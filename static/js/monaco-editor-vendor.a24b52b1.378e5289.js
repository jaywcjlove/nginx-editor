"use strict";(self.webpackChunkmonaco_editor_nginx=self.webpackChunkmonaco_editor_nginx||[]).push([[6029],{43311:function(e,t,n){n.d(t,{f:function(){return he},n:function(){return ge}});var i=n(74165),r=n(93433),o=n(37762),s=n(15671),a=n(43144),u=n(60136),l=n(27277),d=n(1670),c=n(24404),h=n(61002),g=n(84191),f=n(82927),v=n(62428),p=n(91189),m=n(9538),_=n(39177),y=n(78656),k=n(33752),b=n(80017),C=n(3318),w=n(81699),x=n(87328),L=function(){function e(t,n){(0,s.Z)(this,e),this._updateEventEmitter=new C.Q5,this.onDidChange=this._updateEventEmitter.event,this._textModel=t,this._decorationProvider=n,this._regions=new w.MN(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[]}return(0,a.Z)(e,[{key:"regions",get:function(){return this._regions}},{key:"textModel",get:function(){return this._textModel}},{key:"toggleCollapseState",value:function(e){var t=this;if(e.length){e=e.sort((function(e,t){return e.regionIndex-t.regionIndex}));var n={};this._decorationProvider.changeDecorations((function(i){var r,s=0,a=-1,u=-1,l=function(e){for(;s<e;){var n=t._regions.getEndLineNumber(s),r=t._regions.isCollapsed(s);if(n<=a){var o=0!==t.regions.getSource(s);i.changeDecorationOptions(t._editorDecorationIds[s],t._decorationProvider.getDecorationOption(r,n<=u,o))}r&&n>u&&(u=n),s++}},d=(0,o.Z)(e);try{for(d.s();!(r=d.n()).done;){var c=r.value.regionIndex,h=t._editorDecorationIds[c];if(h&&!n[h]){n[h]=!0,l(c);var g=!t._regions.isCollapsed(c);t._regions.setCollapsed(c,g),a=Math.max(a,t._regions.getEndLineNumber(c))}}}catch(f){d.e(f)}finally{d.f()}l(t._regions.length)})),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}}},{key:"removeManualRanges",value:function(e){for(var t=new Array,n=function(t){var n,i=(0,o.Z)(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(!(r.startLineNumber>t.endLineNumber||t.startLineNumber>r.endLineNumber))return!0}}catch(s){i.e(s)}finally{i.f()}return!1},i=0;i<this._regions.length;i++){var r=this._regions.toFoldRange(i);0!==r.source&&n(r)||t.push(r)}this.updatePost(w.MN.fromFoldRanges(t))}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this._currentFoldedOrManualRanges(t),i=w.MN.sanitizeAndMerge(e,n,this._textModel.getLineCount());this.updatePost(w.MN.fromFoldRanges(i))}},{key:"updatePost",value:function(e){for(var t=this,n=[],i=-1,r=0,o=e.length;r<o;r++){var s=e.getStartLineNumber(r),a=e.getEndLineNumber(r),u=e.isCollapsed(r),l=0!==e.getSource(r),d={startLineNumber:s,startColumn:this._textModel.getLineMaxColumn(s),endLineNumber:a,endColumn:this._textModel.getLineMaxColumn(a)+1};n.push({range:d,options:this._decorationProvider.getDecorationOption(u,a<=i,l)}),u&&a>i&&(i=a)}this._decorationProvider.changeDecorations((function(e){return t._editorDecorationIds=e.deltaDecorations(t._editorDecorationIds,n)})),this._regions=e,this._updateEventEmitter.fire({model:this})}},{key:"_currentFoldedOrManualRanges",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=function(t,n){var i,r=(0,o.Z)(e);try{for(r.s();!(i=r.n()).done;){var s=i.value;if(t<s&&s<=n)return!0}}catch(a){r.e(a)}finally{r.f()}return!1},n=[],i=0,r=this._regions.length;i<r;i++){var s=this.regions.isCollapsed(i),a=this.regions.getSource(i);if(s||0!==a){var u=this._regions.toFoldRange(i),l=this._textModel.getDecorationRange(this._editorDecorationIds[i]);l&&(s&&t(l.startLineNumber,l.endLineNumber)&&(s=!1),n.push({startLineNumber:l.startLineNumber,endLineNumber:l.endLineNumber,type:u.type,isCollapsed:s,source:a}))}}return n}},{key:"getMemento",value:function(){for(var e=this._currentFoldedOrManualRanges(),t=[],n=this._textModel.getLineCount(),i=0,r=e.length;i<r;i++){var o=e[i];if(!(o.startLineNumber>=o.endLineNumber||o.startLineNumber<1||o.endLineNumber>n)){var s=this._getLinesChecksum(o.startLineNumber+1,o.endLineNumber);t.push({startLineNumber:o.startLineNumber,endLineNumber:o.endLineNumber,isCollapsed:o.isCollapsed,source:o.source,checksum:s})}}return t.length>0?t:void 0}},{key:"applyMemento",value:function(e){var t,n;if(Array.isArray(e)){var i,r=[],s=this._textModel.getLineCount(),a=(0,o.Z)(e);try{for(a.s();!(i=a.n()).done;){var u=i.value;if(!(u.startLineNumber>=u.endLineNumber||u.startLineNumber<1||u.endLineNumber>s)){var l=this._getLinesChecksum(u.startLineNumber+1,u.endLineNumber);u.checksum&&l!==u.checksum||r.push({startLineNumber:u.startLineNumber,endLineNumber:u.endLineNumber,type:void 0,isCollapsed:null===(t=u.isCollapsed)||void 0===t||t,source:null!==(n=u.source)&&void 0!==n?n:0})}}}catch(c){a.e(c)}finally{a.f()}var d=w.MN.sanitizeAndMerge(this._regions,r,s);this.updatePost(w.MN.fromFoldRanges(d))}}},{key:"_getLinesChecksum",value:function(e,t){return(0,x.vp)(this._textModel.getLineContent(e)+this._textModel.getLineContent(t))%1e6}},{key:"dispose",value:function(){this._decorationProvider.removeDecorations(this._editorDecorationIds)}},{key:"getAllRegionsAtLine",value:function(e,t){var n=[];if(this._regions)for(var i=this._regions.findRange(e),r=1;i>=0;){var o=this._regions.toRegion(i);t&&!t(o,r)||n.push(o),r++,i=o.parentIndex}return n}},{key:"getRegionAtLine",value:function(e){if(this._regions){var t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}},{key:"getRegionsInside",value:function(e,t){var n=[],i=e?e.regionIndex+1:0,r=e?e.endLineNumber:Number.MAX_VALUE;if(t&&2===t.length)for(var o=[],s=i,a=this._regions.length;s<a;s++){var u=this._regions.toRegion(s);if(!(this._regions.getStartLineNumber(s)<r))break;for(;o.length>0&&!u.containedBy(o[o.length-1]);)o.pop();o.push(u),t(u,o.length)&&n.push(u)}else for(var l=i,d=this._regions.length;l<d;l++){var c=this._regions.toRegion(l);if(!(this._regions.getStartLineNumber(l)<r))break;t&&!t(c)||n.push(c)}return n}}]),e}();function N(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.MAX_VALUE,i=arguments.length>3?arguments[3]:void 0,s=[];if(i&&i.length>0){var a,u=(0,o.Z)(i);try{for(u.s();!(a=u.n()).done;){var l=a.value,d=e.getRegionAtLine(l);if(d&&(d.isCollapsed!==t&&s.push(d),n>1)){var c=e.getRegionsInside(d,(function(e,i){return e.isCollapsed!==t&&i<n}));s.push.apply(s,(0,r.Z)(c))}}}catch(g){u.e(g)}finally{u.f()}}else{var h=e.getRegionsInside(null,(function(e,i){return e.isCollapsed!==t&&i<n}));s.push.apply(s,(0,r.Z)(h))}e.toggleCollapseState(s)}function R(e,t,n,i){var s,a=[],u=(0,o.Z)(i);try{for(u.s();!(s=u.n()).done;){var l=s.value,d=e.getAllRegionsAtLine(l,(function(e,i){return e.isCollapsed!==t&&i<=n}));a.push.apply(a,(0,r.Z)(d))}}catch(c){u.e(c)}finally{u.f()}e.toggleCollapseState(a)}function Z(e,t,n){var i,r=[],s=(0,o.Z)(n);try{for(s.s();!(i=s.n()).done;){var a=i.value,u=e.getAllRegionsAtLine(a,void 0);u.length>0&&r.push(u[0])}}catch(d){s.e(d)}finally{s.f()}var l=e.getRegionsInside(null,(function(e){return r.every((function(t){return!t.containedBy(e)&&!e.containedBy(t)}))&&e.isCollapsed!==t}));e.toggleCollapseState(l)}function M(e,t,n){for(var i=e.textModel,r=e.regions,o=[],s=r.length-1;s>=0;s--)if(n!==r.isCollapsed(s)){var a=r.getStartLineNumber(s);t.test(i.getLineContent(a))&&o.push(r.toRegion(s))}e.toggleCollapseState(o)}function D(e,t,n){for(var i=e.regions,r=[],o=i.length-1;o>=0;o--)n!==i.isCollapsed(o)&&t===i.getType(o)&&r.push(i.toRegion(o));e.toggleCollapseState(r)}var S=n(85509),I=n(851),P=n(50160),E=function(){function e(t){var n=this;(0,s.Z)(this,e),this._updateEventEmitter=new C.Q5,this._hasLineChanges=!1,this._foldingModel=t,this._foldingModelListener=t.onDidChange((function(e){return n.updateHiddenRanges()})),this._hiddenRanges=[],t.regions.length&&this.updateHiddenRanges()}return(0,a.Z)(e,[{key:"onDidChange",get:function(){return this._updateEventEmitter.event}},{key:"hiddenRanges",get:function(){return this._hiddenRanges}},{key:"notifyChangeModelContent",value:function(e){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=e.changes.some((function(e){return e.range.endLineNumber!==e.range.startLineNumber||0!==(0,P.Q)(e.text)[0]})))}},{key:"updateHiddenRanges",value:function(){for(var e=!1,t=[],n=0,i=0,r=Number.MAX_VALUE,o=-1,s=this._foldingModel.regions;n<s.length;n++)if(s.isCollapsed(n)){var a=s.getStartLineNumber(n)+1,u=s.getEndLineNumber(n);r<=a&&u<=o||(!e&&i<this._hiddenRanges.length&&this._hiddenRanges[i].startLineNumber===a&&this._hiddenRanges[i].endLineNumber===u?(t.push(this._hiddenRanges[i]),i++):(e=!0,t.push(new I.e(a,1,u,1))),r=a,o=u)}(this._hasLineChanges||e||i<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}},{key:"applyHiddenRanges",value:function(e){this._hiddenRanges=e,this._hasLineChanges=!1,this._updateEventEmitter.fire(e)}},{key:"hasRanges",value:function(){return this._hiddenRanges.length>0}},{key:"isHidden",value:function(e){return null!==A(this._hiddenRanges,e)}},{key:"adjustSelections",value:function(e){for(var t=this,n=!1,i=this._foldingModel.textModel,r=null,o=function(e){return r&&function(e,t){return e>=t.startLineNumber&&e<=t.endLineNumber}(e,r)||(r=A(t._hiddenRanges,e)),r?r.startLineNumber-1:null},s=0,a=e.length;s<a;s++){var u=e[s],l=o(u.startLineNumber);l&&(u=u.setStartPosition(l,i.getLineMaxColumn(l)),n=!0);var d=o(u.endLineNumber);d&&(u=u.setEndPosition(d,i.getLineMaxColumn(d)),n=!0),e[s]=u}return n}},{key:"dispose",value:function(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}]),e}();function A(e,t){var n=(0,S.lG)(e,(function(e){return t<e.startLineNumber}))-1;return n>=0&&e[n].endLineNumber>=t?e[n]:null}var T=n(86677),O=n(96531),F=n(24154),U=n(34922),W=n(428),H=n(80598),B=n(35673),G=n(47825),K=n(76634),V=n(95696),X=(0,B.P6G)("editor.foldBackground",{light:(0,B.ZnX)(B.hEj,.3),dark:(0,B.ZnX)(B.hEj,.3),hcDark:null,hcLight:null},(0,O.NC)("foldBackgroundBackground","Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0);(0,B.P6G)("editorGutter.foldingControlForeground",{dark:B.XZx,light:B.XZx,hcDark:B.XZx,hcLight:B.XZx},(0,O.NC)("editorGutter.foldingControlForeground","Color of the folding control in the editor gutter."));var Q=(0,G.q5)("folding-expanded",U.l.chevronDown,(0,O.NC)("foldingExpandedIcon","Icon for expanded ranges in the editor glyph margin.")),j=(0,G.q5)("folding-collapsed",U.l.chevronRight,(0,O.NC)("foldingCollapsedIcon","Icon for collapsed ranges in the editor glyph margin.")),q=(0,G.q5)("folding-manual-collapsed",j,(0,O.NC)("foldingManualCollapedIcon","Icon for manually collapsed ranges in the editor glyph margin.")),z=(0,G.q5)("folding-manual-expanded",Q,(0,O.NC)("foldingManualExpandedIcon","Icon for manually expanded ranges in the editor glyph margin.")),J={color:(0,K.EN)(X),position:W.F5.Inline},$=function(){function e(t){(0,s.Z)(this,e),this.editor=t,this.showFoldingControls="mouseover",this.showFoldingHighlights=!0}return(0,a.Z)(e,[{key:"getDecorationOption",value:function(t,n,i){return n?e.HIDDEN_RANGE_DECORATION:"never"===this.showFoldingControls?t?this.showFoldingHighlights?e.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION:e.NO_CONTROLS_COLLAPSED_RANGE_DECORATION:e.NO_CONTROLS_EXPANDED_RANGE_DECORATION:t?i?this.showFoldingHighlights?e.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:e.MANUALLY_COLLAPSED_VISUAL_DECORATION:this.showFoldingHighlights?e.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:e.COLLAPSED_VISUAL_DECORATION:"mouseover"===this.showFoldingControls?i?e.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION:e.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:i?e.MANUALLY_EXPANDED_VISUAL_DECORATION:e.EXPANDED_VISUAL_DECORATION}},{key:"changeDecorations",value:function(e){return this.editor.changeDecorations(e)}},{key:"removeDecorations",value:function(e){this.editor.removeDecorations(e)}}]),e}();$.COLLAPSED_VISUAL_DECORATION=H.qx.register({description:"folding-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:V.k.asClassName(j)}),$.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=H.qx.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:J,isWholeLine:!0,firstLineDecorationClassName:V.k.asClassName(j)}),$.MANUALLY_COLLAPSED_VISUAL_DECORATION=H.qx.register({description:"folding-manually-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,firstLineDecorationClassName:V.k.asClassName(q)}),$.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=H.qx.register({description:"folding-manually-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:J,isWholeLine:!0,firstLineDecorationClassName:V.k.asClassName(q)}),$.NO_CONTROLS_COLLAPSED_RANGE_DECORATION=H.qx.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0}),$.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION=H.qx.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:J,isWholeLine:!0}),$.EXPANDED_VISUAL_DECORATION=H.qx.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+V.k.asClassName(Q)}),$.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=H.qx.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:V.k.asClassName(Q)}),$.MANUALLY_EXPANDED_VISUAL_DECORATION=H.qx.register({description:"folding-manually-expanded-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+V.k.asClassName(z)}),$.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION=H.qx.register({description:"folding-manually-expanded-auto-hide-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:V.k.asClassName(z)}),$.NO_CONTROLS_EXPANDED_RANGE_DECORATION=H.qx.register({description:"folding-no-controls-range-decoration",stickiness:0,isWholeLine:!0}),$.HIDDEN_RANGE_DECORATION=H.qx.register({description:"folding-hidden-range-decoration",stickiness:1});var Y=n(76461),ee=n(8439),te=n(60529),ne=n(61597),ie=n(69561),re=n(13134),oe=n(97638),se=n(19920),ae=n(57348),ue=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},le=function(e,t){return function(n,i){t(n,i,e)}},de=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(t){o(t)}}function a(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))},ce=new F.uy("foldingEnabled",!1),he=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(e,i,r,o,a,u){var l;(0,s.Z)(this,n),(l=t.call(this)).contextKeyService=i,l.languageConfigurationService=r,l.languageFeaturesService=u,l.localToDispose=l._register(new f.SL),l.editor=e,l._foldingLimitReporter=new ge(e);var d=l.editor.getOptions();return l._isEnabled=d.get(41),l._useFoldingProviders="indentation"!==d.get(42),l._unfoldOnClickAfterEndOfLine=d.get(46),l._restoringViewState=!1,l._currentModelHasFoldedImports=!1,l._foldingImportsByDefault=d.get(44),l.updateDebounceInfo=a.for(u.foldingRangeProvider,"Folding",{min:200}),l.foldingModel=null,l.hiddenRangeModel=null,l.rangeProvider=null,l.foldingRegionPromise=null,l.foldingModelPromise=null,l.updateScheduler=null,l.cursorChangedScheduler=null,l.mouseDownInfo=null,l.foldingDecorationProvider=new $(e),l.foldingDecorationProvider.showFoldingControls=d.get(106),l.foldingDecorationProvider.showFoldingHighlights=d.get(43),l.foldingEnabled=ce.bindTo(l.contextKeyService),l.foldingEnabled.set(l._isEnabled),l._register(l.editor.onDidChangeModel((function(){return l.onModelChanged()}))),l._register(l.editor.onDidChangeConfiguration((function(e){if(e.hasChanged(41)&&(l._isEnabled=l.editor.getOptions().get(41),l.foldingEnabled.set(l._isEnabled),l.onModelChanged()),e.hasChanged(45)&&l.onModelChanged(),e.hasChanged(106)||e.hasChanged(43)){var t=l.editor.getOptions();l.foldingDecorationProvider.showFoldingControls=t.get(106),l.foldingDecorationProvider.showFoldingHighlights=t.get(43),l.triggerFoldingModelChanged()}e.hasChanged(42)&&(l._useFoldingProviders="indentation"!==l.editor.getOptions().get(42),l.onFoldingStrategyChanged()),e.hasChanged(46)&&(l._unfoldOnClickAfterEndOfLine=l.editor.getOptions().get(46)),e.hasChanged(44)&&(l._foldingImportsByDefault=l.editor.getOptions().get(44))}))),l.onModelChanged(),l}return(0,a.Z)(n,[{key:"saveViewState",value:function(){var e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){var t=this.foldingModel.getMemento(),n=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:n,foldedImports:this._currentModelHasFoldedImports}}}},{key:"restoreViewState",value:function(e){var t=this.editor.getModel();if(t&&this._isEnabled&&!t.isTooLargeForTokenization()&&this.hiddenRangeModel&&e&&(this._currentModelHasFoldedImports=!!e.foldedImports,e.collapsedRegions&&e.collapsedRegions.length>0&&this.foldingModel)){this._restoringViewState=!0;try{this.foldingModel.applyMemento(e.collapsedRegions)}finally{this._restoringViewState=!1}}}},{key:"onModelChanged",value:function(){var e=this;this.localToDispose.clear();var t=this.editor.getModel();this._isEnabled&&t&&!t.isTooLargeForTokenization()&&(this._currentModelHasFoldedImports=!1,this.foldingModel=new L(t,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new E(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange((function(t){return e.onHiddenRangesChanges(t)}))),this.updateScheduler=new d.vp(this.updateDebounceInfo.get(t)),this.cursorChangedScheduler=new d.pY((function(){return e.revealCursor()}),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange((function(){return e.onFoldingStrategyChanged()}))),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration((function(){return e.onFoldingStrategyChanged()}))),this.localToDispose.add(this.editor.onDidChangeModelContent((function(t){return e.onDidChangeModelContent(t)}))),this.localToDispose.add(this.editor.onDidChangeCursorPosition((function(){return e.onCursorPositionChanged()}))),this.localToDispose.add(this.editor.onMouseDown((function(t){return e.onEditorMouseDown(t)}))),this.localToDispose.add(this.editor.onMouseUp((function(t){return e.onEditorMouseUp(t)}))),this.localToDispose.add({dispose:function(){var t,n;e.foldingRegionPromise&&(e.foldingRegionPromise.cancel(),e.foldingRegionPromise=null),null===(t=e.updateScheduler)||void 0===t||t.cancel(),e.updateScheduler=null,e.foldingModel=null,e.foldingModelPromise=null,e.hiddenRangeModel=null,e.cursorChangedScheduler=null,null===(n=e.rangeProvider)||void 0===n||n.dispose(),e.rangeProvider=null}}),this.triggerFoldingModelChanged())}},{key:"onFoldingStrategyChanged",value:function(){var e;null===(e=this.rangeProvider)||void 0===e||e.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}},{key:"getRangeProvider",value:function(e){var t=this;if(this.rangeProvider)return this.rangeProvider;var i=new T.aI(e,this.languageConfigurationService,this._foldingLimitReporter);if(this.rangeProvider=i,this._useFoldingProviders&&this.foldingModel){var r=n.getFoldingRangeProviders(this.languageFeaturesService,e);r.length>0&&(this.rangeProvider=new Y.e(e,r,(function(){return t.triggerFoldingModelChanged()}),this._foldingLimitReporter,i))}return this.rangeProvider}},{key:"getFoldingModel",value:function(){return this.foldingModelPromise}},{key:"onDidChangeModelContent",value:function(e){var t;null===(t=this.hiddenRangeModel)||void 0===t||t.notifyChangeModelContent(e),this.triggerFoldingModelChanged()}},{key:"triggerFoldingModelChanged",value:function(){var e=this;this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger((function(){var t=e.foldingModel;if(!t)return null;var n=new ne.G(!0),i=e.getRangeProvider(t.textModel),r=e.foldingRegionPromise=(0,d.PG)((function(e){return i.compute(e)}));return r.then((function(i){if(i&&r===e.foldingRegionPromise){var o;if(e._foldingImportsByDefault&&!e._currentModelHasFoldedImports){var s=i.setCollapsedAllOfType(k.AD.Imports.value,!0);s&&(o=m.Z.capture(e.editor),e._currentModelHasFoldedImports=s)}var a=e.editor.getSelections(),u=a?a.map((function(e){return e.startLineNumber})):[];t.update(i,u),null===o||void 0===o||o.restore(e.editor);var l=e.updateDebounceInfo.update(t.textModel,n.elapsed());e.updateScheduler&&(e.updateScheduler.defaultDelay=l)}return t}))})).then(void 0,(function(e){return(0,h.dL)(e),null})))}},{key:"onHiddenRangesChanges",value:function(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){var t=this.editor.getSelections();t&&this.hiddenRangeModel.adjustSelections(t)&&this.editor.setSelections(t)}this.editor.setHiddenAreas(e,this)}},{key:"onCursorPositionChanged",value:function(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}},{key:"revealCursor",value:function(){var e=this,t=this.getFoldingModel();t&&t.then((function(t){if(t){var n=e.editor.getSelections();if(n&&n.length>0){var i,s=[],a=(0,o.Z)(n);try{var u=function(){var n=i.value.selectionStartLineNumber;e.hiddenRangeModel&&e.hiddenRangeModel.isHidden(n)&&s.push.apply(s,(0,r.Z)(t.getAllRegionsAtLine(n,(function(e){return e.isCollapsed&&n>e.startLineNumber}))))};for(a.s();!(i=a.n()).done;)u()}catch(l){a.e(l)}finally{a.f()}s.length&&(t.toggleCollapseState(s),e.reveal(n[0].getPosition()))}}})).then(void 0,h.dL)}},{key:"onEditorMouseDown",value:function(e){if(this.mouseDownInfo=null,this.hiddenRangeModel&&e.target&&e.target.range&&(e.event.leftButton||e.event.middleButton)){var t=e.target.range,n=!1;switch(e.target.type){case 4:var i=e.target.detail,r=e.target.element.offsetLeft;if(i.offsetX-r<5)return;n=!0;break;case 7:if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges())if(!e.target.detail.isAfterLines)break;return;case 6:if(this.hiddenRangeModel.hasRanges()){var o=this.editor.getModel();if(o&&t.startColumn===o.getLineMaxColumn(t.startLineNumber))break}return;default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:n}}}},{key:"onEditorMouseUp",value:function(e){var t=this.foldingModel;if(t&&this.mouseDownInfo&&e.target){var n=this.mouseDownInfo.lineNumber,i=this.mouseDownInfo.iconClicked,r=e.target.range;if(r&&r.startLineNumber===n){if(i){if(4!==e.target.type)return}else{var s=this.editor.getModel();if(!s||r.startColumn!==s.getLineMaxColumn(n))return}var a=t.getRegionAtLine(n);if(a&&a.startLineNumber===n){var u=a.isCollapsed;if(i||u){var l=[];if(e.event.altKey){var d,c=t.getRegionsInside(null,(function(e){return!e.containedBy(a)&&!a.containedBy(e)})),h=(0,o.Z)(c);try{for(h.s();!(d=h.n()).done;){var g=d.value;g.isCollapsed&&l.push(g)}}catch(_){h.e(_)}finally{h.f()}0===l.length&&(l=c)}else{var f=e.event.middleButton||e.event.shiftKey;if(f){var v,p=(0,o.Z)(t.getRegionsInside(a));try{for(p.s();!(v=p.n()).done;){var m=v.value;m.isCollapsed===u&&l.push(m)}}catch(_){p.e(_)}finally{p.f()}}!u&&f&&0!==l.length||l.push(a)}t.toggleCollapseState(l),this.reveal({lineNumber:n,column:1})}}}}}},{key:"reveal",value:function(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}}],[{key:"get",value:function(e){return e.getContribution(n.ID)}},{key:"getFoldingRangeProviders",value:function(e,t){var i,r,o=e.foldingRangeProvider.ordered(t);return null!==(r=null===(i=n._foldingRangeSelector)||void 0===i?void 0:i.call(n,o,t))&&void 0!==r?r:o}}]),n}(f.JT);he.ID="editor.contrib.folding",he=ue([le(1,F.i6),le(2,b.c_),le(3,ee.lT),le(4,te.A),le(5,ie.p)],he);var ge=function(){function e(t){(0,s.Z)(this,e),this.editor=t,this._onDidChange=new C.Q5,this._computed=0,this._limited=!1}return(0,a.Z)(e,[{key:"limit",get:function(){return this.editor.getOptions().get(45)}},{key:"update",value:function(e,t){e===this._computed&&t===this._limited||(this._computed=e,this._limited=t,this._onDidChange.fire())}}]),e}(),fe=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"runEditorCommand",value:function(e,t,n){var i=this,r=e.get(b.c_),o=he.get(t);if(o){var s=o.getFoldingModel();return s?(this.reportTelemetry(e,t),s.then((function(e){if(e){i.invoke(o,e,t,n,r);var s=t.getSelection();s&&o.reveal(s.getStartPosition())}}))):void 0}}},{key:"getSelectedLines",value:function(e){var t=e.getSelections();return t?t.map((function(e){return e.startLineNumber})):[]}},{key:"getLineNumbers",value:function(e,t){return e&&e.selectionLines?e.selectionLines.map((function(e){return e+1})):this.getSelectedLines(t)}},{key:"run",value:function(e,t){}}]),n}(_.R6);function ve(e){if(!p.o8(e)){if(!p.Kn(e))return!1;var t=e;if(!p.o8(t.levels)&&!p.hj(t.levels))return!1;if(!p.o8(t.direction)&&!p.HD(t.direction))return!1;if(!p.o8(t.selectionLines)&&(!Array.isArray(t.selectionLines)||!t.selectionLines.every(p.hj)))return!1}return!0}var pe=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.unfold",label:O.NC("unfoldAction.label","Unfold"),alias:"Unfold",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:3166,mac:{primary:2654},weight:100},description:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t",constraint:ve,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n,i){var r=i&&i.levels||1,o=this.getLineNumbers(i,n);i&&"up"===i.direction?R(t,!1,r,o):N(t,!1,r,o)}}]),n}(fe),me=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.unfoldRecursively",label:O.NC("unFoldRecursivelyAction.label","Unfold Recursively"),alias:"Unfold Recursively",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2142),weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n,i){N(t,!1,Number.MAX_VALUE,this.getSelectedLines(n))}}]),n}(fe),_e=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.fold",label:O.NC("foldAction.label","Fold"),alias:"Fold",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:3164,mac:{primary:2652},weight:100},description:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:"Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t",constraint:ve,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n,i){var r=this.getLineNumbers(i,n),s=i&&i.levels,a=i&&i.direction;"number"!==typeof s&&"string"!==typeof a?function(e,t,n){var i,r=[],s=(0,o.Z)(n);try{for(s.s();!(i=s.n()).done;){var a=i.value,u=e.getAllRegionsAtLine(a,(function(e){return e.isCollapsed!==t}));u.length>0&&r.push(u[0])}}catch(l){s.e(l)}finally{s.f()}e.toggleCollapseState(r)}(t,!0,r):"up"===a?R(t,!0,s||1,r):N(t,!0,s||1,r)}}]),n}(fe),ye=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.toggleFold",label:O.NC("toggleFoldAction.label","Toggle Fold"),alias:"Toggle Fold",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2090),weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n){!function(e,t,n){var i,s=[],a=(0,o.Z)(n);try{var u=function(){var n=i.value,o=e.getRegionAtLine(n);if(o){var a=!o.isCollapsed;if(s.push(o),t>1){var u=e.getRegionsInside(o,(function(e,n){return e.isCollapsed!==a&&n<t}));s.push.apply(s,(0,r.Z)(u))}}};for(a.s();!(i=a.n()).done;)u()}catch(l){a.e(l)}finally{a.f()}e.toggleCollapseState(s)}(t,1,this.getSelectedLines(n))}}]),n}(fe),ke=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.foldRecursively",label:O.NC("foldRecursivelyAction.label","Fold Recursively"),alias:"Fold Recursively",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2140),weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n){var i=this.getSelectedLines(n);N(t,!0,Number.MAX_VALUE,i)}}]),n}(fe),be=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.foldAllBlockComments",label:O.NC("foldAllBlockComments.label","Fold All Block Comments"),alias:"Fold All Block Comments",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2138),weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n,i,r){if(t.regions.hasTypes())D(t,k.AD.Comment.value,!0);else{var o=n.getModel();if(!o)return;var s=r.getLanguageConfiguration(o.getLanguageId()).comments;if(s&&s.blockCommentStartToken)M(t,new RegExp("^\\s*"+(0,v.ec)(s.blockCommentStartToken)),!0)}}}]),n}(fe),Ce=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.foldAllMarkerRegions",label:O.NC("foldAllMarkerRegions.label","Fold All Regions"),alias:"Fold All Regions",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2077),weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n,i,r){if(t.regions.hasTypes())D(t,k.AD.Region.value,!0);else{var o=n.getModel();if(!o)return;var s=r.getLanguageConfiguration(o.getLanguageId()).foldingRules;if(s&&s.markers&&s.markers.start)M(t,new RegExp(s.markers.start),!0)}}}]),n}(fe),we=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.unfoldAllMarkerRegions",label:O.NC("unfoldAllMarkerRegions.label","Unfold All Regions"),alias:"Unfold All Regions",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2078),weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n,i,r){if(t.regions.hasTypes())D(t,k.AD.Region.value,!1);else{var o=n.getModel();if(!o)return;var s=r.getLanguageConfiguration(o.getLanguageId()).foldingRules;if(s&&s.markers&&s.markers.start)M(t,new RegExp(s.markers.start),!1)}}}]),n}(fe),xe=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.foldAllExcept",label:O.NC("foldAllExcept.label","Fold All Regions Except Selected"),alias:"Fold All Regions Except Selected",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2136),weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n){Z(t,!0,this.getSelectedLines(n))}}]),n}(fe),Le=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.unfoldAllExcept",label:O.NC("unfoldAllExcept.label","Unfold All Regions Except Selected"),alias:"Unfold All Regions Except Selected",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2134),weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n){Z(t,!1,this.getSelectedLines(n))}}]),n}(fe),Ne=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.foldAll",label:O.NC("foldAllAction.label","Fold All"),alias:"Fold All",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2069),weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n){N(t,!0)}}]),n}(fe),Re=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.unfoldAll",label:O.NC("unfoldAllAction.label","Unfold All"),alias:"Unfold All",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2088),weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n){N(t,!1)}}]),n}(fe),Ze=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n,[{key:"getFoldingLevel",value:function(){return parseInt(this.id.substr(n.ID_PREFIX.length))}},{key:"invoke",value:function(e,t,n){!function(e,t,n,i){var r=e.getRegionsInside(null,(function(e,r){return r===t&&e.isCollapsed!==n&&!i.some((function(t){return e.containsLine(t)}))}));e.toggleCollapseState(r)}(t,this.getFoldingLevel(),!0,this.getSelectedLines(n))}}]),n}(fe);Ze.ID_PREFIX="editor.foldLevel",Ze.ID=function(e){return Ze.ID_PREFIX+e};var Me=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.gotoParentFold",label:O.NC("gotoParentFold.label","Go to Parent Fold"),alias:"Go to Parent Fold",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n){var i=this.getSelectedLines(n);if(i.length>0){var r=function(e,t){var n=null,i=t.getRegionAtLine(e);if(null!==i&&e===(n=i.startLineNumber)){var r=i.parentIndex;n=-1!==r?t.regions.getStartLineNumber(r):null}return n}(i[0],t);null!==r&&n.setSelection({startLineNumber:r,startColumn:1,endLineNumber:r,endColumn:1})}}}]),n}(fe),De=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.gotoPreviousFold",label:O.NC("gotoPreviousFold.label","Go to Previous Folding Range"),alias:"Go to Previous Folding Range",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n){var i=this.getSelectedLines(n);if(i.length>0){var r=function(e,t){var n=t.getRegionAtLine(e);if(null!==n&&n.startLineNumber===e){if(e!==n.startLineNumber)return n.startLineNumber;var i=n.parentIndex,r=0;for(-1!==i&&(r=t.regions.getStartLineNumber(n.parentIndex));null!==n;){if(!(n.regionIndex>0))return null;if((n=t.regions.toRegion(n.regionIndex-1)).startLineNumber<=r)return null;if(n.parentIndex===i)return n.startLineNumber}}else if(t.regions.length>0)for(n=t.regions.toRegion(t.regions.length-1);null!==n;){if(n.startLineNumber<e)return n.startLineNumber;n=n.regionIndex>0?t.regions.toRegion(n.regionIndex-1):null}return null}(i[0],t);null!==r&&n.setSelection({startLineNumber:r,startColumn:1,endLineNumber:r,endColumn:1})}}}]),n}(fe),Se=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.gotoNextFold",label:O.NC("gotoNextFold.label","Go to Next Folding Range"),alias:"Go to Next Folding Range",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n){var i=this.getSelectedLines(n);if(i.length>0){var r=function(e,t){var n=t.getRegionAtLine(e);if(null!==n&&n.startLineNumber===e){var i=n.parentIndex,r=0;if(-1!==i)r=t.regions.getEndLineNumber(n.parentIndex);else{if(0===t.regions.length)return null;r=t.regions.getEndLineNumber(t.regions.length-1)}for(;null!==n;){if(!(n.regionIndex<t.regions.length))return null;if((n=t.regions.toRegion(n.regionIndex+1)).startLineNumber>=r)return null;if(n.parentIndex===i)return n.startLineNumber}}else if(t.regions.length>0)for(n=t.regions.toRegion(0);null!==n;){if(n.startLineNumber>e)return n.startLineNumber;n=n.regionIndex<t.regions.length?t.regions.toRegion(n.regionIndex+1):null}return null}(i[0],t);null!==r&&n.setSelection({startLineNumber:r,startColumn:1,endLineNumber:r,endColumn:1})}}}]),n}(fe),Ie=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.createFoldingRangeFromSelection",label:O.NC("createManualFoldRange.label","Create Folding Range from Selection"),alias:"Create Folding Range from Selection",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2135),weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n){var i,r=[],s=n.getSelections();if(s){var a,u=(0,o.Z)(s);try{for(u.s();!(a=u.n()).done;){var l=a.value,d=l.endLineNumber;1===l.endColumn&&--d,d>l.startLineNumber&&(r.push({startLineNumber:l.startLineNumber,endLineNumber:d,type:void 0,isCollapsed:!0,source:1}),n.setSelection({startLineNumber:l.startLineNumber,startColumn:1,endLineNumber:l.startLineNumber,endColumn:1}))}}catch(h){u.e(h)}finally{u.f()}if(r.length>0){r.sort((function(e,t){return e.startLineNumber-t.startLineNumber}));var c=w.MN.sanitizeAndMerge(t.regions,r,null===(i=n.getModel())||void 0===i?void 0:i.getLineCount());t.updatePost(w.MN.fromFoldRanges(c))}}}}]),n}(fe),Pe=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.removeManualFoldingRanges",label:O.NC("removeManualFoldingRanges.label","Remove Manual Folding Ranges"),alias:"Remove Manual Folding Ranges",precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2137),weight:100}})}return(0,a.Z)(n,[{key:"invoke",value:function(e,t,n){var i=n.getSelections();if(i){var r,s=[],a=(0,o.Z)(i);try{for(a.s();!(r=a.n()).done;){var u=r.value,l=u.startLineNumber,d=u.endLineNumber;s.push(d>=l?{startLineNumber:l,endLineNumber:d}:{endLineNumber:d,startLineNumber:l})}}catch(c){a.e(c)}finally{a.f()}t.removeManualRanges(s),e.triggerFoldingModelChanged()}}}]),n}(fe);(0,_._K)(he.ID,he,0),(0,_.Qr)(pe),(0,_.Qr)(me),(0,_.Qr)(_e),(0,_.Qr)(ke),(0,_.Qr)(Ne),(0,_.Qr)(Re),(0,_.Qr)(be),(0,_.Qr)(Ce),(0,_.Qr)(we),(0,_.Qr)(xe),(0,_.Qr)(Le),(0,_.Qr)(ye),(0,_.Qr)(Me),(0,_.Qr)(De),(0,_.Qr)(Se),(0,_.Qr)(Ie),(0,_.Qr)(Pe);for(var Ee=1;Ee<=7;Ee++)(0,_.QG)(new Ze({id:Ze.ID(Ee),label:O.NC("foldLevelAction.label","Fold Level {0}",Ee),alias:"Fold Level ".concat(Ee),precondition:ce,kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2048|21+Ee),weight:100}}));re.P.registerCommand("_executeFoldingRangeProvider",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return de(this,void 0,void 0,(0,i.Z)().mark((function t(){var r,o,s,a,u,l,d,g,f,v,p,m,_,y;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=n[0])instanceof oe.o){t.next=3;break}throw(0,h.b1)();case 3:if(o=e.get(ie.p),s=e.get(se.q).getModel(r)){t.next=7;break}throw(0,h.b1)();case 7:if((a=e.get(ae.Ui)).getValue("editor.folding",{resource:r})){t.next=10;break}return t.abrupt("return",[]);case 10:return u=e.get(b.c_),l=a.getValue("editor.foldingStrategy",{resource:r}),t.t0=function(e,t){},d={get limit(){return a.getValue("editor.foldingMaximumRegions",{resource:r})},update:t.t0},g=new T.aI(s,u,d),f=g,"indentation"!==l&&(v=he.getFoldingRangeProviders(o,s)).length&&(f=new Y.e(s,v,(function(){}),d,g)),t.next=19,f.compute(c.T.None);case 19:if(p=t.sent,m=[],t.prev=21,p)for(_=0;_<p.length;_++)y=p.getType(_),m.push({start:p.getStartLineNumber(_),end:p.getEndLineNumber(_),kind:y?k.AD.fromValue(y):void 0});return t.abrupt("return",m);case 24:return t.prev=24,f.dispose(),t.finish(24);case 27:case"end":return t.stop()}}),t,null,[[21,,24,27]])})))}))},81699:function(e,t,n){n.d(t,{MN:function(){return c},Xl:function(){return u}});var i,r=n(15671),o=n(43144),s=n(4942),a=(i={},(0,s.Z)(i,0," "),(0,s.Z)(i,1,"u"),(0,s.Z)(i,2,"r"),i),u=16777215,l=4278190080,d=function(){function e(t){(0,r.Z)(this,e);var n=Math.ceil(t/32);this._states=new Uint32Array(n)}return(0,o.Z)(e,[{key:"get",value:function(e){var t=e/32|0,n=e%32;return 0!==(this._states[t]&1<<n)}},{key:"set",value:function(e,t){var n=e/32|0,i=e%32,r=this._states[n];this._states[n]=t?r|1<<i:r&~(1<<i)}}]),e}(),c=function(){function e(t,n,i){if((0,r.Z)(this,e),t.length!==n.length||t.length>65535)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=t,this._endIndexes=n,this._collapseStates=new d(t.length),this._userDefinedStates=new d(t.length),this._recoveredStates=new d(t.length),this._types=i,this._parentsComputed=!1}return(0,o.Z)(e,[{key:"ensureParentIndices",value:function(){var e=this;if(!this._parentsComputed){this._parentsComputed=!0;for(var t=[],n=function(n,i){var r=t[t.length-1];return e.getStartLineNumber(r)<=n&&e.getEndLineNumber(r)>=i},i=0,r=this._startIndexes.length;i<r;i++){var o=this._startIndexes[i],s=this._endIndexes[i];if(o>u||s>u)throw new Error("startLineNumber or endLineNumber must not exceed "+u);for(;t.length>0&&!n(o,s);)t.pop();var a=t.length>0?t[t.length-1]:-1;t.push(i),this._startIndexes[i]=o+((255&a)<<24),this._endIndexes[i]=s+((65280&a)<<16)}}}},{key:"length",get:function(){return this._startIndexes.length}},{key:"getStartLineNumber",value:function(e){return this._startIndexes[e]&u}},{key:"getEndLineNumber",value:function(e){return this._endIndexes[e]&u}},{key:"getType",value:function(e){return this._types?this._types[e]:void 0}},{key:"hasTypes",value:function(){return!!this._types}},{key:"isCollapsed",value:function(e){return this._collapseStates.get(e)}},{key:"setCollapsed",value:function(e,t){this._collapseStates.set(e,t)}},{key:"isUserDefined",value:function(e){return this._userDefinedStates.get(e)}},{key:"setUserDefined",value:function(e,t){return this._userDefinedStates.set(e,t)}},{key:"isRecovered",value:function(e){return this._recoveredStates.get(e)}},{key:"setRecovered",value:function(e,t){return this._recoveredStates.set(e,t)}},{key:"getSource",value:function(e){return this.isUserDefined(e)?1:this.isRecovered(e)?2:0}},{key:"setSource",value:function(e,t){1===t?(this.setUserDefined(e,!0),this.setRecovered(e,!1)):2===t?(this.setUserDefined(e,!1),this.setRecovered(e,!0)):(this.setUserDefined(e,!1),this.setRecovered(e,!1))}},{key:"setCollapsedAllOfType",value:function(e,t){var n=!1;if(this._types)for(var i=0;i<this._types.length;i++)this._types[i]===e&&(this.setCollapsed(i,t),n=!0);return n}},{key:"toRegion",value:function(e){return new h(this,e)}},{key:"getParentIndex",value:function(e){this.ensureParentIndices();var t=((this._startIndexes[e]&l)>>>24)+((this._endIndexes[e]&l)>>>16);return 65535===t?-1:t}},{key:"contains",value:function(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}},{key:"findIndex",value:function(e){var t=0,n=this._startIndexes.length;if(0===n)return-1;for(;t<n;){var i=Math.floor((t+n)/2);e<this.getStartLineNumber(i)?n=i:t=i+1}return t-1}},{key:"findRange",value:function(e){var t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);-1!==t;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}},{key:"toString",value:function(){for(var e=[],t=0;t<this.length;t++)e[t]="[".concat(a[this.getSource(t)]).concat(this.isCollapsed(t)?"+":"-","] ").concat(this.getStartLineNumber(t),"/").concat(this.getEndLineNumber(t));return e.join(", ")}},{key:"toFoldRange",value:function(e){return{startLineNumber:this._startIndexes[e]&u,endLineNumber:this._endIndexes[e]&u,type:this._types?this._types[e]:void 0,isCollapsed:this.isCollapsed(e),source:this.getSource(e)}}}],[{key:"fromFoldRanges",value:function(t){for(var n=t.length,i=new Uint32Array(n),r=new Uint32Array(n),o=[],s=!1,a=0;a<n;a++){var u=t[a];i[a]=u.startLineNumber,r[a]=u.endLineNumber,o.push(u.type),u.type&&(s=!0)}s||(o=void 0);for(var l=new e(i,r,o),d=0;d<n;d++)t[d].isCollapsed&&l.setCollapsed(d,!0),l.setSource(d,t[d].source);return l}},{key:"sanitizeAndMerge",value:function(e,t,n){n=null!==n&&void 0!==n?n:Number.MAX_VALUE;for(var i,r=function(e,t){return Array.isArray(e)?function(n){return n<t?e[n]:void 0}:function(n){return n<t?e.toFoldRange(n):void 0}},o=r(e,e.length),s=r(t,t.length),a=0,u=0,l=o(0),d=s(0),c=[],h=0,g=[];l||d;){var f=void 0;if(d&&(!l||l.startLineNumber>=d.startLineNumber))l&&l.startLineNumber===d.startLineNumber?(1===d.source?f=d:((f=l).isCollapsed=d.isCollapsed&&l.endLineNumber===d.endLineNumber,f.source=0),l=o(++a)):(f=d,d.isCollapsed&&0===d.source&&(f.source=2)),d=s(++u);else{for(var v=u,p=d;;){if(!p||p.startLineNumber>l.endLineNumber){f=l;break}if(1===p.source&&p.endLineNumber>l.endLineNumber)break;p=s(++v)}l=o(++a)}if(f){for(;i&&i.endLineNumber<f.startLineNumber;)i=c.pop();f.endLineNumber>f.startLineNumber&&f.startLineNumber>h&&f.endLineNumber<=n&&(!i||i.endLineNumber>=f.endLineNumber)&&(g.push(f),h=f.startLineNumber,i&&c.push(i),i=f)}}return g}}]),e}(),h=function(){function e(t,n){(0,r.Z)(this,e),this.ranges=t,this.index=n}return(0,o.Z)(e,[{key:"startLineNumber",get:function(){return this.ranges.getStartLineNumber(this.index)}},{key:"endLineNumber",get:function(){return this.ranges.getEndLineNumber(this.index)}},{key:"regionIndex",get:function(){return this.index}},{key:"parentIndex",get:function(){return this.ranges.getParentIndex(this.index)}},{key:"isCollapsed",get:function(){return this.ranges.isCollapsed(this.index)}},{key:"containedBy",value:function(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}},{key:"containsLine",value:function(e){return this.startLineNumber<=e&&e<=this.endLineNumber}}]),e}()},86677:function(e,t,n){n.d(t,{aI:function(){return a}});var i=n(15671),r=n(43144),o=n(15765),s=n(81699),a=function(){function e(t,n,r){(0,i.Z)(this,e),this.editorModel=t,this.languageConfigurationService=n,this.foldingRangesLimit=r,this.id="indent"}return(0,r.Z)(e,[{key:"dispose",value:function(){}},{key:"compute",value:function(e){var t=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,n=t&&!!t.offSide,i=t&&t.markers;return Promise.resolve(function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l,r=e.getOptions().tabSize,s=new u(i),a=void 0;n&&(a=new RegExp("(".concat(n.start.source,")|(?:").concat(n.end.source,")")));var d=[],c=e.getLineCount()+1;d.push({indent:-1,endAbove:c,line:c});for(var h=e.getLineCount();h>0;h--){var g=e.getLineContent(h),f=(0,o.q)(g,r),v=d[d.length-1];if(-1!==f){var p=void 0;if(a&&(p=g.match(a))){if(!p[1]){d.push({indent:-2,endAbove:h,line:h});continue}for(var m=d.length-1;m>0&&-2!==d[m].indent;)m--;if(m>0){d.length=m+1,v=d[m],s.insertFirst(h,v.line,f),v.line=h,v.indent=f,v.endAbove=h;continue}}if(v.indent>f){do{d.pop(),v=d[d.length-1]}while(v.indent>f);var _=v.endAbove-1;_-h>=1&&s.insertFirst(h,_,f)}v.indent===f?v.endAbove=h:d.push({indent:f,endAbove:h,line:h})}else t&&(v.endAbove=h)}return s.toIndentRanges(e)}(this.editorModel,n,i,this.foldingRangesLimit))}}]),e}(),u=function(){function e(t){(0,i.Z)(this,e),this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=t}return(0,r.Z)(e,[{key:"insertFirst",value:function(e,t,n){if(!(e>s.Xl||t>s.Xl)){var i=this._length;this._startIndexes[i]=e,this._endIndexes[i]=t,this._length++,n<1e3&&(this._indentOccurrences[n]=(this._indentOccurrences[n]||0)+1)}}},{key:"toIndentRanges",value:function(e){var t=this._foldingRangesLimit.limit;if(this._length<=t){this._foldingRangesLimit.update(this._length,!1);for(var n=new Uint32Array(this._length),i=new Uint32Array(this._length),r=this._length-1,a=0;r>=0;r--,a++)n[a]=this._startIndexes[r],i[a]=this._endIndexes[r];return new s.MN(n,i)}this._foldingRangesLimit.update(this._length,t);for(var u=0,l=this._indentOccurrences.length,d=0;d<this._indentOccurrences.length;d++){var c=this._indentOccurrences[d];if(c){if(c+u>t){l=d;break}u+=c}}for(var h=e.getOptions().tabSize,g=new Uint32Array(t),f=new Uint32Array(t),v=this._length-1,p=0;v>=0;v--){var m=this._startIndexes[v],_=e.getLineContent(m),y=(0,o.q)(_,h);(y<l||y===l&&u++<t)&&(g[p]=m,f[p]=this._endIndexes[v],p++)}return new s.MN(g,f)}}]),e}(),l={limit:5e3,update:function(){}}},76461:function(e,t,n){n.d(t,{e:function(){return d}});var i=n(37762),r=n(15671),o=n(43144),s=n(61002),a=n(82927),u=n(81699),l={},d=function(){function e(t,n,o,s,u){(0,r.Z)(this,e),this.editorModel=t,this.providers=n,this.handleFoldingRangesChange=o,this.foldingRangesLimit=s,this.fallbackRangeProvider=u,this.id="syntax",this.disposables=new a.SL,u&&this.disposables.add(u);var l,d=(0,i.Z)(n);try{for(d.s();!(l=d.n()).done;){var c=l.value;"function"===typeof c.onDidChange&&this.disposables.add(c.onDidChange(o))}}catch(h){d.e(h)}finally{d.f()}}return(0,o.Z)(e,[{key:"compute",value:function(e){var t=this;return function(e,t,n){var r=null,o=e.map((function(e,o){return Promise.resolve(e.provideFoldingRanges(t,l,n)).then((function(e){if(!n.isCancellationRequested&&Array.isArray(e)){Array.isArray(r)||(r=[]);var s,a=t.getLineCount(),u=(0,i.Z)(e);try{for(u.s();!(s=u.n()).done;){var l=s.value;l.start>0&&l.end>l.start&&l.end<=a&&r.push({start:l.start,end:l.end,rank:o,kind:l.kind})}}catch(d){u.e(d)}finally{u.f()}}}),s.Cp)}));return Promise.all(o).then((function(e){return r}))}(this.providers,this.editorModel,e).then((function(n){var r,o;return n?function(e,t){var n,r=e.sort((function(e,t){var n=e.start-t.start;return 0===n&&(n=e.rank-t.rank),n})),o=new c(t),s=void 0,a=[],u=(0,i.Z)(r);try{for(u.s();!(n=u.n()).done;){var l=n.value;if(s){if(l.start>s.start)if(l.end<=s.end)a.push(s),s=l,o.add(l.start,l.end,l.kind&&l.kind.value,a.length);else{if(l.start>s.end){do{s=a.pop()}while(s&&l.start>s.end);s&&a.push(s),s=l}o.add(l.start,l.end,l.kind&&l.kind.value,a.length)}}else s=l,o.add(l.start,l.end,l.kind&&l.kind.value,a.length)}}catch(d){u.e(d)}finally{u.f()}return o.toIndentRanges()}(n,t.foldingRangesLimit):null!==(o=null===(r=t.fallbackRangeProvider)||void 0===r?void 0:r.compute(e))&&void 0!==o?o:null}))}},{key:"dispose",value:function(){this.disposables.dispose()}}]),e}();var c=function(){function e(t){(0,r.Z)(this,e),this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=t}return(0,o.Z)(e,[{key:"add",value:function(e,t,n,i){if(!(e>u.Xl||t>u.Xl)){var r=this._length;this._startIndexes[r]=e,this._endIndexes[r]=t,this._nestingLevels[r]=i,this._types[r]=n,this._length++,i<30&&(this._nestingLevelCounts[i]=(this._nestingLevelCounts[i]||0)+1)}}},{key:"toIndentRanges",value:function(){var e=this._foldingRangesLimit.limit;if(this._length<=e){this._foldingRangesLimit.update(this._length,!1);for(var t=new Uint32Array(this._length),n=new Uint32Array(this._length),i=0;i<this._length;i++)t[i]=this._startIndexes[i],n[i]=this._endIndexes[i];return new u.MN(t,n,this._types)}this._foldingRangesLimit.update(this._length,e);for(var r=0,o=this._nestingLevelCounts.length,s=0;s<this._nestingLevelCounts.length;s++){var a=this._nestingLevelCounts[s];if(a){if(a+r>e){o=s;break}r+=a}}for(var l=new Uint32Array(e),d=new Uint32Array(e),c=[],h=0,g=0;h<this._length;h++){var f=this._nestingLevels[h];(f<o||f===o&&r++<e)&&(l[g]=this._startIndexes[h],d[g]=this._endIndexes[h],c[g]=this._types[h],g++)}return new u.MN(l,d,c)}}]),e}()},36654:function(e,t,n){var i=n(15671),r=n(43144),o=n(60136),s=n(27277),a=n(39177),u=n(56499),l=n(96531),d=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,i.Z)(this,n),t.call(this,{id:"editor.action.fontZoomIn",label:l.NC("EditorFontZoomIn.label","Editor Font Zoom In"),alias:"Editor Font Zoom In",precondition:void 0})}return(0,r.Z)(n,[{key:"run",value:function(e,t){u.C.setZoomLevel(u.C.getZoomLevel()+1)}}]),n}(a.R6),c=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,i.Z)(this,n),t.call(this,{id:"editor.action.fontZoomOut",label:l.NC("EditorFontZoomOut.label","Editor Font Zoom Out"),alias:"Editor Font Zoom Out",precondition:void 0})}return(0,r.Z)(n,[{key:"run",value:function(e,t){u.C.setZoomLevel(u.C.getZoomLevel()-1)}}]),n}(a.R6),h=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,i.Z)(this,n),t.call(this,{id:"editor.action.fontZoomReset",label:l.NC("EditorFontZoomReset.label","Editor Font Zoom Reset"),alias:"Editor Font Zoom Reset",precondition:void 0})}return(0,r.Z)(n,[{key:"run",value:function(e,t){u.C.setZoomLevel(0)}}]),n}(a.R6);(0,a.Qr)(d),(0,a.Qr)(c),(0,a.Qr)(h)},92984:function(e,t,n){n.d(t,{Qq:function(){return O},Qs:function(){return H},Zg:function(){return I},x$:function(){return A},xC:function(){return E}});var i=n(29439),r=n(93433),o=n(74165),s=n(15671),a=n(43144),u=n(37762),l=n(10202),d=n(85509),c=n(24404),h=n(61002),g=n(79620),f=n(19980),v=n(91189),p=n(97638),m=n(43887),_=n(46061),y=n(39912),k=n(851),b=n(21864),C=n(42109),w=n(42832),x=n(32782),L=n(96531),N=n(13134),R=n(53071),Z=n(20893),M=n(69561),D=n(58312),S=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(t){o(t)}}function a(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};function I(e){if((e=e.filter((function(e){return e.range}))).length){for(var t=e[0].range,n=1;n<e.length;n++)t=k.e.plusRange(t,e[n].range);var i=t,r=i.startLineNumber,o=i.endLineNumber;r===o?1===e.length?(0,l.Z9)(L.NC("hint11","Made 1 formatting edit on line {0}",r)):(0,l.Z9)(L.NC("hintn1","Made {0} formatting edits on line {1}",e.length,r)):1===e.length?(0,l.Z9)(L.NC("hint1n","Made 1 formatting edit between lines {0} and {1}",r,o)):(0,l.Z9)(L.NC("hintnn","Made {0} formatting edits between lines {1} and {2}",e.length,r,o))}}function P(e,t,n){var i,r=[],o=new R.o,s=e.ordered(n),a=(0,u.Z)(s);try{for(a.s();!(i=a.n()).done;){var l=i.value;r.push(l),l.extensionId&&o.add(l.extensionId)}}catch(f){a.e(f)}finally{a.f()}var d,c=t.ordered(n),h=(0,u.Z)(c);try{var g=function(){var e=d.value;if(e.extensionId){if(o.has(e.extensionId))return 1;o.add(e.extensionId)}r.push({displayName:e.displayName,extensionId:e.extensionId,provideDocumentFormattingEdits:function(t,n,i){return e.provideDocumentRangeFormattingEdits(t,t.getFullModelRange(),n,i)}})};for(h.s();!(d=h.n()).done;)g()}catch(f){h.e(f)}finally{h.f()}return r}var E=function(){function e(){(0,s.Z)(this,e)}return(0,a.Z)(e,null,[{key:"setFormatterSelector",value:function(t){return{dispose:e._selectors.unshift(t)}}},{key:"select",value:function(t,n,i){return S(this,void 0,void 0,(0,o.Z)().mark((function r(){var s;return(0,o.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(0!==t.length){r.next=2;break}return r.abrupt("return",void 0);case 2:if(!(s=g.$.first(e._selectors))){r.next=7;break}return r.next=6,s(t,n,i);case 6:return r.abrupt("return",r.sent);case 7:return r.abrupt("return",void 0);case 8:case"end":return r.stop()}}),r)})))}}]),e}();function A(e,t,n,i,r,s){return S(this,void 0,void 0,(0,o.Z)().mark((function a(){var u,l,d,c,h,g;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return u=e.get(Z.TG),l=e.get(M.p),d=l.documentRangeFormattingEditProvider,c=(0,_.CL)(t)?t.getModel():t,h=d.ordered(c),o.next=6,E.select(h,c,i);case 6:if(!(g=o.sent)){o.next=11;break}return r.report(g),o.next=11,u.invokeFunction(T,g,t,n,s);case 11:case"end":return o.stop()}}),a)})))}function T(e,t,n,i,s){var a,l;return S(this,void 0,void 0,(0,o.Z)().mark((function c(){var h,g,f,v,p,y,w,L,N,R,Z,M,P,E,A,T,O,F,U,W,H,B,G,K,V,X,Q,j=this;return(0,o.Z)().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:h=e.get(C.p),g=e.get(D.VZ),(0,_.CL)(n)?(f=n.getModel(),v=new m.Dl(n,5,void 0,s)):(f=n,v=new m.YQ(n,s)),p=[],y=0,w=(0,u.Z)((0,d._2)(i).sort(k.e.compareRangesUsingStarts));try{for(w.s();!(L=w.n()).done;)N=L.value,y>0&&k.e.areIntersectingOrTouching(p[y-1],N)?p[y-1]=k.e.fromPositions(p[y-1].getStartPosition(),N.getEndPosition()):y=p.push(N)}catch(q){w.e(q)}finally{w.f()}if(R=function(e){return S(j,void 0,void 0,(0,o.Z)().mark((function n(){var i,r,s;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return g.trace("[format][provideDocumentRangeFormattingEdits] (request)",null===(i=t.extensionId)||void 0===i?void 0:i.value,e),n.next=3,t.provideDocumentRangeFormattingEdits(f,e,f.getFormattingOptions(),v.token);case 3:if(n.t0=n.sent,n.t0){n.next=6;break}n.t0=[];case 6:return s=n.t0,g.trace("[format][provideDocumentRangeFormattingEdits] (response)",null===(r=t.extensionId)||void 0===r?void 0:r.value,s),n.abrupt("return",s);case 9:case"end":return n.stop()}}),n)})))},Z=function(e,t){if(!e.length||!t.length)return!1;var n=e.reduce((function(e,t){return k.e.plusRange(e,t.range)}),e[0].range);if(!t.some((function(e){return k.e.intersectRanges(n,e.range)})))return!1;var i,r=(0,u.Z)(e);try{for(r.s();!(i=r.n()).done;){var o,s=i.value,a=(0,u.Z)(t);try{for(a.s();!(o=a.n()).done;){var l=o.value;if(k.e.intersectRanges(s.range,l.range))return!0}}catch(q){a.e(q)}finally{a.f()}}}catch(q){r.e(q)}finally{r.f()}return!1},M=[],P=[],c.prev=11,"function"!==typeof t.provideDocumentRangesFormattingEdits){c.next=24;break}return g.trace("[format][provideDocumentRangeFormattingEdits] (request)",null===(a=t.extensionId)||void 0===a?void 0:a.value,p),c.next=16,t.provideDocumentRangesFormattingEdits(f,p,f.getFormattingOptions(),v.token);case 16:if(c.t0=c.sent,c.t0){c.next=19;break}c.t0=[];case 19:E=c.t0,g.trace("[format][provideDocumentRangeFormattingEdits] (response)",null===(l=t.extensionId)||void 0===l?void 0:l.value,E),P.push(E),c.next=71;break;case 24:A=(0,u.Z)(p),c.prev=25,A.s();case 27:if((T=A.n()).done){c.next=38;break}if(O=T.value,!v.token.isCancellationRequested){c.next=31;break}return c.abrupt("return",!0);case 31:return c.t1=P,c.next=34,R(O);case 34:c.t2=c.sent,c.t1.push.call(c.t1,c.t2);case 36:c.next=27;break;case 38:c.next=43;break;case 40:c.prev=40,c.t3=c.catch(25),A.e(c.t3);case 43:return c.prev=43,A.f(),c.finish(43);case 46:F=0;case 47:if(!(F<p.length)){c.next=71;break}U=F+1;case 49:if(!(U<p.length)){c.next=68;break}if(!v.token.isCancellationRequested){c.next=52;break}return c.abrupt("return",!0);case 52:if(!Z(P[F],P[U])){c.next=65;break}return W=k.e.plusRange(p[F],p[U]),c.next=56,R(W);case 56:H=c.sent,p.splice(U,1),p.splice(F,1),p.push(W),P.splice(U,1),P.splice(F,1),P.push(H),F=0,U=0;case 65:++U,c.next=49;break;case 68:++F,c.next=47;break;case 71:B=0,G=P;case 72:if(!(B<G.length)){c.next=83;break}if(K=G[B],!v.token.isCancellationRequested){c.next=76;break}return c.abrupt("return",!0);case 76:return c.next=78,h.computeMoreMinimalEdits(f.uri,K);case 78:(V=c.sent)&&M.push.apply(M,(0,r.Z)(V));case 80:B++,c.next=72;break;case 83:return c.prev=83,v.dispose(),c.finish(83);case 86:if(0!==M.length){c.next=88;break}return c.abrupt("return",!1);case 88:return(0,_.CL)(n)?(x.V.execute(n,M,!0),I(M),n.revealPositionInCenterIfOutsideViewport(n.getPosition(),1)):(X=M[0].range,Q=new b.Y(X.startLineNumber,X.startColumn,X.endLineNumber,X.endColumn),f.pushEditOperations([Q],M.map((function(e){return{text:e.text,range:k.e.lift(e.range),forceMoveMarkers:!0}})),(function(e){var t,n=(0,u.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value.range;if(k.e.areIntersectingOrTouching(i,Q))return[new b.Y(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn)]}}catch(q){n.e(q)}finally{n.f()}return null}))),c.abrupt("return",!0);case 90:case"end":return c.stop()}}),c,null,[[11,,83,86],[25,40,43,46]])})))}function O(e,t,n,i,r){return S(this,void 0,void 0,(0,o.Z)().mark((function s(){var a,u,l,d,c;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return a=e.get(Z.TG),u=e.get(M.p),l=(0,_.CL)(t)?t.getModel():t,d=P(u.documentFormattingEditProvider,u.documentRangeFormattingEditProvider,l),o.next=6,E.select(d,l,n);case 6:if(!(c=o.sent)){o.next=11;break}return i.report(c),o.next=11,a.invokeFunction(F,c,t,n,r);case 11:case"end":return o.stop()}}),s)})))}function F(e,t,n,r,s){return S(this,void 0,void 0,(0,o.Z)().mark((function a(){var l,d,c,h,g,f,v,p,y;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return l=e.get(C.p),(0,_.CL)(n)?(d=n.getModel(),c=new m.Dl(n,5,void 0,s)):(d=n,c=new m.YQ(n,s)),o.prev=2,o.next=5,t.provideDocumentFormattingEdits(d,d.getFormattingOptions(),c.token);case 5:return g=o.sent,o.next=8,l.computeMoreMinimalEdits(d.uri,g);case 8:if(h=o.sent,!c.token.isCancellationRequested){o.next=11;break}return o.abrupt("return",!0);case 11:return o.prev=11,c.dispose(),o.finish(11);case 14:if(h&&0!==h.length){o.next=16;break}return o.abrupt("return",!1);case 16:return(0,_.CL)(n)?(x.V.execute(n,h,2!==r),2!==r&&(I(h),n.revealPositionInCenterIfOutsideViewport(n.getPosition(),1))):(f=h,v=(0,i.Z)(f,1),p=v[0].range,y=new b.Y(p.startLineNumber,p.startColumn,p.endLineNumber,p.endColumn),d.pushEditOperations([y],h.map((function(e){return{text:e.text,range:k.e.lift(e.range),forceMoveMarkers:!0}})),(function(e){var t,n=(0,u.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value.range;if(k.e.areIntersectingOrTouching(i,y))return[new b.Y(i.startLineNumber,i.startColumn,i.endLineNumber,i.endColumn)]}}catch(r){n.e(r)}finally{n.f()}return null}))),o.abrupt("return",!0);case 18:case"end":return o.stop()}}),a,null,[[2,,11,14]])})))}function U(e,t,n,i,r,s){return S(this,void 0,void 0,(0,o.Z)().mark((function a(){var l,c,g,f,v;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:l=t.documentRangeFormattingEditProvider.ordered(n),c=(0,u.Z)(l),o.prev=2,c.s();case 4:if((g=c.n()).done){o.next=15;break}return f=g.value,o.next=8,Promise.resolve(f.provideDocumentRangeFormattingEdits(n,i,r,s)).catch(h.Cp);case 8:if(v=o.sent,!(0,d.Of)(v)){o.next=13;break}return o.next=12,e.computeMoreMinimalEdits(n.uri,v);case 12:return o.abrupt("return",o.sent);case 13:o.next=4;break;case 15:o.next=20;break;case 17:o.prev=17,o.t0=o.catch(2),c.e(o.t0);case 20:return o.prev=20,c.f(),o.finish(20);case 23:return o.abrupt("return",void 0);case 24:case"end":return o.stop()}}),a,null,[[2,17,20,23]])})))}function W(e,t,n,i,r){return S(this,void 0,void 0,(0,o.Z)().mark((function s(){var a,l,c,g,f;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:a=P(t.documentFormattingEditProvider,t.documentRangeFormattingEditProvider,n),l=(0,u.Z)(a),o.prev=2,l.s();case 4:if((c=l.n()).done){o.next=15;break}return g=c.value,o.next=8,Promise.resolve(g.provideDocumentFormattingEdits(n,i,r)).catch(h.Cp);case 8:if(f=o.sent,!(0,d.Of)(f)){o.next=13;break}return o.next=12,e.computeMoreMinimalEdits(n.uri,f);case 12:return o.abrupt("return",o.sent);case 13:o.next=4;break;case 15:o.next=20;break;case 17:o.prev=17,o.t0=o.catch(2),l.e(o.t0);case 20:return o.prev=20,l.f(),o.finish(20);case 23:return o.abrupt("return",void 0);case 24:case"end":return o.stop()}}),s,null,[[2,17,20,23]])})))}function H(e,t,n,i,r,o,s){var a=t.onTypeFormattingEditProvider.ordered(n);return 0===a.length||a[0].autoFormatTriggerCharacters.indexOf(r)<0?Promise.resolve(void 0):Promise.resolve(a[0].provideOnTypeFormattingEdits(n,i,r,o,s)).catch(h.Cp).then((function(t){return e.computeMoreMinimalEdits(n.uri,t)}))}E._selectors=new f.S,N.P.registerCommand("_executeFormatRangeProvider",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return S(this,void 0,void 0,(0,o.Z)().mark((function t(){var i,r,s,a,u,l,d;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n[0],r=n[1],s=n[2],(0,v.p_)(p.o.isUri(i)),(0,v.p_)(k.e.isIRange(r)),a=e.get(w.S),u=e.get(C.p),l=e.get(M.p),t.next=8,a.createModelReference(i);case 8:return d=t.sent,t.prev=9,t.abrupt("return",U(u,l,d.object.textEditorModel,k.e.lift(r),s,c.T.None));case 11:return t.prev=11,d.dispose(),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[9,,11,14]])})))})),N.P.registerCommand("_executeFormatDocumentProvider",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return S(this,void 0,void 0,(0,o.Z)().mark((function t(){var i,r,s,a,u,l;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n[0],r=n[1],(0,v.p_)(p.o.isUri(i)),s=e.get(w.S),a=e.get(C.p),u=e.get(M.p),t.next=7,s.createModelReference(i);case 7:return l=t.sent,t.prev=8,t.abrupt("return",W(a,u,l.object.textEditorModel,r,c.T.None));case 10:return t.prev=10,l.dispose(),t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[8,,10,13]])})))})),N.P.registerCommand("_executeFormatOnTypeProvider",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return S(this,void 0,void 0,(0,o.Z)().mark((function t(){var i,r,s,a,u,l,d,h;return(0,o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n[0],r=n[1],s=n[2],a=n[3],(0,v.p_)(p.o.isUri(i)),(0,v.p_)(y.L.isIPosition(r)),(0,v.p_)("string"===typeof s),u=e.get(w.S),l=e.get(C.p),d=e.get(M.p),t.next=9,u.createModelReference(i);case 9:return h=t.sent,t.prev=10,t.abrupt("return",H(l,d,h.object.textEditorModel,y.L.lift(r),s,a,c.T.None));case 12:return t.prev=12,h.dispose(),t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[10,,12,15]])})))}))},8726:function(e,t,n){var i=n(74165),r=n(60136),o=n(27277),s=n(37762),a=n(29439),u=n(15671),l=n(43144),d=n(85509),c=n(24404),h=n(61002),g=n(84191),f=n(82927),v=n(39177),p=n(47454),m=n(50886),_=n(851),y=n(78656),k=n(42109),b=n(69561),C=n(92984),w=n(32782),x=n(96531),L=n(13134),N=n(24154),R=n(20893),Z=n(36892),M=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},D=function(e,t){return function(n,i){t(n,i,e)}},S=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(t){o(t)}}function a(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))},I=function(){function e(t,n,i){var r=this;(0,u.Z)(this,e),this._editor=t,this._languageFeaturesService=n,this._workerService=i,this._disposables=new f.SL,this._sessionDisposables=new f.SL,this._disposables.add(n.onTypeFormattingEditProvider.onDidChange(this._update,this)),this._disposables.add(t.onDidChangeModel((function(){return r._update()}))),this._disposables.add(t.onDidChangeModelLanguage((function(){return r._update()}))),this._disposables.add(t.onDidChangeConfiguration((function(e){e.hasChanged(54)&&r._update()}))),this._update()}return(0,l.Z)(e,[{key:"dispose",value:function(){this._disposables.dispose(),this._sessionDisposables.dispose()}},{key:"_update",value:function(){var e=this;if(this._sessionDisposables.clear(),this._editor.getOption(54)&&this._editor.hasModel()){var t=this._editor.getModel(),n=this._languageFeaturesService.onTypeFormattingEditProvider.ordered(t),i=(0,a.Z)(n,1)[0];if(i&&i.autoFormatTriggerCharacters){var r,o=new m.q,u=(0,s.Z)(i.autoFormatTriggerCharacters);try{for(u.s();!(r=u.n()).done;){var l=r.value;o.add(l.charCodeAt(0))}}catch(d){u.e(d)}finally{u.f()}this._sessionDisposables.add(this._editor.onDidType((function(t){var n=t.charCodeAt(t.length-1);o.has(n)&&e._trigger(String.fromCharCode(n))})))}}}},{key:"_trigger",value:function(e){var t=this;if(this._editor.hasModel()&&!(this._editor.getSelections().length>1)&&this._editor.getSelection().isEmpty()){var n=this._editor.getModel(),i=this._editor.getPosition(),r=new c.A,o=this._editor.onDidChangeModelContent((function(e){if(e.isFlush)return r.cancel(),void o.dispose();for(var t=0,n=e.changes.length;t<n;t++){if(e.changes[t].range.endLineNumber<=i.lineNumber)return r.cancel(),void o.dispose()}}));(0,C.Qs)(this._workerService,this._languageFeaturesService,n,i,e,n.getFormattingOptions(),r.token).then((function(e){r.token.isCancellationRequested||(0,d.Of)(e)&&(w.V.execute(t._editor,e,!0),(0,C.Zg)(e))})).finally((function(){o.dispose()}))}}}]),e}();I.ID="editor.contrib.autoFormat",I=M([D(1,b.p),D(2,k.p)],I);var P=function(){function e(t,n,i){var r=this;(0,u.Z)(this,e),this.editor=t,this._languageFeaturesService=n,this._instantiationService=i,this._callOnDispose=new f.SL,this._callOnModel=new f.SL,this._callOnDispose.add(t.onDidChangeConfiguration((function(){return r._update()}))),this._callOnDispose.add(t.onDidChangeModel((function(){return r._update()}))),this._callOnDispose.add(t.onDidChangeModelLanguage((function(){return r._update()}))),this._callOnDispose.add(n.documentRangeFormattingEditProvider.onDidChange(this._update,this))}return(0,l.Z)(e,[{key:"dispose",value:function(){this._callOnDispose.dispose(),this._callOnModel.dispose()}},{key:"_update",value:function(){var e=this;this._callOnModel.clear(),this.editor.getOption(53)&&this.editor.hasModel()&&this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste((function(t){var n=t.range;return e._trigger(n)})))}},{key:"_trigger",value:function(e){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(C.x$,this.editor,e,2,Z.Ex.None,c.T.None).catch(h.dL))}}]),e}();P.ID="editor.contrib.formatOnPaste",P=M([D(1,b.p),D(2,R.TG)],P);var E=function(e){(0,r.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,u.Z)(this,n),t.call(this,{id:"editor.action.formatDocument",label:x.NC("formatDocument.label","Format Document"),alias:"Format Document",precondition:N.Ao.and(y.u.notInCompositeEditor,y.u.writable,y.u.hasDocumentFormattingProvider),kbOpts:{kbExpr:y.u.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:"1_modification",order:1.3}})}return(0,l.Z)(n,[{key:"run",value:function(e,t){return S(this,void 0,void 0,(0,i.Z)().mark((function n(){var r,o;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.hasModel()){n.next=5;break}return r=e.get(R.TG),o=e.get(Z.ek),n.next=5,o.showWhile(r.invokeFunction(C.Qq,t,1,Z.Ex.None,c.T.None),250);case 5:case"end":return n.stop()}}),n)})))}}]),n}(v.R6),A=function(e){(0,r.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,u.Z)(this,n),t.call(this,{id:"editor.action.formatSelection",label:x.NC("formatSelection.label","Format Selection"),alias:"Format Selection",precondition:N.Ao.and(y.u.writable,y.u.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:y.u.editorTextFocus,primary:(0,g.gx)(2089,2084),weight:100},contextMenuOpts:{when:y.u.hasNonEmptySelection,group:"1_modification",order:1.31}})}return(0,l.Z)(n,[{key:"run",value:function(e,t){return S(this,void 0,void 0,(0,i.Z)().mark((function n(){var r,o,s,a;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.hasModel()){n.next=2;break}return n.abrupt("return");case 2:return r=e.get(R.TG),o=t.getModel(),s=t.getSelections().map((function(e){return e.isEmpty()?new _.e(e.startLineNumber,1,e.startLineNumber,o.getLineMaxColumn(e.startLineNumber)):e})),a=e.get(Z.ek),n.next=8,a.showWhile(r.invokeFunction(C.x$,t,s,1,Z.Ex.None,c.T.None),250);case 8:case"end":return n.stop()}}),n)})))}}]),n}(v.R6);(0,v._K)(I.ID,I,2),(0,v._K)(P.ID,P,2),(0,v.Qr)(E),(0,v.Qr)(A),L.P.registerCommand("editor.action.format",(function(e){return S(void 0,void 0,void 0,(0,i.Z)().mark((function t(){var n,r;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=e.get(p.$).getFocusedCodeEditor())&&n.hasModel()){t.next=3;break}return t.abrupt("return");case 3:if(r=e.get(L.H),!n.getSelection().isEmpty()){t.next=9;break}return t.next=7,r.executeCommand("editor.action.formatDocument");case 7:t.next=11;break;case 9:return t.next=11,r.executeCommand("editor.action.formatSelection");case 11:case"end":return t.stop()}}),t)})))}))},32782:function(e,t,n){n.d(t,{V:function(){return l}});var i=n(37762),r=n(15671),o=n(43144),s=n(72196),a=n(851),u=n(9538),l=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,null,[{key:"_handleEolEdits",value:function(e,t){var n,r=void 0,o=[],s=(0,i.Z)(t);try{for(s.s();!(n=s.n()).done;){var a=n.value;"number"===typeof a.eol&&(r=a.eol),a.range&&"string"===typeof a.text&&o.push(a)}}catch(u){s.e(u)}finally{s.f()}return"number"===typeof r&&e.hasModel()&&e.getModel().pushEOL(r),o}},{key:"_isFullModelReplaceEdit",value:function(e,t){if(!e.hasModel())return!1;var n=e.getModel(),i=n.validateRange(t.range);return n.getFullModelRange().equalsRange(i)}},{key:"execute",value:function(t,n,i){i&&t.pushUndoStop();var r=u.Z.capture(t),o=e._handleEolEdits(t,n);1===o.length&&e._isFullModelReplaceEdit(t,o[0])?t.executeEdits("formatEditsCommand",o.map((function(e){return s.h.replace(a.e.lift(e.range),e.text)}))):t.executeEdits("formatEditsCommand",o.map((function(e){return s.h.replaceMove(a.e.lift(e.range),e.text)}))),i&&t.pushUndoStop(),r.restoreRelativeVerticalPositionOfCursor(t)}}]),e}()},95705:function(e,t,n){n.d(t,{c:function(){return he},v:function(){return fe}});var i=n(60136),r=n(27277),o=n(74165),s=n(15671),a=n(43144),u=n(34922),l=n(82927),d=n(39177),c=n(47454),h=n(39912),g=n(851),f=n(78656),v=n(37762),p=n(85509),m=n(3318),_=n(19980),y=n(62428),k=n(97638),b=n(41043),C=n(20893),w=n(29941),x=n(57348),L=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},N=function(e,t){return function(n,i){t(n,i,e)}},R=(0,a.Z)((function e(t,n,i){(0,s.Z)(this,e),this.marker=t,this.index=n,this.total=i})),Z=function(){function e(t,n,i){var r=this;(0,s.Z)(this,e),this._markerService=n,this._configService=i,this._onDidChange=new m.Q5,this.onDidChange=this._onDidChange.event,this._dispoables=new l.SL,this._markers=[],this._nextIdx=-1,k.o.isUri(t)?this._resourceFilter=function(e){return e.toString()===t.toString()}:t&&(this._resourceFilter=t);var o=this._configService.getValue("problems.sortOrder"),a=function(e,t){var n=(0,y.qu)(e.resource.toString(),t.resource.toString());return 0===n&&(n="position"===o?g.e.compareRangesUsingStarts(e,t)||w.ZL.compare(e.severity,t.severity):w.ZL.compare(e.severity,t.severity)||g.e.compareRangesUsingStarts(e,t)),n},u=function(){r._markers=r._markerService.read({resource:k.o.isUri(t)?t:void 0,severities:w.ZL.Error|w.ZL.Warning|w.ZL.Info}),"function"===typeof t&&(r._markers=r._markers.filter((function(e){return r._resourceFilter(e.resource)}))),r._markers.sort(a)};u(),this._dispoables.add(n.onMarkerChanged((function(e){r._resourceFilter&&!e.some((function(e){return r._resourceFilter(e)}))||(u(),r._nextIdx=-1,r._onDidChange.fire())})))}return(0,a.Z)(e,[{key:"dispose",value:function(){this._dispoables.dispose(),this._onDidChange.dispose()}},{key:"matches",value:function(e){return!this._resourceFilter&&!e||!(!this._resourceFilter||!e)&&this._resourceFilter(e)}},{key:"selected",get:function(){var e=this._markers[this._nextIdx];return e&&new R(e,this._nextIdx+1,this._markers.length)}},{key:"_initIdx",value:function(e,t,n){var i=!1,r=this._markers.findIndex((function(t){return t.resource.toString()===e.uri.toString()}));r<0&&(r=(0,p.ry)(this._markers,{resource:e.uri},(function(e,t){return(0,y.qu)(e.resource.toString(),t.resource.toString())})))<0&&(r=~r);for(var o=r;o<this._markers.length;o++){var s=g.e.lift(this._markers[o]);if(s.isEmpty()){var a=e.getWordAtPosition(s.getStartPosition());a&&(s=new g.e(s.startLineNumber,a.startColumn,s.startLineNumber,a.endColumn))}if(t&&(s.containsPosition(t)||t.isBeforeOrEqual(s.getStartPosition()))){this._nextIdx=o,i=!0;break}if(this._markers[o].resource.toString()!==e.uri.toString())break}i||(this._nextIdx=n?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}},{key:"resetIndex",value:function(){this._nextIdx=-1}},{key:"move",value:function(e,t,n){if(0===this._markers.length)return!1;var i=this._nextIdx;return-1===this._nextIdx?this._initIdx(t,n,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),i!==this._nextIdx}},{key:"find",value:function(e,t){var n=this._markers.findIndex((function(t){return t.resource.toString()===e.toString()}));if(!(n<0))for(;n<this._markers.length;n++)if(g.e.containsPosition(this._markers[n],t))return new R(this._markers[n],n+1,this._markers.length)}}]),e}();Z=L([N(1,w.lT),N(2,x.Ui)],Z);var M=(0,C.yh)("IMarkerNavigationService"),D=function(){function e(t,n){(0,s.Z)(this,e),this._markerService=t,this._configService=n,this._provider=new _.S}return(0,a.Z)(e,[{key:"getMarkerList",value:function(e){var t,n=(0,v.Z)(this._provider);try{for(n.s();!(t=n.n()).done;){var i=t.value.getMarkerList(e);if(i)return i}}catch(r){n.e(r)}finally{n.f()}return new Z(e,this._markerService,this._configService)}}]),e}();D=L([N(0,w.lT),N(1,x.Ui)],D),(0,b.z)(M,D,1);var S=n(96531),I=n(54998),P=n(24154),E=n(47825),A=n(97326),T=n(11752),O=n(61120),F=n(39165),U=n(19285),W=n(96142),H=n(87558),B=n(7249),G=n(71586),K=n(36499),V=n(83561),X=n(17457),Q=n(35673),j=n(76634),q=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},z=function(e,t){return function(n,i){t(n,i,e)}},J=function(){function e(t,n,i,r,o){var a=this;(0,s.Z)(this,e),this._openerService=r,this._labelService=o,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new l.SL,this._editor=n;var u=document.createElement("div");u.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),u.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),u.appendChild(this._relatedBlock),this._disposables.add(F.addStandardDisposableListener(this._relatedBlock,"click",(function(e){e.preventDefault();var t=a._relatedDiagnostics.get(e.target);t&&i(t)}))),this._scrollable=new U.NB(u,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),t.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll((function(e){u.style.left="-".concat(e.scrollLeft,"px"),u.style.top="-".concat(e.scrollTop,"px")}))),this._disposables.add(this._scrollable)}return(0,a.Z)(e,[{key:"dispose",value:function(){(0,l.B9)(this._disposables)}},{key:"update",value:function(e){var t=this,n=e.source,i=e.message,r=e.relatedInformation,o=e.code,s=((null===n||void 0===n?void 0:n.length)||0)+2;o&&(s+="string"===typeof o?o.length:o.value.length);var a=(0,y.uq)(i);this._lines=a.length,this._longestLineLength=0;var u,l=(0,v.Z)(a);try{for(l.s();!(u=l.n()).done;){var d=u.value;this._longestLineLength=Math.max(d.length+s,this._longestLineLength)}}catch(S){l.e(S)}finally{l.f()}F.clearNode(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);var c,h=this._messageBlock,g=(0,v.Z)(a);try{for(g.s();!(c=g.n()).done;){var f=c.value;(h=document.createElement("div")).innerText=f,""===f&&(h.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(h)}}catch(S){g.e(S)}finally{g.f()}if(n||o){var m=document.createElement("span");if(m.classList.add("details"),h.appendChild(m),n){var _=document.createElement("span");_.innerText=n,_.classList.add("source"),m.appendChild(_)}if(o)if("string"===typeof o){var k=document.createElement("span");k.innerText="(".concat(o,")"),k.classList.add("code"),m.appendChild(k)}else{this._codeLink=F.$("a.code-link"),this._codeLink.setAttribute("href","".concat(o.target.toString())),this._codeLink.onclick=function(e){t._openerService.open(o.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()},F.append(this._codeLink,F.$("span")).innerText=o.value,m.appendChild(this._codeLink)}}if(F.clearNode(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),(0,p.Of)(r)){var b=this._relatedBlock.appendChild(document.createElement("div"));b.style.paddingTop="".concat(Math.floor(.66*this._editor.getOption(64)),"px"),this._lines+=1;var C,w=(0,v.Z)(r);try{for(w.s();!(C=w.n()).done;){var x=C.value,L=document.createElement("div"),N=document.createElement("a");N.classList.add("filename"),N.innerText="".concat(this._labelService.getUriBasenameLabel(x.resource),"(").concat(x.startLineNumber,", ").concat(x.startColumn,"): "),N.title=this._labelService.getUriLabel(x.resource),this._relatedDiagnostics.set(N,x);var R=document.createElement("span");R.innerText=x.message,L.appendChild(N),L.appendChild(R),this._lines+=1,b.appendChild(L)}}catch(S){w.e(S)}finally{w.f()}}var Z=this._editor.getOption(48),M=Math.ceil(Z.typicalFullwidthCharacterWidth*this._longestLineLength*.75),D=Z.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:M,scrollHeight:D})}},{key:"layout",value:function(e,t){this._scrollable.getDomNode().style.height="".concat(e,"px"),this._scrollable.getDomNode().style.width="".concat(t,"px"),this._scrollable.setScrollDimensions({width:t,height:e})}},{key:"getHeightInLines",value:function(){return Math.min(17,this._lines)}},{key:"getAriaLabel",value:function(e){var t="";switch(e.severity){case w.ZL.Error:t=S.NC("Error","Error");break;case w.ZL.Warning:t=S.NC("Warning","Warning");break;case w.ZL.Info:t=S.NC("Info","Info");break;case w.ZL.Hint:t=S.NC("Hint","Hint")}var n=S.NC("marker aria","{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn),i=this._editor.getModel();if(i&&e.startLineNumber<=i.getLineCount()&&e.startLineNumber>=1){var r=i.getLineContent(e.startLineNumber);n="".concat(r,", ").concat(n)}return n}}]),e}(),$=function(e){(0,i.Z)(n,e);var t=(0,r.Z)(n);function n(e,i,r,o,a,u,d){var c;return(0,s.Z)(this,n),(c=t.call(this,e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},a))._themeService=i,c._openerService=r,c._menuService=o,c._contextKeyService=u,c._labelService=d,c._callOnDispose=new l.SL,c._onDidSelectRelatedInformation=new m.Q5,c.onDidSelectRelatedInformation=c._onDidSelectRelatedInformation.event,c._severity=w.ZL.Warning,c._backgroundColor=W.Il.white,c._applyTheme(i.getColorTheme()),c._callOnDispose.add(i.onDidColorThemeChange(c._applyTheme.bind((0,A.Z)(c)))),c.create(),c}return(0,a.Z)(n,[{key:"_applyTheme",value:function(e){this._backgroundColor=e.getColor(ue);var t=ne,n=ie;this._severity===w.ZL.Warning?(t=re,n=oe):this._severity===w.ZL.Info&&(t=se,n=ae);var i=e.getColor(t),r=e.getColor(n);this.style({arrowColor:i,frameColor:i,headerBackgroundColor:r,primaryHeadingColor:e.getColor(B.IH),secondaryHeadingColor:e.getColor(B.R7)})}},{key:"_applyStyles",value:function(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),(0,T.Z)((0,O.Z)(n.prototype),"_applyStyles",this).call(this)}},{key:"dispose",value:function(){this._callOnDispose.dispose(),(0,T.Z)((0,O.Z)(n.prototype),"dispose",this).call(this)}},{key:"_fillHead",value:function(e){var t=this;(0,T.Z)((0,O.Z)(n.prototype),"_fillHead",this).call(this,e),this._disposables.add(this._actionbarWidget.actionRunner.onWillRun((function(e){return t.editor.focus()})));var i=[],r=this._menuService.createMenu(n.TitleMenu,this._contextKeyService);(0,G.vr)(r,void 0,i),this._actionbarWidget.push(i,{label:!1,icon:!0,index:0}),r.dispose()}},{key:"_fillTitleIcon",value:function(e){this._icon=F.append(e,F.$(""))}},{key:"_fillBody",value:function(e){var t=this;this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new J(this._container,this.editor,(function(e){return t._onDidSelectRelatedInformation.fire(e)}),this._openerService,this._labelService),this._disposables.add(this._message)}},{key:"show",value:function(){throw new Error("call showAtMarker")}},{key:"showAtMarker",value:function(e,t,i){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());var r=g.e.lift(e),o=this.editor.getPosition(),s=o&&r.containsPosition(o)?o:r.getStartPosition();(0,T.Z)((0,O.Z)(n.prototype),"show",this).call(this,s,this.computeRequiredHeight());var a=this.editor.getModel();if(a){var u=i>1?S.NC("problems","{0} of {1} problems",t,i):S.NC("change","{0} of {1} problem",t,i);this.setTitle((0,H.EZ)(a.uri),u)}this._icon.className="codicon ".concat(X.j.className(w.ZL.toSeverity(this._severity))),this.editor.revealPositionNearTop(s,0),this.editor.focus()}},{key:"updateMarker",value:function(e){this._container.classList.remove("stale"),this._message.update(e)}},{key:"showStale",value:function(){this._container.classList.add("stale"),this._relayout()}},{key:"_doLayoutBody",value:function(e,t){(0,T.Z)((0,O.Z)(n.prototype),"_doLayoutBody",this).call(this,e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height="".concat(e,"px")}},{key:"_onWidth",value:function(e){this._message.layout(this._heightInPixel,e)}},{key:"_relayout",value:function(){(0,T.Z)((0,O.Z)(n.prototype),"_relayout",this).call(this,this.computeRequiredHeight())}},{key:"computeRequiredHeight",value:function(){return 3+this._message.getHeightInLines()}}]),n}(B.vk);$.TitleMenu=new I.eH("gotoErrorTitleMenu"),$=q([z(1,j.XE),z(2,V.v4),z(3,I.co),z(4,C.TG),z(5,P.i6),z(6,K.e)],$);var Y=(0,Q.kwl)(Q.lXJ,Q.b6y),ee=(0,Q.kwl)(Q.uoC,Q.pW3),te=(0,Q.kwl)(Q.c63,Q.T83),ne=(0,Q.P6G)("editorMarkerNavigationError.background",{dark:Y,light:Y,hcDark:Q.lRK,hcLight:Q.lRK},S.NC("editorMarkerNavigationError","Editor marker navigation widget error color.")),ie=(0,Q.P6G)("editorMarkerNavigationError.headerBackground",{dark:(0,Q.ZnX)(ne,.1),light:(0,Q.ZnX)(ne,.1),hcDark:null,hcLight:null},S.NC("editorMarkerNavigationErrorHeaderBackground","Editor marker navigation widget error heading background.")),re=(0,Q.P6G)("editorMarkerNavigationWarning.background",{dark:ee,light:ee,hcDark:Q.lRK,hcLight:Q.lRK},S.NC("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),oe=(0,Q.P6G)("editorMarkerNavigationWarning.headerBackground",{dark:(0,Q.ZnX)(re,.1),light:(0,Q.ZnX)(re,.1),hcDark:"#0C141F",hcLight:(0,Q.ZnX)(re,.2)},S.NC("editorMarkerNavigationWarningBackground","Editor marker navigation widget warning heading background.")),se=(0,Q.P6G)("editorMarkerNavigationInfo.background",{dark:te,light:te,hcDark:Q.lRK,hcLight:Q.lRK},S.NC("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),ae=(0,Q.P6G)("editorMarkerNavigationInfo.headerBackground",{dark:(0,Q.ZnX)(se,.1),light:(0,Q.ZnX)(se,.1),hcDark:null,hcLight:null},S.NC("editorMarkerNavigationInfoHeaderBackground","Editor marker navigation widget info heading background.")),ue=(0,Q.P6G)("editorMarkerNavigation.background",{dark:Q.cvW,light:Q.cvW,hcDark:Q.cvW,hcLight:Q.cvW},S.NC("editorMarkerNavigationBackground","Editor marker navigation widget background.")),le=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},de=function(e,t){return function(n,i){t(n,i,e)}},ce=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(t){o(t)}}function a(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))},he=function(){function e(t,n,i,r,o){(0,s.Z)(this,e),this._markerNavigationService=n,this._contextKeyService=i,this._editorService=r,this._instantiationService=o,this._sessionDispoables=new l.SL,this._editor=t,this._widgetVisible=_e.bindTo(this._contextKeyService)}return(0,a.Z)(e,[{key:"dispose",value:function(){this._cleanUp(),this._sessionDispoables.dispose()}},{key:"_cleanUp",value:function(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}},{key:"_getOrCreateModel",value:function(e){var t=this;if(this._model&&this._model.matches(e))return this._model;var n=!1;return this._model&&(n=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),n&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance($,this._editor),this._widget.onDidClose((function(){return t.close()}),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition((function(e){var n,i,r;(null===(n=t._model)||void 0===n?void 0:n.selected)&&g.e.containsPosition(null===(i=t._model)||void 0===i?void 0:i.selected.marker,e.position)||null===(r=t._model)||void 0===r||r.resetIndex()}))),this._sessionDispoables.add(this._model.onDidChange((function(){if(t._widget&&t._widget.position&&t._model){var e=t._model.find(t._editor.getModel().uri,t._widget.position);e?t._widget.updateMarker(e.marker):t._widget.showStale()}}))),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation((function(e){t._editorService.openCodeEditor({resource:e.resource,options:{pinned:!0,revealIfOpened:!0,selection:g.e.lift(e).collapseToStart()}},t._editor),t.close(!1)}))),this._sessionDispoables.add(this._editor.onDidChangeModel((function(){return t._cleanUp()}))),this._model}},{key:"close",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._cleanUp(),e&&this._editor.focus()}},{key:"showAtMarker",value:function(e){if(this._editor.hasModel()){var t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new h.L(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}},{key:"nagivate",value:function(t,n){var i,r;return ce(this,void 0,void 0,(0,o.Z)().mark((function s(){var a,u;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!this._editor.hasModel()){o.next=14;break}if((a=this._getOrCreateModel(n?void 0:this._editor.getModel().uri)).move(t,this._editor.getModel(),this._editor.getPosition()),a.selected){o.next=5;break}return o.abrupt("return");case 5:if(a.selected.marker.resource.toString()===this._editor.getModel().uri.toString()){o.next=13;break}return this._cleanUp(),o.next=9,this._editorService.openCodeEditor({resource:a.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:a.selected.marker}},this._editor);case 9:(u=o.sent)&&(null===(i=e.get(u))||void 0===i||i.close(),null===(r=e.get(u))||void 0===r||r.nagivate(t,n)),o.next=14;break;case 13:this._widget.showAtMarker(a.selected.marker,a.selected.index,a.selected.total);case 14:case"end":return o.stop()}}),s,this)})))}}],[{key:"get",value:function(t){return t.getContribution(e.ID)}}]),e}();he.ID="editor.contrib.markerController",he=le([de(1,M),de(2,P.i6),de(3,c.$),de(4,C.TG)],he);var ge=function(e){(0,i.Z)(n,e);var t=(0,r.Z)(n);function n(e,i,r){var o;return(0,s.Z)(this,n),(o=t.call(this,r))._next=e,o._multiFile=i,o}return(0,a.Z)(n,[{key:"run",value:function(e,t){var n;return ce(this,void 0,void 0,(0,o.Z)().mark((function e(){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.hasModel()&&(null===(n=he.get(t))||void 0===n||n.nagivate(this._next,this._multiFile));case 1:case"end":return e.stop()}}),e,this)})))}}]),n}(d.R6),fe=function(e){(0,i.Z)(n,e);var t=(0,r.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,!0,!1,{id:n.ID,label:n.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:f.u.focus,primary:578,weight:100},menuOpts:{menuId:$.TitleMenu,title:n.LABEL,icon:(0,E.q5)("marker-navigation-next",u.l.arrowDown,S.NC("nextMarkerIcon","Icon for goto next marker.")),group:"navigation",order:1}})}return(0,a.Z)(n)}(ge);fe.ID="editor.action.marker.next",fe.LABEL=S.NC("markerAction.next.label","Go to Next Problem (Error, Warning, Info)");var ve=function(e){(0,i.Z)(n,e);var t=(0,r.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,!1,!1,{id:n.ID,label:n.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:f.u.focus,primary:1602,weight:100},menuOpts:{menuId:$.TitleMenu,title:n.LABEL,icon:(0,E.q5)("marker-navigation-previous",u.l.arrowUp,S.NC("previousMarkerIcon","Icon for goto previous marker.")),group:"navigation",order:2}})}return(0,a.Z)(n)}(ge);ve.ID="editor.action.marker.prev",ve.LABEL=S.NC("markerAction.previous.label","Go to Previous Problem (Error, Warning, Info)");var pe=function(e){(0,i.Z)(n,e);var t=(0,r.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,!0,!0,{id:"editor.action.marker.nextInFiles",label:S.NC("markerAction.nextInFiles.label","Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:f.u.focus,primary:66,weight:100},menuOpts:{menuId:I.eH.MenubarGoMenu,title:S.NC({key:"miGotoNextProblem",comment:["&& denotes a mnemonic"]},"Next &&Problem"),group:"6_problem_nav",order:1}})}return(0,a.Z)(n)}(ge),me=function(e){(0,i.Z)(n,e);var t=(0,r.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,!1,!0,{id:"editor.action.marker.prevInFiles",label:S.NC("markerAction.previousInFiles.label","Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:f.u.focus,primary:1090,weight:100},menuOpts:{menuId:I.eH.MenubarGoMenu,title:S.NC({key:"miGotoPreviousProblem",comment:["&& denotes a mnemonic"]},"Previous &&Problem"),group:"6_problem_nav",order:2}})}return(0,a.Z)(n)}(ge);(0,d._K)(he.ID,he,4),(0,d.Qr)(fe),(0,d.Qr)(ve),(0,d.Qr)(pe),(0,d.Qr)(me);var _e=new P.uy("markersNavigationVisible",!1),ye=d._l.bindToContribution(he.get);(0,d.fK)(new ye({id:"closeMarkersNavigation",precondition:_e,handler:function(e){return e.close()},kbOpts:{weight:150,kbExpr:f.u.focus,primary:9,secondary:[1033]}}))},79005:function(e,t,n){n.d(t,{BT:function(){return ce},Bj:function(){return de},_k:function(){return le}});var i=n(11752),r=n(61120),o=n(37762),s=n(74165),a=n(97326),u=n(60136),l=n(27277),d=n(15671),c=n(43144),h=n(34654),g=n(10202),f=n(1670),v=n(84191),p=n(37858),m=n(91189),_=n(97638),y=n(43887),k=n(46061),b=n(39177),C=n(47454),w=n(88424),x=n(39912),L=n(851),N=n(78656),R=n(33752),Z=n(24311),M=n(21164),D=n(3318),S=n(82927),I=n(87558),P=n(96531),E=n(24154),A=n(41043),T=n(20893),O=n(94341),F=n(74546),U=n(8439),W=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},H=function(e,t){return function(n,i){t(n,i,e)}},B=new E.uy("hasSymbols",!1,(0,P.NC)("hasSymbols","Whether there are symbol locations that can be navigated via keyboard-only.")),G=(0,T.yh)("ISymbolNavigationService"),K=function(){function e(t,n,i,r){(0,d.Z)(this,e),this._editorService=n,this._notificationService=i,this._keybindingService=r,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=B.bindTo(t)}return(0,c.Z)(e,[{key:"reset",value:function(){var e,t;this._ctxHasSymbols.reset(),null===(e=this._currentState)||void 0===e||e.dispose(),null===(t=this._currentMessage)||void 0===t||t.dispose(),this._currentModel=void 0,this._currentIdx=-1}},{key:"put",value:function(e){var t=this,n=e.parent.parent;if(n.references.length<=1)this.reset();else{this._currentModel=n,this._currentIdx=n.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();var i=new V(this._editorService),r=i.onDidChange((function(e){if(!t._ignoreEditorChange){var i=t._editorService.getActiveCodeEditor();if(i){var r=i.getModel(),s=i.getPosition();if(r&&s){var a,u=!1,l=!1,d=(0,o.Z)(n.references);try{for(d.s();!(a=d.n()).done;){var c=a.value;if((0,I.Xy)(c.uri,r.uri))u=!0,l=l||L.e.containsPosition(c.range,s);else if(u)break}}catch(h){d.e(h)}finally{d.f()}u&&l||t.reset()}}}}));this._currentState=(0,S.F8)(i,r)}}},{key:"revealNext",value:function(e){var t=this;if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;var n=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:n.uri,options:{selection:L.e.collapseToStart(n.range),selectionRevealType:3}},e).finally((function(){t._ignoreEditorChange=!1}))}},{key:"_showMessage",value:function(){var e;null===(e=this._currentMessage)||void 0===e||e.dispose();var t=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),n=t?(0,P.NC)("location.kb","Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,t.getLabel()):(0,P.NC)("location","Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(n)}}]),e}();K=W([H(0,E.i6),H(1,C.$),H(2,U.lT),H(3,O.d)],K),(0,A.z)(G,K,1),(0,b.fK)(new(function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.call(this,{id:"editor.gotoNextSymbolFromResult",precondition:B,kbOpts:{weight:100,primary:70}})}return(0,c.Z)(n,[{key:"runEditorCommand",value:function(e,t){return e.get(G).revealNext(t)}}]),n}(b._l))),F.W.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:B,primary:9,handler:function(e){e.get(G).reset()}});var V=function(){function e(t){(0,d.Z)(this,e),this._listener=new Map,this._disposables=new S.SL,this._onDidChange=new D.Q5,this.onDidChange=this._onDidChange.event,this._disposables.add(t.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(t.onCodeEditorAdd(this._onDidAddEditor,this)),t.listCodeEditors().forEach(this._onDidAddEditor,this)}return(0,c.Z)(e,[{key:"dispose",value:function(){this._disposables.dispose(),this._onDidChange.dispose(),(0,S.B9)(this._listener.values())}},{key:"_onDidAddEditor",value:function(e){var t=this;this._listener.set(e,(0,S.F8)(e.onDidChangeCursorPosition((function(n){return t._onDidChange.fire({editor:e})})),e.onDidChangeModelContent((function(n){return t._onDidChange.fire({editor:e})}))))}},{key:"_onDidRemoveEditor",value:function(e){var t;null===(t=this._listener.get(e))||void 0===t||t.dispose(),this._listener.delete(e)}}]),e}();V=W([H(0,C.$)],V);var X,Q,j,q,z,J,$,Y,ee=n(90743),te=n(7249),ne=n(54998),ie=n(13134),re=n(36892),oe=n(49223),se=n(69561),ae=n(79620),ue=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(t){o(t)}}function a(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};ne.BH.appendMenuItem(ne.eH.EditorContext,{submenu:ne.eH.EditorContextPeek,title:P.NC("peek.submenu","Peek"),group:"navigation",order:100});var le=function(){function e(t,n){(0,d.Z)(this,e),this.model=t,this.position=n}return(0,c.Z)(e,null,[{key:"is",value:function(t){return!(!t||"object"!==typeof t)&&(t instanceof e||!(!x.L.isIPosition(t.position)||!t.model))}}]),e}(),de=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(e,i){var r;return(0,d.Z)(this,n),(r=t.call(this,n._patchConfig(i))).configuration=e,n._allSymbolNavigationCommands.set(i.id,(0,a.Z)(r)),r}return(0,c.Z)(n,[{key:"runEditorCommand",value:function(e,t,i,r){var o=this;if(!t.hasModel())return Promise.resolve(void 0);var a=e.get(U.lT),u=e.get(C.$),l=e.get(re.ek),d=e.get(G),c=e.get(se.p),h=e.get(T.TG),v=t.getModel(),p=t.getPosition(),m=le.is(i)?i:new le(v,p),_=new y.Dl(t,5),k=(0,f.eP)(this._getLocationModel(c,m.model,m.position,_.token),_.token).then((function(e){return ue(o,void 0,void 0,(0,s.Z)().mark((function o(){var a,l,c,f,m,y=this;return(0,s.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(e&&!_.token.isCancellationRequested){o.next=2;break}return o.abrupt("return");case 2:if((0,g.Z9)(e.ariaMessage),e.referenceAt(v.uri,p)&&(c=this._getAlternativeCommand(t),!n._activeAlternativeCommands.has(c)&&n._allSymbolNavigationCommands.has(c)&&(l=n._allSymbolNavigationCommands.get(c))),0!==(f=e.references.length)){o.next=9;break}this.configuration.muteMessage||(m=v.getWordAtPosition(p),null===(a=ee.O.get(t))||void 0===a||a.showMessage(this._getNoResultFoundMessage(m),p)),o.next=15;break;case 9:if(1!==f||!l){o.next=14;break}n._activeAlternativeCommands.add(this.desc.id),h.invokeFunction((function(e){return l.runEditorCommand(e,t,i,r).finally((function(){n._activeAlternativeCommands.delete(y.desc.id)}))})),o.next=15;break;case 14:return o.abrupt("return",this._onResult(u,d,t,e,r));case 15:case"end":return o.stop()}}),o,this)})))}),(function(e){a.error(e)})).finally((function(){_.dispose()}));return l.showWhile(k,250),k}},{key:"_onResult",value:function(e,t,n,i,r){return ue(this,void 0,void 0,(0,s.Z)().mark((function o(){var a,u,l,d;return(0,s.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(a=this._getGoToPreference(n),n instanceof w.H||!(this.configuration.openInPeek||"peek"===a&&i.references.length>1)){o.next=5;break}this._openInPeek(n,i,r),o.next=12;break;case 5:return u=i.firstReference(),l=i.references.length>1&&"gotoAndPeek"===a,o.next=9,this._openReference(n,e,u,this.configuration.openToSide,!l);case 9:d=o.sent,l&&d?this._openInPeek(d,i,r):i.dispose(),"goto"===a&&t.put(u);case 12:case"end":return o.stop()}}),o,this)})))}},{key:"_openReference",value:function(e,t,n,i,r){return ue(this,void 0,void 0,(0,s.Z)().mark((function o(){var a,u,l,d;return(0,s.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(a=void 0,(0,R.vx)(n)&&(a=n.targetSelectionRange),a||(a=n.range),a){o.next=5;break}return o.abrupt("return",void 0);case 5:return o.next=7,t.openCodeEditor({resource:n.uri,options:{selection:L.e.collapseToStart(a),selectionRevealType:3,selectionSource:"code.jump"}},e,i);case 7:if(u=o.sent){o.next=10;break}return o.abrupt("return",void 0);case 10:return r&&(l=u.getModel(),d=u.createDecorationsCollection([{range:a,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]),setTimeout((function(){u.getModel()===l&&d.clear()}),350)),o.abrupt("return",u);case 12:case"end":return o.stop()}}),o)})))}},{key:"_openInPeek",value:function(e,t,n){var i=Z.J.get(e);i&&e.hasModel()?i.toggleWidget(null!==n&&void 0!==n?n:e.getSelection(),(0,f.PG)((function(e){return Promise.resolve(t)})),this.configuration.openInPeek):t.dispose()}}],[{key:"all",value:function(){return n._allSymbolNavigationCommands.values()}},{key:"_patchConfig",value:function(e){var t=Object.assign(Object.assign({},e),{f1:!0});if(t.menu){var n,i=(0,o.Z)(ae.$.wrap(t.menu));try{for(i.s();!(n=i.n()).done;){var r=n.value;r.id!==ne.eH.EditorContext&&r.id!==ne.eH.EditorContextPeek||(r.when=E.Ao.and(e.precondition,r.when))}}catch(s){i.e(s)}finally{i.f()}}return t}}]),n}(b.x1);de._allSymbolNavigationCommands=new Map,de._activeAlternativeCommands=new Set;var ce=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"_getLocationModel",value:function(e,t,n,i){return ue(this,void 0,void 0,(0,s.Z)().mark((function r(){return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=M.oQ,r.next=3,(0,oe.nD)(e.definitionProvider,t,n,i);case 3:return r.t1=r.sent,r.t2=P.NC("def.title","Definitions"),r.abrupt("return",new r.t0(r.t1,r.t2));case 6:case"end":return r.stop()}}),r)})))}},{key:"_getNoResultFoundMessage",value:function(e){return e&&e.word?P.NC("noResultWord","No definition found for '{0}'",e.word):P.NC("generic.noResults","No definition found")}},{key:"_getAlternativeCommand",value:function(e){return e.getOption(56).alternativeDefinitionCommand}},{key:"_getGoToPreference",value:function(e){return e.getOption(56).multipleDefinitions}}]),n}(de),he=p.$L&&!(0,h.isStandalone)()?2118:70;(0,ne.r1)(((X=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,d.Z)(this,n),e=t.call(this,{openToSide:!1,openInPeek:!1,muteMessage:!1},{id:n.id,title:{value:P.NC("actions.goToDecl.label","Go to Definition"),original:"Go to Definition",mnemonicTitle:P.NC({key:"miGotoDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Definition")},precondition:E.Ao.and(N.u.hasDefinitionProvider,N.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:N.u.editorTextFocus,primary:he,weight:100},menu:[{id:ne.eH.EditorContext,group:"navigation",order:1.1},{id:ne.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:2}]}),ie.P.registerCommandAlias("editor.action.goToDeclaration",n.id),e}return(0,c.Z)(n)}(ce)).id="editor.action.revealDefinition",X)),(0,ne.r1)(((Q=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,d.Z)(this,n),e=t.call(this,{openToSide:!0,openInPeek:!1,muteMessage:!1},{id:n.id,title:{value:P.NC("actions.goToDeclToSide.label","Open Definition to the Side"),original:"Open Definition to the Side"},precondition:E.Ao.and(N.u.hasDefinitionProvider,N.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:N.u.editorTextFocus,primary:(0,v.gx)(2089,he),weight:100}}),ie.P.registerCommandAlias("editor.action.openDeclarationToTheSide",n.id),e}return(0,c.Z)(n)}(ce)).id="editor.action.revealDefinitionAside",Q)),(0,ne.r1)(((j=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,d.Z)(this,n),e=t.call(this,{openToSide:!1,openInPeek:!0,muteMessage:!1},{id:n.id,title:{value:P.NC("actions.previewDecl.label","Peek Definition"),original:"Peek Definition"},precondition:E.Ao.and(N.u.hasDefinitionProvider,te.Jy.notInPeekEditor,N.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:N.u.editorTextFocus,primary:582,linux:{primary:3140},weight:100},menu:{id:ne.eH.EditorContextPeek,group:"peek",order:2}}),ie.P.registerCommandAlias("editor.action.previewDeclaration",n.id),e}return(0,c.Z)(n)}(ce)).id="editor.action.peekDefinition",j));var ge=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"_getLocationModel",value:function(e,t,n,i){return ue(this,void 0,void 0,(0,s.Z)().mark((function r(){return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=M.oQ,r.next=3,(0,oe.zq)(e.declarationProvider,t,n,i);case 3:return r.t1=r.sent,r.t2=P.NC("decl.title","Declarations"),r.abrupt("return",new r.t0(r.t1,r.t2));case 6:case"end":return r.stop()}}),r)})))}},{key:"_getNoResultFoundMessage",value:function(e){return e&&e.word?P.NC("decl.noResultWord","No declaration found for '{0}'",e.word):P.NC("decl.generic.noResults","No declaration found")}},{key:"_getAlternativeCommand",value:function(e){return e.getOption(56).alternativeDeclarationCommand}},{key:"_getGoToPreference",value:function(e){return e.getOption(56).multipleDeclarations}}]),n}(de);(0,ne.r1)(((q=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.call(this,{openToSide:!1,openInPeek:!1,muteMessage:!1},{id:n.id,title:{value:P.NC("actions.goToDeclaration.label","Go to Declaration"),original:"Go to Declaration",mnemonicTitle:P.NC({key:"miGotoDeclaration",comment:["&& denotes a mnemonic"]},"Go to &&Declaration")},precondition:E.Ao.and(N.u.hasDeclarationProvider,N.u.isInWalkThroughSnippet.toNegated()),menu:[{id:ne.eH.EditorContext,group:"navigation",order:1.3},{id:ne.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}return(0,c.Z)(n,[{key:"_getNoResultFoundMessage",value:function(e){return e&&e.word?P.NC("decl.noResultWord","No declaration found for '{0}'",e.word):P.NC("decl.generic.noResults","No declaration found")}}]),n}(ge)).id="editor.action.revealDeclaration",q)),(0,ne.r1)(function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.call(this,{openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",title:{value:P.NC("actions.peekDecl.label","Peek Declaration"),original:"Peek Declaration"},precondition:E.Ao.and(N.u.hasDeclarationProvider,te.Jy.notInPeekEditor,N.u.isInWalkThroughSnippet.toNegated()),menu:{id:ne.eH.EditorContextPeek,group:"peek",order:3}})}return(0,c.Z)(n)}(ge));var fe=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"_getLocationModel",value:function(e,t,n,i){return ue(this,void 0,void 0,(0,s.Z)().mark((function r(){return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=M.oQ,r.next=3,(0,oe.L3)(e.typeDefinitionProvider,t,n,i);case 3:return r.t1=r.sent,r.t2=P.NC("typedef.title","Type Definitions"),r.abrupt("return",new r.t0(r.t1,r.t2));case 6:case"end":return r.stop()}}),r)})))}},{key:"_getNoResultFoundMessage",value:function(e){return e&&e.word?P.NC("goToTypeDefinition.noResultWord","No type definition found for '{0}'",e.word):P.NC("goToTypeDefinition.generic.noResults","No type definition found")}},{key:"_getAlternativeCommand",value:function(e){return e.getOption(56).alternativeTypeDefinitionCommand}},{key:"_getGoToPreference",value:function(e){return e.getOption(56).multipleTypeDefinitions}}]),n}(de);(0,ne.r1)(((z=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.call(this,{openToSide:!1,openInPeek:!1,muteMessage:!1},{id:n.ID,title:{value:P.NC("actions.goToTypeDefinition.label","Go to Type Definition"),original:"Go to Type Definition",mnemonicTitle:P.NC({key:"miGotoTypeDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Type Definition")},precondition:E.Ao.and(N.u.hasTypeDefinitionProvider,N.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:N.u.editorTextFocus,primary:0,weight:100},menu:[{id:ne.eH.EditorContext,group:"navigation",order:1.4},{id:ne.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}return(0,c.Z)(n)}(fe)).ID="editor.action.goToTypeDefinition",z)),(0,ne.r1)(((J=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.call(this,{openToSide:!1,openInPeek:!0,muteMessage:!1},{id:n.ID,title:{value:P.NC("actions.peekTypeDefinition.label","Peek Type Definition"),original:"Peek Type Definition"},precondition:E.Ao.and(N.u.hasTypeDefinitionProvider,te.Jy.notInPeekEditor,N.u.isInWalkThroughSnippet.toNegated()),menu:{id:ne.eH.EditorContextPeek,group:"peek",order:4}})}return(0,c.Z)(n)}(fe)).ID="editor.action.peekTypeDefinition",J));var ve=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"_getLocationModel",value:function(e,t,n,i){return ue(this,void 0,void 0,(0,s.Z)().mark((function r(){return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=M.oQ,r.next=3,(0,oe.f4)(e.implementationProvider,t,n,i);case 3:return r.t1=r.sent,r.t2=P.NC("impl.title","Implementations"),r.abrupt("return",new r.t0(r.t1,r.t2));case 6:case"end":return r.stop()}}),r)})))}},{key:"_getNoResultFoundMessage",value:function(e){return e&&e.word?P.NC("goToImplementation.noResultWord","No implementation found for '{0}'",e.word):P.NC("goToImplementation.generic.noResults","No implementation found")}},{key:"_getAlternativeCommand",value:function(e){return e.getOption(56).alternativeImplementationCommand}},{key:"_getGoToPreference",value:function(e){return e.getOption(56).multipleImplementations}}]),n}(de);(0,ne.r1)((($=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.call(this,{openToSide:!1,openInPeek:!1,muteMessage:!1},{id:n.ID,title:{value:P.NC("actions.goToImplementation.label","Go to Implementations"),original:"Go to Implementations",mnemonicTitle:P.NC({key:"miGotoImplementation",comment:["&& denotes a mnemonic"]},"Go to &&Implementations")},precondition:E.Ao.and(N.u.hasImplementationProvider,N.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:N.u.editorTextFocus,primary:2118,weight:100},menu:[{id:ne.eH.EditorContext,group:"navigation",order:1.45},{id:ne.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:4}]})}return(0,c.Z)(n)}(ve)).ID="editor.action.goToImplementation",$)),(0,ne.r1)(((Y=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.call(this,{openToSide:!1,openInPeek:!0,muteMessage:!1},{id:n.ID,title:{value:P.NC("actions.peekImplementation.label","Peek Implementations"),original:"Peek Implementations"},precondition:E.Ao.and(N.u.hasImplementationProvider,te.Jy.notInPeekEditor,N.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:N.u.editorTextFocus,primary:3142,weight:100},menu:{id:ne.eH.EditorContextPeek,group:"peek",order:5}})}return(0,c.Z)(n)}(ve)).ID="editor.action.peekImplementation",Y));var pe=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"_getNoResultFoundMessage",value:function(e){return e?P.NC("references.no","No references found for '{0}'",e.word):P.NC("references.noGeneric","No references found")}},{key:"_getAlternativeCommand",value:function(e){return e.getOption(56).alternativeReferenceCommand}},{key:"_getGoToPreference",value:function(e){return e.getOption(56).multipleReferences}}]),n}(de);(0,ne.r1)(function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.call(this,{openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",title:{value:P.NC("goToReferences.label","Go to References"),original:"Go to References",mnemonicTitle:P.NC({key:"miGotoReference",comment:["&& denotes a mnemonic"]},"Go to &&References")},precondition:E.Ao.and(N.u.hasReferenceProvider,te.Jy.notInPeekEditor,N.u.isInWalkThroughSnippet.toNegated()),keybinding:{when:N.u.editorTextFocus,primary:1094,weight:100},menu:[{id:ne.eH.EditorContext,group:"navigation",order:1.45},{id:ne.eH.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:5}]})}return(0,c.Z)(n,[{key:"_getLocationModel",value:function(e,t,n,i){return ue(this,void 0,void 0,(0,s.Z)().mark((function r(){return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=M.oQ,r.next=3,(0,oe.aA)(e.referenceProvider,t,n,!0,i);case 3:return r.t1=r.sent,r.t2=P.NC("ref.title","References"),r.abrupt("return",new r.t0(r.t1,r.t2));case 6:case"end":return r.stop()}}),r)})))}}]),n}(pe)),(0,ne.r1)(function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.call(this,{openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",title:{value:P.NC("references.action.label","Peek References"),original:"Peek References"},precondition:E.Ao.and(N.u.hasReferenceProvider,te.Jy.notInPeekEditor,N.u.isInWalkThroughSnippet.toNegated()),menu:{id:ne.eH.EditorContextPeek,group:"peek",order:6}})}return(0,c.Z)(n,[{key:"_getLocationModel",value:function(e,t,n,i){return ue(this,void 0,void 0,(0,s.Z)().mark((function r(){return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=M.oQ,r.next=3,(0,oe.aA)(e.referenceProvider,t,n,!1,i);case 3:return r.t1=r.sent,r.t2=P.NC("ref.title","References"),r.abrupt("return",new r.t0(r.t1,r.t2));case 6:case"end":return r.stop()}}),r)})))}}]),n}(pe));var me=function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(e,i,r){var o;return(0,d.Z)(this,n),(o=t.call(this,e,{id:"editor.action.goToLocation",title:{value:P.NC("label.generic","Go to Any Symbol"),original:"Go to Any Symbol"},precondition:E.Ao.and(te.Jy.notInPeekEditor,N.u.isInWalkThroughSnippet.toNegated())}))._references=i,o._gotoMultipleBehaviour=r,o}return(0,c.Z)(n,[{key:"_getLocationModel",value:function(e,t,n,i){return ue(this,void 0,void 0,(0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new M.oQ(this._references,P.NC("generic.title","Locations")));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"_getNoResultFoundMessage",value:function(e){return e&&P.NC("generic.noResult","No results for '{0}'",e.word)||""}},{key:"_getGoToPreference",value:function(e){var t;return null!==(t=this._gotoMultipleBehaviour)&&void 0!==t?t:e.getOption(56).multipleReferences}},{key:"_getAlternativeCommand",value:function(){return""}}]),n}(de);ie.P.registerCommand({id:"editor.action.goToLocations",description:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:_.o},{name:"position",description:"The position at which to start",constraint:x.L.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:function(e,t,n,o,a,h,g){return ue(void 0,void 0,void 0,(0,s.Z)().mark((function f(){var v,p;return(0,s.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return(0,m.p_)(_.o.isUri(t)),(0,m.p_)(x.L.isIPosition(n)),(0,m.p_)(Array.isArray(o)),(0,m.p_)("undefined"===typeof a||"string"===typeof a),(0,m.p_)("undefined"===typeof g||"boolean"===typeof g),v=e.get(C.$),s.next=8,v.openCodeEditor({resource:t},v.getFocusedCodeEditor());case 8:if(p=s.sent,!(0,k.CL)(p)){s.next=13;break}return p.setPosition(n),p.revealPositionInCenterIfOutsideViewport(n,0),s.abrupt("return",p.invokeWithinContext((function(e){var t=new(function(e){(0,u.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,d.Z)(this,n),t.apply(this,arguments)}return(0,c.Z)(n,[{key:"_getNoResultFoundMessage",value:function(e){return h||(0,i.Z)((0,r.Z)(n.prototype),"_getNoResultFoundMessage",this).call(this,e)}}]),n}(me))({muteMessage:!Boolean(h),openInPeek:Boolean(g),openToSide:!1},o,a);e.get(T.TG).invokeFunction(t.run.bind(t),p)})));case 13:case"end":return s.stop()}}),f)})))}}),ie.P.registerCommand({id:"editor.action.peekLocations",description:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:_.o},{name:"position",description:"The position at which to start",constraint:x.L.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto"}]},handler:function(e,t,n,i,r){return ue(void 0,void 0,void 0,(0,s.Z)().mark((function o(){return(0,s.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:e.get(ie.H).executeCommand("editor.action.goToLocations",t,n,i,r,void 0,!0);case 1:case"end":return o.stop()}}),o)})))}}),ie.P.registerCommand({id:"editor.action.findReferences",handler:function(e,t,n){(0,m.p_)(_.o.isUri(t)),(0,m.p_)(x.L.isIPosition(n));var i=e.get(se.p),r=e.get(C.$);return r.openCodeEditor({resource:t},r.getFocusedCodeEditor()).then((function(e){if((0,k.CL)(e)&&e.hasModel()){var t=Z.J.get(e);if(t){var r=(0,f.PG)((function(t){return(0,oe.aA)(i.referenceProvider,e.getModel(),x.L.lift(n),!1,t).then((function(e){return new M.oQ(e,P.NC("ref.title","References"))}))})),o=new L.e(n.lineNumber,n.column,n.lineNumber,n.column);return Promise.resolve(t.toggleWidget(o,r,!1))}}}))}}),ie.P.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations")},49223:function(e,t,n){n.d(t,{L3:function(){return v},aA:function(){return p},f4:function(){return f},nD:function(){return h},zq:function(){return g}});var i=n(74165),r=n(85509),o=n(24404),s=n(61002),a=n(39177),u=n(69561),l=n(21164),d=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(t){o(t)}}function a(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))};function c(e,t,n,o){return d(this,void 0,void 0,(0,i.Z)().mark((function a(){var u,l,d;return(0,i.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return u=n.ordered(e),l=u.map((function(n){return Promise.resolve(o(n,e,t)).then(void 0,(function(e){(0,s.Cp)(e)}))})),i.next=4,Promise.all(l);case 4:return d=i.sent,i.abrupt("return",(0,r.kX)(d.flat()));case 6:case"end":return i.stop()}}),a)})))}function h(e,t,n,i){return c(t,n,e,(function(e,t,n){return e.provideDefinition(t,n,i)}))}function g(e,t,n,i){return c(t,n,e,(function(e,t,n){return e.provideDeclaration(t,n,i)}))}function f(e,t,n,i){return c(t,n,e,(function(e,t,n){return e.provideImplementation(t,n,i)}))}function v(e,t,n,i){return c(t,n,e,(function(e,t,n){return e.provideTypeDefinition(t,n,i)}))}function p(e,t,n,r,o){var s=this;return c(t,n,e,(function(e,t,n){return d(s,void 0,void 0,(0,i.Z)().mark((function s(){var a,u;return(0,i.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.provideReferences(t,n,{includeDeclaration:!0},o);case 2:if(a=i.sent,r&&a&&2===a.length){i.next=5;break}return i.abrupt("return",a);case 5:return i.next=7,e.provideReferences(t,n,{includeDeclaration:!1},o);case 7:if(!(u=i.sent)||1!==u.length){i.next=10;break}return i.abrupt("return",u);case 10:return i.abrupt("return",a);case 11:case"end":return i.stop()}}),s)})))}))}function m(e){return d(this,void 0,void 0,(0,i.Z)().mark((function t(){var n,r,o;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:return n=t.sent,r=new l.oQ(n,""),o=r.references.map((function(e){return e.link})),r.dispose(),t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})))}(0,a.sb)("_executeDefinitionProvider",(function(e,t,n){var i=h(e.get(u.p).definitionProvider,t,n,o.T.None);return m((function(){return i}))})),(0,a.sb)("_executeTypeDefinitionProvider",(function(e,t,n){var i=v(e.get(u.p).typeDefinitionProvider,t,n,o.T.None);return m((function(){return i}))})),(0,a.sb)("_executeDeclarationProvider",(function(e,t,n){var i=g(e.get(u.p).declarationProvider,t,n,o.T.None);return m((function(){return i}))})),(0,a.sb)("_executeReferenceProvider",(function(e,t,n){var i=p(e.get(u.p).referenceProvider,t,n,!1,o.T.None);return m((function(){return i}))})),(0,a.sb)("_executeImplementationProvider",(function(e,t,n){var i=f(e.get(u.p).implementationProvider,t,n,o.T.None);return m((function(){return i}))}))},96019:function(e,t,n){n.d(t,{yN:function(){return v}});var i=n(60136),r=n(27277),o=n(43144),s=n(15671),a=n(3318),u=n(82927),l=n(37858);function d(e,t){return!!e[t]}var c=(0,o.Z)((function e(t,n){(0,s.Z)(this,e),this.target=t.target,this.isLeftClick=t.event.leftButton,this.isMiddleClick=t.event.middleButton,this.isRightClick=t.event.rightButton,this.hasTriggerModifier=d(t.event,n.triggerModifier),this.hasSideBySideModifier=d(t.event,n.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=t.event.detail<=1})),h=(0,o.Z)((function e(t,n){(0,s.Z)(this,e),this.keyCodeIsTriggerKey=t.keyCode===n.triggerKey,this.keyCodeIsSideBySideKey=t.keyCode===n.triggerSideBySideKey,this.hasTriggerModifier=d(t,n.triggerModifier)})),g=function(){function e(t,n,i,r){(0,s.Z)(this,e),this.triggerKey=t,this.triggerModifier=n,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=r}return(0,o.Z)(e,[{key:"equals",value:function(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}}]),e}();function f(e){return"altKey"===e?l.dz?new g(57,"metaKey",6,"altKey"):new g(5,"ctrlKey",6,"altKey"):l.dz?new g(6,"altKey",57,"metaKey"):new g(6,"altKey",5,"ctrlKey")}var v=function(e){(0,i.Z)(n,e);var t=(0,r.Z)(n);function n(e,i){var r;return(0,s.Z)(this,n),(r=t.call(this))._onMouseMoveOrRelevantKeyDown=r._register(new a.Q5),r.onMouseMoveOrRelevantKeyDown=r._onMouseMoveOrRelevantKeyDown.event,r._onExecute=r._register(new a.Q5),r.onExecute=r._onExecute.event,r._onCancel=r._register(new a.Q5),r.onCancel=r._onCancel.event,r._editor=e,r._alwaysFireExecuteOnMouseUp=i,r._opts=f(r._editor.getOption(75)),r._lastMouseMoveEvent=null,r._hasTriggerKeyOnMouseDown=!1,r._lineNumberOnMouseDown=0,r._register(r._editor.onDidChangeConfiguration((function(e){if(e.hasChanged(75)){var t=f(r._editor.getOption(75));if(r._opts.equals(t))return;r._opts=t,r._lastMouseMoveEvent=null,r._hasTriggerKeyOnMouseDown=!1,r._lineNumberOnMouseDown=0,r._onCancel.fire()}}))),r._register(r._editor.onMouseMove((function(e){return r._onEditorMouseMove(new c(e,r._opts))}))),r._register(r._editor.onMouseDown((function(e){return r._onEditorMouseDown(new c(e,r._opts))}))),r._register(r._editor.onMouseUp((function(e){return r._onEditorMouseUp(new c(e,r._opts))}))),r._register(r._editor.onKeyDown((function(e){return r._onEditorKeyDown(new h(e,r._opts))}))),r._register(r._editor.onKeyUp((function(e){return r._onEditorKeyUp(new h(e,r._opts))}))),r._register(r._editor.onMouseDrag((function(){return r._resetHandler()}))),r._register(r._editor.onDidChangeCursorSelection((function(e){return r._onDidChangeCursorSelection(e)}))),r._register(r._editor.onDidChangeModel((function(e){return r._resetHandler()}))),r._register(r._editor.onDidChangeModelContent((function(){return r._resetHandler()}))),r._register(r._editor.onDidScrollChange((function(e){(e.scrollTopChanged||e.scrollLeftChanged)&&r._resetHandler()}))),r}return(0,o.Z)(n,[{key:"_onDidChangeCursorSelection",value:function(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}},{key:"_onEditorMouseMove",value:function(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}},{key:"_onEditorMouseDown",value:function(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=e.target.position?e.target.position.lineNumber:0}},{key:"_onEditorMouseUp",value:function(e){var t=e.target.position?e.target.position.lineNumber:0;(this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t||this._alwaysFireExecuteOnMouseUp)&&this._onExecute.fire(e)}},{key:"_onEditorKeyDown",value:function(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}},{key:"_onEditorKeyUp",value:function(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}},{key:"_resetHandler",value:function(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}]),n}(u.JT)},90017:function(e,t,n){n.d(t,{S:function(){return M}});var i=n(37762),r=n(74165),o=n(29439),s=n(15671),a=n(43144),u=n(1670),l=n(61002),d=n(31022),c=n(82927),h=n(91189),g=n(43887),f=n(39177),v=n(851),p=n(43954),m=n(42832),_=n(96019),y=n(7249),k=n(96531),b=n(24154),C=n(79005),w=n(49223),x=n(69561),L=n(80598),N=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},R=function(e,t){return function(n,i){t(n,i,e)}},Z=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(t){o(t)}}function a(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))},M=function(){function e(t,n,i,r){var a=this;(0,s.Z)(this,e),this.textModelResolverService=n,this.languageService=i,this.languageFeaturesService=r,this.toUnhook=new c.SL,this.toUnhookForKeyboard=new c.SL,this.currentWordAtPosition=null,this.previousPromise=null,this.editor=t,this.linkDecorations=this.editor.createDecorationsCollection();var u=new _.yN(t);this.toUnhook.add(u),this.toUnhook.add(u.onMouseMoveOrRelevantKeyDown((function(e){var t=(0,o.Z)(e,2),n=t[0],i=t[1];a.startFindDefinitionFromMouse(n,(0,h.f6)(i))}))),this.toUnhook.add(u.onExecute((function(e){a.isEnabled(e)&&a.gotoDefinition(e.target.position,e.hasSideBySideModifier).catch((function(e){(0,l.dL)(e)})).finally((function(){a.removeLinkDecorations()}))}))),this.toUnhook.add(u.onCancel((function(){a.removeLinkDecorations(),a.currentWordAtPosition=null})))}return(0,a.Z)(e,[{key:"startFindDefinitionFromCursor",value:function(e){return Z(this,void 0,void 0,(0,r.Z)().mark((function t(){var n=this;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.startFindDefinition(e);case 2:this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition((function(){n.currentWordAtPosition=null,n.removeLinkDecorations(),n.toUnhookForKeyboard.clear()}))),this.toUnhookForKeyboard.add(this.editor.onKeyDown((function(e){e&&(n.currentWordAtPosition=null,n.removeLinkDecorations(),n.toUnhookForKeyboard.clear())})));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"startFindDefinitionFromMouse",value:function(e,t){if(!(9===e.target.type&&this.linkDecorations.length>0)){if(!this.editor.hasModel()||!this.isEnabled(e,t))return this.currentWordAtPosition=null,void this.removeLinkDecorations();var n=e.target.position;this.startFindDefinition(n)}}},{key:"startFindDefinition",value:function(e){var t;return Z(this,void 0,void 0,(0,r.Z)().mark((function n(){var o,s,a,c,h,f,p,m,_,y=this;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.toUnhookForKeyboard.clear(),o=e?null===(t=this.editor.getModel())||void 0===t?void 0:t.getWordAtPosition(e):null){n.next=6;break}return this.currentWordAtPosition=null,this.removeLinkDecorations(),n.abrupt("return");case 6:if(!this.currentWordAtPosition||this.currentWordAtPosition.startColumn!==o.startColumn||this.currentWordAtPosition.endColumn!==o.endColumn||this.currentWordAtPosition.word!==o.word){n.next=8;break}return n.abrupt("return");case 8:return this.currentWordAtPosition=o,s=new g.yy(this.editor,15),this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=(0,u.PG)((function(t){return y.findDefinition(e,t)})),n.prev=12,n.next=15,this.previousPromise;case 15:a=n.sent,n.next=22;break;case 18:return n.prev=18,n.t0=n.catch(12),(0,l.dL)(n.t0),n.abrupt("return");case 22:if(a&&a.length&&s.validate(this.editor)){n.next=25;break}return this.removeLinkDecorations(),n.abrupt("return");case 25:if(c=a[0].originSelectionRange?v.e.lift(a[0].originSelectionRange):new v.e(e.lineNumber,o.startColumn,e.lineNumber,o.endColumn),!(a.length>1)){n.next=33;break}h=c,f=(0,i.Z)(a);try{for(f.s();!(p=f.n()).done;)(m=p.value.originSelectionRange)&&(h=v.e.plusRange(h,m))}catch(r){f.e(r)}finally{f.f()}this.addDecoration(h,(new d.W5).appendText(k.NC("multipleResults","Click to show {0} definitions.",a.length))),n.next=37;break;case 33:if((_=a[0]).uri){n.next=36;break}return n.abrupt("return");case 36:this.textModelResolverService.createModelReference(_.uri).then((function(e){if(e.object&&e.object.textEditorModel){var t=e.object.textEditorModel,n=_.range.startLineNumber;if(n<1||n>t.getLineCount())e.dispose();else{var i=y.getPreviewValue(t,n,_),r=y.languageService.guessLanguageIdByFilepathOrFirstLine(t.uri);y.addDecoration(c,i?(new d.W5).appendCodeblock(r||"",i):void 0),e.dispose()}}else e.dispose()}));case 37:case"end":return n.stop()}}),n,this,[[12,18]])})))}},{key:"getPreviewValue",value:function(t,n,i){var r=i.range;return r.endLineNumber-r.startLineNumber>=e.MAX_SOURCE_PREVIEW_LINES&&(r=this.getPreviewRangeBasedOnIndentation(t,n)),this.stripIndentationFromPreviewRange(t,n,r)}},{key:"stripIndentationFromPreviewRange",value:function(e,t,n){for(var i=e.getLineFirstNonWhitespaceColumn(t),r=t+1;r<n.endLineNumber;r++){var o=e.getLineFirstNonWhitespaceColumn(r);i=Math.min(i,o)}return e.getValueInRange(n).replace(new RegExp("^\\s{".concat(i-1,"}"),"gm"),"").trim()}},{key:"getPreviewRangeBasedOnIndentation",value:function(t,n){for(var i=t.getLineFirstNonWhitespaceColumn(n),r=Math.min(t.getLineCount(),n+e.MAX_SOURCE_PREVIEW_LINES),o=n+1;o<r;o++){if(i===t.getLineFirstNonWhitespaceColumn(o))break}return new v.e(n,1,o+1,1)}},{key:"addDecoration",value:function(e,t){var n={range:e,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:t}};this.linkDecorations.set([n])}},{key:"removeLinkDecorations",value:function(){this.linkDecorations.clear()}},{key:"isEnabled",value:function(e,t){var n;return this.editor.hasModel()&&e.isLeftClick&&e.isNoneOrSingleMouseDown&&6===e.target.type&&!((null===(n=e.target.detail.injectedText)||void 0===n?void 0:n.options)instanceof L.HS)&&(e.hasTriggerModifier||!!t&&t.keyCodeIsTriggerKey)&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}},{key:"findDefinition",value:function(e,t){var n=this.editor.getModel();return n?(0,w.nD)(this.languageFeaturesService.definitionProvider,n,e,t):Promise.resolve(null)}},{key:"gotoDefinition",value:function(e,t){var n=this;return this.editor.setPosition(e),this.editor.invokeWithinContext((function(e){var i=!t&&n.editor.getOption(85)&&!n.isInPeekEditor(e);return new C.BT({openToSide:t,openInPeek:i,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(e)}))}},{key:"isInPeekEditor",value:function(e){var t=e.get(b.i6);return y.Jy.inPeekEditor.getValue(t)}},{key:"dispose",value:function(){this.toUnhook.dispose(),this.toUnhookForKeyboard.dispose()}}],[{key:"get",value:function(t){return t.getContribution(e.ID)}}]),e}();M.ID="editor.contrib.gotodefinitionatposition",M.MAX_SOURCE_PREVIEW_LINES=8,M=N([R(1,m.S),R(2,p.O),R(3,x.p)],M),(0,f._K)(M.ID,M,2)},24311:function(e,t,n){n.d(t,{J:function(){return be}});var i=n(74165),r=n(15671),o=n(43144),s=n(1670),a=n(61002),u=n(84191),l=n(82927),d=n(47454),c=n(39912),h=n(851),g=n(7249),f=n(96531),v=n(13134),p=n(57348),m=n(24154),_=n(20893),y=n(74546),k=n(55965),b=n(8439),C=n(87327),w=n(21164),x=n(97326),L=n(11752),N=n(61120),R=n(60136),Z=n(27277),M=n(93433),D=n(29439),S=n(37762),I=n(39165),P=n(61556),E=n(96142),A=n(3318),T=n(11540),O=n(87558),F=n(88424),U=n(80598),W=n(80017),H=n(28273),B=n(43954),G=n(42832),K=n(65034),V=n(72270),X=n(45885),Q=n(96823),j=n(94341),q=n(36499),z=n(76512),J=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},$=function(e,t){return function(n,i){t(n,i,e)}},Y=function(){function e(t){(0,r.Z)(this,e),this._resolverService=t}return(0,o.Z)(e,[{key:"hasChildren",value:function(e){return e instanceof w.oQ||e instanceof w.F2}},{key:"getChildren",value:function(e){if(e instanceof w.oQ)return e.groups;if(e instanceof w.F2)return e.resolve(this._resolverService).then((function(e){return e.children}));throw new Error("bad tree")}}]),e}();Y=J([$(0,G.S)],Y);var ee=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,[{key:"getHeight",value:function(){return 23}},{key:"getTemplateId",value:function(e){return e instanceof w.F2?re.id:se.id}}]),e}(),te=function(){function e(t){(0,r.Z)(this,e),this._keybindingService=t}return(0,o.Z)(e,[{key:"getKeyboardNavigationLabel",value:function(e){var t;if(e instanceof w.WX){var n=null===(t=e.parent.getPreview(e))||void 0===t?void 0:t.preview(e.range);if(n)return n.value}return(0,O.EZ)(e.uri)}}]),e}();te=J([$(0,j.d)],te);var ne=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,[{key:"getId",value:function(e){return e instanceof w.WX?e.id:e.uri}}]),e}(),ie=function(e){(0,R.Z)(n,e);var t=(0,Z.Z)(n);function n(e,i){var o;(0,r.Z)(this,n),(o=t.call(this))._labelService=i;var s=document.createElement("div");return s.classList.add("reference-file"),o.file=o._register(new X.g(s,{supportHighlights:!0})),o.badge=new K.Z(I.append(s,I.$(".count")),{},z.ku),e.appendChild(s),o}return(0,o.Z)(n,[{key:"set",value:function(e,t){var n=(0,O.XX)(e.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(e.uri),this._labelService.getUriLabel(n,{relative:!0}),{title:this._labelService.getUriLabel(e.uri),matches:t});var i=e.children.length;this.badge.setCount(i),i>1?this.badge.setTitleFormat((0,f.NC)("referencesCount","{0} references",i)):this.badge.setTitleFormat((0,f.NC)("referenceCount","{0} reference",i))}}]),n}(l.JT);ie=J([$(1,q.e)],ie);var re=function(){function e(t){(0,r.Z)(this,e),this._instantiationService=t,this.templateId=e.id}return(0,o.Z)(e,[{key:"renderTemplate",value:function(e){return this._instantiationService.createInstance(ie,e)}},{key:"renderElement",value:function(e,t,n){n.set(e.element,(0,Q.mB)(e.filterData))}},{key:"disposeTemplate",value:function(e){e.dispose()}}]),e}();re.id="FileReferencesRenderer",re=J([$(0,_.TG)],re);var oe=function(){function e(t){(0,r.Z)(this,e),this.label=new V.q(t)}return(0,o.Z)(e,[{key:"set",value:function(e,t){var n,i=null===(n=e.parent.getPreview(e))||void 0===n?void 0:n.preview(e.range);if(i&&i.value){var r=i.value,o=i.highlight;t&&!Q.CL.isDefault(t)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(r,(0,Q.mB)(t))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(r,[o]))}else this.label.set("".concat((0,O.EZ)(e.uri),":").concat(e.range.startLineNumber+1,":").concat(e.range.startColumn+1))}}]),e}(),se=function(){function e(){(0,r.Z)(this,e),this.templateId=e.id}return(0,o.Z)(e,[{key:"renderTemplate",value:function(e){return new oe(e)}},{key:"renderElement",value:function(e,t,n){n.set(e.element,e.filterData)}},{key:"disposeTemplate",value:function(){}}]),e}();se.id="OneReferenceRenderer";var ae=function(){function e(){(0,r.Z)(this,e)}return(0,o.Z)(e,[{key:"getWidgetAriaLabel",value:function(){return(0,f.NC)("treeAriaLabel","References")}},{key:"getAriaLabel",value:function(e){return e.ariaMessage}}]),e}(),ue=n(76634),le=n(25495),de=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},ce=function(e,t){return function(n,i){t(n,i,e)}},he=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(t){o(t)}}function a(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))},ge=function(){function e(t,n){var i=this;(0,r.Z)(this,e),this._editor=t,this._model=n,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new l.SL,this._callOnModelChange=new l.SL,this._callOnDispose.add(this._editor.onDidChangeModel((function(){return i._onModelChanged()}))),this._onModelChanged()}return(0,o.Z)(e,[{key:"dispose",value:function(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}},{key:"_onModelChanged",value:function(){this._callOnModelChange.clear();var e=this._editor.getModel();if(e){var t,n=(0,S.Z)(this._model.references);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.uri.toString()===e.uri.toString())return void this._addDecorations(i.parent)}}catch(r){n.e(r)}finally{n.f()}}}},{key:"_addDecorations",value:function(t){var n=this;if(this._editor.hasModel()){this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations((function(){return n._onDecorationChanged()})));for(var i=[],r=[],o=0,s=t.children.length;o<s;o++){var a=t.children[o];this._decorationIgnoreSet.has(a.id)||a.uri.toString()===this._editor.getModel().uri.toString()&&(i.push({range:a.range,options:e.DecorationOptions}),r.push(o))}this._editor.changeDecorations((function(e){for(var o=e.deltaDecorations([],i),s=0;s<o.length;s++)n._decorations.set(o[s],t.children[r[s]])}))}}},{key:"_onDecorationChanged",value:function(){var e=[],t=this._editor.getModel();if(t){var n,i=(0,S.Z)(this._decorations);try{for(i.s();!(n=i.n()).done;){var r=(0,D.Z)(n.value,2),o=r[0],s=r[1],a=t.getDecorationRange(o);if(a){var u=!1;if(!h.e.equalsRange(a,s.range)){if(h.e.spansMultipleLines(a))u=!0;else s.range.endColumn-s.range.startColumn!==a.endColumn-a.startColumn&&(u=!0);u?(this._decorationIgnoreSet.add(s.id),e.push(o)):s.range=a}}}}catch(c){i.e(c)}finally{i.f()}for(var l=0,d=e.length;l<d;l++)this._decorations.delete(e[l]);this._editor.removeDecorations(e)}}},{key:"removeDecorations",value:function(){this._editor.removeDecorations((0,M.Z)(this._decorations.keys())),this._decorations.clear()}}]),e}();ge.DecorationOptions=U.qx.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});var fe=function(){function e(){(0,r.Z)(this,e),this.ratio=.7,this.heightInLines=18}return(0,o.Z)(e,null,[{key:"fromJSON",value:function(e){var t,n;try{var i=JSON.parse(e);t=i.ratio,n=i.heightInLines}catch(r){}return{ratio:t||.7,heightInLines:n||18}}}]),e}(),ve=function(e){(0,R.Z)(n,e);var t=(0,Z.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n)}(k.ls),pe=function(e){(0,R.Z)(n,e);var t=(0,Z.Z)(n);function n(e,i,o,s,a,u,d,c,h,g,f,v){var p;return(0,r.Z)(this,n),(p=t.call(this,e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},u))._defaultTreeKeyboardSupport=i,p.layoutData=o,p._textModelResolverService=a,p._instantiationService=u,p._peekViewService=d,p._uriLabel=c,p._undoRedoService=h,p._keybindingService=g,p._languageService=f,p._languageConfigurationService=v,p._disposeOnNewModel=new l.SL,p._callOnDispose=new l.SL,p._onDidSelectReference=new A.Q5,p.onDidSelectReference=p._onDidSelectReference.event,p._dim=new I.Dimension(0,0),p._applyTheme(s.getColorTheme()),p._callOnDispose.add(s.onDidColorThemeChange(p._applyTheme.bind((0,x.Z)(p)))),p._peekViewService.addExclusiveWidget(e,(0,x.Z)(p)),p.create(),p}return(0,o.Z)(n,[{key:"dispose",value:function(){this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),(0,l.B9)(this._preview),(0,l.B9)(this._previewNotAvailableMessage),(0,l.B9)(this._tree),(0,l.B9)(this._previewModelReference),this._splitView.dispose(),(0,L.Z)((0,N.Z)(n.prototype),"dispose",this).call(this)}},{key:"_applyTheme",value:function(e){var t=e.getColor(g.SC)||E.Il.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(g.KY)||E.Il.transparent,primaryHeadingColor:e.getColor(g.IH),secondaryHeadingColor:e.getColor(g.R7)})}},{key:"show",value:function(e){(0,L.Z)((0,N.Z)(n.prototype),"show",this).call(this,e,this.layoutData.heightInLines||18)}},{key:"focusOnReferenceTree",value:function(){this._tree.domFocus()}},{key:"focusOnPreviewEditor",value:function(){this._preview.focus()}},{key:"isPreviewEditorFocused",value:function(){return this._preview.hasTextFocus()}},{key:"_onTitleClick",value:function(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}},{key:"_fillBody",value:function(e){var t=this;this.setCssClass("reference-zone-widget"),this._messageContainer=I.append(e,I.$("div.messages")),I.hide(this._messageContainer),this._splitView=new P.z(e,{orientation:1}),this._previewContainer=I.append(e,I.$("div.preview.inline"));this._preview=this._instantiationService.createInstance(F.H,this._previewContainer,{scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!1},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}},{},this.editor),I.hide(this._previewContainer),this._previewNotAvailableMessage=new U.yO(f.NC("missingPreviewMessage","no preview available"),H.bd,U.yO.DEFAULT_CREATION_OPTIONS,null,this._undoRedoService,this._languageService,this._languageConfigurationService),this._treeContainer=I.append(e,I.$("div.ref-tree.inline"));var n={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new ae,keyboardNavigationLabelProvider:this._instantiationService.createInstance(te),identityProvider:new ne,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:g.M8}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(I.addStandardDisposableListener(this._treeContainer,"keydown",(function(e){e.equals(9)&&(t._keybindingService.dispatchEvent(e,e.target),e.stopPropagation())}),!0)),this._tree=this._instantiationService.createInstance(ve,"ReferencesWidget",this._treeContainer,new ee,[this._instantiationService.createInstance(re),this._instantiationService.createInstance(se)],this._instantiationService.createInstance(Y),n),this._splitView.addView({onDidChange:A.ju.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:function(e){t._preview.layout({height:t._dim.height,width:e})}},P.M.Distribute),this._splitView.addView({onDidChange:A.ju.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:function(e){t._treeContainer.style.height="".concat(t._dim.height,"px"),t._treeContainer.style.width="".concat(e,"px"),t._tree.layout(t._dim.height,e)}},P.M.Distribute),this._disposables.add(this._splitView.onDidSashChange((function(){t._dim.width&&(t.layoutData.ratio=t._splitView.getViewSize(0)/t._dim.width)}),void 0));var i=function(e,n){e instanceof w.WX&&("show"===n&&t._revealReference(e,!1),t._onDidSelectReference.fire({element:e,kind:n,source:"tree"}))};this._tree.onDidOpen((function(e){e.sideBySide?i(e.element,"side"):e.editorOptions.pinned?i(e.element,"goto"):i(e.element,"show")})),I.hide(this._treeContainer)}},{key:"_onWidth",value:function(e){this._dim&&this._doLayoutBody(this._dim.height,e)}},{key:"_doLayoutBody",value:function(e,t){(0,L.Z)((0,N.Z)(n.prototype),"_doLayoutBody",this).call(this,e,t),this._dim=new I.Dimension(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}},{key:"setSelection",value:function(e){var t=this;return this._revealReference(e,!0).then((function(){t._model&&(t._tree.setSelection([e]),t._tree.setFocus([e]))}))}},{key:"setModel",value:function(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}},{key:"_onNewModel",value:function(){var e=this;return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=f.NC("noResults","No results"),I.show(this._messageContainer),Promise.resolve(void 0)):(I.hide(this._messageContainer),this._decorationsManager=new ge(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange((function(t){return e._tree.rerender(t)}))),this._disposeOnNewModel.add(this._preview.onMouseDown((function(t){var n=t.event,i=t.target;if(2===n.detail){var r=e._getFocusedReference();r&&e._onDidSelectReference.fire({element:{uri:r.uri,range:i.range},kind:n.ctrlKey||n.metaKey||n.altKey?"side":"open",source:"editor"})}}))),this.container.classList.add("results-loaded"),I.show(this._treeContainer),I.show(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(1===this._model.groups.length?this._model.groups[0]:this._model)):Promise.resolve(void 0)}},{key:"_getFocusedReference",value:function(){var e=this._tree.getFocus(),t=(0,D.Z)(e,1)[0];return t instanceof w.WX?t:t instanceof w.F2&&t.children.length>0?t.children[0]:void 0}},{key:"revealReference",value:function(e){return he(this,void 0,void 0,(0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._revealReference(e,!1);case 2:this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"});case 3:case"end":return t.stop()}}),t,this)})))}},{key:"_revealReference",value:function(e,t){return he(this,void 0,void 0,(0,i.Z)().mark((function n(){var r,o,s,a,u;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._revealedReference!==e){n.next=2;break}return n.abrupt("return");case 2:if(this._revealedReference=e,e.uri.scheme!==T.lg.inMemory?this.setTitle((0,O.Hx)(e.uri),this._uriLabel.getUriLabel((0,O.XX)(e.uri))):this.setTitle(f.NC("peekView.alternateTitle","References")),r=this._textModelResolverService.createModelReference(e.uri),this._tree.getInput()!==e.parent){n.next=9;break}this._tree.reveal(e),n.next=13;break;case 9:return t&&this._tree.reveal(e.parent),n.next=12,this._tree.expand(e.parent);case 12:this._tree.reveal(e);case 13:return n.next=15,r;case 15:if(o=n.sent,this._model){n.next=19;break}return o.dispose(),n.abrupt("return");case 19:(0,l.B9)(this._previewModelReference),(s=o.object)?(a=this._preview.getModel()===s.textEditorModel?0:1,u=h.e.lift(e.range).collapseToStart(),this._previewModelReference=o,this._preview.setModel(s.textEditorModel),this._preview.setSelection(u),this._preview.revealRangeInCenter(u,a)):(this._preview.setModel(this._previewNotAvailableMessage),o.dispose());case 22:case"end":return n.stop()}}),n,this)})))}}]),n}(g.vk);pe=de([ce(3,ue.XE),ce(4,G.S),ce(5,_.TG),ce(6,g.Fw),ce(7,q.e),ce(8,le.tJ),ce(9,j.d),ce(10,B.O),ce(11,W.c_)],pe);var me=function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},_e=function(e,t){return function(n,i){t(n,i,e)}},ye=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(t){o(t)}}function a(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))},ke=new m.uy("referenceSearchVisible",!1,f.NC("referenceSearchVisible","Whether reference peek is visible, like 'Peek References' or 'Peek Definition'")),be=function(){function e(t,n,i,o,s,a,u,d){(0,r.Z)(this,e),this._defaultTreeKeyboardSupport=t,this._editor=n,this._editorService=o,this._notificationService=s,this._instantiationService=a,this._storageService=u,this._configurationService=d,this._disposables=new l.SL,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=ke.bindTo(i)}return(0,o.Z)(e,[{key:"dispose",value:function(){var e,t;this._referenceSearchVisible.reset(),this._disposables.dispose(),null===(e=this._widget)||void 0===e||e.dispose(),null===(t=this._model)||void 0===t||t.dispose(),this._widget=void 0,this._model=void 0}},{key:"toggleWidget",value:function(e,t,n){var i,r=this;if(this._widget&&(i=this._widget.position),this.closeWidget(),!i||!e.containsPosition(i)){this._peekMode=n,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage((function(){r.closeWidget()}))),this._disposables.add(this._editor.onDidChangeModel((function(){r._ignoreModelChangeEvent||r.closeWidget()})));var o="peekViewLayout",s=fe.fromJSON(this._storageService.get(o,0,"{}"));this._widget=this._instantiationService.createInstance(pe,this._editor,this._defaultTreeKeyboardSupport,s),this._widget.setTitle(f.NC("labelLoading","Loading...")),this._widget.show(e),this._disposables.add(this._widget.onDidClose((function(){t.cancel(),r._widget&&(r._storageService.store(o,JSON.stringify(r._widget.layoutData),0,1),r._widget=void 0),r.closeWidget()}))),this._disposables.add(this._widget.onDidSelectReference((function(e){var t=e.element,i=e.kind;if(t)switch(i){case"open":"editor"===e.source&&r._configurationService.getValue("editor.stablePeek")||r.openReference(t,!1,!1);break;case"side":r.openReference(t,!0,!1);break;case"goto":n?r._gotoReference(t,!0):r.openReference(t,!1,!0)}})));var a=++this._requestIdPool;t.then((function(t){var n;if(a===r._requestIdPool&&r._widget)return null===(n=r._model)||void 0===n||n.dispose(),r._model=t,r._widget.setModel(r._model).then((function(){if(r._widget&&r._model&&r._editor.hasModel()){r._model.isEmpty?r._widget.setMetaTitle(""):r._widget.setMetaTitle(f.NC("metaTitle.N","{0} ({1})",r._model.title,r._model.references.length));var t=r._editor.getModel().uri,n=new c.L(e.startLineNumber,e.startColumn),i=r._model.nearestReference(t,n);if(i)return r._widget.setSelection(i).then((function(){r._widget&&"editor"===r._editor.getOption(84)&&r._widget.focusOnPreviewEditor()}))}}));t.dispose()}),(function(e){r._notificationService.error(e)}))}}},{key:"changeFocusBetweenPreviewAndReferences",value:function(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}},{key:"goToNextOrPreviousReference",value:function(e){return ye(this,void 0,void 0,(0,i.Z)().mark((function t(){var n,r,o,s,a;return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._editor.hasModel()&&this._model&&this._widget){t.next=2;break}return t.abrupt("return");case 2:if(n=this._widget.position){t.next=5;break}return t.abrupt("return");case 5:if(r=this._model.nearestReference(this._editor.getModel().uri,n)){t.next=8;break}return t.abrupt("return");case 8:return o=this._model.nextOrPreviousReference(r,e),s=this._editor.hasTextFocus(),a=this._widget.isPreviewEditorFocused(),t.next=13,this._widget.setSelection(o);case 13:return t.next=15,this._gotoReference(o,!1);case 15:s?this._editor.focus():this._widget&&a&&this._widget.focusOnPreviewEditor();case 16:case"end":return t.stop()}}),t,this)})))}},{key:"revealReference",value:function(e){return ye(this,void 0,void 0,(0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._editor.hasModel()&&this._model&&this._widget){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this._widget.revealReference(e);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"closeWidget",value:function(){var e,t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null===(e=this._widget)||void 0===e||e.dispose(),null===(t=this._model)||void 0===t||t.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,n&&this._editor.focus(),this._requestIdPool+=1}},{key:"_gotoReference",value:function(t,n){var i,r=this;null===(i=this._widget)||void 0===i||i.hide(),this._ignoreModelChangeEvent=!0;var o=h.e.lift(t.range).collapseToStart();return this._editorService.openCodeEditor({resource:t.uri,options:{selection:o,selectionSource:"code.jump",pinned:n}},this._editor).then((function(t){var n;if(r._ignoreModelChangeEvent=!1,t&&r._widget)if(r._editor===t)r._widget.show(o),r._widget.focusOnReferenceTree();else{var i=e.get(t),a=r._model.clone();r.closeWidget(),t.focus(),null===i||void 0===i||i.toggleWidget(o,(0,s.PG)((function(e){return Promise.resolve(a)})),null!==(n=r._peekMode)&&void 0!==n&&n)}else r.closeWidget()}),(function(e){r._ignoreModelChangeEvent=!1,(0,a.dL)(e)}))}},{key:"openReference",value:function(e,t,n){t||this.closeWidget();var i=e.uri,r=e.range;this._editorService.openCodeEditor({resource:i,options:{selection:r,selectionSource:"code.jump",pinned:n}},this._editor,t)}}],[{key:"get",value:function(t){return t.getContribution(e.ID)}}]),e}();function Ce(e,t){var n=(0,g.rc)(e);if(n){var i=be.get(n);i&&t(i)}}be.ID="editor.contrib.referencesController",be=me([_e(2,m.i6),_e(3,d.$),_e(4,b.lT),_e(5,_.TG),_e(6,C.Uy),_e(7,p.Ui)],be),y.W.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:(0,u.gx)(2089,60),when:m.Ao.or(ke,g.Jy.inPeekEditor),handler:function(e){Ce(e,(function(e){e.changeFocusBetweenPreviewAndReferences()}))}}),y.W.registerCommandAndKeybindingRule({id:"goToNextReference",weight:90,primary:62,secondary:[70],when:m.Ao.or(ke,g.Jy.inPeekEditor),handler:function(e){Ce(e,(function(e){e.goToNextOrPreviousReference(!0)}))}}),y.W.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:90,primary:1086,secondary:[1094],when:m.Ao.or(ke,g.Jy.inPeekEditor),handler:function(e){Ce(e,(function(e){e.goToNextOrPreviousReference(!1)}))}}),v.P.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference"),v.P.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference"),v.P.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch"),v.P.registerCommand("closeReferenceSearch",(function(e){return Ce(e,(function(e){return e.closeWidget()}))})),y.W.registerKeybindingRule({id:"closeReferenceSearch",weight:-1,primary:9,secondary:[1033],when:m.Ao.and(g.Jy.inPeekEditor,m.Ao.not("config.editor.stablePeek"))}),y.W.registerKeybindingRule({id:"closeReferenceSearch",weight:250,primary:9,secondary:[1033],when:m.Ao.and(ke,m.Ao.not("config.editor.stablePeek"))}),y.W.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:m.Ao.and(ke,k.CQ,k.PS.negate(),k.uJ.negate()),handler:function(e){var t,n=null===(t=e.get(k.Lw).lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(n)&&n[0]instanceof w.WX&&Ce(e,(function(e){return e.revealReference(n[0])}))}}),y.W.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:m.Ao.and(ke,k.CQ,k.PS.negate(),k.uJ.negate()),handler:function(e){var t,n=null===(t=e.get(k.Lw).lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(n)&&n[0]instanceof w.WX&&Ce(e,(function(e){return e.openReference(n[0],!0,!0)}))}}),v.P.registerCommand("openReference",(function(e){var t,n=null===(t=e.get(k.Lw).lastFocusedList)||void 0===t?void 0:t.getFocus();Array.isArray(n)&&n[0]instanceof w.WX&&Ce(e,(function(e){return e.openReference(n[0],!1,!0)}))}))},21164:function(e,t,n){n.d(t,{F2:function(){return k},WX:function(){return _},oQ:function(){return b}});var i=n(29439),r=n(74165),o=n(37762),s=n(15671),a=n(43144),u=n(61002),l=n(3318),d=n(46800),c=n(82927),h=n(82861),g=n(87558),f=n(62428),v=n(851),p=n(96531),m=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{u(i.next(e))}catch(t){o(t)}}function a(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((i=i.apply(e,t||[])).next())}))},_=function(){function e(t,n,i,r){(0,s.Z)(this,e),this.isProviderFirst=t,this.parent=n,this.link=i,this._rangeCallback=r,this.id=d.a.nextId()}return(0,a.Z)(e,[{key:"uri",get:function(){return this.link.uri}},{key:"range",get:function(){var e,t;return null!==(t=null!==(e=this._range)&&void 0!==e?e:this.link.targetSelectionRange)&&void 0!==t?t:this.link.range},set:function(e){this._range=e,this._rangeCallback(this)}},{key:"ariaMessage",get:function(){var e,t=null===(e=this.parent.getPreview(this))||void 0===e?void 0:e.preview(this.range);return t?(0,p.NC)({key:"aria.oneReference.preview",comment:["Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code"]},"{0} in {1} on line {2} at column {3}",t.value,(0,g.EZ)(this.uri),this.range.startLineNumber,this.range.startColumn):(0,p.NC)("aria.oneReference","in {0} on line {1} at column {2}",(0,g.EZ)(this.uri),this.range.startLineNumber,this.range.startColumn)}}]),e}(),y=function(){function e(t){(0,s.Z)(this,e),this._modelReference=t}return(0,a.Z)(e,[{key:"dispose",value:function(){this._modelReference.dispose()}},{key:"preview",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=this._modelReference.object.textEditorModel;if(n){var i=e.startLineNumber,r=e.startColumn,o=e.endLineNumber,s=e.endColumn,a=n.getWordUntilPosition({lineNumber:i,column:r-t}),u=new v.e(i,a.startColumn,i,r),l=new v.e(o,s,o,1073741824),d=n.getValueInRange(u).replace(/^\s+/,""),c=n.getValueInRange(e);return{value:d+c+n.getValueInRange(l).replace(/\s+$/,""),highlight:{start:d.length,end:d.length+c.length}}}}}]),e}(),k=function(){function e(t,n){(0,s.Z)(this,e),this.parent=t,this.uri=n,this.children=[],this._previews=new h.Y9}return(0,a.Z)(e,[{key:"dispose",value:function(){(0,c.B9)(this._previews.values()),this._previews.clear()}},{key:"getPreview",value:function(e){return this._previews.get(e.uri)}},{key:"ariaMessage",get:function(){var e=this.children.length;return 1===e?(0,p.NC)("aria.fileReferences.1","1 symbol in {0}, full path {1}",(0,g.EZ)(this.uri),this.uri.fsPath):(0,p.NC)("aria.fileReferences.N","{0} symbols in {1}, full path {2}",e,(0,g.EZ)(this.uri),this.uri.fsPath)}},{key:"resolve",value:function(e){return m(this,void 0,void 0,(0,r.Z)().mark((function t(){var n,i,s,a;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===this._previews.size){t.next=2;break}return t.abrupt("return",this);case 2:n=(0,o.Z)(this.children),t.prev=3,n.s();case 5:if((i=n.n()).done){t.next=21;break}if(s=i.value,!this._previews.has(s.uri)){t.next=9;break}return t.abrupt("continue",19);case 9:return t.prev=9,t.next=12,e.createModelReference(s.uri);case 12:a=t.sent,this._previews.set(s.uri,new y(a)),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(9),(0,u.dL)(t.t0);case 19:t.next=5;break;case 21:t.next=26;break;case 23:t.prev=23,t.t1=t.catch(3),n.e(t.t1);case 26:return t.prev=26,n.f(),t.finish(26);case 29:return t.abrupt("return",this);case 30:case"end":return t.stop()}}),t,this,[[3,23,26,29],[9,16]])})))}}]),e}(),b=function(){function e(t,n){var r=this;(0,s.Z)(this,e),this.groups=[],this.references=[],this._onDidChangeReferenceRange=new l.Q5,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=t,this._title=n;var a,u=(0,i.Z)(t,1)[0];t.sort(e._compareReferences);var d,c=(0,o.Z)(t);try{for(c.s();!(d=c.n()).done;){var h=d.value;if(a&&g.SF.isEqual(a.uri,h.uri,!0)||(a=new k(this,h.uri),this.groups.push(a)),0===a.children.length||0!==e._compareReferences(h,a.children[a.children.length-1])){var f=new _(u===h,a,h,(function(e){return r._onDidChangeReferenceRange.fire(e)}));this.references.push(f),a.children.push(f)}}}catch(v){c.e(v)}finally{c.f()}}return(0,a.Z)(e,[{key:"dispose",value:function(){(0,c.B9)(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}},{key:"clone",value:function(){return new e(this._links,this._title)}},{key:"title",get:function(){return this._title}},{key:"isEmpty",get:function(){return 0===this.groups.length}},{key:"ariaMessage",get:function(){return this.isEmpty?(0,p.NC)("aria.result.0","No results found"):1===this.references.length?(0,p.NC)("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):1===this.groups.length?(0,p.NC)("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):(0,p.NC)("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}},{key:"nextOrPreviousReference",value:function(e,t){var n=e.parent,i=n.children.indexOf(e),r=n.children.length,o=n.parent.groups.length;return 1===o||t&&i+1<r||!t&&i>0?(i=t?(i+1)%r:(i+r-1)%r,n.children[i]):(i=n.parent.groups.indexOf(n),t?(i=(i+1)%o,n.parent.groups[i].children[0]):(i=(i+o-1)%o,n.parent.groups[i].children[n.parent.groups[i].children.length-1]))}},{key:"nearestReference",value:function(e,t){var n=this.references.map((function(n,i){return{idx:i,prefixLen:f.Mh(n.uri.toString(),e.toString()),offsetDist:100*Math.abs(n.range.startLineNumber-t.lineNumber)+Math.abs(n.range.startColumn-t.column)}})).sort((function(e,t){return e.prefixLen>t.prefixLen?-1:e.prefixLen<t.prefixLen?1:e.offsetDist<t.offsetDist?-1:e.offsetDist>t.offsetDist?1:0}))[0];if(n)return this.references[n.idx]}},{key:"referenceAt",value:function(e,t){var n,i=(0,o.Z)(this.references);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r.uri.toString()===e.toString()&&v.e.containsPosition(r.range,t))return r}}catch(s){i.e(s)}finally{i.f()}}},{key:"firstReference",value:function(){var e,t=(0,o.Z)(this.references);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.isProviderFirst)return n}}catch(i){t.e(i)}finally{t.f()}return this.references[0]}}],[{key:"_compareReferences",value:function(e,t){return g.SF.compare(e.uri,t.uri)||v.e.compareRangesUsingStarts(e.range,t.range)}}]),e}()}}]);
//# sourceMappingURL=monaco-editor-vendor.a24b52b1.378e5289.js.map