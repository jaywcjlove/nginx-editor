{"version":3,"file":"static/js/monaco-editor-vendor.1b18e904.cddcab9e.js","mappings":"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","sources":["../../node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/browser/fontZoom.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/format.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formatActions.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formattingEdit.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/markerNavigationService.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoErrorWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoError.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/symbolNavigation.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToCommands.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToSymbol.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesTree.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesController.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/referencesModel.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHoverStatusBar.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/getHover.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverActionIds.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverActions.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/markerHoverParticipant.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverContribution.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/resizableContentWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHoverWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverOperation.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHoverComputer.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHoverTypes.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHoverController.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/marginHoverComputer.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/marginHoverWidget.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverController.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverTypes.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/markdownHoverParticipant.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplaceCommand.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/indentation/common/indentation.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/indentation/browser/indentation.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/indentation/common/indentUtils.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHints.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsContribution.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsController.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsHover.js","../../node_modules/monaco-editor/esm/vs/editor/contrib/inlayHints/browser/inlayHintsLocations.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorZoom } from '../../../common/config/editorZoom.js';\nimport * as nls from '../../../../nls.js';\nclass EditorFontZoomIn extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomIn',\n            label: nls.localize('EditorFontZoomIn.label', \"Increase Editor Font Size\"),\n            alias: 'Increase Editor Font Size',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() + 1);\n    }\n}\nclass EditorFontZoomOut extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomOut',\n            label: nls.localize('EditorFontZoomOut.label', \"Decrease Editor Font Size\"),\n            alias: 'Decrease Editor Font Size',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() - 1);\n    }\n}\nclass EditorFontZoomReset extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomReset',\n            label: nls.localize('EditorFontZoomReset.label', \"Reset Editor Font Size\"),\n            alias: 'Reset Editor Font Size',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(0);\n    }\n}\nregisterEditorAction(EditorFontZoomIn);\nregisterEditorAction(EditorFontZoomOut);\nregisterEditorAction(EditorFontZoomReset);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { asArray, isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource, TextModelCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ExtensionIdentifierSet } from '../../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { AccessibilitySignal, IAccessibilitySignalService } from '../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js';\nexport function getRealAndSyntheticDocumentFormattersOrdered(documentFormattingEditProvider, documentRangeFormattingEditProvider, model) {\n    const result = [];\n    const seen = new ExtensionIdentifierSet();\n    // (1) add all document formatter\n    const docFormatter = documentFormattingEditProvider.ordered(model);\n    for (const formatter of docFormatter) {\n        result.push(formatter);\n        if (formatter.extensionId) {\n            seen.add(formatter.extensionId);\n        }\n    }\n    // (2) add all range formatter as document formatter (unless the same extension already did that)\n    const rangeFormatter = documentRangeFormattingEditProvider.ordered(model);\n    for (const formatter of rangeFormatter) {\n        if (formatter.extensionId) {\n            if (seen.has(formatter.extensionId)) {\n                continue;\n            }\n            seen.add(formatter.extensionId);\n        }\n        result.push({\n            displayName: formatter.displayName,\n            extensionId: formatter.extensionId,\n            provideDocumentFormattingEdits(model, options, token) {\n                return formatter.provideDocumentRangeFormattingEdits(model, model.getFullModelRange(), options, token);\n            }\n        });\n    }\n    return result;\n}\nexport class FormattingConflicts {\n    static setFormatterSelector(selector) {\n        const remove = FormattingConflicts._selectors.unshift(selector);\n        return { dispose: remove };\n    }\n    static async select(formatter, document, mode, kind) {\n        if (formatter.length === 0) {\n            return undefined;\n        }\n        const selector = Iterable.first(FormattingConflicts._selectors);\n        if (selector) {\n            return await selector(formatter, document, mode, kind);\n        }\n        return undefined;\n    }\n}\nFormattingConflicts._selectors = new LinkedList();\nexport async function formatDocumentRangesWithSelectedProvider(accessor, editorOrModel, rangeOrRanges, mode, progress, token, userGesture) {\n    const instaService = accessor.get(IInstantiationService);\n    const { documentRangeFormattingEditProvider: documentRangeFormattingEditProviderRegistry } = accessor.get(ILanguageFeaturesService);\n    const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n    const provider = documentRangeFormattingEditProviderRegistry.ordered(model);\n    const selected = await FormattingConflicts.select(provider, model, mode, 2 /* FormattingKind.Selection */);\n    if (selected) {\n        progress.report(selected);\n        await instaService.invokeFunction(formatDocumentRangesWithProvider, selected, editorOrModel, rangeOrRanges, token, userGesture);\n    }\n}\nexport async function formatDocumentRangesWithProvider(accessor, provider, editorOrModel, rangeOrRanges, token, userGesture) {\n    var _a, _b;\n    const workerService = accessor.get(IEditorWorkerService);\n    const logService = accessor.get(ILogService);\n    const accessibilitySignalService = accessor.get(IAccessibilitySignalService);\n    let model;\n    let cts;\n    if (isCodeEditor(editorOrModel)) {\n        model = editorOrModel.getModel();\n        cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n    }\n    else {\n        model = editorOrModel;\n        cts = new TextModelCancellationTokenSource(editorOrModel, token);\n    }\n    // make sure that ranges don't overlap nor touch each other\n    const ranges = [];\n    let len = 0;\n    for (const range of asArray(rangeOrRanges).sort(Range.compareRangesUsingStarts)) {\n        if (len > 0 && Range.areIntersectingOrTouching(ranges[len - 1], range)) {\n            ranges[len - 1] = Range.fromPositions(ranges[len - 1].getStartPosition(), range.getEndPosition());\n        }\n        else {\n            len = ranges.push(range);\n        }\n    }\n    const computeEdits = async (range) => {\n        var _a, _b;\n        logService.trace(`[format][provideDocumentRangeFormattingEdits] (request)`, (_a = provider.extensionId) === null || _a === void 0 ? void 0 : _a.value, range);\n        const result = (await provider.provideDocumentRangeFormattingEdits(model, range, model.getFormattingOptions(), cts.token)) || [];\n        logService.trace(`[format][provideDocumentRangeFormattingEdits] (response)`, (_b = provider.extensionId) === null || _b === void 0 ? void 0 : _b.value, result);\n        return result;\n    };\n    const hasIntersectingEdit = (a, b) => {\n        if (!a.length || !b.length) {\n            return false;\n        }\n        // quick exit if the list of ranges are completely unrelated [O(n)]\n        const mergedA = a.reduce((acc, val) => { return Range.plusRange(acc, val.range); }, a[0].range);\n        if (!b.some(x => { return Range.intersectRanges(mergedA, x.range); })) {\n            return false;\n        }\n        // fallback to a complete check [O(n^2)]\n        for (const edit of a) {\n            for (const otherEdit of b) {\n                if (Range.intersectRanges(edit.range, otherEdit.range)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    const allEdits = [];\n    const rawEditsList = [];\n    try {\n        if (typeof provider.provideDocumentRangesFormattingEdits === 'function') {\n            logService.trace(`[format][provideDocumentRangeFormattingEdits] (request)`, (_a = provider.extensionId) === null || _a === void 0 ? void 0 : _a.value, ranges);\n            const result = (await provider.provideDocumentRangesFormattingEdits(model, ranges, model.getFormattingOptions(), cts.token)) || [];\n            logService.trace(`[format][provideDocumentRangeFormattingEdits] (response)`, (_b = provider.extensionId) === null || _b === void 0 ? void 0 : _b.value, result);\n            rawEditsList.push(result);\n        }\n        else {\n            for (const range of ranges) {\n                if (cts.token.isCancellationRequested) {\n                    return true;\n                }\n                rawEditsList.push(await computeEdits(range));\n            }\n            for (let i = 0; i < ranges.length; ++i) {\n                for (let j = i + 1; j < ranges.length; ++j) {\n                    if (cts.token.isCancellationRequested) {\n                        return true;\n                    }\n                    if (hasIntersectingEdit(rawEditsList[i], rawEditsList[j])) {\n                        // Merge ranges i and j into a single range, recompute the associated edits\n                        const mergedRange = Range.plusRange(ranges[i], ranges[j]);\n                        const edits = await computeEdits(mergedRange);\n                        ranges.splice(j, 1);\n                        ranges.splice(i, 1);\n                        ranges.push(mergedRange);\n                        rawEditsList.splice(j, 1);\n                        rawEditsList.splice(i, 1);\n                        rawEditsList.push(edits);\n                        // Restart scanning\n                        i = 0;\n                        j = 0;\n                    }\n                }\n            }\n        }\n        for (const rawEdits of rawEditsList) {\n            if (cts.token.isCancellationRequested) {\n                return true;\n            }\n            const minimalEdits = await workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            if (minimalEdits) {\n                allEdits.push(...minimalEdits);\n            }\n        }\n    }\n    finally {\n        cts.dispose();\n    }\n    if (allEdits.length === 0) {\n        return false;\n    }\n    if (isCodeEditor(editorOrModel)) {\n        // use editor to apply edits\n        FormattingEdit.execute(editorOrModel, allEdits, true);\n        editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n    }\n    else {\n        // use model to apply edits\n        const [{ range }] = allEdits;\n        const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n        model.pushEditOperations([initialSelection], allEdits.map(edit => {\n            return {\n                text: edit.text,\n                range: Range.lift(edit.range),\n                forceMoveMarkers: true\n            };\n        }), undoEdits => {\n            for (const { range } of undoEdits) {\n                if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                    return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                }\n            }\n            return null;\n        });\n    }\n    accessibilitySignalService.playSignal(AccessibilitySignal.format, { userGesture });\n    return true;\n}\nexport async function formatDocumentWithSelectedProvider(accessor, editorOrModel, mode, progress, token, userGesture) {\n    const instaService = accessor.get(IInstantiationService);\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n    const provider = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n    const selected = await FormattingConflicts.select(provider, model, mode, 1 /* FormattingKind.File */);\n    if (selected) {\n        progress.report(selected);\n        await instaService.invokeFunction(formatDocumentWithProvider, selected, editorOrModel, mode, token, userGesture);\n    }\n}\nexport async function formatDocumentWithProvider(accessor, provider, editorOrModel, mode, token, userGesture) {\n    const workerService = accessor.get(IEditorWorkerService);\n    const accessibilitySignalService = accessor.get(IAccessibilitySignalService);\n    let model;\n    let cts;\n    if (isCodeEditor(editorOrModel)) {\n        model = editorOrModel.getModel();\n        cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n    }\n    else {\n        model = editorOrModel;\n        cts = new TextModelCancellationTokenSource(editorOrModel, token);\n    }\n    let edits;\n    try {\n        const rawEdits = await provider.provideDocumentFormattingEdits(model, model.getFormattingOptions(), cts.token);\n        edits = await workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n        if (cts.token.isCancellationRequested) {\n            return true;\n        }\n    }\n    finally {\n        cts.dispose();\n    }\n    if (!edits || edits.length === 0) {\n        return false;\n    }\n    if (isCodeEditor(editorOrModel)) {\n        // use editor to apply edits\n        FormattingEdit.execute(editorOrModel, edits, mode !== 2 /* FormattingMode.Silent */);\n        if (mode !== 2 /* FormattingMode.Silent */) {\n            editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n        }\n    }\n    else {\n        // use model to apply edits\n        const [{ range }] = edits;\n        const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n        model.pushEditOperations([initialSelection], edits.map(edit => {\n            return {\n                text: edit.text,\n                range: Range.lift(edit.range),\n                forceMoveMarkers: true\n            };\n        }), undoEdits => {\n            for (const { range } of undoEdits) {\n                if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                    return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                }\n            }\n            return null;\n        });\n    }\n    accessibilitySignalService.playSignal(AccessibilitySignal.format, { userGesture });\n    return true;\n}\nexport async function getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, model, range, options, token) {\n    const providers = languageFeaturesService.documentRangeFormattingEditProvider.ordered(model);\n    for (const provider of providers) {\n        const rawEdits = await Promise.resolve(provider.provideDocumentRangeFormattingEdits(model, range, options, token)).catch(onUnexpectedExternalError);\n        if (isNonEmptyArray(rawEdits)) {\n            return await workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n        }\n    }\n    return undefined;\n}\nexport async function getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, model, options, token) {\n    const providers = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n    for (const provider of providers) {\n        const rawEdits = await Promise.resolve(provider.provideDocumentFormattingEdits(model, options, token)).catch(onUnexpectedExternalError);\n        if (isNonEmptyArray(rawEdits)) {\n            return await workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n        }\n    }\n    return undefined;\n}\nexport function getOnTypeFormattingEdits(workerService, languageFeaturesService, model, position, ch, options, token) {\n    const providers = languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n    if (providers.length === 0) {\n        return Promise.resolve(undefined);\n    }\n    if (providers[0].autoFormatTriggerCharacters.indexOf(ch) < 0) {\n        return Promise.resolve(undefined);\n    }\n    return Promise.resolve(providers[0].provideOnTypeFormattingEdits(model, position, ch, options, token)).catch(onUnexpectedExternalError).then(edits => {\n        return workerService.computeMoreMinimalEdits(model.uri, edits);\n    });\n}\nCommandsRegistry.registerCommand('_executeFormatRangeProvider', async function (accessor, ...args) {\n    const [resource, range, options] = args;\n    assertType(URI.isUri(resource));\n    assertType(Range.isIRange(range));\n    const resolverService = accessor.get(ITextModelService);\n    const workerService = accessor.get(IEditorWorkerService);\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const reference = await resolverService.createModelReference(resource);\n    try {\n        return getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, Range.lift(range), options, CancellationToken.None);\n    }\n    finally {\n        reference.dispose();\n    }\n});\nCommandsRegistry.registerCommand('_executeFormatDocumentProvider', async function (accessor, ...args) {\n    const [resource, options] = args;\n    assertType(URI.isUri(resource));\n    const resolverService = accessor.get(ITextModelService);\n    const workerService = accessor.get(IEditorWorkerService);\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const reference = await resolverService.createModelReference(resource);\n    try {\n        return getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, options, CancellationToken.None);\n    }\n    finally {\n        reference.dispose();\n    }\n});\nCommandsRegistry.registerCommand('_executeFormatOnTypeProvider', async function (accessor, ...args) {\n    const [resource, position, ch, options] = args;\n    assertType(URI.isUri(resource));\n    assertType(Position.isIPosition(position));\n    assertType(typeof ch === 'string');\n    const resolverService = accessor.get(ITextModelService);\n    const workerService = accessor.get(IEditorWorkerService);\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const reference = await resolverService.createModelReference(resource);\n    try {\n        return getOnTypeFormattingEdits(workerService, languageFeaturesService, reference.object.textEditorModel, Position.lift(position), ch, options, CancellationToken.None);\n    }\n    finally {\n        reference.dispose();\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { formatDocumentRangesWithSelectedProvider, formatDocumentWithSelectedProvider, getOnTypeFormattingEdits } from './format.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { AccessibilitySignal, IAccessibilitySignalService } from '../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditorProgressService, Progress } from '../../../../platform/progress/common/progress.js';\nlet FormatOnType = class FormatOnType {\n    constructor(_editor, _languageFeaturesService, _workerService, _accessibilitySignalService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._workerService = _workerService;\n        this._accessibilitySignalService = _accessibilitySignalService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._disposables.add(_languageFeaturesService.onTypeFormattingEditProvider.onDidChange(this._update, this));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(56 /* EditorOption.formatOnType */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._sessionDisposables.dispose();\n    }\n    _update() {\n        // clean up\n        this._sessionDisposables.clear();\n        // we are disabled\n        if (!this._editor.getOption(56 /* EditorOption.formatOnType */)) {\n            return;\n        }\n        // no model\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        // no support\n        const [support] = this._languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n        if (!support || !support.autoFormatTriggerCharacters) {\n            return;\n        }\n        // register typing listeners that will trigger the format\n        const triggerChars = new CharacterSet();\n        for (const ch of support.autoFormatTriggerCharacters) {\n            triggerChars.add(ch.charCodeAt(0));\n        }\n        this._sessionDisposables.add(this._editor.onDidType((text) => {\n            const lastCharCode = text.charCodeAt(text.length - 1);\n            if (triggerChars.has(lastCharCode)) {\n                this._trigger(String.fromCharCode(lastCharCode));\n            }\n        }));\n    }\n    _trigger(ch) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (this._editor.getSelections().length > 1 || !this._editor.getSelection().isEmpty()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const position = this._editor.getPosition();\n        const cts = new CancellationTokenSource();\n        // install a listener that checks if edits happens before the\n        // position on which we format right now. If so, we won't\n        // apply the format edits\n        const unbind = this._editor.onDidChangeModelContent((e) => {\n            if (e.isFlush) {\n                // a model.setValue() was called\n                // cancel only once\n                cts.cancel();\n                unbind.dispose();\n                return;\n            }\n            for (let i = 0, len = e.changes.length; i < len; i++) {\n                const change = e.changes[i];\n                if (change.range.endLineNumber <= position.lineNumber) {\n                    // cancel only once\n                    cts.cancel();\n                    unbind.dispose();\n                    return;\n                }\n            }\n        });\n        getOnTypeFormattingEdits(this._workerService, this._languageFeaturesService, model, position, ch, model.getFormattingOptions(), cts.token).then(edits => {\n            if (cts.token.isCancellationRequested) {\n                return;\n            }\n            if (isNonEmptyArray(edits)) {\n                this._accessibilitySignalService.playSignal(AccessibilitySignal.format, { userGesture: false });\n                FormattingEdit.execute(this._editor, edits, true);\n            }\n        }).finally(() => {\n            unbind.dispose();\n        });\n    }\n};\nFormatOnType.ID = 'editor.contrib.autoFormat';\nFormatOnType = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IEditorWorkerService),\n    __param(3, IAccessibilitySignalService)\n], FormatOnType);\nexport { FormatOnType };\nlet FormatOnPaste = class FormatOnPaste {\n    constructor(editor, _languageFeaturesService, _instantiationService) {\n        this.editor = editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instantiationService = _instantiationService;\n        this._callOnDispose = new DisposableStore();\n        this._callOnModel = new DisposableStore();\n        this._callOnDispose.add(editor.onDidChangeConfiguration(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModel(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(() => this._update()));\n        this._callOnDispose.add(_languageFeaturesService.documentRangeFormattingEditProvider.onDidChange(this._update, this));\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        this._callOnModel.dispose();\n    }\n    _update() {\n        // clean up\n        this._callOnModel.clear();\n        // we are disabled\n        if (!this.editor.getOption(55 /* EditorOption.formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        // no formatter\n        if (!this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())) {\n            return;\n        }\n        this._callOnModel.add(this.editor.onDidPaste(({ range }) => this._trigger(range)));\n    }\n    _trigger(range) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (this.editor.getSelections().length > 1) {\n            return;\n        }\n        this._instantiationService.invokeFunction(formatDocumentRangesWithSelectedProvider, this.editor, range, 2 /* FormattingMode.Silent */, Progress.None, CancellationToken.None, false).catch(onUnexpectedError);\n    }\n};\nFormatOnPaste.ID = 'editor.contrib.formatOnPaste';\nFormatOnPaste = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IInstantiationService)\n], FormatOnPaste);\nclass FormatDocumentAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatDocument',\n            label: nls.localize('formatDocument.label', \"Format Document\"),\n            alias: 'Format Document',\n            precondition: ContextKeyExpr.and(EditorContextKeys.notInCompositeEditor, EditorContextKeys.writable, EditorContextKeys.hasDocumentFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 39 /* KeyCode.KeyI */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.3\n            }\n        });\n    }\n    async run(accessor, editor) {\n        if (editor.hasModel()) {\n            const instaService = accessor.get(IInstantiationService);\n            const progressService = accessor.get(IEditorProgressService);\n            await progressService.showWhile(instaService.invokeFunction(formatDocumentWithSelectedProvider, editor, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None, true), 250);\n        }\n    }\n}\nclass FormatSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatSelection',\n            label: nls.localize('formatSelection.label', \"Format Selection\"),\n            alias: 'Format Selection',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentSelectionFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                when: EditorContextKeys.hasNonEmptySelection,\n                group: '1_modification',\n                order: 1.31\n            }\n        });\n    }\n    async run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const instaService = accessor.get(IInstantiationService);\n        const model = editor.getModel();\n        const ranges = editor.getSelections().map(range => {\n            return range.isEmpty()\n                ? new Range(range.startLineNumber, 1, range.startLineNumber, model.getLineMaxColumn(range.startLineNumber))\n                : range;\n        });\n        const progressService = accessor.get(IEditorProgressService);\n        await progressService.showWhile(instaService.invokeFunction(formatDocumentRangesWithSelectedProvider, editor, ranges, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None, true), 250);\n    }\n}\nregisterEditorContribution(FormatOnType.ID, FormatOnType, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorContribution(FormatOnPaste.ID, FormatOnPaste, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(FormatDocumentAction);\nregisterEditorAction(FormatSelectionAction);\n// this is the old format action that does both (format document OR format selection)\n// and we keep it here such that existing keybinding configurations etc will still work\nCommandsRegistry.registerCommand('editor.action.format', async (accessor) => {\n    const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n    if (!editor || !editor.hasModel()) {\n        return;\n    }\n    const commandService = accessor.get(ICommandService);\n    if (editor.getSelection().isEmpty()) {\n        await commandService.executeCommand('editor.action.formatDocument');\n    }\n    else {\n        await commandService.executeCommand('editor.action.formatSelection');\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nexport class FormattingEdit {\n    static _handleEolEdits(editor, edits) {\n        let newEol = undefined;\n        const singleEdits = [];\n        for (const edit of edits) {\n            if (typeof edit.eol === 'number') {\n                newEol = edit.eol;\n            }\n            if (edit.range && typeof edit.text === 'string') {\n                singleEdits.push(edit);\n            }\n        }\n        if (typeof newEol === 'number') {\n            if (editor.hasModel()) {\n                editor.getModel().pushEOL(newEol);\n            }\n        }\n        return singleEdits;\n    }\n    static _isFullModelReplaceEdit(editor, edit) {\n        if (!editor.hasModel()) {\n            return false;\n        }\n        const model = editor.getModel();\n        const editRange = model.validateRange(edit.range);\n        const fullModelRange = model.getFullModelRange();\n        return fullModelRange.equalsRange(editRange);\n    }\n    static execute(editor, _edits, addUndoStops) {\n        if (addUndoStops) {\n            editor.pushUndoStop();\n        }\n        const scrollState = StableEditorScrollState.capture(editor);\n        const edits = FormattingEdit._handleEolEdits(editor, _edits);\n        if (edits.length === 1 && FormattingEdit._isFullModelReplaceEdit(editor, edits[0])) {\n            // We use replace semantics and hope that markers stay put...\n            editor.executeEdits('formatEditsCommand', edits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text)));\n        }\n        else {\n            editor.executeEdits('formatEditsCommand', edits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n        }\n        if (addUndoStops) {\n            editor.pushUndoStop();\n        }\n        scrollState.restoreRelativeVerticalPositionOfCursor(editor);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport class MarkerCoordinate {\n    constructor(marker, index, total) {\n        this.marker = marker;\n        this.index = index;\n        this.total = total;\n    }\n}\nlet MarkerList = class MarkerList {\n    constructor(resourceFilter, _markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._dispoables = new DisposableStore();\n        this._markers = [];\n        this._nextIdx = -1;\n        if (URI.isUri(resourceFilter)) {\n            this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\n        }\n        else if (resourceFilter) {\n            this._resourceFilter = resourceFilter;\n        }\n        const compareOrder = this._configService.getValue('problems.sortOrder');\n        const compareMarker = (a, b) => {\n            let res = compare(a.resource.toString(), b.resource.toString());\n            if (res === 0) {\n                if (compareOrder === 'position') {\n                    res = Range.compareRangesUsingStarts(a, b) || MarkerSeverity.compare(a.severity, b.severity);\n                }\n                else {\n                    res = MarkerSeverity.compare(a.severity, b.severity) || Range.compareRangesUsingStarts(a, b);\n                }\n            }\n            return res;\n        };\n        const updateMarker = () => {\n            this._markers = this._markerService.read({\n                resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\n                severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n            });\n            if (typeof resourceFilter === 'function') {\n                this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\n            }\n            this._markers.sort(compareMarker);\n        };\n        updateMarker();\n        this._dispoables.add(_markerService.onMarkerChanged(uris => {\n            if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\n                updateMarker();\n                this._nextIdx = -1;\n                this._onDidChange.fire();\n            }\n        }));\n    }\n    dispose() {\n        this._dispoables.dispose();\n        this._onDidChange.dispose();\n    }\n    matches(uri) {\n        if (!this._resourceFilter && !uri) {\n            return true;\n        }\n        if (!this._resourceFilter || !uri) {\n            return false;\n        }\n        return this._resourceFilter(uri);\n    }\n    get selected() {\n        const marker = this._markers[this._nextIdx];\n        return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\n    }\n    _initIdx(model, position, fwd) {\n        let found = false;\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\n        if (idx < 0) {\n            idx = binarySearch(this._markers, { resource: model.uri }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\n            if (idx < 0) {\n                idx = ~idx;\n            }\n        }\n        for (let i = idx; i < this._markers.length; i++) {\n            let range = Range.lift(this._markers[i]);\n            if (range.isEmpty()) {\n                const word = model.getWordAtPosition(range.getStartPosition());\n                if (word) {\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n                }\n            }\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n                this._nextIdx = i;\n                found = true;\n                break;\n            }\n            if (this._markers[i].resource.toString() !== model.uri.toString()) {\n                break;\n            }\n        }\n        if (!found) {\n            // after the last change\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\n        }\n        if (this._nextIdx < 0) {\n            this._nextIdx = this._markers.length - 1;\n        }\n    }\n    resetIndex() {\n        this._nextIdx = -1;\n    }\n    move(fwd, model, position) {\n        if (this._markers.length === 0) {\n            return false;\n        }\n        const oldIdx = this._nextIdx;\n        if (this._nextIdx === -1) {\n            this._initIdx(model, position, fwd);\n        }\n        else if (fwd) {\n            this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n        }\n        else if (!fwd) {\n            this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n        }\n        if (oldIdx !== this._nextIdx) {\n            return true;\n        }\n        return false;\n    }\n    find(uri, position) {\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\n        if (idx < 0) {\n            return undefined;\n        }\n        for (; idx < this._markers.length; idx++) {\n            if (Range.containsPosition(this._markers[idx], position)) {\n                return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\n            }\n        }\n        return undefined;\n    }\n};\nMarkerList = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IConfigurationService)\n], MarkerList);\nexport { MarkerList };\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\nlet MarkerNavigationService = class MarkerNavigationService {\n    constructor(_markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._provider = new LinkedList();\n    }\n    getMarkerList(resource) {\n        for (const provider of this._provider) {\n            const result = provider.getMarkerList(resource);\n            if (result) {\n                return result;\n            }\n        }\n        // default\n        return new MarkerList(resource, this._markerService, this._configService);\n    }\n};\nMarkerNavigationService = __decorate([\n    __param(0, IMarkerService),\n    __param(1, IConfigurationService)\n], MarkerNavigationService);\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, 1 /* InstantiationType.Delayed */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar MarkerNavigationWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { splitLines } from '../../../../base/common/strings.js';\nimport './media/gotoErrorWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { peekViewTitleForeground, peekViewTitleInfoForeground, PeekViewWidget } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { createAndFillInActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { SeverityIcon } from '../../../../platform/severityIcon/browser/severityIcon.js';\nimport { contrastBorder, editorBackground, editorErrorBorder, editorErrorForeground, editorInfoBorder, editorInfoForeground, editorWarningBorder, editorWarningForeground, oneOf, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nclass MessageWidget {\n    constructor(parent, editor, onRelatedInformation, _openerService, _labelService) {\n        this._openerService = _openerService;\n        this._labelService = _labelService;\n        this._lines = 0;\n        this._longestLineLength = 0;\n        this._relatedDiagnostics = new WeakMap();\n        this._disposables = new DisposableStore();\n        this._editor = editor;\n        const domNode = document.createElement('div');\n        domNode.className = 'descriptioncontainer';\n        this._messageBlock = document.createElement('div');\n        this._messageBlock.classList.add('message');\n        this._messageBlock.setAttribute('aria-live', 'assertive');\n        this._messageBlock.setAttribute('role', 'alert');\n        domNode.appendChild(this._messageBlock);\n        this._relatedBlock = document.createElement('div');\n        domNode.appendChild(this._relatedBlock);\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', event => {\n            event.preventDefault();\n            const related = this._relatedDiagnostics.get(event.target);\n            if (related) {\n                onRelatedInformation(related);\n            }\n        }));\n        this._scrollable = new ScrollableElement(domNode, {\n            horizontal: 1 /* ScrollbarVisibility.Auto */,\n            vertical: 1 /* ScrollbarVisibility.Auto */,\n            useShadows: false,\n            horizontalScrollbarSize: 6,\n            verticalScrollbarSize: 6\n        });\n        parent.appendChild(this._scrollable.getDomNode());\n        this._disposables.add(this._scrollable.onScroll(e => {\n            domNode.style.left = `-${e.scrollLeft}px`;\n            domNode.style.top = `-${e.scrollTop}px`;\n        }));\n        this._disposables.add(this._scrollable);\n    }\n    dispose() {\n        dispose(this._disposables);\n    }\n    update(marker) {\n        const { source, message, relatedInformation, code } = marker;\n        let sourceAndCodeLength = ((source === null || source === void 0 ? void 0 : source.length) || 0) + '()'.length;\n        if (code) {\n            if (typeof code === 'string') {\n                sourceAndCodeLength += code.length;\n            }\n            else {\n                sourceAndCodeLength += code.value.length;\n            }\n        }\n        const lines = splitLines(message);\n        this._lines = lines.length;\n        this._longestLineLength = 0;\n        for (const line of lines) {\n            this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\n        }\n        dom.clearNode(this._messageBlock);\n        this._messageBlock.setAttribute('aria-label', this.getAriaLabel(marker));\n        this._editor.applyFontInfo(this._messageBlock);\n        let lastLineElement = this._messageBlock;\n        for (const line of lines) {\n            lastLineElement = document.createElement('div');\n            lastLineElement.innerText = line;\n            if (line === '') {\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\n            }\n            this._messageBlock.appendChild(lastLineElement);\n        }\n        if (source || code) {\n            const detailsElement = document.createElement('span');\n            detailsElement.classList.add('details');\n            lastLineElement.appendChild(detailsElement);\n            if (source) {\n                const sourceElement = document.createElement('span');\n                sourceElement.innerText = source;\n                sourceElement.classList.add('source');\n                detailsElement.appendChild(sourceElement);\n            }\n            if (code) {\n                if (typeof code === 'string') {\n                    const codeElement = document.createElement('span');\n                    codeElement.innerText = `(${code})`;\n                    codeElement.classList.add('code');\n                    detailsElement.appendChild(codeElement);\n                }\n                else {\n                    this._codeLink = dom.$('a.code-link');\n                    this._codeLink.setAttribute('href', `${code.target.toString()}`);\n                    this._codeLink.onclick = (e) => {\n                        this._openerService.open(code.target, { allowCommands: true });\n                        e.preventDefault();\n                        e.stopPropagation();\n                    };\n                    const codeElement = dom.append(this._codeLink, dom.$('span'));\n                    codeElement.innerText = code.value;\n                    detailsElement.appendChild(this._codeLink);\n                }\n            }\n        }\n        dom.clearNode(this._relatedBlock);\n        this._editor.applyFontInfo(this._relatedBlock);\n        if (isNonEmptyArray(relatedInformation)) {\n            const relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\n            relatedInformationNode.style.paddingTop = `${Math.floor(this._editor.getOption(67 /* EditorOption.lineHeight */) * 0.66)}px`;\n            this._lines += 1;\n            for (const related of relatedInformation) {\n                const container = document.createElement('div');\n                const relatedResource = document.createElement('a');\n                relatedResource.classList.add('filename');\n                relatedResource.innerText = `${this._labelService.getUriBasenameLabel(related.resource)}(${related.startLineNumber}, ${related.startColumn}): `;\n                relatedResource.title = this._labelService.getUriLabel(related.resource);\n                this._relatedDiagnostics.set(relatedResource, related);\n                const relatedMessage = document.createElement('span');\n                relatedMessage.innerText = related.message;\n                container.appendChild(relatedResource);\n                container.appendChild(relatedMessage);\n                this._lines += 1;\n                relatedInformationNode.appendChild(container);\n            }\n        }\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        const scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\n        const scrollHeight = fontInfo.lineHeight * this._lines;\n        this._scrollable.setScrollDimensions({ scrollWidth, scrollHeight });\n    }\n    layout(height, width) {\n        this._scrollable.getDomNode().style.height = `${height}px`;\n        this._scrollable.getDomNode().style.width = `${width}px`;\n        this._scrollable.setScrollDimensions({ width, height });\n    }\n    getHeightInLines() {\n        return Math.min(17, this._lines);\n    }\n    getAriaLabel(marker) {\n        let severityLabel = '';\n        switch (marker.severity) {\n            case MarkerSeverity.Error:\n                severityLabel = nls.localize('Error', \"Error\");\n                break;\n            case MarkerSeverity.Warning:\n                severityLabel = nls.localize('Warning', \"Warning\");\n                break;\n            case MarkerSeverity.Info:\n                severityLabel = nls.localize('Info', \"Info\");\n                break;\n            case MarkerSeverity.Hint:\n                severityLabel = nls.localize('Hint', \"Hint\");\n                break;\n        }\n        let ariaLabel = nls.localize('marker aria', \"{0} at {1}. \", severityLabel, marker.startLineNumber + ':' + marker.startColumn);\n        const model = this._editor.getModel();\n        if (model && (marker.startLineNumber <= model.getLineCount()) && (marker.startLineNumber >= 1)) {\n            const lineContent = model.getLineContent(marker.startLineNumber);\n            ariaLabel = `${lineContent}, ${ariaLabel}`;\n        }\n        return ariaLabel;\n    }\n}\nlet MarkerNavigationWidget = MarkerNavigationWidget_1 = class MarkerNavigationWidget extends PeekViewWidget {\n    constructor(editor, _themeService, _openerService, _menuService, instantiationService, _contextKeyService, _labelService) {\n        super(editor, { showArrow: true, showFrame: true, isAccessible: true, frameWidth: 1 }, instantiationService);\n        this._themeService = _themeService;\n        this._openerService = _openerService;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._labelService = _labelService;\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectRelatedInformation = new Emitter();\n        this.onDidSelectRelatedInformation = this._onDidSelectRelatedInformation.event;\n        this._severity = MarkerSeverity.Warning;\n        this._backgroundColor = Color.white;\n        this._applyTheme(_themeService.getColorTheme());\n        this._callOnDispose.add(_themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this.create();\n    }\n    _applyTheme(theme) {\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\n        let colorId = editorMarkerNavigationError;\n        let headerBackground = editorMarkerNavigationErrorHeader;\n        if (this._severity === MarkerSeverity.Warning) {\n            colorId = editorMarkerNavigationWarning;\n            headerBackground = editorMarkerNavigationWarningHeader;\n        }\n        else if (this._severity === MarkerSeverity.Info) {\n            colorId = editorMarkerNavigationInfo;\n            headerBackground = editorMarkerNavigationInfoHeader;\n        }\n        const frameColor = theme.getColor(colorId);\n        const headerBg = theme.getColor(headerBackground);\n        this.style({\n            arrowColor: frameColor,\n            frameColor: frameColor,\n            headerBackgroundColor: headerBg,\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\n        }); // style() will trigger _applyStyles\n    }\n    _applyStyles() {\n        if (this._parentContainer) {\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\n        }\n        super._applyStyles();\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        super.dispose();\n    }\n    _fillHead(container) {\n        super._fillHead(container);\n        this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(e => this.editor.focus()));\n        const actions = [];\n        const menu = this._menuService.createMenu(MarkerNavigationWidget_1.TitleMenu, this._contextKeyService);\n        createAndFillInActionBarActions(menu, undefined, actions);\n        this._actionbarWidget.push(actions, { label: false, icon: true, index: 0 });\n        menu.dispose();\n    }\n    _fillTitleIcon(container) {\n        this._icon = dom.append(container, dom.$(''));\n    }\n    _fillBody(container) {\n        this._parentContainer = container;\n        container.classList.add('marker-widget');\n        this._parentContainer.tabIndex = 0;\n        this._parentContainer.setAttribute('role', 'tooltip');\n        this._container = document.createElement('div');\n        container.appendChild(this._container);\n        this._message = new MessageWidget(this._container, this.editor, related => this._onDidSelectRelatedInformation.fire(related), this._openerService, this._labelService);\n        this._disposables.add(this._message);\n    }\n    show() {\n        throw new Error('call showAtMarker');\n    }\n    showAtMarker(marker, markerIdx, markerCount) {\n        // update:\n        // * title\n        // * message\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n        // update frame color (only applied on 'show')\n        this._severity = marker.severity;\n        this._applyTheme(this._themeService.getColorTheme());\n        // show\n        const range = Range.lift(marker);\n        const editorPosition = this.editor.getPosition();\n        const position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\n        super.show(position, this.computeRequiredHeight());\n        const model = this.editor.getModel();\n        if (model) {\n            const detail = markerCount > 1\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\n            this.setTitle(basename(model.uri), detail);\n        }\n        this._icon.className = `codicon ${SeverityIcon.className(MarkerSeverity.toSeverity(this._severity))}`;\n        this.editor.revealPositionNearTop(position, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    updateMarker(marker) {\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n    }\n    showStale() {\n        this._container.classList.add('stale');\n        this._relayout();\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._heightInPixel = heightInPixel;\n        this._message.layout(heightInPixel, widthInPixel);\n        this._container.style.height = `${heightInPixel}px`;\n    }\n    _onWidth(widthInPixel) {\n        this._message.layout(this._heightInPixel, widthInPixel);\n    }\n    _relayout() {\n        super._relayout(this.computeRequiredHeight());\n    }\n    computeRequiredHeight() {\n        return 3 + this._message.getHeightInLines();\n    }\n};\nMarkerNavigationWidget.TitleMenu = new MenuId('gotoErrorTitleMenu');\nMarkerNavigationWidget = MarkerNavigationWidget_1 = __decorate([\n    __param(1, IThemeService),\n    __param(2, IOpenerService),\n    __param(3, IMenuService),\n    __param(4, IInstantiationService),\n    __param(5, IContextKeyService),\n    __param(6, ILabelService)\n], MarkerNavigationWidget);\nexport { MarkerNavigationWidget };\n// theming\nconst errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\nconst warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\nconst infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\nconst editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\nconst editorMarkerNavigationErrorHeader = registerColor('editorMarkerNavigationError.headerBackground', { dark: transparent(editorMarkerNavigationError, .1), light: transparent(editorMarkerNavigationError, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationErrorHeaderBackground', 'Editor marker navigation widget error heading background.'));\nconst editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\nconst editorMarkerNavigationWarningHeader = registerColor('editorMarkerNavigationWarning.headerBackground', { dark: transparent(editorMarkerNavigationWarning, .1), light: transparent(editorMarkerNavigationWarning, .1), hcDark: '#0C141F', hcLight: transparent(editorMarkerNavigationWarning, .2) }, nls.localize('editorMarkerNavigationWarningBackground', 'Editor marker navigation widget warning heading background.'));\nconst editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\nconst editorMarkerNavigationInfoHeader = registerColor('editorMarkerNavigationInfo.headerBackground', { dark: transparent(editorMarkerNavigationInfo, .1), light: transparent(editorMarkerNavigationInfo, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationInfoHeaderBackground', 'Editor marker navigation widget info heading background.'));\nconst editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', { dark: editorBackground, light: editorBackground, hcDark: editorBackground, hcLight: editorBackground }, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar MarkerController_1;\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IMarkerNavigationService } from './markerNavigationService.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\nlet MarkerController = MarkerController_1 = class MarkerController {\n    static get(editor) {\n        return editor.getContribution(MarkerController_1.ID);\n    }\n    constructor(editor, _markerNavigationService, _contextKeyService, _editorService, _instantiationService) {\n        this._markerNavigationService = _markerNavigationService;\n        this._contextKeyService = _contextKeyService;\n        this._editorService = _editorService;\n        this._instantiationService = _instantiationService;\n        this._sessionDispoables = new DisposableStore();\n        this._editor = editor;\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\n    }\n    dispose() {\n        this._cleanUp();\n        this._sessionDispoables.dispose();\n    }\n    _cleanUp() {\n        this._widgetVisible.reset();\n        this._sessionDispoables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    _getOrCreateModel(uri) {\n        if (this._model && this._model.matches(uri)) {\n            return this._model;\n        }\n        let reusePosition = false;\n        if (this._model) {\n            reusePosition = true;\n            this._cleanUp();\n        }\n        this._model = this._markerNavigationService.getMarkerList(uri);\n        if (reusePosition) {\n            this._model.move(true, this._editor.getModel(), this._editor.getPosition());\n        }\n        this._widget = this._instantiationService.createInstance(MarkerNavigationWidget, this._editor);\n        this._widget.onDidClose(() => this.close(), this, this._sessionDispoables);\n        this._widgetVisible.set(true);\n        this._sessionDispoables.add(this._model);\n        this._sessionDispoables.add(this._widget);\n        // follow cursor\n        this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(e => {\n            var _a, _b, _c;\n            if (!((_a = this._model) === null || _a === void 0 ? void 0 : _a.selected) || !Range.containsPosition((_b = this._model) === null || _b === void 0 ? void 0 : _b.selected.marker, e.position)) {\n                (_c = this._model) === null || _c === void 0 ? void 0 : _c.resetIndex();\n            }\n        }));\n        // update markers\n        this._sessionDispoables.add(this._model.onDidChange(() => {\n            if (!this._widget || !this._widget.position || !this._model) {\n                return;\n            }\n            const info = this._model.find(this._editor.getModel().uri, this._widget.position);\n            if (info) {\n                this._widget.updateMarker(info.marker);\n            }\n            else {\n                this._widget.showStale();\n            }\n        }));\n        // open related\n        this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(related => {\n            this._editorService.openCodeEditor({\n                resource: related.resource,\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\n            }, this._editor);\n            this.close(false);\n        }));\n        this._sessionDispoables.add(this._editor.onDidChangeModel(() => this._cleanUp()));\n        return this._model;\n    }\n    close(focusEditor = true) {\n        this._cleanUp();\n        if (focusEditor) {\n            this._editor.focus();\n        }\n    }\n    showAtMarker(marker) {\n        if (this._editor.hasModel()) {\n            const model = this._getOrCreateModel(this._editor.getModel().uri);\n            model.resetIndex();\n            model.move(true, this._editor.getModel(), new Position(marker.startLineNumber, marker.startColumn));\n            if (model.selected) {\n                this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n            }\n        }\n    }\n    async nagivate(next, multiFile) {\n        var _a, _b;\n        if (this._editor.hasModel()) {\n            const model = this._getOrCreateModel(multiFile ? undefined : this._editor.getModel().uri);\n            model.move(next, this._editor.getModel(), this._editor.getPosition());\n            if (!model.selected) {\n                return;\n            }\n            if (model.selected.marker.resource.toString() !== this._editor.getModel().uri.toString()) {\n                // show in different editor\n                this._cleanUp();\n                const otherEditor = await this._editorService.openCodeEditor({\n                    resource: model.selected.marker.resource,\n                    options: { pinned: false, revealIfOpened: true, selectionRevealType: 2 /* TextEditorSelectionRevealType.NearTop */, selection: model.selected.marker }\n                }, this._editor);\n                if (otherEditor) {\n                    (_a = MarkerController_1.get(otherEditor)) === null || _a === void 0 ? void 0 : _a.close();\n                    (_b = MarkerController_1.get(otherEditor)) === null || _b === void 0 ? void 0 : _b.nagivate(next, multiFile);\n                }\n            }\n            else {\n                // show in this editor\n                this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n            }\n        }\n    }\n};\nMarkerController.ID = 'editor.contrib.markerController';\nMarkerController = MarkerController_1 = __decorate([\n    __param(1, IMarkerNavigationService),\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, IInstantiationService)\n], MarkerController);\nexport { MarkerController };\nclass MarkerNavigationAction extends EditorAction {\n    constructor(_next, _multiFile, opts) {\n        super(opts);\n        this._next = _next;\n        this._multiFile = _multiFile;\n    }\n    async run(_accessor, editor) {\n        var _a;\n        if (editor.hasModel()) {\n            (_a = MarkerController.get(editor)) === null || _a === void 0 ? void 0 : _a.nagivate(this._next, this._multiFile);\n        }\n    }\n}\nexport class NextMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, false, {\n            id: NextMarkerAction.ID,\n            label: NextMarkerAction.LABEL,\n            alias: 'Go to Next Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: NextMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-next', Codicon.arrowDown, nls.localize('nextMarkerIcon', 'Icon for goto next marker.')),\n                group: 'navigation',\n                order: 1\n            }\n        });\n    }\n}\nNextMarkerAction.ID = 'editor.action.marker.next';\nNextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\nclass PrevMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, false, {\n            id: PrevMarkerAction.ID,\n            label: PrevMarkerAction.LABEL,\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: PrevMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-previous', Codicon.arrowUp, nls.localize('previousMarkerIcon', 'Icon for goto previous marker.')),\n                group: 'navigation',\n                order: 2\n            }\n        });\n    }\n}\nPrevMarkerAction.ID = 'editor.action.marker.prev';\nPrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\nclass NextMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, true, {\n            id: 'editor.action.marker.nextInFiles',\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\"),\n                group: '6_problem_nav',\n                order: 1\n            }\n        });\n    }\n}\nclass PrevMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, true, {\n            id: 'editor.action.marker.prevInFiles',\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\"),\n                group: '6_problem_nav',\n                order: 2\n            }\n        });\n    }\n}\nregisterEditorContribution(MarkerController.ID, MarkerController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(NextMarkerAction);\nregisterEditorAction(PrevMarkerAction);\nregisterEditorAction(NextMarkerInFilesAction);\nregisterEditorAction(PrevMarkerInFilesAction);\nconst CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\nconst MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\nregisterEditorCommand(new MarkerCommand({\n    id: 'closeMarkersNavigation',\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\n    handler: x => x.close(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 50,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { combinedDisposable, DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nexport const ctxHasSymbols = new RawContextKey('hasSymbols', false, localize('hasSymbols', \"Whether there are symbol locations that can be navigated via keyboard-only.\"));\nexport const ISymbolNavigationService = createDecorator('ISymbolNavigationService');\nlet SymbolNavigationService = class SymbolNavigationService {\n    constructor(contextKeyService, _editorService, _notificationService, _keybindingService) {\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._keybindingService = _keybindingService;\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n        this._ignoreEditorChange = false;\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\n    }\n    reset() {\n        var _a, _b;\n        this._ctxHasSymbols.reset();\n        (_a = this._currentState) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentMessage) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n    }\n    put(anchor) {\n        const refModel = anchor.parent.parent;\n        if (refModel.references.length <= 1) {\n            this.reset();\n            return;\n        }\n        this._currentModel = refModel;\n        this._currentIdx = refModel.references.indexOf(anchor);\n        this._ctxHasSymbols.set(true);\n        this._showMessage();\n        const editorState = new EditorState(this._editorService);\n        const listener = editorState.onDidChange(_ => {\n            if (this._ignoreEditorChange) {\n                return;\n            }\n            const editor = this._editorService.getActiveCodeEditor();\n            if (!editor) {\n                return;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!model || !position) {\n                return;\n            }\n            let seenUri = false;\n            let seenPosition = false;\n            for (const reference of refModel.references) {\n                if (isEqual(reference.uri, model.uri)) {\n                    seenUri = true;\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\n                }\n                else if (seenUri) {\n                    break;\n                }\n            }\n            if (!seenUri || !seenPosition) {\n                this.reset();\n            }\n        });\n        this._currentState = combinedDisposable(editorState, listener);\n    }\n    revealNext(source) {\n        if (!this._currentModel) {\n            return Promise.resolve();\n        }\n        // get next result and advance\n        this._currentIdx += 1;\n        this._currentIdx %= this._currentModel.references.length;\n        const reference = this._currentModel.references[this._currentIdx];\n        // status\n        this._showMessage();\n        // open editor, ignore events while that happens\n        this._ignoreEditorChange = true;\n        return this._editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(reference.range),\n                selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */\n            }\n        }, source).finally(() => {\n            this._ignoreEditorChange = false;\n        });\n    }\n    _showMessage() {\n        var _a;\n        (_a = this._currentMessage) === null || _a === void 0 ? void 0 : _a.dispose();\n        const kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\n        const message = kb\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\n        this._currentMessage = this._notificationService.status(message);\n    }\n};\nSymbolNavigationService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ICodeEditorService),\n    __param(2, INotificationService),\n    __param(3, IKeybindingService)\n], SymbolNavigationService);\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, 1 /* InstantiationType.Delayed */);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.gotoNextSymbolFromResult',\n            precondition: ctxHasSymbols,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 70 /* KeyCode.F12 */\n            }\n        });\n    }\n    runEditorCommand(accessor, editor) {\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'editor.gotoNextSymbolFromResult.cancel',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    when: ctxHasSymbols,\n    primary: 9 /* KeyCode.Escape */,\n    handler(accessor) {\n        accessor.get(ISymbolNavigationService).reset();\n    }\n});\n//\nlet EditorState = class EditorState {\n    constructor(editorService) {\n        this._listener = new Map();\n        this._disposables = new DisposableStore();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._onDidChange.dispose();\n        dispose(this._listener.values());\n    }\n    _onDidAddEditor(editor) {\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(_ => this._onDidChange.fire({ editor })), editor.onDidChangeModelContent(_ => this._onDidChange.fire({ editor }))));\n    }\n    _onDidRemoveEditor(editor) {\n        var _a;\n        (_a = this._listener.get(editor)) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._listener.delete(editor);\n    }\n};\nEditorState = __decorate([\n    __param(0, ICodeEditorService)\n], EditorState);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar _a, _b, _c, _d, _e, _f, _g, _h;\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction2 } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport * as corePosition from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { isLocationLink } from '../../../common/languages.js';\nimport { ReferencesController } from './peek/referencesController.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ISymbolNavigationService } from './symbolNavigation.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { getDeclarationsAtPosition, getDefinitionsAtPosition, getImplementationsAtPosition, getReferencesAtPosition, getTypeDefinitionsAtPosition } from './goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { IsWebContext } from '../../../../platform/contextkey/common/contextkeys.js';\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\n    submenu: MenuId.EditorContextPeek,\n    title: nls.localize('peek.submenu', \"Peek\"),\n    group: 'navigation',\n    order: 100\n});\nexport class SymbolNavigationAnchor {\n    static is(thing) {\n        if (!thing || typeof thing !== 'object') {\n            return false;\n        }\n        if (thing instanceof SymbolNavigationAnchor) {\n            return true;\n        }\n        if (corePosition.Position.isIPosition(thing.position) && thing.model) {\n            return true;\n        }\n        return false;\n    }\n    constructor(model, position) {\n        this.model = model;\n        this.position = position;\n    }\n}\nexport class SymbolNavigationAction extends EditorAction2 {\n    static all() {\n        return SymbolNavigationAction._allSymbolNavigationCommands.values();\n    }\n    static _patchConfig(opts) {\n        const result = { ...opts, f1: true };\n        // patch context menu when clause\n        if (result.menu) {\n            for (const item of Iterable.wrap(result.menu)) {\n                if (item.id === MenuId.EditorContext || item.id === MenuId.EditorContextPeek) {\n                    item.when = ContextKeyExpr.and(opts.precondition, item.when);\n                }\n            }\n        }\n        return result;\n    }\n    constructor(configuration, opts) {\n        super(SymbolNavigationAction._patchConfig(opts));\n        this.configuration = configuration;\n        SymbolNavigationAction._allSymbolNavigationCommands.set(opts.id, this);\n    }\n    runEditorCommand(accessor, editor, arg, range) {\n        if (!editor.hasModel()) {\n            return Promise.resolve(undefined);\n        }\n        const notificationService = accessor.get(INotificationService);\n        const editorService = accessor.get(ICodeEditorService);\n        const progressService = accessor.get(IEditorProgressService);\n        const symbolNavService = accessor.get(ISymbolNavigationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const instaService = accessor.get(IInstantiationService);\n        const model = editor.getModel();\n        const position = editor.getPosition();\n        const anchor = SymbolNavigationAnchor.is(arg) ? arg : new SymbolNavigationAnchor(model, position);\n        const cts = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */);\n        const promise = raceCancellation(this._getLocationModel(languageFeaturesService, anchor.model, anchor.position, cts.token), cts.token).then(async (references) => {\n            var _j;\n            if (!references || cts.token.isCancellationRequested) {\n                return;\n            }\n            alert(references.ariaMessage);\n            let altAction;\n            if (references.referenceAt(model.uri, position)) {\n                const altActionId = this._getAlternativeCommand(editor);\n                if (!SymbolNavigationAction._activeAlternativeCommands.has(altActionId) && SymbolNavigationAction._allSymbolNavigationCommands.has(altActionId)) {\n                    altAction = SymbolNavigationAction._allSymbolNavigationCommands.get(altActionId);\n                }\n            }\n            const referenceCount = references.references.length;\n            if (referenceCount === 0) {\n                // no result -> show message\n                if (!this.configuration.muteMessage) {\n                    const info = model.getWordAtPosition(position);\n                    (_j = MessageController.get(editor)) === null || _j === void 0 ? void 0 : _j.showMessage(this._getNoResultFoundMessage(info), position);\n                }\n            }\n            else if (referenceCount === 1 && altAction) {\n                // already at the only result, run alternative\n                SymbolNavigationAction._activeAlternativeCommands.add(this.desc.id);\n                instaService.invokeFunction((accessor) => altAction.runEditorCommand(accessor, editor, arg, range).finally(() => {\n                    SymbolNavigationAction._activeAlternativeCommands.delete(this.desc.id);\n                }));\n            }\n            else {\n                // normal results handling\n                return this._onResult(editorService, symbolNavService, editor, references, range);\n            }\n        }, (err) => {\n            // report an error\n            notificationService.error(err);\n        }).finally(() => {\n            cts.dispose();\n        });\n        progressService.showWhile(promise, 250);\n        return promise;\n    }\n    async _onResult(editorService, symbolNavService, editor, model, range) {\n        const gotoLocation = this._getGoToPreference(editor);\n        if (!(editor instanceof EmbeddedCodeEditorWidget) && (this.configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1))) {\n            this._openInPeek(editor, model, range);\n        }\n        else {\n            const next = model.firstReference();\n            const peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\n            const targetEditor = await this._openReference(editor, editorService, next, this.configuration.openToSide, !peek);\n            if (peek && targetEditor) {\n                this._openInPeek(targetEditor, model, range);\n            }\n            else {\n                model.dispose();\n            }\n            // keep remaining locations around when using\n            // 'goto'-mode\n            if (gotoLocation === 'goto') {\n                symbolNavService.put(next);\n            }\n        }\n    }\n    async _openReference(editor, editorService, reference, sideBySide, highlight) {\n        // range is the target-selection-range when we have one\n        // and the fallback is the 'full' range\n        let range = undefined;\n        if (isLocationLink(reference)) {\n            range = reference.targetSelectionRange;\n        }\n        if (!range) {\n            range = reference.range;\n        }\n        if (!range) {\n            return undefined;\n        }\n        const targetEditor = await editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(range),\n                selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */,\n                selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */\n            }\n        }, editor, sideBySide);\n        if (!targetEditor) {\n            return undefined;\n        }\n        if (highlight) {\n            const modelNow = targetEditor.getModel();\n            const decorations = targetEditor.createDecorationsCollection([{ range, options: { description: 'symbol-navigate-action-highlight', className: 'symbolHighlight' } }]);\n            setTimeout(() => {\n                if (targetEditor.getModel() === modelNow) {\n                    decorations.clear();\n                }\n            }, 350);\n        }\n        return targetEditor;\n    }\n    _openInPeek(target, model, range) {\n        const controller = ReferencesController.get(target);\n        if (controller && target.hasModel()) {\n            controller.toggleWidget(range !== null && range !== void 0 ? range : target.getSelection(), createCancelablePromise(_ => Promise.resolve(model)), this.configuration.openInPeek);\n        }\n        else {\n            model.dispose();\n        }\n    }\n}\nSymbolNavigationAction._allSymbolNavigationCommands = new Map();\nSymbolNavigationAction._activeAlternativeCommands = new Set();\n//#region --- DEFINITION\nexport class DefinitionAction extends SymbolNavigationAction {\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, token), nls.localize('def.title', 'Definitions'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\n            : nls.localize('generic.noResults', \"No definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleDefinitions;\n    }\n}\nregisterAction2((_a = class GoToDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _a.id,\n                title: {\n                    ...nls.localize2('actions.goToDecl.label', \"Go to Definition\"),\n                    mnemonicTitle: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\"),\n                },\n                precondition: EditorContextKeys.hasDefinitionProvider,\n                keybinding: [{\n                        when: EditorContextKeys.editorTextFocus,\n                        primary: 70 /* KeyCode.F12 */,\n                        weight: 100 /* KeybindingWeight.EditorContrib */\n                    }, {\n                        when: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, IsWebContext),\n                        primary: 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */,\n                        weight: 100 /* KeybindingWeight.EditorContrib */\n                    }],\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.1\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 2,\n                    }]\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', _a.id);\n        }\n    },\n    _a.id = 'editor.action.revealDefinition',\n    _a));\nregisterAction2((_b = class OpenDefinitionToSideAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: true,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _b.id,\n                title: nls.localize2('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n                keybinding: [{\n                        when: EditorContextKeys.editorTextFocus,\n                        primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 70 /* KeyCode.F12 */),\n                        weight: 100 /* KeybindingWeight.EditorContrib */\n                    }, {\n                        when: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, IsWebContext),\n                        primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */),\n                        weight: 100 /* KeybindingWeight.EditorContrib */\n                    }]\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', _b.id);\n        }\n    },\n    _b.id = 'editor.action.revealDefinitionAside',\n    _b));\nregisterAction2((_c = class PeekDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: _c.id,\n                title: nls.localize2('actions.previewDecl.label', \"Peek Definition\"),\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 512 /* KeyMod.Alt */ | 70 /* KeyCode.F12 */,\n                    linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 68 /* KeyCode.F10 */ },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 2\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', _c.id);\n        }\n    },\n    _c.id = 'editor.action.peekDefinition',\n    _c));\n//#endregion\n//#region --- DECLARATION\nclass DeclarationAction extends SymbolNavigationAction {\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, token), nls.localize('decl.title', 'Declarations'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeDeclarationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleDeclarations;\n    }\n}\nregisterAction2((_d = class GoToDeclarationAction extends DeclarationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _d.id,\n                title: {\n                    ...nls.localize2('actions.goToDeclaration.label', \"Go to Declaration\"),\n                    mnemonicTitle: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\"),\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.3\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 3,\n                    }],\n            });\n        }\n        _getNoResultFoundMessage(info) {\n            return info && info.word\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\n        }\n    },\n    _d.id = 'editor.action.revealDeclaration',\n    _d));\nregisterAction2(class PeekDeclarationAction extends DeclarationAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.peekDeclaration',\n            title: nls.localize2('actions.peekDecl.label', \"Peek Declaration\"),\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 3\n            }\n        });\n    }\n});\n//#endregion\n//#region --- TYPE DEFINITION\nclass TypeDefinitionAction extends SymbolNavigationAction {\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, token), nls.localize('typedef.title', 'Type Definitions'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeTypeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleTypeDefinitions;\n    }\n}\nregisterAction2((_e = class GoToTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _e.ID,\n                title: {\n                    ...nls.localize2('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\n                    mnemonicTitle: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\"),\n                },\n                precondition: EditorContextKeys.hasTypeDefinitionProvider,\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 0,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.4\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 3,\n                    }]\n            });\n        }\n    },\n    _e.ID = 'editor.action.goToTypeDefinition',\n    _e));\nregisterAction2((_f = class PeekTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: _f.ID,\n                title: nls.localize2('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 4\n                }\n            });\n        }\n    },\n    _f.ID = 'editor.action.peekTypeDefinition',\n    _f));\n//#endregion\n//#region --- IMPLEMENTATION\nclass ImplementationAction extends SymbolNavigationAction {\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, token), nls.localize('impl.title', 'Implementations'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeImplementationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleImplementations;\n    }\n}\nregisterAction2((_g = class GoToImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: _g.ID,\n                title: {\n                    ...nls.localize2('actions.goToImplementation.label', \"Go to Implementations\"),\n                    mnemonicTitle: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\"),\n                },\n                precondition: EditorContextKeys.hasImplementationProvider,\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.45\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 4,\n                    }]\n            });\n        }\n    },\n    _g.ID = 'editor.action.goToImplementation',\n    _g));\nregisterAction2((_h = class PeekImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: _h.ID,\n                title: nls.localize2('actions.peekImplementation.label', \"Peek Implementations\"),\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 5\n                }\n            });\n        }\n    },\n    _h.ID = 'editor.action.peekImplementation',\n    _h));\n//#endregion\n//#region --- REFERENCES\nclass ReferencesAction extends SymbolNavigationAction {\n    _getNoResultFoundMessage(info) {\n        return info\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\n            : nls.localize('references.noGeneric', \"No references found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).alternativeReferenceCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(58 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n}\nregisterAction2(class GoToReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: 'editor.action.goToReferences',\n            title: {\n                ...nls.localize2('goToReferences.label', \"Go to References\"),\n                mnemonicTitle: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\"),\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            keybinding: {\n                when: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menu: [{\n                    id: MenuId.EditorContext,\n                    group: 'navigation',\n                    order: 1.45\n                }, {\n                    id: MenuId.MenubarGoMenu,\n                    precondition: null,\n                    group: '4_symbol_nav',\n                    order: 5,\n                }]\n        });\n    }\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, true, token), nls.localize('ref.title', 'References'));\n    }\n});\nregisterAction2(class PeekReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.referenceSearch.trigger',\n            title: nls.localize2('references.action.label', \"Peek References\"),\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 6\n            }\n        });\n    }\n    async _getLocationModel(languageFeaturesService, model, position, token) {\n        return new ReferencesModel(await getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, token), nls.localize('ref.title', 'References'));\n    }\n});\n//#endregion\n//#region --- GENERIC goto symbols command\nclass GenericGoToLocationAction extends SymbolNavigationAction {\n    constructor(config, _references, _gotoMultipleBehaviour) {\n        super(config, {\n            id: 'editor.action.goToLocation',\n            title: nls.localize2('label.generic', \"Go to Any Symbol\"),\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInEmbeddedEditor.toNegated()),\n        });\n        this._references = _references;\n        this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\n    }\n    async _getLocationModel(languageFeaturesService, _model, _position, _token) {\n        return new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'));\n    }\n    _getNoResultFoundMessage(info) {\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\n    }\n    _getGoToPreference(editor) {\n        var _j;\n        return (_j = this._gotoMultipleBehaviour) !== null && _j !== void 0 ? _j : editor.getOption(58 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n    _getAlternativeCommand() { return ''; }\n}\nCommandsRegistry.registerCommand({\n    id: 'editor.action.goToLocations',\n    metadata: {\n        description: 'Go to locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`' },\n            { name: 'noResultsMessage', description: 'Human readable message that shows when locations is empty.' },\n        ]\n    },\n    handler: async (accessor, resource, position, references, multiple, noResultsMessage, openInPeek) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        assertType(Array.isArray(references));\n        assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\n        assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\n        const editorService = accessor.get(ICodeEditorService);\n        const editor = await editorService.openCodeEditor({ resource }, editorService.getFocusedCodeEditor());\n        if (isCodeEditor(editor)) {\n            editor.setPosition(position);\n            editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n            return editor.invokeWithinContext(accessor => {\n                const command = new class extends GenericGoToLocationAction {\n                    _getNoResultFoundMessage(info) {\n                        return noResultsMessage || super._getNoResultFoundMessage(info);\n                    }\n                }({\n                    muteMessage: !Boolean(noResultsMessage),\n                    openInPeek: Boolean(openInPeek),\n                    openToSide: false\n                }, references, multiple);\n                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\n            });\n        }\n    }\n});\nCommandsRegistry.registerCommand({\n    id: 'editor.action.peekLocations',\n    metadata: {\n        description: 'Peek locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`' },\n        ]\n    },\n    handler: async (accessor, resource, position, references, multiple) => {\n        accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, undefined, true);\n    }\n});\n//#endregion\n//#region --- REFERENCE search special commands\nCommandsRegistry.registerCommand({\n    id: 'editor.action.findReferences',\n    handler: (accessor, resource, position) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const codeEditorService = accessor.get(ICodeEditorService);\n        return codeEditorService.openCodeEditor({ resource }, codeEditorService.getFocusedCodeEditor()).then(control => {\n            if (!isCodeEditor(control) || !control.hasModel()) {\n                return undefined;\n            }\n            const controller = ReferencesController.get(control);\n            if (!controller) {\n                return undefined;\n            }\n            const references = createCancelablePromise(token => getReferencesAtPosition(languageFeaturesService.referenceProvider, control.getModel(), corePosition.Position.lift(position), false, token).then(references => new ReferencesModel(references, nls.localize('ref.title', 'References'))));\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            return Promise.resolve(controller.toggleWidget(range, references, false));\n        });\n    }\n});\n// use NEW command\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ReferencesModel } from './referencesModel.js';\nasync function getLocationLinks(model, position, registry, provide) {\n    const provider = registry.ordered(model);\n    // get results\n    const promises = provider.map((provider) => {\n        return Promise.resolve(provide(provider, model, position)).then(undefined, err => {\n            onUnexpectedExternalError(err);\n            return undefined;\n        });\n    });\n    const values = await Promise.all(promises);\n    return coalesce(values.flat());\n}\nexport function getDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDefinition(model, position, token);\n    });\n}\nexport function getDeclarationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDeclaration(model, position, token);\n    });\n}\nexport function getImplementationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideImplementation(model, position, token);\n    });\n}\nexport function getTypeDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideTypeDefinition(model, position, token);\n    });\n}\nexport function getReferencesAtPosition(registry, model, position, compact, token) {\n    return getLocationLinks(model, position, registry, async (provider, model, position) => {\n        const result = await provider.provideReferences(model, position, { includeDeclaration: true }, token);\n        if (!compact || !result || result.length !== 2) {\n            return result;\n        }\n        const resultWithoutDeclaration = await provider.provideReferences(model, position, { includeDeclaration: false }, token);\n        if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\n            return resultWithoutDeclaration;\n        }\n        return result;\n    });\n}\n// -- API commands ----\nasync function _sortedAndDeduped(callback) {\n    const rawLinks = await callback();\n    const model = new ReferencesModel(rawLinks, '');\n    const modelLinks = model.references.map(ref => ref.link);\n    model.dispose();\n    return modelLinks;\n}\nregisterModelAndPositionCommand('_executeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeDeclarationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeReferenceProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeImplementationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../../base/common/platform.js';\nfunction hasModifier(e, modifier) {\n    return !!e[modifier];\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkMouseEvent {\n    constructor(source, opts) {\n        this.target = source.target;\n        this.isLeftClick = source.event.leftButton;\n        this.isMiddleClick = source.event.middleButton;\n        this.isRightClick = source.event.rightButton;\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\n        this.isNoneOrSingleMouseDown = (source.event.detail <= 1);\n    }\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkKeyboardEvent {\n    constructor(source, opts) {\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\n    }\n}\nexport class ClickLinkOptions {\n    constructor(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\n        this.triggerKey = triggerKey;\n        this.triggerModifier = triggerModifier;\n        this.triggerSideBySideKey = triggerSideBySideKey;\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\n    }\n    equals(other) {\n        return (this.triggerKey === other.triggerKey\n            && this.triggerModifier === other.triggerModifier\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\n    }\n}\nfunction createOptions(multiCursorModifier) {\n    if (multiCursorModifier === 'altKey') {\n        if (platform.isMacintosh) {\n            return new ClickLinkOptions(57 /* KeyCode.Meta */, 'metaKey', 6 /* KeyCode.Alt */, 'altKey');\n        }\n        return new ClickLinkOptions(5 /* KeyCode.Ctrl */, 'ctrlKey', 6 /* KeyCode.Alt */, 'altKey');\n    }\n    if (platform.isMacintosh) {\n        return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 57 /* KeyCode.Meta */, 'metaKey');\n    }\n    return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 5 /* KeyCode.Ctrl */, 'ctrlKey');\n}\nexport class ClickLinkGesture extends Disposable {\n    constructor(editor, opts) {\n        var _a;\n        super();\n        this._onMouseMoveOrRelevantKeyDown = this._register(new Emitter());\n        this.onMouseMoveOrRelevantKeyDown = this._onMouseMoveOrRelevantKeyDown.event;\n        this._onExecute = this._register(new Emitter());\n        this.onExecute = this._onExecute.event;\n        this._onCancel = this._register(new Emitter());\n        this.onCancel = this._onCancel.event;\n        this._editor = editor;\n        this._extractLineNumberFromMouseEvent = (_a = opts === null || opts === void 0 ? void 0 : opts.extractLineNumberFromMouseEvent) !== null && _a !== void 0 ? _a : ((e) => e.target.position ? e.target.position.lineNumber : 0);\n        this._opts = createOptions(this._editor.getOption(78 /* EditorOption.multiCursorModifier */));\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._lineNumberOnMouseDown = 0;\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(78 /* EditorOption.multiCursorModifier */)) {\n                const newOpts = createOptions(this._editor.getOption(78 /* EditorOption.multiCursorModifier */));\n                if (this._opts.equals(newOpts)) {\n                    return;\n                }\n                this._opts = newOpts;\n                this._lastMouseMoveEvent = null;\n                this._hasTriggerKeyOnMouseDown = false;\n                this._lineNumberOnMouseDown = 0;\n                this._onCancel.fire();\n            }\n        }));\n        this._register(this._editor.onMouseMove((e) => this._onEditorMouseMove(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onKeyDown((e) => this._onEditorKeyDown(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onKeyUp((e) => this._onEditorKeyUp(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onMouseDrag(() => this._resetHandler()));\n        this._register(this._editor.onDidChangeCursorSelection((e) => this._onDidChangeCursorSelection(e)));\n        this._register(this._editor.onDidChangeModel((e) => this._resetHandler()));\n        this._register(this._editor.onDidChangeModelContent(() => this._resetHandler()));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\n                this._resetHandler();\n            }\n        }));\n    }\n    _onDidChangeCursorSelection(e) {\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\n            this._resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/microsoft/vscode/issues/7827)\n        }\n    }\n    _onEditorMouseMove(mouseEvent) {\n        this._lastMouseMoveEvent = mouseEvent;\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\n    }\n    _onEditorMouseDown(mouseEvent) {\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\n        // release the mouse button without wanting to do the navigation.\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\n        this._hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\n        this._lineNumberOnMouseDown = this._extractLineNumberFromMouseEvent(mouseEvent);\n    }\n    _onEditorMouseUp(mouseEvent) {\n        const currentLineNumber = this._extractLineNumberFromMouseEvent(mouseEvent);\n        if (this._hasTriggerKeyOnMouseDown && this._lineNumberOnMouseDown && this._lineNumberOnMouseDown === currentLineNumber) {\n            this._onExecute.fire(mouseEvent);\n        }\n    }\n    _onEditorKeyDown(e) {\n        if (this._lastMouseMoveEvent\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\n            )) {\n            this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent, e]);\n        }\n        else if (e.hasTriggerModifier) {\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\n        }\n    }\n    _onEditorKeyUp(e) {\n        if (e.keyCodeIsTriggerKey) {\n            this._onCancel.fire();\n        }\n    }\n    _resetHandler() {\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._onCancel.fire();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar GotoDefinitionAtPositionEditorContribution_1;\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport './goToDefinitionAtPosition.css';\nimport { EditorState } from '../../../editorState/browser/editorState.js';\nimport { registerEditorContribution } from '../../../../browser/editorExtensions.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from './clickLinkGesture.js';\nimport { PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { DefinitionAction } from '../goToCommands.js';\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../../common/model/textModel.js';\nlet GotoDefinitionAtPositionEditorContribution = GotoDefinitionAtPositionEditorContribution_1 = class GotoDefinitionAtPositionEditorContribution {\n    constructor(editor, textModelResolverService, languageService, languageFeaturesService) {\n        this.textModelResolverService = textModelResolverService;\n        this.languageService = languageService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.toUnhook = new DisposableStore();\n        this.toUnhookForKeyboard = new DisposableStore();\n        this.currentWordAtPosition = null;\n        this.previousPromise = null;\n        this.editor = editor;\n        this.linkDecorations = this.editor.createDecorationsCollection();\n        const linkGesture = new ClickLinkGesture(editor);\n        this.toUnhook.add(linkGesture);\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this.startFindDefinitionFromMouse(mouseEvent, keyboardEvent !== null && keyboardEvent !== void 0 ? keyboardEvent : undefined);\n        }));\n        this.toUnhook.add(linkGesture.onExecute((mouseEvent) => {\n            if (this.isEnabled(mouseEvent)) {\n                this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier)\n                    .catch((error) => {\n                    onUnexpectedError(error);\n                })\n                    .finally(() => {\n                    this.removeLinkDecorations();\n                });\n            }\n        }));\n        this.toUnhook.add(linkGesture.onCancel(() => {\n            this.removeLinkDecorations();\n            this.currentWordAtPosition = null;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution_1.ID);\n    }\n    async startFindDefinitionFromCursor(position) {\n        // For issue: https://github.com/microsoft/vscode/issues/46257\n        // equivalent to mouse move with meta/ctrl key\n        // First find the definition and add decorations\n        // to the editor to be shown with the content hover widget\n        await this.startFindDefinition(position);\n        // Add listeners for editor cursor move and key down events\n        // Dismiss the \"extended\" editor decorations when the user hides\n        // the hover widget. There is no event for the widget itself so these\n        // serve as a best effort. After removing the link decorations, the hover\n        // widget is clean and will only show declarations per next request.\n        this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            this.toUnhookForKeyboard.clear();\n        }));\n        this.toUnhookForKeyboard.add(this.editor.onKeyDown((e) => {\n            if (e) {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                this.toUnhookForKeyboard.clear();\n            }\n        }));\n    }\n    startFindDefinitionFromMouse(mouseEvent, withKey) {\n        // check if we are active and on a content widget\n        if (mouseEvent.target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\n            return;\n        }\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        const position = mouseEvent.target.position;\n        this.startFindDefinition(position);\n    }\n    async startFindDefinition(position) {\n        var _a;\n        // Dispose listeners for updating decorations when using keyboard to show definition hover\n        this.toUnhookForKeyboard.clear();\n        // Find word at mouse position\n        const word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\n        if (!word) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        // Return early if word at position is still the same\n        if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\n            return;\n        }\n        this.currentWordAtPosition = word;\n        // Find definition and decorate word if found\n        const state = new EditorState(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */ | 8 /* CodeEditorStateFlag.Scroll */);\n        if (this.previousPromise) {\n            this.previousPromise.cancel();\n            this.previousPromise = null;\n        }\n        this.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\n        let results;\n        try {\n            results = await this.previousPromise;\n        }\n        catch (error) {\n            onUnexpectedError(error);\n            return;\n        }\n        if (!results || !results.length || !state.validate(this.editor)) {\n            this.removeLinkDecorations();\n            return;\n        }\n        const linkRange = results[0].originSelectionRange\n            ? Range.lift(results[0].originSelectionRange)\n            : new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n        // Multiple results\n        if (results.length > 1) {\n            let combinedRange = linkRange;\n            for (const { originSelectionRange } of results) {\n                if (originSelectionRange) {\n                    combinedRange = Range.plusRange(combinedRange, originSelectionRange);\n                }\n            }\n            this.addDecoration(combinedRange, new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\n        }\n        else {\n            // Single result\n            const result = results[0];\n            if (!result.uri) {\n                return;\n            }\n            this.textModelResolverService.createModelReference(result.uri).then(ref => {\n                if (!ref.object || !ref.object.textEditorModel) {\n                    ref.dispose();\n                    return;\n                }\n                const { object: { textEditorModel } } = ref;\n                const { startLineNumber } = result.range;\n                if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\n                    // invalid range\n                    ref.dispose();\n                    return;\n                }\n                const previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\n                const languageId = this.languageService.guessLanguageIdByFilepathOrFirstLine(textEditorModel.uri);\n                this.addDecoration(linkRange, previewValue ? new MarkdownString().appendCodeblock(languageId ? languageId : '', previewValue) : undefined);\n                ref.dispose();\n            });\n        }\n    }\n    getPreviewValue(textEditorModel, startLineNumber, result) {\n        let rangeToUse = result.range;\n        const numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution_1.MAX_SOURCE_PREVIEW_LINES) {\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\n        }\n        const previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\n        return previewValue;\n    }\n    stripIndentationFromPreviewRange(textEditorModel, startLineNumber, previewRange) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        let minIndent = startIndent;\n        for (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            minIndent = Math.min(minIndent, endIndent);\n        }\n        const previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\n        return previewValue;\n    }\n    getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution_1.MAX_SOURCE_PREVIEW_LINES);\n        let endLineNumber = startLineNumber + 1;\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            if (startIndent === endIndent) {\n                break;\n            }\n        }\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n    }\n    addDecoration(range, hoverMessage) {\n        const newDecorations = {\n            range: range,\n            options: {\n                description: 'goto-definition-link',\n                inlineClassName: 'goto-definition-link',\n                hoverMessage\n            }\n        };\n        this.linkDecorations.set([newDecorations]);\n    }\n    removeLinkDecorations() {\n        this.linkDecorations.clear();\n    }\n    isEnabled(mouseEvent, withKey) {\n        var _a;\n        return this.editor.hasModel()\n            && mouseEvent.isLeftClick\n            && mouseEvent.isNoneOrSingleMouseDown\n            && mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */\n            && !(((_a = mouseEvent.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options) instanceof ModelDecorationInjectedTextOptions)\n            && (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false))\n            && this.languageFeaturesService.definitionProvider.has(this.editor.getModel());\n    }\n    findDefinition(position, token) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return Promise.resolve(null);\n        }\n        return getDefinitionsAtPosition(this.languageFeaturesService.definitionProvider, model, position, token);\n    }\n    gotoDefinition(position, openToSide) {\n        this.editor.setPosition(position);\n        return this.editor.invokeWithinContext((accessor) => {\n            const canPeek = !openToSide && this.editor.getOption(88 /* EditorOption.definitionLinkOpensInPeek */) && !this.isInPeekEditor(accessor);\n            const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { title: { value: '', original: '' }, id: '', precondition: undefined });\n            return action.run(accessor);\n        });\n    }\n    isInPeekEditor(accessor) {\n        const contextKeyService = accessor.get(IContextKeyService);\n        return PeekContext.inPeekEditor.getValue(contextKeyService);\n    }\n    dispose() {\n        this.toUnhook.dispose();\n        this.toUnhookForKeyboard.dispose();\n    }\n};\nGotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\nGotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\nGotoDefinitionAtPositionEditorContribution = GotoDefinitionAtPositionEditorContribution_1 = __decorate([\n    __param(1, ITextModelService),\n    __param(2, ILanguageService),\n    __param(3, ILanguageFeaturesService)\n], GotoDefinitionAtPositionEditorContribution);\nexport { GotoDefinitionAtPositionEditorContribution };\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar FileReferencesRenderer_1;\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { CountBadge } from '../../../../../base/browser/ui/countBadge/countBadge.js';\nimport { HighlightedLabel } from '../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\nimport { IconLabel } from '../../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { createMatches, FuzzyScore } from '../../../../../base/common/filters.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { basename, dirname } from '../../../../../base/common/resources.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { localize } from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { defaultCountBadgeStyles } from '../../../../../platform/theme/browser/defaultStyles.js';\nimport { FileReferences, OneReference, ReferencesModel } from '../referencesModel.js';\nlet DataSource = class DataSource {\n    constructor(_resolverService) {\n        this._resolverService = _resolverService;\n    }\n    hasChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return true;\n        }\n        if (element instanceof FileReferences) {\n            return true;\n        }\n        return false;\n    }\n    getChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return element.groups;\n        }\n        if (element instanceof FileReferences) {\n            return element.resolve(this._resolverService).then(val => {\n                // if (element.failure) {\n                // \t// refresh the element on failure so that\n                // \t// we can update its rendering\n                // \treturn tree.refresh(element).then(() => val.children);\n                // }\n                return val.children;\n            });\n        }\n        throw new Error('bad tree');\n    }\n};\nDataSource = __decorate([\n    __param(0, ITextModelService)\n], DataSource);\nexport { DataSource };\n//#endregion\nexport class Delegate {\n    getHeight() {\n        return 23;\n    }\n    getTemplateId(element) {\n        if (element instanceof FileReferences) {\n            return FileReferencesRenderer.id;\n        }\n        else {\n            return OneReferenceRenderer.id;\n        }\n    }\n}\nlet StringRepresentationProvider = class StringRepresentationProvider {\n    constructor(_keybindingService) {\n        this._keybindingService = _keybindingService;\n    }\n    getKeyboardNavigationLabel(element) {\n        var _a;\n        if (element instanceof OneReference) {\n            const parts = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n            if (parts) {\n                return parts.value;\n            }\n        }\n        // FileReferences or unresolved OneReference\n        return basename(element.uri);\n    }\n};\nStringRepresentationProvider = __decorate([\n    __param(0, IKeybindingService)\n], StringRepresentationProvider);\nexport { StringRepresentationProvider };\nexport class IdentityProvider {\n    getId(element) {\n        return element instanceof OneReference ? element.id : element.uri;\n    }\n}\n//#region render: File\nlet FileReferencesTemplate = class FileReferencesTemplate extends Disposable {\n    constructor(container, _labelService) {\n        super();\n        this._labelService = _labelService;\n        const parent = document.createElement('div');\n        parent.classList.add('reference-file');\n        this.file = this._register(new IconLabel(parent, { supportHighlights: true }));\n        this.badge = new CountBadge(dom.append(parent, dom.$('.count')), {}, defaultCountBadgeStyles);\n        container.appendChild(parent);\n    }\n    set(element, matches) {\n        const parent = dirname(element.uri);\n        this.file.setLabel(this._labelService.getUriBasenameLabel(element.uri), this._labelService.getUriLabel(parent, { relative: true }), { title: this._labelService.getUriLabel(element.uri), matches });\n        const len = element.children.length;\n        this.badge.setCount(len);\n        if (len > 1) {\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\n        }\n        else {\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\n        }\n    }\n};\nFileReferencesTemplate = __decorate([\n    __param(1, ILabelService)\n], FileReferencesTemplate);\nlet FileReferencesRenderer = FileReferencesRenderer_1 = class FileReferencesRenderer {\n    constructor(_instantiationService) {\n        this._instantiationService = _instantiationService;\n        this.templateId = FileReferencesRenderer_1.id;\n    }\n    renderTemplate(container) {\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\n    }\n    renderElement(node, index, template) {\n        template.set(node.element, createMatches(node.filterData));\n    }\n    disposeTemplate(templateData) {\n        templateData.dispose();\n    }\n};\nFileReferencesRenderer.id = 'FileReferencesRenderer';\nFileReferencesRenderer = FileReferencesRenderer_1 = __decorate([\n    __param(0, IInstantiationService)\n], FileReferencesRenderer);\nexport { FileReferencesRenderer };\n//#endregion\n//#region render: Reference\nclass OneReferenceTemplate extends Disposable {\n    constructor(container) {\n        super();\n        this.label = this._register(new HighlightedLabel(container));\n    }\n    set(element, score) {\n        var _a;\n        const preview = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n        if (!preview || !preview.value) {\n            // this means we FAILED to resolve the document or the value is the empty string\n            this.label.set(`${basename(element.uri)}:${element.range.startLineNumber + 1}:${element.range.startColumn + 1}`);\n        }\n        else {\n            // render search match as highlight unless\n            // we have score, then render the score\n            const { value, highlight } = preview;\n            if (score && !FuzzyScore.isDefault(score)) {\n                this.label.element.classList.toggle('referenceMatch', false);\n                this.label.set(value, createMatches(score));\n            }\n            else {\n                this.label.element.classList.toggle('referenceMatch', true);\n                this.label.set(value, [highlight]);\n            }\n        }\n    }\n}\nexport class OneReferenceRenderer {\n    constructor() {\n        this.templateId = OneReferenceRenderer.id;\n    }\n    renderTemplate(container) {\n        return new OneReferenceTemplate(container);\n    }\n    renderElement(node, index, templateData) {\n        templateData.set(node.element, node.filterData);\n    }\n    disposeTemplate(templateData) {\n        templateData.dispose();\n    }\n}\nOneReferenceRenderer.id = 'OneReferenceRenderer';\n//#endregion\nexport class AccessibilityProvider {\n    getWidgetAriaLabel() {\n        return localize('treeAriaLabel', \"References\");\n    }\n    getAriaLabel(element) {\n        return element.ariaMessage;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { Sizing, SplitView } from '../../../../../base/browser/ui/splitview/splitview.js';\nimport { Color } from '../../../../../base/common/color.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { basenameOrAuthority, dirname } from '../../../../../base/common/resources.js';\nimport './referencesWidget.css';\nimport { EmbeddedCodeEditorWidget } from '../../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ModelDecorationOptions, TextModel } from '../../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../../common/languages/modesRegistry.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, IdentityProvider, OneReferenceRenderer, StringRepresentationProvider } from './referencesTree.js';\nimport * as peekView from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { WorkbenchAsyncDataTree } from '../../../../../platform/list/browser/listService.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { FileReferences, OneReference } from '../referencesModel.js';\nclass DecorationsManager {\n    constructor(_editor, _model) {\n        this._editor = _editor;\n        this._model = _model;\n        this._decorations = new Map();\n        this._decorationIgnoreSet = new Set();\n        this._callOnDispose = new DisposableStore();\n        this._callOnModelChange = new DisposableStore();\n        this._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\n        this._onModelChanged();\n    }\n    dispose() {\n        this._callOnModelChange.dispose();\n        this._callOnDispose.dispose();\n        this.removeDecorations();\n    }\n    _onModelChanged() {\n        this._callOnModelChange.clear();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const ref of this._model.references) {\n            if (ref.uri.toString() === model.uri.toString()) {\n                this._addDecorations(ref.parent);\n                return;\n            }\n        }\n    }\n    _addDecorations(reference) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\n        const newDecorations = [];\n        const newDecorationsActualIndex = [];\n        for (let i = 0, len = reference.children.length; i < len; i++) {\n            const oneReference = reference.children[i];\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\n                continue;\n            }\n            if (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\n                continue;\n            }\n            newDecorations.push({\n                range: oneReference.range,\n                options: DecorationsManager.DecorationOptions\n            });\n            newDecorationsActualIndex.push(i);\n        }\n        this._editor.changeDecorations((changeAccessor) => {\n            const decorations = changeAccessor.deltaDecorations([], newDecorations);\n            for (let i = 0; i < decorations.length; i++) {\n                this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\n            }\n        });\n    }\n    _onDecorationChanged() {\n        const toRemove = [];\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const [decorationId, reference] of this._decorations) {\n            const newRange = model.getDecorationRange(decorationId);\n            if (!newRange) {\n                continue;\n            }\n            let ignore = false;\n            if (Range.equalsRange(newRange, reference.range)) {\n                continue;\n            }\n            if (Range.spansMultipleLines(newRange)) {\n                ignore = true;\n            }\n            else {\n                const lineLength = reference.range.endColumn - reference.range.startColumn;\n                const newLineLength = newRange.endColumn - newRange.startColumn;\n                if (lineLength !== newLineLength) {\n                    ignore = true;\n                }\n            }\n            if (ignore) {\n                this._decorationIgnoreSet.add(reference.id);\n                toRemove.push(decorationId);\n            }\n            else {\n                reference.range = newRange;\n            }\n        }\n        for (let i = 0, len = toRemove.length; i < len; i++) {\n            this._decorations.delete(toRemove[i]);\n        }\n        this._editor.removeDecorations(toRemove);\n    }\n    removeDecorations() {\n        this._editor.removeDecorations([...this._decorations.keys()]);\n        this._decorations.clear();\n    }\n}\nDecorationsManager.DecorationOptions = ModelDecorationOptions.register({\n    description: 'reference-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'reference-decoration'\n});\nexport class LayoutData {\n    constructor() {\n        this.ratio = 0.7;\n        this.heightInLines = 18;\n    }\n    static fromJSON(raw) {\n        let ratio;\n        let heightInLines;\n        try {\n            const data = JSON.parse(raw);\n            ratio = data.ratio;\n            heightInLines = data.heightInLines;\n        }\n        catch (_a) {\n            //\n        }\n        return {\n            ratio: ratio || 0.7,\n            heightInLines: heightInLines || 18\n        };\n    }\n}\nclass ReferencesTree extends WorkbenchAsyncDataTree {\n}\n/**\n * ZoneWidget that is shown inside the editor\n */\nlet ReferenceWidget = class ReferenceWidget extends peekView.PeekViewWidget {\n    constructor(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel, _undoRedoService, _keybindingService, _languageService, _languageConfigurationService) {\n        super(editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true, supportOnTitleClick: true }, _instantiationService);\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this.layoutData = layoutData;\n        this._textModelResolverService = _textModelResolverService;\n        this._instantiationService = _instantiationService;\n        this._peekViewService = _peekViewService;\n        this._uriLabel = _uriLabel;\n        this._undoRedoService = _undoRedoService;\n        this._keybindingService = _keybindingService;\n        this._languageService = _languageService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._disposeOnNewModel = new DisposableStore();\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectReference = new Emitter();\n        this.onDidSelectReference = this._onDidSelectReference.event;\n        this._dim = new dom.Dimension(0, 0);\n        this._applyTheme(themeService.getColorTheme());\n        this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this._peekViewService.addExclusiveWidget(editor, this);\n        this.create();\n    }\n    dispose() {\n        this.setModel(undefined);\n        this._callOnDispose.dispose();\n        this._disposeOnNewModel.dispose();\n        dispose(this._preview);\n        dispose(this._previewNotAvailableMessage);\n        dispose(this._tree);\n        dispose(this._previewModelReference);\n        this._splitView.dispose();\n        super.dispose();\n    }\n    _applyTheme(theme) {\n        const borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\n        this.style({\n            arrowColor: borderColor,\n            frameColor: borderColor,\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\n        });\n    }\n    show(where) {\n        super.show(where, this.layoutData.heightInLines || 18);\n    }\n    focusOnReferenceTree() {\n        this._tree.domFocus();\n    }\n    focusOnPreviewEditor() {\n        this._preview.focus();\n    }\n    isPreviewEditorFocused() {\n        return this._preview.hasTextFocus();\n    }\n    _onTitleClick(e) {\n        if (this._preview && this._preview.getModel()) {\n            this._onDidSelectReference.fire({\n                element: this._getFocusedReference(),\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\n                source: 'title'\n            });\n        }\n    }\n    _fillBody(containerElement) {\n        this.setCssClass('reference-zone-widget');\n        // message pane\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\n        dom.hide(this._messageContainer);\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* Orientation.HORIZONTAL */ });\n        // editor\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\n        const options = {\n            scrollBeyondLastLine: false,\n            scrollbar: {\n                verticalScrollbarSize: 14,\n                horizontal: 'auto',\n                useShadows: true,\n                verticalHasArrows: false,\n                horizontalHasArrows: false,\n                alwaysConsumeMouseWheel: true\n            },\n            overviewRulerLanes: 2,\n            fixedOverflowWidgets: true,\n            minimap: {\n                enabled: false\n            }\n        };\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, {}, this.editor);\n        dom.hide(this._previewContainer);\n        this._previewNotAvailableMessage = new TextModel(nls.localize('missingPreviewMessage', \"no preview available\"), PLAINTEXT_LANGUAGE_ID, TextModel.DEFAULT_CREATION_OPTIONS, null, this._undoRedoService, this._languageService, this._languageConfigurationService);\n        // tree\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\n        const treeOptions = {\n            keyboardSupport: this._defaultTreeKeyboardSupport,\n            accessibilityProvider: new AccessibilityProvider(),\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\n            identityProvider: new IdentityProvider(),\n            openOnSingleClick: true,\n            selectionNavigation: true,\n            overrideStyles: {\n                listBackground: peekView.peekViewResultsBackground\n            }\n        };\n        if (this._defaultTreeKeyboardSupport) {\n            // the tree will consume `Escape` and prevent the widget from closing\n            this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', (e) => {\n                if (e.equals(9 /* KeyCode.Escape */)) {\n                    this._keybindingService.dispatchEvent(e, e.target);\n                    e.stopPropagation();\n                }\n            }, true));\n        }\n        this._tree = this._instantiationService.createInstance(ReferencesTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\n            this._instantiationService.createInstance(FileReferencesRenderer),\n            this._instantiationService.createInstance(OneReferenceRenderer),\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\n        // split stuff\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._previewContainer,\n            minimumSize: 200,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._preview.layout({ height: this._dim.height, width });\n            }\n        }, Sizing.Distribute);\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._treeContainer,\n            minimumSize: 100,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._treeContainer.style.height = `${this._dim.height}px`;\n                this._treeContainer.style.width = `${width}px`;\n                this._tree.layout(this._dim.height, width);\n            }\n        }, Sizing.Distribute);\n        this._disposables.add(this._splitView.onDidSashChange(() => {\n            if (this._dim.width) {\n                this.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\n            }\n        }, undefined));\n        // listen on selection and focus\n        const onEvent = (element, kind) => {\n            if (element instanceof OneReference) {\n                if (kind === 'show') {\n                    this._revealReference(element, false);\n                }\n                this._onDidSelectReference.fire({ element, kind, source: 'tree' });\n            }\n        };\n        this._tree.onDidOpen(e => {\n            if (e.sideBySide) {\n                onEvent(e.element, 'side');\n            }\n            else if (e.editorOptions.pinned) {\n                onEvent(e.element, 'goto');\n            }\n            else {\n                onEvent(e.element, 'show');\n            }\n        });\n        dom.hide(this._treeContainer);\n    }\n    _onWidth(width) {\n        if (this._dim) {\n            this._doLayoutBody(this._dim.height, width);\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._dim = new dom.Dimension(widthInPixel, heightInPixel);\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\n        this._splitView.layout(widthInPixel);\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\n    }\n    setSelection(selection) {\n        return this._revealReference(selection, true).then(() => {\n            if (!this._model) {\n                // disposed\n                return;\n            }\n            // show in tree\n            this._tree.setSelection([selection]);\n            this._tree.setFocus([selection]);\n        });\n    }\n    setModel(newModel) {\n        // clean up\n        this._disposeOnNewModel.clear();\n        this._model = newModel;\n        if (this._model) {\n            return this._onNewModel();\n        }\n        return Promise.resolve();\n    }\n    _onNewModel() {\n        if (!this._model) {\n            return Promise.resolve(undefined);\n        }\n        if (this._model.isEmpty) {\n            this.setTitle('');\n            this._messageContainer.innerText = nls.localize('noResults', \"No results\");\n            dom.show(this._messageContainer);\n            return Promise.resolve(undefined);\n        }\n        dom.hide(this._messageContainer);\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\n        this._disposeOnNewModel.add(this._decorationsManager);\n        // listen on model changes\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference)));\n        // listen on editor\n        this._disposeOnNewModel.add(this._preview.onMouseDown(e => {\n            const { event, target } = e;\n            if (event.detail !== 2) {\n                return;\n            }\n            const element = this._getFocusedReference();\n            if (!element) {\n                return;\n            }\n            this._onDidSelectReference.fire({\n                element: { uri: element.uri, range: target.range },\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\n                source: 'editor'\n            });\n        }));\n        // make sure things are rendered\n        this.container.classList.add('results-loaded');\n        dom.show(this._treeContainer);\n        dom.show(this._previewContainer);\n        this._splitView.layout(this._dim.width);\n        this.focusOnReferenceTree();\n        // pick input and a reference to begin with\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\n    }\n    _getFocusedReference() {\n        const [element] = this._tree.getFocus();\n        if (element instanceof OneReference) {\n            return element;\n        }\n        else if (element instanceof FileReferences) {\n            if (element.children.length > 0) {\n                return element.children[0];\n            }\n        }\n        return undefined;\n    }\n    async revealReference(reference) {\n        await this._revealReference(reference, false);\n        this._onDidSelectReference.fire({ element: reference, kind: 'goto', source: 'tree' });\n    }\n    async _revealReference(reference, revealParent) {\n        // check if there is anything to do...\n        if (this._revealedReference === reference) {\n            return;\n        }\n        this._revealedReference = reference;\n        // Update widget header\n        if (reference.uri.scheme !== Schemas.inMemory) {\n            this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\n        }\n        else {\n            this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\n        }\n        const promise = this._textModelResolverService.createModelReference(reference.uri);\n        if (this._tree.getInput() === reference.parent) {\n            this._tree.reveal(reference);\n        }\n        else {\n            if (revealParent) {\n                this._tree.reveal(reference.parent);\n            }\n            await this._tree.expand(reference.parent);\n            this._tree.reveal(reference);\n        }\n        const ref = await promise;\n        if (!this._model) {\n            // disposed\n            ref.dispose();\n            return;\n        }\n        dispose(this._previewModelReference);\n        // show in editor\n        const model = ref.object;\n        if (model) {\n            const scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* ScrollType.Smooth */ : 1 /* ScrollType.Immediate */;\n            const sel = Range.lift(reference.range).collapseToStart();\n            this._previewModelReference = ref;\n            this._preview.setModel(model.textEditorModel);\n            this._preview.setSelection(sel);\n            this._preview.revealRangeInCenter(sel, scrollType);\n        }\n        else {\n            this._preview.setModel(this._previewNotAvailableMessage);\n            ref.dispose();\n        }\n    }\n};\nReferenceWidget = __decorate([\n    __param(3, IThemeService),\n    __param(4, ITextModelService),\n    __param(5, IInstantiationService),\n    __param(6, peekView.IPeekViewService),\n    __param(7, ILabelService),\n    __param(8, IUndoRedoService),\n    __param(9, IKeybindingService),\n    __param(10, ILanguageService),\n    __param(11, ILanguageConfigurationService)\n], ReferenceWidget);\nexport { ReferenceWidget };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ReferencesController_1;\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { getOuterEditor, PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { CommandsRegistry } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingsRegistry } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { IListService, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse, WorkbenchTreeElementCanExpand } from '../../../../../platform/list/browser/listService.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { OneReference } from '../referencesModel.js';\nimport { LayoutData, ReferenceWidget } from './referencesWidget.js';\nimport { EditorContextKeys } from '../../../../common/editorContextKeys.js';\nimport { InputFocusedContext } from '../../../../../platform/contextkey/common/contextkeys.js';\nexport const ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false, nls.localize('referenceSearchVisible', \"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'\"));\nlet ReferencesController = ReferencesController_1 = class ReferencesController {\n    static get(editor) {\n        return editor.getContribution(ReferencesController_1.ID);\n    }\n    constructor(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this._editor = _editor;\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._instantiationService = _instantiationService;\n        this._storageService = _storageService;\n        this._configurationService = _configurationService;\n        this._disposables = new DisposableStore();\n        this._requestIdPool = 0;\n        this._ignoreModelChangeEvent = false;\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\n    }\n    dispose() {\n        var _a, _b;\n        this._referenceSearchVisible.reset();\n        this._disposables.dispose();\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    toggleWidget(range, modelPromise, peekMode) {\n        // close current widget and return early is position didn't change\n        let widgetPosition;\n        if (this._widget) {\n            widgetPosition = this._widget.position;\n        }\n        this.closeWidget();\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\n            return;\n        }\n        this._peekMode = peekMode;\n        this._referenceSearchVisible.set(true);\n        // close the widget on model/mode changes\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => { this.closeWidget(); }));\n        this._disposables.add(this._editor.onDidChangeModel(() => {\n            if (!this._ignoreModelChangeEvent) {\n                this.closeWidget();\n            }\n        }));\n        const storageKey = 'peekViewLayout';\n        const data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* StorageScope.PROFILE */, '{}'));\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\n        this._widget.show(range);\n        this._disposables.add(this._widget.onDidClose(() => {\n            modelPromise.cancel();\n            if (this._widget) {\n                this._storageService.store(storageKey, JSON.stringify(this._widget.layoutData), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n                this._widget = undefined;\n            }\n            this.closeWidget();\n        }));\n        this._disposables.add(this._widget.onDidSelectReference(event => {\n            const { element, kind } = event;\n            if (!element) {\n                return;\n            }\n            switch (kind) {\n                case 'open':\n                    if (event.source !== 'editor' || !this._configurationService.getValue('editor.stablePeek')) {\n                        // when stable peek is configured we don't close\n                        // the peek window on selecting the editor\n                        this.openReference(element, false, false);\n                    }\n                    break;\n                case 'side':\n                    this.openReference(element, true, false);\n                    break;\n                case 'goto':\n                    if (peekMode) {\n                        this._gotoReference(element, true);\n                    }\n                    else {\n                        this.openReference(element, false, true);\n                    }\n                    break;\n            }\n        }));\n        const requestId = ++this._requestIdPool;\n        modelPromise.then(model => {\n            var _a;\n            // still current request? widget still open?\n            if (requestId !== this._requestIdPool || !this._widget) {\n                model.dispose();\n                return undefined;\n            }\n            (_a = this._model) === null || _a === void 0 ? void 0 : _a.dispose();\n            this._model = model;\n            // show widget\n            return this._widget.setModel(this._model).then(() => {\n                if (this._widget && this._model && this._editor.hasModel()) { // might have been closed\n                    // set title\n                    if (!this._model.isEmpty) {\n                        this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", this._model.title, this._model.references.length));\n                    }\n                    else {\n                        this._widget.setMetaTitle('');\n                    }\n                    // set 'best' selection\n                    const uri = this._editor.getModel().uri;\n                    const pos = new Position(range.startLineNumber, range.startColumn);\n                    const selection = this._model.nearestReference(uri, pos);\n                    if (selection) {\n                        return this._widget.setSelection(selection).then(() => {\n                            if (this._widget && this._editor.getOption(87 /* EditorOption.peekWidgetDefaultFocus */) === 'editor') {\n                                this._widget.focusOnPreviewEditor();\n                            }\n                        });\n                    }\n                }\n                return undefined;\n            });\n        }, error => {\n            this._notificationService.error(error);\n        });\n    }\n    changeFocusBetweenPreviewAndReferences() {\n        if (!this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        if (this._widget.isPreviewEditorFocused()) {\n            this._widget.focusOnReferenceTree();\n        }\n        else {\n            this._widget.focusOnPreviewEditor();\n        }\n    }\n    async goToNextOrPreviousReference(fwd) {\n        if (!this._editor.hasModel() || !this._model || !this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        const currentPosition = this._widget.position;\n        if (!currentPosition) {\n            return;\n        }\n        const source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\n        if (!source) {\n            return;\n        }\n        const target = this._model.nextOrPreviousReference(source, fwd);\n        const editorFocus = this._editor.hasTextFocus();\n        const previewEditorFocus = this._widget.isPreviewEditorFocused();\n        await this._widget.setSelection(target);\n        await this._gotoReference(target, false);\n        if (editorFocus) {\n            this._editor.focus();\n        }\n        else if (this._widget && previewEditorFocus) {\n            this._widget.focusOnPreviewEditor();\n        }\n    }\n    async revealReference(reference) {\n        if (!this._editor.hasModel() || !this._model || !this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        await this._widget.revealReference(reference);\n    }\n    closeWidget(focusEditor = true) {\n        var _a, _b;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._referenceSearchVisible.reset();\n        this._disposables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n        if (focusEditor) {\n            this._editor.focus();\n        }\n        this._requestIdPool += 1; // Cancel pending requests\n    }\n    _gotoReference(ref, pinned) {\n        var _a;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.hide();\n        this._ignoreModelChangeEvent = true;\n        const range = Range.lift(ref.range).collapseToStart();\n        return this._editorService.openCodeEditor({\n            resource: ref.uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor).then(openedEditor => {\n            var _a;\n            this._ignoreModelChangeEvent = false;\n            if (!openedEditor || !this._widget) {\n                // something went wrong...\n                this.closeWidget();\n                return;\n            }\n            if (this._editor === openedEditor) {\n                //\n                this._widget.show(range);\n                this._widget.focusOnReferenceTree();\n            }\n            else {\n                // we opened a different editor instance which means a different controller instance.\n                // therefore we stop with this controller and continue with the other\n                const other = ReferencesController_1.get(openedEditor);\n                const model = this._model.clone();\n                this.closeWidget();\n                openedEditor.focus();\n                other === null || other === void 0 ? void 0 : other.toggleWidget(range, createCancelablePromise(_ => Promise.resolve(model)), (_a = this._peekMode) !== null && _a !== void 0 ? _a : false);\n            }\n        }, (err) => {\n            this._ignoreModelChangeEvent = false;\n            onUnexpectedError(err);\n        });\n    }\n    openReference(ref, sideBySide, pinned) {\n        // clear stage\n        if (!sideBySide) {\n            this.closeWidget();\n        }\n        const { uri, range } = ref;\n        this._editorService.openCodeEditor({\n            resource: uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor, sideBySide);\n    }\n};\nReferencesController.ID = 'editor.contrib.referencesController';\nReferencesController = ReferencesController_1 = __decorate([\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, INotificationService),\n    __param(5, IInstantiationService),\n    __param(6, IStorageService),\n    __param(7, IConfigurationService)\n], ReferencesController);\nexport { ReferencesController };\nfunction withController(accessor, fn) {\n    const outerEditor = getOuterEditor(accessor);\n    if (!outerEditor) {\n        return;\n    }\n    const controller = ReferencesController.get(outerEditor);\n    if (controller) {\n        fn(controller);\n    }\n}\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'togglePeekWidgetFocus',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 60 /* KeyCode.F2 */),\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.changeFocusBetweenPreviewAndReferences();\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToNextReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 62 /* KeyCode.F4 */,\n    secondary: [70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(true);\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToPreviousReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 1024 /* KeyMod.Shift */ | 62 /* KeyCode.F4 */,\n    secondary: [1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(false);\n        });\n    }\n});\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\nCommandsRegistry.registerCommandAlias('goToNextReferenceFromEmbeddedEditor', 'goToNextReference');\nCommandsRegistry.registerCommandAlias('goToPreviousReferenceFromEmbeddedEditor', 'goToPreviousReference');\n// close\nCommandsRegistry.registerCommandAlias('closeReferenceSearchEditor', 'closeReferenceSearch');\nCommandsRegistry.registerCommand('closeReferenceSearch', accessor => withController(accessor, controller => controller.closeWidget()));\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 101,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */ + 50,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek'), ContextKeyExpr.or(EditorContextKeys.editorTextFocus, InputFocusedContext.negate()))\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'revealReference',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */,\n    primary: 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 3 /* KeyCode.Enter */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */]\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.revealReference(focus[0]));\n        }\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'openReferenceToSide',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 256 /* KeyMod.WinCtrl */ | 3 /* KeyCode.Enter */\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.openReference(focus[0], true, true));\n        }\n    }\n});\nCommandsRegistry.registerCommand('openReference', (accessor) => {\n    var _a;\n    const listService = accessor.get(IListService);\n    const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n    if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n        withController(accessor, controller => controller.openReference(focus[0], false, true));\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { defaultGenerator } from '../../../../base/common/idGenerator.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { basename, extUri } from '../../../../base/common/resources.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nexport class OneReference {\n    constructor(isProviderFirst, parent, link, _rangeCallback) {\n        this.isProviderFirst = isProviderFirst;\n        this.parent = parent;\n        this.link = link;\n        this._rangeCallback = _rangeCallback;\n        this.id = defaultGenerator.nextId();\n    }\n    get uri() {\n        return this.link.uri;\n    }\n    get range() {\n        var _a, _b;\n        return (_b = (_a = this._range) !== null && _a !== void 0 ? _a : this.link.targetSelectionRange) !== null && _b !== void 0 ? _b : this.link.range;\n    }\n    set range(value) {\n        this._range = value;\n        this._rangeCallback(this);\n    }\n    get ariaMessage() {\n        var _a;\n        const preview = (_a = this.parent.getPreview(this)) === null || _a === void 0 ? void 0 : _a.preview(this.range);\n        if (!preview) {\n            return localize('aria.oneReference', \"in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n        else {\n            return localize({ key: 'aria.oneReference.preview', comment: ['Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code'] }, \"{0} in {1} on line {2} at column {3}\", preview.value, basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n    }\n}\nexport class FilePreview {\n    constructor(_modelReference) {\n        this._modelReference = _modelReference;\n    }\n    dispose() {\n        this._modelReference.dispose();\n    }\n    preview(range, n = 8) {\n        const model = this._modelReference.object.textEditorModel;\n        if (!model) {\n            return undefined;\n        }\n        const { startLineNumber, startColumn, endLineNumber, endColumn } = range;\n        const word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\n        const beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\n        const afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        const before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\n        const inside = model.getValueInRange(range);\n        const after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\n        return {\n            value: before + inside + after,\n            highlight: { start: before.length, end: before.length + inside.length }\n        };\n    }\n}\nexport class FileReferences {\n    constructor(parent, uri) {\n        this.parent = parent;\n        this.uri = uri;\n        this.children = [];\n        this._previews = new ResourceMap();\n    }\n    dispose() {\n        dispose(this._previews.values());\n        this._previews.clear();\n    }\n    getPreview(child) {\n        return this._previews.get(child.uri);\n    }\n    get ariaMessage() {\n        const len = this.children.length;\n        if (len === 1) {\n            return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\n        }\n        else {\n            return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\n        }\n    }\n    async resolve(textModelResolverService) {\n        if (this._previews.size !== 0) {\n            return this;\n        }\n        for (const child of this.children) {\n            if (this._previews.has(child.uri)) {\n                continue;\n            }\n            try {\n                const ref = await textModelResolverService.createModelReference(child.uri);\n                this._previews.set(child.uri, new FilePreview(ref));\n            }\n            catch (err) {\n                onUnexpectedError(err);\n            }\n        }\n        return this;\n    }\n}\nexport class ReferencesModel {\n    constructor(links, title) {\n        this.groups = [];\n        this.references = [];\n        this._onDidChangeReferenceRange = new Emitter();\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\n        this._links = links;\n        this._title = title;\n        // grouping and sorting\n        const [providersFirst] = links;\n        links.sort(ReferencesModel._compareReferences);\n        let current;\n        for (const link of links) {\n            if (!current || !extUri.isEqual(current.uri, link.uri, true)) {\n                // new group\n                current = new FileReferences(this, link.uri);\n                this.groups.push(current);\n            }\n            // append, check for equality first!\n            if (current.children.length === 0 || ReferencesModel._compareReferences(link, current.children[current.children.length - 1]) !== 0) {\n                const oneRef = new OneReference(providersFirst === link, current, link, ref => this._onDidChangeReferenceRange.fire(ref));\n                this.references.push(oneRef);\n                current.children.push(oneRef);\n            }\n        }\n    }\n    dispose() {\n        dispose(this.groups);\n        this._onDidChangeReferenceRange.dispose();\n        this.groups.length = 0;\n    }\n    clone() {\n        return new ReferencesModel(this._links, this._title);\n    }\n    get title() {\n        return this._title;\n    }\n    get isEmpty() {\n        return this.groups.length === 0;\n    }\n    get ariaMessage() {\n        if (this.isEmpty) {\n            return localize('aria.result.0', \"No results found\");\n        }\n        else if (this.references.length === 1) {\n            return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\n        }\n        else if (this.groups.length === 1) {\n            return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\n        }\n        else {\n            return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\n        }\n    }\n    nextOrPreviousReference(reference, next) {\n        const { parent } = reference;\n        let idx = parent.children.indexOf(reference);\n        const childCount = parent.children.length;\n        const groupCount = parent.parent.groups.length;\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\n            // cycling within one file\n            if (next) {\n                idx = (idx + 1) % childCount;\n            }\n            else {\n                idx = (idx + childCount - 1) % childCount;\n            }\n            return parent.children[idx];\n        }\n        idx = parent.parent.groups.indexOf(parent);\n        if (next) {\n            idx = (idx + 1) % groupCount;\n            return parent.parent.groups[idx].children[0];\n        }\n        else {\n            idx = (idx + groupCount - 1) % groupCount;\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\n        }\n    }\n    nearestReference(resource, position) {\n        const nearest = this.references.map((ref, idx) => {\n            return {\n                idx,\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\n            };\n        }).sort((a, b) => {\n            if (a.prefixLen > b.prefixLen) {\n                return -1;\n            }\n            else if (a.prefixLen < b.prefixLen) {\n                return 1;\n            }\n            else if (a.offsetDist < b.offsetDist) {\n                return -1;\n            }\n            else if (a.offsetDist > b.offsetDist) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n        })[0];\n        if (nearest) {\n            return this.references[nearest.idx];\n        }\n        return undefined;\n    }\n    referenceAt(resource, position) {\n        for (const ref of this.references) {\n            if (ref.uri.toString() === resource.toString()) {\n                if (Range.containsPosition(ref.range, position)) {\n                    return ref;\n                }\n            }\n        }\n        return undefined;\n    }\n    firstReference() {\n        for (const ref of this.references) {\n            if (ref.isProviderFirst) {\n                return ref;\n            }\n        }\n        return this.references[0];\n    }\n    static _compareReferences(a, b) {\n        return extUri.compare(a.uri, b.uri) || Range.compareRangesUsingStarts(a.range, b.range);\n    }\n}\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { HoverAction } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nconst $ = dom.$;\nlet EditorHoverStatusBar = class EditorHoverStatusBar extends Disposable {\n    get hasContent() {\n        return this._hasContent;\n    }\n    constructor(_keybindingService) {\n        super();\n        this._keybindingService = _keybindingService;\n        this._hasContent = false;\n        this.hoverElement = $('div.hover-row.status-bar');\n        this.hoverElement.tabIndex = 0;\n        this.actionsElement = dom.append(this.hoverElement, $('div.actions'));\n    }\n    addAction(actionOptions) {\n        const keybinding = this._keybindingService.lookupKeybinding(actionOptions.commandId);\n        const keybindingLabel = keybinding ? keybinding.getLabel() : null;\n        this._hasContent = true;\n        return this._register(HoverAction.render(this.actionsElement, actionOptions, keybindingLabel));\n    }\n    append(element) {\n        const result = dom.append(this.actionsElement, element);\n        this._hasContent = true;\n        return result;\n    }\n};\nEditorHoverStatusBar = __decorate([\n    __param(0, IKeybindingService)\n], EditorHoverStatusBar);\nexport { EditorHoverStatusBar };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport class HoverProviderResult {\n    constructor(provider, hover, ordinal) {\n        this.provider = provider;\n        this.hover = hover;\n        this.ordinal = ordinal;\n    }\n}\n/**\n * Does not throw or return a rejected promise (returns undefined instead).\n */\nasync function executeProvider(provider, ordinal, model, position, token) {\n    const result = await Promise\n        .resolve(provider.provideHover(model, position, token))\n        .catch(onUnexpectedExternalError);\n    if (!result || !isValid(result)) {\n        return undefined;\n    }\n    return new HoverProviderResult(provider, result, ordinal);\n}\nexport function getHoverProviderResultsAsAsyncIterable(registry, model, position, token) {\n    const providers = registry.ordered(model);\n    const promises = providers.map((provider, index) => executeProvider(provider, index, model, position, token));\n    return AsyncIterableObject.fromPromises(promises).coalesce();\n}\nexport function getHoversPromise(registry, model, position, token) {\n    return getHoverProviderResultsAsAsyncIterable(registry, model, position, token).map(item => item.hover).toPromise();\n}\nregisterModelAndPositionCommand('_executeHoverProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    return getHoversPromise(languageFeaturesService.hoverProvider, model, position, CancellationToken.None);\n});\nfunction isValid(result) {\n    const hasRange = (typeof result.range !== 'undefined');\n    const hasHtmlContent = typeof result.contents !== 'undefined' && result.contents && result.contents.length > 0;\n    return hasRange && hasHtmlContent;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const SHOW_OR_FOCUS_HOVER_ACTION_ID = 'editor.action.showHover';\nexport const SHOW_DEFINITION_PREVIEW_HOVER_ACTION_ID = 'editor.action.showDefinitionPreviewHover';\nexport const SCROLL_UP_HOVER_ACTION_ID = 'editor.action.scrollUpHover';\nexport const SCROLL_DOWN_HOVER_ACTION_ID = 'editor.action.scrollDownHover';\nexport const SCROLL_LEFT_HOVER_ACTION_ID = 'editor.action.scrollLeftHover';\nexport const SCROLL_RIGHT_HOVER_ACTION_ID = 'editor.action.scrollRightHover';\nexport const PAGE_UP_HOVER_ACTION_ID = 'editor.action.pageUpHover';\nexport const PAGE_DOWN_HOVER_ACTION_ID = 'editor.action.pageDownHover';\nexport const GO_TO_TOP_HOVER_ACTION_ID = 'editor.action.goToTopHover';\nexport const GO_TO_BOTTOM_HOVER_ACTION_ID = 'editor.action.goToBottomHover';\nexport const INCREASE_HOVER_VERBOSITY_ACTION_ID = 'editor.action.increaseHoverVerbosityLevel';\nexport const DECREASE_HOVER_VERBOSITY_ACTION_ID = 'editor.action.decreaseHoverVerbosityLevel';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DECREASE_HOVER_VERBOSITY_ACTION_ID, GO_TO_BOTTOM_HOVER_ACTION_ID, GO_TO_TOP_HOVER_ACTION_ID, INCREASE_HOVER_VERBOSITY_ACTION_ID, PAGE_DOWN_HOVER_ACTION_ID, PAGE_UP_HOVER_ACTION_ID, SCROLL_DOWN_HOVER_ACTION_ID, SCROLL_LEFT_HOVER_ACTION_ID, SCROLL_RIGHT_HOVER_ACTION_ID, SCROLL_UP_HOVER_ACTION_ID, SHOW_DEFINITION_PREVIEW_HOVER_ACTION_ID, SHOW_OR_FOCUS_HOVER_ACTION_ID } from './hoverActionIds.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { EditorAction } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { GotoDefinitionAtPositionEditorContribution } from '../../gotoSymbol/browser/link/goToDefinitionAtPosition.js';\nimport { HoverController } from './hoverController.js';\nimport { HoverVerbosityAction } from '../../../common/languages.js';\nimport * as nls from '../../../../nls.js';\nimport './hover.css';\nvar HoverFocusBehavior;\n(function (HoverFocusBehavior) {\n    HoverFocusBehavior[\"NoAutoFocus\"] = \"noAutoFocus\";\n    HoverFocusBehavior[\"FocusIfVisible\"] = \"focusIfVisible\";\n    HoverFocusBehavior[\"AutoFocusImmediately\"] = \"autoFocusImmediately\";\n})(HoverFocusBehavior || (HoverFocusBehavior = {}));\nexport class ShowOrFocusHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: SHOW_OR_FOCUS_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'showOrFocusHover',\n                comment: [\n                    'Label for action that will trigger the showing/focusing of a hover in the editor.',\n                    'If the hover is not visible, it will show the hover.',\n                    'This allows for users to show the hover without using the mouse.'\n                ]\n            }, \"Show or Focus Hover\"),\n            metadata: {\n                description: nls.localize2('showOrFocusHoverDescription', 'Show or focus the editor hover which shows documentation, references, and other content for a symbol at the current cursor position.'),\n                args: [{\n                        name: 'args',\n                        schema: {\n                            type: 'object',\n                            properties: {\n                                'focus': {\n                                    description: 'Controls if and when the hover should take focus upon being triggered by this action.',\n                                    enum: [HoverFocusBehavior.NoAutoFocus, HoverFocusBehavior.FocusIfVisible, HoverFocusBehavior.AutoFocusImmediately],\n                                    enumDescriptions: [\n                                        nls.localize('showOrFocusHover.focus.noAutoFocus', 'The hover will not automatically take focus.'),\n                                        nls.localize('showOrFocusHover.focus.focusIfVisible', 'The hover will take focus only if it is already visible.'),\n                                        nls.localize('showOrFocusHover.focus.autoFocusImmediately', 'The hover will automatically take focus when it appears.'),\n                                    ],\n                                    default: HoverFocusBehavior.FocusIfVisible,\n                                }\n                            },\n                        }\n                    }]\n            },\n            alias: 'Show or Focus Hover',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 39 /* KeyCode.KeyI */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor, args) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const focusArgument = args === null || args === void 0 ? void 0 : args.focus;\n        let focusOption = HoverFocusBehavior.FocusIfVisible;\n        if (Object.values(HoverFocusBehavior).includes(focusArgument)) {\n            focusOption = focusArgument;\n        }\n        else if (typeof focusArgument === 'boolean' && focusArgument) {\n            focusOption = HoverFocusBehavior.AutoFocusImmediately;\n        }\n        const showContentHover = (focus) => {\n            const position = editor.getPosition();\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            controller.showContentHover(range, 1 /* HoverStartMode.Immediate */, 1 /* HoverStartSource.Keyboard */, focus);\n        };\n        const accessibilitySupportEnabled = editor.getOption(2 /* EditorOption.accessibilitySupport */) === 2 /* AccessibilitySupport.Enabled */;\n        if (controller.isHoverVisible) {\n            if (focusOption !== HoverFocusBehavior.NoAutoFocus) {\n                controller.focus();\n            }\n            else {\n                showContentHover(accessibilitySupportEnabled);\n            }\n        }\n        else {\n            showContentHover(accessibilitySupportEnabled || focusOption === HoverFocusBehavior.AutoFocusImmediately);\n        }\n    }\n}\nexport class ShowDefinitionPreviewHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: SHOW_DEFINITION_PREVIEW_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'showDefinitionPreviewHover',\n                comment: [\n                    'Label for action that will trigger the showing of definition preview hover in the editor.',\n                    'This allows for users to show the definition preview hover without using the mouse.'\n                ]\n            }, \"Show Definition Preview Hover\"),\n            alias: 'Show Definition Preview Hover',\n            precondition: undefined,\n            metadata: {\n                description: nls.localize2('showDefinitionPreviewHoverDescription', 'Show the definition preview hover in the editor.'),\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const position = editor.getPosition();\n        if (!position) {\n            return;\n        }\n        const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n        const goto = GotoDefinitionAtPositionEditorContribution.get(editor);\n        if (!goto) {\n            return;\n        }\n        const promise = goto.startFindDefinitionFromCursor(position);\n        promise.then(() => {\n            controller.showContentHover(range, 1 /* HoverStartMode.Immediate */, 1 /* HoverStartSource.Keyboard */, true);\n        });\n    }\n}\nexport class ScrollUpHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: SCROLL_UP_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'scrollUpHover',\n                comment: [\n                    'Action that allows to scroll up in the hover widget with the up arrow when the hover widget is focused.'\n                ]\n            }, \"Scroll Up Hover\"),\n            alias: 'Scroll Up Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 16 /* KeyCode.UpArrow */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('scrollUpHoverDescription', 'Scroll up the editor hover.')\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.scrollUp();\n    }\n}\nexport class ScrollDownHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: SCROLL_DOWN_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'scrollDownHover',\n                comment: [\n                    'Action that allows to scroll down in the hover widget with the up arrow when the hover widget is focused.'\n                ]\n            }, \"Scroll Down Hover\"),\n            alias: 'Scroll Down Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 18 /* KeyCode.DownArrow */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('scrollDownHoverDescription', 'Scroll down the editor hover.'),\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.scrollDown();\n    }\n}\nexport class ScrollLeftHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: SCROLL_LEFT_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'scrollLeftHover',\n                comment: [\n                    'Action that allows to scroll left in the hover widget with the left arrow when the hover widget is focused.'\n                ]\n            }, \"Scroll Left Hover\"),\n            alias: 'Scroll Left Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 15 /* KeyCode.LeftArrow */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('scrollLeftHoverDescription', 'Scroll left the editor hover.'),\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.scrollLeft();\n    }\n}\nexport class ScrollRightHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: SCROLL_RIGHT_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'scrollRightHover',\n                comment: [\n                    'Action that allows to scroll right in the hover widget with the right arrow when the hover widget is focused.'\n                ]\n            }, \"Scroll Right Hover\"),\n            alias: 'Scroll Right Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 17 /* KeyCode.RightArrow */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('scrollRightHoverDescription', 'Scroll right the editor hover.')\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.scrollRight();\n    }\n}\nexport class PageUpHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: PAGE_UP_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'pageUpHover',\n                comment: [\n                    'Action that allows to page up in the hover widget with the page up command when the hover widget is focused.'\n                ]\n            }, \"Page Up Hover\"),\n            alias: 'Page Up Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 11 /* KeyCode.PageUp */,\n                secondary: [512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */],\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('pageUpHoverDescription', 'Page up the editor hover.'),\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.pageUp();\n    }\n}\nexport class PageDownHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: PAGE_DOWN_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'pageDownHover',\n                comment: [\n                    'Action that allows to page down in the hover widget with the page down command when the hover widget is focused.'\n                ]\n            }, \"Page Down Hover\"),\n            alias: 'Page Down Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 12 /* KeyCode.PageDown */,\n                secondary: [512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */],\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('pageDownHoverDescription', 'Page down the editor hover.'),\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.pageDown();\n    }\n}\nexport class GoToTopHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: GO_TO_TOP_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'goToTopHover',\n                comment: [\n                    'Action that allows to go to the top of the hover widget with the home command when the hover widget is focused.'\n                ]\n            }, \"Go To Top Hover\"),\n            alias: 'Go To Bottom Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 14 /* KeyCode.Home */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */],\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('goToTopHoverDescription', 'Go to the top of the editor hover.'),\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.goToTop();\n    }\n}\nexport class GoToBottomHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: GO_TO_BOTTOM_HOVER_ACTION_ID,\n            label: nls.localize({\n                key: 'goToBottomHover',\n                comment: [\n                    'Action that allows to go to the bottom in the hover widget with the end command when the hover widget is focused.'\n                ]\n            }, \"Go To Bottom Hover\"),\n            alias: 'Go To Bottom Hover',\n            precondition: EditorContextKeys.hoverFocused,\n            kbOpts: {\n                kbExpr: EditorContextKeys.hoverFocused,\n                primary: 13 /* KeyCode.End */,\n                secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */],\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            metadata: {\n                description: nls.localize2('goToBottomHoverDescription', 'Go to the bottom of the editor hover.')\n            },\n        });\n    }\n    run(accessor, editor) {\n        const controller = HoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        controller.goToBottom();\n    }\n}\nexport class IncreaseHoverVerbosityLevel extends EditorAction {\n    constructor() {\n        super({\n            id: INCREASE_HOVER_VERBOSITY_ACTION_ID,\n            label: nls.localize({\n                key: 'increaseHoverVerbosityLevel',\n                comment: ['Label for action that will increase the hover verbosity level.']\n            }, \"Increase Hover Verbosity Level\"),\n            alias: 'Increase Hover Verbosity Level',\n            precondition: EditorContextKeys.hoverFocused\n        });\n    }\n    run(accessor, editor) {\n        var _a;\n        (_a = HoverController.get(editor)) === null || _a === void 0 ? void 0 : _a.updateFocusedMarkdownHoverVerbosityLevel(HoverVerbosityAction.Increase);\n    }\n}\nexport class DecreaseHoverVerbosityLevel extends EditorAction {\n    constructor() {\n        super({\n            id: DECREASE_HOVER_VERBOSITY_ACTION_ID,\n            label: nls.localize({\n                key: 'decreaseHoverVerbosityLevel',\n                comment: ['Label for action that will decrease the hover verbosity level.']\n            }, \"Decrease Hover Verbosity Level\"),\n            alias: 'Decrease Hover Verbosity Level',\n            precondition: EditorContextKeys.hoverFocused\n        });\n    }\n    run(accessor, editor, args) {\n        var _a;\n        (_a = HoverController.get(editor)) === null || _a === void 0 ? void 0 : _a.updateFocusedMarkdownHoverVerbosityLevel(HoverVerbosityAction.Decrease);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, disposableTimeout } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { IMarkerDecorationsService } from '../../../common/services/markerDecorations.js';\nimport { getCodeActions, quickFixCommandId } from '../../codeAction/browser/codeAction.js';\nimport { CodeActionController } from '../../codeAction/browser/codeActionController.js';\nimport { CodeActionKind, CodeActionTriggerSource } from '../../codeAction/common/types.js';\nimport { MarkerController, NextMarkerAction } from '../../gotoError/browser/gotoError.js';\nimport * as nls from '../../../../nls.js';\nimport { IMarkerData, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nconst $ = dom.$;\nexport class MarkerHover {\n    constructor(owner, range, marker) {\n        this.owner = owner;\n        this.range = range;\n        this.marker = marker;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nconst markerCodeActionTrigger = {\n    type: 1 /* CodeActionTriggerType.Invoke */,\n    filter: { include: CodeActionKind.QuickFix },\n    triggerAction: CodeActionTriggerSource.QuickFixHover\n};\nlet MarkerHoverParticipant = class MarkerHoverParticipant {\n    constructor(_editor, _markerDecorationsService, _openerService, _languageFeaturesService) {\n        this._editor = _editor;\n        this._markerDecorationsService = _markerDecorationsService;\n        this._openerService = _openerService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this.hoverOrdinal = 1;\n        this.recentMarkerCodeActionsInfo = undefined;\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */ && !anchor.supportsMarkerHover) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        const result = [];\n        for (const d of lineDecorations) {\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            const marker = this._markerDecorationsService.getMarker(model.uri, d);\n            if (!marker) {\n                continue;\n            }\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\n            result.push(new MarkerHover(this, range, marker));\n        }\n        return result;\n    }\n    renderHoverParts(context, hoverParts) {\n        if (!hoverParts.length) {\n            return Disposable.None;\n        }\n        const disposables = new DisposableStore();\n        hoverParts.forEach(msg => context.fragment.appendChild(this.renderMarkerHover(msg, disposables)));\n        const markerHoverForStatusbar = hoverParts.length === 1 ? hoverParts[0] : hoverParts.sort((a, b) => MarkerSeverity.compare(a.marker.severity, b.marker.severity))[0];\n        this.renderMarkerStatusbar(context, markerHoverForStatusbar, disposables);\n        return disposables;\n    }\n    renderMarkerHover(markerHover, disposables) {\n        const hoverElement = $('div.hover-row');\n        hoverElement.tabIndex = 0;\n        const markerElement = dom.append(hoverElement, $('div.marker.hover-contents'));\n        const { source, message, code, relatedInformation } = markerHover.marker;\n        this._editor.applyFontInfo(markerElement);\n        const messageElement = dom.append(markerElement, $('span'));\n        messageElement.style.whiteSpace = 'pre-wrap';\n        messageElement.innerText = message;\n        if (source || code) {\n            // Code has link\n            if (code && typeof code !== 'string') {\n                const sourceAndCodeElement = $('span');\n                if (source) {\n                    const sourceElement = dom.append(sourceAndCodeElement, $('span'));\n                    sourceElement.innerText = source;\n                }\n                const codeLink = dom.append(sourceAndCodeElement, $('a.code-link'));\n                codeLink.setAttribute('href', code.target.toString());\n                disposables.add(dom.addDisposableListener(codeLink, 'click', (e) => {\n                    this._openerService.open(code.target, { allowCommands: true });\n                    e.preventDefault();\n                    e.stopPropagation();\n                }));\n                const codeElement = dom.append(codeLink, $('span'));\n                codeElement.innerText = code.value;\n                const detailsElement = dom.append(markerElement, sourceAndCodeElement);\n                detailsElement.style.opacity = '0.6';\n                detailsElement.style.paddingLeft = '6px';\n            }\n            else {\n                const detailsElement = dom.append(markerElement, $('span'));\n                detailsElement.style.opacity = '0.6';\n                detailsElement.style.paddingLeft = '6px';\n                detailsElement.innerText = source && code ? `${source}(${code})` : source ? source : `(${code})`;\n            }\n        }\n        if (isNonEmptyArray(relatedInformation)) {\n            for (const { message, resource, startLineNumber, startColumn } of relatedInformation) {\n                const relatedInfoContainer = dom.append(markerElement, $('div'));\n                relatedInfoContainer.style.marginTop = '8px';\n                const a = dom.append(relatedInfoContainer, $('a'));\n                a.innerText = `${basename(resource)}(${startLineNumber}, ${startColumn}): `;\n                a.style.cursor = 'pointer';\n                disposables.add(dom.addDisposableListener(a, 'click', (e) => {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    if (this._openerService) {\n                        this._openerService.open(resource, {\n                            fromUserGesture: true,\n                            editorOptions: { selection: { startLineNumber, startColumn } }\n                        }).catch(onUnexpectedError);\n                    }\n                }));\n                const messageElement = dom.append(relatedInfoContainer, $('span'));\n                messageElement.innerText = message;\n                this._editor.applyFontInfo(messageElement);\n            }\n        }\n        return hoverElement;\n    }\n    renderMarkerStatusbar(context, markerHover, disposables) {\n        if (markerHover.marker.severity === MarkerSeverity.Error || markerHover.marker.severity === MarkerSeverity.Warning || markerHover.marker.severity === MarkerSeverity.Info) {\n            const markerController = MarkerController.get(this._editor);\n            if (markerController) {\n                context.statusBar.addAction({\n                    label: nls.localize('view problem', \"View Problem\"),\n                    commandId: NextMarkerAction.ID,\n                    run: () => {\n                        context.hide();\n                        markerController.showAtMarker(markerHover.marker);\n                        this._editor.focus();\n                    }\n                });\n            }\n        }\n        if (!this._editor.getOption(91 /* EditorOption.readOnly */)) {\n            const quickfixPlaceholderElement = context.statusBar.append($('div'));\n            if (this.recentMarkerCodeActionsInfo) {\n                if (IMarkerData.makeKey(this.recentMarkerCodeActionsInfo.marker) === IMarkerData.makeKey(markerHover.marker)) {\n                    if (!this.recentMarkerCodeActionsInfo.hasCodeActions) {\n                        quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\n                    }\n                }\n                else {\n                    this.recentMarkerCodeActionsInfo = undefined;\n                }\n            }\n            const updatePlaceholderDisposable = this.recentMarkerCodeActionsInfo && !this.recentMarkerCodeActionsInfo.hasCodeActions ? Disposable.None : disposableTimeout(() => quickfixPlaceholderElement.textContent = nls.localize('checkingForQuickFixes', \"Checking for quick fixes...\"), 200, disposables);\n            if (!quickfixPlaceholderElement.textContent) {\n                // Have some content in here to avoid flickering\n                quickfixPlaceholderElement.textContent = String.fromCharCode(0xA0); // &nbsp;\n            }\n            const codeActionsPromise = this.getCodeActions(markerHover.marker);\n            disposables.add(toDisposable(() => codeActionsPromise.cancel()));\n            codeActionsPromise.then(actions => {\n                updatePlaceholderDisposable.dispose();\n                this.recentMarkerCodeActionsInfo = { marker: markerHover.marker, hasCodeActions: actions.validActions.length > 0 };\n                if (!this.recentMarkerCodeActionsInfo.hasCodeActions) {\n                    actions.dispose();\n                    quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\n                    return;\n                }\n                quickfixPlaceholderElement.style.display = 'none';\n                let showing = false;\n                disposables.add(toDisposable(() => {\n                    if (!showing) {\n                        actions.dispose();\n                    }\n                }));\n                context.statusBar.addAction({\n                    label: nls.localize('quick fixes', \"Quick Fix...\"),\n                    commandId: quickFixCommandId,\n                    run: (target) => {\n                        showing = true;\n                        const controller = CodeActionController.get(this._editor);\n                        const elementPosition = dom.getDomNodePagePosition(target);\n                        // Hide the hover pre-emptively, otherwise the editor can close the code actions\n                        // context menu as well when using keyboard navigation\n                        context.hide();\n                        controller === null || controller === void 0 ? void 0 : controller.showCodeActions(markerCodeActionTrigger, actions, {\n                            x: elementPosition.left,\n                            y: elementPosition.top,\n                            width: elementPosition.width,\n                            height: elementPosition.height\n                        });\n                    }\n                });\n            }, onUnexpectedError);\n        }\n    }\n    getCodeActions(marker) {\n        return createCancelablePromise(cancellationToken => {\n            return getCodeActions(this._languageFeaturesService.codeActionProvider, this._editor.getModel(), new Range(marker.startLineNumber, marker.startColumn, marker.endLineNumber, marker.endColumn), markerCodeActionTrigger, Progress.None, cancellationToken);\n        });\n    }\n};\nMarkerHoverParticipant = __decorate([\n    __param(1, IMarkerDecorationsService),\n    __param(2, IOpenerService),\n    __param(3, ILanguageFeaturesService)\n], MarkerHoverParticipant);\nexport { MarkerHoverParticipant };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DecreaseHoverVerbosityLevel, GoToBottomHoverAction, GoToTopHoverAction, IncreaseHoverVerbosityLevel, PageDownHoverAction, PageUpHoverAction, ScrollDownHoverAction, ScrollLeftHoverAction, ScrollRightHoverAction, ScrollUpHoverAction, ShowDefinitionPreviewHoverAction, ShowOrFocusHoverAction } from './hoverActions.js';\nimport { registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { editorHoverBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { HoverParticipantRegistry } from './hoverTypes.js';\nimport { MarkdownHoverParticipant } from './markdownHoverParticipant.js';\nimport { MarkerHoverParticipant } from './markerHoverParticipant.js';\nimport { HoverController } from './hoverController.js';\nimport './hover.css';\nregisterEditorContribution(HoverController.ID, HoverController, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(ShowOrFocusHoverAction);\nregisterEditorAction(ShowDefinitionPreviewHoverAction);\nregisterEditorAction(ScrollUpHoverAction);\nregisterEditorAction(ScrollDownHoverAction);\nregisterEditorAction(ScrollLeftHoverAction);\nregisterEditorAction(ScrollRightHoverAction);\nregisterEditorAction(PageUpHoverAction);\nregisterEditorAction(PageDownHoverAction);\nregisterEditorAction(GoToTopHoverAction);\nregisterEditorAction(GoToBottomHoverAction);\nregisterEditorAction(IncreaseHoverVerbosityLevel);\nregisterEditorAction(DecreaseHoverVerbosityLevel);\nHoverParticipantRegistry.register(MarkdownHoverParticipant);\nHoverParticipantRegistry.register(MarkerHoverParticipant);\n// theming\nregisterThemingParticipant((theme, collector) => {\n    const hoverBorder = theme.getColor(editorHoverBorder);\n    if (hoverBorder) {\n        collector.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${hoverBorder.transparent(0.5)}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { ResizableHTMLElement } from '../../../../base/browser/ui/resizable/resizable.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport * as dom from '../../../../base/browser/dom.js';\nconst TOP_HEIGHT = 30;\nconst BOTTOM_HEIGHT = 24;\nexport class ResizableContentWidget extends Disposable {\n    constructor(_editor, minimumSize = new dom.Dimension(10, 10)) {\n        super();\n        this._editor = _editor;\n        this.allowEditorOverflow = true;\n        this.suppressMouseDown = false;\n        this._resizableNode = this._register(new ResizableHTMLElement());\n        this._contentPosition = null;\n        this._isResizing = false;\n        this._resizableNode.domNode.style.position = 'absolute';\n        this._resizableNode.minSize = dom.Dimension.lift(minimumSize);\n        this._resizableNode.layout(minimumSize.height, minimumSize.width);\n        this._resizableNode.enableSashes(true, true, true, true);\n        this._register(this._resizableNode.onDidResize(e => {\n            this._resize(new dom.Dimension(e.dimension.width, e.dimension.height));\n            if (e.done) {\n                this._isResizing = false;\n            }\n        }));\n        this._register(this._resizableNode.onDidWillResize(() => {\n            this._isResizing = true;\n        }));\n    }\n    get isResizing() {\n        return this._isResizing;\n    }\n    getDomNode() {\n        return this._resizableNode.domNode;\n    }\n    getPosition() {\n        return this._contentPosition;\n    }\n    get position() {\n        var _a;\n        return ((_a = this._contentPosition) === null || _a === void 0 ? void 0 : _a.position) ? Position.lift(this._contentPosition.position) : undefined;\n    }\n    _availableVerticalSpaceAbove(position) {\n        const editorDomNode = this._editor.getDomNode();\n        const mouseBox = this._editor.getScrolledVisiblePosition(position);\n        if (!editorDomNode || !mouseBox) {\n            return;\n        }\n        const editorBox = dom.getDomNodePagePosition(editorDomNode);\n        return editorBox.top + mouseBox.top - TOP_HEIGHT;\n    }\n    _availableVerticalSpaceBelow(position) {\n        const editorDomNode = this._editor.getDomNode();\n        const mouseBox = this._editor.getScrolledVisiblePosition(position);\n        if (!editorDomNode || !mouseBox) {\n            return;\n        }\n        const editorBox = dom.getDomNodePagePosition(editorDomNode);\n        const bodyBox = dom.getClientArea(editorDomNode.ownerDocument.body);\n        const mouseBottom = editorBox.top + mouseBox.top + mouseBox.height;\n        return bodyBox.height - mouseBottom - BOTTOM_HEIGHT;\n    }\n    _findPositionPreference(widgetHeight, showAtPosition) {\n        var _a, _b;\n        const maxHeightBelow = Math.min((_a = this._availableVerticalSpaceBelow(showAtPosition)) !== null && _a !== void 0 ? _a : Infinity, widgetHeight);\n        const maxHeightAbove = Math.min((_b = this._availableVerticalSpaceAbove(showAtPosition)) !== null && _b !== void 0 ? _b : Infinity, widgetHeight);\n        const maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow), widgetHeight);\n        const height = Math.min(widgetHeight, maxHeight);\n        let renderingAbove;\n        if (this._editor.getOption(60 /* EditorOption.hover */).above) {\n            renderingAbove = height <= maxHeightAbove ? 1 /* ContentWidgetPositionPreference.ABOVE */ : 2 /* ContentWidgetPositionPreference.BELOW */;\n        }\n        else {\n            renderingAbove = height <= maxHeightBelow ? 2 /* ContentWidgetPositionPreference.BELOW */ : 1 /* ContentWidgetPositionPreference.ABOVE */;\n        }\n        if (renderingAbove === 1 /* ContentWidgetPositionPreference.ABOVE */) {\n            this._resizableNode.enableSashes(true, true, false, false);\n        }\n        else {\n            this._resizableNode.enableSashes(false, true, true, false);\n        }\n        return renderingAbove;\n    }\n    _resize(dimension) {\n        this._resizableNode.layout(dimension.height, dimension.width);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ContentHoverWidget_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ResizableContentWidget } from './resizableContentWidget.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { getHoverAccessibleViewHint, HoverWidget } from '../../../../base/browser/ui/hover/hoverWidget.js';\nconst HORIZONTAL_SCROLLING_BY = 30;\nconst CONTAINER_HEIGHT_PADDING = 6;\nlet ContentHoverWidget = ContentHoverWidget_1 = class ContentHoverWidget extends ResizableContentWidget {\n    get isColorPickerVisible() {\n        var _a;\n        return Boolean((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.colorPicker);\n    }\n    get isVisibleFromKeyboard() {\n        var _a;\n        return (((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.source) === 1 /* HoverStartSource.Keyboard */);\n    }\n    get isVisible() {\n        var _a;\n        return (_a = this._hoverVisibleKey.get()) !== null && _a !== void 0 ? _a : false;\n    }\n    get isFocused() {\n        var _a;\n        return (_a = this._hoverFocusedKey.get()) !== null && _a !== void 0 ? _a : false;\n    }\n    constructor(editor, contextKeyService, _configurationService, _accessibilityService, _keybindingService) {\n        const minimumHeight = editor.getOption(67 /* EditorOption.lineHeight */) + 8;\n        const minimumWidth = 150;\n        const minimumSize = new dom.Dimension(minimumWidth, minimumHeight);\n        super(editor, minimumSize);\n        this._configurationService = _configurationService;\n        this._accessibilityService = _accessibilityService;\n        this._keybindingService = _keybindingService;\n        this._hover = this._register(new HoverWidget());\n        this._minimumSize = minimumSize;\n        this._hoverVisibleKey = EditorContextKeys.hoverVisible.bindTo(contextKeyService);\n        this._hoverFocusedKey = EditorContextKeys.hoverFocused.bindTo(contextKeyService);\n        dom.append(this._resizableNode.domNode, this._hover.containerDomNode);\n        this._resizableNode.domNode.style.zIndex = '50';\n        this._register(this._editor.onDidLayoutChange(() => {\n            if (this.isVisible) {\n                this._updateMaxDimensions();\n            }\n        }));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        const focusTracker = this._register(dom.trackFocus(this._resizableNode.domNode));\n        this._register(focusTracker.onDidFocus(() => {\n            this._hoverFocusedKey.set(true);\n        }));\n        this._register(focusTracker.onDidBlur(() => {\n            this._hoverFocusedKey.set(false);\n        }));\n        this._setHoverData(undefined);\n        this._editor.addContentWidget(this);\n    }\n    dispose() {\n        var _a;\n        super.dispose();\n        (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.disposables.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return ContentHoverWidget_1.ID;\n    }\n    static _applyDimensions(container, width, height) {\n        const transformedWidth = typeof width === 'number' ? `${width}px` : width;\n        const transformedHeight = typeof height === 'number' ? `${height}px` : height;\n        container.style.width = transformedWidth;\n        container.style.height = transformedHeight;\n    }\n    _setContentsDomNodeDimensions(width, height) {\n        const contentsDomNode = this._hover.contentsDomNode;\n        return ContentHoverWidget_1._applyDimensions(contentsDomNode, width, height);\n    }\n    _setContainerDomNodeDimensions(width, height) {\n        const containerDomNode = this._hover.containerDomNode;\n        return ContentHoverWidget_1._applyDimensions(containerDomNode, width, height);\n    }\n    _setHoverWidgetDimensions(width, height) {\n        this._setContentsDomNodeDimensions(width, height);\n        this._setContainerDomNodeDimensions(width, height);\n        this._layoutContentWidget();\n    }\n    static _applyMaxDimensions(container, width, height) {\n        const transformedWidth = typeof width === 'number' ? `${width}px` : width;\n        const transformedHeight = typeof height === 'number' ? `${height}px` : height;\n        container.style.maxWidth = transformedWidth;\n        container.style.maxHeight = transformedHeight;\n    }\n    _setHoverWidgetMaxDimensions(width, height) {\n        ContentHoverWidget_1._applyMaxDimensions(this._hover.contentsDomNode, width, height);\n        ContentHoverWidget_1._applyMaxDimensions(this._hover.containerDomNode, width, height);\n        this._hover.containerDomNode.style.setProperty('--vscode-hover-maxWidth', typeof width === 'number' ? `${width}px` : width);\n        this._layoutContentWidget();\n    }\n    _setAdjustedHoverWidgetDimensions(size) {\n        this._setHoverWidgetMaxDimensions('none', 'none');\n        const width = size.width;\n        const height = size.height;\n        this._setHoverWidgetDimensions(width, height);\n    }\n    _updateResizableNodeMaxDimensions() {\n        var _a, _b;\n        const maxRenderingWidth = (_a = this._findMaximumRenderingWidth()) !== null && _a !== void 0 ? _a : Infinity;\n        const maxRenderingHeight = (_b = this._findMaximumRenderingHeight()) !== null && _b !== void 0 ? _b : Infinity;\n        this._resizableNode.maxSize = new dom.Dimension(maxRenderingWidth, maxRenderingHeight);\n        this._setHoverWidgetMaxDimensions(maxRenderingWidth, maxRenderingHeight);\n    }\n    _resize(size) {\n        var _a, _b;\n        ContentHoverWidget_1._lastDimensions = new dom.Dimension(size.width, size.height);\n        this._setAdjustedHoverWidgetDimensions(size);\n        this._resizableNode.layout(size.height, size.width);\n        this._updateResizableNodeMaxDimensions();\n        this._hover.scrollbar.scanDomNode();\n        this._editor.layoutContentWidget(this);\n        (_b = (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.colorPicker) === null || _b === void 0 ? void 0 : _b.layout();\n    }\n    _findAvailableSpaceVertically() {\n        var _a;\n        const position = (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.showAtPosition;\n        if (!position) {\n            return;\n        }\n        return this._positionPreference === 1 /* ContentWidgetPositionPreference.ABOVE */ ?\n            this._availableVerticalSpaceAbove(position)\n            : this._availableVerticalSpaceBelow(position);\n    }\n    _findMaximumRenderingHeight() {\n        const availableSpace = this._findAvailableSpaceVertically();\n        if (!availableSpace) {\n            return;\n        }\n        // Padding needed in order to stop the resizing down to a smaller height\n        let maximumHeight = CONTAINER_HEIGHT_PADDING;\n        Array.from(this._hover.contentsDomNode.children).forEach((hoverPart) => {\n            maximumHeight += hoverPart.clientHeight;\n        });\n        return Math.min(availableSpace, maximumHeight);\n    }\n    _isHoverTextOverflowing() {\n        // To find out if the text is overflowing, we will disable wrapping, check the widths, and then re-enable wrapping\n        this._hover.containerDomNode.style.setProperty('--vscode-hover-whiteSpace', 'nowrap');\n        this._hover.containerDomNode.style.setProperty('--vscode-hover-sourceWhiteSpace', 'nowrap');\n        const overflowing = Array.from(this._hover.contentsDomNode.children).some((hoverElement) => {\n            return hoverElement.scrollWidth > hoverElement.clientWidth;\n        });\n        this._hover.containerDomNode.style.removeProperty('--vscode-hover-whiteSpace');\n        this._hover.containerDomNode.style.removeProperty('--vscode-hover-sourceWhiteSpace');\n        return overflowing;\n    }\n    _findMaximumRenderingWidth() {\n        if (!this._editor || !this._editor.hasModel()) {\n            return;\n        }\n        const overflowing = this._isHoverTextOverflowing();\n        const initialWidth = (typeof this._contentWidth === 'undefined'\n            ? 0\n            : this._contentWidth - 2 // - 2 for the borders\n        );\n        if (overflowing || this._hover.containerDomNode.clientWidth < initialWidth) {\n            const bodyBoxWidth = dom.getClientArea(this._hover.containerDomNode.ownerDocument.body).width;\n            const horizontalPadding = 14;\n            return bodyBoxWidth - horizontalPadding;\n        }\n        else {\n            return this._hover.containerDomNode.clientWidth + 2;\n        }\n    }\n    isMouseGettingCloser(posx, posy) {\n        if (!this._visibleData) {\n            return false;\n        }\n        if (typeof this._visibleData.initialMousePosX === 'undefined'\n            || typeof this._visibleData.initialMousePosY === 'undefined') {\n            this._visibleData.initialMousePosX = posx;\n            this._visibleData.initialMousePosY = posy;\n            return false;\n        }\n        const widgetRect = dom.getDomNodePagePosition(this.getDomNode());\n        if (typeof this._visibleData.closestMouseDistance === 'undefined') {\n            this._visibleData.closestMouseDistance = computeDistanceFromPointToRectangle(this._visibleData.initialMousePosX, this._visibleData.initialMousePosY, widgetRect.left, widgetRect.top, widgetRect.width, widgetRect.height);\n        }\n        const distance = computeDistanceFromPointToRectangle(posx, posy, widgetRect.left, widgetRect.top, widgetRect.width, widgetRect.height);\n        if (distance > this._visibleData.closestMouseDistance + 4 /* tolerance of 4 pixels */) {\n            // The mouse is getting farther away\n            return false;\n        }\n        this._visibleData.closestMouseDistance = Math.min(this._visibleData.closestMouseDistance, distance);\n        return true;\n    }\n    _setHoverData(hoverData) {\n        var _a;\n        (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.disposables.dispose();\n        this._visibleData = hoverData;\n        this._hoverVisibleKey.set(!!hoverData);\n        this._hover.containerDomNode.classList.toggle('hidden', !hoverData);\n    }\n    _updateFont() {\n        const { fontSize, lineHeight } = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        const contentsDomNode = this._hover.contentsDomNode;\n        contentsDomNode.style.fontSize = `${fontSize}px`;\n        contentsDomNode.style.lineHeight = `${lineHeight / fontSize}`;\n        const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\n        codeClasses.forEach(node => this._editor.applyFontInfo(node));\n    }\n    _updateContent(node) {\n        const contentsDomNode = this._hover.contentsDomNode;\n        contentsDomNode.style.paddingBottom = '';\n        contentsDomNode.textContent = '';\n        contentsDomNode.appendChild(node);\n    }\n    _layoutContentWidget() {\n        this._editor.layoutContentWidget(this);\n        this._hover.onContentsChanged();\n    }\n    _updateMaxDimensions() {\n        const height = Math.max(this._editor.getLayoutInfo().height / 4, 250, ContentHoverWidget_1._lastDimensions.height);\n        const width = Math.max(this._editor.getLayoutInfo().width * 0.66, 500, ContentHoverWidget_1._lastDimensions.width);\n        this._setHoverWidgetMaxDimensions(width, height);\n    }\n    _render(node, hoverData) {\n        this._setHoverData(hoverData);\n        this._updateFont();\n        this._updateContent(node);\n        this._updateMaxDimensions();\n        this.onContentsChanged();\n        // Simply force a synchronous render on the editor\n        // such that the widget does not really render with left = '0px'\n        this._editor.render();\n    }\n    getPosition() {\n        var _a;\n        if (!this._visibleData) {\n            return null;\n        }\n        return {\n            position: this._visibleData.showAtPosition,\n            secondaryPosition: this._visibleData.showAtSecondaryPosition,\n            positionAffinity: this._visibleData.isBeforeContent ? 3 /* PositionAffinity.LeftOfInjectedText */ : undefined,\n            preference: [(_a = this._positionPreference) !== null && _a !== void 0 ? _a : 1 /* ContentWidgetPositionPreference.ABOVE */]\n        };\n    }\n    showAt(node, hoverData) {\n        var _a, _b, _c, _d;\n        if (!this._editor || !this._editor.hasModel()) {\n            return;\n        }\n        this._render(node, hoverData);\n        const widgetHeight = dom.getTotalHeight(this._hover.containerDomNode);\n        const widgetPosition = hoverData.showAtPosition;\n        this._positionPreference = (_a = this._findPositionPreference(widgetHeight, widgetPosition)) !== null && _a !== void 0 ? _a : 1 /* ContentWidgetPositionPreference.ABOVE */;\n        // See https://github.com/microsoft/vscode/issues/140339\n        // TODO: Doing a second layout of the hover after force rendering the editor\n        this.onContentsChanged();\n        if (hoverData.stoleFocus) {\n            this._hover.containerDomNode.focus();\n        }\n        (_b = hoverData.colorPicker) === null || _b === void 0 ? void 0 : _b.layout();\n        // The aria label overrides the label, so if we add to it, add the contents of the hover\n        const hoverFocused = this._hover.containerDomNode.ownerDocument.activeElement === this._hover.containerDomNode;\n        const accessibleViewHint = hoverFocused && getHoverAccessibleViewHint(this._configurationService.getValue('accessibility.verbosity.hover') === true && this._accessibilityService.isScreenReaderOptimized(), (_d = (_c = this._keybindingService.lookupKeybinding('editor.action.accessibleView')) === null || _c === void 0 ? void 0 : _c.getAriaLabel()) !== null && _d !== void 0 ? _d : '');\n        if (accessibleViewHint) {\n            this._hover.contentsDomNode.ariaLabel = this._hover.contentsDomNode.textContent + ', ' + accessibleViewHint;\n        }\n    }\n    hide() {\n        if (!this._visibleData) {\n            return;\n        }\n        const stoleFocus = this._visibleData.stoleFocus || this._hoverFocusedKey.get();\n        this._setHoverData(undefined);\n        this._resizableNode.maxSize = new dom.Dimension(Infinity, Infinity);\n        this._resizableNode.clearSashHoverState();\n        this._hoverFocusedKey.set(false);\n        this._editor.layoutContentWidget(this);\n        if (stoleFocus) {\n            this._editor.focus();\n        }\n    }\n    _removeConstraintsRenderNormally() {\n        // Added because otherwise the initial size of the hover content is smaller than should be\n        const layoutInfo = this._editor.getLayoutInfo();\n        this._resizableNode.layout(layoutInfo.height, layoutInfo.width);\n        this._setHoverWidgetDimensions('auto', 'auto');\n    }\n    setMinimumDimensions(dimensions) {\n        // We combine the new minimum dimensions with the previous ones\n        this._minimumSize = new dom.Dimension(Math.max(this._minimumSize.width, dimensions.width), Math.max(this._minimumSize.height, dimensions.height));\n        this._updateMinimumWidth();\n    }\n    _updateMinimumWidth() {\n        const width = (typeof this._contentWidth === 'undefined'\n            ? this._minimumSize.width\n            : Math.min(this._contentWidth, this._minimumSize.width));\n        // We want to avoid that the hover is artificially large, so we use the content width as minimum width\n        this._resizableNode.minSize = new dom.Dimension(width, this._minimumSize.height);\n    }\n    onContentsChanged() {\n        var _a;\n        this._removeConstraintsRenderNormally();\n        const containerDomNode = this._hover.containerDomNode;\n        let height = dom.getTotalHeight(containerDomNode);\n        let width = dom.getTotalWidth(containerDomNode);\n        this._resizableNode.layout(height, width);\n        this._setHoverWidgetDimensions(width, height);\n        height = dom.getTotalHeight(containerDomNode);\n        width = dom.getTotalWidth(containerDomNode);\n        this._contentWidth = width;\n        this._updateMinimumWidth();\n        this._resizableNode.layout(height, width);\n        if ((_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.showAtPosition) {\n            const widgetHeight = dom.getTotalHeight(this._hover.containerDomNode);\n            this._positionPreference = this._findPositionPreference(widgetHeight, this._visibleData.showAtPosition);\n        }\n        this._layoutContentWidget();\n    }\n    focus() {\n        this._hover.containerDomNode.focus();\n    }\n    scrollUp() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop - fontInfo.lineHeight });\n    }\n    scrollDown() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop + fontInfo.lineHeight });\n    }\n    scrollLeft() {\n        const scrollLeft = this._hover.scrollbar.getScrollPosition().scrollLeft;\n        this._hover.scrollbar.setScrollPosition({ scrollLeft: scrollLeft - HORIZONTAL_SCROLLING_BY });\n    }\n    scrollRight() {\n        const scrollLeft = this._hover.scrollbar.getScrollPosition().scrollLeft;\n        this._hover.scrollbar.setScrollPosition({ scrollLeft: scrollLeft + HORIZONTAL_SCROLLING_BY });\n    }\n    pageUp() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const scrollHeight = this._hover.scrollbar.getScrollDimensions().height;\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop - scrollHeight });\n    }\n    pageDown() {\n        const scrollTop = this._hover.scrollbar.getScrollPosition().scrollTop;\n        const scrollHeight = this._hover.scrollbar.getScrollDimensions().height;\n        this._hover.scrollbar.setScrollPosition({ scrollTop: scrollTop + scrollHeight });\n    }\n    goToTop() {\n        this._hover.scrollbar.setScrollPosition({ scrollTop: 0 });\n    }\n    goToBottom() {\n        this._hover.scrollbar.setScrollPosition({ scrollTop: this._hover.scrollbar.getScrollDimensions().scrollHeight });\n    }\n};\nContentHoverWidget.ID = 'editor.contrib.resizableContentHoverWidget';\nContentHoverWidget._lastDimensions = new dom.Dimension(0, 0);\nContentHoverWidget = ContentHoverWidget_1 = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, IConfigurationService),\n    __param(3, IAccessibilityService),\n    __param(4, IKeybindingService)\n], ContentHoverWidget);\nexport { ContentHoverWidget };\nfunction computeDistanceFromPointToRectangle(pointX, pointY, left, top, width, height) {\n    const x = (left + width / 2); // x center of rectangle\n    const y = (top + height / 2); // y center of rectangle\n    const dx = Math.max(Math.abs(pointX - x) - width / 2, 0);\n    const dy = Math.max(Math.abs(pointY - y) - height / 2, 0);\n    return Math.sqrt(dx * dx + dy * dy);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createCancelableAsyncIterable, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nexport class HoverResult {\n    constructor(value, isComplete, hasLoadingMessage) {\n        this.value = value;\n        this.isComplete = isComplete;\n        this.hasLoadingMessage = hasLoadingMessage;\n    }\n}\n/**\n * Computing the hover is very fine tuned.\n *\n * Suppose the hover delay is 300ms (the default). Then, when resting the mouse at an anchor:\n * - at 150ms, the async computation is triggered (i.e. semantic hover)\n *   - if async results already come in, they are not rendered yet.\n * - at 300ms, the sync computation is triggered (i.e. decorations, markers)\n *   - if there are sync or async results, they are rendered.\n * - at 900ms, if the async computation hasn't finished, a \"Loading...\" result is added.\n */\nexport class HoverOperation extends Disposable {\n    constructor(_editor, _computer) {\n        super();\n        this._editor = _editor;\n        this._computer = _computer;\n        this._onResult = this._register(new Emitter());\n        this.onResult = this._onResult.event;\n        this._firstWaitScheduler = this._register(new RunOnceScheduler(() => this._triggerAsyncComputation(), 0));\n        this._secondWaitScheduler = this._register(new RunOnceScheduler(() => this._triggerSyncComputation(), 0));\n        this._loadingMessageScheduler = this._register(new RunOnceScheduler(() => this._triggerLoadingMessage(), 0));\n        this._state = 0 /* HoverOperationState.Idle */;\n        this._asyncIterable = null;\n        this._asyncIterableDone = false;\n        this._result = [];\n    }\n    dispose() {\n        if (this._asyncIterable) {\n            this._asyncIterable.cancel();\n            this._asyncIterable = null;\n        }\n        super.dispose();\n    }\n    get _hoverTime() {\n        return this._editor.getOption(60 /* EditorOption.hover */).delay;\n    }\n    get _firstWaitTime() {\n        return this._hoverTime / 2;\n    }\n    get _secondWaitTime() {\n        return this._hoverTime - this._firstWaitTime;\n    }\n    get _loadingMessageTime() {\n        return 3 * this._hoverTime;\n    }\n    _setState(state, fireResult = true) {\n        this._state = state;\n        if (fireResult) {\n            this._fireResult();\n        }\n    }\n    _triggerAsyncComputation() {\n        this._setState(2 /* HoverOperationState.SecondWait */);\n        this._secondWaitScheduler.schedule(this._secondWaitTime);\n        if (this._computer.computeAsync) {\n            this._asyncIterableDone = false;\n            this._asyncIterable = createCancelableAsyncIterable(token => this._computer.computeAsync(token));\n            (async () => {\n                try {\n                    for await (const item of this._asyncIterable) {\n                        if (item) {\n                            this._result.push(item);\n                            this._fireResult();\n                        }\n                    }\n                    this._asyncIterableDone = true;\n                    if (this._state === 3 /* HoverOperationState.WaitingForAsync */ || this._state === 4 /* HoverOperationState.WaitingForAsyncShowingLoading */) {\n                        this._setState(0 /* HoverOperationState.Idle */);\n                    }\n                }\n                catch (e) {\n                    onUnexpectedError(e);\n                }\n            })();\n        }\n        else {\n            this._asyncIterableDone = true;\n        }\n    }\n    _triggerSyncComputation() {\n        if (this._computer.computeSync) {\n            this._result = this._result.concat(this._computer.computeSync());\n        }\n        this._setState(this._asyncIterableDone ? 0 /* HoverOperationState.Idle */ : 3 /* HoverOperationState.WaitingForAsync */);\n    }\n    _triggerLoadingMessage() {\n        if (this._state === 3 /* HoverOperationState.WaitingForAsync */) {\n            this._setState(4 /* HoverOperationState.WaitingForAsyncShowingLoading */);\n        }\n    }\n    _fireResult() {\n        if (this._state === 1 /* HoverOperationState.FirstWait */ || this._state === 2 /* HoverOperationState.SecondWait */) {\n            // Do not send out results before the hover time\n            return;\n        }\n        const isComplete = (this._state === 0 /* HoverOperationState.Idle */);\n        const hasLoadingMessage = (this._state === 4 /* HoverOperationState.WaitingForAsyncShowingLoading */);\n        this._onResult.fire(new HoverResult(this._result.slice(0), isComplete, hasLoadingMessage));\n    }\n    start(mode) {\n        if (mode === 0 /* HoverStartMode.Delayed */) {\n            if (this._state === 0 /* HoverOperationState.Idle */) {\n                this._setState(1 /* HoverOperationState.FirstWait */);\n                this._firstWaitScheduler.schedule(this._firstWaitTime);\n                this._loadingMessageScheduler.schedule(this._loadingMessageTime);\n            }\n        }\n        else {\n            switch (this._state) {\n                case 0 /* HoverOperationState.Idle */:\n                    this._triggerAsyncComputation();\n                    this._secondWaitScheduler.cancel();\n                    this._triggerSyncComputation();\n                    break;\n                case 2 /* HoverOperationState.SecondWait */:\n                    this._secondWaitScheduler.cancel();\n                    this._triggerSyncComputation();\n                    break;\n            }\n        }\n    }\n    cancel() {\n        this._firstWaitScheduler.cancel();\n        this._secondWaitScheduler.cancel();\n        this._loadingMessageScheduler.cancel();\n        if (this._asyncIterable) {\n            this._asyncIterable.cancel();\n            this._asyncIterable = null;\n        }\n        this._result = [];\n        this._setState(0 /* HoverOperationState.Idle */, false);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nexport class ContentHoverComputer {\n    get anchor() { return this._anchor; }\n    set anchor(value) { this._anchor = value; }\n    get shouldFocus() { return this._shouldFocus; }\n    set shouldFocus(value) { this._shouldFocus = value; }\n    get source() { return this._source; }\n    set source(value) { this._source = value; }\n    get insistOnKeepingHoverVisible() { return this._insistOnKeepingHoverVisible; }\n    set insistOnKeepingHoverVisible(value) { this._insistOnKeepingHoverVisible = value; }\n    constructor(_editor, _participants) {\n        this._editor = _editor;\n        this._participants = _participants;\n        this._anchor = null;\n        this._shouldFocus = false;\n        this._source = 0 /* HoverStartSource.Mouse */;\n        this._insistOnKeepingHoverVisible = false;\n    }\n    static _getLineDecorations(editor, anchor) {\n        if (anchor.type !== 1 /* HoverAnchorType.Range */ && !anchor.supportsMarkerHover) {\n            return [];\n        }\n        const model = editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        if (lineNumber > model.getLineCount()) {\n            // invalid line\n            return [];\n        }\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        return editor.getLineDecorations(lineNumber).filter((d) => {\n            if (d.options.isWholeLine) {\n                return true;\n            }\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            if (d.options.showIfCollapsed) {\n                // Relax check around `showIfCollapsed` decorations to also include +/- 1 character\n                if (startColumn > anchor.range.startColumn + 1 || anchor.range.endColumn - 1 > endColumn) {\n                    return false;\n                }\n            }\n            else {\n                if (startColumn > anchor.range.startColumn || anchor.range.endColumn > endColumn) {\n                    return false;\n                }\n            }\n            return true;\n        });\n    }\n    computeAsync(token) {\n        const anchor = this._anchor;\n        if (!this._editor.hasModel() || !anchor) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, anchor);\n        return AsyncIterableObject.merge(this._participants.map((participant) => {\n            if (!participant.computeAsync) {\n                return AsyncIterableObject.EMPTY;\n            }\n            return participant.computeAsync(anchor, lineDecorations, token);\n        }));\n    }\n    computeSync() {\n        if (!this._editor.hasModel() || !this._anchor) {\n            return [];\n        }\n        const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, this._anchor);\n        let result = [];\n        for (const participant of this._participants) {\n            result = result.concat(participant.computeSync(this._anchor, lineDecorations));\n        }\n        return coalesce(result);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class HoverResult {\n    constructor(anchor, messages, isComplete) {\n        this.anchor = anchor;\n        this.messages = messages;\n        this.isComplete = isComplete;\n    }\n    filter(anchor) {\n        const filteredMessages = this.messages.filter((m) => m.isValidForHoverAnchor(anchor));\n        if (filteredMessages.length === this.messages.length) {\n            return this;\n        }\n        return new FilteredHoverResult(this, this.anchor, filteredMessages, this.isComplete);\n    }\n}\nexport class FilteredHoverResult extends HoverResult {\n    constructor(original, anchor, messages, isComplete) {\n        super(anchor, messages, isComplete);\n        this.original = original;\n    }\n    filter(anchor) {\n        return this.original.filter(anchor);\n    }\n}\nexport class ContentHoverVisibleData {\n    constructor(initialMousePosX, initialMousePosY, colorPicker, showAtPosition, showAtSecondaryPosition, preferAbove, stoleFocus, source, isBeforeContent, disposables) {\n        this.initialMousePosX = initialMousePosX;\n        this.initialMousePosY = initialMousePosY;\n        this.colorPicker = colorPicker;\n        this.showAtPosition = showAtPosition;\n        this.showAtSecondaryPosition = showAtSecondaryPosition;\n        this.preferAbove = preferAbove;\n        this.stoleFocus = stoleFocus;\n        this.source = source;\n        this.isBeforeContent = isBeforeContent;\n        this.disposables = disposables;\n        this.closestMouseDistance = undefined;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar ContentHoverController_1;\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { TokenizationRegistry } from '../../../common/languages.js';\nimport { HoverOperation } from './hoverOperation.js';\nimport { HoverParticipantRegistry, HoverRangeAnchor } from './hoverTypes.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { MarkdownHoverParticipant } from './markdownHoverParticipant.js';\nimport { InlayHintsHover } from '../../inlayHints/browser/inlayHintsHover.js';\nimport { ContentHoverWidget } from './contentHoverWidget.js';\nimport { ContentHoverComputer } from './contentHoverComputer.js';\nimport { ContentHoverVisibleData, HoverResult } from './contentHoverTypes.js';\nimport { EditorHoverStatusBar } from './contentHoverStatusBar.js';\nlet ContentHoverController = ContentHoverController_1 = class ContentHoverController extends Disposable {\n    constructor(_editor, _instantiationService, _keybindingService) {\n        super();\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._keybindingService = _keybindingService;\n        this._currentResult = null;\n        this._widget = this._register(this._instantiationService.createInstance(ContentHoverWidget, this._editor));\n        // Instantiate participants and sort them by `hoverOrdinal` which is relevant for rendering order.\n        this._participants = [];\n        for (const participant of HoverParticipantRegistry.getAll()) {\n            const participantInstance = this._instantiationService.createInstance(participant, this._editor);\n            if (participantInstance instanceof MarkdownHoverParticipant && !(participantInstance instanceof InlayHintsHover)) {\n                this._markdownHoverParticipant = participantInstance;\n            }\n            this._participants.push(participantInstance);\n        }\n        this._participants.sort((p1, p2) => p1.hoverOrdinal - p2.hoverOrdinal);\n        this._computer = new ContentHoverComputer(this._editor, this._participants);\n        this._hoverOperation = this._register(new HoverOperation(this._editor, this._computer));\n        this._register(this._hoverOperation.onResult((result) => {\n            if (!this._computer.anchor) {\n                // invalid state, ignore result\n                return;\n            }\n            const messages = (result.hasLoadingMessage ? this._addLoadingMessage(result.value) : result.value);\n            this._withResult(new HoverResult(this._computer.anchor, messages, result.isComplete));\n        }));\n        this._register(dom.addStandardDisposableListener(this._widget.getDomNode(), 'keydown', (e) => {\n            if (e.equals(9 /* KeyCode.Escape */)) {\n                this.hide();\n            }\n        }));\n        this._register(TokenizationRegistry.onDidChange(() => {\n            if (this._widget.position && this._currentResult) {\n                this._setCurrentResult(this._currentResult); // render again\n            }\n        }));\n    }\n    /**\n     * Returns true if the hover shows now or will show.\n     */\n    _startShowingOrUpdateHover(anchor, mode, source, focus, mouseEvent) {\n        if (!this._widget.position || !this._currentResult) {\n            // The hover is not visible\n            if (anchor) {\n                this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n                return true;\n            }\n            return false;\n        }\n        // The hover is currently visible\n        const isHoverSticky = this._editor.getOption(60 /* EditorOption.hover */).sticky;\n        const isGettingCloser = (isHoverSticky\n            && mouseEvent\n            && this._widget.isMouseGettingCloser(mouseEvent.event.posx, mouseEvent.event.posy));\n        if (isGettingCloser) {\n            // The mouse is getting closer to the hover, so we will keep the hover untouched\n            // But we will kick off a hover update at the new anchor, insisting on keeping the hover visible.\n            if (anchor) {\n                this._startHoverOperationIfNecessary(anchor, mode, source, focus, true);\n            }\n            return true;\n        }\n        if (!anchor) {\n            this._setCurrentResult(null);\n            return false;\n        }\n        if (anchor && this._currentResult.anchor.equals(anchor)) {\n            // The widget is currently showing results for the exact same anchor, so no update is needed\n            return true;\n        }\n        if (!anchor.canAdoptVisibleHover(this._currentResult.anchor, this._widget.position)) {\n            // The new anchor is not compatible with the previous anchor\n            this._setCurrentResult(null);\n            this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n            return true;\n        }\n        // We aren't getting any closer to the hover, so we will filter existing results\n        // and keep those which also apply to the new anchor.\n        this._setCurrentResult(this._currentResult.filter(anchor));\n        this._startHoverOperationIfNecessary(anchor, mode, source, focus, false);\n        return true;\n    }\n    _startHoverOperationIfNecessary(anchor, mode, source, focus, insistOnKeepingHoverVisible) {\n        if (this._computer.anchor && this._computer.anchor.equals(anchor)) {\n            // We have to start a hover operation at the exact same anchor as before, so no work is needed\n            return;\n        }\n        this._hoverOperation.cancel();\n        this._computer.anchor = anchor;\n        this._computer.shouldFocus = focus;\n        this._computer.source = source;\n        this._computer.insistOnKeepingHoverVisible = insistOnKeepingHoverVisible;\n        this._hoverOperation.start(mode);\n    }\n    _setCurrentResult(hoverResult) {\n        if (this._currentResult === hoverResult) {\n            // avoid updating the DOM to avoid resetting the user selection\n            return;\n        }\n        if (hoverResult && hoverResult.messages.length === 0) {\n            hoverResult = null;\n        }\n        this._currentResult = hoverResult;\n        if (this._currentResult) {\n            this._renderMessages(this._currentResult.anchor, this._currentResult.messages);\n        }\n        else {\n            this._widget.hide();\n        }\n    }\n    _addLoadingMessage(result) {\n        if (this._computer.anchor) {\n            for (const participant of this._participants) {\n                if (participant.createLoadingMessage) {\n                    const loadingMessage = participant.createLoadingMessage(this._computer.anchor);\n                    if (loadingMessage) {\n                        return result.slice(0).concat([loadingMessage]);\n                    }\n                }\n            }\n        }\n        return result;\n    }\n    _withResult(hoverResult) {\n        if (this._widget.position && this._currentResult && this._currentResult.isComplete) {\n            // The hover is visible with a previous complete result.\n            if (!hoverResult.isComplete) {\n                // Instead of rendering the new partial result, we wait for the result to be complete.\n                return;\n            }\n            if (this._computer.insistOnKeepingHoverVisible && hoverResult.messages.length === 0) {\n                // The hover would now hide normally, so we'll keep the previous messages\n                return;\n            }\n        }\n        this._setCurrentResult(hoverResult);\n    }\n    _renderMessages(anchor, messages) {\n        const { showAtPosition, showAtSecondaryPosition, highlightRange } = ContentHoverController_1.computeHoverRanges(this._editor, anchor.range, messages);\n        const disposables = new DisposableStore();\n        const statusBar = disposables.add(new EditorHoverStatusBar(this._keybindingService));\n        const fragment = document.createDocumentFragment();\n        let colorPicker = null;\n        const context = {\n            fragment,\n            statusBar,\n            setColorPicker: (widget) => colorPicker = widget,\n            onContentsChanged: () => this._widget.onContentsChanged(),\n            setMinimumDimensions: (dimensions) => this._widget.setMinimumDimensions(dimensions),\n            hide: () => this.hide()\n        };\n        for (const participant of this._participants) {\n            const hoverParts = messages.filter(msg => msg.owner === participant);\n            if (hoverParts.length > 0) {\n                disposables.add(participant.renderHoverParts(context, hoverParts));\n            }\n        }\n        const isBeforeContent = messages.some(m => m.isBeforeContent);\n        if (statusBar.hasContent) {\n            fragment.appendChild(statusBar.hoverElement);\n        }\n        if (fragment.hasChildNodes()) {\n            if (highlightRange) {\n                const highlightDecoration = this._editor.createDecorationsCollection();\n                highlightDecoration.set([{\n                        range: highlightRange,\n                        options: ContentHoverController_1._DECORATION_OPTIONS\n                    }]);\n                disposables.add(toDisposable(() => {\n                    highlightDecoration.clear();\n                }));\n            }\n            this._widget.showAt(fragment, new ContentHoverVisibleData(anchor.initialMousePosX, anchor.initialMousePosY, colorPicker, showAtPosition, showAtSecondaryPosition, this._editor.getOption(60 /* EditorOption.hover */).above, this._computer.shouldFocus, this._computer.source, isBeforeContent, disposables));\n        }\n        else {\n            disposables.dispose();\n        }\n    }\n    static computeHoverRanges(editor, anchorRange, messages) {\n        let startColumnBoundary = 1;\n        if (editor.hasModel()) {\n            // Ensure the range is on the current view line\n            const viewModel = editor._getViewModel();\n            const coordinatesConverter = viewModel.coordinatesConverter;\n            const anchorViewRange = coordinatesConverter.convertModelRangeToViewRange(anchorRange);\n            const anchorViewRangeStart = new Position(anchorViewRange.startLineNumber, viewModel.getLineMinColumn(anchorViewRange.startLineNumber));\n            startColumnBoundary = coordinatesConverter.convertViewPositionToModelPosition(anchorViewRangeStart).column;\n        }\n        // The anchor range is always on a single line\n        const anchorLineNumber = anchorRange.startLineNumber;\n        let renderStartColumn = anchorRange.startColumn;\n        let highlightRange = messages[0].range;\n        let forceShowAtRange = null;\n        for (const msg of messages) {\n            highlightRange = Range.plusRange(highlightRange, msg.range);\n            if (msg.range.startLineNumber === anchorLineNumber && msg.range.endLineNumber === anchorLineNumber) {\n                // this message has a range that is completely sitting on the line of the anchor\n                renderStartColumn = Math.max(Math.min(renderStartColumn, msg.range.startColumn), startColumnBoundary);\n            }\n            if (msg.forceShowAtRange) {\n                forceShowAtRange = msg.range;\n            }\n        }\n        const showAtPosition = forceShowAtRange ? forceShowAtRange.getStartPosition() : new Position(anchorLineNumber, anchorRange.startColumn);\n        const showAtSecondaryPosition = forceShowAtRange ? forceShowAtRange.getStartPosition() : new Position(anchorLineNumber, renderStartColumn);\n        return {\n            showAtPosition,\n            showAtSecondaryPosition,\n            highlightRange\n        };\n    }\n    showsOrWillShow(mouseEvent) {\n        if (this._widget.isResizing) {\n            return true;\n        }\n        const anchorCandidates = [];\n        for (const participant of this._participants) {\n            if (participant.suggestHoverAnchor) {\n                const anchor = participant.suggestHoverAnchor(mouseEvent);\n                if (anchor) {\n                    anchorCandidates.push(anchor);\n                }\n            }\n        }\n        const target = mouseEvent.target;\n        if (target.type === 6 /* MouseTargetType.CONTENT_TEXT */) {\n            anchorCandidates.push(new HoverRangeAnchor(0, target.range, mouseEvent.event.posx, mouseEvent.event.posy));\n        }\n        if (target.type === 7 /* MouseTargetType.CONTENT_EMPTY */) {\n            const epsilon = this._editor.getOption(50 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth / 2;\n            if (!target.detail.isAfterLines\n                && typeof target.detail.horizontalDistanceToText === 'number'\n                && target.detail.horizontalDistanceToText < epsilon) {\n                // Let hover kick in even when the mouse is technically in the empty area after a line, given the distance is small enough\n                anchorCandidates.push(new HoverRangeAnchor(0, target.range, mouseEvent.event.posx, mouseEvent.event.posy));\n            }\n        }\n        if (anchorCandidates.length === 0) {\n            return this._startShowingOrUpdateHover(null, 0 /* HoverStartMode.Delayed */, 0 /* HoverStartSource.Mouse */, false, mouseEvent);\n        }\n        anchorCandidates.sort((a, b) => b.priority - a.priority);\n        return this._startShowingOrUpdateHover(anchorCandidates[0], 0 /* HoverStartMode.Delayed */, 0 /* HoverStartSource.Mouse */, false, mouseEvent);\n    }\n    startShowingAtRange(range, mode, source, focus) {\n        this._startShowingOrUpdateHover(new HoverRangeAnchor(0, range, undefined, undefined), mode, source, focus, null);\n    }\n    async updateFocusedMarkdownHoverVerbosityLevel(action) {\n        var _a;\n        (_a = this._markdownHoverParticipant) === null || _a === void 0 ? void 0 : _a.updateFocusedMarkdownHoverPartVerbosityLevel(action);\n    }\n    containsNode(node) {\n        return (node ? this._widget.getDomNode().contains(node) : false);\n    }\n    focus() {\n        this._widget.focus();\n    }\n    scrollUp() {\n        this._widget.scrollUp();\n    }\n    scrollDown() {\n        this._widget.scrollDown();\n    }\n    scrollLeft() {\n        this._widget.scrollLeft();\n    }\n    scrollRight() {\n        this._widget.scrollRight();\n    }\n    pageUp() {\n        this._widget.pageUp();\n    }\n    pageDown() {\n        this._widget.pageDown();\n    }\n    goToTop() {\n        this._widget.goToTop();\n    }\n    goToBottom() {\n        this._widget.goToBottom();\n    }\n    hide() {\n        this._computer.anchor = null;\n        this._hoverOperation.cancel();\n        this._setCurrentResult(null);\n    }\n    get isColorPickerVisible() {\n        return this._widget.isColorPickerVisible;\n    }\n    get isVisibleFromKeyboard() {\n        return this._widget.isVisibleFromKeyboard;\n    }\n    get isVisible() {\n        return this._widget.isVisible;\n    }\n    get isFocused() {\n        return this._widget.isFocused;\n    }\n    get isResizing() {\n        return this._widget.isResizing;\n    }\n    get widget() {\n        return this._widget;\n    }\n};\nContentHoverController._DECORATION_OPTIONS = ModelDecorationOptions.register({\n    description: 'content-hover-highlight',\n    className: 'hoverHighlight'\n});\nContentHoverController = ContentHoverController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IKeybindingService)\n], ContentHoverController);\nexport { ContentHoverController };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { asArray } from '../../../../base/common/arrays.js';\nimport { isEmptyMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { GlyphMarginLane } from '../../../common/model.js';\nexport class MarginHoverComputer {\n    get lineNumber() {\n        return this._lineNumber;\n    }\n    set lineNumber(value) {\n        this._lineNumber = value;\n    }\n    get lane() {\n        return this._laneOrLine;\n    }\n    set lane(value) {\n        this._laneOrLine = value;\n    }\n    constructor(_editor) {\n        this._editor = _editor;\n        this._lineNumber = -1;\n        this._laneOrLine = GlyphMarginLane.Center;\n    }\n    computeSync() {\n        var _a, _b;\n        const toHoverMessage = (contents) => {\n            return {\n                value: contents\n            };\n        };\n        const lineDecorations = this._editor.getLineDecorations(this._lineNumber);\n        const result = [];\n        const isLineHover = this._laneOrLine === 'lineNo';\n        if (!lineDecorations) {\n            return result;\n        }\n        for (const d of lineDecorations) {\n            const lane = (_b = (_a = d.options.glyphMargin) === null || _a === void 0 ? void 0 : _a.position) !== null && _b !== void 0 ? _b : GlyphMarginLane.Center;\n            if (!isLineHover && lane !== this._laneOrLine) {\n                continue;\n            }\n            const hoverMessage = isLineHover ? d.options.lineNumberHoverMessage : d.options.glyphMarginHoverMessage;\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\n                continue;\n            }\n            result.push(...asArray(hoverMessage).map(toHoverMessage));\n        }\n        return result;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { HoverOperation } from './hoverOperation.js';\nimport { HoverWidget } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { MarginHoverComputer } from './marginHoverComputer.js';\nconst $ = dom.$;\nexport class MarginHoverWidget extends Disposable {\n    constructor(editor, languageService, openerService) {\n        super();\n        this._renderDisposeables = this._register(new DisposableStore());\n        this._editor = editor;\n        this._isVisible = false;\n        this._messages = [];\n        this._hover = this._register(new HoverWidget());\n        this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n        this._markdownRenderer = this._register(new MarkdownRenderer({ editor: this._editor }, languageService, openerService));\n        this._computer = new MarginHoverComputer(this._editor);\n        this._hoverOperation = this._register(new HoverOperation(this._editor, this._computer));\n        this._register(this._hoverOperation.onResult((result) => {\n            this._withResult(result.value);\n        }));\n        this._register(this._editor.onDidChangeModelDecorations(() => this._onModelDecorationsChanged()));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._editor.addOverlayWidget(this);\n    }\n    dispose() {\n        this._editor.removeOverlayWidget(this);\n        super.dispose();\n    }\n    getId() {\n        return MarginHoverWidget.ID;\n    }\n    getDomNode() {\n        return this._hover.containerDomNode;\n    }\n    getPosition() {\n        return null;\n    }\n    _updateFont() {\n        const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\n        codeClasses.forEach(node => this._editor.applyFontInfo(node));\n    }\n    _onModelDecorationsChanged() {\n        if (this._isVisible) {\n            // The decorations have changed and the hover is visible,\n            // we need to recompute the displayed text\n            this._hoverOperation.cancel();\n            this._hoverOperation.start(0 /* HoverStartMode.Delayed */);\n        }\n    }\n    showsOrWillShow(mouseEvent) {\n        const target = mouseEvent.target;\n        if (target.type === 2 /* MouseTargetType.GUTTER_GLYPH_MARGIN */ && target.detail.glyphMarginLane) {\n            this._startShowingAt(target.position.lineNumber, target.detail.glyphMarginLane);\n            return true;\n        }\n        if (target.type === 3 /* MouseTargetType.GUTTER_LINE_NUMBERS */) {\n            this._startShowingAt(target.position.lineNumber, 'lineNo');\n            return true;\n        }\n        return false;\n    }\n    _startShowingAt(lineNumber, laneOrLine) {\n        if (this._computer.lineNumber === lineNumber && this._computer.lane === laneOrLine) {\n            // We have to show the widget at the exact same line number as before, so no work is needed\n            return;\n        }\n        this._hoverOperation.cancel();\n        this.hide();\n        this._computer.lineNumber = lineNumber;\n        this._computer.lane = laneOrLine;\n        this._hoverOperation.start(0 /* HoverStartMode.Delayed */);\n    }\n    hide() {\n        this._computer.lineNumber = -1;\n        this._hoverOperation.cancel();\n        if (!this._isVisible) {\n            return;\n        }\n        this._isVisible = false;\n        this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n    }\n    _withResult(result) {\n        this._messages = result;\n        if (this._messages.length > 0) {\n            this._renderMessages(this._computer.lineNumber, this._messages);\n        }\n        else {\n            this.hide();\n        }\n    }\n    _renderMessages(lineNumber, messages) {\n        this._renderDisposeables.clear();\n        const fragment = document.createDocumentFragment();\n        for (const msg of messages) {\n            const markdownHoverElement = $('div.hover-row.markdown-hover');\n            const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n            const renderedContents = this._renderDisposeables.add(this._markdownRenderer.render(msg.value));\n            hoverContentsElement.appendChild(renderedContents.element);\n            fragment.appendChild(markdownHoverElement);\n        }\n        this._updateContents(fragment);\n        this._showAt(lineNumber);\n    }\n    _updateContents(node) {\n        this._hover.contentsDomNode.textContent = '';\n        this._hover.contentsDomNode.appendChild(node);\n        this._updateFont();\n    }\n    _showAt(lineNumber) {\n        if (!this._isVisible) {\n            this._isVisible = true;\n            this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n        }\n        const editorLayout = this._editor.getLayoutInfo();\n        const topForLineNumber = this._editor.getTopForLineNumber(lineNumber);\n        const editorScrollTop = this._editor.getScrollTop();\n        const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n        const nodeHeight = this._hover.containerDomNode.clientHeight;\n        const top = topForLineNumber - editorScrollTop - ((nodeHeight - lineHeight) / 2);\n        const left = editorLayout.glyphMarginLeft + editorLayout.glyphMarginWidth + (this._computer.lane === 'lineNo' ? editorLayout.lineNumbersWidth : 0);\n        this._hover.containerDomNode.style.left = `${left}px`;\n        this._hover.containerDomNode.style.top = `${Math.max(Math.round(top), 0)}px`;\n    }\n}\nMarginHoverWidget.ID = 'editor.contrib.modesGlyphHoverWidget';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar HoverController_1;\nimport { DECREASE_HOVER_VERBOSITY_ACTION_ID, INCREASE_HOVER_VERBOSITY_ACTION_ID, SHOW_OR_FOCUS_HOVER_ACTION_ID } from './hoverActionIds.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { InlineSuggestionHintsContentWidget } from '../../inlineCompletions/browser/inlineCompletionsHintsWidget.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { ContentHoverWidget } from './contentHoverWidget.js';\nimport { ContentHoverController } from './contentHoverController.js';\nimport './hover.css';\nimport { MarginHoverWidget } from './marginHoverWidget.js';\n// sticky hover widget which doesn't disappear on focus out and such\nconst _sticky = false;\nlet HoverController = HoverController_1 = class HoverController extends Disposable {\n    constructor(_editor, _instantiationService, _keybindingService) {\n        super();\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._keybindingService = _keybindingService;\n        this._listenersStore = new DisposableStore();\n        this._hoverState = {\n            mouseDown: false,\n            activatedByDecoratorClick: false\n        };\n        this._reactToEditorMouseMoveRunner = this._register(new RunOnceScheduler(() => this._reactToEditorMouseMove(this._mouseMoveEvent), 0));\n        this._hookListeners();\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(60 /* EditorOption.hover */)) {\n                this._unhookListeners();\n                this._hookListeners();\n            }\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(HoverController_1.ID);\n    }\n    _hookListeners() {\n        const hoverOpts = this._editor.getOption(60 /* EditorOption.hover */);\n        this._hoverSettings = {\n            enabled: hoverOpts.enabled,\n            sticky: hoverOpts.sticky,\n            hidingDelay: hoverOpts.delay\n        };\n        if (hoverOpts.enabled) {\n            this._listenersStore.add(this._editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n            this._listenersStore.add(this._editor.onMouseUp(() => this._onEditorMouseUp()));\n            this._listenersStore.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\n            this._listenersStore.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\n        }\n        else {\n            this._listenersStore.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\n            this._listenersStore.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\n        }\n        this._listenersStore.add(this._editor.onMouseLeave((e) => this._onEditorMouseLeave(e)));\n        this._listenersStore.add(this._editor.onDidChangeModel(() => {\n            this._cancelScheduler();\n            this._hideWidgets();\n        }));\n        this._listenersStore.add(this._editor.onDidChangeModelContent(() => this._cancelScheduler()));\n        this._listenersStore.add(this._editor.onDidScrollChange((e) => this._onEditorScrollChanged(e)));\n    }\n    _unhookListeners() {\n        this._listenersStore.clear();\n    }\n    _cancelScheduler() {\n        this._mouseMoveEvent = undefined;\n        this._reactToEditorMouseMoveRunner.cancel();\n    }\n    _onEditorScrollChanged(e) {\n        if (e.scrollTopChanged || e.scrollLeftChanged) {\n            this._hideWidgets();\n        }\n    }\n    _onEditorMouseDown(mouseEvent) {\n        this._hoverState.mouseDown = true;\n        const shouldNotHideCurrentHoverWidget = this._shouldNotHideCurrentHoverWidget(mouseEvent);\n        if (shouldNotHideCurrentHoverWidget) {\n            return;\n        }\n        this._hideWidgets();\n    }\n    _shouldNotHideCurrentHoverWidget(mouseEvent) {\n        if (this._isMouseOnContentHoverWidget(mouseEvent)\n            || this._isMouseOnMarginHoverWidget(mouseEvent)\n            || this._isContentWidgetResizing()) {\n            return true;\n        }\n        return false;\n    }\n    _isMouseOnMarginHoverWidget(mouseEvent) {\n        const target = mouseEvent.target;\n        if (!target) {\n            return false;\n        }\n        return target.type === 12 /* MouseTargetType.OVERLAY_WIDGET */ && target.detail === MarginHoverWidget.ID;\n    }\n    _isMouseOnContentHoverWidget(mouseEvent) {\n        const target = mouseEvent.target;\n        if (!target) {\n            return false;\n        }\n        return target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && target.detail === ContentHoverWidget.ID;\n    }\n    _onEditorMouseUp() {\n        this._hoverState.mouseDown = false;\n    }\n    _onEditorMouseLeave(mouseEvent) {\n        this._cancelScheduler();\n        const shouldNotHideCurrentHoverWidget = this._shouldNotHideCurrentHoverWidget(mouseEvent);\n        if (shouldNotHideCurrentHoverWidget) {\n            return;\n        }\n        if (_sticky) {\n            return;\n        }\n        this._hideWidgets();\n    }\n    _shouldNotRecomputeCurrentHoverWidget(mouseEvent) {\n        const isHoverSticky = this._hoverSettings.sticky;\n        const isMouseOnStickyMarginHoverWidget = (mouseEvent, isHoverSticky) => {\n            const isMouseOnMarginHoverWidget = this._isMouseOnMarginHoverWidget(mouseEvent);\n            return isHoverSticky && isMouseOnMarginHoverWidget;\n        };\n        const isMouseOnStickyContentHoverWidget = (mouseEvent, isHoverSticky) => {\n            const isMouseOnContentHoverWidget = this._isMouseOnContentHoverWidget(mouseEvent);\n            return isHoverSticky && isMouseOnContentHoverWidget;\n        };\n        const isMouseOnColorPicker = (mouseEvent) => {\n            var _a;\n            const isMouseOnContentHoverWidget = this._isMouseOnContentHoverWidget(mouseEvent);\n            const isColorPickerVisible = (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isColorPickerVisible;\n            return isMouseOnContentHoverWidget && isColorPickerVisible;\n        };\n        // TODO@aiday-mar verify if the following is necessary code\n        const isTextSelectedWithinContentHoverWidget = (mouseEvent, sticky) => {\n            var _a, _b, _c, _d;\n            return sticky\n                && ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.containsNode((_b = mouseEvent.event.browserEvent.view) === null || _b === void 0 ? void 0 : _b.document.activeElement))\n                && !((_d = (_c = mouseEvent.event.browserEvent.view) === null || _c === void 0 ? void 0 : _c.getSelection()) === null || _d === void 0 ? void 0 : _d.isCollapsed);\n        };\n        if (isMouseOnStickyMarginHoverWidget(mouseEvent, isHoverSticky)\n            || isMouseOnStickyContentHoverWidget(mouseEvent, isHoverSticky)\n            || isMouseOnColorPicker(mouseEvent)\n            || isTextSelectedWithinContentHoverWidget(mouseEvent, isHoverSticky)) {\n            return true;\n        }\n        return false;\n    }\n    _onEditorMouseMove(mouseEvent) {\n        var _a, _b, _c, _d;\n        this._mouseMoveEvent = mouseEvent;\n        if (((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isFocused) || ((_b = this._contentWidget) === null || _b === void 0 ? void 0 : _b.isResizing)) {\n            return;\n        }\n        const sticky = this._hoverSettings.sticky;\n        if (sticky && ((_c = this._contentWidget) === null || _c === void 0 ? void 0 : _c.isVisibleFromKeyboard)) {\n            // Sticky mode is on and the hover has been shown via keyboard\n            // so moving the mouse has no effect\n            return;\n        }\n        const shouldNotRecomputeCurrentHoverWidget = this._shouldNotRecomputeCurrentHoverWidget(mouseEvent);\n        if (shouldNotRecomputeCurrentHoverWidget) {\n            this._reactToEditorMouseMoveRunner.cancel();\n            return;\n        }\n        const hidingDelay = this._hoverSettings.hidingDelay;\n        const isContentHoverWidgetVisible = (_d = this._contentWidget) === null || _d === void 0 ? void 0 : _d.isVisible;\n        // If the mouse is not over the widget, and if sticky is on,\n        // then give it a grace period before reacting to the mouse event\n        const shouldRescheduleHoverComputation = isContentHoverWidgetVisible && sticky && hidingDelay > 0;\n        if (shouldRescheduleHoverComputation) {\n            if (!this._reactToEditorMouseMoveRunner.isScheduled()) {\n                this._reactToEditorMouseMoveRunner.schedule(hidingDelay);\n            }\n            return;\n        }\n        this._reactToEditorMouseMove(mouseEvent);\n    }\n    _reactToEditorMouseMove(mouseEvent) {\n        var _a;\n        if (!mouseEvent) {\n            return;\n        }\n        const target = mouseEvent.target;\n        const mouseOnDecorator = (_a = target.element) === null || _a === void 0 ? void 0 : _a.classList.contains('colorpicker-color-decoration');\n        const decoratorActivatedOn = this._editor.getOption(148 /* EditorOption.colorDecoratorsActivatedOn */);\n        const enabled = this._hoverSettings.enabled;\n        const activatedByDecoratorClick = this._hoverState.activatedByDecoratorClick;\n        if ((mouseOnDecorator && ((decoratorActivatedOn === 'click' && !activatedByDecoratorClick) ||\n            (decoratorActivatedOn === 'hover' && !enabled && !_sticky) ||\n            (decoratorActivatedOn === 'clickAndHover' && !enabled && !activatedByDecoratorClick))) || (!mouseOnDecorator && !enabled && !activatedByDecoratorClick)) {\n            this._hideWidgets();\n            return;\n        }\n        const contentHoverShowsOrWillShow = this._tryShowHoverWidget(mouseEvent, 0 /* HoverWidgetType.Content */);\n        if (contentHoverShowsOrWillShow) {\n            return;\n        }\n        const glyphWidgetShowsOrWillShow = this._tryShowHoverWidget(mouseEvent, 1 /* HoverWidgetType.Glyph */);\n        if (glyphWidgetShowsOrWillShow) {\n            return;\n        }\n        if (_sticky) {\n            return;\n        }\n        this._hideWidgets();\n    }\n    _tryShowHoverWidget(mouseEvent, hoverWidgetType) {\n        const contentWidget = this._getOrCreateContentWidget();\n        const glyphWidget = this._getOrCreateGlyphWidget();\n        let currentWidget;\n        let otherWidget;\n        switch (hoverWidgetType) {\n            case 0 /* HoverWidgetType.Content */:\n                currentWidget = contentWidget;\n                otherWidget = glyphWidget;\n                break;\n            case 1 /* HoverWidgetType.Glyph */:\n                currentWidget = glyphWidget;\n                otherWidget = contentWidget;\n                break;\n            default:\n                throw new Error(`HoverWidgetType ${hoverWidgetType} is unrecognized`);\n        }\n        const showsOrWillShow = currentWidget.showsOrWillShow(mouseEvent);\n        if (showsOrWillShow) {\n            otherWidget.hide();\n        }\n        return showsOrWillShow;\n    }\n    _onKeyDown(e) {\n        var _a;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const resolvedKeyboardEvent = this._keybindingService.softDispatch(e, this._editor.getDomNode());\n        // If the beginning of a multi-chord keybinding is pressed,\n        // or the command aims to focus the hover,\n        // set the variable to true, otherwise false\n        const shouldKeepHoverVisible = (resolvedKeyboardEvent.kind === 1 /* ResultKind.MoreChordsNeeded */ ||\n            (resolvedKeyboardEvent.kind === 2 /* ResultKind.KbFound */\n                && (resolvedKeyboardEvent.commandId === SHOW_OR_FOCUS_HOVER_ACTION_ID\n                    || resolvedKeyboardEvent.commandId === INCREASE_HOVER_VERBOSITY_ACTION_ID\n                    || resolvedKeyboardEvent.commandId === DECREASE_HOVER_VERBOSITY_ACTION_ID)\n                && ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isVisible)));\n        if (e.keyCode === 5 /* KeyCode.Ctrl */\n            || e.keyCode === 6 /* KeyCode.Alt */\n            || e.keyCode === 57 /* KeyCode.Meta */\n            || e.keyCode === 4 /* KeyCode.Shift */\n            || shouldKeepHoverVisible) {\n            // Do not hide hover when a modifier key is pressed\n            return;\n        }\n        this._hideWidgets();\n    }\n    _hideWidgets() {\n        var _a, _b, _c;\n        if (_sticky) {\n            return;\n        }\n        if ((this._hoverState.mouseDown\n            && ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isColorPickerVisible)) || InlineSuggestionHintsContentWidget.dropDownVisible) {\n            return;\n        }\n        this._hoverState.activatedByDecoratorClick = false;\n        (_b = this._glyphWidget) === null || _b === void 0 ? void 0 : _b.hide();\n        (_c = this._contentWidget) === null || _c === void 0 ? void 0 : _c.hide();\n    }\n    _getOrCreateContentWidget() {\n        if (!this._contentWidget) {\n            this._contentWidget = this._instantiationService.createInstance(ContentHoverController, this._editor);\n        }\n        return this._contentWidget;\n    }\n    _getOrCreateGlyphWidget() {\n        if (!this._glyphWidget) {\n            this._glyphWidget = this._instantiationService.createInstance(MarginHoverWidget, this._editor);\n        }\n        return this._glyphWidget;\n    }\n    showContentHover(range, mode, source, focus, activatedByColorDecoratorClick = false) {\n        this._hoverState.activatedByDecoratorClick = activatedByColorDecoratorClick;\n        this._getOrCreateContentWidget().startShowingAtRange(range, mode, source, focus);\n    }\n    _isContentWidgetResizing() {\n        var _a;\n        return ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.widget.isResizing) || false;\n    }\n    updateFocusedMarkdownHoverVerbosityLevel(action) {\n        this._getOrCreateContentWidget().updateFocusedMarkdownHoverVerbosityLevel(action);\n    }\n    focus() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.focus();\n    }\n    scrollUp() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.scrollUp();\n    }\n    scrollDown() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.scrollDown();\n    }\n    scrollLeft() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.scrollLeft();\n    }\n    scrollRight() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.scrollRight();\n    }\n    pageUp() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.pageUp();\n    }\n    pageDown() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.pageDown();\n    }\n    goToTop() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.goToTop();\n    }\n    goToBottom() {\n        var _a;\n        (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.goToBottom();\n    }\n    get isColorPickerVisible() {\n        var _a;\n        return (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isColorPickerVisible;\n    }\n    get isHoverVisible() {\n        var _a;\n        return (_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isVisible;\n    }\n    dispose() {\n        var _a, _b;\n        super.dispose();\n        this._unhookListeners();\n        this._listenersStore.dispose();\n        (_a = this._glyphWidget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._contentWidget) === null || _b === void 0 ? void 0 : _b.dispose();\n    }\n};\nHoverController.ID = 'editor.contrib.hover';\nHoverController = HoverController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IKeybindingService)\n], HoverController);\nexport { HoverController };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class HoverRangeAnchor {\n    constructor(priority, range, initialMousePosX, initialMousePosY) {\n        this.priority = priority;\n        this.range = range;\n        this.initialMousePosX = initialMousePosX;\n        this.initialMousePosY = initialMousePosY;\n        this.type = 1 /* HoverAnchorType.Range */;\n    }\n    equals(other) {\n        return (other.type === 1 /* HoverAnchorType.Range */ && this.range.equalsRange(other.range));\n    }\n    canAdoptVisibleHover(lastAnchor, showAtPosition) {\n        return (lastAnchor.type === 1 /* HoverAnchorType.Range */ && showAtPosition.lineNumber === this.range.startLineNumber);\n    }\n}\nexport class HoverForeignElementAnchor {\n    constructor(priority, owner, range, initialMousePosX, initialMousePosY, supportsMarkerHover) {\n        this.priority = priority;\n        this.owner = owner;\n        this.range = range;\n        this.initialMousePosX = initialMousePosX;\n        this.initialMousePosY = initialMousePosY;\n        this.supportsMarkerHover = supportsMarkerHover;\n        this.type = 2 /* HoverAnchorType.ForeignElement */;\n    }\n    equals(other) {\n        return (other.type === 2 /* HoverAnchorType.ForeignElement */ && this.owner === other.owner);\n    }\n    canAdoptVisibleHover(lastAnchor, showAtPosition) {\n        return (lastAnchor.type === 2 /* HoverAnchorType.ForeignElement */ && this.owner === lastAnchor.owner);\n    }\n}\nexport const HoverParticipantRegistry = (new class HoverParticipantRegistry {\n    constructor() {\n        this._participants = [];\n    }\n    register(ctor) {\n        this._participants.push(ctor);\n    }\n    getAll() {\n        return this._participants;\n    }\n}());\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { asArray, compareBy, numberComparator } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { isEmptyMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { DECREASE_HOVER_VERBOSITY_ACTION_ID, INCREASE_HOVER_VERBOSITY_ACTION_ID } from './hoverActionIds.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport * as nls from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { HoverVerbosityAction } from '../../../common/languages.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ClickAction, KeyDownAction } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { IHoverService, WorkbenchHoverDelegate } from '../../../../platform/hover/browser/hover.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { getHoverProviderResultsAsAsyncIterable } from './getHover.js';\nconst $ = dom.$;\nconst increaseHoverVerbosityIcon = registerIcon('hover-increase-verbosity', Codicon.add, nls.localize('increaseHoverVerbosity', 'Icon for increaseing hover verbosity.'));\nconst decreaseHoverVerbosityIcon = registerIcon('hover-decrease-verbosity', Codicon.remove, nls.localize('decreaseHoverVerbosity', 'Icon for decreasing hover verbosity.'));\nexport class MarkdownHover {\n    constructor(owner, range, contents, isBeforeContent, ordinal, source = undefined) {\n        this.owner = owner;\n        this.range = range;\n        this.contents = contents;\n        this.isBeforeContent = isBeforeContent;\n        this.ordinal = ordinal;\n        this.source = source;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nclass HoverSource {\n    constructor(hover, hoverProvider, hoverPosition) {\n        this.hover = hover;\n        this.hoverProvider = hoverProvider;\n        this.hoverPosition = hoverPosition;\n    }\n    supportsVerbosityAction(hoverVerbosityAction) {\n        var _a, _b;\n        switch (hoverVerbosityAction) {\n            case HoverVerbosityAction.Increase:\n                return (_a = this.hover.canIncreaseVerbosity) !== null && _a !== void 0 ? _a : false;\n            case HoverVerbosityAction.Decrease:\n                return (_b = this.hover.canDecreaseVerbosity) !== null && _b !== void 0 ? _b : false;\n        }\n    }\n}\nlet MarkdownHoverParticipant = class MarkdownHoverParticipant {\n    constructor(_editor, _languageService, _openerService, _configurationService, _languageFeaturesService, _keybindingService, _hoverService) {\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._keybindingService = _keybindingService;\n        this._hoverService = _hoverService;\n        this.hoverOrdinal = 3;\n    }\n    createLoadingMessage(anchor) {\n        return new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(nls.localize('modesContentHover.loading', \"Loading...\"))], false, 2000);\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        const result = [];\n        let index = 1000;\n        const lineLength = model.getLineLength(lineNumber);\n        const languageId = model.getLanguageIdAtPosition(anchor.range.startLineNumber, anchor.range.startColumn);\n        const stopRenderingLineAfter = this._editor.getOption(117 /* EditorOption.stopRenderingLineAfter */);\n        const maxTokenizationLineLength = this._configurationService.getValue('editor.maxTokenizationLineLength', {\n            overrideIdentifier: languageId\n        });\n        let stopRenderingMessage = false;\n        if (stopRenderingLineAfter >= 0 && lineLength > stopRenderingLineAfter && anchor.range.startColumn >= stopRenderingLineAfter) {\n            stopRenderingMessage = true;\n            result.push(new MarkdownHover(this, anchor.range, [{\n                    value: nls.localize('stopped rendering', \"Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.\")\n                }], false, index++));\n        }\n        if (!stopRenderingMessage && typeof maxTokenizationLineLength === 'number' && lineLength >= maxTokenizationLineLength) {\n            result.push(new MarkdownHover(this, anchor.range, [{\n                    value: nls.localize('too many characters', \"Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.\")\n                }], false, index++));\n        }\n        let isBeforeContent = false;\n        for (const d of lineDecorations) {\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            const hoverMessage = d.options.hoverMessage;\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\n                continue;\n            }\n            if (d.options.beforeContentClassName) {\n                isBeforeContent = true;\n            }\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\n            result.push(new MarkdownHover(this, range, asArray(hoverMessage), isBeforeContent, index++));\n        }\n        return result;\n    }\n    computeAsync(anchor, lineDecorations, token) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const model = this._editor.getModel();\n        const hoverProviderRegistry = this._languageFeaturesService.hoverProvider;\n        if (!hoverProviderRegistry.has(model)) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const markdownHovers = this._getMarkdownHovers(hoverProviderRegistry, model, anchor, token);\n        return markdownHovers;\n    }\n    _getMarkdownHovers(hoverProviderRegistry, model, anchor, token) {\n        const position = anchor.range.getStartPosition();\n        const hoverProviderResults = getHoverProviderResultsAsAsyncIterable(hoverProviderRegistry, model, position, token);\n        const markdownHovers = hoverProviderResults.filter(item => !isEmptyMarkdownString(item.hover.contents))\n            .map(item => {\n            const range = item.hover.range ? Range.lift(item.hover.range) : anchor.range;\n            const hoverSource = new HoverSource(item.hover, item.provider, position);\n            return new MarkdownHover(this, range, item.hover.contents, false, item.ordinal, hoverSource);\n        });\n        return markdownHovers;\n    }\n    renderHoverParts(context, hoverParts) {\n        this._renderedHoverParts = new MarkdownRenderedHoverParts(hoverParts, context.fragment, this._editor, this._languageService, this._openerService, this._keybindingService, this._hoverService, this._configurationService, context.onContentsChanged);\n        return this._renderedHoverParts;\n    }\n    updateFocusedMarkdownHoverPartVerbosityLevel(action) {\n        var _a;\n        (_a = this._renderedHoverParts) === null || _a === void 0 ? void 0 : _a.updateFocusedHoverPartVerbosityLevel(action);\n    }\n};\nMarkdownHoverParticipant = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeaturesService),\n    __param(5, IKeybindingService),\n    __param(6, IHoverService)\n], MarkdownHoverParticipant);\nexport { MarkdownHoverParticipant };\nclass MarkdownRenderedHoverParts extends Disposable {\n    constructor(hoverParts, // we own!\n    hoverPartsContainer, _editor, _languageService, _openerService, _keybindingService, _hoverService, _configurationService, _onFinishedRendering) {\n        super();\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this._keybindingService = _keybindingService;\n        this._hoverService = _hoverService;\n        this._configurationService = _configurationService;\n        this._onFinishedRendering = _onFinishedRendering;\n        this._hoverFocusInfo = { hoverPartIndex: -1, focusRemains: false };\n        this._renderedHoverParts = this._renderHoverParts(hoverParts, hoverPartsContainer, this._onFinishedRendering);\n        this._register(toDisposable(() => {\n            this._renderedHoverParts.forEach(renderedHoverPart => {\n                renderedHoverPart.disposables.dispose();\n            });\n        }));\n    }\n    _renderHoverParts(hoverParts, hoverPartsContainer, onFinishedRendering) {\n        hoverParts.sort(compareBy(hover => hover.ordinal, numberComparator));\n        return hoverParts.map((hoverPart, hoverIndex) => {\n            const renderedHoverPart = this._renderHoverPart(hoverIndex, hoverPart.contents, hoverPart.source, onFinishedRendering);\n            hoverPartsContainer.appendChild(renderedHoverPart.renderedMarkdown);\n            return renderedHoverPart;\n        });\n    }\n    _renderHoverPart(hoverPartIndex, hoverContents, hoverSource, onFinishedRendering) {\n        const { renderedMarkdown, disposables } = this._renderMarkdownContent(hoverContents, onFinishedRendering);\n        if (!hoverSource) {\n            return { renderedMarkdown, disposables };\n        }\n        const canIncreaseVerbosity = hoverSource.supportsVerbosityAction(HoverVerbosityAction.Increase);\n        const canDecreaseVerbosity = hoverSource.supportsVerbosityAction(HoverVerbosityAction.Decrease);\n        if (!canIncreaseVerbosity && !canDecreaseVerbosity) {\n            return { renderedMarkdown, disposables, hoverSource };\n        }\n        const actionsContainer = $('div.verbosity-actions');\n        renderedMarkdown.prepend(actionsContainer);\n        disposables.add(this._renderHoverExpansionAction(actionsContainer, HoverVerbosityAction.Increase, canIncreaseVerbosity));\n        disposables.add(this._renderHoverExpansionAction(actionsContainer, HoverVerbosityAction.Decrease, canDecreaseVerbosity));\n        const focusTracker = disposables.add(dom.trackFocus(renderedMarkdown));\n        disposables.add(focusTracker.onDidFocus(() => {\n            this._hoverFocusInfo = {\n                hoverPartIndex,\n                focusRemains: true\n            };\n        }));\n        disposables.add(focusTracker.onDidBlur(() => {\n            var _a;\n            if ((_a = this._hoverFocusInfo) === null || _a === void 0 ? void 0 : _a.focusRemains) {\n                this._hoverFocusInfo.focusRemains = false;\n                return;\n            }\n        }));\n        return { renderedMarkdown, disposables, hoverSource };\n    }\n    _renderMarkdownContent(markdownContent, onFinishedRendering) {\n        const renderedMarkdown = $('div.hover-row');\n        renderedMarkdown.tabIndex = 0;\n        const renderedMarkdownContents = $('div.hover-row-contents');\n        renderedMarkdown.appendChild(renderedMarkdownContents);\n        const disposables = new DisposableStore();\n        disposables.add(renderMarkdownInContainer(this._editor, renderedMarkdownContents, markdownContent, this._languageService, this._openerService, onFinishedRendering));\n        return { renderedMarkdown, disposables };\n    }\n    _renderHoverExpansionAction(container, action, actionEnabled) {\n        const store = new DisposableStore();\n        const isActionIncrease = action === HoverVerbosityAction.Increase;\n        const actionElement = dom.append(container, $(ThemeIcon.asCSSSelector(isActionIncrease ? increaseHoverVerbosityIcon : decreaseHoverVerbosityIcon)));\n        actionElement.tabIndex = 0;\n        const hoverDelegate = new WorkbenchHoverDelegate('mouse', false, { target: container, position: { hoverPosition: 0 /* HoverPosition.LEFT */ } }, this._configurationService, this._hoverService);\n        if (isActionIncrease) {\n            const kb = this._keybindingService.lookupKeybinding(INCREASE_HOVER_VERBOSITY_ACTION_ID);\n            store.add(this._hoverService.setupUpdatableHover(hoverDelegate, actionElement, kb ?\n                nls.localize('increaseVerbosityWithKb', \"Increase Verbosity ({0})\", kb.getLabel()) :\n                nls.localize('increaseVerbosity', \"Increase Verbosity\")));\n        }\n        else {\n            const kb = this._keybindingService.lookupKeybinding(DECREASE_HOVER_VERBOSITY_ACTION_ID);\n            store.add(this._hoverService.setupUpdatableHover(hoverDelegate, actionElement, kb ?\n                nls.localize('decreaseVerbosityWithKb', \"Decrease Verbosity ({0})\", kb.getLabel()) :\n                nls.localize('decreaseVerbosity', \"Decrease Verbosity\")));\n        }\n        if (!actionEnabled) {\n            actionElement.classList.add('disabled');\n            return store;\n        }\n        actionElement.classList.add('enabled');\n        const actionFunction = () => this.updateFocusedHoverPartVerbosityLevel(action);\n        store.add(new ClickAction(actionElement, actionFunction));\n        store.add(new KeyDownAction(actionElement, actionFunction, [3 /* KeyCode.Enter */, 10 /* KeyCode.Space */]));\n        return store;\n    }\n    async updateFocusedHoverPartVerbosityLevel(action) {\n        var _a;\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        const hoverFocusedPartIndex = this._hoverFocusInfo.hoverPartIndex;\n        const hoverRenderedPart = this._getRenderedHoverPartAtIndex(hoverFocusedPartIndex);\n        if (!hoverRenderedPart || !((_a = hoverRenderedPart.hoverSource) === null || _a === void 0 ? void 0 : _a.supportsVerbosityAction(action))) {\n            return;\n        }\n        const hoverPosition = hoverRenderedPart.hoverSource.hoverPosition;\n        const hoverProvider = hoverRenderedPart.hoverSource.hoverProvider;\n        const hover = hoverRenderedPart.hoverSource.hover;\n        const hoverContext = { verbosityRequest: { action, previousHover: hover } };\n        let newHover;\n        try {\n            newHover = await Promise.resolve(hoverProvider.provideHover(model, hoverPosition, CancellationToken.None, hoverContext));\n        }\n        catch (e) {\n            onUnexpectedExternalError(e);\n        }\n        if (!newHover) {\n            return;\n        }\n        const hoverSource = new HoverSource(newHover, hoverProvider, hoverPosition);\n        const renderedHoverPart = this._renderHoverPart(hoverFocusedPartIndex, newHover.contents, hoverSource, this._onFinishedRendering);\n        this._replaceRenderedHoverPartAtIndex(hoverFocusedPartIndex, renderedHoverPart);\n        this._focusOnHoverPartWithIndex(hoverFocusedPartIndex);\n        this._onFinishedRendering();\n    }\n    _replaceRenderedHoverPartAtIndex(index, renderedHoverPart) {\n        if (index >= this._renderHoverParts.length || index < 0) {\n            return;\n        }\n        const currentRenderedHoverPart = this._renderedHoverParts[index];\n        const currentRenderedMarkdown = currentRenderedHoverPart.renderedMarkdown;\n        currentRenderedMarkdown.replaceWith(renderedHoverPart.renderedMarkdown);\n        currentRenderedHoverPart.disposables.dispose();\n        this._renderedHoverParts[index] = renderedHoverPart;\n    }\n    _focusOnHoverPartWithIndex(index) {\n        this._renderedHoverParts[index].renderedMarkdown.focus();\n        this._hoverFocusInfo.focusRemains = true;\n    }\n    _getRenderedHoverPartAtIndex(index) {\n        return this._renderedHoverParts[index];\n    }\n}\nexport function renderMarkdownHovers(context, hoverParts, editor, languageService, openerService) {\n    // Sort hover parts to keep them stable since they might come in async, out-of-order\n    hoverParts.sort(compareBy(hover => hover.ordinal, numberComparator));\n    const disposables = new DisposableStore();\n    for (const hoverPart of hoverParts) {\n        disposables.add(renderMarkdownInContainer(editor, context.fragment, hoverPart.contents, languageService, openerService, context.onContentsChanged));\n    }\n    return disposables;\n}\nfunction renderMarkdownInContainer(editor, container, markdownStrings, languageService, openerService, onFinishedRendering) {\n    const store = new DisposableStore();\n    for (const contents of markdownStrings) {\n        if (isEmptyMarkdownString(contents)) {\n            continue;\n        }\n        const markdownHoverElement = $('div.markdown-hover');\n        const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n        const renderer = store.add(new MarkdownRenderer({ editor }, languageService, openerService));\n        store.add(renderer.onDidRenderAsync(() => {\n            hoverContentsElement.className = 'hover-contents code-hover-contents';\n            onFinishedRendering();\n        }));\n        const renderedContents = store.add(renderer.render(contents));\n        hoverContentsElement.appendChild(renderedContents.element);\n        container.appendChild(markdownHoverElement);\n    }\n    return store;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Selection } from '../../../common/core/selection.js';\nexport class InPlaceReplaceCommand {\n    constructor(editRange, originalSelection, text) {\n        this._editRange = editRange;\n        this._originalSelection = originalSelection;\n        this._text = text;\n    }\n    getEditOperations(model, builder) {\n        builder.addTrackedEditOperation(this._editRange, this._text);\n    }\n    computeCursorState(model, helper) {\n        const inverseEditOperations = helper.getInverseEditOperations();\n        const srcRange = inverseEditOperations[0].range;\n        if (!this._originalSelection.isEmpty()) {\n            // Preserve selection and extends to typed text\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn - this._text.length, srcRange.endLineNumber, srcRange.endColumn);\n        }\n        return new Selection(srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn), srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn));\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InPlaceReplaceController_1;\nimport { createCancelablePromise, timeout } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { EditorState } from '../../editorState/browser/editorState.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport * as nls from '../../../../nls.js';\nimport { InPlaceReplaceCommand } from './inPlaceReplaceCommand.js';\nimport './inPlaceReplace.css';\nlet InPlaceReplaceController = InPlaceReplaceController_1 = class InPlaceReplaceController {\n    static get(editor) {\n        return editor.getContribution(InPlaceReplaceController_1.ID);\n    }\n    constructor(editor, editorWorkerService) {\n        this.editor = editor;\n        this.editorWorkerService = editorWorkerService;\n        this.decorations = this.editor.createDecorationsCollection();\n    }\n    dispose() {\n    }\n    run(source, up) {\n        var _a;\n        // cancel any pending request\n        (_a = this.currentRequest) === null || _a === void 0 ? void 0 : _a.cancel();\n        const editorSelection = this.editor.getSelection();\n        const model = this.editor.getModel();\n        if (!model || !editorSelection) {\n            return undefined;\n        }\n        let selection = editorSelection;\n        if (selection.startLineNumber !== selection.endLineNumber) {\n            // Can't accept multiline selection\n            return undefined;\n        }\n        const state = new EditorState(this.editor, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */);\n        const modelURI = model.uri;\n        if (!this.editorWorkerService.canNavigateValueSet(modelURI)) {\n            return Promise.resolve(undefined);\n        }\n        this.currentRequest = createCancelablePromise(token => this.editorWorkerService.navigateValueSet(modelURI, selection, up));\n        return this.currentRequest.then(result => {\n            var _a;\n            if (!result || !result.range || !result.value) {\n                // No proper result\n                return;\n            }\n            if (!state.validate(this.editor)) {\n                // state has changed\n                return;\n            }\n            // Selection\n            const editRange = Range.lift(result.range);\n            let highlightRange = result.range;\n            const diff = result.value.length - (selection.endColumn - selection.startColumn);\n            // highlight\n            highlightRange = {\n                startLineNumber: highlightRange.startLineNumber,\n                startColumn: highlightRange.startColumn,\n                endLineNumber: highlightRange.endLineNumber,\n                endColumn: highlightRange.startColumn + result.value.length\n            };\n            if (diff > 1) {\n                selection = new Selection(selection.startLineNumber, selection.startColumn, selection.endLineNumber, selection.endColumn + diff - 1);\n            }\n            // Insert new text\n            const command = new InPlaceReplaceCommand(editRange, selection, result.value);\n            this.editor.pushUndoStop();\n            this.editor.executeCommand(source, command);\n            this.editor.pushUndoStop();\n            // add decoration\n            this.decorations.set([{\n                    range: highlightRange,\n                    options: InPlaceReplaceController_1.DECORATION\n                }]);\n            // remove decoration after delay\n            (_a = this.decorationRemover) === null || _a === void 0 ? void 0 : _a.cancel();\n            this.decorationRemover = timeout(350);\n            this.decorationRemover.then(() => this.decorations.clear()).catch(onUnexpectedError);\n        }).catch(onUnexpectedError);\n    }\n};\nInPlaceReplaceController.ID = 'editor.contrib.inPlaceReplaceController';\nInPlaceReplaceController.DECORATION = ModelDecorationOptions.register({\n    description: 'in-place-replace',\n    className: 'valueSetReplacement'\n});\nInPlaceReplaceController = InPlaceReplaceController_1 = __decorate([\n    __param(1, IEditorWorkerService)\n], InPlaceReplaceController);\nclass InPlaceReplaceUp extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inPlaceReplace.up',\n            label: nls.localize('InPlaceReplaceAction.previous.label', \"Replace with Previous Value\"),\n            alias: 'Replace with Previous Value',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 87 /* KeyCode.Comma */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = InPlaceReplaceController.get(editor);\n        if (!controller) {\n            return Promise.resolve(undefined);\n        }\n        return controller.run(this.id, false);\n    }\n}\nclass InPlaceReplaceDown extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inPlaceReplace.down',\n            label: nls.localize('InPlaceReplaceAction.next.label', \"Replace with Next Value\"),\n            alias: 'Replace with Next Value',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 89 /* KeyCode.Period */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = InPlaceReplaceController.get(editor);\n        if (!controller) {\n            return Promise.resolve(undefined);\n        }\n        return controller.run(this.id, true);\n    }\n}\nregisterEditorContribution(InPlaceReplaceController.ID, InPlaceReplaceController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(InPlaceReplaceUp);\nregisterEditorAction(InPlaceReplaceDown);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from '../../../../base/common/strings.js';\nimport { ShiftCommand } from '../../../common/commands/shiftCommand.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { normalizeIndentation } from '../../../common/core/indentation.js';\nimport { Selection } from '../../../common/core/selection.js';\nexport function getReindentEditOperations(model, languageConfigurationService, startLineNumber, endLineNumber, inheritedIndent) {\n    if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n        // Model is empty\n        return [];\n    }\n    const indentationRules = languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).indentationRules;\n    if (!indentationRules) {\n        return [];\n    }\n    endLineNumber = Math.min(endLineNumber, model.getLineCount());\n    // Skip `unIndentedLinePattern` lines\n    while (startLineNumber <= endLineNumber) {\n        if (!indentationRules.unIndentedLinePattern) {\n            break;\n        }\n        const text = model.getLineContent(startLineNumber);\n        if (!indentationRules.unIndentedLinePattern.test(text)) {\n            break;\n        }\n        startLineNumber++;\n    }\n    if (startLineNumber > endLineNumber - 1) {\n        return [];\n    }\n    const { tabSize, indentSize, insertSpaces } = model.getOptions();\n    const shiftIndent = (indentation, count) => {\n        count = count || 1;\n        return ShiftCommand.shiftIndent(indentation, indentation.length + count, tabSize, indentSize, insertSpaces);\n    };\n    const unshiftIndent = (indentation, count) => {\n        count = count || 1;\n        return ShiftCommand.unshiftIndent(indentation, indentation.length + count, tabSize, indentSize, insertSpaces);\n    };\n    const indentEdits = [];\n    // indentation being passed to lines below\n    let globalIndent;\n    // Calculate indentation for the first line\n    // If there is no passed-in indentation, we use the indentation of the first line as base.\n    const currentLineText = model.getLineContent(startLineNumber);\n    let adjustedLineContent = currentLineText;\n    if (inheritedIndent !== undefined && inheritedIndent !== null) {\n        globalIndent = inheritedIndent;\n        const oldIndentation = strings.getLeadingWhitespace(currentLineText);\n        adjustedLineContent = globalIndent + currentLineText.substring(oldIndentation.length);\n        if (indentationRules.decreaseIndentPattern && indentationRules.decreaseIndentPattern.test(adjustedLineContent)) {\n            globalIndent = unshiftIndent(globalIndent);\n            adjustedLineContent = globalIndent + currentLineText.substring(oldIndentation.length);\n        }\n        if (currentLineText !== adjustedLineContent) {\n            indentEdits.push(EditOperation.replaceMove(new Selection(startLineNumber, 1, startLineNumber, oldIndentation.length + 1), normalizeIndentation(globalIndent, indentSize, insertSpaces)));\n        }\n    }\n    else {\n        globalIndent = strings.getLeadingWhitespace(currentLineText);\n    }\n    // idealIndentForNextLine doesn't equal globalIndent when there is a line matching `indentNextLinePattern`.\n    let idealIndentForNextLine = globalIndent;\n    if (indentationRules.increaseIndentPattern && indentationRules.increaseIndentPattern.test(adjustedLineContent)) {\n        idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n        globalIndent = shiftIndent(globalIndent);\n    }\n    else if (indentationRules.indentNextLinePattern && indentationRules.indentNextLinePattern.test(adjustedLineContent)) {\n        idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n    }\n    startLineNumber++;\n    // Calculate indentation adjustment for all following lines\n    for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n        const text = model.getLineContent(lineNumber);\n        const oldIndentation = strings.getLeadingWhitespace(text);\n        const adjustedLineContent = idealIndentForNextLine + text.substring(oldIndentation.length);\n        if (indentationRules.decreaseIndentPattern && indentationRules.decreaseIndentPattern.test(adjustedLineContent)) {\n            idealIndentForNextLine = unshiftIndent(idealIndentForNextLine);\n            globalIndent = unshiftIndent(globalIndent);\n        }\n        if (oldIndentation !== idealIndentForNextLine) {\n            indentEdits.push(EditOperation.replaceMove(new Selection(lineNumber, 1, lineNumber, oldIndentation.length + 1), normalizeIndentation(idealIndentForNextLine, indentSize, insertSpaces)));\n        }\n        // calculate idealIndentForNextLine\n        if (indentationRules.unIndentedLinePattern && indentationRules.unIndentedLinePattern.test(text)) {\n            // In reindent phase, if the line matches `unIndentedLinePattern` we inherit indentation from above lines\n            // but don't change globalIndent and idealIndentForNextLine.\n            continue;\n        }\n        else if (indentationRules.increaseIndentPattern && indentationRules.increaseIndentPattern.test(adjustedLineContent)) {\n            globalIndent = shiftIndent(globalIndent);\n            idealIndentForNextLine = globalIndent;\n        }\n        else if (indentationRules.indentNextLinePattern && indentationRules.indentNextLinePattern.test(adjustedLineContent)) {\n            idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n        }\n        else {\n            idealIndentForNextLine = globalIndent;\n        }\n    }\n    return indentEdits;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ShiftCommand } from '../../../common/commands/shiftCommand.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport * as indentUtils from '../common/indentUtils.js';\nimport * as nls from '../../../../nls.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nimport { getGoodIndentForLine, getIndentMetadata } from '../../../common/languages/autoIndent.js';\nimport { getReindentEditOperations } from '../common/indentation.js';\nexport class IndentationToSpacesAction extends EditorAction {\n    constructor() {\n        super({\n            id: IndentationToSpacesAction.ID,\n            label: nls.localize('indentationToSpaces', \"Convert Indentation to Spaces\"),\n            alias: 'Convert Indentation to Spaces',\n            precondition: EditorContextKeys.writable,\n            metadata: {\n                description: nls.localize2('indentationToSpacesDescription', \"Convert the tab indentation to spaces.\"),\n            }\n        });\n    }\n    run(accessor, editor) {\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const modelOpts = model.getOptions();\n        const selection = editor.getSelection();\n        if (!selection) {\n            return;\n        }\n        const command = new IndentationToSpacesCommand(selection, modelOpts.tabSize);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n        model.updateOptions({\n            insertSpaces: true\n        });\n    }\n}\nIndentationToSpacesAction.ID = 'editor.action.indentationToSpaces';\nexport class IndentationToTabsAction extends EditorAction {\n    constructor() {\n        super({\n            id: IndentationToTabsAction.ID,\n            label: nls.localize('indentationToTabs', \"Convert Indentation to Tabs\"),\n            alias: 'Convert Indentation to Tabs',\n            precondition: EditorContextKeys.writable,\n            metadata: {\n                description: nls.localize2('indentationToTabsDescription', \"Convert the spaces indentation to tabs.\"),\n            }\n        });\n    }\n    run(accessor, editor) {\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const modelOpts = model.getOptions();\n        const selection = editor.getSelection();\n        if (!selection) {\n            return;\n        }\n        const command = new IndentationToTabsCommand(selection, modelOpts.tabSize);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n        model.updateOptions({\n            insertSpaces: false\n        });\n    }\n}\nIndentationToTabsAction.ID = 'editor.action.indentationToTabs';\nexport class ChangeIndentationSizeAction extends EditorAction {\n    constructor(insertSpaces, displaySizeOnly, opts) {\n        super(opts);\n        this.insertSpaces = insertSpaces;\n        this.displaySizeOnly = displaySizeOnly;\n    }\n    run(accessor, editor) {\n        const quickInputService = accessor.get(IQuickInputService);\n        const modelService = accessor.get(IModelService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const creationOpts = modelService.getCreationOptions(model.getLanguageId(), model.uri, model.isForSimpleWidget);\n        const modelOpts = model.getOptions();\n        const picks = [1, 2, 3, 4, 5, 6, 7, 8].map(n => ({\n            id: n.toString(),\n            label: n.toString(),\n            // add description for tabSize value set in the configuration\n            description: (n === creationOpts.tabSize && n === modelOpts.tabSize\n                ? nls.localize('configuredTabSize', \"Configured Tab Size\")\n                : n === creationOpts.tabSize\n                    ? nls.localize('defaultTabSize', \"Default Tab Size\")\n                    : n === modelOpts.tabSize\n                        ? nls.localize('currentTabSize', \"Current Tab Size\")\n                        : undefined)\n        }));\n        // auto focus the tabSize set for the current editor\n        const autoFocusIndex = Math.min(model.getOptions().tabSize - 1, 7);\n        setTimeout(() => {\n            quickInputService.pick(picks, { placeHolder: nls.localize({ key: 'selectTabWidth', comment: ['Tab corresponds to the tab key'] }, \"Select Tab Size for Current File\"), activeItem: picks[autoFocusIndex] }).then(pick => {\n                if (pick) {\n                    if (model && !model.isDisposed()) {\n                        const pickedVal = parseInt(pick.label, 10);\n                        if (this.displaySizeOnly) {\n                            model.updateOptions({\n                                tabSize: pickedVal\n                            });\n                        }\n                        else {\n                            model.updateOptions({\n                                tabSize: pickedVal,\n                                indentSize: pickedVal,\n                                insertSpaces: this.insertSpaces\n                            });\n                        }\n                    }\n                }\n            });\n        }, 50 /* quick input is sensitive to being opened so soon after another */);\n    }\n}\nexport class IndentUsingTabs extends ChangeIndentationSizeAction {\n    constructor() {\n        super(false, false, {\n            id: IndentUsingTabs.ID,\n            label: nls.localize('indentUsingTabs', \"Indent Using Tabs\"),\n            alias: 'Indent Using Tabs',\n            precondition: undefined,\n            metadata: {\n                description: nls.localize2('indentUsingTabsDescription', \"Use indentation with tabs.\"),\n            }\n        });\n    }\n}\nIndentUsingTabs.ID = 'editor.action.indentUsingTabs';\nexport class IndentUsingSpaces extends ChangeIndentationSizeAction {\n    constructor() {\n        super(true, false, {\n            id: IndentUsingSpaces.ID,\n            label: nls.localize('indentUsingSpaces', \"Indent Using Spaces\"),\n            alias: 'Indent Using Spaces',\n            precondition: undefined,\n            metadata: {\n                description: nls.localize2('indentUsingSpacesDescription', \"Use indentation with spaces.\"),\n            }\n        });\n    }\n}\nIndentUsingSpaces.ID = 'editor.action.indentUsingSpaces';\nexport class ChangeTabDisplaySize extends ChangeIndentationSizeAction {\n    constructor() {\n        super(true, true, {\n            id: ChangeTabDisplaySize.ID,\n            label: nls.localize('changeTabDisplaySize', \"Change Tab Display Size\"),\n            alias: 'Change Tab Display Size',\n            precondition: undefined,\n            metadata: {\n                description: nls.localize2('changeTabDisplaySizeDescription', \"Change the space size equivalent of the tab.\"),\n            }\n        });\n    }\n}\nChangeTabDisplaySize.ID = 'editor.action.changeTabDisplaySize';\nexport class DetectIndentation extends EditorAction {\n    constructor() {\n        super({\n            id: DetectIndentation.ID,\n            label: nls.localize('detectIndentation', \"Detect Indentation from Content\"),\n            alias: 'Detect Indentation from Content',\n            precondition: undefined,\n            metadata: {\n                description: nls.localize2('detectIndentationDescription', \"Detect the indentation from content.\"),\n            }\n        });\n    }\n    run(accessor, editor) {\n        const modelService = accessor.get(IModelService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const creationOpts = modelService.getCreationOptions(model.getLanguageId(), model.uri, model.isForSimpleWidget);\n        model.detectIndentation(creationOpts.insertSpaces, creationOpts.tabSize);\n    }\n}\nDetectIndentation.ID = 'editor.action.detectIndentation';\nexport class ReindentLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.reindentlines',\n            label: nls.localize('editor.reindentlines', \"Reindent Lines\"),\n            alias: 'Reindent Lines',\n            precondition: EditorContextKeys.writable,\n            metadata: {\n                description: nls.localize2('editor.reindentlinesDescription', \"Reindent the lines of the editor.\"),\n            }\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const edits = getReindentEditOperations(model, languageConfigurationService, 1, model.getLineCount());\n        if (edits.length > 0) {\n            editor.pushUndoStop();\n            editor.executeEdits(this.id, edits);\n            editor.pushUndoStop();\n        }\n    }\n}\nexport class ReindentSelectedLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.reindentselectedlines',\n            label: nls.localize('editor.reindentselectedlines', \"Reindent Selected Lines\"),\n            alias: 'Reindent Selected Lines',\n            precondition: EditorContextKeys.writable,\n            metadata: {\n                description: nls.localize2('editor.reindentselectedlinesDescription', \"Reindent the selected lines of the editor.\"),\n            }\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        const edits = [];\n        for (const selection of selections) {\n            let startLineNumber = selection.startLineNumber;\n            let endLineNumber = selection.endLineNumber;\n            if (startLineNumber !== endLineNumber && selection.endColumn === 1) {\n                endLineNumber--;\n            }\n            if (startLineNumber === 1) {\n                if (startLineNumber === endLineNumber) {\n                    continue;\n                }\n            }\n            else {\n                startLineNumber--;\n            }\n            const editOperations = getReindentEditOperations(model, languageConfigurationService, startLineNumber, endLineNumber);\n            edits.push(...editOperations);\n        }\n        if (edits.length > 0) {\n            editor.pushUndoStop();\n            editor.executeEdits(this.id, edits);\n            editor.pushUndoStop();\n        }\n    }\n}\nexport class AutoIndentOnPasteCommand {\n    constructor(edits, initialSelection) {\n        this._initialSelection = initialSelection;\n        this._edits = [];\n        this._selectionId = null;\n        for (const edit of edits) {\n            if (edit.range && typeof edit.text === 'string') {\n                this._edits.push(edit);\n            }\n        }\n    }\n    getEditOperations(model, builder) {\n        for (const edit of this._edits) {\n            builder.addEditOperation(Range.lift(edit.range), edit.text);\n        }\n        let selectionIsSet = false;\n        if (Array.isArray(this._edits) && this._edits.length === 1 && this._initialSelection.isEmpty()) {\n            if (this._edits[0].range.startColumn === this._initialSelection.endColumn &&\n                this._edits[0].range.startLineNumber === this._initialSelection.endLineNumber) {\n                selectionIsSet = true;\n                this._selectionId = builder.trackSelection(this._initialSelection, true);\n            }\n            else if (this._edits[0].range.endColumn === this._initialSelection.startColumn &&\n                this._edits[0].range.endLineNumber === this._initialSelection.startLineNumber) {\n                selectionIsSet = true;\n                this._selectionId = builder.trackSelection(this._initialSelection, false);\n            }\n        }\n        if (!selectionIsSet) {\n            this._selectionId = builder.trackSelection(this._initialSelection);\n        }\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this._selectionId);\n    }\n}\nlet AutoIndentOnPaste = class AutoIndentOnPaste {\n    constructor(editor, _languageConfigurationService) {\n        this.editor = editor;\n        this._languageConfigurationService = _languageConfigurationService;\n        this.callOnDispose = new DisposableStore();\n        this.callOnModel = new DisposableStore();\n        this.callOnDispose.add(editor.onDidChangeConfiguration(() => this.update()));\n        this.callOnDispose.add(editor.onDidChangeModel(() => this.update()));\n        this.callOnDispose.add(editor.onDidChangeModelLanguage(() => this.update()));\n    }\n    update() {\n        // clean up\n        this.callOnModel.clear();\n        // we are disabled\n        if (this.editor.getOption(12 /* EditorOption.autoIndent */) < 4 /* EditorAutoIndentStrategy.Full */ || this.editor.getOption(55 /* EditorOption.formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        this.callOnModel.add(this.editor.onDidPaste(({ range }) => {\n            this.trigger(range);\n        }));\n    }\n    trigger(range) {\n        const selections = this.editor.getSelections();\n        if (selections === null || selections.length > 1) {\n            return;\n        }\n        const model = this.editor.getModel();\n        if (!model) {\n            return;\n        }\n        if (!model.tokenization.isCheapToTokenize(range.getStartPosition().lineNumber)) {\n            return;\n        }\n        const autoIndent = this.editor.getOption(12 /* EditorOption.autoIndent */);\n        const { tabSize, indentSize, insertSpaces } = model.getOptions();\n        const textEdits = [];\n        const indentConverter = {\n            shiftIndent: (indentation) => {\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            },\n            unshiftIndent: (indentation) => {\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            }\n        };\n        let startLineNumber = range.startLineNumber;\n        while (startLineNumber <= range.endLineNumber) {\n            if (this.shouldIgnoreLine(model, startLineNumber)) {\n                startLineNumber++;\n                continue;\n            }\n            break;\n        }\n        if (startLineNumber > range.endLineNumber) {\n            return;\n        }\n        let firstLineText = model.getLineContent(startLineNumber);\n        if (!/\\S/.test(firstLineText.substring(0, range.startColumn - 1))) {\n            const indentOfFirstLine = getGoodIndentForLine(autoIndent, model, model.getLanguageId(), startLineNumber, indentConverter, this._languageConfigurationService);\n            if (indentOfFirstLine !== null) {\n                const oldIndentation = strings.getLeadingWhitespace(firstLineText);\n                const newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\n                const oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                if (newSpaceCnt !== oldSpaceCnt) {\n                    const newIndent = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\n                    textEdits.push({\n                        range: new Range(startLineNumber, 1, startLineNumber, oldIndentation.length + 1),\n                        text: newIndent\n                    });\n                    firstLineText = newIndent + firstLineText.substr(oldIndentation.length);\n                }\n                else {\n                    const indentMetadata = getIndentMetadata(model, startLineNumber, this._languageConfigurationService);\n                    if (indentMetadata === 0 || indentMetadata === 8 /* IndentConsts.UNINDENT_MASK */) {\n                        // we paste content into a line where only contains whitespaces\n                        // after pasting, the indentation of the first line is already correct\n                        // the first line doesn't match any indentation rule\n                        // then no-op.\n                        return;\n                    }\n                }\n            }\n        }\n        const firstLineNumber = startLineNumber;\n        // ignore empty or ignored lines\n        while (startLineNumber < range.endLineNumber) {\n            if (!/\\S/.test(model.getLineContent(startLineNumber + 1))) {\n                startLineNumber++;\n                continue;\n            }\n            break;\n        }\n        if (startLineNumber !== range.endLineNumber) {\n            const virtualModel = {\n                tokenization: {\n                    getLineTokens: (lineNumber) => {\n                        return model.tokenization.getLineTokens(lineNumber);\n                    },\n                    getLanguageId: () => {\n                        return model.getLanguageId();\n                    },\n                    getLanguageIdAtPosition: (lineNumber, column) => {\n                        return model.getLanguageIdAtPosition(lineNumber, column);\n                    },\n                },\n                getLineContent: (lineNumber) => {\n                    if (lineNumber === firstLineNumber) {\n                        return firstLineText;\n                    }\n                    else {\n                        return model.getLineContent(lineNumber);\n                    }\n                }\n            };\n            const indentOfSecondLine = getGoodIndentForLine(autoIndent, virtualModel, model.getLanguageId(), startLineNumber + 1, indentConverter, this._languageConfigurationService);\n            if (indentOfSecondLine !== null) {\n                const newSpaceCntOfSecondLine = indentUtils.getSpaceCnt(indentOfSecondLine, tabSize);\n                const oldSpaceCntOfSecondLine = indentUtils.getSpaceCnt(strings.getLeadingWhitespace(model.getLineContent(startLineNumber + 1)), tabSize);\n                if (newSpaceCntOfSecondLine !== oldSpaceCntOfSecondLine) {\n                    const spaceCntOffset = newSpaceCntOfSecondLine - oldSpaceCntOfSecondLine;\n                    for (let i = startLineNumber + 1; i <= range.endLineNumber; i++) {\n                        const lineContent = model.getLineContent(i);\n                        const originalIndent = strings.getLeadingWhitespace(lineContent);\n                        const originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\n                        const newSpacesCnt = originalSpacesCnt + spaceCntOffset;\n                        const newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\n                        if (newIndent !== originalIndent) {\n                            textEdits.push({\n                                range: new Range(i, 1, i, originalIndent.length + 1),\n                                text: newIndent\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        if (textEdits.length > 0) {\n            this.editor.pushUndoStop();\n            const cmd = new AutoIndentOnPasteCommand(textEdits, this.editor.getSelection());\n            this.editor.executeCommand('autoIndentOnPaste', cmd);\n            this.editor.pushUndoStop();\n        }\n    }\n    shouldIgnoreLine(model, lineNumber) {\n        model.tokenization.forceTokenization(lineNumber);\n        const nonWhitespaceColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\n        if (nonWhitespaceColumn === 0) {\n            return true;\n        }\n        const tokens = model.tokenization.getLineTokens(lineNumber);\n        if (tokens.getCount() > 0) {\n            const firstNonWhitespaceTokenIndex = tokens.findTokenIndexAtOffset(nonWhitespaceColumn);\n            if (firstNonWhitespaceTokenIndex >= 0 && tokens.getStandardTokenType(firstNonWhitespaceTokenIndex) === 1 /* StandardTokenType.Comment */) {\n                return true;\n            }\n        }\n        return false;\n    }\n    dispose() {\n        this.callOnDispose.dispose();\n        this.callOnModel.dispose();\n    }\n};\nAutoIndentOnPaste.ID = 'editor.contrib.autoIndentOnPaste';\nAutoIndentOnPaste = __decorate([\n    __param(1, ILanguageConfigurationService)\n], AutoIndentOnPaste);\nexport { AutoIndentOnPaste };\nfunction getIndentationEditOperations(model, builder, tabSize, tabsToSpaces) {\n    if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n        // Model is empty\n        return;\n    }\n    let spaces = '';\n    for (let i = 0; i < tabSize; i++) {\n        spaces += ' ';\n    }\n    const spacesRegExp = new RegExp(spaces, 'gi');\n    for (let lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\n        let lastIndentationColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\n        if (lastIndentationColumn === 0) {\n            lastIndentationColumn = model.getLineMaxColumn(lineNumber);\n        }\n        if (lastIndentationColumn === 1) {\n            continue;\n        }\n        const originalIndentationRange = new Range(lineNumber, 1, lineNumber, lastIndentationColumn);\n        const originalIndentation = model.getValueInRange(originalIndentationRange);\n        const newIndentation = (tabsToSpaces\n            ? originalIndentation.replace(/\\t/ig, spaces)\n            : originalIndentation.replace(spacesRegExp, '\\t'));\n        builder.addEditOperation(originalIndentationRange, newIndentation);\n    }\n}\nexport class IndentationToSpacesCommand {\n    constructor(selection, tabSize) {\n        this.selection = selection;\n        this.tabSize = tabSize;\n        this.selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        this.selectionId = builder.trackSelection(this.selection);\n        getIndentationEditOperations(model, builder, this.tabSize, true);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n}\nexport class IndentationToTabsCommand {\n    constructor(selection, tabSize) {\n        this.selection = selection;\n        this.tabSize = tabSize;\n        this.selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        this.selectionId = builder.trackSelection(this.selection);\n        getIndentationEditOperations(model, builder, this.tabSize, false);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n}\nregisterEditorContribution(AutoIndentOnPaste.ID, AutoIndentOnPaste, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(IndentationToSpacesAction);\nregisterEditorAction(IndentationToTabsAction);\nregisterEditorAction(IndentUsingTabs);\nregisterEditorAction(IndentUsingSpaces);\nregisterEditorAction(ChangeTabDisplaySize);\nregisterEditorAction(DetectIndentation);\nregisterEditorAction(ReindentLinesAction);\nregisterEditorAction(ReindentSelectedLinesAction);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport function getSpaceCnt(str, tabSize) {\n    let spacesCnt = 0;\n    for (let i = 0; i < str.length; i++) {\n        if (str.charAt(i) === '\\t') {\n            spacesCnt += tabSize;\n        }\n        else {\n            spacesCnt++;\n        }\n    }\n    return spacesCnt;\n}\nexport function generateIndent(spacesCnt, tabSize, insertSpaces) {\n    spacesCnt = spacesCnt < 0 ? 0 : spacesCnt;\n    let result = '';\n    if (!insertSpaces) {\n        const tabsCnt = Math.floor(spacesCnt / tabSize);\n        spacesCnt = spacesCnt % tabSize;\n        for (let i = 0; i < tabsCnt; i++) {\n            result += '\\t';\n        }\n    }\n    for (let i = 0; i < spacesCnt; i++) {\n        result += ' ';\n    }\n    return result;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { CancellationError, onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Schemas } from '../../../../base/common/network.js';\nimport { URI } from '../../../../base/common/uri.js';\nexport class InlayHintAnchor {\n    constructor(range, direction) {\n        this.range = range;\n        this.direction = direction;\n    }\n}\nexport class InlayHintItem {\n    constructor(hint, anchor, provider) {\n        this.hint = hint;\n        this.anchor = anchor;\n        this.provider = provider;\n        this._isResolved = false;\n    }\n    with(delta) {\n        const result = new InlayHintItem(this.hint, delta.anchor, this.provider);\n        result._isResolved = this._isResolved;\n        result._currentResolve = this._currentResolve;\n        return result;\n    }\n    async resolve(token) {\n        if (typeof this.provider.resolveInlayHint !== 'function') {\n            return;\n        }\n        if (this._currentResolve) {\n            // wait for an active resolve operation and try again\n            // when that's done.\n            await this._currentResolve;\n            if (token.isCancellationRequested) {\n                return;\n            }\n            return this.resolve(token);\n        }\n        if (!this._isResolved) {\n            this._currentResolve = this._doResolve(token)\n                .finally(() => this._currentResolve = undefined);\n        }\n        await this._currentResolve;\n    }\n    async _doResolve(token) {\n        var _a, _b, _c;\n        try {\n            const newHint = await Promise.resolve(this.provider.resolveInlayHint(this.hint, token));\n            this.hint.tooltip = (_a = newHint === null || newHint === void 0 ? void 0 : newHint.tooltip) !== null && _a !== void 0 ? _a : this.hint.tooltip;\n            this.hint.label = (_b = newHint === null || newHint === void 0 ? void 0 : newHint.label) !== null && _b !== void 0 ? _b : this.hint.label;\n            this.hint.textEdits = (_c = newHint === null || newHint === void 0 ? void 0 : newHint.textEdits) !== null && _c !== void 0 ? _c : this.hint.textEdits;\n            this._isResolved = true;\n        }\n        catch (err) {\n            onUnexpectedExternalError(err);\n            this._isResolved = false;\n        }\n    }\n}\nexport class InlayHintsFragments {\n    static async create(registry, model, ranges, token) {\n        const data = [];\n        const promises = registry.ordered(model).reverse().map(provider => ranges.map(async (range) => {\n            try {\n                const result = await provider.provideInlayHints(model, range, token);\n                if ((result === null || result === void 0 ? void 0 : result.hints.length) || provider.onDidChangeInlayHints) {\n                    data.push([result !== null && result !== void 0 ? result : InlayHintsFragments._emptyInlayHintList, provider]);\n                }\n            }\n            catch (err) {\n                onUnexpectedExternalError(err);\n            }\n        }));\n        await Promise.all(promises.flat());\n        if (token.isCancellationRequested || model.isDisposed()) {\n            throw new CancellationError();\n        }\n        return new InlayHintsFragments(ranges, data, model);\n    }\n    constructor(ranges, data, model) {\n        this._disposables = new DisposableStore();\n        this.ranges = ranges;\n        this.provider = new Set();\n        const items = [];\n        for (const [list, provider] of data) {\n            this._disposables.add(list);\n            this.provider.add(provider);\n            for (const hint of list.hints) {\n                // compute the range to which the item should be attached to\n                const position = model.validatePosition(hint.position);\n                let direction = 'before';\n                const wordRange = InlayHintsFragments._getRangeAtPosition(model, position);\n                let range;\n                if (wordRange.getStartPosition().isBefore(position)) {\n                    range = Range.fromPositions(wordRange.getStartPosition(), position);\n                    direction = 'after';\n                }\n                else {\n                    range = Range.fromPositions(position, wordRange.getEndPosition());\n                    direction = 'before';\n                }\n                items.push(new InlayHintItem(hint, new InlayHintAnchor(range, direction), provider));\n            }\n        }\n        this.items = items.sort((a, b) => Position.compare(a.hint.position, b.hint.position));\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n    static _getRangeAtPosition(model, position) {\n        const line = position.lineNumber;\n        const word = model.getWordAtPosition(position);\n        if (word) {\n            // always prefer the word range\n            return new Range(line, word.startColumn, line, word.endColumn);\n        }\n        model.tokenization.tokenizeIfCheap(line);\n        const tokens = model.tokenization.getLineTokens(line);\n        const offset = position.column - 1;\n        const idx = tokens.findTokenIndexAtOffset(offset);\n        let start = tokens.getStartOffset(idx);\n        let end = tokens.getEndOffset(idx);\n        if (end - start === 1) {\n            // single character token, when at its end try leading/trailing token instead\n            if (start === offset && idx > 1) {\n                // leading token\n                start = tokens.getStartOffset(idx - 1);\n                end = tokens.getEndOffset(idx - 1);\n            }\n            else if (end === offset && idx < tokens.getCount() - 1) {\n                // trailing token\n                start = tokens.getStartOffset(idx + 1);\n                end = tokens.getEndOffset(idx + 1);\n            }\n        }\n        return new Range(line, start + 1, line, end + 1);\n    }\n}\nInlayHintsFragments._emptyInlayHintList = Object.freeze({ dispose() { }, hints: [] });\nexport function asCommandLink(command) {\n    return URI.from({\n        scheme: Schemas.command,\n        path: command.id,\n        query: command.arguments && encodeURIComponent(JSON.stringify(command.arguments))\n    }).toString();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { HoverParticipantRegistry } from '../../hover/browser/hoverTypes.js';\nimport { InlayHintsController } from './inlayHintsController.js';\nimport { InlayHintsHover } from './inlayHintsHover.js';\nregisterEditorContribution(InlayHintsController.ID, InlayHintsController, 1 /* EditorContributionInstantiation.AfterFirstRender */);\nHoverParticipantRegistry.register(InlayHintsHover);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlayHintsController_1;\nimport { ModifierKeyEmitter } from '../../../../base/browser/dom.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { LRUCache } from '../../../../base/common/map.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { DynamicCssRules } from '../../../browser/editorDom.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../../common/config/editorOptions.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport * as languages from '../../../common/languages.js';\nimport { InjectedTextCursorStops } from '../../../common/model.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../common/model/textModel.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { InlayHintAnchor, InlayHintsFragments } from './inlayHints.js';\nimport { goToDefinitionWithLocation, showGoToContextMenu } from './inlayHintsLocations.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator, IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nimport * as colors from '../../../../platform/theme/common/colorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\n// --- hint caching service (per session)\nclass InlayHintsCache {\n    constructor() {\n        this._entries = new LRUCache(50);\n    }\n    get(model) {\n        const key = InlayHintsCache._key(model);\n        return this._entries.get(key);\n    }\n    set(model, value) {\n        const key = InlayHintsCache._key(model);\n        this._entries.set(key, value);\n    }\n    static _key(model) {\n        return `${model.uri.toString()}/${model.getVersionId()}`;\n    }\n}\nconst IInlayHintsCache = createDecorator('IInlayHintsCache');\nregisterSingleton(IInlayHintsCache, InlayHintsCache, 1 /* InstantiationType.Delayed */);\n// --- rendered label\nexport class RenderedInlayHintLabelPart {\n    constructor(item, index) {\n        this.item = item;\n        this.index = index;\n    }\n    get part() {\n        const label = this.item.hint.label;\n        if (typeof label === 'string') {\n            return { label };\n        }\n        else {\n            return label[this.index];\n        }\n    }\n}\nclass ActiveInlayHintInfo {\n    constructor(part, hasTriggerModifier) {\n        this.part = part;\n        this.hasTriggerModifier = hasTriggerModifier;\n    }\n}\n// --- controller\nlet InlayHintsController = InlayHintsController_1 = class InlayHintsController {\n    static get(editor) {\n        var _a;\n        return (_a = editor.getContribution(InlayHintsController_1.ID)) !== null && _a !== void 0 ? _a : undefined;\n    }\n    constructor(_editor, _languageFeaturesService, _featureDebounce, _inlayHintsCache, _commandService, _notificationService, _instaService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._inlayHintsCache = _inlayHintsCache;\n        this._commandService = _commandService;\n        this._notificationService = _notificationService;\n        this._instaService = _instaService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._decorationsMetadata = new Map();\n        this._ruleFactory = new DynamicCssRules(this._editor);\n        this._activeRenderMode = 0 /* RenderMode.Normal */;\n        this._debounceInfo = _featureDebounce.for(_languageFeaturesService.inlayHintsProvider, 'InlayHint', { min: 25 });\n        this._disposables.add(_languageFeaturesService.inlayHintsProvider.onDidChange(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(141 /* EditorOption.inlayHints */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    dispose() {\n        this._sessionDisposables.dispose();\n        this._removeAllDecorations();\n        this._disposables.dispose();\n    }\n    _update() {\n        this._sessionDisposables.clear();\n        this._removeAllDecorations();\n        const options = this._editor.getOption(141 /* EditorOption.inlayHints */);\n        if (options.enabled === 'off') {\n            return;\n        }\n        const model = this._editor.getModel();\n        if (!model || !this._languageFeaturesService.inlayHintsProvider.has(model)) {\n            return;\n        }\n        if (options.enabled === 'on') {\n            // different \"on\" modes: always\n            this._activeRenderMode = 0 /* RenderMode.Normal */;\n        }\n        else {\n            // different \"on\" modes: offUnlessPressed, or onUnlessPressed\n            let defaultMode;\n            let altMode;\n            if (options.enabled === 'onUnlessPressed') {\n                defaultMode = 0 /* RenderMode.Normal */;\n                altMode = 1 /* RenderMode.Invisible */;\n            }\n            else {\n                defaultMode = 1 /* RenderMode.Invisible */;\n                altMode = 0 /* RenderMode.Normal */;\n            }\n            this._activeRenderMode = defaultMode;\n            this._sessionDisposables.add(ModifierKeyEmitter.getInstance().event(e => {\n                if (!this._editor.hasModel()) {\n                    return;\n                }\n                const newRenderMode = e.altKey && e.ctrlKey && !(e.shiftKey || e.metaKey) ? altMode : defaultMode;\n                if (newRenderMode !== this._activeRenderMode) {\n                    this._activeRenderMode = newRenderMode;\n                    const model = this._editor.getModel();\n                    const copies = this._copyInlayHintsWithCurrentAnchor(model);\n                    this._updateHintsDecorators([model.getFullModelRange()], copies);\n                    scheduler.schedule(0);\n                }\n            }));\n        }\n        // iff possible, quickly update from cache\n        const cached = this._inlayHintsCache.get(model);\n        if (cached) {\n            this._updateHintsDecorators([model.getFullModelRange()], cached);\n        }\n        this._sessionDisposables.add(toDisposable(() => {\n            // cache items when switching files etc\n            if (!model.isDisposed()) {\n                this._cacheHintsForFastRestore(model);\n            }\n        }));\n        let cts;\n        const watchedProviders = new Set();\n        const scheduler = new RunOnceScheduler(async () => {\n            const t1 = Date.now();\n            cts === null || cts === void 0 ? void 0 : cts.dispose(true);\n            cts = new CancellationTokenSource();\n            const listener = model.onWillDispose(() => cts === null || cts === void 0 ? void 0 : cts.cancel());\n            try {\n                const myToken = cts.token;\n                const inlayHints = await InlayHintsFragments.create(this._languageFeaturesService.inlayHintsProvider, model, this._getHintsRanges(), myToken);\n                scheduler.delay = this._debounceInfo.update(model, Date.now() - t1);\n                if (myToken.isCancellationRequested) {\n                    inlayHints.dispose();\n                    return;\n                }\n                // listen to provider changes\n                for (const provider of inlayHints.provider) {\n                    if (typeof provider.onDidChangeInlayHints === 'function' && !watchedProviders.has(provider)) {\n                        watchedProviders.add(provider);\n                        this._sessionDisposables.add(provider.onDidChangeInlayHints(() => {\n                            if (!scheduler.isScheduled()) { // ignore event when request is already scheduled\n                                scheduler.schedule();\n                            }\n                        }));\n                    }\n                }\n                this._sessionDisposables.add(inlayHints);\n                this._updateHintsDecorators(inlayHints.ranges, inlayHints.items);\n                this._cacheHintsForFastRestore(model);\n            }\n            catch (err) {\n                onUnexpectedError(err);\n            }\n            finally {\n                cts.dispose();\n                listener.dispose();\n            }\n        }, this._debounceInfo.get(model));\n        this._sessionDisposables.add(scheduler);\n        this._sessionDisposables.add(toDisposable(() => cts === null || cts === void 0 ? void 0 : cts.dispose(true)));\n        scheduler.schedule(0);\n        this._sessionDisposables.add(this._editor.onDidScrollChange((e) => {\n            // update when scroll position changes\n            // uses scrollTopChanged has weak heuristic to differenatiate between scrolling due to\n            // typing or due to \"actual\" scrolling\n            if (e.scrollTopChanged || !scheduler.isScheduled()) {\n                scheduler.schedule();\n            }\n        }));\n        this._sessionDisposables.add(this._editor.onDidChangeModelContent((e) => {\n            cts === null || cts === void 0 ? void 0 : cts.cancel();\n            // update less aggressive when typing\n            const delay = Math.max(scheduler.delay, 1250);\n            scheduler.schedule(delay);\n        }));\n        // mouse gestures\n        this._sessionDisposables.add(this._installDblClickGesture(() => scheduler.schedule(0)));\n        this._sessionDisposables.add(this._installLinkGesture());\n        this._sessionDisposables.add(this._installContextMenu());\n    }\n    _installLinkGesture() {\n        const store = new DisposableStore();\n        const gesture = store.add(new ClickLinkGesture(this._editor));\n        // let removeHighlight = () => { };\n        const sessionStore = new DisposableStore();\n        store.add(sessionStore);\n        store.add(gesture.onMouseMoveOrRelevantKeyDown(e => {\n            const [mouseEvent] = e;\n            const labelPart = this._getInlayHintLabelPart(mouseEvent);\n            const model = this._editor.getModel();\n            if (!labelPart || !model) {\n                sessionStore.clear();\n                return;\n            }\n            // resolve the item\n            const cts = new CancellationTokenSource();\n            sessionStore.add(toDisposable(() => cts.dispose(true)));\n            labelPart.item.resolve(cts.token);\n            // render link => when the modifier is pressed and when there is a command or location\n            this._activeInlayHintPart = labelPart.part.command || labelPart.part.location\n                ? new ActiveInlayHintInfo(labelPart, mouseEvent.hasTriggerModifier)\n                : undefined;\n            const lineNumber = model.validatePosition(labelPart.item.hint.position).lineNumber;\n            const range = new Range(lineNumber, 1, lineNumber, model.getLineMaxColumn(lineNumber));\n            const lineHints = this._getInlineHintsForRange(range);\n            this._updateHintsDecorators([range], lineHints);\n            sessionStore.add(toDisposable(() => {\n                this._activeInlayHintPart = undefined;\n                this._updateHintsDecorators([range], lineHints);\n            }));\n        }));\n        store.add(gesture.onCancel(() => sessionStore.clear()));\n        store.add(gesture.onExecute(async (e) => {\n            const label = this._getInlayHintLabelPart(e);\n            if (label) {\n                const part = label.part;\n                if (part.location) {\n                    // location -> execute go to def\n                    this._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor, part.location);\n                }\n                else if (languages.Command.is(part.command)) {\n                    // command -> execute it\n                    await this._invokeCommand(part.command, label.item);\n                }\n            }\n        }));\n        return store;\n    }\n    _getInlineHintsForRange(range) {\n        const lineHints = new Set();\n        for (const data of this._decorationsMetadata.values()) {\n            if (range.containsRange(data.item.anchor.range)) {\n                lineHints.add(data.item);\n            }\n        }\n        return Array.from(lineHints);\n    }\n    _installDblClickGesture(updateInlayHints) {\n        return this._editor.onMouseUp(async (e) => {\n            if (e.event.detail !== 2) {\n                return;\n            }\n            const part = this._getInlayHintLabelPart(e);\n            if (!part) {\n                return;\n            }\n            e.event.preventDefault();\n            await part.item.resolve(CancellationToken.None);\n            if (isNonEmptyArray(part.item.hint.textEdits)) {\n                const edits = part.item.hint.textEdits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text));\n                this._editor.executeEdits('inlayHint.default', edits);\n                updateInlayHints();\n            }\n        });\n    }\n    _installContextMenu() {\n        return this._editor.onContextMenu(async (e) => {\n            if (!(e.event.target instanceof HTMLElement)) {\n                return;\n            }\n            const part = this._getInlayHintLabelPart(e);\n            if (part) {\n                await this._instaService.invokeFunction(showGoToContextMenu, this._editor, e.event.target, part);\n            }\n        });\n    }\n    _getInlayHintLabelPart(e) {\n        var _a;\n        if (e.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return undefined;\n        }\n        const options = (_a = e.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options;\n        if (options instanceof ModelDecorationInjectedTextOptions && (options === null || options === void 0 ? void 0 : options.attachedData) instanceof RenderedInlayHintLabelPart) {\n            return options.attachedData;\n        }\n        return undefined;\n    }\n    async _invokeCommand(command, item) {\n        var _a;\n        try {\n            await this._commandService.executeCommand(command.id, ...((_a = command.arguments) !== null && _a !== void 0 ? _a : []));\n        }\n        catch (err) {\n            this._notificationService.notify({\n                severity: Severity.Error,\n                source: item.provider.displayName,\n                message: err\n            });\n        }\n    }\n    _cacheHintsForFastRestore(model) {\n        const hints = this._copyInlayHintsWithCurrentAnchor(model);\n        this._inlayHintsCache.set(model, hints);\n    }\n    // return inlay hints but with an anchor that reflects \"updates\"\n    // that happened after receiving them, e.g adding new lines before a hint\n    _copyInlayHintsWithCurrentAnchor(model) {\n        const items = new Map();\n        for (const [id, obj] of this._decorationsMetadata) {\n            if (items.has(obj.item)) {\n                // an inlay item can be rendered as multiple decorations\n                // but they will all uses the same range\n                continue;\n            }\n            const range = model.getDecorationRange(id);\n            if (range) {\n                // update range with whatever the editor has tweaked it to\n                const anchor = new InlayHintAnchor(range, obj.item.anchor.direction);\n                const copy = obj.item.with({ anchor });\n                items.set(obj.item, copy);\n            }\n        }\n        return Array.from(items.values());\n    }\n    _getHintsRanges() {\n        const extra = 30;\n        const model = this._editor.getModel();\n        const visibleRanges = this._editor.getVisibleRangesPlusViewportAboveBelow();\n        const result = [];\n        for (const range of visibleRanges.sort(Range.compareRangesUsingStarts)) {\n            const extendedRange = model.validateRange(new Range(range.startLineNumber - extra, range.startColumn, range.endLineNumber + extra, range.endColumn));\n            if (result.length === 0 || !Range.areIntersectingOrTouching(result[result.length - 1], extendedRange)) {\n                result.push(extendedRange);\n            }\n            else {\n                result[result.length - 1] = Range.plusRange(result[result.length - 1], extendedRange);\n            }\n        }\n        return result;\n    }\n    _updateHintsDecorators(ranges, items) {\n        var _a, _b;\n        // utils to collect/create injected text decorations\n        const newDecorationsData = [];\n        const addInjectedText = (item, ref, content, cursorStops, attachedData) => {\n            const opts = {\n                content,\n                inlineClassNameAffectsLetterSpacing: true,\n                inlineClassName: ref.className,\n                cursorStops,\n                attachedData\n            };\n            newDecorationsData.push({\n                item,\n                classNameRef: ref,\n                decoration: {\n                    range: item.anchor.range,\n                    options: {\n                        // className: \"rangeHighlight\", // DEBUG highlight to see to what range a hint is attached\n                        description: 'InlayHint',\n                        showIfCollapsed: item.anchor.range.isEmpty(), // \"original\" range is empty\n                        collapseOnReplaceEdit: !item.anchor.range.isEmpty(),\n                        stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n                        [item.anchor.direction]: this._activeRenderMode === 0 /* RenderMode.Normal */ ? opts : undefined\n                    }\n                }\n            });\n        };\n        const addInjectedWhitespace = (item, isLast) => {\n            const marginRule = this._ruleFactory.createClassNameRef({\n                width: `${(fontSize / 3) | 0}px`,\n                display: 'inline-block'\n            });\n            addInjectedText(item, marginRule, '\\u200a', isLast ? InjectedTextCursorStops.Right : InjectedTextCursorStops.None);\n        };\n        //\n        const { fontSize, fontFamily, padding, isUniform } = this._getLayoutInfo();\n        const fontFamilyVar = '--code-editorInlayHintsFontFamily';\n        this._editor.getContainerDomNode().style.setProperty(fontFamilyVar, fontFamily);\n        let currentLineInfo = { line: 0, totalLen: 0 };\n        for (const item of items) {\n            if (currentLineInfo.line !== item.anchor.range.startLineNumber) {\n                currentLineInfo = { line: item.anchor.range.startLineNumber, totalLen: 0 };\n            }\n            if (currentLineInfo.totalLen > InlayHintsController_1._MAX_LABEL_LEN) {\n                continue;\n            }\n            // whitespace leading the actual label\n            if (item.hint.paddingLeft) {\n                addInjectedWhitespace(item, false);\n            }\n            // the label with its parts\n            const parts = typeof item.hint.label === 'string'\n                ? [{ label: item.hint.label }]\n                : item.hint.label;\n            for (let i = 0; i < parts.length; i++) {\n                const part = parts[i];\n                const isFirst = i === 0;\n                const isLast = i === parts.length - 1;\n                const cssProperties = {\n                    fontSize: `${fontSize}px`,\n                    fontFamily: `var(${fontFamilyVar}), ${EDITOR_FONT_DEFAULTS.fontFamily}`,\n                    verticalAlign: isUniform ? 'baseline' : 'middle',\n                    unicodeBidi: 'isolate'\n                };\n                if (isNonEmptyArray(item.hint.textEdits)) {\n                    cssProperties.cursor = 'default';\n                }\n                this._fillInColors(cssProperties, item.hint);\n                if ((part.command || part.location) && ((_a = this._activeInlayHintPart) === null || _a === void 0 ? void 0 : _a.part.item) === item && this._activeInlayHintPart.part.index === i) {\n                    // active link!\n                    cssProperties.textDecoration = 'underline';\n                    if (this._activeInlayHintPart.hasTriggerModifier) {\n                        cssProperties.color = themeColorFromId(colors.editorActiveLinkForeground);\n                        cssProperties.cursor = 'pointer';\n                    }\n                }\n                if (padding) {\n                    if (isFirst && isLast) {\n                        // only element\n                        cssProperties.padding = `1px ${Math.max(1, fontSize / 4) | 0}px`;\n                        cssProperties.borderRadius = `${(fontSize / 4) | 0}px`;\n                    }\n                    else if (isFirst) {\n                        // first element\n                        cssProperties.padding = `1px 0 1px ${Math.max(1, fontSize / 4) | 0}px`;\n                        cssProperties.borderRadius = `${(fontSize / 4) | 0}px 0 0 ${(fontSize / 4) | 0}px`;\n                    }\n                    else if (isLast) {\n                        // last element\n                        cssProperties.padding = `1px ${Math.max(1, fontSize / 4) | 0}px 1px 0`;\n                        cssProperties.borderRadius = `0 ${(fontSize / 4) | 0}px ${(fontSize / 4) | 0}px 0`;\n                    }\n                    else {\n                        cssProperties.padding = `1px 0 1px 0`;\n                    }\n                }\n                let textlabel = part.label;\n                currentLineInfo.totalLen += textlabel.length;\n                let tooLong = false;\n                const over = currentLineInfo.totalLen - InlayHintsController_1._MAX_LABEL_LEN;\n                if (over > 0) {\n                    textlabel = textlabel.slice(0, -over) + '';\n                    tooLong = true;\n                }\n                addInjectedText(item, this._ruleFactory.createClassNameRef(cssProperties), fixSpace(textlabel), isLast && !item.hint.paddingRight ? InjectedTextCursorStops.Right : InjectedTextCursorStops.None, new RenderedInlayHintLabelPart(item, i));\n                if (tooLong) {\n                    break;\n                }\n            }\n            // whitespace trailing the actual label\n            if (item.hint.paddingRight) {\n                addInjectedWhitespace(item, true);\n            }\n            if (newDecorationsData.length > InlayHintsController_1._MAX_DECORATORS) {\n                break;\n            }\n        }\n        // collect all decoration ids that are affected by the ranges\n        // and only update those decorations\n        const decorationIdsToReplace = [];\n        for (const [id, metadata] of this._decorationsMetadata) {\n            const range = (_b = this._editor.getModel()) === null || _b === void 0 ? void 0 : _b.getDecorationRange(id);\n            if (range && ranges.some(r => r.containsRange(range))) {\n                decorationIdsToReplace.push(id);\n                metadata.classNameRef.dispose();\n                this._decorationsMetadata.delete(id);\n            }\n        }\n        const scrollState = StableEditorScrollState.capture(this._editor);\n        this._editor.changeDecorations(accessor => {\n            const newDecorationIds = accessor.deltaDecorations(decorationIdsToReplace, newDecorationsData.map(d => d.decoration));\n            for (let i = 0; i < newDecorationIds.length; i++) {\n                const data = newDecorationsData[i];\n                this._decorationsMetadata.set(newDecorationIds[i], data);\n            }\n        });\n        scrollState.restore(this._editor);\n    }\n    _fillInColors(props, hint) {\n        if (hint.kind === languages.InlayHintKind.Parameter) {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintParameterBackground);\n            props.color = themeColorFromId(colors.editorInlayHintParameterForeground);\n        }\n        else if (hint.kind === languages.InlayHintKind.Type) {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintTypeBackground);\n            props.color = themeColorFromId(colors.editorInlayHintTypeForeground);\n        }\n        else {\n            props.backgroundColor = themeColorFromId(colors.editorInlayHintBackground);\n            props.color = themeColorFromId(colors.editorInlayHintForeground);\n        }\n    }\n    _getLayoutInfo() {\n        const options = this._editor.getOption(141 /* EditorOption.inlayHints */);\n        const padding = options.padding;\n        const editorFontSize = this._editor.getOption(52 /* EditorOption.fontSize */);\n        const editorFontFamily = this._editor.getOption(49 /* EditorOption.fontFamily */);\n        let fontSize = options.fontSize;\n        if (!fontSize || fontSize < 5 || fontSize > editorFontSize) {\n            fontSize = editorFontSize;\n        }\n        const fontFamily = options.fontFamily || editorFontFamily;\n        const isUniform = !padding\n            && fontFamily === editorFontFamily\n            && fontSize === editorFontSize;\n        return { fontSize, fontFamily, padding, isUniform };\n    }\n    _removeAllDecorations() {\n        this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));\n        for (const obj of this._decorationsMetadata.values()) {\n            obj.classNameRef.dispose();\n        }\n        this._decorationsMetadata.clear();\n    }\n};\nInlayHintsController.ID = 'editor.contrib.InlayHints';\nInlayHintsController._MAX_DECORATORS = 1500;\nInlayHintsController._MAX_LABEL_LEN = 43;\nInlayHintsController = InlayHintsController_1 = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, ILanguageFeatureDebounceService),\n    __param(3, IInlayHintsCache),\n    __param(4, ICommandService),\n    __param(5, INotificationService),\n    __param(6, IInstantiationService)\n], InlayHintsController);\nexport { InlayHintsController };\n// Prevents the view from potentially visible whitespace\nfunction fixSpace(str) {\n    const noBreakWhitespace = '\\xa0';\n    return str.replace(/[ \\t]/g, noBreakWhitespace);\n}\nCommandsRegistry.registerCommand('_executeInlayHintProvider', async (accessor, ...args) => {\n    const [uri, range] = args;\n    assertType(URI.isUri(uri));\n    assertType(Range.isIRange(range));\n    const { inlayHintsProvider } = accessor.get(ILanguageFeaturesService);\n    const ref = await accessor.get(ITextModelService).createModelReference(uri);\n    try {\n        const model = await InlayHintsFragments.create(inlayHintsProvider, ref.object.textEditorModel, [Range.lift(range)], CancellationToken.None);\n        const result = model.items.map(i => i.hint);\n        setTimeout(() => model.dispose(), 0); // dispose after sending to ext host\n        return result;\n    }\n    finally {\n        ref.dispose();\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { isEmptyMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Position } from '../../../common/core/position.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../common/model/textModel.js';\nimport { HoverForeignElementAnchor } from '../../hover/browser/hoverTypes.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { getHoverProviderResultsAsAsyncIterable } from '../../hover/browser/getHover.js';\nimport { MarkdownHover, MarkdownHoverParticipant } from '../../hover/browser/markdownHoverParticipant.js';\nimport { RenderedInlayHintLabelPart, InlayHintsController } from './inlayHintsController.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { localize } from '../../../../nls.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { asCommandLink } from './inlayHints.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nclass InlayHintsHoverAnchor extends HoverForeignElementAnchor {\n    constructor(part, owner, initialMousePosX, initialMousePosY) {\n        super(10, owner, part.item.anchor.range, initialMousePosX, initialMousePosY, true);\n        this.part = part;\n    }\n}\nlet InlayHintsHover = class InlayHintsHover extends MarkdownHoverParticipant {\n    constructor(editor, languageService, openerService, keybindingService, hoverService, configurationService, _resolverService, languageFeaturesService) {\n        super(editor, languageService, openerService, configurationService, languageFeaturesService, keybindingService, hoverService);\n        this._resolverService = _resolverService;\n        this.hoverOrdinal = 6;\n    }\n    suggestHoverAnchor(mouseEvent) {\n        var _a;\n        const controller = InlayHintsController.get(this._editor);\n        if (!controller) {\n            return null;\n        }\n        if (mouseEvent.target.type !== 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return null;\n        }\n        const options = (_a = mouseEvent.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options;\n        if (!(options instanceof ModelDecorationInjectedTextOptions && options.attachedData instanceof RenderedInlayHintLabelPart)) {\n            return null;\n        }\n        return new InlayHintsHoverAnchor(options.attachedData, this, mouseEvent.event.posx, mouseEvent.event.posy);\n    }\n    computeSync() {\n        return [];\n    }\n    computeAsync(anchor, _lineDecorations, token) {\n        if (!(anchor instanceof InlayHintsHoverAnchor)) {\n            return AsyncIterableObject.EMPTY;\n        }\n        return new AsyncIterableObject(async (executor) => {\n            const { part } = anchor;\n            await part.item.resolve(token);\n            if (token.isCancellationRequested) {\n                return;\n            }\n            // (1) Inlay Tooltip\n            let itemTooltip;\n            if (typeof part.item.hint.tooltip === 'string') {\n                itemTooltip = new MarkdownString().appendText(part.item.hint.tooltip);\n            }\n            else if (part.item.hint.tooltip) {\n                itemTooltip = part.item.hint.tooltip;\n            }\n            if (itemTooltip) {\n                executor.emitOne(new MarkdownHover(this, anchor.range, [itemTooltip], false, 0));\n            }\n            // (1.2) Inlay dbl-click gesture\n            if (isNonEmptyArray(part.item.hint.textEdits)) {\n                executor.emitOne(new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(localize('hint.dbl', \"Double-click to insert\"))], false, 10001));\n            }\n            // (2) Inlay Label Part Tooltip\n            let partTooltip;\n            if (typeof part.part.tooltip === 'string') {\n                partTooltip = new MarkdownString().appendText(part.part.tooltip);\n            }\n            else if (part.part.tooltip) {\n                partTooltip = part.part.tooltip;\n            }\n            if (partTooltip) {\n                executor.emitOne(new MarkdownHover(this, anchor.range, [partTooltip], false, 1));\n            }\n            // (2.2) Inlay Label Part Help Hover\n            if (part.part.location || part.part.command) {\n                let linkHint;\n                const useMetaKey = this._editor.getOption(78 /* EditorOption.multiCursorModifier */) === 'altKey';\n                const kb = useMetaKey\n                    ? platform.isMacintosh\n                        ? localize('links.navigate.kb.meta.mac', \"cmd + click\")\n                        : localize('links.navigate.kb.meta', \"ctrl + click\")\n                    : platform.isMacintosh\n                        ? localize('links.navigate.kb.alt.mac', \"option + click\")\n                        : localize('links.navigate.kb.alt', \"alt + click\");\n                if (part.part.location && part.part.command) {\n                    linkHint = new MarkdownString().appendText(localize('hint.defAndCommand', 'Go to Definition ({0}), right click for more', kb));\n                }\n                else if (part.part.location) {\n                    linkHint = new MarkdownString().appendText(localize('hint.def', 'Go to Definition ({0})', kb));\n                }\n                else if (part.part.command) {\n                    linkHint = new MarkdownString(`[${localize('hint.cmd', \"Execute Command\")}](${asCommandLink(part.part.command)} \"${part.part.command.title}\") (${kb})`, { isTrusted: true });\n                }\n                if (linkHint) {\n                    executor.emitOne(new MarkdownHover(this, anchor.range, [linkHint], false, 10000));\n                }\n            }\n            // (3) Inlay Label Part Location tooltip\n            const iterable = await this._resolveInlayHintLabelPartHover(part, token);\n            for await (const item of iterable) {\n                executor.emitOne(item);\n            }\n        });\n    }\n    async _resolveInlayHintLabelPartHover(part, token) {\n        if (!part.part.location) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const { uri, range } = part.part.location;\n        const ref = await this._resolverService.createModelReference(uri);\n        try {\n            const model = ref.object.textEditorModel;\n            if (!this._languageFeaturesService.hoverProvider.has(model)) {\n                return AsyncIterableObject.EMPTY;\n            }\n            return getHoverProviderResultsAsAsyncIterable(this._languageFeaturesService.hoverProvider, model, new Position(range.startLineNumber, range.startColumn), token)\n                .filter(item => !isEmptyMarkdownString(item.hover.contents))\n                .map(item => new MarkdownHover(this, part.item.anchor.range, item.hover.contents, false, 2 + item.ordinal));\n        }\n        finally {\n            ref.dispose();\n        }\n    }\n};\nInlayHintsHover = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService),\n    __param(3, IKeybindingService),\n    __param(4, IHoverService),\n    __param(5, IConfigurationService),\n    __param(6, ITextModelService),\n    __param(7, ILanguageFeaturesService)\n], InlayHintsHover);\nexport { InlayHintsHover };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { Action, Separator } from '../../../../base/common/actions.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { DefinitionAction, SymbolNavigationAction, SymbolNavigationAnchor } from '../../gotoSymbol/browser/goToCommands.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport { isIMenuItem, MenuId, MenuItemAction, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService, Severity } from '../../../../platform/notification/common/notification.js';\nexport async function showGoToContextMenu(accessor, editor, anchor, part) {\n    var _a;\n    const resolverService = accessor.get(ITextModelService);\n    const contextMenuService = accessor.get(IContextMenuService);\n    const commandService = accessor.get(ICommandService);\n    const instaService = accessor.get(IInstantiationService);\n    const notificationService = accessor.get(INotificationService);\n    await part.item.resolve(CancellationToken.None);\n    if (!part.part.location) {\n        return;\n    }\n    const location = part.part.location;\n    const menuActions = [];\n    // from all registered (not active) context menu actions select those\n    // that are a symbol navigation actions\n    const filter = new Set(MenuRegistry.getMenuItems(MenuId.EditorContext)\n        .map(item => isIMenuItem(item) ? item.command.id : generateUuid()));\n    for (const delegate of SymbolNavigationAction.all()) {\n        if (filter.has(delegate.desc.id)) {\n            menuActions.push(new Action(delegate.desc.id, MenuItemAction.label(delegate.desc, { renderShortTitle: true }), undefined, true, async () => {\n                const ref = await resolverService.createModelReference(location.uri);\n                try {\n                    const symbolAnchor = new SymbolNavigationAnchor(ref.object.textEditorModel, Range.getStartPosition(location.range));\n                    const range = part.item.anchor.range;\n                    await instaService.invokeFunction(delegate.runEditorCommand.bind(delegate), editor, symbolAnchor, range);\n                }\n                finally {\n                    ref.dispose();\n                }\n            }));\n        }\n    }\n    if (part.part.command) {\n        const { command } = part.part;\n        menuActions.push(new Separator());\n        menuActions.push(new Action(command.id, command.title, undefined, true, async () => {\n            var _a;\n            try {\n                await commandService.executeCommand(command.id, ...((_a = command.arguments) !== null && _a !== void 0 ? _a : []));\n            }\n            catch (err) {\n                notificationService.notify({\n                    severity: Severity.Error,\n                    source: part.item.provider.displayName,\n                    message: err\n                });\n            }\n        }));\n    }\n    // show context menu\n    const useShadowDOM = editor.getOption(127 /* EditorOption.useShadowDOM */);\n    contextMenuService.showContextMenu({\n        domForShadowRoot: useShadowDOM ? (_a = editor.getDomNode()) !== null && _a !== void 0 ? _a : undefined : undefined,\n        getAnchor: () => {\n            const box = dom.getDomNodePagePosition(anchor);\n            return { x: box.left, y: box.top + box.height + 8 };\n        },\n        getActions: () => menuActions,\n        onHide: () => {\n            editor.focus();\n        },\n        autoSelectFirstItem: true,\n    });\n}\nexport async function goToDefinitionWithLocation(accessor, event, editor, location) {\n    const resolverService = accessor.get(ITextModelService);\n    const ref = await resolverService.createModelReference(location.uri);\n    await editor.invokeWithinContext(async (accessor) => {\n        const openToSide = event.hasSideBySideModifier;\n        const contextKeyService = accessor.get(IContextKeyService);\n        const isInPeek = PeekContext.inPeekEditor.getValue(contextKeyService);\n        const canPeek = !openToSide && editor.getOption(88 /* EditorOption.definitionLinkOpensInPeek */) && !isInPeek;\n        const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { title: { value: '', original: '' }, id: '', precondition: undefined });\n        return action.run(accessor, new SymbolNavigationAnchor(ref.object.textEditorModel, Range.getStartPosition(location.range)), Range.lift(location.range));\n    });\n    ref.dispose();\n}\n"],"names":["EditorFontZoomIn","EditorAction","constructor","super","id","label","nls","alias","precondition","undefined","run","accessor","editor","EditorZoom","setZoomLevel","getZoomLevel","EditorFontZoomOut","EditorFontZoomReset","registerEditorAction","getRealAndSyntheticDocumentFormattersOrdered","documentFormattingEditProvider","documentRangeFormattingEditProvider","model","result","seen","ExtensionIdentifierSet","docFormatter","ordered","formatter","push","extensionId","add","rangeFormatter","has","displayName","provideDocumentFormattingEdits","options","token","provideDocumentRangeFormattingEdits","getFullModelRange","FormattingConflicts","setFormatterSelector","selector","dispose","_selectors","unshift","select","document","mode","kind","length","Iterable","first","async","formatDocumentRangesWithSelectedProvider","editorOrModel","rangeOrRanges","progress","userGesture","instaService","get","IInstantiationService","documentRangeFormattingEditProviderRegistry","ILanguageFeaturesService","isCodeEditor","getModel","provider","selected","report","invokeFunction","formatDocumentRangesWithProvider","_a","_b","workerService","IEditorWorkerService","logService","ILogService","accessibilitySignalService","IAccessibilitySignalService","cts","EditorStateCancellationTokenSource","TextModelCancellationTokenSource","ranges","len","range","asArray","sort","Range","compareRangesUsingStarts","areIntersectingOrTouching","fromPositions","getStartPosition","getEndPosition","computeEdits","trace","value","getFormattingOptions","hasIntersectingEdit","a","b","mergedA","reduce","acc","val","plusRange","some","x","intersectRanges","edit","otherEdit","allEdits","rawEditsList","provideDocumentRangesFormattingEdits","isCancellationRequested","i","j","mergedRange","edits","splice","rawEdits","minimalEdits","computeMoreMinimalEdits","uri","FormattingEdit","execute","revealPositionInCenterIfOutsideViewport","getPosition","initialSelection","Selection","startLineNumber","startColumn","endLineNumber","endColumn","pushEditOperations","map","text","lift","forceMoveMarkers","undoEdits","playSignal","AccessibilitySignal","format","formatDocumentWithSelectedProvider","languageFeaturesService","formatDocumentWithProvider","getOnTypeFormattingEdits","position","ch","providers","onTypeFormattingEditProvider","autoFormatTriggerCharacters","indexOf","Promise","resolve","provideOnTypeFormattingEdits","catch","onUnexpectedExternalError","then","LinkedList","CommandsRegistry","registerCommand","_len","arguments","args","Array","_key","resource","assertType","URI","isUri","isIRange","resolverService","ITextModelService","reference","createModelReference","isNonEmptyArray","getDocumentRangeFormattingEditsUntilResult","object","textEditorModel","CancellationToken","None","_len2","_key2","getDocumentFormattingEditsUntilResult","_len3","_key3","Position","isIPosition","__decorate","decorators","target","key","desc","d","c","r","Object","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","FormatOnType","_editor","_languageFeaturesService","_workerService","_accessibilitySignalService","this","_disposables","DisposableStore","_sessionDisposables","onDidChange","_update","onDidChangeModel","onDidChangeModelLanguage","onDidChangeConfiguration","e","hasChanged","clear","getOption","hasModel","support","triggerChars","CharacterSet","charCodeAt","onDidType","lastCharCode","_trigger","String","fromCharCode","getSelections","getSelection","isEmpty","CancellationTokenSource","unbind","onDidChangeModelContent","isFlush","cancel","changes","lineNumber","finally","ID","FormatOnPaste","_instantiationService","_callOnDispose","_callOnModel","onDidPaste","_ref","Progress","onUnexpectedError","FormatDocumentAction","ContextKeyExpr","and","EditorContextKeys","notInCompositeEditor","writable","hasDocumentFormattingProvider","kbOpts","kbExpr","editorTextFocus","primary","linux","weight","contextMenuOpts","group","order","progressService","IEditorProgressService","showWhile","FormatSelectionAction","hasDocumentSelectionFormattingProvider","KeyChord","when","hasNonEmptySelection","getLineMaxColumn","registerEditorContribution","ICodeEditorService","getFocusedCodeEditor","commandService","ICommandService","executeCommand","_handleEolEdits","newEol","singleEdits","eol","pushEOL","_isFullModelReplaceEdit","editRange","validateRange","equalsRange","_edits","addUndoStops","pushUndoStop","scrollState","StableEditorScrollState","capture","executeEdits","EditOperation","replace","replaceMove","restoreRelativeVerticalPositionOfCursor","MarkerCoordinate","marker","index","total","MarkerList","resourceFilter","_markerService","_configService","_onDidChange","Emitter","event","_dispoables","_markers","_nextIdx","_resourceFilter","toString","compareOrder","getValue","compareMarker","res","compare","MarkerSeverity","severity","updateMarker","read","severities","Error","Warning","Info","filter","m","onMarkerChanged","uris","fire","matches","_initIdx","fwd","found","idx","findIndex","binarySearch","word","getWordAtPosition","containsPosition","isBeforeOrEqual","resetIndex","move","oldIdx","find","IMarkerService","IConfigurationService","IMarkerNavigationService","createDecorator","MarkerNavigationService","_provider","getMarkerList","registerSingleton","MarkerNavigationWidget_1","MessageWidget","parent","onRelatedInformation","_openerService","_labelService","_lines","_longestLineLength","_relatedDiagnostics","WeakMap","domNode","createElement","className","_messageBlock","classList","setAttribute","appendChild","_relatedBlock","dom","preventDefault","related","_scrollable","ScrollableElement","horizontal","vertical","useShadows","horizontalScrollbarSize","verticalScrollbarSize","getDomNode","onScroll","style","left","concat","scrollLeft","top","scrollTop","update","source","message","relatedInformation","code","sourceAndCodeLength","lines","splitLines","line","Math","max","getAriaLabel","applyFontInfo","lastLineElement","innerText","height","lineHeight","detailsElement","sourceElement","codeElement","_codeLink","$","onclick","open","allowCommands","stopPropagation","relatedInformationNode","paddingTop","floor","container","relatedResource","getUriBasenameLabel","title","getUriLabel","set","relatedMessage","fontInfo","scrollWidth","ceil","typicalFullwidthCharacterWidth","scrollHeight","setScrollDimensions","layout","width","getHeightInLines","min","severityLabel","Hint","ariaLabel","getLineCount","lineContent","getLineContent","MarkerNavigationWidget","PeekViewWidget","_themeService","_menuService","instantiationService","_contextKeyService","showArrow","showFrame","isAccessible","frameWidth","_onDidSelectRelatedInformation","onDidSelectRelatedInformation","_severity","_backgroundColor","Color","white","_applyTheme","getColorTheme","onDidColorThemeChange","bind","create","theme","getColor","editorMarkerNavigationBackground","colorId","editorMarkerNavigationError","headerBackground","editorMarkerNavigationErrorHeader","editorMarkerNavigationWarning","editorMarkerNavigationWarningHeader","editorMarkerNavigationInfo","editorMarkerNavigationInfoHeader","frameColor","headerBg","arrowColor","headerBackgroundColor","primaryHeadingColor","peekViewTitleForeground","secondaryHeadingColor","peekViewTitleInfoForeground","_applyStyles","_parentContainer","backgroundColor","_fillHead","_actionbarWidget","actionRunner","onWillRun","focus","actions","menu","createMenu","TitleMenu","createAndFillInActionBarActions","icon","_fillTitleIcon","_icon","_fillBody","tabIndex","_container","_message","show","showAtMarker","markerIdx","markerCount","remove","editorPosition","computeRequiredHeight","detail","setTitle","basename","SeverityIcon","toSeverity","revealPositionNearTop","showStale","_relayout","_doLayoutBody","heightInPixel","widthInPixel","_heightInPixel","_onWidth","MenuId","IThemeService","IOpenerService","IMenuService","IContextKeyService","ILabelService","errorDefault","oneOf","editorErrorForeground","editorErrorBorder","warningDefault","editorWarningForeground","editorWarningBorder","infoDefault","editorInfoForeground","editorInfoBorder","registerColor","dark","light","hcDark","contrastBorder","hcLight","transparent","editorBackground","MarkerController_1","MarkerController","getContribution","_markerNavigationService","_editorService","_sessionDispoables","_widgetVisible","CONTEXT_MARKERS_NAVIGATION_VISIBLE","bindTo","_cleanUp","reset","_widget","_model","_getOrCreateModel","reusePosition","createInstance","onDidClose","close","onDidChangeCursorPosition","_c","info","openCodeEditor","pinned","revealIfOpened","selection","collapseToStart","focusEditor","nagivate","next","multiFile","otherEditor","selectionRevealType","MarkerNavigationAction","_next","_multiFile","opts","_accessor","NextMarkerAction","LABEL","menuOpts","menuId","registerIcon","Codicon","arrowDown","PrevMarkerAction","arrowUp","MenubarGoMenu","comment","RawContextKey","MarkerCommand","EditorCommand","bindToContribution","registerEditorCommand","handler","secondary","ctxHasSymbols","localize","ISymbolNavigationService","SymbolNavigationService","contextKeyService","_notificationService","_keybindingService","_currentModel","_currentIdx","_ignoreEditorChange","_ctxHasSymbols","_currentState","_currentMessage","put","anchor","refModel","references","_showMessage","editorState","EditorState","listener","_","getActiveCodeEditor","seenUri","seenPosition","isEqual","combinedDisposable","revealNext","kb","lookupKeybinding","getLabel","status","INotificationService","IKeybindingService","runEditorCommand","KeybindingsRegistry","registerCommandAndKeybindingRule","editorService","_listener","Map","onCodeEditorRemove","_onDidRemoveEditor","onCodeEditorAdd","_onDidAddEditor","listCodeEditors","forEach","values","delete","_d","_e","_f","_g","_h","MenuRegistry","appendMenuItem","EditorContext","submenu","EditorContextPeek","SymbolNavigationAnchor","is","thing","corePosition","SymbolNavigationAction","EditorAction2","all","_allSymbolNavigationCommands","_patchConfig","f1","item","wrap","configuration","arg","notificationService","symbolNavService","promise","raceCancellation","_getLocationModel","_j","altAction","alert","ariaMessage","referenceAt","altActionId","_getAlternativeCommand","_activeAlternativeCommands","referenceCount","muteMessage","MessageController","showMessage","_getNoResultFoundMessage","_onResult","err","error","gotoLocation","_getGoToPreference","EmbeddedCodeEditorWidget","openInPeek","firstReference","peek","targetEditor","_openReference","openToSide","_openInPeek","sideBySide","highlight","isLocationLink","targetSelectionRange","selectionSource","modelNow","decorations","createDecorationsCollection","description","setTimeout","controller","ReferencesController","toggleWidget","createCancelablePromise","Set","DefinitionAction","ReferencesModel","getDefinitionsAtPosition","definitionProvider","alternativeDefinitionCommand","multipleDefinitions","registerAction2","mnemonicTitle","hasDefinitionProvider","keybinding","IsWebContext","registerCommandAlias","isInEmbeddedEditor","toNegated","PeekContext","notInPeekEditor","DeclarationAction","getDeclarationsAtPosition","declarationProvider","alternativeDeclarationCommand","multipleDeclarations","hasDeclarationProvider","TypeDefinitionAction","getTypeDefinitionsAtPosition","typeDefinitionProvider","alternativeTypeDefinitionCommand","multipleTypeDefinitions","hasTypeDefinitionProvider","ImplementationAction","getImplementationsAtPosition","implementationProvider","alternativeImplementationCommand","multipleImplementations","hasImplementationProvider","ReferencesAction","alternativeReferenceCommand","multipleReferences","hasReferenceProvider","getReferencesAtPosition","referenceProvider","GenericGoToLocationAction","config","_references","_gotoMultipleBehaviour","_position","_token","metadata","name","constraint","multiple","noResultsMessage","isArray","setPosition","invokeWithinContext","command","Boolean","codeEditorService","control","column","getLocationLinks","registry","provide","promises","coalesce","flat","provideDefinition","provideDeclaration","provideImplementation","provideTypeDefinition","compact","provideReferences","includeDeclaration","resultWithoutDeclaration","_sortedAndDeduped","callback","rawLinks","modelLinks","ref","link","registerModelAndPositionCommand","hasModifier","modifier","ClickLinkMouseEvent","isLeftClick","leftButton","isMiddleClick","middleButton","isRightClick","rightButton","hasTriggerModifier","triggerModifier","hasSideBySideModifier","triggerSideBySideModifier","isNoneOrSingleMouseDown","ClickLinkKeyboardEvent","keyCodeIsTriggerKey","keyCode","triggerKey","keyCodeIsSideBySideKey","triggerSideBySideKey","ClickLinkOptions","equals","other","createOptions","multiCursorModifier","platform","ClickLinkGesture","Disposable","_onMouseMoveOrRelevantKeyDown","_register","onMouseMoveOrRelevantKeyDown","_onExecute","onExecute","_onCancel","onCancel","_extractLineNumberFromMouseEvent","extractLineNumberFromMouseEvent","_opts","_lastMouseMoveEvent","_hasTriggerKeyOnMouseDown","_lineNumberOnMouseDown","newOpts","onMouseMove","_onEditorMouseMove","onMouseDown","_onEditorMouseDown","onMouseUp","_onEditorMouseUp","onKeyDown","_onEditorKeyDown","onKeyUp","_onEditorKeyUp","onMouseDrag","_resetHandler","onDidChangeCursorSelection","_onDidChangeCursorSelection","onDidScrollChange","scrollTopChanged","scrollLeftChanged","mouseEvent","currentLineNumber","GotoDefinitionAtPositionEditorContribution_1","GotoDefinitionAtPositionEditorContribution","textModelResolverService","languageService","toUnhook","toUnhookForKeyboard","currentWordAtPosition","previousPromise","linkDecorations","linkGesture","keyboardEvent","startFindDefinitionFromMouse","isEnabled","gotoDefinition","removeLinkDecorations","startFindDefinitionFromCursor","startFindDefinition","withKey","type","state","results","findDefinition","validate","linkRange","originSelectionRange","combinedRange","addDecoration","MarkdownString","appendText","previewValue","getPreviewValue","languageId","guessLanguageIdByFilepathOrFirstLine","appendCodeblock","rangeToUse","MAX_SOURCE_PREVIEW_LINES","getPreviewRangeBasedOnIndentation","stripIndentationFromPreviewRange","previewRange","minIndent","getLineFirstNonWhitespaceColumn","endIndent","getValueInRange","RegExp","trim","startIndent","maxLineNumber","hoverMessage","newDecorations","inlineClassName","injectedText","ModelDecorationInjectedTextOptions","canPeek","isInPeekEditor","original","inPeekEditor","ILanguageService","FileReferencesRenderer_1","DataSource","_resolverService","hasChildren","element","FileReferences","getChildren","groups","children","Delegate","getHeight","getTemplateId","FileReferencesRenderer","OneReferenceRenderer","StringRepresentationProvider","getKeyboardNavigationLabel","OneReference","parts","getPreview","preview","IdentityProvider","getId","FileReferencesTemplate","file","IconLabel","supportHighlights","badge","CountBadge","defaultCountBadgeStyles","dirname","setLabel","relative","setCount","setTitleFormat","templateId","renderTemplate","renderElement","node","template","createMatches","filterData","disposeTemplate","templateData","OneReferenceTemplate","HighlightedLabel","score","FuzzyScore","isDefault","toggle","AccessibilityProvider","getWidgetAriaLabel","DecorationsManager","_decorations","_decorationIgnoreSet","_callOnModelChange","_onModelChanged","removeDecorations","_addDecorations","onDidChangeDecorations","_onDecorationChanged","newDecorationsActualIndex","oneReference","DecorationOptions","changeDecorations","changeAccessor","deltaDecorations","toRemove","decorationId","newRange","getDecorationRange","ignore","spansMultipleLines","keys","ModelDecorationOptions","register","stickiness","LayoutData","ratio","heightInLines","fromJSON","raw","data","JSON","parse","ReferencesTree","WorkbenchAsyncDataTree","ReferenceWidget","peekView","_defaultTreeKeyboardSupport","layoutData","themeService","_textModelResolverService","_peekViewService","_uriLabel","_undoRedoService","_languageService","_languageConfigurationService","isResizeable","supportOnTitleClick","_disposeOnNewModel","_onDidSelectReference","onDidSelectReference","_dim","addExclusiveWidget","setModel","_preview","_previewNotAvailableMessage","_tree","_previewModelReference","_splitView","borderColor","where","focusOnReferenceTree","domFocus","focusOnPreviewEditor","isPreviewEditorFocused","hasTextFocus","_onTitleClick","_getFocusedReference","ctrlKey","metaKey","altKey","containerElement","setCssClass","_messageContainer","SplitView","orientation","_previewContainer","scrollBeyondLastLine","scrollbar","verticalHasArrows","horizontalHasArrows","alwaysConsumeMouseWheel","overviewRulerLanes","fixedOverflowWidgets","minimap","enabled","TextModel","PLAINTEXT_LANGUAGE_ID","DEFAULT_CREATION_OPTIONS","_treeContainer","treeOptions","keyboardSupport","accessibilityProvider","keyboardNavigationLabelProvider","identityProvider","openOnSingleClick","selectionNavigation","overrideStyles","listBackground","dispatchEvent","addView","Event","minimumSize","maximumSize","Number","MAX_VALUE","Sizing","Distribute","onDidSashChange","getViewSize","onEvent","_revealReference","onDidOpen","editorOptions","_viewZone","resizeView","setSelection","setFocus","newModel","_onNewModel","_decorationsManager","onDidChangeReferenceRange","rerender","setInput","getFocus","revealReference","revealParent","_revealedReference","scheme","Schemas","inMemory","basenameOrAuthority","getInput","reveal","expand","scrollType","sel","revealRangeInCenter","IUndoRedoService","ILanguageConfigurationService","ReferencesController_1","ctxReferenceSearchVisible","_storageService","_configurationService","_requestIdPool","_ignoreModelChangeEvent","_referenceSearchVisible","modelPromise","peekMode","widgetPosition","closeWidget","_peekMode","storageKey","store","stringify","openReference","_gotoReference","requestId","setMetaTitle","pos","nearestReference","changeFocusBetweenPreviewAndReferences","goToNextOrPreviousReference","currentPosition","nextOrPreviousReference","editorFocus","previewEditorFocus","hide","openedEditor","clone","withController","fn","outerEditor","getOuterEditor","IStorageService","or","registerKeybindingRule","not","InputFocusedContext","negate","mac","WorkbenchListFocusContextKey","WorkbenchTreeElementCanCollapse","WorkbenchTreeElementCanExpand","IListService","lastFocusedList","isProviderFirst","_rangeCallback","defaultGenerator","nextId","_range","FilePreview","_modelReference","n","getWordUntilPosition","beforeRange","afterRange","before","inside","start","end","_previews","ResourceMap","child","fsPath","size","links","_onDidChangeReferenceRange","_links","_title","providersFirst","current","_compareReferences","extUri","oneRef","childCount","groupCount","nearest","prefixLen","strings","offsetDist","abs","EditorHoverStatusBar","hasContent","_hasContent","hoverElement","actionsElement","addAction","actionOptions","commandId","keybindingLabel","HoverAction","render","append","HoverProviderResult","hover","ordinal","getHoverProviderResultsAsAsyncIterable","provideHover","hasRange","hasHtmlContent","contents","isValid","executeProvider","AsyncIterableObject","fromPromises","toPromise","getHoversPromise","hoverProvider","SHOW_OR_FOCUS_HOVER_ACTION_ID","SHOW_DEFINITION_PREVIEW_HOVER_ACTION_ID","SCROLL_UP_HOVER_ACTION_ID","SCROLL_DOWN_HOVER_ACTION_ID","SCROLL_LEFT_HOVER_ACTION_ID","SCROLL_RIGHT_HOVER_ACTION_ID","PAGE_UP_HOVER_ACTION_ID","PAGE_DOWN_HOVER_ACTION_ID","GO_TO_TOP_HOVER_ACTION_ID","GO_TO_BOTTOM_HOVER_ACTION_ID","INCREASE_HOVER_VERBOSITY_ACTION_ID","DECREASE_HOVER_VERBOSITY_ACTION_ID","HoverFocusBehavior","ShowOrFocusHoverAction","schema","properties","enum","NoAutoFocus","FocusIfVisible","AutoFocusImmediately","enumDescriptions","default","HoverController","focusArgument","focusOption","includes","showContentHover","accessibilitySupportEnabled","isHoverVisible","ShowDefinitionPreviewHoverAction","goto","ScrollUpHoverAction","hoverFocused","scrollUp","ScrollDownHoverAction","scrollDown","ScrollLeftHoverAction","ScrollRightHoverAction","scrollRight","PageUpHoverAction","pageUp","PageDownHoverAction","pageDown","GoToTopHoverAction","goToTop","GoToBottomHoverAction","goToBottom","IncreaseHoverVerbosityLevel","updateFocusedMarkdownHoverVerbosityLevel","HoverVerbosityAction","Increase","DecreaseHoverVerbosityLevel","Decrease","MarkerHover","owner","isValidForHoverAnchor","markerCodeActionTrigger","include","CodeActionKind","QuickFix","triggerAction","CodeActionTriggerSource","QuickFixHover","MarkerHoverParticipant","_markerDecorationsService","hoverOrdinal","recentMarkerCodeActionsInfo","computeSync","lineDecorations","supportsMarkerHover","maxColumn","getMarker","renderHoverParts","context","hoverParts","disposables","msg","fragment","renderMarkerHover","markerHoverForStatusbar","renderMarkerStatusbar","markerHover","markerElement","messageElement","whiteSpace","sourceAndCodeElement","codeLink","opacity","paddingLeft","relatedInfoContainer","marginTop","cursor","fromUserGesture","markerController","statusBar","quickfixPlaceholderElement","IMarkerData","makeKey","hasCodeActions","textContent","updatePlaceholderDisposable","disposableTimeout","codeActionsPromise","getCodeActions","toDisposable","validActions","display","showing","quickFixCommandId","CodeActionController","elementPosition","showCodeActions","y","cancellationToken","codeActionProvider","IMarkerDecorationsService","HoverParticipantRegistry","MarkdownHoverParticipant","registerThemingParticipant","collector","hoverBorder","editorHoverBorder","addRule","ResizableContentWidget","allowEditorOverflow","suppressMouseDown","_resizableNode","ResizableHTMLElement","_contentPosition","_isResizing","minSize","enableSashes","onDidResize","_resize","dimension","done","onDidWillResize","isResizing","_availableVerticalSpaceAbove","editorDomNode","mouseBox","getScrolledVisiblePosition","_availableVerticalSpaceBelow","editorBox","bodyBox","ownerDocument","body","mouseBottom","_findPositionPreference","widgetHeight","showAtPosition","maxHeightBelow","Infinity","maxHeightAbove","maxHeight","renderingAbove","above","ContentHoverWidget_1","ContentHoverWidget","isColorPickerVisible","_visibleData","colorPicker","isVisibleFromKeyboard","isVisible","_hoverVisibleKey","isFocused","_hoverFocusedKey","_accessibilityService","minimumHeight","_hover","HoverWidget","_minimumSize","hoverVisible","containerDomNode","zIndex","onDidLayoutChange","_updateMaxDimensions","_updateFont","focusTracker","onDidFocus","onDidBlur","_setHoverData","addContentWidget","removeContentWidget","_applyDimensions","transformedWidth","transformedHeight","_setContentsDomNodeDimensions","contentsDomNode","_setContainerDomNodeDimensions","_setHoverWidgetDimensions","_layoutContentWidget","_applyMaxDimensions","maxWidth","_setHoverWidgetMaxDimensions","setProperty","_setAdjustedHoverWidgetDimensions","_updateResizableNodeMaxDimensions","maxRenderingWidth","_findMaximumRenderingWidth","maxRenderingHeight","_findMaximumRenderingHeight","maxSize","_lastDimensions","scanDomNode","layoutContentWidget","_findAvailableSpaceVertically","_positionPreference","availableSpace","maximumHeight","from","hoverPart","clientHeight","_isHoverTextOverflowing","overflowing","clientWidth","removeProperty","initialWidth","_contentWidth","isMouseGettingCloser","posx","posy","initialMousePosX","initialMousePosY","widgetRect","closestMouseDistance","computeDistanceFromPointToRectangle","distance","hoverData","fontSize","prototype","slice","call","getElementsByClassName","_updateContent","paddingBottom","onContentsChanged","getLayoutInfo","_render","secondaryPosition","showAtSecondaryPosition","positionAffinity","isBeforeContent","preference","showAt","stoleFocus","accessibleViewHint","activeElement","getHoverAccessibleViewHint","isScreenReaderOptimized","clearSashHoverState","_removeConstraintsRenderNormally","layoutInfo","setMinimumDimensions","dimensions","_updateMinimumWidth","getScrollPosition","setScrollPosition","getScrollDimensions","pointX","pointY","dx","dy","sqrt","IAccessibilityService","HoverResult","isComplete","hasLoadingMessage","HoverOperation","_computer","onResult","_firstWaitScheduler","RunOnceScheduler","_triggerAsyncComputation","_secondWaitScheduler","_triggerSyncComputation","_loadingMessageScheduler","_triggerLoadingMessage","_state","_asyncIterable","_asyncIterableDone","_result","_hoverTime","delay","_firstWaitTime","_secondWaitTime","_loadingMessageTime","_setState","fireResult","_fireResult","schedule","computeAsync","createCancelableAsyncIterable","ContentHoverComputer","_anchor","shouldFocus","_shouldFocus","_source","insistOnKeepingHoverVisible","_insistOnKeepingHoverVisible","_participants","_getLineDecorations","getLineDecorations","isWholeLine","showIfCollapsed","EMPTY","merge","participant","messages","filteredMessages","FilteredHoverResult","ContentHoverVisibleData","preferAbove","ContentHoverController_1","ContentHoverController","_currentResult","getAll","participantInstance","InlayHintsHover","_markdownHoverParticipant","p1","p2","_hoverOperation","_addLoadingMessage","_withResult","TokenizationRegistry","_setCurrentResult","_startShowingOrUpdateHover","_startHoverOperationIfNecessary","sticky","canAdoptVisibleHover","hoverResult","_renderMessages","createLoadingMessage","loadingMessage","highlightRange","computeHoverRanges","createDocumentFragment","setColorPicker","widget","hasChildNodes","highlightDecoration","_DECORATION_OPTIONS","anchorRange","startColumnBoundary","viewModel","_getViewModel","coordinatesConverter","anchorViewRange","convertModelRangeToViewRange","anchorViewRangeStart","getLineMinColumn","convertViewPositionToModelPosition","anchorLineNumber","renderStartColumn","forceShowAtRange","showsOrWillShow","anchorCandidates","suggestHoverAnchor","HoverRangeAnchor","epsilon","typicalHalfwidthCharacterWidth","isAfterLines","horizontalDistanceToText","priority","startShowingAtRange","action","updateFocusedMarkdownHoverPartVerbosityLevel","containsNode","contains","MarginHoverComputer","_lineNumber","lane","_laneOrLine","GlyphMarginLane","Center","toHoverMessage","isLineHover","glyphMargin","lineNumberHoverMessage","glyphMarginHoverMessage","isEmptyMarkdownString","MarginHoverWidget","openerService","_renderDisposeables","_isVisible","_messages","_markdownRenderer","MarkdownRenderer","onDidChangeModelDecorations","_onModelDecorationsChanged","addOverlayWidget","removeOverlayWidget","glyphMarginLane","_startShowingAt","laneOrLine","markdownHoverElement","hoverContentsElement","renderedContents","_updateContents","_showAt","editorLayout","topForLineNumber","getTopForLineNumber","editorScrollTop","getScrollTop","glyphMarginLeft","glyphMarginWidth","lineNumbersWidth","round","HoverController_1","_listenersStore","_hoverState","mouseDown","activatedByDecoratorClick","_reactToEditorMouseMoveRunner","_reactToEditorMouseMove","_mouseMoveEvent","_hookListeners","_unhookListeners","hoverOpts","_hoverSettings","hidingDelay","_onKeyDown","onMouseLeave","_onEditorMouseLeave","_cancelScheduler","_hideWidgets","_onEditorScrollChanged","_shouldNotHideCurrentHoverWidget","_isMouseOnContentHoverWidget","_isMouseOnMarginHoverWidget","_isContentWidgetResizing","_shouldNotRecomputeCurrentHoverWidget","isHoverSticky","isMouseOnStickyMarginHoverWidget","isMouseOnMarginHoverWidget","isMouseOnStickyContentHoverWidget","isMouseOnContentHoverWidget","_contentWidget","isMouseOnColorPicker","isTextSelectedWithinContentHoverWidget","browserEvent","view","isCollapsed","isScheduled","mouseOnDecorator","decoratorActivatedOn","_tryShowHoverWidget","hoverWidgetType","contentWidget","_getOrCreateContentWidget","glyphWidget","_getOrCreateGlyphWidget","currentWidget","otherWidget","resolvedKeyboardEvent","softDispatch","shouldKeepHoverVisible","InlineSuggestionHintsContentWidget","dropDownVisible","_glyphWidget","activatedByColorDecoratorClick","lastAnchor","HoverForeignElementAnchor","ctor","increaseHoverVerbosityIcon","decreaseHoverVerbosityIcon","MarkdownHover","HoverSource","hoverPosition","supportsVerbosityAction","hoverVerbosityAction","canIncreaseVerbosity","canDecreaseVerbosity","_hoverService","lineLength","getLineLength","getLanguageIdAtPosition","stopRenderingLineAfter","maxTokenizationLineLength","overrideIdentifier","stopRenderingMessage","beforeContentClassName","hoverProviderRegistry","_getMarkdownHovers","hoverSource","_renderedHoverParts","MarkdownRenderedHoverParts","updateFocusedHoverPartVerbosityLevel","IHoverService","hoverPartsContainer","_onFinishedRendering","_hoverFocusInfo","hoverPartIndex","focusRemains","_renderHoverParts","renderedHoverPart","onFinishedRendering","compareBy","numberComparator","hoverIndex","_renderHoverPart","renderedMarkdown","hoverContents","_renderMarkdownContent","actionsContainer","prepend","_renderHoverExpansionAction","markdownContent","renderedMarkdownContents","renderMarkdownInContainer","actionEnabled","isActionIncrease","actionElement","ThemeIcon","asCSSSelector","hoverDelegate","WorkbenchHoverDelegate","setupUpdatableHover","actionFunction","ClickAction","KeyDownAction","hoverFocusedPartIndex","hoverRenderedPart","_getRenderedHoverPartAtIndex","hoverContext","verbosityRequest","previousHover","newHover","_replaceRenderedHoverPartAtIndex","_focusOnHoverPartWithIndex","currentRenderedHoverPart","replaceWith","renderMarkdownHovers","markdownStrings","renderer","onDidRenderAsync","InPlaceReplaceCommand","originalSelection","_editRange","_originalSelection","_text","getEditOperations","builder","addTrackedEditOperation","computeCursorState","helper","srcRange","getInverseEditOperations","positionColumn","InPlaceReplaceController_1","InPlaceReplaceController","editorWorkerService","up","currentRequest","editorSelection","modelURI","canNavigateValueSet","navigateValueSet","diff","DECORATION","decorationRemover","timeout","InPlaceReplaceUp","InPlaceReplaceDown","getReindentEditOperations","languageConfigurationService","inheritedIndent","indentationRules","getLanguageConfiguration","getLanguageId","unIndentedLinePattern","test","tabSize","indentSize","insertSpaces","getOptions","shiftIndent","indentation","count","ShiftCommand","unshiftIndent","indentEdits","globalIndent","currentLineText","adjustedLineContent","oldIndentation","substring","decreaseIndentPattern","normalizeIndentation","idealIndentForNextLine","increaseIndentPattern","indentNextLinePattern","IndentationToSpacesAction","modelOpts","IndentationToSpacesCommand","executeCommands","updateOptions","IndentationToTabsAction","IndentationToTabsCommand","ChangeIndentationSizeAction","displaySizeOnly","quickInputService","IQuickInputService","modelService","IModelService","creationOpts","getCreationOptions","isForSimpleWidget","picks","autoFocusIndex","pick","placeHolder","activeItem","isDisposed","pickedVal","parseInt","IndentUsingTabs","IndentUsingSpaces","ChangeTabDisplaySize","DetectIndentation","detectIndentation","ReindentLinesAction","ReindentSelectedLinesAction","selections","editOperations","AutoIndentOnPasteCommand","_initialSelection","_selectionId","addEditOperation","selectionIsSet","trackSelection","getTrackedSelection","AutoIndentOnPaste","callOnDispose","callOnModel","trigger","tokenization","isCheapToTokenize","autoIndent","textEdits","indentConverter","shouldIgnoreLine","firstLineText","indentOfFirstLine","getGoodIndentForLine","newSpaceCnt","indentUtils","newIndent","substr","indentMetadata","getIndentMetadata","firstLineNumber","virtualModel","getLineTokens","indentOfSecondLine","newSpaceCntOfSecondLine","oldSpaceCntOfSecondLine","spaceCntOffset","originalIndent","newSpacesCnt","cmd","forceTokenization","nonWhitespaceColumn","tokens","getCount","firstNonWhitespaceTokenIndex","findTokenIndexAtOffset","getStandardTokenType","getIndentationEditOperations","tabsToSpaces","spaces","spacesRegExp","lineCount","lastIndentationColumn","originalIndentationRange","originalIndentation","newIndentation","selectionId","getSpaceCnt","str","spacesCnt","charAt","generateIndent","tabsCnt","InlayHintAnchor","direction","InlayHintItem","hint","_isResolved","with","delta","_currentResolve","resolveInlayHint","_doResolve","newHint","tooltip","InlayHintsFragments","reverse","provideInlayHints","hints","onDidChangeInlayHints","_emptyInlayHintList","CancellationError","items","list","validatePosition","wordRange","_getRangeAtPosition","isBefore","tokenizeIfCheap","offset","getStartOffset","getEndOffset","asCommandLink","path","query","encodeURIComponent","freeze","InlayHintsController","InlayHintsController_1","InlayHintsCache","_entries","LRUCache","getVersionId","IInlayHintsCache","RenderedInlayHintLabelPart","part","ActiveInlayHintInfo","_featureDebounce","_inlayHintsCache","_commandService","_instaService","_decorationsMetadata","_ruleFactory","DynamicCssRules","_activeRenderMode","_debounceInfo","for","inlayHintsProvider","_removeAllDecorations","defaultMode","altMode","ModifierKeyEmitter","getInstance","newRenderMode","shiftKey","copies","_copyInlayHintsWithCurrentAnchor","_updateHintsDecorators","scheduler","cached","_cacheHintsForFastRestore","watchedProviders","t1","Date","now","onWillDispose","myToken","inlayHints","_getHintsRanges","_installDblClickGesture","_installLinkGesture","_installContextMenu","gesture","sessionStore","labelPart","_getInlayHintLabelPart","_activeInlayHintPart","location","lineHints","_getInlineHintsForRange","goToDefinitionWithLocation","languages","_invokeCommand","containsRange","updateInlayHints","onContextMenu","HTMLElement","showGoToContextMenu","attachedData","notify","Severity","obj","copy","visibleRanges","getVisibleRangesPlusViewportAboveBelow","extendedRange","newDecorationsData","addInjectedText","content","cursorStops","inlineClassNameAffectsLetterSpacing","classNameRef","decoration","collapseOnReplaceEdit","addInjectedWhitespace","isLast","marginRule","createClassNameRef","InjectedTextCursorStops","Right","fontFamily","padding","isUniform","_getLayoutInfo","fontFamilyVar","getContainerDomNode","currentLineInfo","totalLen","_MAX_LABEL_LEN","isFirst","cssProperties","EDITOR_FONT_DEFAULTS","verticalAlign","unicodeBidi","_fillInColors","textDecoration","color","themeColorFromId","colors","borderRadius","textlabel","tooLong","over","fixSpace","paddingRight","_MAX_DECORATORS","decorationIdsToReplace","newDecorationIds","restore","props","Parameter","Type","editorFontSize","editorFontFamily","ILanguageFeatureDebounceService","InlayHintsHoverAnchor","keybindingService","hoverService","configurationService","_lineDecorations","itemTooltip","partTooltip","executor","emitOne","linkHint","isTrusted","iterable","_resolveInlayHintLabelPartHover","contextMenuService","IContextMenuService","menuActions","getMenuItems","isIMenuItem","generateUuid","delegate","Action","MenuItemAction","renderShortTitle","symbolAnchor","Separator","useShadowDOM","showContextMenu","domForShadowRoot","getAnchor","box","getActions","onHide","autoSelectFirstItem","isInPeek"],"sourceRoot":""}