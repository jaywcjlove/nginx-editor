{"version":3,"file":"static/js/monaco-editor-vendor.de15e873.7b50f459.js","mappings":"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","sources":["../node_modules/monaco-editor/esm/vs/editor/browser/editorBrowser.js","../node_modules/monaco-editor/esm/vs/editor/browser/editorDom.js","../node_modules/monaco-editor/esm/vs/editor/browser/editorExtensions.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/abstractCodeEditorService.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/bulkEditService.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/codeEditorService.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/editorWorkerService.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/markerDecorations.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/openerService.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/webWorker.js","../node_modules/monaco-editor/esm/vs/editor/browser/stableEditorScroll.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as editorCommon from '../common/editorCommon.js';\n/**\n *@internal\n */\nexport function isCodeEditor(thing) {\n    if (thing && typeof thing.getEditorType === 'function') {\n        return thing.getEditorType() === editorCommon.EditorType.ICodeEditor;\n    }\n    else {\n        return false;\n    }\n}\n/**\n *@internal\n */\nexport function isDiffEditor(thing) {\n    if (thing && typeof thing.getEditorType === 'function') {\n        return thing.getEditorType() === editorCommon.EditorType.IDiffEditor;\n    }\n    else {\n        return false;\n    }\n}\n/**\n *@internal\n */\nexport function getCodeEditor(thing) {\n    if (isCodeEditor(thing)) {\n        return thing;\n    }\n    if (isDiffEditor(thing)) {\n        return thing.getModifiedEditor();\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../base/browser/dom.js';\nimport { GlobalPointerMoveMonitor } from '../../base/browser/globalPointerMoveMonitor.js';\nimport { StandardMouseEvent } from '../../base/browser/mouseEvent.js';\nimport { RunOnceScheduler } from '../../base/common/async.js';\nimport { Disposable } from '../../base/common/lifecycle.js';\nimport { asCssVariableName } from '../../platform/theme/common/colorRegistry.js';\n/**\n * Coordinates relative to the whole document (e.g. mouse event's pageX and pageY)\n */\nexport class PageCoordinates {\n    constructor(x, y) {\n        this.x = x;\n        this.y = y;\n        this._pageCoordinatesBrand = undefined;\n    }\n    toClientCoordinates() {\n        return new ClientCoordinates(this.x - dom.StandardWindow.scrollX, this.y - dom.StandardWindow.scrollY);\n    }\n}\n/**\n * Coordinates within the application's client area (i.e. origin is document's scroll position).\n *\n * For example, clicking in the top-left corner of the client area will\n * always result in a mouse event with a client.x value of 0, regardless\n * of whether the page is scrolled horizontally.\n */\nexport class ClientCoordinates {\n    constructor(clientX, clientY) {\n        this.clientX = clientX;\n        this.clientY = clientY;\n        this._clientCoordinatesBrand = undefined;\n    }\n    toPageCoordinates() {\n        return new PageCoordinates(this.clientX + dom.StandardWindow.scrollX, this.clientY + dom.StandardWindow.scrollY);\n    }\n}\n/**\n * The position of the editor in the page.\n */\nexport class EditorPagePosition {\n    constructor(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n        this._editorPagePositionBrand = undefined;\n    }\n}\n/**\n * Coordinates relative to the the (top;left) of the editor that can be used safely with other internal editor metrics.\n * **NOTE**: This position is obtained by taking page coordinates and transforming them relative to the\n * editor's (top;left) position in a way in which scale transformations are taken into account.\n * **NOTE**: These coordinates could be negative if the mouse position is outside the editor.\n */\nexport class CoordinatesRelativeToEditor {\n    constructor(x, y) {\n        this.x = x;\n        this.y = y;\n        this._positionRelativeToEditorBrand = undefined;\n    }\n}\nexport function createEditorPagePosition(editorViewDomNode) {\n    const editorPos = dom.getDomNodePagePosition(editorViewDomNode);\n    return new EditorPagePosition(editorPos.left, editorPos.top, editorPos.width, editorPos.height);\n}\nexport function createCoordinatesRelativeToEditor(editorViewDomNode, editorPagePosition, pos) {\n    // The editor's page position is read from the DOM using getBoundingClientRect().\n    //\n    // getBoundingClientRect() returns the actual dimensions, while offsetWidth and offsetHeight\n    // reflect the unscaled size. We can use this difference to detect a transform:scale()\n    // and we will apply the transformation in inverse to get mouse coordinates that make sense inside the editor.\n    //\n    // This could be expanded to cover rotation as well maybe by walking the DOM up from `editorViewDomNode`\n    // and computing the effective transformation matrix using getComputedStyle(element).transform.\n    //\n    const scaleX = editorPagePosition.width / editorViewDomNode.offsetWidth;\n    const scaleY = editorPagePosition.height / editorViewDomNode.offsetHeight;\n    // Adjust mouse offsets if editor appears to be scaled via transforms\n    const relativeX = (pos.x - editorPagePosition.x) / scaleX;\n    const relativeY = (pos.y - editorPagePosition.y) / scaleY;\n    return new CoordinatesRelativeToEditor(relativeX, relativeY);\n}\nexport class EditorMouseEvent extends StandardMouseEvent {\n    constructor(e, isFromPointerCapture, editorViewDomNode) {\n        super(e);\n        this._editorMouseEventBrand = undefined;\n        this.isFromPointerCapture = isFromPointerCapture;\n        this.pos = new PageCoordinates(this.posx, this.posy);\n        this.editorPos = createEditorPagePosition(editorViewDomNode);\n        this.relativePos = createCoordinatesRelativeToEditor(editorViewDomNode, this.editorPos, this.pos);\n    }\n}\nexport class EditorMouseEventFactory {\n    constructor(editorViewDomNode) {\n        this._editorViewDomNode = editorViewDomNode;\n    }\n    _create(e) {\n        return new EditorMouseEvent(e, false, this._editorViewDomNode);\n    }\n    onContextMenu(target, callback) {\n        return dom.addDisposableListener(target, 'contextmenu', (e) => {\n            callback(this._create(e));\n        });\n    }\n    onMouseUp(target, callback) {\n        return dom.addDisposableListener(target, 'mouseup', (e) => {\n            callback(this._create(e));\n        });\n    }\n    onMouseDown(target, callback) {\n        return dom.addDisposableListener(target, dom.EventType.MOUSE_DOWN, (e) => {\n            callback(this._create(e));\n        });\n    }\n    onPointerDown(target, callback) {\n        return dom.addDisposableListener(target, dom.EventType.POINTER_DOWN, (e) => {\n            callback(this._create(e), e.pointerId);\n        });\n    }\n    onMouseLeave(target, callback) {\n        return dom.addDisposableListener(target, dom.EventType.MOUSE_LEAVE, (e) => {\n            callback(this._create(e));\n        });\n    }\n    onMouseMove(target, callback) {\n        return dom.addDisposableListener(target, 'mousemove', (e) => callback(this._create(e)));\n    }\n}\nexport class EditorPointerEventFactory {\n    constructor(editorViewDomNode) {\n        this._editorViewDomNode = editorViewDomNode;\n    }\n    _create(e) {\n        return new EditorMouseEvent(e, false, this._editorViewDomNode);\n    }\n    onPointerUp(target, callback) {\n        return dom.addDisposableListener(target, 'pointerup', (e) => {\n            callback(this._create(e));\n        });\n    }\n    onPointerDown(target, callback) {\n        return dom.addDisposableListener(target, dom.EventType.POINTER_DOWN, (e) => {\n            callback(this._create(e), e.pointerId);\n        });\n    }\n    onPointerLeave(target, callback) {\n        return dom.addDisposableListener(target, dom.EventType.POINTER_LEAVE, (e) => {\n            callback(this._create(e));\n        });\n    }\n    onPointerMove(target, callback) {\n        return dom.addDisposableListener(target, 'pointermove', (e) => callback(this._create(e)));\n    }\n}\nexport class GlobalEditorPointerMoveMonitor extends Disposable {\n    constructor(editorViewDomNode) {\n        super();\n        this._editorViewDomNode = editorViewDomNode;\n        this._globalPointerMoveMonitor = this._register(new GlobalPointerMoveMonitor());\n        this._keydownListener = null;\n    }\n    startMonitoring(initialElement, pointerId, initialButtons, pointerMoveCallback, onStopCallback) {\n        // Add a <<capture>> keydown event listener that will cancel the monitoring\n        // if something other than a modifier key is pressed\n        this._keydownListener = dom.addStandardDisposableListener(document, 'keydown', (e) => {\n            const kb = e.toKeybinding();\n            if (kb.isModifierKey()) {\n                // Allow modifier keys\n                return;\n            }\n            this._globalPointerMoveMonitor.stopMonitoring(true, e.browserEvent);\n        }, true);\n        this._globalPointerMoveMonitor.startMonitoring(initialElement, pointerId, initialButtons, (e) => {\n            pointerMoveCallback(new EditorMouseEvent(e, true, this._editorViewDomNode));\n        }, (e) => {\n            this._keydownListener.dispose();\n            onStopCallback(e);\n        });\n    }\n    stopMonitoring() {\n        this._globalPointerMoveMonitor.stopMonitoring(true);\n    }\n}\n/**\n * A helper to create dynamic css rules, bound to a class name.\n * Rules are reused.\n * Reference counting and delayed garbage collection ensure that no rules leak.\n*/\nexport class DynamicCssRules {\n    constructor(_editor) {\n        this._editor = _editor;\n        this._instanceId = ++DynamicCssRules._idPool;\n        this._counter = 0;\n        this._rules = new Map();\n        // We delay garbage collection so that hanging rules can be reused.\n        this._garbageCollectionScheduler = new RunOnceScheduler(() => this.garbageCollect(), 1000);\n    }\n    createClassNameRef(options) {\n        const rule = this.getOrCreateRule(options);\n        rule.increaseRefCount();\n        return {\n            className: rule.className,\n            dispose: () => {\n                rule.decreaseRefCount();\n                this._garbageCollectionScheduler.schedule();\n            }\n        };\n    }\n    getOrCreateRule(properties) {\n        const key = this.computeUniqueKey(properties);\n        let existingRule = this._rules.get(key);\n        if (!existingRule) {\n            const counter = this._counter++;\n            existingRule = new RefCountedCssRule(key, `dyn-rule-${this._instanceId}-${counter}`, dom.isInShadowDOM(this._editor.getContainerDomNode())\n                ? this._editor.getContainerDomNode()\n                : undefined, properties);\n            this._rules.set(key, existingRule);\n        }\n        return existingRule;\n    }\n    computeUniqueKey(properties) {\n        return JSON.stringify(properties);\n    }\n    garbageCollect() {\n        for (const rule of this._rules.values()) {\n            if (!rule.hasReferences()) {\n                this._rules.delete(rule.key);\n                rule.dispose();\n            }\n        }\n    }\n}\nDynamicCssRules._idPool = 0;\nclass RefCountedCssRule {\n    constructor(key, className, _containerElement, properties) {\n        this.key = key;\n        this.className = className;\n        this.properties = properties;\n        this._referenceCount = 0;\n        this._styleElement = dom.createStyleSheet(_containerElement);\n        this._styleElement.textContent = this.getCssText(this.className, this.properties);\n    }\n    getCssText(className, properties) {\n        let str = `.${className} {`;\n        for (const prop in properties) {\n            const value = properties[prop];\n            let cssValue;\n            if (typeof value === 'object') {\n                cssValue = `var(${asCssVariableName(value.id)})`;\n            }\n            else {\n                cssValue = value;\n            }\n            const cssPropName = camelToDashes(prop);\n            str += `\\n\\t${cssPropName}: ${cssValue};`;\n        }\n        str += `\\n}`;\n        return str;\n    }\n    dispose() {\n        this._styleElement.remove();\n    }\n    increaseRefCount() {\n        this._referenceCount++;\n    }\n    decreaseRefCount() {\n        this._referenceCount--;\n    }\n    hasReferences() {\n        return this._referenceCount > 0;\n    }\n}\nfunction camelToDashes(str) {\n    return str.replace(/(^[A-Z])/, ([first]) => first.toLowerCase())\n        .replace(/([A-Z])/g, ([letter]) => `-${letter.toLowerCase()}`);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as nls from '../../nls.js';\nimport { URI } from '../../base/common/uri.js';\nimport { ICodeEditorService } from './services/codeEditorService.js';\nimport { Position } from '../common/core/position.js';\nimport { IModelService } from '../common/services/model.js';\nimport { ITextModelService } from '../common/services/resolverService.js';\nimport { MenuId, MenuRegistry } from '../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../platform/commands/common/commands.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../platform/instantiation/common/instantiation.js';\nimport { KeybindingsRegistry } from '../../platform/keybinding/common/keybindingsRegistry.js';\nimport { Registry } from '../../platform/registry/common/platform.js';\nimport { ITelemetryService } from '../../platform/telemetry/common/telemetry.js';\nimport { withNullAsUndefined, assertType } from '../../base/common/types.js';\nimport { ILogService } from '../../platform/log/common/log.js';\nexport class Command {\n    constructor(opts) {\n        this.id = opts.id;\n        this.precondition = opts.precondition;\n        this._kbOpts = opts.kbOpts;\n        this._menuOpts = opts.menuOpts;\n        this._description = opts.description;\n    }\n    register() {\n        if (Array.isArray(this._menuOpts)) {\n            this._menuOpts.forEach(this._registerMenuItem, this);\n        }\n        else if (this._menuOpts) {\n            this._registerMenuItem(this._menuOpts);\n        }\n        if (this._kbOpts) {\n            const kbOptsArr = Array.isArray(this._kbOpts) ? this._kbOpts : [this._kbOpts];\n            for (const kbOpts of kbOptsArr) {\n                let kbWhen = kbOpts.kbExpr;\n                if (this.precondition) {\n                    if (kbWhen) {\n                        kbWhen = ContextKeyExpr.and(kbWhen, this.precondition);\n                    }\n                    else {\n                        kbWhen = this.precondition;\n                    }\n                }\n                const desc = {\n                    id: this.id,\n                    weight: kbOpts.weight,\n                    args: kbOpts.args,\n                    when: kbWhen,\n                    primary: kbOpts.primary,\n                    secondary: kbOpts.secondary,\n                    win: kbOpts.win,\n                    linux: kbOpts.linux,\n                    mac: kbOpts.mac,\n                };\n                KeybindingsRegistry.registerKeybindingRule(desc);\n            }\n        }\n        CommandsRegistry.registerCommand({\n            id: this.id,\n            handler: (accessor, args) => this.runCommand(accessor, args),\n            description: this._description\n        });\n    }\n    _registerMenuItem(item) {\n        MenuRegistry.appendMenuItem(item.menuId, {\n            group: item.group,\n            command: {\n                id: this.id,\n                title: item.title,\n                icon: item.icon,\n                precondition: this.precondition\n            },\n            when: item.when,\n            order: item.order\n        });\n    }\n}\nexport class MultiCommand extends Command {\n    constructor() {\n        super(...arguments);\n        this._implementations = [];\n    }\n    /**\n     * A higher priority gets to be looked at first\n     */\n    addImplementation(priority, name, implementation) {\n        this._implementations.push({ priority, name, implementation });\n        this._implementations.sort((a, b) => b.priority - a.priority);\n        return {\n            dispose: () => {\n                for (let i = 0; i < this._implementations.length; i++) {\n                    if (this._implementations[i].implementation === implementation) {\n                        this._implementations.splice(i, 1);\n                        return;\n                    }\n                }\n            }\n        };\n    }\n    runCommand(accessor, args) {\n        const logService = accessor.get(ILogService);\n        logService.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);\n        for (const impl of this._implementations) {\n            const result = impl.implementation(accessor, args);\n            if (result) {\n                logService.trace(`Command '${this.id}' was handled by '${impl.name}'.`);\n                if (typeof result === 'boolean') {\n                    return;\n                }\n                return result;\n            }\n        }\n        logService.trace(`The Command '${this.id}' was not handled by any implementation.`);\n    }\n}\n//#endregion\n/**\n * A command that delegates to another command's implementation.\n *\n * This lets different commands be registered but share the same implementation\n */\nexport class ProxyCommand extends Command {\n    constructor(command, opts) {\n        super(opts);\n        this.command = command;\n    }\n    runCommand(accessor, args) {\n        return this.command.runCommand(accessor, args);\n    }\n}\nexport class EditorCommand extends Command {\n    /**\n     * Create a command class that is bound to a certain editor contribution.\n     */\n    static bindToContribution(controllerGetter) {\n        return class EditorControllerCommandImpl extends EditorCommand {\n            constructor(opts) {\n                super(opts);\n                this._callback = opts.handler;\n            }\n            runEditorCommand(accessor, editor, args) {\n                const controller = controllerGetter(editor);\n                if (controller) {\n                    this._callback(controller, args);\n                }\n            }\n        };\n    }\n    static runEditorCommand(accessor, args, precondition, runner) {\n        const codeEditorService = accessor.get(ICodeEditorService);\n        // Find the editor with text focus or active\n        const editor = codeEditorService.getFocusedCodeEditor() || codeEditorService.getActiveCodeEditor();\n        if (!editor) {\n            // well, at least we tried...\n            return;\n        }\n        return editor.invokeWithinContext((editorAccessor) => {\n            const kbService = editorAccessor.get(IContextKeyService);\n            if (!kbService.contextMatchesRules(withNullAsUndefined(precondition))) {\n                // precondition does not hold\n                return;\n            }\n            return runner(editorAccessor, editor, args);\n        });\n    }\n    runCommand(accessor, args) {\n        return EditorCommand.runEditorCommand(accessor, args, this.precondition, (accessor, editor, args) => this.runEditorCommand(accessor, editor, args));\n    }\n}\nexport class EditorAction extends EditorCommand {\n    constructor(opts) {\n        super(EditorAction.convertOptions(opts));\n        this.label = opts.label;\n        this.alias = opts.alias;\n    }\n    static convertOptions(opts) {\n        let menuOpts;\n        if (Array.isArray(opts.menuOpts)) {\n            menuOpts = opts.menuOpts;\n        }\n        else if (opts.menuOpts) {\n            menuOpts = [opts.menuOpts];\n        }\n        else {\n            menuOpts = [];\n        }\n        function withDefaults(item) {\n            if (!item.menuId) {\n                item.menuId = MenuId.EditorContext;\n            }\n            if (!item.title) {\n                item.title = opts.label;\n            }\n            item.when = ContextKeyExpr.and(opts.precondition, item.when);\n            return item;\n        }\n        if (Array.isArray(opts.contextMenuOpts)) {\n            menuOpts.push(...opts.contextMenuOpts.map(withDefaults));\n        }\n        else if (opts.contextMenuOpts) {\n            menuOpts.push(withDefaults(opts.contextMenuOpts));\n        }\n        opts.menuOpts = menuOpts;\n        return opts;\n    }\n    runEditorCommand(accessor, editor, args) {\n        this.reportTelemetry(accessor, editor);\n        return this.run(accessor, editor, args || {});\n    }\n    reportTelemetry(accessor, editor) {\n        accessor.get(ITelemetryService).publicLog2('editorActionInvoked', { name: this.label, id: this.id });\n    }\n}\nexport class MultiEditorAction extends EditorAction {\n    constructor() {\n        super(...arguments);\n        this._implementations = [];\n    }\n    /**\n     * A higher priority gets to be looked at first\n     */\n    addImplementation(priority, implementation) {\n        this._implementations.push([priority, implementation]);\n        this._implementations.sort((a, b) => b[0] - a[0]);\n        return {\n            dispose: () => {\n                for (let i = 0; i < this._implementations.length; i++) {\n                    if (this._implementations[i][1] === implementation) {\n                        this._implementations.splice(i, 1);\n                        return;\n                    }\n                }\n            }\n        };\n    }\n    run(accessor, editor, args) {\n        for (const impl of this._implementations) {\n            const result = impl[1](accessor, editor, args);\n            if (result) {\n                if (typeof result === 'boolean') {\n                    return;\n                }\n                return result;\n            }\n        }\n    }\n}\n//#endregion\n// --- Registration of commands and actions\nexport function registerModelAndPositionCommand(id, handler) {\n    CommandsRegistry.registerCommand(id, function (accessor, ...args) {\n        const instaService = accessor.get(IInstantiationService);\n        const [resource, position] = args;\n        assertType(URI.isUri(resource));\n        assertType(Position.isIPosition(position));\n        const model = accessor.get(IModelService).getModel(resource);\n        if (model) {\n            const editorPosition = Position.lift(position);\n            return instaService.invokeFunction(handler, model, editorPosition, ...args.slice(2));\n        }\n        return accessor.get(ITextModelService).createModelReference(resource).then(reference => {\n            return new Promise((resolve, reject) => {\n                try {\n                    const result = instaService.invokeFunction(handler, reference.object.textEditorModel, Position.lift(position), args.slice(2));\n                    resolve(result);\n                }\n                catch (err) {\n                    reject(err);\n                }\n            }).finally(() => {\n                reference.dispose();\n            });\n        });\n    });\n}\nexport function registerEditorCommand(editorCommand) {\n    EditorContributionRegistry.INSTANCE.registerEditorCommand(editorCommand);\n    return editorCommand;\n}\nexport function registerEditorAction(ctor) {\n    const action = new ctor();\n    EditorContributionRegistry.INSTANCE.registerEditorAction(action);\n    return action;\n}\nexport function registerMultiEditorAction(action) {\n    EditorContributionRegistry.INSTANCE.registerEditorAction(action);\n    return action;\n}\nexport function registerInstantiatedEditorAction(editorAction) {\n    EditorContributionRegistry.INSTANCE.registerEditorAction(editorAction);\n}\nexport function registerEditorContribution(id, ctor) {\n    EditorContributionRegistry.INSTANCE.registerEditorContribution(id, ctor);\n}\nexport var EditorExtensionsRegistry;\n(function (EditorExtensionsRegistry) {\n    function getEditorCommand(commandId) {\n        return EditorContributionRegistry.INSTANCE.getEditorCommand(commandId);\n    }\n    EditorExtensionsRegistry.getEditorCommand = getEditorCommand;\n    function getEditorActions() {\n        return EditorContributionRegistry.INSTANCE.getEditorActions();\n    }\n    EditorExtensionsRegistry.getEditorActions = getEditorActions;\n    function getEditorContributions() {\n        return EditorContributionRegistry.INSTANCE.getEditorContributions();\n    }\n    EditorExtensionsRegistry.getEditorContributions = getEditorContributions;\n    function getSomeEditorContributions(ids) {\n        return EditorContributionRegistry.INSTANCE.getEditorContributions().filter(c => ids.indexOf(c.id) >= 0);\n    }\n    EditorExtensionsRegistry.getSomeEditorContributions = getSomeEditorContributions;\n    function getDiffEditorContributions() {\n        return EditorContributionRegistry.INSTANCE.getDiffEditorContributions();\n    }\n    EditorExtensionsRegistry.getDiffEditorContributions = getDiffEditorContributions;\n})(EditorExtensionsRegistry || (EditorExtensionsRegistry = {}));\n// Editor extension points\nconst Extensions = {\n    EditorCommonContributions: 'editor.contributions'\n};\nclass EditorContributionRegistry {\n    constructor() {\n        this.editorContributions = [];\n        this.diffEditorContributions = [];\n        this.editorActions = [];\n        this.editorCommands = Object.create(null);\n    }\n    registerEditorContribution(id, ctor) {\n        this.editorContributions.push({ id, ctor: ctor });\n    }\n    getEditorContributions() {\n        return this.editorContributions.slice(0);\n    }\n    getDiffEditorContributions() {\n        return this.diffEditorContributions.slice(0);\n    }\n    registerEditorAction(action) {\n        action.register();\n        this.editorActions.push(action);\n    }\n    getEditorActions() {\n        return this.editorActions.slice(0);\n    }\n    registerEditorCommand(editorCommand) {\n        editorCommand.register();\n        this.editorCommands[editorCommand.id] = editorCommand;\n    }\n    getEditorCommand(commandId) {\n        return (this.editorCommands[commandId] || null);\n    }\n}\nEditorContributionRegistry.INSTANCE = new EditorContributionRegistry();\nRegistry.add(Extensions.EditorCommonContributions, EditorContributionRegistry.INSTANCE);\nfunction registerCommand(command) {\n    command.register();\n    return command;\n}\nexport const UndoCommand = registerCommand(new MultiCommand({\n    id: 'undo',\n    precondition: undefined,\n    kbOpts: {\n        weight: 0 /* KeybindingWeight.EditorCore */,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 56 /* KeyCode.KeyZ */\n    },\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '1_do',\n            title: nls.localize({ key: 'miUndo', comment: ['&& denotes a mnemonic'] }, \"&&Undo\"),\n            order: 1\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('undo', \"Undo\"),\n            order: 1\n        }]\n}));\nregisterCommand(new ProxyCommand(UndoCommand, { id: 'default:undo', precondition: undefined }));\nexport const RedoCommand = registerCommand(new MultiCommand({\n    id: 'redo',\n    precondition: undefined,\n    kbOpts: {\n        weight: 0 /* KeybindingWeight.EditorCore */,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 55 /* KeyCode.KeyY */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 56 /* KeyCode.KeyZ */],\n        mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 56 /* KeyCode.KeyZ */ }\n    },\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '1_do',\n            title: nls.localize({ key: 'miRedo', comment: ['&& denotes a mnemonic'] }, \"&&Redo\"),\n            order: 2\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('redo', \"Redo\"),\n            order: 1\n        }]\n}));\nregisterCommand(new ProxyCommand(RedoCommand, { id: 'default:redo', precondition: undefined }));\nexport const SelectAllCommand = registerCommand(new MultiCommand({\n    id: 'editor.action.selectAll',\n    precondition: undefined,\n    kbOpts: {\n        weight: 0 /* KeybindingWeight.EditorCore */,\n        kbExpr: null,\n        primary: 2048 /* KeyMod.CtrlCmd */ | 31 /* KeyCode.KeyA */\n    },\n    menuOpts: [{\n            menuId: MenuId.MenubarSelectionMenu,\n            group: '1_basic',\n            title: nls.localize({ key: 'miSelectAll', comment: ['&& denotes a mnemonic'] }, \"&&Select All\"),\n            order: 1\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('selectAll', \"Select All\"),\n            order: 1\n        }]\n}));\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable, toDisposable } from '../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\nlet AbstractCodeEditorService = class AbstractCodeEditorService extends Disposable {\n    constructor(_themeService) {\n        super();\n        this._themeService = _themeService;\n        this._onCodeEditorAdd = this._register(new Emitter());\n        this.onCodeEditorAdd = this._onCodeEditorAdd.event;\n        this._onCodeEditorRemove = this._register(new Emitter());\n        this.onCodeEditorRemove = this._onCodeEditorRemove.event;\n        this._onDiffEditorAdd = this._register(new Emitter());\n        this.onDiffEditorAdd = this._onDiffEditorAdd.event;\n        this._onDiffEditorRemove = this._register(new Emitter());\n        this.onDiffEditorRemove = this._onDiffEditorRemove.event;\n        this._decorationOptionProviders = new Map();\n        this._codeEditorOpenHandlers = new LinkedList();\n        this._modelProperties = new Map();\n        this._codeEditors = Object.create(null);\n        this._diffEditors = Object.create(null);\n        this._globalStyleSheet = null;\n    }\n    addCodeEditor(editor) {\n        this._codeEditors[editor.getId()] = editor;\n        this._onCodeEditorAdd.fire(editor);\n    }\n    removeCodeEditor(editor) {\n        if (delete this._codeEditors[editor.getId()]) {\n            this._onCodeEditorRemove.fire(editor);\n        }\n    }\n    listCodeEditors() {\n        return Object.keys(this._codeEditors).map(id => this._codeEditors[id]);\n    }\n    addDiffEditor(editor) {\n        this._diffEditors[editor.getId()] = editor;\n        this._onDiffEditorAdd.fire(editor);\n    }\n    removeDiffEditor(editor) {\n        if (delete this._diffEditors[editor.getId()]) {\n            this._onDiffEditorRemove.fire(editor);\n        }\n    }\n    listDiffEditors() {\n        return Object.keys(this._diffEditors).map(id => this._diffEditors[id]);\n    }\n    getFocusedCodeEditor() {\n        let editorWithWidgetFocus = null;\n        const editors = this.listCodeEditors();\n        for (const editor of editors) {\n            if (editor.hasTextFocus()) {\n                // bingo!\n                return editor;\n            }\n            if (editor.hasWidgetFocus()) {\n                editorWithWidgetFocus = editor;\n            }\n        }\n        return editorWithWidgetFocus;\n    }\n    removeDecorationType(key) {\n        const provider = this._decorationOptionProviders.get(key);\n        if (provider) {\n            provider.refCount--;\n            if (provider.refCount <= 0) {\n                this._decorationOptionProviders.delete(key);\n                provider.dispose();\n                this.listCodeEditors().forEach((ed) => ed.removeDecorationsByType(key));\n            }\n        }\n    }\n    setModelProperty(resource, key, value) {\n        const key1 = resource.toString();\n        let dest;\n        if (this._modelProperties.has(key1)) {\n            dest = this._modelProperties.get(key1);\n        }\n        else {\n            dest = new Map();\n            this._modelProperties.set(key1, dest);\n        }\n        dest.set(key, value);\n    }\n    getModelProperty(resource, key) {\n        const key1 = resource.toString();\n        if (this._modelProperties.has(key1)) {\n            const innerMap = this._modelProperties.get(key1);\n            return innerMap.get(key);\n        }\n        return undefined;\n    }\n    openCodeEditor(input, source, sideBySide) {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (const handler of this._codeEditorOpenHandlers) {\n                const candidate = yield handler(input, source, sideBySide);\n                if (candidate !== null) {\n                    return candidate;\n                }\n            }\n            return null;\n        });\n    }\n    registerCodeEditorOpenHandler(handler) {\n        const rm = this._codeEditorOpenHandlers.unshift(handler);\n        return toDisposable(rm);\n    }\n};\nAbstractCodeEditorService = __decorate([\n    __param(0, IThemeService)\n], AbstractCodeEditorService);\nexport { AbstractCodeEditorService };\nexport class GlobalStyleSheet {\n    constructor(styleSheet) {\n        this._styleSheet = styleSheet;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { isObject } from '../../../base/common/types.js';\nexport const IBulkEditService = createDecorator('IWorkspaceEditService');\nexport class ResourceEdit {\n    constructor(metadata) {\n        this.metadata = metadata;\n    }\n    static convert(edit) {\n        return edit.edits.map(edit => {\n            if (ResourceTextEdit.is(edit)) {\n                return ResourceTextEdit.lift(edit);\n            }\n            if (ResourceFileEdit.is(edit)) {\n                return ResourceFileEdit.lift(edit);\n            }\n            throw new Error('Unsupported edit');\n        });\n    }\n}\nexport class ResourceTextEdit extends ResourceEdit {\n    constructor(resource, textEdit, versionId = undefined, metadata) {\n        super(metadata);\n        this.resource = resource;\n        this.textEdit = textEdit;\n        this.versionId = versionId;\n    }\n    static is(candidate) {\n        if (candidate instanceof ResourceTextEdit) {\n            return true;\n        }\n        return isObject(candidate)\n            && URI.isUri(candidate.resource)\n            && isObject(candidate.textEdit);\n    }\n    static lift(edit) {\n        if (edit instanceof ResourceTextEdit) {\n            return edit;\n        }\n        else {\n            return new ResourceTextEdit(edit.resource, edit.textEdit, edit.versionId, edit.metadata);\n        }\n    }\n}\nexport class ResourceFileEdit extends ResourceEdit {\n    constructor(oldResource, newResource, options = {}, metadata) {\n        super(metadata);\n        this.oldResource = oldResource;\n        this.newResource = newResource;\n        this.options = options;\n    }\n    static is(candidate) {\n        if (candidate instanceof ResourceFileEdit) {\n            return true;\n        }\n        else {\n            return isObject(candidate)\n                && (Boolean(candidate.newResource) || Boolean(candidate.oldResource));\n        }\n    }\n    static lift(edit) {\n        if (edit instanceof ResourceFileEdit) {\n            return edit;\n        }\n        else {\n            return new ResourceFileEdit(edit.oldResource, edit.newResource, edit.options, edit.metadata);\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nexport const ICodeEditorService = createDecorator('codeEditorService');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { IntervalTimer, timeout } from '../../../base/common/async.js';\nimport { Disposable, dispose, toDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\nimport { SimpleWorkerClient, logOnceWebWorkerWarning } from '../../../base/common/worker/simpleWorker.js';\nimport { DefaultWorkerFactory } from '../../../base/browser/defaultWorkerFactory.js';\nimport { Range } from '../../common/core/range.js';\nimport { ILanguageConfigurationService } from '../../common/languages/languageConfigurationRegistry.js';\nimport { EditorSimpleWorker } from '../../common/services/editorSimpleWorker.js';\nimport { IModelService } from '../../common/services/model.js';\nimport { ITextResourceConfigurationService } from '../../common/services/textResourceConfiguration.js';\nimport { regExpFlags } from '../../../base/common/strings.js';\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\nimport { ILogService } from '../../../platform/log/common/log.js';\nimport { StopWatch } from '../../../base/common/stopwatch.js';\nimport { canceled } from '../../../base/common/errors.js';\nimport { ILanguageFeaturesService } from '../../common/services/languageFeatures.js';\n/**\n * Stop syncing a model to the worker if it was not needed for 1 min.\n */\nconst STOP_SYNC_MODEL_DELTA_TIME_MS = 60 * 1000;\n/**\n * Stop the worker if it was not needed for 5 min.\n */\nconst STOP_WORKER_DELTA_TIME_MS = 5 * 60 * 1000;\nfunction canSyncModel(modelService, resource) {\n    const model = modelService.getModel(resource);\n    if (!model) {\n        return false;\n    }\n    if (model.isTooLargeForSyncing()) {\n        return false;\n    }\n    return true;\n}\nlet EditorWorkerService = class EditorWorkerService extends Disposable {\n    constructor(modelService, configurationService, logService, languageConfigurationService, languageFeaturesService) {\n        super();\n        this._modelService = modelService;\n        this._workerManager = this._register(new WorkerManager(this._modelService, languageConfigurationService));\n        this._logService = logService;\n        // register default link-provider and default completions-provider\n        this._register(languageFeaturesService.linkProvider.register({ language: '*', hasAccessToAllModels: true }, {\n            provideLinks: (model, token) => {\n                if (!canSyncModel(this._modelService, model.uri)) {\n                    return Promise.resolve({ links: [] }); // File too large\n                }\n                return this._workerManager.withWorker().then(client => client.computeLinks(model.uri)).then(links => {\n                    return links && { links };\n                });\n            }\n        }));\n        this._register(languageFeaturesService.completionProvider.register('*', new WordBasedCompletionItemProvider(this._workerManager, configurationService, this._modelService, languageConfigurationService)));\n    }\n    dispose() {\n        super.dispose();\n    }\n    canComputeUnicodeHighlights(uri) {\n        return canSyncModel(this._modelService, uri);\n    }\n    computedUnicodeHighlights(uri, options, range) {\n        return this._workerManager.withWorker().then(client => client.computedUnicodeHighlights(uri, options, range));\n    }\n    computeDiff(original, modified, ignoreTrimWhitespace, maxComputationTime) {\n        return this._workerManager.withWorker().then(client => client.computeDiff(original, modified, ignoreTrimWhitespace, maxComputationTime));\n    }\n    computeMoreMinimalEdits(resource, edits) {\n        if (isNonEmptyArray(edits)) {\n            if (!canSyncModel(this._modelService, resource)) {\n                return Promise.resolve(edits); // File too large\n            }\n            const sw = StopWatch.create(true);\n            const result = this._workerManager.withWorker().then(client => client.computeMoreMinimalEdits(resource, edits));\n            result.finally(() => this._logService.trace('FORMAT#computeMoreMinimalEdits', resource.toString(true), sw.elapsed()));\n            return Promise.race([result, timeout(1000).then(() => edits)]);\n        }\n        else {\n            return Promise.resolve(undefined);\n        }\n    }\n    canNavigateValueSet(resource) {\n        return (canSyncModel(this._modelService, resource));\n    }\n    navigateValueSet(resource, range, up) {\n        return this._workerManager.withWorker().then(client => client.navigateValueSet(resource, range, up));\n    }\n    canComputeWordRanges(resource) {\n        return canSyncModel(this._modelService, resource);\n    }\n    computeWordRanges(resource, range) {\n        return this._workerManager.withWorker().then(client => client.computeWordRanges(resource, range));\n    }\n};\nEditorWorkerService = __decorate([\n    __param(0, IModelService),\n    __param(1, ITextResourceConfigurationService),\n    __param(2, ILogService),\n    __param(3, ILanguageConfigurationService),\n    __param(4, ILanguageFeaturesService)\n], EditorWorkerService);\nexport { EditorWorkerService };\nclass WordBasedCompletionItemProvider {\n    constructor(workerManager, configurationService, modelService, languageConfigurationService) {\n        this.languageConfigurationService = languageConfigurationService;\n        this._debugDisplayName = 'wordbasedCompletions';\n        this._workerManager = workerManager;\n        this._configurationService = configurationService;\n        this._modelService = modelService;\n    }\n    provideCompletionItems(model, position) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const config = this._configurationService.getValue(model.uri, position, 'editor');\n            if (!config.wordBasedSuggestions) {\n                return undefined;\n            }\n            const models = [];\n            if (config.wordBasedSuggestionsMode === 'currentDocument') {\n                // only current file and only if not too large\n                if (canSyncModel(this._modelService, model.uri)) {\n                    models.push(model.uri);\n                }\n            }\n            else {\n                // either all files or files of same language\n                for (const candidate of this._modelService.getModels()) {\n                    if (!canSyncModel(this._modelService, candidate.uri)) {\n                        continue;\n                    }\n                    if (candidate === model) {\n                        models.unshift(candidate.uri);\n                    }\n                    else if (config.wordBasedSuggestionsMode === 'allDocuments' || candidate.getLanguageId() === model.getLanguageId()) {\n                        models.push(candidate.uri);\n                    }\n                }\n            }\n            if (models.length === 0) {\n                return undefined; // File too large, no other files\n            }\n            const wordDefRegExp = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n            const word = model.getWordAtPosition(position);\n            const replace = !word ? Range.fromPositions(position) : new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n            const insert = replace.setEndPosition(position.lineNumber, position.column);\n            const client = yield this._workerManager.withWorker();\n            const data = yield client.textualSuggest(models, word === null || word === void 0 ? void 0 : word.word, wordDefRegExp);\n            if (!data) {\n                return undefined;\n            }\n            return {\n                duration: data.duration,\n                suggestions: data.words.map((word) => {\n                    return {\n                        kind: 18 /* languages.CompletionItemKind.Text */,\n                        label: word,\n                        insertText: word,\n                        range: { insert, replace }\n                    };\n                }),\n            };\n        });\n    }\n}\nclass WorkerManager extends Disposable {\n    constructor(modelService, languageConfigurationService) {\n        super();\n        this.languageConfigurationService = languageConfigurationService;\n        this._modelService = modelService;\n        this._editorWorkerClient = null;\n        this._lastWorkerUsedTime = (new Date()).getTime();\n        const stopWorkerInterval = this._register(new IntervalTimer());\n        stopWorkerInterval.cancelAndSet(() => this._checkStopIdleWorker(), Math.round(STOP_WORKER_DELTA_TIME_MS / 2));\n        this._register(this._modelService.onModelRemoved(_ => this._checkStopEmptyWorker()));\n    }\n    dispose() {\n        if (this._editorWorkerClient) {\n            this._editorWorkerClient.dispose();\n            this._editorWorkerClient = null;\n        }\n        super.dispose();\n    }\n    /**\n     * Check if the model service has no more models and stop the worker if that is the case.\n     */\n    _checkStopEmptyWorker() {\n        if (!this._editorWorkerClient) {\n            return;\n        }\n        const models = this._modelService.getModels();\n        if (models.length === 0) {\n            // There are no more models => nothing possible for me to do\n            this._editorWorkerClient.dispose();\n            this._editorWorkerClient = null;\n        }\n    }\n    /**\n     * Check if the worker has been idle for a while and then stop it.\n     */\n    _checkStopIdleWorker() {\n        if (!this._editorWorkerClient) {\n            return;\n        }\n        const timeSinceLastWorkerUsedTime = (new Date()).getTime() - this._lastWorkerUsedTime;\n        if (timeSinceLastWorkerUsedTime > STOP_WORKER_DELTA_TIME_MS) {\n            this._editorWorkerClient.dispose();\n            this._editorWorkerClient = null;\n        }\n    }\n    withWorker() {\n        this._lastWorkerUsedTime = (new Date()).getTime();\n        if (!this._editorWorkerClient) {\n            this._editorWorkerClient = new EditorWorkerClient(this._modelService, false, 'editorWorkerService', this.languageConfigurationService);\n        }\n        return Promise.resolve(this._editorWorkerClient);\n    }\n}\nclass EditorModelManager extends Disposable {\n    constructor(proxy, modelService, keepIdleModels) {\n        super();\n        this._syncedModels = Object.create(null);\n        this._syncedModelsLastUsedTime = Object.create(null);\n        this._proxy = proxy;\n        this._modelService = modelService;\n        if (!keepIdleModels) {\n            const timer = new IntervalTimer();\n            timer.cancelAndSet(() => this._checkStopModelSync(), Math.round(STOP_SYNC_MODEL_DELTA_TIME_MS / 2));\n            this._register(timer);\n        }\n    }\n    dispose() {\n        for (const modelUrl in this._syncedModels) {\n            dispose(this._syncedModels[modelUrl]);\n        }\n        this._syncedModels = Object.create(null);\n        this._syncedModelsLastUsedTime = Object.create(null);\n        super.dispose();\n    }\n    ensureSyncedResources(resources, forceLargeModels) {\n        for (const resource of resources) {\n            const resourceStr = resource.toString();\n            if (!this._syncedModels[resourceStr]) {\n                this._beginModelSync(resource, forceLargeModels);\n            }\n            if (this._syncedModels[resourceStr]) {\n                this._syncedModelsLastUsedTime[resourceStr] = (new Date()).getTime();\n            }\n        }\n    }\n    _checkStopModelSync() {\n        const currentTime = (new Date()).getTime();\n        const toRemove = [];\n        for (const modelUrl in this._syncedModelsLastUsedTime) {\n            const elapsedTime = currentTime - this._syncedModelsLastUsedTime[modelUrl];\n            if (elapsedTime > STOP_SYNC_MODEL_DELTA_TIME_MS) {\n                toRemove.push(modelUrl);\n            }\n        }\n        for (const e of toRemove) {\n            this._stopModelSync(e);\n        }\n    }\n    _beginModelSync(resource, forceLargeModels) {\n        const model = this._modelService.getModel(resource);\n        if (!model) {\n            return;\n        }\n        if (!forceLargeModels && model.isTooLargeForSyncing()) {\n            return;\n        }\n        const modelUrl = resource.toString();\n        this._proxy.acceptNewModel({\n            url: model.uri.toString(),\n            lines: model.getLinesContent(),\n            EOL: model.getEOL(),\n            versionId: model.getVersionId()\n        });\n        const toDispose = new DisposableStore();\n        toDispose.add(model.onDidChangeContent((e) => {\n            this._proxy.acceptModelChanged(modelUrl.toString(), e);\n        }));\n        toDispose.add(model.onWillDispose(() => {\n            this._stopModelSync(modelUrl);\n        }));\n        toDispose.add(toDisposable(() => {\n            this._proxy.acceptRemovedModel(modelUrl);\n        }));\n        this._syncedModels[modelUrl] = toDispose;\n    }\n    _stopModelSync(modelUrl) {\n        const toDispose = this._syncedModels[modelUrl];\n        delete this._syncedModels[modelUrl];\n        delete this._syncedModelsLastUsedTime[modelUrl];\n        dispose(toDispose);\n    }\n}\nclass SynchronousWorkerClient {\n    constructor(instance) {\n        this._instance = instance;\n        this._proxyObj = Promise.resolve(this._instance);\n    }\n    dispose() {\n        this._instance.dispose();\n    }\n    getProxyObject() {\n        return this._proxyObj;\n    }\n}\nexport class EditorWorkerHost {\n    constructor(workerClient) {\n        this._workerClient = workerClient;\n    }\n    // foreign host request\n    fhr(method, args) {\n        return this._workerClient.fhr(method, args);\n    }\n}\nexport class EditorWorkerClient extends Disposable {\n    constructor(modelService, keepIdleModels, label, languageConfigurationService) {\n        super();\n        this.languageConfigurationService = languageConfigurationService;\n        this._disposed = false;\n        this._modelService = modelService;\n        this._keepIdleModels = keepIdleModels;\n        this._workerFactory = new DefaultWorkerFactory(label);\n        this._worker = null;\n        this._modelManager = null;\n    }\n    // foreign host request\n    fhr(method, args) {\n        throw new Error(`Not implemented!`);\n    }\n    _getOrCreateWorker() {\n        if (!this._worker) {\n            try {\n                this._worker = this._register(new SimpleWorkerClient(this._workerFactory, 'vs/editor/common/services/editorSimpleWorker', new EditorWorkerHost(this)));\n            }\n            catch (err) {\n                logOnceWebWorkerWarning(err);\n                this._worker = new SynchronousWorkerClient(new EditorSimpleWorker(new EditorWorkerHost(this), null));\n            }\n        }\n        return this._worker;\n    }\n    _getProxy() {\n        return this._getOrCreateWorker().getProxyObject().then(undefined, (err) => {\n            logOnceWebWorkerWarning(err);\n            this._worker = new SynchronousWorkerClient(new EditorSimpleWorker(new EditorWorkerHost(this), null));\n            return this._getOrCreateWorker().getProxyObject();\n        });\n    }\n    _getOrCreateModelManager(proxy) {\n        if (!this._modelManager) {\n            this._modelManager = this._register(new EditorModelManager(proxy, this._modelService, this._keepIdleModels));\n        }\n        return this._modelManager;\n    }\n    _withSyncedResources(resources, forceLargeModels = false) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._disposed) {\n                return Promise.reject(canceled());\n            }\n            return this._getProxy().then((proxy) => {\n                this._getOrCreateModelManager(proxy).ensureSyncedResources(resources, forceLargeModels);\n                return proxy;\n            });\n        });\n    }\n    computedUnicodeHighlights(uri, options, range) {\n        return this._withSyncedResources([uri]).then(proxy => {\n            return proxy.computeUnicodeHighlights(uri.toString(), options, range);\n        });\n    }\n    computeDiff(original, modified, ignoreTrimWhitespace, maxComputationTime) {\n        return this._withSyncedResources([original, modified], /* forceLargeModels */ true).then(proxy => {\n            return proxy.computeDiff(original.toString(), modified.toString(), ignoreTrimWhitespace, maxComputationTime);\n        });\n    }\n    computeMoreMinimalEdits(resource, edits) {\n        return this._withSyncedResources([resource]).then(proxy => {\n            return proxy.computeMoreMinimalEdits(resource.toString(), edits);\n        });\n    }\n    computeLinks(resource) {\n        return this._withSyncedResources([resource]).then(proxy => {\n            return proxy.computeLinks(resource.toString());\n        });\n    }\n    textualSuggest(resources, leadingWord, wordDefRegExp) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const proxy = yield this._withSyncedResources(resources);\n            const wordDef = wordDefRegExp.source;\n            const wordDefFlags = regExpFlags(wordDefRegExp);\n            return proxy.textualSuggest(resources.map(r => r.toString()), leadingWord, wordDef, wordDefFlags);\n        });\n    }\n    computeWordRanges(resource, range) {\n        return this._withSyncedResources([resource]).then(proxy => {\n            const model = this._modelService.getModel(resource);\n            if (!model) {\n                return Promise.resolve(null);\n            }\n            const wordDefRegExp = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n            const wordDef = wordDefRegExp.source;\n            const wordDefFlags = regExpFlags(wordDefRegExp);\n            return proxy.computeWordRanges(resource.toString(), range, wordDef, wordDefFlags);\n        });\n    }\n    navigateValueSet(resource, range, up) {\n        return this._withSyncedResources([resource]).then(proxy => {\n            const model = this._modelService.getModel(resource);\n            if (!model) {\n                return null;\n            }\n            const wordDefRegExp = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n            const wordDef = wordDefRegExp.source;\n            const wordDefFlags = regExpFlags(wordDefRegExp);\n            return proxy.navigateValueSet(resource.toString(), range, up, wordDef, wordDefFlags);\n        });\n    }\n    dispose() {\n        super.dispose();\n        this._disposed = true;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IMarkerDecorationsService } from '../../common/services/markerDecorations.js';\nimport { registerEditorContribution } from '../editorExtensions.js';\nlet MarkerDecorationsContribution = class MarkerDecorationsContribution {\n    constructor(_editor, _markerDecorationsService) {\n        // Doesn't do anything, just requires `IMarkerDecorationsService` to make sure it gets instantiated\n    }\n    dispose() {\n    }\n};\nMarkerDecorationsContribution.ID = 'editor.contrib.markerDecorations';\nMarkerDecorationsContribution = __decorate([\n    __param(1, IMarkerDecorationsService)\n], MarkerDecorationsContribution);\nexport { MarkerDecorationsContribution };\nregisterEditorContribution(MarkerDecorationsContribution.ID, MarkerDecorationsContribution);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../base/browser/dom.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nimport { parse } from '../../../base/common/marshalling.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { normalizePath } from '../../../base/common/resources.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { ICodeEditorService } from './codeEditorService.js';\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\nimport { EditorOpenSource } from '../../../platform/editor/common/editor.js';\nimport { extractSelection, matchesScheme, matchesSomeScheme } from '../../../platform/opener/common/opener.js';\nlet CommandOpener = class CommandOpener {\n    constructor(_commandService) {\n        this._commandService = _commandService;\n    }\n    open(target, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!matchesScheme(target, Schemas.command)) {\n                return false;\n            }\n            if (!(options === null || options === void 0 ? void 0 : options.allowCommands)) {\n                // silently ignore commands when command-links are disabled, also\n                // surpress other openers by returning TRUE\n                return true;\n            }\n            // run command or bail out if command isn't known\n            if (typeof target === 'string') {\n                target = URI.parse(target);\n            }\n            // execute as command\n            let args = [];\n            try {\n                args = parse(decodeURIComponent(target.query));\n            }\n            catch (_a) {\n                // ignore and retry\n                try {\n                    args = parse(target.query);\n                }\n                catch (_b) {\n                    // ignore error\n                }\n            }\n            if (!Array.isArray(args)) {\n                args = [args];\n            }\n            yield this._commandService.executeCommand(target.path, ...args);\n            return true;\n        });\n    }\n};\nCommandOpener = __decorate([\n    __param(0, ICommandService)\n], CommandOpener);\nlet EditorOpener = class EditorOpener {\n    constructor(_editorService) {\n        this._editorService = _editorService;\n    }\n    open(target, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof target === 'string') {\n                target = URI.parse(target);\n            }\n            const { selection, uri } = extractSelection(target);\n            target = uri;\n            if (target.scheme === Schemas.file) {\n                target = normalizePath(target); // workaround for non-normalized paths (https://github.com/microsoft/vscode/issues/12954)\n            }\n            yield this._editorService.openCodeEditor({\n                resource: target,\n                options: Object.assign({ selection, source: (options === null || options === void 0 ? void 0 : options.fromUserGesture) ? EditorOpenSource.USER : EditorOpenSource.API }, options === null || options === void 0 ? void 0 : options.editorOptions)\n            }, this._editorService.getFocusedCodeEditor(), options === null || options === void 0 ? void 0 : options.openToSide);\n            return true;\n        });\n    }\n};\nEditorOpener = __decorate([\n    __param(0, ICodeEditorService)\n], EditorOpener);\nlet OpenerService = class OpenerService {\n    constructor(editorService, commandService) {\n        this._openers = new LinkedList();\n        this._validators = new LinkedList();\n        this._resolvers = new LinkedList();\n        this._resolvedUriTargets = new ResourceMap(uri => uri.with({ path: null, fragment: null, query: null }).toString());\n        this._externalOpeners = new LinkedList();\n        // Default external opener is going through window.open()\n        this._defaultExternalOpener = {\n            openExternal: (href) => __awaiter(this, void 0, void 0, function* () {\n                // ensure to open HTTP/HTTPS links into new windows\n                // to not trigger a navigation. Any other link is\n                // safe to be set as HREF to prevent a blank window\n                // from opening.\n                if (matchesSomeScheme(href, Schemas.http, Schemas.https)) {\n                    dom.windowOpenNoOpener(href);\n                }\n                else {\n                    window.location.href = href;\n                }\n                return true;\n            })\n        };\n        // Default opener: any external, maito, http(s), command, and catch-all-editors\n        this._openers.push({\n            open: (target, options) => __awaiter(this, void 0, void 0, function* () {\n                if ((options === null || options === void 0 ? void 0 : options.openExternal) || matchesSomeScheme(target, Schemas.mailto, Schemas.http, Schemas.https, Schemas.vsls)) {\n                    // open externally\n                    yield this._doOpenExternal(target, options);\n                    return true;\n                }\n                return false;\n            })\n        });\n        this._openers.push(new CommandOpener(commandService));\n        this._openers.push(new EditorOpener(editorService));\n    }\n    registerOpener(opener) {\n        const remove = this._openers.unshift(opener);\n        return { dispose: remove };\n    }\n    registerValidator(validator) {\n        const remove = this._validators.push(validator);\n        return { dispose: remove };\n    }\n    registerExternalUriResolver(resolver) {\n        const remove = this._resolvers.push(resolver);\n        return { dispose: remove };\n    }\n    setDefaultExternalOpener(externalOpener) {\n        this._defaultExternalOpener = externalOpener;\n    }\n    registerExternalOpener(opener) {\n        const remove = this._externalOpeners.push(opener);\n        return { dispose: remove };\n    }\n    open(target, options) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            // check with contributed validators\n            const targetURI = typeof target === 'string' ? URI.parse(target) : target;\n            // validate against the original URI that this URI resolves to, if one exists\n            const validationTarget = (_a = this._resolvedUriTargets.get(targetURI)) !== null && _a !== void 0 ? _a : target;\n            for (const validator of this._validators) {\n                if (!(yield validator.shouldOpen(validationTarget, options))) {\n                    return false;\n                }\n            }\n            // check with contributed openers\n            for (const opener of this._openers) {\n                const handled = yield opener.open(target, options);\n                if (handled) {\n                    return true;\n                }\n            }\n            return false;\n        });\n    }\n    resolveExternalUri(resource, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (const resolver of this._resolvers) {\n                try {\n                    const result = yield resolver.resolveExternalUri(resource, options);\n                    if (result) {\n                        if (!this._resolvedUriTargets.has(result.resolved)) {\n                            this._resolvedUriTargets.set(result.resolved, resource);\n                        }\n                        return result;\n                    }\n                }\n                catch (_a) {\n                    // noop\n                }\n            }\n            throw new Error('Could not resolve external URI: ' + resource.toString());\n        });\n    }\n    _doOpenExternal(resource, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            //todo@jrieken IExternalUriResolver should support `uri: URI | string`\n            const uri = typeof resource === 'string' ? URI.parse(resource) : resource;\n            let externalUri;\n            try {\n                externalUri = (yield this.resolveExternalUri(uri, options)).resolved;\n            }\n            catch (_a) {\n                externalUri = uri;\n            }\n            let href;\n            if (typeof resource === 'string' && uri.toString() === externalUri.toString()) {\n                // open the url-string AS IS\n                href = resource;\n            }\n            else {\n                // open URI using the toString(noEncode)+encodeURI-trick\n                href = encodeURI(externalUri.toString(true));\n            }\n            if (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) {\n                const preferredOpenerId = typeof (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) === 'string' ? options === null || options === void 0 ? void 0 : options.allowContributedOpeners : undefined;\n                for (const opener of this._externalOpeners) {\n                    const didOpen = yield opener.openExternal(href, {\n                        sourceUri: uri,\n                        preferredOpenerId,\n                    }, CancellationToken.None);\n                    if (didOpen) {\n                        return true;\n                    }\n                }\n            }\n            return this._defaultExternalOpener.openExternal(href, { sourceUri: uri }, CancellationToken.None);\n        });\n    }\n    dispose() {\n        this._validators.clear();\n    }\n};\nOpenerService = __decorate([\n    __param(0, ICodeEditorService),\n    __param(1, ICommandService)\n], OpenerService);\nexport { OpenerService };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorWorkerClient } from './editorWorkerService.js';\nimport * as types from '../../../base/common/types.js';\n/**\n * Create a new web worker that has model syncing capabilities built in.\n * Specify an AMD module to load that will `create` an object that will be proxied.\n */\nexport function createWebWorker(modelService, languageConfigurationService, opts) {\n    return new MonacoWebWorkerImpl(modelService, languageConfigurationService, opts);\n}\nclass MonacoWebWorkerImpl extends EditorWorkerClient {\n    constructor(modelService, languageConfigurationService, opts) {\n        super(modelService, opts.keepIdleModels || false, opts.label, languageConfigurationService);\n        this._foreignModuleId = opts.moduleId;\n        this._foreignModuleCreateData = opts.createData || null;\n        this._foreignModuleHost = opts.host || null;\n        this._foreignProxy = null;\n    }\n    // foreign host request\n    fhr(method, args) {\n        if (!this._foreignModuleHost || typeof this._foreignModuleHost[method] !== 'function') {\n            return Promise.reject(new Error('Missing method ' + method + ' or missing main thread foreign host.'));\n        }\n        try {\n            return Promise.resolve(this._foreignModuleHost[method].apply(this._foreignModuleHost, args));\n        }\n        catch (e) {\n            return Promise.reject(e);\n        }\n    }\n    _getForeignProxy() {\n        if (!this._foreignProxy) {\n            this._foreignProxy = this._getProxy().then((proxy) => {\n                const foreignHostMethods = this._foreignModuleHost ? types.getAllMethodNames(this._foreignModuleHost) : [];\n                return proxy.loadForeignModule(this._foreignModuleId, this._foreignModuleCreateData, foreignHostMethods).then((foreignMethods) => {\n                    this._foreignModuleCreateData = null;\n                    const proxyMethodRequest = (method, args) => {\n                        return proxy.fmr(method, args);\n                    };\n                    const createProxyMethod = (method, proxyMethodRequest) => {\n                        return function () {\n                            const args = Array.prototype.slice.call(arguments, 0);\n                            return proxyMethodRequest(method, args);\n                        };\n                    };\n                    const foreignProxy = {};\n                    for (const foreignMethod of foreignMethods) {\n                        foreignProxy[foreignMethod] = createProxyMethod(foreignMethod, proxyMethodRequest);\n                    }\n                    return foreignProxy;\n                });\n            });\n        }\n        return this._foreignProxy;\n    }\n    getProxy() {\n        return this._getForeignProxy();\n    }\n    withSyncedResources(resources) {\n        return this._withSyncedResources(resources).then(_ => this.getProxy());\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class StableEditorScrollState {\n    constructor(_visiblePosition, _visiblePositionScrollDelta, _cursorPosition) {\n        this._visiblePosition = _visiblePosition;\n        this._visiblePositionScrollDelta = _visiblePositionScrollDelta;\n        this._cursorPosition = _cursorPosition;\n    }\n    static capture(editor) {\n        let visiblePosition = null;\n        let visiblePositionScrollDelta = 0;\n        if (editor.getScrollTop() !== 0) {\n            const visibleRanges = editor.getVisibleRanges();\n            if (visibleRanges.length > 0) {\n                visiblePosition = visibleRanges[0].getStartPosition();\n                const visiblePositionScrollTop = editor.getTopForPosition(visiblePosition.lineNumber, visiblePosition.column);\n                visiblePositionScrollDelta = editor.getScrollTop() - visiblePositionScrollTop;\n            }\n        }\n        return new StableEditorScrollState(visiblePosition, visiblePositionScrollDelta, editor.getPosition());\n    }\n    restore(editor) {\n        if (this._visiblePosition) {\n            const visiblePositionScrollTop = editor.getTopForPosition(this._visiblePosition.lineNumber, this._visiblePosition.column);\n            editor.setScrollTop(visiblePositionScrollTop + this._visiblePositionScrollDelta);\n        }\n    }\n    restoreRelativeVerticalPositionOfCursor(editor) {\n        const currentCursorPosition = editor.getPosition();\n        if (!this._cursorPosition || !currentCursorPosition) {\n            return;\n        }\n        const offset = editor.getTopForLineNumber(currentCursorPosition.lineNumber) - editor.getTopForLineNumber(this._cursorPosition.lineNumber);\n        editor.setScrollTop(editor.getScrollTop() + offset);\n    }\n}\n"],"names":["isCodeEditor","thing","getEditorType","editorCommon","isDiffEditor","getCodeEditor","getModifiedEditor","PageCoordinates","x","y","this","_pageCoordinatesBrand","undefined","ClientCoordinates","dom","clientX","clientY","_clientCoordinatesBrand","EditorPagePosition","width","height","_editorPagePositionBrand","CoordinatesRelativeToEditor","_positionRelativeToEditorBrand","createEditorPagePosition","editorViewDomNode","editorPos","left","top","createCoordinatesRelativeToEditor","editorPagePosition","pos","scaleX","offsetWidth","scaleY","offsetHeight","relativeX","relativeY","EditorMouseEvent","e","isFromPointerCapture","_editorMouseEventBrand","posx","posy","relativePos","StandardMouseEvent","EditorMouseEventFactory","_editorViewDomNode","target","callback","_create","pointerId","EditorPointerEventFactory","GlobalEditorPointerMoveMonitor","_globalPointerMoveMonitor","_register","GlobalPointerMoveMonitor","_keydownListener","initialElement","initialButtons","pointerMoveCallback","onStopCallback","document","toKeybinding","isModifierKey","stopMonitoring","browserEvent","startMonitoring","dispose","Disposable","DynamicCssRules","_editor","_instanceId","_idPool","_counter","_rules","Map","_garbageCollectionScheduler","RunOnceScheduler","garbageCollect","options","rule","getOrCreateRule","increaseRefCount","className","decreaseRefCount","schedule","properties","key","computeUniqueKey","existingRule","get","counter","RefCountedCssRule","getContainerDomNode","set","JSON","stringify","values","hasReferences","delete","_containerElement","_referenceCount","_styleElement","textContent","getCssText","str","prop","value","cssValue","asCssVariableName","id","cssPropName","camelToDashes","remove","replace","toLowerCase","letter","EditorExtensionsRegistry","Command","opts","precondition","_kbOpts","kbOpts","_menuOpts","menuOpts","_description","description","Array","isArray","forEach","_registerMenuItem","kbOptsArr","kbWhen","kbExpr","ContextKeyExpr","desc","weight","args","when","primary","secondary","win","linux","mac","KeybindingsRegistry","CommandsRegistry","handler","accessor","runCommand","item","MenuRegistry","menuId","group","command","title","icon","order","MultiCommand","arguments","_implementations","priority","name","implementation","push","sort","a","b","i","length","splice","logService","ILogService","trace","impl","result","ProxyCommand","EditorCommand","runEditorCommand","editor","controllerGetter","_callback","controller","runner","codeEditorService","ICodeEditorService","getFocusedCodeEditor","getActiveCodeEditor","invokeWithinContext","editorAccessor","IContextKeyService","contextMatchesRules","withNullAsUndefined","EditorAction","convertOptions","label","alias","reportTelemetry","run","ITelemetryService","publicLog2","withDefaults","MenuId","contextMenuOpts","map","MultiEditorAction","registerModelAndPositionCommand","instaService","IInstantiationService","resource","position","assertType","URI","Position","model","IModelService","getModel","editorPosition","invokeFunction","slice","ITextModelService","createModelReference","then","reference","Promise","resolve","reject","object","textEditorModel","err","finally","registerEditorCommand","editorCommand","EditorContributionRegistry","INSTANCE","registerEditorAction","ctor","action","registerMultiEditorAction","registerInstantiatedEditorAction","editorAction","registerEditorContribution","getEditorCommand","commandId","getEditorActions","getEditorContributions","getSomeEditorContributions","ids","filter","c","indexOf","getDiffEditorContributions","editorContributions","diffEditorContributions","editorActions","editorCommands","Object","create","register","registerCommand","Registry","UndoCommand","nls","comment","RedoCommand","SelectAllCommand","__decorate","decorators","d","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","next","rejected","done","apply","AbstractCodeEditorService","_themeService","_onCodeEditorAdd","Emitter","onCodeEditorAdd","event","_onCodeEditorRemove","onCodeEditorRemove","_onDiffEditorAdd","onDiffEditorAdd","_onDiffEditorRemove","onDiffEditorRemove","_decorationOptionProviders","_codeEditorOpenHandlers","LinkedList","_modelProperties","_codeEditors","_diffEditors","_globalStyleSheet","getId","fire","keys","editorWithWidgetFocus","editors","listCodeEditors","hasTextFocus","hasWidgetFocus","provider","refCount","ed","removeDecorationsByType","dest","key1","toString","has","input","source","sideBySide","candidate","rm","unshift","toDisposable","IThemeService","IBulkEditService","createDecorator","ResourceEdit","metadata","edit","edits","ResourceTextEdit","is","lift","ResourceFileEdit","Error","textEdit","versionId","isObject","oldResource","newResource","Boolean","STOP_WORKER_DELTA_TIME_MS","canSyncModel","modelService","isTooLargeForSyncing","EditorWorkerService","configurationService","languageConfigurationService","languageFeaturesService","_modelService","_workerManager","WorkerManager","_logService","linkProvider","language","hasAccessToAllModels","provideLinks","token","uri","withWorker","client","computeLinks","links","completionProvider","WordBasedCompletionItemProvider","range","computedUnicodeHighlights","original","modified","ignoreTrimWhitespace","maxComputationTime","computeDiff","isNonEmptyArray","sw","StopWatch","computeMoreMinimalEdits","elapsed","race","timeout","up","navigateValueSet","computeWordRanges","ITextResourceConfigurationService","ILanguageConfigurationService","ILanguageFeaturesService","workerManager","_debugDisplayName","_configurationService","config","getValue","wordBasedSuggestions","models","wordBasedSuggestionsMode","getModels","getLanguageId","wordDefRegExp","getLanguageConfiguration","getWordDefinition","word","getWordAtPosition","Range","lineNumber","startColumn","endColumn","insert","setEndPosition","column","textualSuggest","data","duration","suggestions","words","kind","insertText","_editorWorkerClient","_lastWorkerUsedTime","Date","getTime","IntervalTimer","cancelAndSet","_checkStopIdleWorker","Math","round","onModelRemoved","_","_checkStopEmptyWorker","EditorWorkerClient","EditorModelManager","proxy","keepIdleModels","_syncedModels","_syncedModelsLastUsedTime","_proxy","timer","_checkStopModelSync","STOP_SYNC_MODEL_DELTA_TIME_MS","modelUrl","resources","forceLargeModels","resourceStr","_beginModelSync","currentTime","toRemove","_stopModelSync","acceptNewModel","url","lines","getLinesContent","EOL","getEOL","getVersionId","toDispose","DisposableStore","add","onDidChangeContent","acceptModelChanged","onWillDispose","acceptRemovedModel","SynchronousWorkerClient","instance","_instance","_proxyObj","EditorWorkerHost","workerClient","_workerClient","method","fhr","_disposed","_keepIdleModels","_workerFactory","DefaultWorkerFactory","_worker","_modelManager","SimpleWorkerClient","logOnceWebWorkerWarning","EditorSimpleWorker","_getOrCreateWorker","getProxyObject","canceled","_getProxy","_getOrCreateModelManager","ensureSyncedResources","_withSyncedResources","computeUnicodeHighlights","leadingWord","wordDef","wordDefFlags","regExpFlags","MarkerDecorationsContribution","_markerDecorationsService","ID","IMarkerDecorationsService","CommandOpener","_commandService","matchesScheme","Schemas","allowCommands","parse","decodeURIComponent","query","_a","_b","executeCommand","path","ICommandService","EditorOpener","_editorService","extractSelection","selection","scheme","normalizePath","openCodeEditor","assign","fromUserGesture","EditorOpenSource","editorOptions","openToSide","OpenerService","editorService","commandService","_openers","_validators","_resolvers","_resolvedUriTargets","ResourceMap","with","fragment","_externalOpeners","_defaultExternalOpener","openExternal","href","matchesSomeScheme","window","location","open","_doOpenExternal","opener","validator","resolver","externalOpener","targetURI","validationTarget","shouldOpen","resolveExternalUri","resolved","externalUri","encodeURI","allowContributedOpeners","preferredOpenerId","sourceUri","CancellationToken","clear","createWebWorker","MonacoWebWorkerImpl","_foreignModuleId","moduleId","_foreignModuleCreateData","createData","_foreignModuleHost","host","_foreignProxy","foreignHostMethods","types","loadForeignModule","foreignMethods","proxyMethodRequest","fmr","createProxyMethod","prototype","call","foreignProxy","foreignMethod","_getForeignProxy","getProxy","StableEditorScrollState","_visiblePosition","_visiblePositionScrollDelta","_cursorPosition","visiblePositionScrollTop","getTopForPosition","setScrollTop","currentCursorPosition","getPosition","offset","getTopForLineNumber","getScrollTop","visiblePosition","visiblePositionScrollDelta","visibleRanges","getVisibleRanges","getStartPosition"],"sourceRoot":""}