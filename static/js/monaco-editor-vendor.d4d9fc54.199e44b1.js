"use strict";(self.webpackChunkmonaco_editor_nginx=self.webpackChunkmonaco_editor_nginx||[]).push([[233],{57195:function(e,t,n){n.r(t),n.d(t,{InlayHintsController:function(){return te},RenderedInlayHintLabelPart:function(){return ee}});var i=n(4942),r=n(93433),o=n(29439),a=n(37762),s=n(15671),u=n(43144),c=n(87757),l=n.n(c),d=n(32590),h=n(32124),v=n(68552),g=n(10526),f=n(49584),p=n(64272),m=n(50605),b=n(93741),C=n(98351),y=n(31492),w=n(30788),L=n(49500),x=n(36158),k=n(27959),_=n(22847),S=n(26777),I=n(61826),N=n(10849),Z=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(t){o(t)}}function s(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},M=(0,u.Z)((function e(t,n){(0,s.Z)(this,e),this.range=t,this.direction=n})),D=function(){function e(t,n,i){(0,s.Z)(this,e),this.hint=t,this.anchor=n,this.provider=i,this._isResolved=!1}return(0,u.Z)(e,[{key:"with",value:function(t){var n=new e(this.hint,t.anchor,this.provider);return n._isResolved=this._isResolved,n._currentResolve=this._currentResolve,n}},{key:"resolve",value:function(e){return Z(this,void 0,void 0,l().mark((function t(){var n=this;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("function"===typeof this.provider.resolveInlayHint){t.next=2;break}return t.abrupt("return");case 2:if(!this._currentResolve){t.next=8;break}return t.next=5,this._currentResolve;case 5:if(!e.isCancellationRequested){t.next=7;break}return t.abrupt("return");case 7:return t.abrupt("return",this.resolve(e));case 8:return this._isResolved||(this._currentResolve=this._doResolve(e).finally((function(){return n._currentResolve=void 0}))),t.next=11,this._currentResolve;case 11:case"end":return t.stop()}}),t,this)})))}},{key:"_doResolve",value:function(e){var t,n;return Z(this,void 0,void 0,l().mark((function i(){var r;return l().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Promise.resolve(this.provider.resolveInlayHint(this.hint,e));case 3:r=i.sent,this.hint.tooltip=null!==(t=null===r||void 0===r?void 0:r.tooltip)&&void 0!==t?t:this.hint.tooltip,this.hint.label=null!==(n=null===r||void 0===r?void 0:r.label)&&void 0!==n?n:this.hint.label,this._isResolved=!0,i.next=13;break;case 9:i.prev=9,i.t0=i.catch(0),(0,v.Cp)(i.t0),this._isResolved=!1;case 13:case"end":return i.stop()}}),i,this,[[0,9]])})))}}]),e}(),R=function(){function e(t,n,i){(0,s.Z)(this,e),this._disposables=new g.SL,this.ranges=t,this.provider=new Set;var r,u=[],c=(0,a.Z)(n);try{for(c.s();!(r=c.n()).done;){var l=(0,o.Z)(r.value,2),d=l[0],h=l[1];this._disposables.add(d),this.provider.add(h);var v,f=(0,a.Z)(d.hints);try{for(f.s();!(v=f.n()).done;){var p=v.value,m=i.validatePosition(p.position),b="before",C=e._getRangeAtPosition(i,m),y=void 0;C.getStartPosition().isBefore(m)?(y=w.e.fromPositions(C.getStartPosition(),m),b="after"):(y=w.e.fromPositions(m,C.getEndPosition()),b="before"),u.push(new D(p,new M(y,b),h))}}catch(L){f.e(L)}finally{f.f()}}}catch(L){c.e(L)}finally{c.f()}this.items=u.sort((function(e,t){return N.L.compare(e.hint.position,t.hint.position)}))}return(0,u.Z)(e,[{key:"dispose",value:function(){this._disposables.dispose()}}],[{key:"create",value:function(t,n,i){return Z(this,void 0,void 0,l().mark((function r(){var o,a,s=this;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=[],a=L.mX.ordered(t).reverse().map((function(e){return n.map((function(n){return Z(s,void 0,void 0,l().mark((function r(){var a;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.provideInlayHints(t,n,i);case 3:(null===(a=r.sent)||void 0===a?void 0:a.hints.length)&&o.push([a,e]),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),(0,v.Cp)(r.t0);case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))}))})),r.next=4,Promise.all(a.flat());case 4:if(!i.isCancellationRequested&&!t.isDisposed()){r.next=6;break}throw new v.FU;case 6:return r.abrupt("return",new e(n,o,t));case 7:case"end":return r.stop()}}),r)})))}},{key:"_getRangeAtPosition",value:function(e,t){var n=t.lineNumber,i=e.getWordAtPosition(t);if(i)return new w.e(n,i.startColumn,n,i.endColumn);e.tokenizeIfCheap(n);var r=e.getLineTokens(n),o=t.column-1,a=r.findTokenIndexAtOffset(o),s=r.getStartOffset(a),u=r.getEndOffset(a);return u-s===1&&(s===o&&a>1?(s=r.getStartOffset(a-1),u=r.getEndOffset(a-1)):u===o&&a<r.getCount()-1&&(s=r.getStartOffset(a+1),u=r.getEndOffset(a+1))),new w.e(n,s+1,n,u+1)}}]),e}(),E=n(53210),T=n(89663),A=n(55584),O=n(99892),P=n(23911),U=n(89850),H=n(49525),F=n(30291),V=n(8850),W=n(13023),K=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(t){o(t)}}function s(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))};function z(e,t,n,i){var o;return K(this,void 0,void 0,l().mark((function s(){var u,c,d,v,g,f,p,m,b,y,L,x,k,_=this;return l().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return u=e.get(S.S),c=e.get(F.i),d=e.get(U.Hy),v=e.get(V.TG),g=e.get(W.lT),s.next=7,i.item.resolve(h.T.None);case 7:if(i.part.location){s.next=9;break}return s.abrupt("return");case 9:f=i.part.location,p=[],m=new Set(P.BH.getMenuItems(P.eH.EditorContext).map((function(e){return(0,P.vr)(e)?e.command.id:""}))),b=(0,a.Z)(C.Uc.getEditorActions());try{for(L=function(){var e=y.value;e instanceof A.SymbolNavigationAction&&m.has(e.id)&&p.push(new T.aU(e.id,e.label,void 0,!0,(function(){return K(_,void 0,void 0,l().mark((function n(){var i;return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u.createModelReference(f.uri);case 2:return i=n.sent,n.prev=3,n.next=6,v.invokeFunction(e.run.bind(e),t,new A.SymbolNavigationAnchor(i.object.textEditorModel,w.e.getStartPosition(f.range)));case 6:return n.prev=6,i.dispose(),n.finish(6);case 9:case"end":return n.stop()}}),n,null,[[3,,6,9]])})))})))},b.s();!(y=b.n()).done;)L()}catch(I){b.e(I)}finally{b.f()}i.part.command&&(x=i.part.command,p.push(new T.Z0),p.push(new T.aU(x.id,x.title,void 0,!0,(function(){return K(_,void 0,void 0,l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.executeCommand.apply(d,[x.id].concat((0,r.Z)(null!==(t=x.arguments)&&void 0!==t?t:[])));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),g.notify({severity:W.zb.Error,source:i.item.provider.displayName,message:e.t0});case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))})))),k=t.getOption(115),c.showContextMenu({domForShadowRoot:k&&null!==(o=t.getDomNode())&&void 0!==o?o:void 0,getAnchor:function(){var e=E.getDomNodePagePosition(n);return{x:e.left,y:e.top+e.height+8}},getActions:function(){return p},onHide:function(){t.focus()},autoSelectFirstItem:!0});case 17:case"end":return s.stop()}}),s)})))}function j(e,t,n,i){return K(this,void 0,void 0,l().mark((function r(){var o,a,s=this;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=e.get(S.S),r.next=3,o.createModelReference(i.uri);case 3:return a=r.sent,r.next=6,n.invokeWithinContext((function(e){return K(s,void 0,void 0,l().mark((function r(){var o,s,u,c,d;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=t.hasSideBySideModifier,s=e.get(H.i6),u=O.Jy.inPeekEditor.getValue(s),c=!o&&n.getOption(78)&&!u,d=new A.DefinitionAction({openToSide:o,openInPeek:c,muteMessage:!0},{alias:"",label:"",id:"",precondition:void 0}),r.abrupt("return",d.run(e,n,{model:a.object.textEditorModel,position:w.e.getStartPosition(i.range)}));case 6:case"end":return r.stop()}}),r)})))}));case 6:a.dispose();case 7:case"end":return r.stop()}}),r)})))}var B=n(11280),Y=n(6574),q=n(3553),G=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Q=function(e,t){return function(n,i){t(n,i,e)}},J=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(t){o(t)}}function s(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},X=function(){function e(){(0,s.Z)(this,e),this._entries=new f.z6(50)}return(0,u.Z)(e,[{key:"get",value:function(t){var n=e._key(t);return this._entries.get(n)}},{key:"set",value:function(t,n){var i=e._key(t);this._entries.set(i,n)}}],[{key:"_key",value:function(e){return"".concat(e.uri.toString(),"/").concat(e.getVersionId())}}]),e}(),$=(0,V.yh)("IInlayHintsCache");(0,B.z)($,X,!0);var ee=function(){function e(t,n){(0,s.Z)(this,e),this.item=t,this.index=n}return(0,u.Z)(e,[{key:"part",get:function(){var e=this.item.hint.label;return"string"===typeof e?{label:e}:e[this.index]}}]),e}(),te=function(){function e(t,n,i,r,o,a){var u=this;(0,s.Z)(this,e),this._editor=t,this._inlayHintsCache=i,this._commandService=r,this._notificationService=o,this._instaService=a,this._disposables=new g.SL,this._sessionDisposables=new g.SL,this._decorationsMetadata=new Map,this._ruleFactory=new b.t7(this._editor),this._debounceInfo=n.for(L.mX,"InlayHint",{min:25}),this._disposables.add(L.mX.onDidChange((function(){return u._update()}))),this._disposables.add(t.onDidChangeModel((function(){return u._update()}))),this._disposables.add(t.onDidChangeModelLanguage((function(){return u._update()}))),this._disposables.add(t.onDidChangeConfiguration((function(e){e.hasChanged(127)&&u._update()}))),this._update()}return(0,u.Z)(e,[{key:"dispose",value:function(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}},{key:"_update",value:function(){var e=this;if(this._sessionDisposables.clear(),this._removeAllDecorations(),this._editor.getOption(127).enabled){var t=this._editor.getModel();if(t&&L.mX.has(t)){var n,i=this._inlayHintsCache.get(t);i&&this._updateHintsDecorators([t.getFullModelRange()],i),this._sessionDisposables.add((0,g.OF)((function(){t.isDisposed()||e._cacheHintsForFastRestore(t)})));var r=new Set,o=new d.pY((function(){return J(e,void 0,void 0,l().mark((function e(){var i,s,u,c,d,g,f;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Date.now(),null===n||void 0===n||n.dispose(!0),n=new h.A,s=t.onWillDispose((function(){return null===n||void 0===n?void 0:n.cancel()})),e.prev=4,u=n.token,e.next=8,R.create(t,this._getHintsRanges(),u);case 8:if(c=e.sent,o.delay=this._debounceInfo.update(t,Date.now()-i),!u.isCancellationRequested){e.next=13;break}return c.dispose(),e.abrupt("return");case 13:d=(0,a.Z)(c.provider);try{for(d.s();!(g=d.n()).done;)"function"!==typeof(f=g.value).onDidChangeInlayHints||r.has(f)||(r.add(f),this._sessionDisposables.add(f.onDidChangeInlayHints((function(){o.isScheduled()||o.schedule()}))))}catch(l){d.e(l)}finally{d.f()}this._sessionDisposables.add(c),this._updateHintsDecorators(c.ranges,c.items),this._cacheHintsForFastRestore(t),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),(0,v.dL)(e.t0);case 23:return e.prev=23,n.dispose(),s.dispose(),e.finish(23);case 27:case"end":return e.stop()}}),e,this,[[4,20,23,27]])})))}),this._debounceInfo.get(t));this._sessionDisposables.add(o),this._sessionDisposables.add((0,g.OF)((function(){return null===n||void 0===n?void 0:n.dispose(!0)}))),o.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange((function(e){!e.scrollTopChanged&&o.isScheduled()||o.schedule()}))),this._sessionDisposables.add(this._editor.onDidChangeModelContent((function(e){var t=Math.max(o.delay,1250);o.schedule(t)}))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installContextMenu())}}}},{key:"_installLinkGesture",value:function(){var e=this,t=function(){},n=new I.yN(this._editor);return n.onMouseMoveOrRelevantKeyDown((function(n){var i=(0,o.Z)(n,1)[0],r=e._getInlayHintLabelPart(i),s=e._editor.getModel();if(r&&i.hasTriggerModifier&&s){if(i.hasTriggerModifier&&(r.part.command||r.part.location)){var u=new h.A;r.item.resolve(u.token),e._activeInlayHintPart=r;var c,l=e._activeInlayHintPart.item.hint.position.lineNumber,d=new w.e(l,1,l,s.getLineMaxColumn(l)),v=new Set,g=(0,a.Z)(e._decorationsMetadata.values());try{for(g.s();!(c=g.n()).done;){var f=c.value;d.containsRange(f.item.anchor.range)&&v.add(f.item)}}catch(p){g.e(p)}finally{g.f()}e._updateHintsDecorators([d],Array.from(v)),t=function(){u.dispose(!0),e._activeInlayHintPart=void 0,e._updateHintsDecorators([d],Array.from(v))}}}else t()})),n.onCancel(t),n.onExecute((function(t){return J(e,void 0,void 0,l().mark((function e(){var n,i,o,a;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=this._getInlayHintLabelPart(t))){e.next=16;break}if(!(o=i.part).location){e.next=7;break}this._instaService.invokeFunction(j,t,this._editor,o.location),e.next=16;break;case 7:if(!L.mY.is(o.command)){e.next=16;break}return e.prev=8,e.next=11,(a=this._commandService).executeCommand.apply(a,[o.command.id].concat((0,r.Z)(null!==(n=o.command.arguments)&&void 0!==n?n:[])));case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),this._notificationService.notify({severity:W.zb.Error,source:i.item.provider.displayName,message:e.t0});case 16:case"end":return e.stop()}}),e,this,[[8,13]])})))})),n}},{key:"_installContextMenu",value:function(){var e=this;return this._editor.onContextMenu((function(t){return J(e,void 0,void 0,l().mark((function e(){var n;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.event.target instanceof HTMLElement){e.next=2;break}return e.abrupt("return");case 2:if(!(n=this._getInlayHintLabelPart(t))){e.next=6;break}return e.next=6,this._instaService.invokeFunction(z,this._editor,t.event.target,n);case 6:case"end":return e.stop()}}),e,this)})))}))}},{key:"_getInlayHintLabelPart",value:function(e){var t;if(6===e.target.type){var n=null===(t=e.target.detail.injectedText)||void 0===t?void 0:t.options;return n instanceof k.HS&&(null===n||void 0===n?void 0:n.attachedData)instanceof ee?n.attachedData:void 0}}},{key:"_cacheHintsForFastRestore",value:function(e){var t,n=new Map,i=(0,a.Z)(this._decorationsMetadata);try{for(i.s();!(t=i.n()).done;){var r=(0,o.Z)(t.value,2),s=r[0],u=r[1];if(!n.has(u.item)){var c=u.item,l=e.getDecorationRange(s);if(l){var d=new M(l,u.item.anchor.direction);c=u.item.with({anchor:d})}n.set(u.item,c)}}}catch(h){i.e(h)}finally{i.f()}this._inlayHintsCache.set(e,Array.from(n.values()))}},{key:"_getHintsRanges",value:function(){var e,t=this._editor.getModel(),n=this._editor.getVisibleRangesPlusViewportAboveBelow(),i=[],r=(0,a.Z)(n.sort(w.e.compareRangesUsingStarts));try{for(r.s();!(e=r.n()).done;){var o=e.value,s=t.validateRange(new w.e(o.startLineNumber-30,o.startColumn,o.endLineNumber+30,o.endColumn));0!==i.length&&w.e.areIntersectingOrTouching(i[i.length-1],s)?i[i.length-1]=w.e.plusRange(i[i.length-1],s):i.push(s)}}catch(u){r.e(u)}finally{r.f()}return i}},{key:"_updateHintsDecorators",value:function(t,n){var r,o,s=this,u=[],c=function(e,t,n,r,o){u.push({item:e,classNameRef:t,decoration:{range:e.anchor.range,options:(0,i.Z)({description:"InlayHint",showIfCollapsed:e.anchor.range.isEmpty(),collapseOnReplaceEdit:!e.anchor.range.isEmpty(),stickiness:0},e.anchor.direction,{content:n,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:t.className,cursorStops:r,attachedData:o})}})},l=function(e,t){var n=s._ruleFactory.createClassNameRef({width:"".concat(h/3|0,"px"),display:"inline-block"});c(e,n,"\u200a",t?x.RM.Right:x.RM.None)},d=this._getLayoutInfo(),h=d.fontSize,v=d.fontFamily,g="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(g,v);var f,p=(0,a.Z)(n);try{for(p.s();!(f=p.n()).done;){var m=f.value;m.hint.paddingLeft&&l(m,!1);for(var b="string"===typeof m.hint.label?[{label:m.hint.label}]:m.hint.label,C=0;C<b.length;C++){var w=b[C],L=0===C,k=C===b.length-1,_={fontSize:"".concat(h,"px"),fontFamily:"var(".concat(g,"), ").concat(y.hL.fontFamily),verticalAlign:"middle"};this._fillInColors(_,m.hint),(w.command||w.location)&&(null===(r=this._activeInlayHintPart)||void 0===r?void 0:r.item)===m&&this._activeInlayHintPart.index===C&&(_.textDecoration="underline",_.cursor="pointer",_.color=(0,q.EN)(Y._Yy)),L&&k?(_.padding="1px ".concat(0|Math.max(1,h/4),"px"),_.borderRadius="".concat(h/4|0,"px")):L?(_.padding="1px 0 1px ".concat(0|Math.max(1,h/4),"px"),_.borderRadius="".concat(h/4|0,"px 0 0 ").concat(h/4|0,"px")):k?(_.padding="1px ".concat(0|Math.max(1,h/4),"px 1px 0"),_.borderRadius="0 ".concat(h/4|0,"px ").concat(h/4|0,"px 0")):_.padding="1px 0 1px 0",c(m,this._ruleFactory.createClassNameRef(_),ne(w.label),k&&!m.hint.paddingRight?x.RM.Right:x.RM.None,new ee(m,C))}if(m.hint.paddingRight&&l(m,!0),u.length>e._MAX_DECORATORS)break}}catch(P){p.e(P)}finally{p.f()}var S,I=[],N=(0,a.Z)(t);try{for(N.s();!(S=N.n()).done;){var Z,M=S.value,D=(0,a.Z)(null!==(o=this._editor.getDecorationsInRange(M))&&void 0!==o?o:[]);try{for(D.s();!(Z=D.n()).done;){var R=Z.value.id,E=this._decorationsMetadata.get(R);E&&(I.push(R),E.classNameRef.dispose(),this._decorationsMetadata.delete(R))}}catch(P){D.e(P)}finally{D.f()}}}catch(P){N.e(P)}finally{N.f()}for(var T=this._editor.deltaDecorations(I,u.map((function(e){return e.decoration}))),A=0;A<T.length;A++){var O=u[A];this._decorationsMetadata.set(T[A],{item:O.item,classNameRef:O.classNameRef})}}},{key:"_fillInColors",value:function(e,t){t.kind===L.gl.Parameter?(e.backgroundColor=(0,q.EN)(Y.phM),e.color=(0,q.EN)(Y.HCL)):t.kind===L.gl.Type?(e.backgroundColor=(0,q.EN)(Y.bKB),e.color=(0,q.EN)(Y.hX8)):(e.backgroundColor=(0,q.EN)(Y.PpC),e.color=(0,q.EN)(Y.VVv))}},{key:"_getLayoutInfo",value:function(){var e=this._editor.getOption(127),t=this._editor.getOption(46),n=e.fontSize;return(!n||n<5||n>t)&&(n=.9*t|0),{fontSize:n,fontFamily:e.fontFamily||this._editor.getOption(43)}}},{key:"_removeAllDecorations",value:function(){this._editor.deltaDecorations(Array.from(this._decorationsMetadata.keys()),[]);var e,t=(0,a.Z)(this._decorationsMetadata.values());try{for(t.s();!(e=t.n()).done;){e.value.classNameRef.dispose()}}catch(n){t.e(n)}finally{t.f()}this._decorationsMetadata.clear()}}],[{key:"get",value:function(t){var n;return null!==(n=t.getContribution(e.ID))&&void 0!==n?n:void 0}}]),e}();function ne(e){return e.replace(/[ \t]/g,"\xa0")}te.ID="editor.contrib.InlayHints",te._MAX_DECORATORS=1500,te=G([Q(1,_.A),Q(2,$),Q(3,U.Hy),Q(4,W.lT),Q(5,V.TG)],te),(0,C._K)(te.ID,te),U.P0.registerCommand("_executeInlayHintProvider",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return J(void 0,void 0,void 0,l().mark((function t(){var i,r,o,a,s;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n[0],r=n[1],(0,p.p_)(m.o.isUri(i)),(0,p.p_)(w.e.isIRange(r)),t.next=5,e.get(S.S).createModelReference(i);case 5:return o=t.sent,t.prev=6,t.next=9,R.create(o.object.textEditorModel,[w.e.lift(r)],h.T.None);case 9:return a=t.sent,s=a.items.map((function(e){return e.hint})),setTimeout((function(){return a.dispose()}),0),t.abrupt("return",s);case 13:return t.prev=13,o.dispose(),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[6,,13,16]])})))}))},51330:function(e,t,n){n.d(t,{G:function(){return I}});var i=n(43144),r=n(15671),o=n(60136),a=n(43668),s=n(87757),u=n.n(s),c=n(32590),l=n(67277),d=n(10849),h=n(49500),v=n(27959),g=n(51168),f=n(79876),p=n(26777),m=n(25539),b=n(38305),C=n(57195),y=n(64644),w=n(74990),L=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},x=function(e,t){return function(n,i){t(n,i,e)}},k=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(t){o(t)}}function s(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},_=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"===typeof __values?__values(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){(function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)})(i,r,(t=e[n](t)).done,t.value)}))}}},S=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e,i){var o;return(0,r.Z)(this,n),(o=t.call(this,10,i,e.item.anchor.range)).part=e,o}return(0,i.Z)(n)}(g.Y),I=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e,i,o,a,s){var u;return(0,r.Z)(this,n),(u=t.call(this,e,i,o,a))._resolverService=s,u}return(0,i.Z)(n,[{key:"suggestHoverAnchor",value:function(e){var t;if(!C.InlayHintsController.get(this._editor))return null;if(6!==e.target.type)return null;var n=null===(t=e.target.detail.injectedText)||void 0===t?void 0:t.options;return n instanceof v.HS&&n.attachedData instanceof C.RenderedInlayHintLabelPart?new S(n.attachedData,this):null}},{key:"computeSync",value:function(){return[]}},{key:"computeAsync",value:function(e,t,n){var i=this;return e instanceof S?new c.Aq((function(t){return k(i,void 0,void 0,u().mark((function i(){var r,o,a,s,c,d,h,v,g;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a=e.part,i.next=3,a.item.resolve(n);case 3:if(!n.isCancellationRequested){i.next=5;break}return i.abrupt("return");case 5:return"string"===typeof a.item.hint.tooltip?s=(new l.W5).appendText(a.item.hint.tooltip):a.item.hint.tooltip&&(s=a.item.hint.tooltip),s&&t.emitOne(new b.hU(this,e.range,[s],0)),"string"===typeof a.part.tooltip?c=(new l.W5).appendText(a.part.tooltip):a.part.tooltip&&(c=a.part.tooltip),c&&t.emitOne(new b.hU(this,e.range,[c],1)),i.next=11,this._resolveInlayHintLabelPartHover(a,n);case 11:d=i.sent,i.prev=12,h=_(d);case 14:return i.next=16,h.next();case 16:if((v=i.sent).done){i.next=22;break}g=v.value,t.emitOne(g);case 20:i.next=14;break;case 22:i.next=27;break;case 24:i.prev=24,i.t0=i.catch(12),r={error:i.t0};case 27:if(i.prev=27,i.prev=28,!v||v.done||!(o=h.return)){i.next=32;break}return i.next=32,o.call(h);case 32:if(i.prev=32,!r){i.next=35;break}throw r.error;case 35:return i.finish(32);case 36:return i.finish(27);case 37:case"end":return i.stop()}}),i,this,[[12,24,27,37],[28,,32,36]])})))})):c.Aq.EMPTY}},{key:"_resolveInlayHintLabelPartHover",value:function(e,t){return k(this,void 0,void 0,u().mark((function n(){var i,r,o,a,s,v=this;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.part.location){n.next=2;break}return n.abrupt("return",c.Aq.EMPTY);case 2:return i=e.part.location,r=i.uri,o=i.range,n.next=5,this._resolverService.createModelReference(r);case 5:if(a=n.sent,n.prev=6,s=a.object.textEditorModel,h.xp.has(s)){n.next=10;break}return n.abrupt("return",c.Aq.EMPTY);case 10:return n.abrupt("return",(0,m.R8)(s,new d.L(o.startLineNumber,o.startColumn),t).filter((function(e){return!(0,l.CP)(e.hover.contents)})).map((function(t){return new b.hU(v,e.item.anchor.range,t.hover.contents,2+t.ordinal)})));case 11:return n.prev=11,a.dispose(),n.finish(11);case 14:case"end":return n.stop()}}),n,this,[[6,,11,14]])})))}}]),n}(b.D5);I=L([x(1,f.O),x(2,w.v4),x(3,y.Ui),x(4,p.S)],I)},23918:function(e,t,n){n.r(t),n.d(t,{ActiveGhostTextController:function(){return Pe},GhostTextController:function(){return Ae},ShowNextInlineSuggestionAction:function(){return Fe},ShowPreviousInlineSuggestionAction:function(){return Ve},TriggerInlineSuggestionAction:function(){return We},commitInlineSuggestionAction:function(){return He}});var i=n(15671),r=n(43144),o=n(60136),a=n(43668),s=n(87757),u=n.n(s),c=n(10526),l=n(26684),d=n(98351),h=n(34538),v=n(44474),g="editor.action.inlineSuggest.commit",f=n(28941),p=n(10849),m=n(49500),b=n(89125),C=n(37762),y=n(93433),w=n(32590),L=n(32124),x=n(68552),k=n(87020),_=n(15261),S=n(30788),I=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,i.Z)(this,e),this.lineNumber=t,this.parts=n,this.additionalReservedLineCount=r}return(0,r.Z)(e,[{key:"renderForScreenReader",value:function(e){if(0===this.parts.length)return"";var t=this.parts[this.parts.length-1];return function(e,t){var n=new N(e),i=t.map((function(e){var t=S.e.lift(e.range);return{startOffset:n.getOffset(t.getStartPosition()),endOffset:n.getOffset(t.getEndPosition()),text:e.text}}));i.sort((function(e,t){return t.startOffset-e.startOffset}));var r,o=(0,C.Z)(i);try{for(o.s();!(r=o.n()).done;){var a=r.value;e=e.substring(0,a.startOffset)+a.text+e.substring(a.endOffset)}}catch(s){o.e(s)}finally{o.f()}return e}(e.substr(0,t.column-1),this.parts.map((function(e){return{range:{startLineNumber:1,endLineNumber:1,startColumn:e.column,endColumn:e.column},text:e.lines.join("\n")}}))).substring(this.parts[0].column-1)}}]),e}(),N=function(){function e(t){(0,i.Z)(this,e),this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(var n=0;n<t.length;n++)"\n"===t.charAt(n)&&this.lineStartOffsetByLineIdx.push(n+1)}return(0,r.Z)(e,[{key:"getOffset",value:function(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}}]),e}();var Z=(0,r.Z)((function e(t,n,r){(0,i.Z)(this,e),this.column=t,this.lines=n,this.preview=r})),M=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this)).editor=e,r._expanded=void 0,r.onDidChangeEmitter=new f.Q5,r.onDidChange=r.onDidChangeEmitter.event,r._register(e.onDidChangeConfiguration((function(e){e.hasChanged(106)&&void 0===r._expanded&&r.onDidChangeEmitter.fire()}))),r}return(0,r.Z)(n,[{key:"setExpanded",value:function(e){this._expanded=!0,this.onDidChangeEmitter.fire()}}]),n}(c.JT),D=n(89850),R=n(56199);function E(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(e.range.startLineNumber===e.range.endLineNumber){var o=t.getLineContent(e.range.startLineNumber),a=l.V8(o).length,s=e.range.startColumn-1<=a;if(s){var u=l.V8(e.text).length,c=o.substring(e.range.startColumn-1,a),d=S.e.fromPositions(e.range.getStartPosition().delta(0,c.length),e.range.getEndPosition()),h=e.text.startsWith(c)?e.text.substring(c.length):e.text.substring(u);e={range:d,text:h,command:e.command}}var v=t.getValueInRange(e.range),g=A(v,e.text);if(g){var f=e.range.startLineNumber,p=new Array;if("prefix"===n){var m=g.filter((function(e){return 0===e.originalLength}));if(m.length>1||1===m.length&&m[0].originalStart!==v.length)return}var b,y=e.text.length-r,w=(0,C.Z)(g);try{for(w.s();!(b=w.n()).done;){var L=b.value,x=e.range.startColumn+L.originalStart+L.originalLength;if("subwordSmart"===n&&i&&i.lineNumber===e.range.startLineNumber&&x<i.column)return;if(L.originalLength>0)return;if(0!==L.modifiedLength){var k=L.modifiedStart+L.modifiedLength,_=Math.max(L.modifiedStart,Math.min(k,y)),N=e.text.substring(L.modifiedStart,_),M=e.text.substring(_,Math.max(L.modifiedStart,k));if(N.length>0){var D=l.uq(N);p.push(new Z(x,D,!1))}if(M.length>0){var R=l.uq(M);p.push(new Z(x,R,!0))}}}}catch(E){w.e(E)}finally{w.f()}return new I(f,p,0)}}}var T=void 0;function A(e,t){if((null===T||void 0===T?void 0:T.originalValue)===e&&(null===T||void 0===T?void 0:T.newValue)===t)return null===T||void 0===T?void 0:T.changes;var n=function(e,t){if(e.length>5e3||t.length>5e3)return;function n(e){for(var t=0,n=0,i=e.length;n<i;n++){var r=e.charCodeAt(n);r>t&&(t=r)}return t}var i=Math.max(n(e),n(t));function r(e){if(e<0)throw new Error("unexpected");return i+e+1}function o(e){for(var t=0,n=0,i=new Int32Array(e.length),o=0,a=e.length;o<a;o++){var s=100*n+t;"("===e[o]?(i[o]=r(2*s),t++):")"===e[o]?(i[o]=r(2*s+1),1===t&&n++,t=Math.max(t-1,0)):i[o]=e.charCodeAt(o)}return i}var a=o(e),s=o(t);return new R.Hs({getElements:function(){return a}},{getElements:function(){return s}}).ComputeDiff(!1).changes}(e,t);return T={originalValue:e,newValue:t,changes:n},n}var O=n(65396),P=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},U=function(e,t){return function(n,i){t(n,i,e)}},H=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(t){o(t)}}function s(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},F=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e,r,o,a){var s;return(0,i.Z)(this,n),(s=t.call(this)).editor=e,s.cache=r,s.commandService=o,s.languageConfigurationService=a,s.onDidChangeEmitter=new f.Q5,s.onDidChange=s.onDidChangeEmitter.event,s.completionSession=s._register(new c.XK),s.active=!1,s.disposed=!1,s._register(o.onDidExecuteCommand((function(t){new Set([k.CoreEditingCommands.Tab.id,k.CoreEditingCommands.DeleteLeft.id,k.CoreEditingCommands.DeleteRight.id,g,"acceptSelectedSuggestion"]).has(t.commandId)&&e.hasTextFocus()&&s.handleUserInput()}))),s._register(s.editor.onDidType((function(e){s.handleUserInput()}))),s._register(s.editor.onDidChangeCursorPosition((function(e){s.session&&!s.session.isValid&&s.hide()}))),s._register((0,c.OF)((function(){s.disposed=!0}))),s._register(s.editor.onDidBlurEditorWidget((function(){s.hide()}))),s}return(0,r.Z)(n,[{key:"handleUserInput",value:function(){var e=this;this.session&&!this.session.isValid&&this.hide(),setTimeout((function(){e.disposed||e.startSessionIfTriggered()}),0)}},{key:"session",get:function(){return this.completionSession.value}},{key:"ghostText",get:function(){var e;return null===(e=this.session)||void 0===e?void 0:e.ghostText}},{key:"minReservedLineCount",get:function(){return this.session?this.session.minReservedLineCount:0}},{key:"setExpanded",value:function(e){var t;null===(t=this.session)||void 0===t||t.setExpanded(e)}},{key:"setActive",value:function(e){var t;this.active=e,e&&(null===(t=this.session)||void 0===t||t.scheduleAutomaticUpdate())}},{key:"startSessionIfTriggered",value:function(){this.editor.getOption(55).enabled&&(this.session&&this.session.isValid||this.trigger(m.bw.Automatic))}},{key:"trigger",value:function(e){var t=this;this.completionSession.value?e===m.bw.Explicit&&this.completionSession.value.ensureUpdateWithExplicitContext():(this.completionSession.value=new V(this.editor,this.editor.getPosition(),(function(){return t.active}),this.commandService,this.cache,e,this.languageConfigurationService),this.completionSession.value.takeOwnership(this.completionSession.value.onDidChange((function(){t.onDidChangeEmitter.fire()}))))}},{key:"hide",value:function(){this.completionSession.clear(),this.onDidChangeEmitter.fire()}},{key:"commitCurrentSuggestion",value:function(){var e;null===(e=this.session)||void 0===e||e.commitCurrentCompletion()}},{key:"showNext",value:function(){var e;null===(e=this.session)||void 0===e||e.showNextInlineCompletion()}},{key:"showPrevious",value:function(){var e;null===(e=this.session)||void 0===e||e.showPreviousInlineCompletion()}},{key:"hasMultipleInlineCompletions",value:function(){var e;return H(this,void 0,void 0,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.session)||void 0===e?void 0:e.hasMultipleInlineCompletions();case 2:return n=t.sent,t.abrupt("return",void 0!==n&&n);case 4:case"end":return t.stop()}}),t,this)})))}}]),n}(c.JT);F=P([U(2,D.Hy),U(3,b.c_)],F);var V=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e,r,o,a,s,u,l){var d;(0,i.Z)(this,n),(d=t.call(this,e)).triggerPosition=r,d.shouldUpdate=o,d.commandService=a,d.cache=s,d.initialTriggerKind=u,d.languageConfigurationService=l,d.minReservedLineCount=0,d.updateOperation=d._register(new c.XK),d.updateSoon=d._register(new w.pY((function(){var e=d.initialTriggerKind;return d.initialTriggerKind=m.bw.Automatic,d.update(e)}),50)),d.currentlySelectedCompletionId=void 0;var h=void 0;return d._register(d.onDidChange((function(){var e=d.currentCompletion;if(e&&e.sourceInlineCompletion!==h){h=e.sourceInlineCompletion;var t=e.sourceProvider;t.handleItemDidShow&&t.handleItemDidShow(e.sourceInlineCompletions,h)}}))),d._register((0,c.OF)((function(){d.cache.clear()}))),d._register(d.editor.onDidChangeCursorPosition((function(e){d.cache.value&&d.onDidChangeEmitter.fire()}))),d._register(d.editor.onDidChangeModelContent((function(e){d.scheduleAutomaticUpdate()}))),d._register(m.zu.onDidChange((function(){d.updateSoon.schedule()}))),d.scheduleAutomaticUpdate(),d}return(0,r.Z)(n,[{key:"fixAndGetIndexOfCurrentSelection",value:function(){var e=this;if(!this.currentlySelectedCompletionId||!this.cache.value)return 0;if(0===this.cache.value.completions.length)return 0;var t=this.cache.value.completions.findIndex((function(t){return t.semanticId===e.currentlySelectedCompletionId}));return-1===t?(this.currentlySelectedCompletionId=void 0,0):t}},{key:"currentCachedCompletion",get:function(){if(this.cache.value)return this.cache.value.completions[this.fixAndGetIndexOfCurrentSelection()]}},{key:"showNextInlineCompletion",value:function(){var e;return H(this,void 0,void 0,u().mark((function t(){var n,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.ensureUpdateWithExplicitContext();case 2:(n=(null===(e=this.cache.value)||void 0===e?void 0:e.completions)||[]).length>0?(i=(this.fixAndGetIndexOfCurrentSelection()+1)%n.length,this.currentlySelectedCompletionId=n[i].semanticId):this.currentlySelectedCompletionId=void 0,this.onDidChangeEmitter.fire();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"showPreviousInlineCompletion",value:function(){var e;return H(this,void 0,void 0,u().mark((function t(){var n,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.ensureUpdateWithExplicitContext();case 2:(n=(null===(e=this.cache.value)||void 0===e?void 0:e.completions)||[]).length>0?(i=(this.fixAndGetIndexOfCurrentSelection()+n.length-1)%n.length,this.currentlySelectedCompletionId=n[i].semanticId):this.currentlySelectedCompletionId=void 0,this.onDidChangeEmitter.fire();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"ensureUpdateWithExplicitContext",value:function(){var e;return H(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.updateOperation.value){t.next=10;break}if(this.updateOperation.value.triggerKind!==m.bw.Explicit){t.next=6;break}return t.next=4,this.updateOperation.value.promise;case 4:t.next=8;break;case 6:return t.next=8,this.update(m.bw.Explicit);case 8:t.next=13;break;case 10:if((null===(e=this.cache.value)||void 0===e?void 0:e.triggerKind)===m.bw.Explicit){t.next=13;break}return t.next=13,this.update(m.bw.Explicit);case 13:case"end":return t.stop()}}),t,this)})))}},{key:"hasMultipleInlineCompletions",value:function(){var e;return H(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.ensureUpdateWithExplicitContext();case 2:return t.abrupt("return",((null===(e=this.cache.value)||void 0===e?void 0:e.completions.length)||0)>1);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"ghostText",get:function(){var e=this.currentCompletion,t=this.editor.getOptions().get(55).mode;return e?E(e,this.editor.getModel(),t,this.editor.getPosition()):void 0}},{key:"currentCompletion",get:function(){var e=this.currentCachedCompletion;if(e)return e.toLiveInlineCompletion()}},{key:"isValid",get:function(){return this.editor.getPosition().lineNumber===this.triggerPosition.lineNumber}},{key:"scheduleAutomaticUpdate",value:function(){this.updateOperation.clear(),this.updateSoon.schedule()}},{key:"update",value:function(e){return H(this,void 0,void 0,u().mark((function t(){var n,i,r,o=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.shouldUpdate()){t.next=2;break}return t.abrupt("return");case 2:return n=this.editor.getPosition(),i=(0,w.PG)((function(t){return H(o,void 0,void 0,u().mark((function i(){var r;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,B(n,this.editor.getModel(),{triggerKind:e,selectedSuggestionInfo:void 0},t,this.languageConfigurationService);case 3:r=i.sent,i.next=10;break;case 6:return i.prev=6,i.t0=i.catch(0),(0,x.dL)(i.t0),i.abrupt("return");case 10:if(!t.isCancellationRequested){i.next=12;break}return i.abrupt("return");case 12:this.cache.setValue(this.editor,r,e),this.onDidChangeEmitter.fire();case 14:case"end":return i.stop()}}),i,this,[[0,6]])})))})),r=new W(i,e),this.updateOperation.value=r,t.next=8,i;case 8:this.updateOperation.value===r&&this.updateOperation.clear();case 9:case"end":return t.stop()}}),t,this)})))}},{key:"takeOwnership",value:function(e){this._register(e)}},{key:"commitCurrentCompletion",value:function(){if(this.ghostText){var e=this.currentCompletion;e&&this.commit(e)}}},{key:"commit",value:function(e){var t,n=this.cache.clearAndLeak();(this.editor.executeEdits("inlineSuggestion.accept",[_.h.replaceMove(e.range,e.text)]),e.command)?(t=this.commandService).executeCommand.apply(t,[e.command.id].concat((0,y.Z)(e.command.arguments||[]))).finally((function(){null===n||void 0===n||n.dispose()})).then(void 0,x.Cp):null===n||void 0===n||n.dispose();this.onDidChangeEmitter.fire()}}]),n}(M),W=function(){function e(t,n){(0,i.Z)(this,e),this.promise=t,this.triggerKind=n}return(0,r.Z)(e,[{key:"dispose",value:function(){this.promise.cancel()}}]),e}(),K=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e,r,o,a){var s;(0,i.Z)(this,n),(s=t.call(this)).triggerKind=a;var u=e.deltaDecorations([],r.items.map((function(e){return{range:e.range,options:{description:"inline-completion-tracking-range"}}})));return s._register((0,c.OF)((function(){e.deltaDecorations(u,[])}))),s.completions=r.items.map((function(e,t){return new z(e,u[t])})),s._register(e.onDidChangeModelContent((function(){var t,n=!1,i=e.getModel(),r=(0,C.Z)(s.completions);try{for(r.s();!(t=r.n()).done;){var a=t.value,u=i.getDecorationRange(a.decorationId);u?a.synchronizedRange.equalsRange(u)||(n=!0,a.synchronizedRange=u):(0,x.dL)(new Error("Decoration has no range"))}}catch(c){r.e(c)}finally{r.f()}n&&o()}))),s._register(r),s}return(0,r.Z)(n)}(c.JT),z=function(){function e(t,n){(0,i.Z)(this,e),this.inlineCompletion=t,this.decorationId=n,this.semanticId=JSON.stringify({text:this.inlineCompletion.text,startLine:this.inlineCompletion.range.startLineNumber,startColumn:this.inlineCompletion.range.startColumn,command:this.inlineCompletion.command}),this.synchronizedRange=t.range}return(0,r.Z)(e,[{key:"toLiveInlineCompletion",value:function(){return{text:this.inlineCompletion.text,range:this.synchronizedRange,command:this.inlineCompletion.command,sourceProvider:this.inlineCompletion.sourceProvider,sourceInlineCompletions:this.inlineCompletion.sourceInlineCompletions,sourceInlineCompletion:this.inlineCompletion.sourceInlineCompletion}}}]),e}();function j(e,t){var n=t.getWordAtPosition(e),i=t.getLineMaxColumn(e.lineNumber);return n?new S.e(e.lineNumber,n.startColumn,e.lineNumber,i):S.e.fromPositions(e,e.with(void 0,i))}function B(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:L.T.None,r=arguments.length>4?arguments[4]:void 0;return H(this,void 0,void 0,u().mark((function o(){var a,s,c,l,d,h,v,g,f,p,b,w,L,x,k=this;return u().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return a=j(e,t),s=m.zu.all(t),o.next=4,Promise.all(s.map((function(r){return H(k,void 0,void 0,u().mark((function o(){var a;return u().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,r.provideInlineCompletions(t,e,n,i);case 2:return a=o.sent,o.abrupt("return",{completions:a,provider:r,dispose:function(){a&&r.freeInlineCompletions(a)}});case 4:case"end":return o.stop()}}),o)})))})));case 4:c=o.sent,l=new Map,d=(0,C.Z)(c),o.prev=7,d.s();case 9:if((h=d.n()).done){o.next=36;break}if(v=h.value,!(g=v.completions)){o.next=34;break}f=(0,C.Z)(g.items),o.prev=14,f.s();case 16:if((p=f.n()).done){o.next=26;break}if(b=p.value,(w=b.range?S.e.lift(b.range):a).startLineNumber===w.endLineNumber){o.next=21;break}return o.abrupt("continue",24);case 21:L=r&&b.completeBracketPairs?Y(b.text,w.getStartPosition(),t,r):b.text,x={text:L,range:w,command:b.command,sourceProvider:v.provider,sourceInlineCompletions:g,sourceInlineCompletion:b},l.set(JSON.stringify({text:L,range:b.range}),x);case 24:o.next=16;break;case 26:o.next=31;break;case 28:o.prev=28,o.t0=o.catch(14),f.e(o.t0);case 31:return o.prev=31,f.f(),o.finish(31);case 34:o.next=9;break;case 36:o.next=41;break;case 38:o.prev=38,o.t1=o.catch(7),d.e(o.t1);case 41:return o.prev=41,d.f(),o.finish(41);case 44:return o.abrupt("return",{items:(0,y.Z)(l.values()),dispose:function(){var e,t=(0,C.Z)(c);try{for(t.s();!(e=t.n()).done;){e.value.dispose()}}catch(n){t.e(n)}finally{t.f()}}});case 45:case"end":return o.stop()}}),o,null,[[7,38,41,44],[14,28,31,34]])})))}function Y(e,t,n,i){var r=n.getLineContent(t.lineNumber).substring(0,t.column-1)+e,o=n.tokenizeLineWithEdit(t,r.length-(t.column-1),e),a=null===o||void 0===o?void 0:o.sliceAndInflate(t.column-1,r.length,0);return a?(console.log(a),(0,O.r)(a,i)):e}function q(e,t){if(!t)return t;var n=e.getValueInRange(t.range),i=(0,l.Mh)(n,t.text),r=e.getOffsetAt(t.range.getStartPosition())+i,o=e.getPositionAt(r),a=n.substr(i),s=(0,l.P1)(a,t.text),u=e.getPositionAt(Math.max(r,e.getOffsetAt(t.range.getEndPosition())-s));return{range:S.e.fromPositions(o,u),text:t.text.substr(i,t.text.length-i-s)}}var G=n(71881),Q=n(25707),J=n(93011),X=n(14393),$=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e,r){var o;(0,i.Z)(this,n),(o=t.call(this)).editor=e,o.suggestControllerPreselector=r,o.isSuggestWidgetVisible=!1,o.isShiftKeyPressed=!1,o._isActive=!1,o._currentSuggestItemInfo=void 0,o.onDidChangeEmitter=new f.Q5,o.onDidChange=o.onDidChangeEmitter.event,o.setInactiveDelayed=o._register(new w.pY((function(){o.isSuggestWidgetVisible||o._isActive&&(o._isActive=!1,o.onDidChangeEmitter.fire())}),100)),o._register(e.onKeyDown((function(e){e.shiftKey&&!o.isShiftKeyPressed&&(o.isShiftKeyPressed=!0,o.update(o._isActive))}))),o._register(e.onKeyUp((function(e){e.shiftKey&&o.isShiftKeyPressed&&(o.isShiftKeyPressed=!1,o.update(o._isActive))})));var a=X.SuggestController.get(o.editor);if(a){o._register(a.registerSelector({priority:100,select:function(e,t,n){var i=o.editor.getModel(),r=q(i,o.suggestControllerPreselector());if(!r)return-1;var s=p.L.lift(t),u=n.map((function(e,t){var n,u,c=ee(a,s,e,o.isShiftKeyPressed),l=q(i,null===c||void 0===c?void 0:c.normalizedInlineCompletion);if(l)return{index:t,valid:(n=r.range,(u=l.range).startLineNumber===n.startLineNumber&&u.startColumn===n.startColumn&&(u.endLineNumber<n.endLineNumber||u.endLineNumber===n.endLineNumber&&u.endColumn<=n.endColumn)&&r.text.startsWith(l.text)),prefixLength:l.text.length,suggestItem:e}})).filter((function(e){return e&&e.valid})),c=(0,G.Dc)(u,(0,G.tT)((function(e){return e.prefixLength}),G.fv));return c?c.index:-1}}));var s=!1;o._register(f.ju.once(a.model.onDidTrigger)((function(e){s||(s=!0,o._register(a.widget.value.onDidShow((function(){o.isSuggestWidgetVisible=!0,o.update(!0)}))),o._register(a.widget.value.onDidHide((function(){o.isSuggestWidgetVisible=!1,o.setInactiveDelayed.schedule(),o.update(o._isActive)}))),o._register(a.widget.value.onDidFocus((function(){o.isSuggestWidgetVisible=!0,o.update(!0)}))))})))}return o.update(o._isActive),o}return(0,r.Z)(n,[{key:"state",get:function(){if(this._isActive)return{selectedItem:this._currentSuggestItemInfo}}},{key:"update",value:function(e){var t=this.getSuggestItemInfo(),n=!1;(function(e,t){if(e===t)return!0;if(!e||!t)return!1;return e.completionItemKind===t.completionItemKind&&e.isSnippetText===t.isSnippetText&&function(e,t){return e===t||!(!e||!t)&&e.range.equalsRange(t.range)&&e.text===t.text&&e.command===t.command}(e.normalizedInlineCompletion,t.normalizedInlineCompletion)})(this._currentSuggestItemInfo,t)||(this._currentSuggestItemInfo=t,n=!0),this._isActive!==e&&(this._isActive=e,n=!0),n&&this.onDidChangeEmitter.fire()}},{key:"getSuggestItemInfo",value:function(){var e=X.SuggestController.get(this.editor);if(e&&this.isSuggestWidgetVisible){var t=e.widget.value.getFocusedItem();if(t)return ee(e,this.editor.getPosition(),t.item,this.isShiftKeyPressed)}}},{key:"stopForceRenderingAbove",value:function(){var e=X.SuggestController.get(this.editor);e&&e.stopForceRenderingAbove()}},{key:"forceRenderingAbove",value:function(){var e=X.SuggestController.get(this.editor);e&&e.forceRenderingAbove()}}]),n}(c.JT);function ee(e,t,n,i){if(Array.isArray(n.completion.additionalTextEdits)&&n.completion.additionalTextEdits.length>0)return{completionItemKind:n.completion.kind,isSnippetText:!1,normalizedInlineCompletion:{range:S.e.fromPositions(t,t),text:""}};var r=n.completion.insertText,o=!1;if(4&n.completion.insertTextRules){var a=(new Q.Yj).parse(r),s=e.editor.getModel();if(a.children.length>100)return;J.l.adjustWhitespace(s,t,a,!0,!0),r=a.toString(),o=!0}var u=e.getOverwriteInfo(n,i);return{isSnippetText:o,completionItemKind:n.completion.kind,normalizedInlineCompletion:{text:r,range:S.e.fromPositions(t.delta(0,-u.overwriteBefore),t.delta(0,Math.max(u.overwriteAfter,0)))}}}var te=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(t){o(t)}}function s(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},ne=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e,r){var o;return(0,i.Z)(this,n),(o=t.call(this,e)).cache=r,o.suggestionInlineCompletionSource=o._register(new $(o.editor,(function(){var e,t;return null===(t=null===(e=o.cache.value)||void 0===e?void 0:e.completions[0])||void 0===t?void 0:t.toLiveInlineCompletion()}))),o.updateOperation=o._register(new c.XK),o.updateCacheSoon=o._register(new w.pY((function(){return o.updateCache()}),50)),o.minReservedLineCount=0,o._register(o.suggestionInlineCompletionSource.onDidChange((function(){o.updateCacheSoon.schedule(),o.suggestionInlineCompletionSource.state||(o.minReservedLineCount=0);var e=o.ghostText;e&&(o.minReservedLineCount=Math.max(o.minReservedLineCount,e.parts.map((function(e){return e.lines.length-1})).reduce((function(e,t){return e+t}),0))),o.minReservedLineCount>=1?o.suggestionInlineCompletionSource.forceRenderingAbove():o.suggestionInlineCompletionSource.stopForceRenderingAbove(),o.onDidChangeEmitter.fire()}))),o._register(o.cache.onDidChange((function(){o.onDidChangeEmitter.fire()}))),o._register(o.editor.onDidChangeCursorPosition((function(e){o.minReservedLineCount=0,o.updateCacheSoon.schedule(),o.onDidChangeEmitter.fire()}))),o._register((0,c.OF)((function(){return o.suggestionInlineCompletionSource.stopForceRenderingAbove()}))),o}return(0,r.Z)(n,[{key:"isActive",get:function(){return void 0!==this.suggestionInlineCompletionSource.state}},{key:"isSuggestionPreviewEnabled",value:function(){return this.editor.getOption(106).preview}},{key:"updateCache",value:function(){return te(this,void 0,void 0,u().mark((function e(){var t,n,i,r,o,a=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.suggestionInlineCompletionSource.state)&&t.selectedItem){e.next=3;break}return e.abrupt("return");case 3:return n={text:t.selectedItem.normalizedInlineCompletion.text,range:t.selectedItem.normalizedInlineCompletion.range,isSnippetText:t.selectedItem.isSnippetText,completionKind:t.selectedItem.completionItemKind},i=this.editor.getPosition(),r=(0,w.PG)((function(e){return te(a,void 0,void 0,u().mark((function t(){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,B(i,this.editor.getModel(),{triggerKind:m.bw.Automatic,selectedSuggestionInfo:n},e);case 3:r=t.sent,t.next=10;break;case 6:return t.prev=6,t.t0=t.catch(0),(0,x.dL)(t.t0),t.abrupt("return");case 10:if(!e.isCancellationRequested){t.next=12;break}return t.abrupt("return");case 12:this.cache.setValue(this.editor,r,m.bw.Automatic),this.onDidChangeEmitter.fire();case 14:case"end":return t.stop()}}),t,this,[[0,6]])})))})),o=new W(r,m.bw.Automatic),this.updateOperation.value=o,e.next=10,r;case 10:this.updateOperation.value===o&&this.updateOperation.clear();case 11:case"end":return e.stop()}}),e,this)})))}},{key:"ghostText",get:function(){var e,t,n,i=this.isSuggestionPreviewEnabled(),r=q(this.editor.getModel(),null===(t=null===(e=this.cache.value)||void 0===e?void 0:e.completions[0])||void 0===t?void 0:t.toLiveInlineCompletion()),o=this.suggestionInlineCompletionSource.state,a=q(this.editor.getModel(),null===(n=null===o||void 0===o?void 0:o.selectedItem)||void 0===n?void 0:n.normalizedInlineCompletion),s=r&&a&&r.text.startsWith(a.text)&&r.range.equalsRange(a.range);if(i||s){var u=s?r:a||r,c=s?u.text.length-a.text.length:0;return this.toGhostText(u,c)}}},{key:"toGhostText",value:function(e,t){var n=this.editor.getOptions().get(106).previewMode;return e?E(e,this.editor.getModel(),n,this.editor.getPosition(),t)||new I(e.range.endLineNumber,[],this.minReservedLineCount):void 0}}]),n}(M);var ie=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},re=function(e,t){return function(n,i){t(n,i,e)}},oe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(t){o(t)}}function s(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},ae=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(){var e;return(0,i.Z)(this,n),(e=t.apply(this,arguments)).onDidChangeEmitter=new f.Q5,e.onDidChange=e.onDidChangeEmitter.event,e.hasCachedGhostText=!1,e.currentModelRef=e._register(new c.XK),e}return(0,r.Z)(n,[{key:"targetModel",get:function(){var e;return null===(e=this.currentModelRef.value)||void 0===e?void 0:e.object}},{key:"setTargetModel",value:function(e){var t,n,i,r=this;(null===(t=this.currentModelRef.value)||void 0===t?void 0:t.object)!==e&&(this.currentModelRef.clear(),this.currentModelRef.value=e?(n=e,i=e.onDidChange((function(){r.hasCachedGhostText=!1,r.onDidChangeEmitter.fire()})),{object:n,dispose:function(){return null===i||void 0===i?void 0:i.dispose()}}):void 0,this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire())}},{key:"ghostText",get:function(){var e,t;return this.hasCachedGhostText||(this.cachedGhostText=null===(t=null===(e=this.currentModelRef.value)||void 0===e?void 0:e.object)||void 0===t?void 0:t.ghostText,this.hasCachedGhostText=!0),this.cachedGhostText}},{key:"setExpanded",value:function(e){var t;null===(t=this.targetModel)||void 0===t||t.setExpanded(e)}},{key:"minReservedLineCount",get:function(){return this.targetModel?this.targetModel.minReservedLineCount:0}}]),n}(c.JT),se=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e,r,o){var a;return(0,i.Z)(this,n),(a=t.call(this)).editor=e,a.commandService=r,a.languageConfigurationService=o,a.sharedCache=a._register(new ce),a.suggestWidgetAdapterModel=a._register(new ne(a.editor,a.sharedCache)),a.inlineCompletionsModel=a._register(new F(a.editor,a.sharedCache,a.commandService,a.languageConfigurationService)),a._register(a.suggestWidgetAdapterModel.onDidChange((function(){a.updateModel()}))),a.updateModel(),a}return(0,r.Z)(n,[{key:"activeInlineCompletionsModel",get:function(){if(this.targetModel===this.inlineCompletionsModel)return this.inlineCompletionsModel}},{key:"updateModel",value:function(){this.setTargetModel(this.suggestWidgetAdapterModel.isActive?this.suggestWidgetAdapterModel:this.inlineCompletionsModel),this.inlineCompletionsModel.setActive(this.targetModel===this.inlineCompletionsModel)}},{key:"shouldShowHoverAt",value:function(e){var t,n=null===(t=this.activeInlineCompletionsModel)||void 0===t?void 0:t.ghostText;return!!n&&n.parts.some((function(t){return e.containsPosition(new p.L(n.lineNumber,t.column))}))}},{key:"triggerInlineCompletion",value:function(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.trigger(m.bw.Explicit)}},{key:"commitInlineCompletion",value:function(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.commitCurrentSuggestion()}},{key:"hideInlineCompletion",value:function(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.hide()}},{key:"showNextInlineCompletion",value:function(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.showNext()}},{key:"showPreviousInlineCompletion",value:function(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.showPrevious()}},{key:"hasMultipleInlineCompletions",value:function(){var e;return oe(this,void 0,void 0,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.activeInlineCompletionsModel)||void 0===e?void 0:e.hasMultipleInlineCompletions();case 2:return n=t.sent,t.abrupt("return",void 0!==n&&n);case 4:case"end":return t.stop()}}),t,this)})))}}]),n}(ae);se=ie([re(1,D.Hy),re(2,b.c_)],se);var ue,ce=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(){var e;return(0,i.Z)(this,n),(e=t.apply(this,arguments)).onDidChangeEmitter=new f.Q5,e.onDidChange=e.onDidChangeEmitter.event,e.cache=e._register(new c.XK),e}return(0,r.Z)(n,[{key:"value",get:function(){return this.cache.value}},{key:"setValue",value:function(e,t,n){var i=this;this.cache.value=new K(e,t,(function(){return i.onDidChangeEmitter.fire()}),n)}},{key:"clearAndLeak",value:function(){return this.cache.clearAndLeak()}},{key:"clear",value:function(){this.cache.clear()}}]),n}(c.JT),le=n(97326),de=n(53210),he=n(6815),ve=n(31492),ge=n(58705),fe=n(63633),pe=n(79876),me=n(2374),be=n(50381),Ce=n(78699),ye=n(8850),we=n(3553),Le=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},xe=function(e,t){return function(n,i){t(n,i,e)}},ke=null===(ue=window.trustedTypes)||void 0===ue?void 0:ue.createPolicy("editorGhostText",{createHTML:function(e){return e}}),_e=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e,r,o,a){var s;return(0,i.Z)(this,n),(s=t.call(this)).editor=e,s.model=r,s.instantiationService=o,s.languageService=a,s.disposed=!1,s.partsWidget=s._register(s.instantiationService.createInstance(Se,s.editor)),s.additionalLinesWidget=s._register(new Ie(s.editor,s.languageService.languageIdCodec)),s.viewMoreContentWidget=void 0,s._register(s.editor.onDidChangeConfiguration((function(e){(e.hasChanged(29)||e.hasChanged(105)||e.hasChanged(88)||e.hasChanged(83)||e.hasChanged(45)||e.hasChanged(44)||e.hasChanged(59))&&s.update()}))),s._register((0,c.OF)((function(){var e;s.disposed=!0,s.update(),null===(e=s.viewMoreContentWidget)||void 0===e||e.dispose(),s.viewMoreContentWidget=void 0}))),s._register(r.onDidChange((function(){s.update()}))),s.update(),s}return(0,r.Z)(n,[{key:"shouldShowHoverAtViewZone",value:function(e){return this.additionalLinesWidget.viewZoneId===e}},{key:"update",value:function(){var e,t=this.model.ghostText;if(!this.editor.hasModel()||!t||this.disposed)return this.partsWidget.clear(),void this.additionalLinesWidget.clear();var n=new Array,i=new Array;function r(e,t){if(i.length>0){var n=i[i.length-1];t&&n.decorations.push(new be.Kp(n.content.length+1,n.content.length+1+e[0].length,t,0)),n.content+=e[0],e=e.slice(1)}var r,o=(0,C.Z)(e);try{for(o.s();!(r=o.n()).done;){var a=r.value;i.push({content:a,decorations:t?[new be.Kp(1,a.length+1,t,0)]:[]})}}catch(s){o.e(s)}finally{o.f()}}var o=this.editor.getModel().getLineContent(t.lineNumber);this.editor.getModel().getLineTokens(t.lineNumber);var a,s=void 0,u=0,c=(0,C.Z)(t.parts);try{for(c.s();!(a=c.n()).done;){var l=a.value,d=l.lines;void 0===s?(n.push({column:l.column,text:d[0],preview:l.preview}),d=d.slice(1)):r([o.substring(u,l.column-1)],void 0),d.length>0&&(r(d,"ghost-text"),void 0===s&&l.column<=o.length&&(s=l.column)),u=l.column-1}}catch(h){c.e(h)}finally{c.f()}void 0!==s&&r([o.substring(u)],void 0),this.partsWidget.setParts(t.lineNumber,n,void 0!==s?{column:s,length:o.length+1-s}:void 0),this.additionalLinesWidget.updateLines(t.lineNumber,i,t.additionalReservedLineCount),t.parts.some((function(e){return e.lines.length<0}))?this.viewMoreContentWidget=this.renderViewMoreLines(new p.L(t.lineNumber,this.editor.getModel().getLineMaxColumn(t.lineNumber)),"",0):(null===(e=this.viewMoreContentWidget)||void 0===e||e.dispose(),this.viewMoreContentWidget=void 0)}},{key:"renderViewMoreLines",value:function(e,t,n){var i=this,r=this.editor.getOption(44),o=document.createElement("div");o.className="suggest-preview-additional-widget",(0,he.N)(o,r);var a=document.createElement("span");a.className="content-spacer",a.append(t),o.append(a);var s=document.createElement("span");s.className="content-newline suggest-preview-text",s.append("\u23ce  "),o.append(s);var u=new c.SL,l=document.createElement("div");return l.className="button suggest-preview-text",l.append("+".concat(n," lines\u2026")),u.add(de.addStandardDisposableListener(l,"mousedown",(function(e){var t;null===(t=i.model)||void 0===t||t.setExpanded(!0),e.preventDefault(),i.editor.focus()}))),o.append(l),new Ne(this.editor,e,o,u)}}]),n}(c.JT);_e=Le([xe(2,ye.TG),xe(3,pe.O)],_e);var Se=function(){function e(t){(0,i.Z)(this,e),this.editor=t,this.decorationIds=[],this.disposableStore=new c.SL}return(0,r.Z)(e,[{key:"dispose",value:function(){this.clear(),this.disposableStore.dispose()}},{key:"clear",value:function(){this.editor.deltaDecorations(this.decorationIds,[]),this.disposableStore.clear()}},{key:"setParts",value:function(e,t,n){if(this.disposableStore.clear(),this.editor.getModel()){var i=new Array;n&&i.push({range:S.e.fromPositions(new p.L(e,n.column),new p.L(e,n.column+n.length)),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}}),this.decorationIds=this.editor.deltaDecorations(this.decorationIds,t.map((function(t){return{range:S.e.fromPositions(new p.L(e,t.column)),options:{description:"ghost-text",after:{content:t.text,inlineClassName:t.preview?"ghost-text-decoration-preview":"ghost-text-decoration"},showIfCollapsed:!0}}})).concat(i))}}}]),e}(),Ie=function(){function e(t,n){(0,i.Z)(this,e),this.editor=t,this.languageIdCodec=n,this._viewZoneId=void 0}return(0,r.Z)(e,[{key:"viewZoneId",get:function(){return this._viewZoneId}},{key:"dispose",value:function(){this.clear()}},{key:"clear",value:function(){var e=this;this.editor.changeViewZones((function(t){e._viewZoneId&&(t.removeZone(e._viewZoneId),e._viewZoneId=void 0)}))}},{key:"updateLines",value:function(e,t,n){var i=this,r=this.editor.getModel();if(r){var o=r.getOptions().tabSize;this.editor.changeViewZones((function(r){i._viewZoneId&&(r.removeZone(i._viewZoneId),i._viewZoneId=void 0);var a=Math.max(t.length,n);if(a>0){var s=document.createElement("div");!function(e,t,n,i,r){var o=i.get(29),a=i.get(105),s="none",u=i.get(83),c=i.get(45),d=i.get(44),h=i.get(59),v=(0,fe.l$)(1e4);v.appendASCIIString('<div class="suggest-preview-text">');for(var g=0,f=n.length;g<f;g++){var p=n[g],m=p.content;v.appendASCIIString('<div class="view-line'),v.appendASCIIString('" style="top:'),v.appendASCIIString(String(g*h)),v.appendASCIIString('px;width:1000000px;">');var b=l.$i(m),C=l.Ut(m),y=ge.A.createEmpty(m,r);(0,Ce.d1)(new Ce.IJ(d.isMonospace&&!o,d.canUseHalfwidthRightwardsArrow,m,!1,b,C,0,y,p.decorations,t,0,d.spaceWidth,d.middotWidth,d.wsmiddotWidth,a,s,u,c!==ve.n0.OFF,null),v),v.appendASCIIString("</div>")}v.appendASCIIString("</div>"),(0,he.N)(e,d);var w=v.build(),L=ke?ke.createHTML(w):w;e.innerHTML=L}(s,o,t,i.editor.getOptions(),i.languageIdCodec),i._viewZoneId=r.addZone({afterLineNumber:e,heightInLines:a,domNode:s,afterColumnAffinity:1})}}))}}}]),e}();var Ne=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e,r,o,a){var s;return(0,i.Z)(this,n),(s=t.call(this)).editor=e,s.position=r,s.domNode=o,s.allowEditorOverflow=!1,s.suppressMouseDown=!1,s._register(a),s._register((0,c.OF)((function(){s.editor.removeContentWidget((0,le.Z)(s))}))),s.editor.addContentWidget((0,le.Z)(s)),s}return(0,r.Z)(n,[{key:"getId",value:function(){return"editor.widget.viewMoreLinesWidget"}},{key:"getDomNode",value:function(){return this.domNode}},{key:"getPosition",value:function(){return{position:this.position,preference:[0]}}}]),n}(c.JT);(0,we.Ic)((function(e,t){var n=e.getColor(me.N5);n&&(t.addRule(".monaco-editor .ghost-text-decoration { color: ".concat(n.toString()," !important; }")),t.addRule(".monaco-editor .ghost-text-decoration-preview { color: ".concat(n.toString()," !important; }")),t.addRule(".monaco-editor .suggest-preview-text .ghost-text { color: ".concat(n.toString()," !important; }")));var i=e.getColor(me.IO);i&&(t.addRule(".monaco-editor .ghost-text-decoration { background-color: ".concat(i.toString(),"; }")),t.addRule(".monaco-editor .ghost-text-decoration-preview { background-color: ".concat(i.toString(),"; }")),t.addRule(".monaco-editor .suggest-preview-text .ghost-text { background-color: ".concat(i.toString(),"; }")));var r=e.getColor(me.x3);r&&(t.addRule(".monaco-editor .suggest-preview-text .ghost-text { border: 1px solid ".concat(r,"; }")),t.addRule(".monaco-editor .ghost-text-decoration { border: 1px solid ".concat(r,"; }")),t.addRule(".monaco-editor .ghost-text-decoration-preview { border: 1px solid ".concat(r,"; }")))}));var Ze=n(87697),Me=n(49525),De=n(90031),Re=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Ee=function(e,t){return function(n,i){t(n,i,e)}},Te=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(t){o(t)}}function s(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},Ae=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e,r){var o;return(0,i.Z)(this,n),(o=t.call(this)).editor=e,o.instantiationService=r,o.triggeredExplicitly=!1,o.activeController=o._register(new c.XK),o._register(o.editor.onDidChangeModel((function(){o.updateModelController()}))),o._register(o.editor.onDidChangeConfiguration((function(e){e.hasChanged(106)&&o.updateModelController(),e.hasChanged(55)&&o.updateModelController()}))),o.updateModelController(),o}return(0,r.Z)(n,[{key:"activeModel",get:function(){var e;return null===(e=this.activeController.value)||void 0===e?void 0:e.model}},{key:"updateModelController",value:function(){var e=this.editor.getOption(106),t=this.editor.getOption(55);this.activeController.value=void 0,this.activeController.value=this.editor.hasModel()&&(e.preview||t.enabled||this.triggeredExplicitly)?this.instantiationService.createInstance(Pe,this.editor):void 0}},{key:"shouldShowHoverAt",value:function(e){var t;return(null===(t=this.activeModel)||void 0===t?void 0:t.shouldShowHoverAt(e))||!1}},{key:"shouldShowHoverAtViewZone",value:function(e){var t,n;return(null===(n=null===(t=this.activeController.value)||void 0===t?void 0:t.widget)||void 0===n?void 0:n.shouldShowHoverAtViewZone(e))||!1}},{key:"trigger",value:function(){var e;this.triggeredExplicitly=!0,this.activeController.value||this.updateModelController(),null===(e=this.activeModel)||void 0===e||e.triggerInlineCompletion()}},{key:"commit",value:function(){var e;null===(e=this.activeModel)||void 0===e||e.commitInlineCompletion()}},{key:"hide",value:function(){var e;null===(e=this.activeModel)||void 0===e||e.hideInlineCompletion()}},{key:"showNextInlineCompletion",value:function(){var e;null===(e=this.activeModel)||void 0===e||e.showNextInlineCompletion()}},{key:"showPreviousInlineCompletion",value:function(){var e;null===(e=this.activeModel)||void 0===e||e.showPreviousInlineCompletion()}},{key:"hasMultipleInlineCompletions",value:function(){var e;return Te(this,void 0,void 0,u().mark((function t(){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null===(e=this.activeModel)||void 0===e?void 0:e.hasMultipleInlineCompletions();case 2:return n=t.sent,t.abrupt("return",void 0!==n&&n);case 4:case"end":return t.stop()}}),t,this)})))}}],[{key:"get",value:function(e){return e.getContribution(n.ID)}}]),n}(c.JT);Ae.inlineSuggestionVisible=new Me.uy("inlineSuggestionVisible",!1,Ze.N("inlineSuggestionVisible","Whether an inline suggestion is visible")),Ae.inlineSuggestionHasIndentation=new Me.uy("inlineSuggestionHasIndentation",!1,Ze.N("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace")),Ae.inlineSuggestionHasIndentationLessThanTabSize=new Me.uy("inlineSuggestionHasIndentationLessThanTabSize",!0,Ze.N("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab")),Ae.ID="editor.contrib.ghostTextController",Ae=Re([Ee(1,ye.TG)],Ae);var Oe=(0,r.Z)((function e(t){(0,i.Z)(this,e),this.contextKeyService=t,this.inlineCompletionVisible=Ae.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=Ae.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=Ae.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService)})),Pe=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(e,r,o){var a;return(0,i.Z)(this,n),(a=t.call(this)).editor=e,a.instantiationService=r,a.contextKeyService=o,a.contextKeys=new Oe(a.contextKeyService),a.model=a._register(a.instantiationService.createInstance(se,a.editor)),a.widget=a._register(a.instantiationService.createInstance(_e,a.editor,a.model)),a._register((0,c.OF)((function(){a.contextKeys.inlineCompletionVisible.set(!1),a.contextKeys.inlineCompletionSuggestsIndentation.set(!1),a.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(!0)}))),a._register(a.model.onDidChange((function(){a.updateContextKeys()}))),a.updateContextKeys(),a}return(0,r.Z)(n,[{key:"updateContextKeys",value:function(){var e;this.contextKeys.inlineCompletionVisible.set(void 0!==(null===(e=this.model.activeInlineCompletionsModel)||void 0===e?void 0:e.ghostText));var t=!1,n=!0,i=this.model.inlineCompletionsModel.ghostText;if(this.model.activeInlineCompletionsModel&&i&&i.parts.length>0){var r=i.parts[0],o=r.column,a=r.lines[0];if(o<=this.editor.getModel().getLineIndentColumn(i.lineNumber)){var s=(0,l.LC)(a);-1===s&&(s=a.length-1),t=s>0;var u=this.editor.getModel().getOptions().tabSize;n=h.i.visibleColumnFromColumn(a,s+1,u)<u}}this.contextKeys.inlineCompletionSuggestsIndentation.set(t),this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(n)}}]),n}(c.JT);Pe=Re([Ee(1,ye.TG),Ee(2,Me.i6)],Pe);var Ue=d._l.bindToContribution(Ae.get),He=new Ue({id:g,precondition:Ae.inlineSuggestionVisible,handler:function(e){e.commit(),e.editor.focus()}});(0,d.fK)(He),De.W.registerKeybindingRule({primary:2,weight:200,id:He.id,when:Me.Ao.and(He.precondition,v.u.tabMovesFocus.toNegated(),Ae.inlineSuggestionHasIndentationLessThanTabSize)}),(0,d.fK)(new Ue({id:"editor.action.inlineSuggest.hide",precondition:Ae.inlineSuggestionVisible,kbOpts:{weight:100,primary:9},handler:function(e){e.hide()}}));var Fe=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(){return(0,i.Z)(this,n),t.call(this,{id:n.ID,label:Ze.N("action.inlineSuggest.showNext","Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:Me.Ao.and(v.u.writable,Ae.inlineSuggestionVisible),kbOpts:{weight:100,primary:601}})}return(0,r.Z)(n,[{key:"run",value:function(e,t){return Te(this,void 0,void 0,u().mark((function e(){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=Ae.get(t))&&(n.showNextInlineCompletion(),t.focus());case 2:case"end":return e.stop()}}),e)})))}}]),n}(d.R6);Fe.ID="editor.action.inlineSuggest.showNext";var Ve=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(){return(0,i.Z)(this,n),t.call(this,{id:n.ID,label:Ze.N("action.inlineSuggest.showPrevious","Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:Me.Ao.and(v.u.writable,Ae.inlineSuggestionVisible),kbOpts:{weight:100,primary:599}})}return(0,r.Z)(n,[{key:"run",value:function(e,t){return Te(this,void 0,void 0,u().mark((function e(){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=Ae.get(t))&&(n.showPreviousInlineCompletion(),t.focus());case 2:case"end":return e.stop()}}),e)})))}}]),n}(d.R6);Ve.ID="editor.action.inlineSuggest.showPrevious";var We=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(){return(0,i.Z)(this,n),t.call(this,{id:"editor.action.inlineSuggest.trigger",label:Ze.N("action.inlineSuggest.trigger","Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:v.u.writable})}return(0,r.Z)(n,[{key:"run",value:function(e,t){return Te(this,void 0,void 0,u().mark((function e(){var n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=Ae.get(t))&&n.trigger();case 2:case"end":return e.stop()}}),e)})))}}]),n}(d.R6);(0,d._K)(Ae.ID,Ae),(0,d.Qr)(We),(0,d.Qr)(Fe),(0,d.Qr)(Ve)},48479:function(e,t,n){n.d(t,{l:function(){return k}});var i=n(29439),r=n(37762),o=n(15671),a=n(43144),s=n(53210),u=n(67277),c=n(10526),l=n(65163),d=n(30788),h=n(79876),v=n(51168),g=n(23918),f=n(87697),p=n(99277),m=n(23911),b=n(89850),C=n(49525),y=n(74990),w=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},L=function(e,t){return function(n,i){t(n,i,e)}},x=function(){function e(t,n,i){(0,o.Z)(this,e),this.owner=t,this.range=n,this.controller=i}return(0,a.Z)(e,[{key:"isValidForHoverAnchor",value:function(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}},{key:"hasMultipleSuggestions",value:function(){return this.controller.hasMultipleInlineCompletions()}}]),e}(),k=function(){function e(t,n,i,r,a,s,u){(0,o.Z)(this,e),this._editor=t,this._commandService=n,this._menuService=i,this._contextKeyService=r,this._languageService=a,this._openerService=s,this.accessibilityService=u}return(0,a.Z)(e,[{key:"suggestHoverAnchor",value:function(e){var t=g.GhostTextController.get(this._editor);if(!t)return null;var n=e.target;if(8===n.type){var i=n.detail;if(t.shouldShowHoverAtViewZone(i.viewZoneId))return new v.Y(1e3,this,d.e.fromPositions(i.positionBefore||i.position,i.positionBefore||i.position))}if(7===n.type&&t.shouldShowHoverAt(n.range))return new v.Y(1e3,this,n.range);if(6===n.type&&(n.detail.mightBeForeignElement&&t.shouldShowHoverAt(n.range)))return new v.Y(1e3,this,n.range);return null}},{key:"computeSync",value:function(e,t){var n=g.GhostTextController.get(this._editor);return n&&n.shouldShowHoverAt(e.range)?[new x(this,e.range,n)]:[]}},{key:"renderHoverParts",value:function(e,t){var n=this,o=new c.SL,a=t[0];this.accessibilityService.isScreenReaderOptimized()&&this.renderScreenReaderText(e,a,o);var s=o.add(this._menuService.createMenu(m.eH.InlineCompletionsActions,this._contextKeyService)),u=e.statusBar.addAction({label:f.N("showNextInlineSuggestion","Next"),commandId:g.ShowNextInlineSuggestionAction.ID,run:function(){return n._commandService.executeCommand(g.ShowNextInlineSuggestionAction.ID)}}),l=e.statusBar.addAction({label:f.N("showPreviousInlineSuggestion","Previous"),commandId:g.ShowPreviousInlineSuggestionAction.ID,run:function(){return n._commandService.executeCommand(g.ShowPreviousInlineSuggestionAction.ID)}});e.statusBar.addAction({label:f.N("acceptInlineSuggestion","Accept"),commandId:g.commitInlineSuggestionAction.id,run:function(){return n._commandService.executeCommand(g.commitInlineSuggestionAction.id)}});for(var d=[u,l],h=0,v=d;h<v.length;h++){v[h].setEnabled(!1)}a.hasMultipleSuggestions().then((function(e){var t,n=(0,r.Z)(d);try{for(n.s();!(t=n.n()).done;){t.value.setEnabled(e)}}catch(i){n.e(i)}finally{n.f()}}));var p,b=(0,r.Z)(s.getActions());try{for(b.s();!(p=b.n()).done;){var C,y=(0,i.Z)(p.value,2),w=(y[0],y[1]),L=(0,r.Z)(w);try{var x=function(){var t=C.value;t instanceof m.U8&&e.statusBar.addAction({label:t.label,commandId:t.item.id,run:function(){return n._commandService.executeCommand(t.item.id)}})};for(L.s();!(C=L.n()).done;)x()}catch(k){L.e(k)}finally{L.f()}}}catch(k){b.e(k)}finally{b.f()}return o}},{key:"renderScreenReaderText",value:function(e,t,n){var i,r,o=s.$,a=o("div.hover-row.markdown-hover"),c=s.append(a,o("div.hover-contents")),d=n.add(new l.$({editor:this._editor},this._languageService,this._openerService)),h=null===(r=null===(i=t.controller.activeModel)||void 0===i?void 0:i.inlineCompletionsModel)||void 0===r?void 0:r.ghostText;if(h){var v=this._editor.getModel().getLineContent(h.lineNumber);!function(t){n.add(d.onDidRenderAsync((function(){c.className="hover-contents code-hover-contents",e.onContentsChanged()})));var i=f.N("inlineSuggestionFollows","Suggestion:"),r=n.add(d.render((new u.W5).appendText(i).appendCodeblock("text",t)));c.replaceChildren(r.element)}(h.renderForScreenReader(v))}e.fragment.appendChild(a)}}]),e}();k=w([L(1,b.Hy),L(2,m.co),L(3,C.i6),L(4,h.O),L(5,y.v4),L(6,p.F)],k)},5514:function(e,t,n){n.r(t),n.d(t,{ExpandLineSelectionAction:function(){return d}});var i=n(15671),r=n(43144),o=n(60136),a=n(43668),s=n(98351),u=n(4614),c=n(44474),l=n(87697),d=function(e){(0,o.Z)(n,e);var t=(0,a.Z)(n);function n(){return(0,i.Z)(this,n),t.call(this,{id:"expandLineSelection",label:l.N("expandLineSelection","Expand Line Selection"),alias:"Expand Line Selection",precondition:void 0,kbOpts:{weight:0,kbExpr:c.u.textInputFocus,primary:2090}})}return(0,r.Z)(n,[{key:"run",value:function(e,t,n){if(n=n||{},t.hasModel()){var i=t._getViewModel();i.model.pushStackElement(),i.setCursorStates(n.source,3,u.P.expandLineSelection(i,i.getCursorStates())),i.revealPrimaryCursor(n.source,!0)}}}]),n}(s.R6);(0,s.Qr)(d)},56189:function(e,t,n){n.r(t),n.d(t,{AbstractCaseAction:function(){return X},AbstractDeleteAllToBoundaryAction:function(){return Y},AbstractSortLinesAction:function(){return P},DeleteAllLeftAction:function(){return q},DeleteAllRightAction:function(){return G},DeleteDuplicateLinesAction:function(){return F},DeleteLinesAction:function(){return W},DuplicateSelectionAction:function(){return E},IndentLinesAction:function(){return K},InsertLineAfterAction:function(){return B},InsertLineBeforeAction:function(){return j},JoinLinesAction:function(){return Q},LowerCaseAction:function(){return ee},SnakeCaseAction:function(){return ie},SortLinesAscendingAction:function(){return U},SortLinesDescendingAction:function(){return H},TitleCaseAction:function(){return ne},TransposeAction:function(){return J},TrimTrailingWhitespaceAction:function(){return V},UpperCaseAction:function(){return $}});var i=n(37762),r=n(15671),o=n(43144),a=n(60136),s=n(43668),u=n(27924),c=n(87020),l=n(98351),d=n(11922),h=n(66533),v=n(19881),g=n(15261),f=n(10849),p=n(30788),m=n(52091),b=n(44474),C=function(){function e(t,n,i){(0,r.Z)(this,e),this._selection=t,this._isCopyingDown=n,this._noop=i||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}return(0,o.Z)(e,[{key:"getEditOperations",value:function(e,t){var n=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,n.startLineNumber<n.endLineNumber&&1===n.endColumn&&(this._endLineNumberDelta=1,n=n.setEndPosition(n.endLineNumber-1,e.getLineMaxColumn(n.endLineNumber-1)));for(var i=[],r=n.startLineNumber;r<=n.endLineNumber;r++)i.push(e.getLineContent(r));var o=i.join("\n");""===o&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?t.addEditOperation(new p.e(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber),n.endLineNumber+1,1),n.endLineNumber===e.getLineCount()?"":"\n"):this._isCopyingDown?t.addEditOperation(new p.e(n.startLineNumber,1,n.startLineNumber,1),o+"\n"):t.addEditOperation(new p.e(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber),n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),"\n"+o),this._selectionId=t.trackSelection(n),this._selectionDirection=this._selection.getDirection()}},{key:"computeCursorState",value:function(e,t){var n=t.getTrackedSelection(this._selectionId);if(0!==this._startLineNumberDelta||0!==this._endLineNumberDelta){var i=n.startLineNumber,r=n.startColumn,o=n.endLineNumber,a=n.endColumn;0!==this._startLineNumberDelta&&(i+=this._startLineNumberDelta,r=1),0!==this._endLineNumberDelta&&(o+=this._endLineNumberDelta,a=1),n=m.Y.createWithDirection(i,r,o,a,this._selectionDirection)}return n}}]),e}(),y=n(26684),w=n(55428),L=n(75057),x=n(89125),k=n(90570),_=function(){function e(t,n,i){(0,r.Z)(this,e),this._selection=t,this._isMovingDown=n,this._autoIndent=i,this._selectionId=null,this._moveEndLineSelectionShrink=!1}return(0,o.Z)(e,[{key:"getEditOperations",value:function(e,t){var n=e.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===n)this._selectionId=t.trackSelection(this._selection);else if(this._isMovingDown||1!==this._selection.startLineNumber){this._moveEndPositionDown=!1;var i=this._selection;i.startLineNumber<i.endLineNumber&&1===i.endColumn&&(this._moveEndPositionDown=!0,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));var r=e.getOptions(),o=r.tabSize,a=r.indentSize,s=r.insertSpaces,u=this.buildIndentConverter(o,a,s),c={getLineTokens:function(t){return e.getLineTokens(t)},getLanguageId:function(){return e.getLanguageId()},getLanguageIdAtPosition:function(t,n){return e.getLanguageIdAtPosition(t,n)},getLineContent:null};if(i.startLineNumber===i.endLineNumber&&1===e.getLineMaxColumn(i.startLineNumber)){var l=i.startLineNumber,d=this._isMovingDown?l+1:l-1;1===e.getLineMaxColumn(d)?t.addEditOperation(new p.e(1,1,1,1),null):(t.addEditOperation(new p.e(l,1,l,1),e.getLineContent(d)),t.addEditOperation(new p.e(d,1,d,e.getLineMaxColumn(d)),null)),i=new m.Y(d,1,d,1)}else{var h,v;if(this._isMovingDown){h=i.endLineNumber+1,v=e.getLineContent(h),t.addEditOperation(new p.e(h-1,e.getLineMaxColumn(h-1),h,e.getLineMaxColumn(h)),null);var g=v;if(this.shouldAutoIndent(e,i)){var f=this.matchEnterRule(e,u,o,h,i.startLineNumber-1);if(null!==f){var b=y.V8(e.getLineContent(h)),C=f+k.Y(b,o),w=k.J(C,o,s);g=w+this.trimLeft(v)}else{c.getLineContent=function(t){return t===i.startLineNumber?e.getLineContent(h):e.getLineContent(t)};var L=x.zu.getGoodIndentForLine(this._autoIndent,c,e.getLanguageIdAtPosition(h,1),i.startLineNumber,u);if(null!==L){var _=y.V8(e.getLineContent(h)),S=k.Y(L,o);if(S!==k.Y(_,o)){var I=k.J(S,o,s);g=I+this.trimLeft(v)}}}t.addEditOperation(new p.e(i.startLineNumber,1,i.startLineNumber,1),g+"\n");var N=this.matchEnterRuleMovingDown(e,u,o,i.startLineNumber,h,g);if(null!==N)0!==N&&this.getIndentEditsOfMovingBlock(e,t,i,o,s,N);else{c.getLineContent=function(t){return t===i.startLineNumber?g:t>=i.startLineNumber+1&&t<=i.endLineNumber+1?e.getLineContent(t-1):e.getLineContent(t)};var Z=x.zu.getGoodIndentForLine(this._autoIndent,c,e.getLanguageIdAtPosition(h,1),i.startLineNumber+1,u);if(null!==Z){var M=y.V8(e.getLineContent(i.startLineNumber)),D=k.Y(Z,o),R=k.Y(M,o);if(D!==R){var E=D-R;this.getIndentEditsOfMovingBlock(e,t,i,o,s,E)}}}}else t.addEditOperation(new p.e(i.startLineNumber,1,i.startLineNumber,1),g+"\n")}else if(h=i.startLineNumber-1,v=e.getLineContent(h),t.addEditOperation(new p.e(h,1,h+1,1),null),t.addEditOperation(new p.e(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),"\n"+v),this.shouldAutoIndent(e,i)){c.getLineContent=function(t){return t===h?e.getLineContent(i.startLineNumber):e.getLineContent(t)};var T=this.matchEnterRule(e,u,o,i.startLineNumber,i.startLineNumber-2);if(null!==T)0!==T&&this.getIndentEditsOfMovingBlock(e,t,i,o,s,T);else{var A=x.zu.getGoodIndentForLine(this._autoIndent,c,e.getLanguageIdAtPosition(i.startLineNumber,1),h,u);if(null!==A){var O=y.V8(e.getLineContent(i.startLineNumber)),P=k.Y(A,o),U=k.Y(O,o);if(P!==U){var H=P-U;this.getIndentEditsOfMovingBlock(e,t,i,o,s,H)}}}}}this._selectionId=t.trackSelection(i)}else this._selectionId=t.trackSelection(this._selection)}},{key:"buildIndentConverter",value:function(e,t,n){return{shiftIndent:function(i){return w.U.shiftIndent(i,i.length+1,e,t,n)},unshiftIndent:function(i){return w.U.unshiftIndent(i,i.length+1,e,t,n)}}}},{key:"parseEnterResult",value:function(e,t,n,i,r){if(r){var o=r.indentation;r.indentAction===L.wU.None||r.indentAction===L.wU.Indent?o=r.indentation+r.appendText:r.indentAction===L.wU.IndentOutdent?o=r.indentation:r.indentAction===L.wU.Outdent&&(o=t.unshiftIndent(r.indentation)+r.appendText);var a=e.getLineContent(i);if(this.trimLeft(a).indexOf(this.trimLeft(o))>=0){var s=y.V8(e.getLineContent(i)),u=y.V8(o),c=x.zu.getIndentMetadata(e,i);return null!==c&&2&c&&(u=t.unshiftIndent(u)),k.Y(u,n)-k.Y(s,n)}}return null}},{key:"matchEnterRuleMovingDown",value:function(e,t,n,i,r,o){if(y.ow(o)>=0){var a=e.getLineMaxColumn(r),s=x.zu.getEnterAction(this._autoIndent,e,new p.e(r,a,r,a));return this.parseEnterResult(e,t,n,i,s)}for(var u=i-1;u>=1;){var c=e.getLineContent(u);if(y.ow(c)>=0)break;u--}if(u<1||i>e.getLineCount())return null;var l=e.getLineMaxColumn(u),d=x.zu.getEnterAction(this._autoIndent,e,new p.e(u,l,u,l));return this.parseEnterResult(e,t,n,i,d)}},{key:"matchEnterRule",value:function(e,t,n,i,r,o){for(var a=r;a>=1;){var s=void 0;if(s=a===r&&void 0!==o?o:e.getLineContent(a),y.ow(s)>=0)break;a--}if(a<1||i>e.getLineCount())return null;var u=e.getLineMaxColumn(a),c=x.zu.getEnterAction(this._autoIndent,e,new p.e(a,u,a,u));return this.parseEnterResult(e,t,n,i,c)}},{key:"trimLeft",value:function(e){return e.replace(/^\s+/,"")}},{key:"shouldAutoIndent",value:function(e,t){if(this._autoIndent<4)return!1;if(!e.isCheapToTokenize(t.startLineNumber))return!1;var n=e.getLanguageIdAtPosition(t.startLineNumber,1);return n===e.getLanguageIdAtPosition(t.endLineNumber,1)&&null!==x.zu.getIndentRulesSupport(n)}},{key:"getIndentEditsOfMovingBlock",value:function(e,t,n,i,r,o){for(var a=n.startLineNumber;a<=n.endLineNumber;a++){var s=e.getLineContent(a),u=y.V8(s),c=k.Y(u,i)+o,l=k.J(c,i,r);l!==u&&(t.addEditOperation(new p.e(a,1,a,u.length+1),l),a===n.endLineNumber&&n.endColumn<=u.length+1&&""===l&&(this._moveEndLineSelectionShrink=!0))}}},{key:"computeCursorState",value:function(e,t){var n=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(n=n.setEndPosition(n.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&n.startLineNumber<n.endLineNumber&&(n=n.setEndPosition(n.endLineNumber,2)),n}}]),e}(),S=function(){function e(t,n){(0,r.Z)(this,e),this.selection=t,this.descending=n,this.selectionId=null}return(0,o.Z)(e,[{key:"getEditOperations",value:function(e,t){var n=function(e,t,n){var i=I(e,t,n);if(!i)return null;return g.h.replace(new p.e(i.startLineNumber,1,i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),i.after.join("\n"))}(e,this.selection,this.descending);n&&t.addEditOperation(n.range,n.text),this.selectionId=t.trackSelection(this.selection)}},{key:"computeCursorState",value:function(e,t){return t.getTrackedSelection(this.selectionId)}}],[{key:"getCollator",value:function(){return e._COLLATOR||(e._COLLATOR=new Intl.Collator),e._COLLATOR}},{key:"canRun",value:function(e,t,n){if(null===e)return!1;var i=I(e,t,n);if(!i)return!1;for(var r=0,o=i.before.length;r<o;r++)if(i.before[r]!==i.after[r])return!0;return!1}}]),e}();function I(e,t,n){var i=t.startLineNumber,r=t.endLineNumber;if(1===t.endColumn&&r--,i>=r)return null;for(var o=[],a=i;a<=r;a++)o.push(e.getLineContent(a));var s=o.slice(0);return s.sort(S.getCollator().compare),!0===n&&(s=s.reverse()),{startLineNumber:i,endLineNumber:r,before:o,after:s}}S._COLLATOR=null;var N=n(87697),Z=n(23911),M=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e,i){var o;return(0,r.Z)(this,n),(o=t.call(this,i)).down=e,o}return(0,o.Z)(n,[{key:"run",value:function(e,t){if(t.hasModel()){var n=t.getSelections().map((function(e,t){return{selection:e,index:t,ignore:!1}}));n.sort((function(e,t){return p.e.compareRangesUsingStarts(e.selection,t.selection)}));for(var r=n[0],o=1;o<n.length;o++){var a=n[o];r.selection.endLineNumber===a.selection.startLineNumber&&(r.index<a.index?a.ignore=!0:(r.ignore=!0,r=a))}var s,u=[],c=(0,i.Z)(n);try{for(c.s();!(s=c.n()).done;){var l=s.value;u.push(new C(l.selection,this.down,l.ignore))}}catch(d){c.e(d)}finally{c.f()}t.pushUndoStop(),t.executeCommands(this.id,u),t.pushUndoStop()}}}]),n}(l.R6),D=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,!1,{id:"editor.action.copyLinesUpAction",label:N.N("lines.copyUp","Copy Line Up"),alias:"Copy Line Up",precondition:b.u.writable,kbOpts:{kbExpr:b.u.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:Z.eH.MenubarSelectionMenu,group:"2_line",title:N.N({key:"miCopyLinesUp",comment:["&& denotes a mnemonic"]},"&&Copy Line Up"),order:1}})}return(0,o.Z)(n)}(M),R=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,!0,{id:"editor.action.copyLinesDownAction",label:N.N("lines.copyDown","Copy Line Down"),alias:"Copy Line Down",precondition:b.u.writable,kbOpts:{kbExpr:b.u.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:Z.eH.MenubarSelectionMenu,group:"2_line",title:N.N({key:"miCopyLinesDown",comment:["&& denotes a mnemonic"]},"Co&&py Line Down"),order:2}})}return(0,o.Z)(n)}(M),E=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.duplicateSelection",label:N.N("duplicateSelection","Duplicate Selection"),alias:"Duplicate Selection",precondition:b.u.writable,menuOpts:{menuId:Z.eH.MenubarSelectionMenu,group:"2_line",title:N.N({key:"miDuplicateSelection",comment:["&& denotes a mnemonic"]},"&&Duplicate Selection"),order:5}})}return(0,o.Z)(n,[{key:"run",value:function(e,t,n){if(t.hasModel()){var r,o=[],a=t.getSelections(),s=t.getModel(),u=(0,i.Z)(a);try{for(u.s();!(r=u.n()).done;){var c=r.value;if(c.isEmpty())o.push(new C(c,!0));else{var l=new m.Y(c.endLineNumber,c.endColumn,c.endLineNumber,c.endColumn);o.push(new d.OY(l,s.getValueInRange(c)))}}}catch(h){u.e(h)}finally{u.f()}t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}}]),n}(l.R6),T=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e,i){var o;return(0,r.Z)(this,n),(o=t.call(this,i)).down=e,o}return(0,o.Z)(n,[{key:"run",value:function(e,t){var n,r=[],o=t.getSelections()||[],a=t.getOption(9),s=(0,i.Z)(o);try{for(s.s();!(n=s.n()).done;){var u=n.value;r.push(new _(u,this.down,a))}}catch(c){s.e(c)}finally{s.f()}t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}}]),n}(l.R6),A=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,!1,{id:"editor.action.moveLinesUpAction",label:N.N("lines.moveUp","Move Line Up"),alias:"Move Line Up",precondition:b.u.writable,kbOpts:{kbExpr:b.u.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:Z.eH.MenubarSelectionMenu,group:"2_line",title:N.N({key:"miMoveLinesUp",comment:["&& denotes a mnemonic"]},"Mo&&ve Line Up"),order:3}})}return(0,o.Z)(n)}(T),O=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,!0,{id:"editor.action.moveLinesDownAction",label:N.N("lines.moveDown","Move Line Down"),alias:"Move Line Down",precondition:b.u.writable,kbOpts:{kbExpr:b.u.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:Z.eH.MenubarSelectionMenu,group:"2_line",title:N.N({key:"miMoveLinesDown",comment:["&& denotes a mnemonic"]},"Move &&Line Down"),order:4}})}return(0,o.Z)(n)}(T),P=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e,i){var o;return(0,r.Z)(this,n),(o=t.call(this,i)).descending=e,o}return(0,o.Z)(n,[{key:"run",value:function(e,t){var n,r=t.getSelections()||[],o=(0,i.Z)(r);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(!S.canRun(t.getModel(),a,this.descending))return}}catch(l){o.e(l)}finally{o.f()}for(var s=[],u=0,c=r.length;u<c;u++)s[u]=new S(r[u],this.descending);t.pushUndoStop(),t.executeCommands(this.id,s),t.pushUndoStop()}}]),n}(l.R6),U=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,!1,{id:"editor.action.sortLinesAscending",label:N.N("lines.sortAscending","Sort Lines Ascending"),alias:"Sort Lines Ascending",precondition:b.u.writable})}return(0,o.Z)(n)}(P),H=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,!0,{id:"editor.action.sortLinesDescending",label:N.N("lines.sortDescending","Sort Lines Descending"),alias:"Sort Lines Descending",precondition:b.u.writable})}return(0,o.Z)(n)}(P),F=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.removeDuplicateLines",label:N.N("lines.deleteDuplicates","Delete Duplicate Lines"),alias:"Delete Duplicate Lines",precondition:b.u.writable})}return(0,o.Z)(n,[{key:"run",value:function(e,t){if(t.hasModel()){var n=t.getModel();if(1!==n.getLineCount()||1!==n.getLineMaxColumn(1)){var r,o=[],a=[],s=0,u=(0,i.Z)(t.getSelections());try{for(u.s();!(r=u.n()).done;){for(var c=r.value,l=new Set,d=[],h=c.startLineNumber;h<=c.endLineNumber;h++){var v=n.getLineContent(h);l.has(v)||(d.push(v),l.add(v))}var f=new m.Y(c.startLineNumber,1,c.endLineNumber,n.getLineMaxColumn(c.endLineNumber)),p=c.startLineNumber-s,b=new m.Y(p,1,p+d.length-1,d[d.length-1].length);o.push(g.h.replace(f,d.join("\n"))),a.push(b),s+=c.endLineNumber-c.startLineNumber+1-d.length}}catch(C){u.e(C)}finally{u.f()}t.pushUndoStop(),t.executeEdits(this.id,o,a),t.pushUndoStop()}}}}]),n}(l.R6),V=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:n.ID,label:N.N("lines.trimTrailingWhitespace","Trim Trailing Whitespace"),alias:"Trim Trailing Whitespace",precondition:b.u.writable,kbOpts:{kbExpr:b.u.editorTextFocus,primary:(0,u.gx)(2089,2102),weight:100}})}return(0,o.Z)(n,[{key:"run",value:function(e,t,n){var i=[];"auto-save"===n.reason&&(i=(t.getSelections()||[]).map((function(e){return new f.L(e.positionLineNumber,e.positionColumn)})));var r=t.getSelection();if(null!==r){var o=new h.V(r,i);t.pushUndoStop(),t.executeCommands(this.id,[o]),t.pushUndoStop()}}}]),n}(l.R6);V.ID="editor.action.trimTrailingWhitespace";var W=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.deleteLines",label:N.N("lines.delete","Delete Line"),alias:"Delete Line",precondition:b.u.writable,kbOpts:{kbExpr:b.u.textInputFocus,primary:3113,weight:100}})}return(0,o.Z)(n,[{key:"run",value:function(e,t){if(t.hasModel()){var n=this._getLinesToRemove(t),i=t.getModel();if(1!==i.getLineCount()||1!==i.getLineMaxColumn(1)){for(var r=0,o=[],a=[],s=0,u=n.length;s<u;s++){var c=n[s],l=c.startLineNumber,d=c.endLineNumber,h=1,v=i.getLineMaxColumn(d);d<i.getLineCount()?(d+=1,v=1):l>1&&(l-=1,h=i.getLineMaxColumn(l)),o.push(g.h.replace(new m.Y(l,h,d,v),"")),a.push(new m.Y(l-r,c.positionColumn,l-r,c.positionColumn)),r+=c.endLineNumber-c.startLineNumber+1}t.pushUndoStop(),t.executeEdits(this.id,o,a),t.pushUndoStop()}}}},{key:"_getLinesToRemove",value:function(e){var t=e.getSelections().map((function(e){var t=e.endLineNumber;return e.startLineNumber<e.endLineNumber&&1===e.endColumn&&(t-=1),{startLineNumber:e.startLineNumber,selectionStartColumn:e.selectionStartColumn,endLineNumber:t,positionColumn:e.positionColumn}}));t.sort((function(e,t){return e.startLineNumber===t.startLineNumber?e.endLineNumber-t.endLineNumber:e.startLineNumber-t.startLineNumber}));for(var n=[],i=t[0],r=1;r<t.length;r++)i.endLineNumber+1>=t[r].startLineNumber?i.endLineNumber=t[r].endLineNumber:(n.push(i),i=t[r]);return n.push(i),n}}]),n}(l.R6),K=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.indentLines",label:N.N("lines.indent","Indent Line"),alias:"Indent Line",precondition:b.u.writable,kbOpts:{kbExpr:b.u.editorTextFocus,primary:2137,weight:100}})}return(0,o.Z)(n,[{key:"run",value:function(e,t){var n=t._getViewModel();n&&(t.pushUndoStop(),t.executeCommands(this.id,v.u.indent(n.cursorConfig,t.getModel(),t.getSelections())),t.pushUndoStop())}}]),n}(l.R6),z=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.outdentLines",label:N.N("lines.outdent","Outdent Line"),alias:"Outdent Line",precondition:b.u.writable,kbOpts:{kbExpr:b.u.editorTextFocus,primary:2135,weight:100}})}return(0,o.Z)(n,[{key:"run",value:function(e,t){c.CoreEditingCommands.Outdent.runEditorCommand(e,t,null)}}]),n}(l.R6),j=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.insertLineBefore",label:N.N("lines.insertBefore","Insert Line Above"),alias:"Insert Line Above",precondition:b.u.writable,kbOpts:{kbExpr:b.u.editorTextFocus,primary:3075,weight:100}})}return(0,o.Z)(n,[{key:"run",value:function(e,t){var n=t._getViewModel();n&&(t.pushUndoStop(),t.executeCommands(this.id,v.u.lineInsertBefore(n.cursorConfig,t.getModel(),t.getSelections())))}}]),n}(l.R6),B=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.insertLineAfter",label:N.N("lines.insertAfter","Insert Line Below"),alias:"Insert Line Below",precondition:b.u.writable,kbOpts:{kbExpr:b.u.editorTextFocus,primary:2051,weight:100}})}return(0,o.Z)(n,[{key:"run",value:function(e,t){var n=t._getViewModel();n&&(t.pushUndoStop(),t.executeCommands(this.id,v.u.lineInsertAfter(n.cursorConfig,t.getModel(),t.getSelections())))}}]),n}(l.R6),Y=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"run",value:function(e,t){if(t.hasModel()){for(var n=t.getSelection(),i=this._getRangesToDelete(t),r=[],o=0,a=i.length-1;o<a;o++){var s=i[o],u=i[o+1];null===p.e.intersectRanges(s,u)?r.push(s):i[o+1]=p.e.plusRange(s,u)}r.push(i[i.length-1]);var c=this._getEndCursorState(n,r),l=r.map((function(e){return g.h.replace(e,"")}));t.pushUndoStop(),t.executeEdits(this.id,l,c),t.pushUndoStop()}}}]),n}(l.R6),q=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"deleteAllLeft",label:N.N("lines.deleteAllLeft","Delete All Left"),alias:"Delete All Left",precondition:b.u.writable,kbOpts:{kbExpr:b.u.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}return(0,o.Z)(n,[{key:"_getEndCursorState",value:function(e,t){var n=null,i=[],r=0;return t.forEach((function(t){var o;if(1===t.endColumn&&r>0){var a=t.startLineNumber-r;o=new m.Y(a,t.startColumn,a,t.startColumn)}else o=new m.Y(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn);r+=t.endLineNumber-t.startLineNumber,t.intersectRanges(e)?n=o:i.push(o)})),n&&i.unshift(n),i}},{key:"_getRangesToDelete",value:function(e){var t=e.getSelections();if(null===t)return[];var n=t,i=e.getModel();return null===i?[]:(n.sort(p.e.compareRangesUsingStarts),n=n.map((function(e){if(e.isEmpty()){if(1===e.startColumn){var t=Math.max(1,e.startLineNumber-1),n=1===e.startLineNumber?1:i.getLineContent(t).length+1;return new p.e(t,n,e.startLineNumber,1)}return new p.e(e.startLineNumber,1,e.startLineNumber,e.startColumn)}return new p.e(e.startLineNumber,1,e.endLineNumber,e.endColumn)})))}}]),n}(Y),G=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"deleteAllRight",label:N.N("lines.deleteAllRight","Delete All Right"),alias:"Delete All Right",precondition:b.u.writable,kbOpts:{kbExpr:b.u.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}return(0,o.Z)(n,[{key:"_getEndCursorState",value:function(e,t){for(var n=null,i=[],r=0,o=t.length;r<o;r++){var a=t[r],s=new m.Y(a.startLineNumber-0,a.startColumn,a.startLineNumber-0,a.startColumn);a.intersectRanges(e)?n=s:i.push(s)}return n&&i.unshift(n),i}},{key:"_getRangesToDelete",value:function(e){var t=e.getModel();if(null===t)return[];var n=e.getSelections();if(null===n)return[];var i=n.map((function(e){if(e.isEmpty()){var n=t.getLineMaxColumn(e.startLineNumber);return e.startColumn===n?new p.e(e.startLineNumber,e.startColumn,e.startLineNumber+1,1):new p.e(e.startLineNumber,e.startColumn,e.startLineNumber,n)}return e}));return i.sort(p.e.compareRangesUsingStarts),i}}]),n}(Y),Q=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.joinLines",label:N.N("lines.joinLines","Join Lines"),alias:"Join Lines",precondition:b.u.writable,kbOpts:{kbExpr:b.u.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}return(0,o.Z)(n,[{key:"run",value:function(e,t){var n=t.getSelections();if(null!==n){var i=t.getSelection();if(null!==i){n.sort(p.e.compareRangesUsingStarts);var r=[],o=n.reduce((function(e,t){return e.isEmpty()?e.endLineNumber===t.startLineNumber?(i.equalsSelection(e)&&(i=t),t):t.startLineNumber>e.endLineNumber+1?(r.push(e),t):new m.Y(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn):t.startLineNumber>e.endLineNumber?(r.push(e),t):new m.Y(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn)}));r.push(o);var a=t.getModel();if(null!==a){for(var s=[],u=[],c=i,l=0,d=0,h=r.length;d<h;d++){var v=r[d],f=v.startLineNumber,b=0,C=void 0,y=void 0,w=a.getLineContent(v.endLineNumber).length-v.endColumn;if(v.isEmpty()||v.startLineNumber===v.endLineNumber){var L=v.getStartPosition();L.lineNumber<a.getLineCount()?(C=f+1,y=a.getLineMaxColumn(C)):(C=L.lineNumber,y=a.getLineMaxColumn(L.lineNumber))}else C=v.endLineNumber,y=a.getLineMaxColumn(C);for(var x=a.getLineContent(f),k=f+1;k<=C;k++){var _=a.getLineContent(k),S=a.getLineFirstNonWhitespaceColumn(k);if(S>=1){var I=!0;""===x&&(I=!1),!I||" "!==x.charAt(x.length-1)&&"\t"!==x.charAt(x.length-1)||(I=!1,x=x.replace(/[\s\uFEFF\xA0]+$/g," "));var N=_.substr(S-1);x+=(I?" ":"")+N,b=I?N.length+1:N.length}else b=0}var Z=new p.e(f,1,C,y);if(!Z.isEmpty()){var M=void 0;v.isEmpty()?(s.push(g.h.replace(Z,x)),M=new m.Y(Z.startLineNumber-l,x.length-b+1,f-l,x.length-b+1)):v.startLineNumber===v.endLineNumber?(s.push(g.h.replace(Z,x)),M=new m.Y(v.startLineNumber-l,v.startColumn,v.endLineNumber-l,v.endColumn)):(s.push(g.h.replace(Z,x)),M=new m.Y(v.startLineNumber-l,v.startColumn,v.startLineNumber-l,x.length-w)),null!==p.e.intersectRanges(Z,i)?c=M:u.push(M)}l+=Z.endLineNumber-Z.startLineNumber}u.unshift(c),t.pushUndoStop(),t.executeEdits(this.id,s,u),t.pushUndoStop()}}}}}]),n}(l.R6),J=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.transpose",label:N.N("editor.transpose","Transpose characters around the cursor"),alias:"Transpose characters around the cursor",precondition:b.u.writable})}return(0,o.Z)(n,[{key:"run",value:function(e,t){var n=t.getSelections();if(null!==n){var i=t.getModel();if(null!==i){for(var r=[],o=0,a=n.length;o<a;o++){var s=n[o];if(s.isEmpty()){var u=s.getStartPosition(),c=i.getLineMaxColumn(u.lineNumber);if(u.column>=c){if(u.lineNumber===i.getLineCount())continue;var l=new p.e(u.lineNumber,Math.max(1,u.column-1),u.lineNumber+1,1),h=i.getValueInRange(l).split("").reverse().join("");r.push(new d.T4(new m.Y(u.lineNumber,Math.max(1,u.column-1),u.lineNumber+1,1),h))}else{var v=new p.e(u.lineNumber,Math.max(1,u.column-1),u.lineNumber,u.column+1),g=i.getValueInRange(v).split("").reverse().join("");r.push(new d.hP(v,g,new m.Y(u.lineNumber,u.column+1,u.lineNumber,u.column+1)))}}}t.pushUndoStop(),t.executeCommands(this.id,r),t.pushUndoStop()}}}}]),n}(l.R6),X=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"run",value:function(e,t){var n=t.getSelections();if(null!==n){var r=t.getModel();if(null!==r){var o,a=t.getOption(117),s=[],u=(0,i.Z)(n);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(c.isEmpty()){var l=c.getStartPosition(),d=t.getConfiguredWordAtPosition(l);if(!d)continue;var h=new p.e(l.lineNumber,d.startColumn,l.lineNumber,d.endColumn),v=r.getValueInRange(h);s.push(g.h.replace(h,this._modifyText(v,a)))}else{var f=r.getValueInRange(c);s.push(g.h.replace(c,this._modifyText(f,a)))}}}catch(m){u.e(m)}finally{u.f()}t.pushUndoStop(),t.executeEdits(this.id,s),t.pushUndoStop()}}}}]),n}(l.R6),$=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.transformToUppercase",label:N.N("editor.transformToUppercase","Transform to Uppercase"),alias:"Transform to Uppercase",precondition:b.u.writable})}return(0,o.Z)(n,[{key:"_modifyText",value:function(e,t){return e.toLocaleUpperCase()}}]),n}(X),ee=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.transformToLowercase",label:N.N("editor.transformToLowercase","Transform to Lowercase"),alias:"Transform to Lowercase",precondition:b.u.writable})}return(0,o.Z)(n,[{key:"_modifyText",value:function(e,t){return e.toLocaleLowerCase()}}]),n}(X),te=function(){function e(t,n){(0,r.Z)(this,e),this._pattern=t,this._flags=n,this._actual=null,this._evaluated=!1}return(0,o.Z)(e,[{key:"get",value:function(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch(e){}}return this._actual}},{key:"isSupported",value:function(){return null!==this.get()}}]),e}(),ne=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.transformToTitlecase",label:N.N("editor.transformToTitlecase","Transform to Title Case"),alias:"Transform to Title Case",precondition:b.u.writable})}return(0,o.Z)(n,[{key:"_modifyText",value:function(e,t){var i=n.titleBoundary.get();return i?e.toLocaleLowerCase().replace(i,(function(e){return e.toLocaleUpperCase()})):e}}]),n}(X);ne.titleBoundary=new te("(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}","gmu");var ie=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.transformToSnakecase",label:N.N("editor.transformToSnakecase","Transform to Snake Case"),alias:"Transform to Snake Case",precondition:b.u.writable})}return(0,o.Z)(n,[{key:"_modifyText",value:function(e,t){var i=n.caseBoundary.get(),r=n.singleLetters.get();return i&&r?e.replace(i,"$1_$2").replace(r,"$1_$2$3").toLocaleLowerCase():e}}]),n}(X);ie.caseBoundary=new te("(\\p{Ll})(\\p{Lu})","gmu"),ie.singleLetters=new te("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu"),(0,l.Qr)(D),(0,l.Qr)(R),(0,l.Qr)(E),(0,l.Qr)(A),(0,l.Qr)(O),(0,l.Qr)(U),(0,l.Qr)(H),(0,l.Qr)(F),(0,l.Qr)(V),(0,l.Qr)(W),(0,l.Qr)(K),(0,l.Qr)(z),(0,l.Qr)(j),(0,l.Qr)(B),(0,l.Qr)(q),(0,l.Qr)(G),(0,l.Qr)(Q),(0,l.Qr)(J),(0,l.Qr)($),(0,l.Qr)(ee),ie.caseBoundary.isSupported()&&ie.singleLetters.isSupported()&&(0,l.Qr)(ie),ne.titleBoundary.isSupported()&&(0,l.Qr)(ne)},72133:function(e,t,n){n.r(t),n.d(t,{CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE:function(){return O},LinkedEditingContribution:function(){return U},LinkedEditingAction:function(){return H},editorLinkedEditingBackground:function(){return W}});var i=n(29439),r=n(15671),o=n(43144),a=n(11752),s=n(61120),u=n(60136),c=n(43668),l=n(87757),d=n.n(l),h=n(71881),v=n(32590),g=n(32124),f=n(17424),p=n(68552),m=n(28941),b=n(10526),C=n(26684),y=n(50605),w=n(98351),L=n(56692),x=n(10849),k=n(30788),_=n(44474),S=n(27959),I=n(49500),N=n(89125),Z=n(87697),M=n(49525),D=n(6574),R=n(3553),E=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},T=function(e,t){return function(n,i){t(n,i,e)}},A=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(t){o(t)}}function s(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},O=new M.uy("LinkedEditingInputVisible",!1),P="linked-editing-decoration",U=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e,i,o){var a;return(0,r.Z)(this,n),(a=t.call(this)).languageConfigurationService=o,a._debounceDuration=200,a._localToDispose=a._register(new b.SL),a._editor=e,a._enabled=!1,a._visibleContextKey=O.bindTo(i),a._currentDecorations=[],a._languageWordPattern=null,a._currentWordPattern=null,a._ignoreChangeEvent=!1,a._localToDispose=a._register(new b.SL),a._rangeUpdateTriggerPromise=null,a._rangeSyncTriggerPromise=null,a._currentRequest=null,a._currentRequestPosition=null,a._currentRequestModelVersion=null,a._register(a._editor.onDidChangeModel((function(){return a.reinitialize(!0)}))),a._register(a._editor.onDidChangeConfiguration((function(e){(e.hasChanged(62)||e.hasChanged(82))&&a.reinitialize(!1)}))),a._register(I.id.onDidChange((function(){return a.reinitialize(!1)}))),a._register(a._editor.onDidChangeModelLanguage((function(){return a.reinitialize(!0)}))),a.reinitialize(!0),a}return(0,o.Z)(n,[{key:"reinitialize",value:function(e){var t=this,n=this._editor.getModel(),i=null!==n&&(this._editor.getOption(62)||this._editor.getOption(82))&&I.id.has(n);if((i!==this._enabled||e)&&(this._enabled=i,this.clearRanges(),this._localToDispose.clear(),i&&null!==n)){this._localToDispose.add(m.ju.runAndSubscribe(n.onDidChangeLanguageConfiguration,(function(){t._languageWordPattern=t.languageConfigurationService.getLanguageConfiguration(n.getLanguageId()).getWordDefinition()})));var r=new v.vp(this._debounceDuration),o=function(){t._rangeUpdateTriggerPromise=r.trigger((function(){return t.updateRanges()}),t._debounceDuration)},a=new v.vp(0);this._localToDispose.add(this._editor.onDidChangeCursorPosition((function(){o()}))),this._localToDispose.add(this._editor.onDidChangeModelContent((function(e){if(!t._ignoreChangeEvent&&t._currentDecorations.length>0){var i=n.getDecorationRange(t._currentDecorations[0]);if(i&&e.changes.every((function(e){return i.intersectRanges(e.range)})))return r=t._currentDecorations,void(t._rangeSyncTriggerPromise=a.trigger((function(){return t._syncRanges(r)})))}var r;o()}))),this._localToDispose.add({dispose:function(){r.cancel(),a.cancel()}}),this.updateRanges()}}},{key:"_syncRanges",value:function(e){if(this._editor.hasModel()&&e===this._currentDecorations&&0!==e.length){var t=this._editor.getModel(),n=t.getDecorationRange(e[0]);if(!n||n.startLineNumber!==n.endLineNumber)return this.clearRanges();var i=t.getValueInRange(n);if(this._currentWordPattern){var r=i.match(this._currentWordPattern);if((r?r[0].length:0)!==i.length)return this.clearRanges()}for(var o=[],a=1,s=e.length;a<s;a++){var u=t.getDecorationRange(e[a]);if(u)if(u.startLineNumber!==u.endLineNumber)o.push({range:u,text:i});else{var c=t.getValueInRange(u),l=i,d=u.startColumn,h=u.endColumn,v=C.Mh(c,l);d+=v,c=c.substr(v),l=l.substr(v);var g=C.P1(c,l);h-=g,c=c.substr(0,c.length-g),l=l.substr(0,l.length-g),d===h&&0===l.length||o.push({range:new k.e(u.startLineNumber,d,u.endLineNumber,h),text:l})}}if(0!==o.length)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;var f=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",o),this._editor._getViewModel().setPrevEditOperationType(f)}finally{this._ignoreChangeEvent=!1}}}},{key:"dispose",value:function(){this.clearRanges(),(0,a.Z)((0,s.Z)(n.prototype),"dispose",this).call(this)}},{key:"clearRanges",value:function(){this._visibleContextKey.set(!1),this._currentDecorations=this._editor.deltaDecorations(this._currentDecorations,[]),this._currentRequest&&(this._currentRequest.cancel(),this._currentRequest=null,this._currentRequestPosition=null)}},{key:"updateRanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return A(this,void 0,void 0,d().mark((function t(){var i,r,o,a,s,u=this;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._editor.hasModel()){t.next=3;break}return this.clearRanges(),t.abrupt("return");case 3:if(i=this._editor.getPosition(),!(!this._enabled&&!e||this._editor.getSelections().length>1)){t.next=7;break}return this.clearRanges(),t.abrupt("return");case 7:if(r=this._editor.getModel(),o=r.getVersionId(),!this._currentRequestPosition||this._currentRequestModelVersion!==o){t.next=16;break}if(!i.equals(this._currentRequestPosition)){t.next=12;break}return t.abrupt("return");case 12:if(!(this._currentDecorations&&this._currentDecorations.length>0)){t.next=16;break}if(!(a=r.getDecorationRange(this._currentDecorations[0]))||!a.containsPosition(i)){t.next=16;break}return t.abrupt("return");case 16:return this._currentRequestPosition=i,this._currentRequestModelVersion=o,s=(0,v.PG)((function(e){return A(u,void 0,void 0,d().mark((function t(){var a,u,c,l,h,v,g;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,V(r,i,e);case 3:if(a=t.sent,s===this._currentRequest){t.next=6;break}return t.abrupt("return");case 6:if(this._currentRequest=null,o===r.getVersionId()){t.next=9;break}return t.abrupt("return");case 9:u=[],(null===a||void 0===a?void 0:a.ranges)&&(u=a.ranges),this._currentWordPattern=(null===a||void 0===a?void 0:a.wordPattern)||this._languageWordPattern,c=!1,l=0,h=u.length;case 14:if(!(l<h)){t.next=22;break}if(!k.e.containsPosition(u[l],i)){t.next=19;break}return c=!0,0!==l&&(v=u[l],u.splice(l,1),u.unshift(v)),t.abrupt("break",22);case 19:l++,t.next=14;break;case 22:if(c){t.next=25;break}return this.clearRanges(),t.abrupt("return");case 25:g=u.map((function(e){return{range:e,options:n.DECORATION}})),this._visibleContextKey.set(!0),this._currentDecorations=this._editor.deltaDecorations(this._currentDecorations,g),t.next=34;break;case 30:t.prev=30,t.t0=t.catch(0),(0,p.n2)(t.t0)||(0,p.dL)(t.t0),this._currentRequest!==s&&this._currentRequest||this.clearRanges();case 34:case"end":return t.stop()}}),t,this,[[0,30]])})))})),this._currentRequest=s,t.abrupt("return",s);case 21:case"end":return t.stop()}}),t,this)})))}}],[{key:"get",value:function(e){return e.getContribution(n.ID)}}]),n}(b.JT);U.ID="editor.contrib.linkedEditing",U.DECORATION=S.qx.register({description:"linked-editing",stickiness:0,className:P}),U=E([T(1,M.i6),T(2,N.c_)],U);var H=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(){return(0,r.Z)(this,n),t.call(this,{id:"editor.action.linkedEditing",label:Z.N("linkedEditing.label","Start Linked Editing"),alias:"Start Linked Editing",precondition:M.Ao.and(_.u.writable,_.u.hasRenameProvider),kbOpts:{kbExpr:_.u.editorTextFocus,primary:3132,weight:100}})}return(0,o.Z)(n,[{key:"runCommand",value:function(e,t){var r=this,o=e.get(L.$),u=Array.isArray(t)&&t||[void 0,void 0],c=(0,i.Z)(u,2),l=c[0],d=c[1];return y.o.isUri(l)&&x.L.isIPosition(d)?o.openCodeEditor({resource:l},o.getActiveCodeEditor()).then((function(e){e&&(e.setPosition(d),e.invokeWithinContext((function(t){return r.reportTelemetry(t,e),r.run(t,e)})))}),p.dL):(0,a.Z)((0,s.Z)(n.prototype),"runCommand",this).call(this,e,t)}},{key:"run",value:function(e,t){var n=U.get(t);return n?Promise.resolve(n.updateRanges(!0)):Promise.resolve()}}]),n}(w.R6),F=w._l.bindToContribution(U.get);function V(e,t,n){var i=this,r=I.id.ordered(e);return(0,v.Ps)(r.map((function(r){return function(){return A(i,void 0,void 0,d().mark((function i(){return d().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,r.provideLinkedEditingRanges(e,t,n);case 3:return i.abrupt("return",i.sent);case 6:return i.prev=6,i.t0=i.catch(0),(0,p.Cp)(i.t0),i.abrupt("return",void 0);case 10:case"end":return i.stop()}}),i,null,[[0,6]])})))}})),(function(e){return!!e&&h.Of(null===e||void 0===e?void 0:e.ranges)}))}(0,w.fK)(new F({id:"cancelLinkedEditingInput",precondition:O,handler:function(e){return e.clearRanges()},kbOpts:{kbExpr:_.u.editorTextFocus,weight:199,primary:9,secondary:[1033]}}));var W=(0,D.P6G)("editor.linkedEditingBackground",{dark:f.Il.fromHex("#f00").transparent(.3),light:f.Il.fromHex("#f00").transparent(.3),hc:f.Il.fromHex("#f00").transparent(.3)},Z.N("editorLinkedEditingBackground","Background color when the editor auto renames on type."));(0,R.Ic)((function(e,t){var n=e.getColor(W);n&&t.addRule(".monaco-editor .".concat(P," { background: ").concat(n,"; border-left-color: ").concat(n,"; }"))})),(0,w.sb)("_executeLinkedEditingProvider",(function(e,t){return V(e,t,g.T.None)})),(0,w._K)(U.ID,U),(0,w.Qr)(H)},22678:function(e,t,n){n.r(t),n.d(t,{LinkDetector:function(){return K}});var i=n(60136),r=n(43668),o=n(37762),a=n(29439),s=n(15671),u=n(43144),c=n(87757),l=n.n(c),d=n(32590),h=n(32124),v=n(68552),g=n(67277),f=n(10526),p=n(16496),m=n(4827),b=n(34408),C=n(50605),y=n(98351),w=n(27959),L=n(49500),x=n(61826),k=n(71881),_=n(64272),S=n(30788),I=n(74463),N=n(89850),Z=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(t){o(t)}}function s(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},M=function(){function e(t,n){(0,s.Z)(this,e),this._link=t,this._provider=n}return(0,u.Z)(e,[{key:"toJSON",value:function(){return{range:this.range,url:this.url,tooltip:this.tooltip}}},{key:"range",get:function(){return this._link.range}},{key:"url",get:function(){return this._link.url}},{key:"tooltip",get:function(){return this._link.tooltip}},{key:"resolve",value:function(e){return Z(this,void 0,void 0,l().mark((function t(){var n=this;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._link.url){t.next=2;break}return t.abrupt("return",this._link.url);case 2:if("function"!==typeof this._provider.resolveLink){t.next=4;break}return t.abrupt("return",Promise.resolve(this._provider.resolveLink(this._link,e)).then((function(t){return n._link=t||n._link,n._link.url?n.resolve(e):Promise.reject(new Error("missing"))})));case 4:return t.abrupt("return",Promise.reject(new Error("missing")));case 5:case"end":return t.stop()}}),t,this)})))}}]),e}(),D=function(){function e(t){var n=this;(0,s.Z)(this,e),this._disposables=new f.SL;var i,r=[],u=(0,o.Z)(t);try{var c=function(){var t=(0,a.Z)(i.value,2),o=t[0],s=t[1],u=o.links.map((function(e){return new M(e,s)}));r=e._union(r,u),(0,f.Wf)(o)&&n._disposables.add(o)};for(u.s();!(i=u.n()).done;)c()}catch(l){u.e(l)}finally{u.f()}this.links=r}return(0,u.Z)(e,[{key:"dispose",value:function(){this._disposables.dispose(),this.links.length=0}}],[{key:"_union",value:function(e,t){var n,i,r,o,a=[];for(n=0,r=0,i=e.length,o=t.length;n<i&&r<o;){var s=e[n],u=t[r];if(S.e.areIntersectingOrTouching(s.range,u.range))n++;else S.e.compareRangesUsingStarts(s.range,u.range)<0?(a.push(s),n++):(a.push(u),r++)}for(;n<i;n++)a.push(e[n]);for(;r<o;r++)a.push(t[r]);return a}}]),e}();function R(e,t){var n=[],i=L.pM.ordered(e).reverse().map((function(i,r){return Promise.resolve(i.provideLinks(e,t)).then((function(e){e&&(n[r]=[e,i])}),v.Cp)}));return Promise.all(i).then((function(){var e=new D((0,k.kX)(n));return t.isCancellationRequested?(e.dispose(),new D([])):e}))}N.P0.registerCommand("_executeLinkProvider",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Z(void 0,void 0,void 0,l().mark((function t(){var i,r,o,a,s,u;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=n[0],r=n[1],(0,_.p_)(i instanceof C.o),"number"!==typeof r&&(r=0),o=e.get(I.q).getModel(i)){t.next=6;break}return t.abrupt("return",[]);case 6:return t.next=8,R(o,h.T.None);case 8:if(a=t.sent){t.next=11;break}return t.abrupt("return",[]);case 11:s=0;case 12:if(!(s<Math.min(r,a.links.length))){t.next=18;break}return t.next=15,a.links[s].resolve(h.T.None);case 15:s++,t.next=12;break;case 18:return u=a.links.slice(0),a.dispose(),t.abrupt("return",u);case 21:case"end":return t.stop()}}),t)})))}));var E=n(87697),T=n(13023),A=n(74990),O=n(6574),P=n(3553),U=function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},H=function(e,t){return function(n,i){t(n,i,e)}},F=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(t){o(t)}}function s(e){try{u(i.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))};var V={general:w.qx.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),active:w.qx.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"})},W=function(){function e(t,n){(0,s.Z)(this,e),this.link=t,this.decorationId=n}return(0,u.Z)(e,[{key:"activate",value:function(t,n){t.changeDecorationOptions(this.decorationId,e._getOptions(this.link,n,!0))}},{key:"deactivate",value:function(t,n){t.changeDecorationOptions(this.decorationId,e._getOptions(this.link,n,!1))}}],[{key:"decoration",value:function(t,n){return{range:t.range,options:e._getOptions(t,n,!1)}}},{key:"_getOptions",value:function(e,t,n){var i=Object.assign({},n?V.active:V.general);return i.hoverMessage=function(e,t){var n=e.url&&/^command:/i.test(e.url.toString()),i=e.tooltip?e.tooltip:n?E.N("links.navigate.executeCmd","Execute command"):E.N("links.navigate.follow","Follow link"),r=t?m.dz?E.N("links.navigate.kb.meta.mac","cmd + click"):E.N("links.navigate.kb.meta","ctrl + click"):m.dz?E.N("links.navigate.kb.alt.mac","option + click"):E.N("links.navigate.kb.alt","alt + click");if(e.url){var o="";if(/^command:/i.test(e.url.toString())){var a=e.url.toString().match(/^command:([^?#]+)/);if(a){var s=a[1],u=E.N("tooltip.explanation","Execute command {0}",s);o=' "'.concat(u,'"')}}return new g.W5("",!0).appendMarkdown("[".concat(i,"](").concat(e.url.toString(!0).replace(/ /g,"%20")).concat(o,") (").concat(r,")"))}return(new g.W5).appendText("".concat(i," (").concat(r,")"))}(e,t),i}}]),e}(),K=function(){function e(t,n,i){var r=this;(0,s.Z)(this,e),this.listenersToRemove=new f.SL,this.editor=t,this.openerService=n,this.notificationService=i;var o=new x.yN(t);this.listenersToRemove.add(o),this.listenersToRemove.add(o.onMouseMoveOrRelevantKeyDown((function(e){var t=(0,a.Z)(e,2),n=t[0],i=t[1];r._onEditorMouseMove(n,i)}))),this.listenersToRemove.add(o.onExecute((function(e){r.onEditorMouseUp(e)}))),this.listenersToRemove.add(o.onCancel((function(e){r.cleanUpActiveLinkDecoration()}))),this.enabled=t.getOption(63),this.listenersToRemove.add(t.onDidChangeConfiguration((function(e){var n=t.getOption(63);r.enabled!==n&&(r.enabled=n,r.updateDecorations([]),r.stop(),r.beginCompute())}))),this.listenersToRemove.add(t.onDidChangeModelContent((function(e){return r.onChange()}))),this.listenersToRemove.add(t.onDidChangeModel((function(e){return r.onModelChanged()}))),this.listenersToRemove.add(t.onDidChangeModelLanguage((function(e){return r.onModelLanguageChanged()}))),this.listenersToRemove.add(L.pM.onDidChange((function(e){return r.onModelLanguageChanged()}))),this.timeout=new d._F,this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null,this.beginCompute()}return(0,u.Z)(e,[{key:"onModelChanged",value:function(){this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.beginCompute()}},{key:"onModelLanguageChanged",value:function(){this.stop(),this.beginCompute()}},{key:"onChange",value:function(){var t=this;this.timeout.setIfNotSet((function(){return t.beginCompute()}),e.RECOMPUTE_TIME)}},{key:"beginCompute",value:function(){return F(this,void 0,void 0,l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.editor.hasModel()&&this.enabled){e.next=2;break}return e.abrupt("return");case 2:if(t=this.editor.getModel(),L.pM.has(t)){e.next=5;break}return e.abrupt("return");case 5:return this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=d.PG((function(e){return R(t,e)})),e.prev=7,e.next=10,this.computePromise;case 10:this.activeLinksList=e.sent,this.updateDecorations(this.activeLinksList.links),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),(0,v.dL)(e.t0);case 17:return e.prev=17,this.computePromise=null,e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[7,14,17,20]])})))}},{key:"updateDecorations",value:function(e){for(var t="altKey"===this.editor.getOption(70),n=[],i=Object.keys(this.currentOccurrences),r=0,a=i.length;r<a;r++){var s=i[r],u=this.currentOccurrences[s];n.push(u.decorationId)}var c=[];if(e){var l,d=(0,o.Z)(e);try{for(d.s();!(l=d.n()).done;){var h=l.value;c.push(W.decoration(h,t))}}catch(m){d.e(m)}finally{d.f()}}var v=this.editor.deltaDecorations(n,c);this.currentOccurrences={},this.activeLinkDecorationId=null;for(var g=0,f=v.length;g<f;g++){var p=new W(e[g],v[g]);this.currentOccurrences[p.decorationId]=p}}},{key:"_onEditorMouseMove",value:function(e,t){var n=this,i="altKey"===this.editor.getOption(70);if(this.isEnabled(e,t)){this.cleanUpActiveLinkDecoration();var r=this.getLinkOccurrence(e.target.position);r&&this.editor.changeDecorations((function(e){r.activate(e,i),n.activeLinkDecorationId=r.decorationId}))}else this.cleanUpActiveLinkDecoration()}},{key:"cleanUpActiveLinkDecoration",value:function(){var e="altKey"===this.editor.getOption(70);if(this.activeLinkDecorationId){var t=this.currentOccurrences[this.activeLinkDecorationId];t&&this.editor.changeDecorations((function(n){t.deactivate(n,e)})),this.activeLinkDecorationId=null}}},{key:"onEditorMouseUp",value:function(e){if(this.isEnabled(e)){var t=this.getLinkOccurrence(e.target.position);t&&this.openLinkOccurrence(t,e.hasSideBySideModifier,!0)}}},{key:"openLinkOccurrence",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.openerService){var r=e.link;r.resolve(h.T.None).then((function(e){if("string"===typeof e&&n.editor.hasModel()){var r=n.editor.getModel().uri;if(r.scheme===p.lg.file&&e.startsWith("".concat(p.lg.file,":"))){var o=C.o.parse(e);if(o.scheme===p.lg.file){var a=b.z_(o),s=null;a.startsWith("/./")?s=".".concat(a.substr(1)):a.startsWith("//./")&&(s=".".concat(a.substr(2))),s&&(e=b.Vo(r,s))}}}return n.openerService.open(e,{openToSide:t,fromUserGesture:i,allowContributedOpeners:!0,allowCommands:!0})}),(function(e){var t=e instanceof Error?e.message:e;"invalid"===t?n.notificationService.warn(E.N("invalid.url","Failed to open this link because it is not well-formed: {0}",r.url.toString())):"missing"===t?n.notificationService.warn(E.N("missing.url","Failed to open this link because its target is missing.")):(0,v.dL)(e)}))}}},{key:"getLinkOccurrence",value:function(e){if(!this.editor.hasModel()||!e)return null;var t,n=this.editor.getModel().getDecorationsInRange({startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},0,!0),i=(0,o.Z)(n);try{for(i.s();!(t=i.n()).done;){var r=t.value,a=this.currentOccurrences[r.id];if(a)return a}}catch(s){i.e(s)}finally{i.f()}return null}},{key:"isEnabled",value:function(e,t){return Boolean(6===e.target.type&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey))}},{key:"stop",value:function(){var e;this.timeout.cancel(),this.activeLinksList&&(null===(e=this.activeLinksList)||void 0===e||e.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}},{key:"dispose",value:function(){this.listenersToRemove.dispose(),this.stop(),this.timeout.dispose()}}],[{key:"get",value:function(t){return t.getContribution(e.ID)}}]),e}();K.ID="editor.linkDetector",K.RECOMPUTE_TIME=1e3,K=U([H(1,A.v4),H(2,T.lT)],K);var z=function(e){(0,i.Z)(n,e);var t=(0,r.Z)(n);function n(){return(0,s.Z)(this,n),t.call(this,{id:"editor.action.openLink",label:E.N("label","Open Link"),alias:"Open Link",precondition:void 0})}return(0,u.Z)(n,[{key:"run",value:function(e,t){var n=K.get(t);if(n&&t.hasModel()){var i,r=t.getSelections(),a=(0,o.Z)(r);try{for(a.s();!(i=a.n()).done;){var s=i.value,u=n.getLinkOccurrence(s.getEndPosition());u&&n.openLinkOccurrence(u,!1)}}catch(c){a.e(c)}finally{a.f()}}}}]),n}(y.R6);(0,y._K)(K.ID,K),(0,y.Qr)(z),(0,P.Ic)((function(e,t){var n=e.getColor(O._Yy);n&&t.addRule(".monaco-editor .detected-link-active { color: ".concat(n," !important; }"))}))}}]);
//# sourceMappingURL=monaco-editor-vendor.d4d9fc54.199e44b1.js.map