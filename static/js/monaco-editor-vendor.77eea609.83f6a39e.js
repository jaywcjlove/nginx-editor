"use strict";(self.webpackChunkmonaco_editor_nginx=self.webpackChunkmonaco_editor_nginx||[]).push([[6284],{72231:function(e,t,i){i.r(t);var n,o,s=i(95253),r=i(74165),a=i(15671),l=i(43144),d=i(60136),c=i(27277),u=i(18420),h=i(59874),g=i(14443),f=i(77819),p=i(8022),_=i(98926),m=i(37762),v=i(29439),y=i(97326),b=i(11752),S=i(61120),k=i(65096),w=i(65441),C=i(93433),x=i(32959),D=i(81200),L=i(38102),N=i(79730),I=i(30804),F=i(4391),T=i(65631),P=i(53603),M=i(63465),E=i(56606),R=i(68297),O=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))},Z=function(){function e(t,i,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;(0,a.Z)(this,e),this.startLineNumbers=t,this.endLineNumbers=i,this.lastLineRelativePosition=n,this.showEndForLine=o}return(0,l.Z)(e,[{key:"equals",value:function(e){return!!e&&this.lastLineRelativePosition===e.lastLineRelativePosition&&this.showEndForLine===e.showEndForLine&&(0,L.fS)(this.startLineNumbers,e.startLineNumbers)&&(0,L.fS)(this.endLineNumbers,e.endLineNumbers)}}]),e}(),z=(0,D.Z)("stickyScrollViewLayer",{createHTML:function(e){return e}}),A="data-sticky-line-index",W="data-sticky-is-line",V="data-sticky-is-folding-icon",H=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;(0,a.Z)(this,i),(n=t.call(this))._editor=e,n._foldingIconStore=new k.SL,n._rootDomNode=document.createElement("div"),n._lineNumbersDomNode=document.createElement("div"),n._linesDomNodeScrollable=document.createElement("div"),n._linesDomNode=document.createElement("div"),n._lineHeight=n._editor.getOption(66),n._stickyLines=[],n._lineNumbers=[],n._lastLineRelativePosition=0,n._minContentWidthInPx=0,n._isOnGlyphMargin=!1,n._lineNumbersDomNode.className="sticky-widget-line-numbers",n._lineNumbersDomNode.setAttribute("role","none"),n._linesDomNode.className="sticky-widget-lines",n._linesDomNode.setAttribute("role","list"),n._linesDomNodeScrollable.className="sticky-widget-lines-scrollable",n._linesDomNodeScrollable.appendChild(n._linesDomNode),n._rootDomNode.className="sticky-widget",n._rootDomNode.classList.toggle("peek",e instanceof F.H),n._rootDomNode.appendChild(n._lineNumbersDomNode),n._rootDomNode.appendChild(n._linesDomNodeScrollable);var o=function(){n._linesDomNode.style.left=n._editor.getOption(114).scrollWithEditor?"-".concat(n._editor.getScrollLeft(),"px"):"0px"};return n._register(n._editor.onDidChangeConfiguration((function(e){e.hasChanged(114)&&o(),e.hasChanged(66)&&(n._lineHeight=n._editor.getOption(66))}))),n._register(n._editor.onDidScrollChange((function(e){e.scrollLeftChanged&&o(),e.scrollWidthChanged&&n._updateWidgetWidth()}))),n._register(n._editor.onDidChangeModel((function(){o(),n._updateWidgetWidth()}))),n._register(n._foldingIconStore),o(),n._register(n._editor.onDidLayoutChange((function(e){n._updateWidgetWidth()}))),n._updateWidgetWidth(),n}return(0,l.Z)(i,[{key:"lineNumbers",get:function(){return this._lineNumbers}},{key:"lineNumberCount",get:function(){return this._lineNumbers.length}},{key:"getStickyLineForLine",value:function(e){return this._stickyLines.find((function(t){return t.lineNumber===e}))}},{key:"getCurrentLines",value:function(){return this._lineNumbers}},{key:"setState",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;if(!(!this._previousState&&!e||this._previousState&&this._previousState.equals(e))||i!==1/0){this._previousState=e;var n=this._stickyLines;if(this._clearStickyWidget(),e&&this._editor._getViewModel()){if(e.startLineNumbers.length*this._lineHeight+e.lastLineRelativePosition>0){this._lastLineRelativePosition=e.lastLineRelativePosition;var o=(0,C.Z)(e.startLineNumbers);null!==e.showEndForLine&&(o[e.showEndForLine]=e.endLineNumbers[e.showEndForLine]),this._lineNumbers=o}else this._lastLineRelativePosition=0,this._lineNumbers=[];this._renderRootNode(n,t,i)}}}},{key:"_updateWidgetWidth",value:function(){var e=this._editor.getLayoutInfo(),t=e.contentLeft;this._lineNumbersDomNode.style.width="".concat(t,"px"),this._linesDomNodeScrollable.style.setProperty("--vscode-editorStickyScroll-scrollableWidth","".concat(this._editor.getScrollWidth()-e.verticalScrollbarWidth,"px")),this._rootDomNode.style.width="".concat(e.width-e.verticalScrollbarWidth,"px")}},{key:"_clearStickyWidget",value:function(){this._stickyLines=[],this._foldingIconStore.clear(),x.clearNode(this._lineNumbersDomNode),x.clearNode(this._linesDomNode),this._rootDomNode.style.display="none"}},{key:"_useFoldingOpacityTransition",value:function(e){this._lineNumbersDomNode.style.setProperty("--vscode-editorStickyScroll-foldingOpacityTransition","opacity ".concat(e?.5:0,"s"))}},{key:"_setFoldingIconsVisibility",value:function(e){var t,i=(0,m.Z)(this._stickyLines);try{for(i.s();!(t=i.n()).done;){var n=t.value.foldingIcon;n&&n.setVisible(!!e||n.isCollapsed)}}catch(o){i.e(o)}finally{i.f()}}},{key:"_renderRootNode",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return O(this,void 0,void 0,(0,r.Z)().mark((function n(){var o,s,a,l,d,c,u,h,g;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=this._editor.getLayoutInfo(),s=(0,m.Z)(this._lineNumbers.entries()),n.prev=2,s.s();case 4:if((a=s.n()).done){n.next=15;break}if(l=(0,v.Z)(a.value,2),d=l[0],c=l[1],u=e[d],h=c>=i||(null===u||void 0===u?void 0:u.lineNumber)!==c?this._renderChildNode(d,c,t,o):this._updateTopAndZIndexOfStickyLine(u)){n.next=10;break}return n.abrupt("continue",13);case 10:this._linesDomNode.appendChild(h.lineDomNode),this._lineNumbersDomNode.appendChild(h.lineNumberDomNode),this._stickyLines.push(h);case 13:n.next=4;break;case 15:n.next=20;break;case 17:n.prev=17,n.t0=n.catch(2),s.e(n.t0);case 20:return n.prev=20,s.f(),n.finish(20);case 23:if(t&&(this._setFoldingHoverListeners(),this._useFoldingOpacityTransition(!this._isOnGlyphMargin)),0!==(g=this._lineNumbers.length*this._lineHeight+this._lastLineRelativePosition)){n.next=28;break}return this._clearStickyWidget(),n.abrupt("return");case 28:this._rootDomNode.style.display="block",this._lineNumbersDomNode.style.height="".concat(g,"px"),this._linesDomNodeScrollable.style.height="".concat(g,"px"),this._rootDomNode.style.height="".concat(g,"px"),this._rootDomNode.style.marginLeft="0px",this._updateMinContentWidth(),this._editor.layoutOverlayWidget(this);case 35:case"end":return n.stop()}}),n,this,[[2,17,20,23]])})))}},{key:"_setFoldingHoverListeners",value:function(){var e=this;"mouseover"===this._editor.getOption(109)&&(this._foldingIconStore.add(x.addDisposableListener(this._lineNumbersDomNode,x.EventType.MOUSE_ENTER,(function(t){e._isOnGlyphMargin=!0,e._setFoldingIconsVisibility(!0)}))),this._foldingIconStore.add(x.addDisposableListener(this._lineNumbersDomNode,x.EventType.MOUSE_LEAVE,(function(){e._isOnGlyphMargin=!1,e._useFoldingOpacityTransition(!0),e._setFoldingIconsVisibility(!1)}))))}},{key:"_renderChildNode",value:function(e,t,i,n){var o=this._editor._getViewModel();if(o){var s,r=o.coordinatesConverter.convertModelPositionToViewPosition(new T.L(t,1)).lineNumber,a=o.getViewLineRenderingData(r),l=this._editor.getOption(67);try{s=M.Kp.filter(a.inlineDecorations,r,a.minColumn,a.maxColumn)}catch(y){s=[]}var d,c=new E.IJ(!0,!0,a.content,a.continuesWithWrappedLine,a.isBasicASCII,a.containsRTL,0,a.tokens,s,a.tabSize,a.startVisibleColumn,1,1,1,500,"none",!0,!0,null),u=new P.HT(2e3),h=(0,E.d1)(c,u);d=z?z.createHTML(u.build()):u.build();var g=document.createElement("span");g.setAttribute(A,String(e)),g.setAttribute(W,""),g.setAttribute("role","listitem"),g.tabIndex=0,g.className="sticky-line-content",g.classList.add("stickyLine".concat(t)),g.style.lineHeight="".concat(this._lineHeight,"px"),g.innerHTML=d;var f=document.createElement("span");f.setAttribute(A,String(e)),f.setAttribute("data-sticky-is-line-number",""),f.className="sticky-line-number",f.style.lineHeight="".concat(this._lineHeight,"px");var p=n.contentLeft;f.style.width="".concat(p,"px");var _=document.createElement("span");1===l.renderType||3===l.renderType&&t%10===0?_.innerText=t.toString():2===l.renderType&&(_.innerText=Math.abs(t-this._editor.getPosition().lineNumber).toString()),_.className="sticky-line-number-inner",_.style.lineHeight="".concat(this._lineHeight,"px"),_.style.width="".concat(n.lineNumbersWidth,"px"),_.style.paddingLeft="".concat(n.lineNumbersLeft,"px"),f.appendChild(_);var m=this._renderFoldingIconForLine(i,t);m&&f.appendChild(m.domNode),this._editor.applyFontInfo(g),this._editor.applyFontInfo(_),f.style.lineHeight="".concat(this._lineHeight,"px"),g.style.lineHeight="".concat(this._lineHeight,"px"),f.style.height="".concat(this._lineHeight,"px"),g.style.height="".concat(this._lineHeight,"px");var v=new G(e,t,g,f,m,h.characterMapping);return this._updateTopAndZIndexOfStickyLine(v)}}},{key:"_updateTopAndZIndexOfStickyLine",value:function(e){var t,i=e.index,n=e.lineDomNode,o=e.lineNumberDomNode,s=i===this._lineNumbers.length-1;n.style.zIndex=s?"0":"1",o.style.zIndex=s?"0":"1";var r="".concat(i*this._lineHeight+this._lastLineRelativePosition+((null===(t=e.foldingIcon)||void 0===t?void 0:t.isCollapsed)?1:0),"px"),a="".concat(i*this._lineHeight,"px");return n.style.top=s?r:a,o.style.top=s?r:a,e}},{key:"_renderFoldingIconForLine",value:function(e,t){var i=this._editor.getOption(109);if(e&&"never"!==i){var n=e.regions,o=n.findRange(t),s=n.getStartLineNumber(o);if(t===s){var r=n.isCollapsed(o),a=new B(r,s,n.getEndLineNumber(o),this._lineHeight);return a.setVisible(!!this._isOnGlyphMargin||(r||"always"===i)),a.domNode.setAttribute(V,""),a}}}},{key:"_updateMinContentWidth",value:function(){this._minContentWidthInPx=0;var e,t=(0,m.Z)(this._stickyLines);try{for(t.s();!(e=t.n()).done;){var i=e.value;i.lineDomNode.scrollWidth>this._minContentWidthInPx&&(this._minContentWidthInPx=i.lineDomNode.scrollWidth)}}catch(n){t.e(n)}finally{t.f()}this._minContentWidthInPx+=this._editor.getLayoutInfo().verticalScrollbarWidth}},{key:"getId",value:function(){return"editor.contrib.stickyScrollWidget"}},{key:"getDomNode",value:function(){return this._rootDomNode}},{key:"getPosition",value:function(){return{preference:null}}},{key:"getMinContentWidthInPx",value:function(){return this._minContentWidthInPx}},{key:"focusLineWithIndex",value:function(e){0<=e&&e<this._stickyLines.length&&this._stickyLines[e].lineDomNode.focus()}},{key:"getEditorPositionFromNode",value:function(e){if(!e||e.children.length>0)return null;var t=this._getRenderedStickyLineFromChildDomNode(e);if(!t)return null;var i=(0,I.dL)(t.characterMapping,e,0);return new T.L(t.lineNumber,i)}},{key:"getLineNumberFromChildDomNode",value:function(e){var t,i;return null!==(i=null===(t=this._getRenderedStickyLineFromChildDomNode(e))||void 0===t?void 0:t.lineNumber)&&void 0!==i?i:null}},{key:"_getRenderedStickyLineFromChildDomNode",value:function(e){var t=this.getLineIndexFromChildDomNode(e);return null===t||t<0||t>=this._stickyLines.length?null:this._stickyLines[t]}},{key:"getLineIndexFromChildDomNode",value:function(e){var t=this._getAttributeValue(e,A);return t?parseInt(t,10):null}},{key:"isInStickyLine",value:function(e){return void 0!==this._getAttributeValue(e,W)}},{key:"isInFoldingIconDomNode",value:function(e){return void 0!==this._getAttributeValue(e,V)}},{key:"_getAttributeValue",value:function(e,t){for(;e&&e!==this._rootDomNode;){var i=e.getAttribute(t);if(null!==i)return i;e=e.parentElement}}}]),i}(k.JT),G=(0,l.Z)((function e(t,i,n,o,s,r){(0,a.Z)(this,e),this.index=t,this.lineNumber=i,this.lineDomNode=n,this.lineNumberDomNode=o,this.foldingIcon=s,this.characterMapping=r})),B=function(){function e(t,i,n,o){(0,a.Z)(this,e),this.isCollapsed=t,this.foldingStartLine=i,this.foldingEndLine=n,this.dimension=o,this.domNode=document.createElement("div"),this.domNode.style.width="".concat(o,"px"),this.domNode.style.height="".concat(o,"px"),this.domNode.className=N.k.asClassName(t?R.f5:R.Iy)}return(0,l.Z)(e,[{key:"setVisible",value:function(e){this.domNode.style.cursor=e?"pointer":"default",this.domNode.style.opacity=e?"1":"0"}}]),e}(),K=i(7388),j=i(71049),U=i(13880),q=i(19536),$=i(40455),Q=i(44419),X=i(21039),J=i(69220),Y=i(74146),ee=(0,l.Z)((function e(t,i){(0,a.Z)(this,e),this.startLineNumber=t,this.endLineNumber=i})),te=(0,l.Z)((function e(t,i,n){(0,a.Z)(this,e),this.range=t,this.children=i,this.parent=n})),ie=(0,l.Z)((function e(t,i,n,o){(0,a.Z)(this,e),this.uri=t,this.version=i,this.element=n,this.outlineProviderId=o})),ne=i(12928),oe=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},se=function(e,t){return function(i,n){t(i,n,e)}},re=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};!function(e){e.OUTLINE_MODEL="outlineModel",e.FOLDING_PROVIDER_MODEL="foldingProviderModel",e.INDENTATION_MODEL="indentationModel"}(n||(n={})),function(e){e[e.VALID=0]="VALID",e[e.INVALID=1]="INVALID",e[e.CANCELED=2]="CANCELED"}(o||(o={}));var ae=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(e,o,s,r){var l;(0,a.Z)(this,i),(l=t.call(this))._editor=e,l._languageConfigurationService=o,l._languageFeaturesService=s,l._modelProviders=[],l._modelPromise=null,l._updateScheduler=l._register(new j.vp(300)),l._updateOperation=l._register(new k.SL);var d=new de(s),c=new he(l._editor,s),u=new ue(l._editor,o);switch(r){case n.OUTLINE_MODEL:l._modelProviders.push(d),l._modelProviders.push(c),l._modelProviders.push(u);break;case n.FOLDING_PROVIDER_MODEL:l._modelProviders.push(c),l._modelProviders.push(u);break;case n.INDENTATION_MODEL:l._modelProviders.push(u)}return l}return(0,l.Z)(i,[{key:"_cancelModelPromise",value:function(){this._modelPromise&&(this._modelPromise.cancel(),this._modelPromise=null)}},{key:"update",value:function(e,t,i){return re(this,void 0,void 0,(0,r.Z)().mark((function n(){var s=this;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this._updateOperation.clear(),this._updateOperation.add({dispose:function(){s._cancelModelPromise(),s._updateScheduler.cancel()}}),this._cancelModelPromise(),n.next=5,this._updateScheduler.trigger((function(){return re(s,void 0,void 0,(0,r.Z)().mark((function n(){var s,a,l,d,c,u,h;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:s=(0,m.Z)(this._modelProviders),n.prev=1,s.s();case 3:if((a=s.n()).done){n.next=20;break}return l=a.value,d=l.computeStickyModel(e,t,i),c=d.statusPromise,u=d.modelPromise,this._modelPromise=u,n.next=9,c;case 9:if(h=n.sent,this._modelPromise===u){n.next=12;break}return n.abrupt("return",null);case 12:n.t0=h,n.next=n.t0===o.CANCELED?15:n.t0===o.VALID?17:18;break;case 15:return this._updateOperation.clear(),n.abrupt("return",null);case 17:return n.abrupt("return",l.stickyModel);case 18:n.next=3;break;case 20:n.next=25;break;case 22:n.prev=22,n.t1=n.catch(1),s.e(n.t1);case 25:return n.prev=25,s.f(),n.finish(25);case 28:return n.abrupt("return",null);case 29:case"end":return n.stop()}}),n,this,[[1,22,25,28]])})))})).catch((function(e){return(0,Y.dL)(e),null}));case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n,this)})))}}]),i}(k.JT);ae=oe([se(1,q.c_),se(2,w.p)],ae);var le=function(){function e(){(0,a.Z)(this,e),this._stickyModel=null}return(0,l.Z)(e,[{key:"stickyModel",get:function(){return this._stickyModel}},{key:"_invalid",value:function(){return this._stickyModel=null,o.INVALID}},{key:"computeStickyModel",value:function(e,t,i){var n=this;if(i.isCancellationRequested||!this.isProviderValid(e))return{statusPromise:this._invalid(),modelPromise:null};var s=(0,j.PG)((function(i){return n.createModelFromProvider(e,t,i)}));return{statusPromise:s.then((function(s){return n.isModelValid(s)?i.isCancellationRequested?o.CANCELED:(n._stickyModel=n.createStickyModel(e,t,i,s),o.VALID):n._invalid()})).then(void 0,(function(e){return(0,Y.dL)(e),o.CANCELED})),modelPromise:s}}},{key:"isModelValid",value:function(e){return!0}},{key:"isProviderValid",value:function(e){return!0}}]),e}(),de=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this))._languageFeaturesService=e,n}return(0,l.Z)(i,[{key:"createModelFromProvider",value:function(e,t,i){return $.C3.create(this._languageFeaturesService.documentSymbolProvider,e,i)}},{key:"createStickyModel",value:function(e,t,i,n){var o,s=this._stickyModelFromOutlineModel(n,null===(o=this._stickyModel)||void 0===o?void 0:o.outlineProviderId),r=s.stickyOutlineElement,a=s.providerID;return new ie(e.uri,t,r,a)}},{key:"isModelValid",value:function(e){return e&&e.children.size>0}},{key:"_stickyModelFromOutlineModel",value:function(e,t){var i,n=this;if(ne.$.first(e.children.values())instanceof $.H3){var o=ne.$.find(e.children.values(),(function(e){return e.id===t}));if(o)i=o.children;else{var s,r="",a=-1,l=void 0,d=(0,m.Z)(e.children.entries());try{for(d.s();!(s=d.n()).done;){var c=(0,v.Z)(s.value,2),u=(c[0],c[1]),h=this._findSumOfRangesOfGroup(u);h>a&&(l=u,a=h,r=u.id)}}catch(b){d.e(b)}finally{d.f()}t=r,i=l.children}}else i=e.children;var g,f=[],p=Array.from(i.values()).sort((function(e,t){var i=new ee(e.symbol.range.startLineNumber,e.symbol.range.endLineNumber),o=new ee(t.symbol.range.startLineNumber,t.symbol.range.endLineNumber);return n._comparator(i,o)})),_=(0,m.Z)(p);try{for(_.s();!(g=_.n()).done;){var y=g.value;f.push(this._stickyModelFromOutlineElement(y,y.symbol.selectionRange.startLineNumber))}}catch(b){_.e(b)}finally{_.f()}return{stickyOutlineElement:new te(void 0,f,void 0),providerID:t}}},{key:"_stickyModelFromOutlineElement",value:function(e,t){var i,n=this,o=[],s=(0,m.Z)(e.children.values());try{for(s.s();!(i=s.n()).done;){var r=i.value;if(r.symbol.selectionRange.startLineNumber!==r.symbol.range.endLineNumber)if(r.symbol.selectionRange.startLineNumber!==t)o.push(this._stickyModelFromOutlineElement(r,r.symbol.selectionRange.startLineNumber));else{var a,l=(0,m.Z)(r.children.values());try{for(l.s();!(a=l.n()).done;){var d=a.value;o.push(this._stickyModelFromOutlineElement(d,r.symbol.selectionRange.startLineNumber))}}catch(u){l.e(u)}finally{l.f()}}}}catch(u){s.e(u)}finally{s.f()}o.sort((function(e,t){return n._comparator(e.range,t.range)}));var c=new ee(e.symbol.selectionRange.startLineNumber,e.symbol.range.endLineNumber);return new te(c,o,void 0)}},{key:"_comparator",value:function(e,t){return e.startLineNumber!==t.startLineNumber?e.startLineNumber-t.startLineNumber:t.endLineNumber-e.endLineNumber}},{key:"_findSumOfRangesOfGroup",value:function(e){var t,i=0,n=(0,m.Z)(e.children.values());try{for(n.s();!(t=n.n()).done;){var o=t.value;i+=this._findSumOfRangesOfGroup(o)}}catch(s){n.e(s)}finally{n.f()}return e instanceof $.sT?i+e.symbol.range.endLineNumber-e.symbol.selectionRange.startLineNumber:i}}]),i}(le);de=oe([se(0,w.p)],de);var ce=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(e){var n;return(0,a.Z)(this,i),(n=t.call(this))._foldingLimitReporter=new Q.RangesLimitReporter(e),n}return(0,l.Z)(i,[{key:"createStickyModel",value:function(e,t,i,n){var o=this._fromFoldingRegions(n);return new ie(e.uri,t,o,void 0)}},{key:"isModelValid",value:function(e){return null!==e}},{key:"_fromFoldingRegions",value:function(e){for(var t=e.length,i=[],n=new te(void 0,[],void 0),o=0;o<t;o++){var s=e.getParentIndex(o),r=void 0;r=-1!==s?i[s]:n;var a=new te(new ee(e.getStartLineNumber(o),e.getEndLineNumber(o)+1),[],r);r.children.push(a),i.push(a)}return n}}]),i}(le),ue=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(e,n){var o;return(0,a.Z)(this,i),(o=t.call(this,e))._languageConfigurationService=n,o}return(0,l.Z)(i,[{key:"createModelFromProvider",value:function(e,t,i){return new J.aI(e,this._languageConfigurationService,this._foldingLimitReporter).compute(i)}}]),i}(ce);ue=oe([se(1,q.c_)],ue);var he=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(e,n){var o;return(0,a.Z)(this,i),(o=t.call(this,e))._languageFeaturesService=n,o}return(0,l.Z)(i,[{key:"isProviderValid",value:function(e){return Q.FoldingController.getFoldingRangeProviders(this._languageFeaturesService,e).length>0}},{key:"createModelFromProvider",value:function(e,t,i){var n=this,o=Q.FoldingController.getFoldingRangeProviders(this._languageFeaturesService,e);return new X.e(e,o,(function(){return n.createModelFromProvider(e,t,i)}),this._foldingLimitReporter,void 0).compute(i)}}]),i}(ce);he=oe([se(1,w.p)],he);var ge=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},fe=function(e,t){return function(i,n){t(i,n,e)}},pe=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))},_e=(0,l.Z)((function e(t,i,n){(0,a.Z)(this,e),this.startLineNumber=t,this.endLineNumber=i,this.nestingDepth=n})),me=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(e,n,o){var s;return(0,a.Z)(this,i),(s=t.call(this))._languageFeaturesService=n,s._languageConfigurationService=o,s._onDidChangeStickyScroll=s._register(new U.Q5),s.onDidChangeStickyScroll=s._onDidChangeStickyScroll.event,s._options=null,s._model=null,s._cts=null,s._stickyModelProvider=null,s._editor=e,s._sessionStore=s._register(new k.SL),s._updateSoon=s._register(new j.pY((function(){return s.update()}),50)),s._register(s._editor.onDidChangeConfiguration((function(e){e.hasChanged(114)&&s.readConfiguration()}))),s.readConfiguration(),s}return(0,l.Z)(i,[{key:"readConfiguration",value:function(){var e=this;this._stickyModelProvider=null,this._sessionStore.clear(),this._options=this._editor.getOption(114),this._options.enabled&&(this._stickyModelProvider=this._sessionStore.add(new ae(this._editor,this._languageConfigurationService,this._languageFeaturesService,this._options.defaultModel)),this._sessionStore.add(this._editor.onDidChangeModel((function(){e._model=null,e._onDidChangeStickyScroll.fire(),e.update()}))),this._sessionStore.add(this._editor.onDidChangeHiddenAreas((function(){return e.update()}))),this._sessionStore.add(this._editor.onDidChangeModelContent((function(){return e._updateSoon.schedule()}))),this._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange((function(){return e.update()}))),this.update())}},{key:"getVersionId",value:function(){var e;return null===(e=this._model)||void 0===e?void 0:e.version}},{key:"update",value:function(){var e;return pe(this,void 0,void 0,(0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null===(e=this._cts)||void 0===e||e.dispose(!0),this._cts=new K.A,t.next=4,this.updateStickyModel(this._cts.token);case 4:this._onDidChangeStickyScroll.fire();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"updateStickyModel",value:function(e){return pe(this,void 0,void 0,(0,r.Z)().mark((function t(){var i,n,o;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._editor.hasModel()&&this._stickyModelProvider&&!this._editor.getModel().isTooLargeForTokenization()){t.next=3;break}return this._model=null,t.abrupt("return");case 3:return i=this._editor.getModel(),n=i.getVersionId(),t.next=7,this._stickyModelProvider.update(i,n,e);case 7:if(o=t.sent,!e.isCancellationRequested){t.next=10;break}return t.abrupt("return");case 10:this._model=o;case 11:case"end":return t.stop()}}),t,this)})))}},{key:"updateIndex",value:function(e){return-1===e?e=0:e<0&&(e=-e-2),e}},{key:"getCandidateStickyLinesIntersectingFromStickyModel",value:function(e,t,i,n,o){if(0!==t.children.length){for(var s=o,r=[],a=0;a<t.children.length;a++){var l=t.children[a];l.range&&r.push(l.range.startLineNumber)}for(var d=this.updateIndex((0,L.ry)(r,e.startLineNumber,(function(e,t){return e-t}))),c=this.updateIndex((0,L.ry)(r,e.startLineNumber+n,(function(e,t){return e-t}))),u=d;u<=c;u++){var h=t.children[u];if(!h)return;if(h.range){var g=h.range.startLineNumber,f=h.range.endLineNumber;e.startLineNumber<=f+1&&g-1<=e.endLineNumber&&g!==s&&(s=g,i.push(new _e(g,f-1,n+1)),this.getCandidateStickyLinesIntersectingFromStickyModel(e,h,i,n+1,g))}else this.getCandidateStickyLinesIntersectingFromStickyModel(e,h,i,n,o)}}}},{key:"getCandidateStickyLinesIntersecting",value:function(e){var t,i;if(!(null===(t=this._model)||void 0===t?void 0:t.element))return[];var n=[];this.getCandidateStickyLinesIntersectingFromStickyModel(e,this._model.element,n,0,-1);var o=null===(i=this._editor._getViewModel())||void 0===i?void 0:i.getHiddenAreas();if(o){var s,r=(0,m.Z)(o);try{var a=function(){var e=s.value;n=n.filter((function(t){return!(t.startLineNumber>=e.startLineNumber&&t.endLineNumber<=e.endLineNumber+1)}))};for(r.s();!(s=r.n()).done;)a()}catch(l){r.e(l)}finally{r.f()}}return n}}]),i}(k.JT);me=ge([fe(1,w.p),fe(2,q.c_)],me);var ve,ye=i(64606),be=i(92361),Se=i(64124),ke=i(17429),we=i(94738),Ce=i(32993),xe=i(68200),De=i(32990),Le=i(63134),Ne=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},Ie=function(e,t){return function(i,n){t(i,n,e)}},Fe=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))},Te=ve=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(e,n,o,s,l,d,c){var u;(0,a.Z)(this,i),(u=t.call(this))._editor=e,u._contextMenuService=n,u._languageFeaturesService=o,u._instaService=s,u._contextKeyService=c,u._sessionStore=new k.SL,u._foldingModel=null,u._maxStickyLines=Number.MAX_SAFE_INTEGER,u._candidateDefinitionsLength=-1,u._focusedStickyElementIndex=-1,u._enabled=!1,u._focused=!1,u._positionRevealed=!1,u._onMouseDown=!1,u._endLineNumbers=[],u._showEndForLine=null,u._stickyScrollWidget=new H(u._editor),u._stickyLineCandidateProvider=new me(u._editor,o,l),u._register(u._stickyScrollWidget),u._register(u._stickyLineCandidateProvider),u._widgetState=new Z([],[],0),u._readConfiguration();var h=u._stickyScrollWidget.getDomNode();u._register(u._editor.onDidChangeConfiguration((function(e){(e.hasChanged(114)||e.hasChanged(72)||e.hasChanged(66)||e.hasChanged(109))&&u._readConfiguration()}))),u._register(x.addDisposableListener(h,x.EventType.CONTEXT_MENU,(function(e){return Fe((0,y.Z)(u),void 0,void 0,(0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._onContextMenu(e);case 1:case"end":return t.stop()}}),t,this)})))}))),u._stickyScrollFocusedContextKey=_.u.stickyScrollFocused.bindTo(u._contextKeyService),u._stickyScrollVisibleContextKey=_.u.stickyScrollVisible.bindTo(u._contextKeyService);var g=u._register(x.trackFocus(h));return u._register(g.onDidBlur((function(e){!1===u._positionRevealed&&0===h.clientHeight?(u._focusedStickyElementIndex=-1,u.focus()):u._disposeFocusStickyScrollStore()}))),u._register(g.onDidFocus((function(e){u.focus()}))),u._registerMouseListeners(),u._register(x.addDisposableListener(h,x.EventType.MOUSE_DOWN,(function(e){u._onMouseDown=!0}))),u}return(0,l.Z)(i,[{key:"_disposeFocusStickyScrollStore",value:function(){var e;this._stickyScrollFocusedContextKey.set(!1),null===(e=this._focusDisposableStore)||void 0===e||e.dispose(),this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1}},{key:"focus",value:function(){if(this._onMouseDown)return this._onMouseDown=!1,void this._editor.focus();!0!==this._stickyScrollFocusedContextKey.get()&&(this._focused=!0,this._focusDisposableStore=new k.SL,this._stickyScrollFocusedContextKey.set(!0),this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumbers.length-1,this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex))}},{key:"focusNext",value:function(){this._focusedStickyElementIndex<this._stickyScrollWidget.lineNumberCount-1&&this._focusNav(!0)}},{key:"focusPrevious",value:function(){this._focusedStickyElementIndex>0&&this._focusNav(!1)}},{key:"selectEditor",value:function(){this._editor.focus()}},{key:"_focusNav",value:function(e){this._focusedStickyElementIndex=e?this._focusedStickyElementIndex+1:this._focusedStickyElementIndex-1,this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex)}},{key:"goToFocused",value:function(){var e=this._stickyScrollWidget.lineNumbers;this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:e[this._focusedStickyElementIndex],column:1})}},{key:"_revealPosition",value:function(e){var t=this;this._reveaInEditor(e,(function(){return t._editor.revealPosition(e)}))}},{key:"_revealLineInCenterIfOutsideViewport",value:function(e){var t=this;this._reveaInEditor(e,(function(){return t._editor.revealLineInCenterIfOutsideViewport(e.lineNumber,0)}))}},{key:"_reveaInEditor",value:function(e,t){this._focused&&this._disposeFocusStickyScrollStore(),this._positionRevealed=!0,t(),this._editor.setSelection(ke.e.fromPositions(e)),this._editor.focus()}},{key:"_registerMouseListeners",value:function(){var e=this,t=this._register(new k.SL),i=this._register(new Se.yN(this._editor,{extractLineNumberFromMouseEvent:function(t){var i=e._stickyScrollWidget.getEditorPositionFromNode(t.target.element);return i?i.lineNumber:0}})),n=function(t){if(!e._editor.hasModel())return null;if(12!==t.target.type||t.target.detail!==e._stickyScrollWidget.getId())return null;var i=t.target.element;if(!i||i.innerText!==i.innerHTML)return null;var n=e._stickyScrollWidget.getEditorPositionFromNode(i);return n?{range:new ke.e(n.lineNumber,n.column,n.lineNumber,n.column+i.innerText.length),textElement:i}:null},o=this._stickyScrollWidget.getDomNode();this._register(x.addStandardDisposableListener(o,x.EventType.CLICK,(function(t){if(!(t.ctrlKey||t.altKey||t.metaKey)&&t.leftButton)if(t.shiftKey){var i=e._stickyScrollWidget.getLineIndexFromChildDomNode(t.target);if(null===i)return;var n=new T.L(e._endLineNumbers[i],1);e._revealLineInCenterIfOutsideViewport(n)}else{if(e._stickyScrollWidget.isInFoldingIconDomNode(t.target)){var o=e._stickyScrollWidget.getLineNumberFromChildDomNode(t.target);e._toggleFoldingRegionForLine(o)}else{if(e._stickyScrollWidget.isInStickyLine(t.target)){var s=e._stickyScrollWidget.getEditorPositionFromNode(t.target);if(!s){var r=e._stickyScrollWidget.getLineNumberFromChildDomNode(t.target);if(null===r)return;s=new T.L(r,1)}e._revealPosition(s)}}}}))),this._register(x.addStandardDisposableListener(o,x.EventType.MOUSE_MOVE,(function(t){if(t.shiftKey){var i=e._stickyScrollWidget.getLineIndexFromChildDomNode(t.target);if(null===i||null!==e._showEndForLine&&e._showEndForLine===i)return;return e._showEndForLine=i,void e._renderStickyScroll()}null!==e._showEndForLine&&(e._showEndForLine=null,e._renderStickyScroll())}))),this._register(x.addDisposableListener(o,x.EventType.MOUSE_LEAVE,(function(t){null!==e._showEndForLine&&(e._showEndForLine=null,e._renderStickyScroll())}))),this._register(i.onMouseMoveOrRelevantKeyDown((function(i){var o=(0,v.Z)(i,2),s=o[0],r=(o[1],n(s));if(r&&s.hasTriggerModifier&&e._editor.hasModel()){var a=r.range,l=r.textElement;if(a.equalsRange(e._stickyRangeProjectedOnEditor)){if("underline"===l.style.textDecoration)return}else e._stickyRangeProjectedOnEditor=a,t.clear();var d,c=new K.A;t.add((0,k.OF)((function(){return c.dispose(!0)}))),(0,we.nD)(e._languageFeaturesService.definitionProvider,e._editor.getModel(),new T.L(a.startLineNumber,a.startColumn+1),c.token).then((function(i){if(!c.token.isCancellationRequested)if(0!==i.length){e._candidateDefinitionsLength=i.length;var n=l;d!==n?(t.clear(),(d=n).style.textDecoration="underline",t.add((0,k.OF)((function(){d.style.textDecoration="none"})))):d||((d=n).style.textDecoration="underline",t.add((0,k.OF)((function(){d.style.textDecoration="none"}))))}else t.clear()}))}else t.clear()}))),this._register(i.onCancel((function(){t.clear()}))),this._register(i.onExecute((function(t){return Fe(e,void 0,void 0,(0,r.Z)().mark((function e(){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(12===t.target.type&&t.target.detail===this._stickyScrollWidget.getId()){e.next=2;break}return e.abrupt("return");case 2:if(i=this._stickyScrollWidget.getEditorPositionFromNode(t.target.element)){e.next=5;break}return e.abrupt("return");case 5:this._candidateDefinitionsLength>1&&(this._focused&&this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:i.lineNumber,column:1})),this._instaService.invokeFunction(Ce.K,t,this._editor,{uri:this._editor.getModel().uri,range:this._stickyRangeProjectedOnEditor});case 7:case"end":return e.stop()}}),e,this)})))})))}},{key:"_onContextMenu",value:function(e){var t=new De.n(e);this._contextMenuService.showContextMenu({menuId:g.eH.StickyScrollContext,getAnchor:function(){return t}})}},{key:"_toggleFoldingRegionForLine",value:function(e){if(this._foldingModel&&null!==e){var t=this._stickyScrollWidget.getStickyLineForLine(e),i=null===t||void 0===t?void 0:t.foldingIcon;if(i){(0,Le.d8)(this._foldingModel,Number.MAX_VALUE,[e]),i.isCollapsed=!i.isCollapsed;var n=(i.isCollapsed?this._editor.getTopForLineNumber(i.foldingEndLine):this._editor.getTopForLineNumber(i.foldingStartLine))-this._editor.getOption(66)*t.index+1;this._editor.setScrollTop(n),this._renderStickyScroll(e)}}}},{key:"_readConfiguration",value:function(){var e=this,t=this._editor.getOption(114);if(!1===t.enabled)return this._editor.removeOverlayWidget(this._stickyScrollWidget),this._sessionStore.clear(),void(this._enabled=!1);t.enabled&&!this._enabled&&(this._editor.addOverlayWidget(this._stickyScrollWidget),this._sessionStore.add(this._editor.onDidScrollChange((function(t){t.scrollTopChanged&&(e._showEndForLine=null,e._renderStickyScroll())}))),this._sessionStore.add(this._editor.onDidLayoutChange((function(){return e._onDidResize()}))),this._sessionStore.add(this._editor.onDidChangeModelTokens((function(t){return e._onTokensChange(t)}))),this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll((function(){e._showEndForLine=null,e._renderStickyScroll()}))),this._enabled=!0),2===this._editor.getOption(67).renderType&&this._sessionStore.add(this._editor.onDidChangeCursorPosition((function(){e._showEndForLine=null,e._renderStickyScroll()})))}},{key:"_needsUpdate",value:function(e){var t,i=this._stickyScrollWidget.getCurrentLines(),n=(0,m.Z)(i);try{for(n.s();!(t=n.n()).done;){var o,s=t.value,r=(0,m.Z)(e.ranges);try{for(r.s();!(o=r.n()).done;){var a=o.value;if(s>=a.fromLineNumber&&s<=a.toLineNumber)return!0}}catch(l){r.e(l)}finally{r.f()}}}catch(l){n.e(l)}finally{n.f()}return!1}},{key:"_onTokensChange",value:function(e){this._needsUpdate(e)&&this._renderStickyScroll(-1)}},{key:"_onDidResize",value:function(){var e=this._editor.getLayoutInfo().height/this._editor.getOption(66);this._maxStickyLines=Math.round(.25*e)}},{key:"_renderStickyScroll",value:function(){var e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return Fe(this,void 0,void 0,(0,r.Z)().mark((function n(){var o,s,a;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((o=this._editor.getModel())&&!o.isTooLargeForTokenization()){n.next=5;break}return this._foldingModel=null,this._stickyScrollWidget.setState(void 0,null,i),n.abrupt("return");case 5:if(void 0!==(s=this._stickyLineCandidateProvider.getVersionId())&&s!==o.getVersionId()){n.next=22;break}return n.next=9,null===(e=Q.FoldingController.get(this._editor))||void 0===e?void 0:e.getFoldingModel();case 9:if(n.t1=t=n.sent,n.t0=null!==n.t1,!n.t0){n.next=13;break}n.t0=void 0!==t;case 13:if(!n.t0){n.next=17;break}n.t2=t,n.next=18;break;case 17:n.t2=null;case 18:this._foldingModel=n.t2,this._widgetState=this.findScrollWidgetState(),this._stickyScrollVisibleContextKey.set(!(0===this._widgetState.startLineNumbers.length)),this._focused?-1===this._focusedStickyElementIndex?(this._stickyScrollWidget.setState(this._widgetState,this._foldingModel,i),this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumberCount-1,-1!==this._focusedStickyElementIndex&&this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex)):(a=this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex],this._stickyScrollWidget.setState(this._widgetState,this._foldingModel,i),0===this._stickyScrollWidget.lineNumberCount?this._focusedStickyElementIndex=-1:(this._stickyScrollWidget.lineNumbers.includes(a)||(this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumberCount-1),this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex))):this._stickyScrollWidget.setState(this._widgetState,this._foldingModel,i);case 22:case"end":return n.stop()}}),n,this)})))}},{key:"findScrollWidgetState",value:function(){var e=this._editor.getOption(66),t=Math.min(this._maxStickyLines,this._editor.getOption(114).maxLineCount),i=this._editor.getScrollTop(),n=0,o=[],s=[],r=this._editor.getVisibleRanges();if(0!==r.length){var a,l=new ee(r[0].startLineNumber,r[r.length-1].endLineNumber),d=this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(l),c=(0,m.Z)(d);try{for(c.s();!(a=c.n()).done;){var u=a.value,h=u.startLineNumber,g=u.endLineNumber,f=u.nestingDepth;if(g-h>0){var p=(f-1)*e,_=f*e,v=this._editor.getBottomForLineNumber(h)-i,y=this._editor.getTopForLineNumber(g)-i,b=this._editor.getBottomForLineNumber(g)-i;if(p>y&&p<=b){o.push(h),s.push(g+1),n=b-_;break}if(_>v&&_<=b&&(o.push(h),s.push(g+1)),o.length===t)break}}}catch(S){c.e(S)}finally{c.f()}}return this._endLineNumbers=s,new Z(o,s,n,this._showEndForLine)}},{key:"dispose",value:function(){(0,b.Z)((0,S.Z)(i.prototype),"dispose",this).call(this),this._sessionStore.dispose()}}],[{key:"get",value:function(e){return e.getContribution(ve.ID)}}]),i}(k.JT);Te.ID="store.contrib.stickyScrollController",Te=ve=Ne([Ie(1,be.i),Ie(2,w.p),Ie(3,ye.TG),Ie(4,q.c_),Ie(5,xe.A),Ie(6,p.i6)],Te);var Pe=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))},Me=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(){return(0,a.Z)(this,i),t.call(this,{id:"editor.action.toggleStickyScroll",title:{value:(0,u.NC)("toggleStickyScroll","Toggle Sticky Scroll"),mnemonicTitle:(0,u.NC)({key:"mitoggleStickyScroll",comment:["&& denotes a mnemonic"]},"&&Toggle Sticky Scroll"),original:"Toggle Sticky Scroll"},category:h.R.View,toggled:{condition:p.Ao.equals("config.editor.stickyScroll.enabled",!0),title:(0,u.NC)("stickyScroll","Sticky Scroll"),mnemonicTitle:(0,u.NC)({key:"miStickyScroll",comment:["&& denotes a mnemonic"]},"&&Sticky Scroll")},menu:[{id:g.eH.CommandPalette},{id:g.eH.MenubarAppearanceMenu,group:"4_editor",order:3},{id:g.eH.StickyScrollContext}]})}return(0,l.Z)(i,[{key:"run",value:function(e){return Pe(this,void 0,void 0,(0,r.Z)().mark((function t(){var i,n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.get(f.Ui),n=!i.getValue("editor.stickyScroll.enabled"),t.abrupt("return",i.updateValue("editor.stickyScroll.enabled",n));case 3:case"end":return t.stop()}}),t)})))}}]),i}(g.Ke),Ee=100,Re=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(){return(0,a.Z)(this,i),t.call(this,{id:"editor.action.focusStickyScroll",title:{value:(0,u.NC)("focusStickyScroll","Focus Sticky Scroll"),mnemonicTitle:(0,u.NC)({key:"mifocusStickyScroll",comment:["&& denotes a mnemonic"]},"&&Focus Sticky Scroll"),original:"Focus Sticky Scroll"},precondition:p.Ao.and(p.Ao.has("config.editor.stickyScroll.enabled"),_.u.stickyScrollVisible),menu:[{id:g.eH.CommandPalette}]})}return(0,l.Z)(i,[{key:"runEditorCommand",value:function(e,t){var i;null===(i=Te.get(t))||void 0===i||i.focus()}}]),i}(s.x1),Oe=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(){return(0,a.Z)(this,i),t.call(this,{id:"editor.action.selectNextStickyScrollLine",title:{value:(0,u.NC)("selectNextStickyScrollLine.title","Select next sticky scroll line"),original:"Select next sticky scroll line"},precondition:_.u.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:Ee,primary:18}})}return(0,l.Z)(i,[{key:"runEditorCommand",value:function(e,t){var i;null===(i=Te.get(t))||void 0===i||i.focusNext()}}]),i}(s.x1),Ze=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(){return(0,a.Z)(this,i),t.call(this,{id:"editor.action.selectPreviousStickyScrollLine",title:{value:(0,u.NC)("selectPreviousStickyScrollLine.title","Select previous sticky scroll line"),original:"Select previous sticky scroll line"},precondition:_.u.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:Ee,primary:16}})}return(0,l.Z)(i,[{key:"runEditorCommand",value:function(e,t){var i;null===(i=Te.get(t))||void 0===i||i.focusPrevious()}}]),i}(s.x1),ze=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(){return(0,a.Z)(this,i),t.call(this,{id:"editor.action.goToFocusedStickyScrollLine",title:{value:(0,u.NC)("goToFocusedStickyScrollLine.title","Go to focused sticky scroll line"),original:"Go to focused sticky scroll line"},precondition:_.u.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:Ee,primary:3}})}return(0,l.Z)(i,[{key:"runEditorCommand",value:function(e,t){var i;null===(i=Te.get(t))||void 0===i||i.goToFocused()}}]),i}(s.x1),Ae=function(e){(0,d.Z)(i,e);var t=(0,c.Z)(i);function i(){return(0,a.Z)(this,i),t.call(this,{id:"editor.action.selectEditor",title:{value:(0,u.NC)("selectEditor.title","Select Editor"),original:"Select Editor"},precondition:_.u.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:Ee,primary:9}})}return(0,l.Z)(i,[{key:"runEditorCommand",value:function(e,t){var i;null===(i=Te.get(t))||void 0===i||i.selectEditor()}}]),i}(s.x1);(0,s._K)(Te.ID,Te,1),(0,g.r1)(Me),(0,g.r1)(Re),(0,g.r1)(Ze),(0,g.r1)(Oe),(0,g.r1)(ze),(0,g.r1)(Ae)},47799:function(e,t,i){i.d(t,{_:function(){return u},t:function(){return c}});var n=i(29439),o=i(37762),s=i(43144),r=i(15671),a=i(38102),l=i(21973),d=i(31906),c=(0,s.Z)((function e(t,i){(0,r.Z)(this,e),this.leadingLineContent=t,this.characterCountDelta=i})),u=function(){function e(t,i,n,o,s,a){var d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:l.mX.default,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0;(0,r.Z)(this,e),this.clipboardText=c,this._snippetCompareFn=e._compareCompletionItems,this._items=t,this._column=i,this._wordDistance=o,this._options=s,this._refilterKind=1,this._lineContext=n,this._fuzzyScoreOptions=d,"top"===a?this._snippetCompareFn=e._compareCompletionItemsSnippetsUp:"bottom"===a&&(this._snippetCompareFn=e._compareCompletionItemsSnippetsDown)}return(0,s.Z)(e,[{key:"lineContext",get:function(){return this._lineContext},set:function(e){this._lineContext.leadingLineContent===e.leadingLineContent&&this._lineContext.characterCountDelta===e.characterCountDelta||(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}},{key:"items",get:function(){return this._ensureCachedState(),this._filteredItems}},{key:"getItemsByProvider",value:function(){return this._ensureCachedState(),this._itemsByProvider}},{key:"getIncompleteProvider",value:function(){this._ensureCachedState();var e,t=new Set,i=(0,o.Z)(this.getItemsByProvider());try{for(i.s();!(e=i.n()).done;){var s=(0,n.Z)(e.value,2),r=s[0],a=s[1];a.length>0&&a[0].container.incomplete&&t.add(r)}}catch(l){i.e(l)}finally{i.f()}return t}},{key:"stats",get:function(){return this._ensureCachedState(),this._stats}},{key:"_ensureCachedState",value:function(){0!==this._refilterKind&&this._createCachedState()}},{key:"_createCachedState",value:function(){this._itemsByProvider=new Map;for(var e=[],t=this._lineContext,i=t.leadingLineContent,n=t.characterCountDelta,o="",s="",r=1===this._refilterKind?this._items:this._filteredItems,c=[],u=!this._options.filterGraceful||r.length>2e3?l.EW:l.l7,h=0;h<r.length;h++){var g=r[h];if(!g.isInvalid){var f=this._itemsByProvider.get(g.provider);f?f.push(g):this._itemsByProvider.set(g.provider,[g]);var p=g.position.column-g.editStart.column,_=p+n-(g.position.column-this._column);if(o.length!==_&&(s=(o=0===_?"":i.slice(-_)).toLowerCase()),g.word=o,0===_)g.score=l.CL.Default;else{for(var m=0;m<p;){var v=o.charCodeAt(m);if(32!==v&&9!==v)break;m+=1}if(m>=_)g.score=l.CL.Default;else if("string"===typeof g.completion.filterText){var y=u(o,s,m,g.completion.filterText,g.filterTextLow,0,this._fuzzyScoreOptions);if(!y)continue;0===(0,d.zY)(g.completion.filterText,g.textLabel)?g.score=y:(g.score=(0,l.jB)(o,s,m,g.textLabel,g.labelLow,0),g.score[0]=y[0])}else{var b=u(o,s,m,g.textLabel,g.labelLow,0,this._fuzzyScoreOptions);if(!b)continue;g.score=b}}g.idx=h,g.distance=this._wordDistance.distance(g.position,g.completion),c.push(g),e.push(g.textLabel.length)}}this._filteredItems=c.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:e.length?(0,a.HW)(e.length-.85,e,(function(e,t){return e-t})):0}}}],[{key:"_compareCompletionItems",value:function(e,t){return e.score[0]>t.score[0]?-1:e.score[0]<t.score[0]?1:e.distance<t.distance?-1:e.distance>t.distance?1:e.idx<t.idx?-1:e.idx>t.idx?1:0}},{key:"_compareCompletionItemsSnippetsDown",value:function(t,i){if(t.completion.kind!==i.completion.kind){if(27===t.completion.kind)return 1;if(27===i.completion.kind)return-1}return e._compareCompletionItems(t,i)}},{key:"_compareCompletionItemsSnippetsUp",value:function(t,i){if(t.completion.kind!==i.completion.kind){if(27===t.completion.kind)return-1;if(27===i.completion.kind)return 1}return e._compareCompletionItems(t,i)}}]),e}()},51211:function(e,t,i){i.d(t,{A9:function(){return I},GI:function(){return L},ZJ:function(){return F},_y:function(){return D},i5:function(){return R},kL:function(){return P},tG:function(){return O}});var n,o=i(37762),s=i(74165),r=i(15671),a=i(43144),l=i(7388),d=i(74146),c=i(21973),u=i(65096),h=i(48497),g=i(63021),f=i(38821),p=i(65631),_=i(17429),m=i(7787),v=i(88324),y=i(18420),b=i(14443),S=i(99740),k=i(8022),w=i(65441),C=i(46689),x=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))},D={Visible:C.iX,HasFocusedSuggestion:new k.uy("suggestWidgetHasFocusedSuggestion",!1,(0,y.NC)("suggestWidgetHasSelection","Whether any suggestion is focused")),DetailsVisible:new k.uy("suggestWidgetDetailsVisible",!1,(0,y.NC)("suggestWidgetDetailsVisible","Whether suggestion details are visible")),MultipleSuggestions:new k.uy("suggestWidgetMultipleSuggestions",!1,(0,y.NC)("suggestWidgetMultipleSuggestions","Whether there are multiple suggestions to pick from")),MakesTextEdit:new k.uy("suggestionMakesTextEdit",!0,(0,y.NC)("suggestionMakesTextEdit","Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new k.uy("acceptSuggestionOnEnter",!0,(0,y.NC)("acceptSuggestionOnEnter","Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new k.uy("suggestionHasInsertAndReplaceRange",!1,(0,y.NC)("suggestionHasInsertAndReplaceRange","Whether the current suggestion has insert and replace behaviour")),InsertMode:new k.uy("suggestionInsertMode",void 0,{type:"string",description:(0,y.NC)("suggestionInsertMode","Whether the default behaviour is to insert or replace")}),CanResolve:new k.uy("suggestionCanResolve",!1,(0,y.NC)("suggestionCanResolve","Whether the current suggestion supports to resolve further details"))},L=new b.eH("suggestWidgetStatusBar"),N=function(){function e(t,i,n,o){var s;(0,r.Z)(this,e),this.position=t,this.completion=i,this.container=n,this.provider=o,this.isInvalid=!1,this.score=c.CL.Default,this.distance=0,this.textLabel="string"===typeof i.label?i.label:null===(s=i.label)||void 0===s?void 0:s.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=i.sortText&&i.sortText.toLowerCase(),this.filterTextLow=i.filterText&&i.filterText.toLowerCase(),this.extensionId=i.extensionId,_.e.isIRange(i.range)?(this.editStart=new p.L(i.range.startLineNumber,i.range.startColumn),this.editInsertEnd=new p.L(i.range.endLineNumber,i.range.endColumn),this.editReplaceEnd=new p.L(i.range.endLineNumber,i.range.endColumn),this.isInvalid=this.isInvalid||_.e.spansMultipleLines(i.range)||i.range.startLineNumber!==t.lineNumber):(this.editStart=new p.L(i.range.insert.startLineNumber,i.range.insert.startColumn),this.editInsertEnd=new p.L(i.range.insert.endLineNumber,i.range.insert.endColumn),this.editReplaceEnd=new p.L(i.range.replace.endLineNumber,i.range.replace.endColumn),this.isInvalid=this.isInvalid||_.e.spansMultipleLines(i.range.insert)||_.e.spansMultipleLines(i.range.replace)||i.range.insert.startLineNumber!==t.lineNumber||i.range.replace.startLineNumber!==t.lineNumber||i.range.insert.startColumn!==i.range.replace.startColumn),"function"!==typeof o.resolveCompletionItem&&(this._resolveCache=Promise.resolve(),this._resolveDuration=0)}return(0,a.Z)(e,[{key:"isResolved",get:function(){return void 0!==this._resolveDuration}},{key:"resolveDuration",get:function(){return void 0!==this._resolveDuration?this._resolveDuration:-1}},{key:"resolve",value:function(e){return x(this,void 0,void 0,(0,s.Z)().mark((function t(){var i,n,o=this;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._resolveCache||(i=e.onCancellationRequested((function(){o._resolveCache=void 0,o._resolveDuration=void 0})),n=new h.G(!0),this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,e)).then((function(e){Object.assign(o.completion,e),o._resolveDuration=n.elapsed()}),(function(e){(0,d.n2)(e)&&(o._resolveCache=void 0,o._resolveDuration=void 0)})).finally((function(){i.dispose()}))),t.abrupt("return",this._resolveCache);case 2:case"end":return t.stop()}}),t,this)})))}}]),e}(),I=(0,a.Z)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Map,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];(0,r.Z)(this,e),this.snippetSortOrder=t,this.kindFilter=i,this.providerFilter=n,this.providerItemsToReuse=o,this.showDeprecated=s}));function F(){return n}I.default=new I;var T=(0,a.Z)((function e(t,i,n,o){(0,r.Z)(this,e),this.items=t,this.needsClipboard=i,this.durations=n,this.disposable=o}));function P(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I.default,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{triggerKind:0},c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:l.T.None;return x(this,void 0,void 0,(0,s.Z)().mark((function l(){var g,f,p,m,y,b,S,k,w,C,D,L,I,F=this;return(0,s.Z)().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:g=new h.G,i=i.clone(),f=t.getWordAtPosition(i),p=f?new _.e(i.lineNumber,f.startColumn,i.lineNumber,f.endColumn):_.e.fromPositions(i),m={replace:p,insert:p.setEndPosition(i.lineNumber,i.column)},y=[],b=new u.SL,S=[],k=!1,w=function(e,t,n){var s,a,l,d=!1;if(!t)return d;var c,h=(0,o.Z)(t.suggestions);try{for(h.s();!(c=h.n()).done;){var g=c.value;if(!r.kindFilter.has(g.kind)){if(!r.showDeprecated&&(null===(s=null===g||void 0===g?void 0:g.tags)||void 0===s?void 0:s.includes(1)))continue;g.range||(g.range=m),g.sortText||(g.sortText="string"===typeof g.label?g.label:g.label.label),!k&&g.insertTextRules&&4&g.insertTextRules&&(k=v.Yj.guessNeedsClipboard(g.insertText)),y.push(new N(i,g,t,e)),d=!0}}}catch(f){h.e(f)}finally{h.f()}return(0,u.Wf)(t)&&b.add(t),S.push({providerName:null!==(a=e._debugDisplayName)&&void 0!==a?a:"unknown_provider",elapsedProvider:null!==(l=t.duration)&&void 0!==l?l:-1,elapsedOverall:n.elapsed()}),d},C=x(F,void 0,void 0,(0,s.Z)().mark((function e(){var o,l,d;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!r.kindFilter.has(27)){e.next=2;break}return e.abrupt("return");case 2:if(!(o=r.providerItemsToReuse.get(n))){e.next=6;break}return o.forEach((function(e){return y.push(e)})),e.abrupt("return");case 6:if(!(r.providerFilter.size>0)||r.providerFilter.has(n)){e.next=8;break}return e.abrupt("return");case 8:return l=new h.G,e.next=11,n.provideCompletionItems(t,i,a,c);case 11:d=e.sent,w(n,d,l);case 13:case"end":return e.stop()}}),e)}))),D=(0,o.Z)(e.orderedGroups(t)),l.prev=12,I=(0,s.Z)().mark((function e(){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=L.value,o=!1,e.next=4,Promise.all(n.map((function(e){return x(F,void 0,void 0,(0,s.Z)().mark((function n(){var l,u,g;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!r.providerItemsToReuse.has(e)){n.next=5;break}return(l=r.providerItemsToReuse.get(e)).forEach((function(e){return y.push(e)})),o=o||l.length>0,n.abrupt("return");case 5:if(!(r.providerFilter.size>0)||r.providerFilter.has(e)){n.next=7;break}return n.abrupt("return");case 7:return n.prev=7,u=new h.G,n.next=11,e.provideCompletionItems(t,i,a,c);case 11:g=n.sent,o=w(e,g,u)||o,n.next=18;break;case 15:n.prev=15,n.t0=n.catch(7),(0,d.Cp)(n.t0);case 18:case"end":return n.stop()}}),n,null,[[7,15]])})))})));case 4:if(!o&&!c.isCancellationRequested){e.next=6;break}return e.abrupt("return",1);case 6:case"end":return e.stop()}}),e)})),D.s();case 15:if((L=D.n()).done){l.next=21;break}return l.delegateYield(I(),"t0",17);case 17:if(!l.t0){l.next=19;break}return l.abrupt("break",21);case 19:l.next=15;break;case 21:l.next=26;break;case 23:l.prev=23,l.t1=l.catch(12),D.e(l.t1);case 26:return l.prev=26,D.f(),l.finish(26);case 29:return l.next=31,C;case 31:if(!c.isCancellationRequested){l.next=34;break}return b.dispose(),l.abrupt("return",Promise.reject(new d.FU));case 34:return l.abrupt("return",new T(y.sort((P=r.snippetSortOrder,E.get(P))),k,{entries:S,elapsed:g.elapsed()},b));case 35:case"end":return l.stop()}var P}),l,null,[[12,23,26,29]])})))}function M(e,t){if(e.sortTextLow&&t.sortTextLow){if(e.sortTextLow<t.sortTextLow)return-1;if(e.sortTextLow>t.sortTextLow)return 1}return e.textLabel<t.textLabel?-1:e.textLabel>t.textLabel?1:e.completion.kind-t.completion.kind}var E=new Map;function R(e,t){var i;null===(i=e.getContribution("editor.contrib.suggestController"))||void 0===i||i.triggerSuggest((new Set).add(t),void 0,!0)}E.set(0,(function(e,t){if(e.completion.kind!==t.completion.kind){if(27===e.completion.kind)return-1;if(27===t.completion.kind)return 1}return M(e,t)})),E.set(2,(function(e,t){if(e.completion.kind!==t.completion.kind){if(27===e.completion.kind)return 1;if(27===t.completion.kind)return-1}return M(e,t)})),E.set(1,M),S.P.registerCommand("_executeCompletionItemProvider",(function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return x(void 0,void 0,void 0,(0,s.Z)().mark((function t(){var n,r,a,d,c,u,h,_,v,y,b,S,k,C;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i[0],r=i[1],a=i[2],d=i[3],(0,g.p_)(f.o.isUri(n)),(0,g.p_)(p.L.isIPosition(r)),(0,g.p_)("string"===typeof a||!a),(0,g.p_)("number"===typeof d||!d),c=e.get(w.p),u=c.completionProvider,t.next=8,e.get(m.S).createModelReference(n);case 8:return h=t.sent,t.prev=9,_={incomplete:!1,suggestions:[]},v=[],y=h.object.textEditorModel.validatePosition(r),t.next=15,P(u,h.object.textEditorModel,y,void 0,{triggerCharacter:null!==a&&void 0!==a?a:void 0,triggerKind:a?1:0});case 15:b=t.sent,S=(0,o.Z)(b.items);try{for(S.s();!(k=S.n()).done;)C=k.value,v.length<(null!==d&&void 0!==d?d:0)&&v.push(C.resolve(l.T.None)),_.incomplete=_.incomplete||C.container.incomplete,_.suggestions.push(C.completion)}catch(s){S.e(s)}finally{S.f()}return t.prev=18,t.next=21,Promise.all(v);case 21:return t.abrupt("return",_);case 22:return t.prev=22,setTimeout((function(){return b.disposable.dispose()}),100),t.finish(22);case 25:return t.prev=25,h.dispose(),t.finish(25);case 28:case"end":return t.stop()}}),t,null,[[9,,25,28],[18,,22,25]])})))}));var O=function(){function e(){(0,r.Z)(this,e)}return(0,a.Z)(e,null,[{key:"isAllOff",value:function(e){return"off"===e.other&&"off"===e.comments&&"off"===e.strings}},{key:"isAllOn",value:function(e){return"on"===e.other&&"on"===e.comments&&"on"===e.strings}},{key:"valueFor",value:function(e,t){switch(t){case 1:return e.comments;case 2:return e.strings;default:return e.other}}}]),e}()},54125:function(e,t,i){i.r(t),i.d(t,{SuggestController:function(){return mt},TriggerSuggestAction:function(){return yt}});var n,o=i(60136),s=i(27277),r=i(93433),a=i(37762),l=i(15671),d=i(43144),c=i(46403),u=i(38102),h=i(71049),g=i(7388),f=i(74146),p=i(13880),_=i(63908),m=i(65096),v=i(90650),y=i(48497),b=i(63021),S=i(49039),k=i(95253),w=i(62557),C=i(65631),x=i(17429),D=i(98926),L=i(55261),N=i(88324),I=i(11522),F=i(8022),T=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},P=function(e,t){return function(i,n){t(i,n,e)}},M=n=function(){function e(t,i){var o=this;(0,l.Z)(this,e),this._editor=t,this._enabled=!1,this._ckAtEnd=n.AtEnd.bindTo(i),this._configListener=this._editor.onDidChangeConfiguration((function(e){return e.hasChanged(122)&&o._update()})),this._update()}return(0,d.Z)(e,[{key:"dispose",value:function(){var e;this._configListener.dispose(),null===(e=this._selectionListener)||void 0===e||e.dispose(),this._ckAtEnd.reset()}},{key:"_update",value:function(){var e=this,t="on"===this._editor.getOption(122);if(this._enabled!==t)if(this._enabled=t,this._enabled){var i=function(){if(e._editor.hasModel()){var t=e._editor.getModel(),i=e._editor.getSelection(),n=t.getWordAtPosition(i.getStartPosition());n?e._ckAtEnd.set(n.endColumn===i.getStartPosition().column):e._ckAtEnd.set(!1)}else e._ckAtEnd.set(!1)};this._selectionListener=this._editor.onDidChangeCursorSelection(i),i()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}}]),e}();M.AtEnd=new F.uy("atEndOfWord",!1),M=n=T([P(1,F.i6)],M);var E,R=i(18420),O=i(99740),Z=i(64606),z=i(1018),A=i(51211),W=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},V=function(e,t){return function(i,n){t(i,n,e)}},H=E=function(){function e(t,i){(0,l.Z)(this,e),this._editor=t,this._index=0,this._ckOtherSuggestions=E.OtherSuggestions.bindTo(i)}return(0,d.Z)(e,[{key:"dispose",value:function(){this.reset()}},{key:"reset",value:function(){var e;this._ckOtherSuggestions.reset(),null===(e=this._listener)||void 0===e||e.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}},{key:"set",value:function(e,t){var i=this,n=e.model,o=e.index;0!==n.items.length?E._moveIndex(!0,n,o)!==o?(this._acceptNext=t,this._model=n,this._index=o,this._listener=this._editor.onDidChangeCursorPosition((function(){i._ignore||i.reset()})),this._ckOtherSuggestions.set(!0)):this.reset():this.reset()}},{key:"next",value:function(){this._move(!0)}},{key:"prev",value:function(){this._move(!1)}},{key:"_move",value:function(e){if(this._model)try{this._ignore=!0,this._index=E._moveIndex(e,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}}],[{key:"_moveIndex",value:function(e,t,i){for(var n=i,o=t.items.length;o>0&&(n=(n+t.items.length+(e?1:-1))%t.items.length)!==i&&t.items[n].completion.additionalTextEdits;o--);return n}}]),e}();H.OtherSuggestions=new F.uy("hasOtherSuggestions",!1),H=E=W([V(1,F.i6)],H);var G,B=i(65239),K=function(){function e(t,i,n,o){var s=this;(0,l.Z)(this,e),this._disposables=new m.SL,this._disposables.add(n.onDidSuggest((function(e){0===e.completionModel.items.length&&s.reset()}))),this._disposables.add(n.onDidCancel((function(e){s.reset()}))),this._disposables.add(i.onDidShow((function(){return s._onItem(i.getFocusedItem())}))),this._disposables.add(i.onDidFocus(this._onItem,this)),this._disposables.add(i.onDidHide(this.reset,this)),this._disposables.add(t.onWillType((function(e){if(s._active&&!i.isFrozen()&&0!==n.state){var r=e.charCodeAt(e.length-1);s._active.acceptCharacters.has(r)&&t.getOption(0)&&o(s._active.item)}})))}return(0,d.Z)(e,[{key:"_onItem",value:function(e){if(e&&(0,u.Of)(e.item.completion.commitCharacters)){if(!this._active||this._active.item.item!==e.item){var t,i=new B.q,n=(0,a.Z)(e.item.completion.commitCharacters);try{for(n.s();!(t=n.n()).done;){var o=t.value;o.length>0&&i.add(o.charCodeAt(0))}}catch(s){n.e(s)}finally{n.f()}this._active={acceptCharacters:i,item:e}}}else this.reset()}},{key:"reset",value:function(){this._active=void 0}},{key:"dispose",value:function(){this._disposables.dispose()}}]),e}(),j=i(74165),U=i(29439),q=i(31906),$=i(96601),Q=i(88697),X=i(53459),J=i(76344),Y=i(77819),ee=i(45536),te=i(47799),ie=i(65441),ne=i(21973),oe=i(2736),se=i(31198),re=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},ae=function(e,t){return function(i,n){t(i,n,e)}},le=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))},de=function(){function e(t,i,n){(0,l.Z)(this,e),this.leadingLineContent=t.getLineContent(i.lineNumber).substr(0,i.column-1),this.leadingWord=t.getWordUntilPosition(i),this.lineNumber=i.lineNumber,this.column=i.column,this.triggerOptions=n}return(0,d.Z)(e,null,[{key:"shouldAutoTrigger",value:function(e){if(!e.hasModel())return!1;var t=e.getModel(),i=e.getPosition();t.tokenization.tokenizeIfCheap(i.lineNumber);var n=t.getWordAtPosition(i);return!!n&&((n.endColumn===i.column||n.startColumn+1===i.column)&&!!isNaN(Number(n.word)))}}]),e}();var ce=G=function(){function e(t,i,n,o,s,r,a,d,c){var u=this;(0,l.Z)(this,e),this._editor=t,this._editorWorkerService=i,this._clipboardService=n,this._telemetryService=o,this._logService=s,this._contextKeyService=r,this._configurationService=a,this._languageFeaturesService=d,this._envService=c,this._toDispose=new m.SL,this._triggerCharacterListener=new m.SL,this._triggerQuickSuggest=new h._F,this._triggerState=void 0,this._completionDisposables=new m.SL,this._onDidCancel=new p.Q5,this._onDidTrigger=new p.Q5,this._onDidSuggest=new p.Q5,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._telemetryGate=0,this._currentSelection=this._editor.getSelection()||new $.Y(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel((function(){u._updateTriggerCharacters(),u.cancel()}))),this._toDispose.add(this._editor.onDidChangeModelLanguage((function(){u._updateTriggerCharacters(),u.cancel()}))),this._toDispose.add(this._editor.onDidChangeConfiguration((function(){u._updateTriggerCharacters()}))),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange((function(){u._updateTriggerCharacters(),u._updateActiveSuggestSession()})));var g=!1;this._toDispose.add(this._editor.onDidCompositionStart((function(){g=!0}))),this._toDispose.add(this._editor.onDidCompositionEnd((function(){g=!1,u._onCompositionEnd()}))),this._toDispose.add(this._editor.onDidChangeCursorSelection((function(e){g||u._onCursorChange(e)}))),this._toDispose.add(this._editor.onDidChangeModelContent((function(){g||void 0===u._triggerState||u._refilterCompletionItems()}))),this._updateTriggerCharacters()}return(0,d.Z)(e,[{key:"dispose",value:function(){(0,m.B9)(this._triggerCharacterListener),(0,m.B9)([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}},{key:"_updateTriggerCharacters",value:function(){var e=this;if(this._triggerCharacterListener.clear(),!this._editor.getOption(90)&&this._editor.hasModel()&&this._editor.getOption(120)){var t,i=new Map,n=(0,a.Z)(this._languageFeaturesService.completionProvider.all(this._editor.getModel()));try{for(n.s();!(t=n.n()).done;){var o,s=t.value,r=(0,a.Z)(s.triggerCharacters||[]);try{for(r.s();!(o=r.n()).done;){var l=o.value,d=i.get(l);d||((d=new Set).add((0,A.ZJ)()),i.set(l,d)),d.add(s)}}catch(u){r.e(u)}finally{r.f()}}}catch(u){n.e(u)}finally{n.f()}var c=function(t){var n;if(function(e,t,i){if(!Boolean(t.getContextKeyValue("inlineSuggestionVisible")))return!0;var n=t.getContextKeyValue(oe.f.suppressSuggestions.key);return void 0!==n?!n:!e.getOption(62).suppressSuggestions}(e._editor,e._contextKeyService,e._configurationService)&&!de.shouldAutoTrigger(e._editor)){if(!t){var o=e._editor.getPosition();t=e._editor.getModel().getLineContent(o.lineNumber).substr(0,o.column-1)}var s="";(0,q.YK)(t.charCodeAt(t.length-1))?(0,q.ZG)(t.charCodeAt(t.length-2))&&(s=t.substr(t.length-2)):s=t.charAt(t.length-1);var r=i.get(s);if(r){var l=new Map;if(e._completionModel){var d,c=(0,a.Z)(e._completionModel.getItemsByProvider());try{for(c.s();!(d=c.n()).done;){var h=(0,U.Z)(d.value,2),g=h[0],f=h[1];r.has(g)||l.set(g,f)}}catch(u){c.e(u)}finally{c.f()}}e.trigger({auto:!0,triggerKind:1,triggerCharacter:s,retrigger:Boolean(e._completionModel),clipboardText:null===(n=e._completionModel)||void 0===n?void 0:n.clipboardText,completionOptions:{providerFilter:r,providerItemsToReuse:l}})}}};this._triggerCharacterListener.add(this._editor.onDidType(c)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd((function(){return c()})))}}},{key:"state",get:function(){return this._triggerState?this._triggerState.auto?2:1:0}},{key:"cancel",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];void 0!==this._triggerState&&(this._triggerQuickSuggest.cancel(),null===(e=this._requestToken)||void 0===e||e.cancel(),this._requestToken=void 0,this._triggerState=void 0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:t}))}},{key:"clear",value:function(){this._completionDisposables.clear()}},{key:"_updateActiveSuggestSession",value:function(){void 0!==this._triggerState&&(this._editor.hasModel()&&this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.trigger({auto:this._triggerState.auto,retrigger:!0}):this.cancel())}},{key:"_onCursorChange",value:function(e){if(this._editor.hasModel()){var t=this._currentSelection;this._currentSelection=this._editor.getSelection(),!e.selection.isEmpty()||0!==e.reason&&3!==e.reason||"keyboard"!==e.source&&"deleteLeft"!==e.source?this.cancel():void 0===this._triggerState&&0===e.reason?(t.containsRange(this._currentSelection)||t.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():void 0!==this._triggerState&&3===e.reason&&this._refilterCompletionItems()}}},{key:"_onCompositionEnd",value:function(){void 0===this._triggerState?this._doTriggerQuickSuggest():this._refilterCompletionItems()}},{key:"_doTriggerQuickSuggest",value:function(){var e,t=this;A.tG.isAllOff(this._editor.getOption(88))||this._editor.getOption(117).snippetsPreventQuickSuggestions&&(null===(e=L.SnippetController2.get(this._editor))||void 0===e?void 0:e.isInSnippet())||(this.cancel(),this._triggerQuickSuggest.cancelAndSet((function(){if(void 0===t._triggerState&&de.shouldAutoTrigger(t._editor)&&t._editor.hasModel()&&t._editor.hasWidgetFocus()){var e=t._editor.getModel(),i=t._editor.getPosition(),n=t._editor.getOption(88);if(!A.tG.isAllOff(n)){if(!A.tG.isAllOn(n)){e.tokenization.tokenizeIfCheap(i.lineNumber);var o=e.tokenization.getLineTokens(i.lineNumber),s=o.getStandardTokenType(o.findTokenIndexAtOffset(Math.max(i.column-1-1,0)));if("on"!==A.tG.valueFor(n,s))return}(function(e,t,i){if(!Boolean(t.getContextKeyValue(oe.f.inlineSuggestionVisible.key)))return!0;var n=t.getContextKeyValue(oe.f.suppressSuggestions.key);return void 0!==n?!n:!e.getOption(62).suppressSuggestions})(t._editor,t._contextKeyService,t._configurationService)&&t._languageFeaturesService.completionProvider.has(e)&&t.trigger({auto:!0})}}}),this._editor.getOption(89)))}},{key:"_refilterCompletionItems",value:function(){(0,b.p_)(this._editor.hasModel()),(0,b.p_)(void 0!==this._triggerState);var e=this._editor.getModel(),t=this._editor.getPosition(),i=new de(e,t,Object.assign(Object.assign({},this._triggerState),{refilter:!0}));this._onNewContext(i)}},{key:"trigger",value:function(e){var t,i,n,o,s,r,l=this;if(this._editor.hasModel()){var d=this._editor.getModel(),c=new de(d,this._editor.getPosition(),e);this.cancel(e.retrigger),this._triggerState=e,this._onDidTrigger.fire({auto:e.auto,shy:null!==(t=e.shy)&&void 0!==t&&t,position:this._editor.getPosition()}),this._context=c;var u={triggerKind:null!==(i=e.triggerKind)&&void 0!==i?i:0};e.triggerCharacter&&(u={triggerKind:1,triggerCharacter:e.triggerCharacter}),this._requestToken=new g.A;var h=1;switch(this._editor.getOption(111)){case"top":h=0;break;case"bottom":h=2}var p=G._createSuggestFilter(this._editor),_=p.itemKind,m=p.showDeprecated,v=new A.A9(h,null!==(o=null===(n=e.completionOptions)||void 0===n?void 0:n.kindFilter)&&void 0!==o?o:_,null===(s=e.completionOptions)||void 0===s?void 0:s.providerFilter,null===(r=e.completionOptions)||void 0===r?void 0:r.providerItemsToReuse,m),y=X.K.create(this._editorWorkerService,this._editor),b=(0,A.kL)(this._languageFeaturesService.completionProvider,d,this._editor.getPosition(),v,u,this._requestToken.token);Promise.all([b,y]).then((function(t){var i=(0,U.Z)(t,2),n=i[0],o=i[1];return le(l,void 0,void 0,(0,j.Z)().mark((function t(){var i,s,r,l,d,c,u,h;return(0,j.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(i=this._requestToken)||void 0===i||i.dispose(),this._editor.hasModel()){t.next=3;break}return t.abrupt("return");case 3:if((s=null===e||void 0===e?void 0:e.clipboardText)||!n.needsClipboard){t.next=8;break}return t.next=7,this._clipboardService.readText();case 7:s=t.sent;case 8:if(void 0!==this._triggerState){t.next=10;break}return t.abrupt("return");case 10:if(r=this._editor.getModel(),l=new de(r,this._editor.getPosition(),e),d=Object.assign(Object.assign({},ne.mX.default),{firstMatchCanBeWeak:!this._editor.getOption(117).matchOnWordStartOnly}),this._completionModel=new te._(n.items,this._context.column,{leadingLineContent:l.leadingLineContent,characterCountDelta:l.column-this._context.column},o,this._editor.getOption(117),this._editor.getOption(111),d,s),this._completionDisposables.add(n.disposable),this._onNewContext(l),this._reportDurationsTelemetry(n.durations),!this._envService.isBuilt||this._envService.isExtensionDevelopment){c=(0,a.Z)(n.items);try{for(c.s();!(u=c.n()).done;)(h=u.value).isInvalid&&this._logService.warn("[suggest] did IGNORE invalid completion item from ".concat(h.provider._debugDisplayName),h.completion)}catch(g){c.e(g)}finally{c.f()}}case 18:case"end":return t.stop()}}),t,this)})))})).catch(f.dL)}}},{key:"_reportDurationsTelemetry",value:function(e){var t=this;this._telemetryGate++%230===0&&setTimeout((function(){t._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(e)}),t._logService.debug("suggest.durations.json",e)}))}},{key:"_onNewContext",value:function(e){if(this._context)if(e.lineNumber===this._context.lineNumber)if((0,q.V8)(e.leadingLineContent)===(0,q.V8)(this._context.leadingLineContent)){if(e.column<this._context.column)e.leadingWord.word?this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0}):this.cancel();else if(this._completionModel)if(0!==e.leadingWord.word.length&&e.leadingWord.startColumn>this._context.leadingWord.startColumn){if(de.shouldAutoTrigger(this._editor)&&this._context){var t=this._completionModel.getItemsByProvider();this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerItemsToReuse:t}})}}else if(e.column>this._context.column&&this._completionModel.getIncompleteProvider().size>0&&0!==e.leadingWord.word.length){var i,n=new Map,o=new Set,s=(0,a.Z)(this._completionModel.getItemsByProvider());try{for(s.s();!(i=s.n()).done;){var r=(0,U.Z)(i.value,2),l=r[0],d=r[1];d.length>0&&d[0].container.incomplete?o.add(l):n.set(l,d)}}catch(g){s.e(g)}finally{s.f()}this.trigger({auto:this._context.triggerOptions.auto,triggerKind:2,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerFilter:o,providerItemsToReuse:n}})}else{var c=this._completionModel.lineContext,u=!1;if(this._completionModel.lineContext={leadingLineContent:e.leadingLineContent,characterCountDelta:e.column-this._context.column},0===this._completionModel.items.length){var h=de.shouldAutoTrigger(this._editor);if(!this._context)return void this.cancel();if(h&&this._context.leadingWord.endColumn<e.leadingWord.startColumn)return void this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0});if(this._context.triggerOptions.auto)return void this.cancel();if(this._completionModel.lineContext=c,(u=this._completionModel.items.length>0)&&0===e.leadingWord.word.length)return void this.cancel()}this._onDidSuggest.fire({completionModel:this._completionModel,triggerOptions:e.triggerOptions,isFrozen:u})}}else this.cancel();else this.cancel()}}],[{key:"_createSuggestFilter",value:function(e){var t=new Set;"none"===e.getOption(111)&&t.add(27);var i=e.getOption(117);return i.showMethods||t.add(0),i.showFunctions||t.add(1),i.showConstructors||t.add(2),i.showFields||t.add(3),i.showVariables||t.add(4),i.showClasses||t.add(5),i.showStructs||t.add(6),i.showInterfaces||t.add(7),i.showModules||t.add(8),i.showProperties||t.add(9),i.showEvents||t.add(10),i.showOperators||t.add(11),i.showUnits||t.add(12),i.showValues||t.add(13),i.showConstants||t.add(14),i.showEnums||t.add(15),i.showEnumMembers||t.add(16),i.showKeywords||t.add(17),i.showWords||t.add(18),i.showColors||t.add(19),i.showFiles||t.add(20),i.showReferences||t.add(21),i.showColors||t.add(22),i.showFolders||t.add(23),i.showTypeParameters||t.add(24),i.showSnippets||t.add(27),i.showUsers||t.add(25),i.showIssues||t.add(26),{itemKind:t,showDeprecated:i.showDeprecated}}}]),e}();ce=G=re([ae(1,Q.p),ae(2,J.p),ae(3,ee.b),ae(4,z.VZ),ae(5,F.i6),ae(6,Y.Ui),ae(7,ie.p),ae(8,se.Y)],ce);var ue=function(){function e(t,i){var n=this;(0,l.Z)(this,e),this._disposables=new m.SL,this._lastOvertyped=[],this._locked=!1,this._disposables.add(t.onWillType((function(){if(!n._locked&&t.hasModel()){for(var i=t.getSelections(),o=i.length,s=!1,r=0;r<o;r++)if(!i[r].isEmpty()){s=!0;break}if(s){n._lastOvertyped=[];for(var a=t.getModel(),l=0;l<o;l++){var d=i[l];if(a.getValueLengthInRange(d)>e._maxSelectionLength)return;n._lastOvertyped[l]={value:a.getValueInRange(d),multiline:d.startLineNumber!==d.endLineNumber}}}else 0!==n._lastOvertyped.length&&(n._lastOvertyped.length=0)}}))),this._disposables.add(i.onDidTrigger((function(e){n._locked=!0}))),this._disposables.add(i.onDidCancel((function(e){n._locked=!1})))}return(0,d.Z)(e,[{key:"getLastOvertypedInfo",value:function(e){if(e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}},{key:"dispose",value:function(){this._disposables.dispose()}}]),e}();ue._maxSelectionLength=51200;var he=i(32959),ge=(i(46962),i(95587)),fe=i(61347),pe=i(4391),_e=i(11752),me=i(61120),ve=i(65171),ye=i(12858),be=i(14443),Se=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},ke=function(e,t){return function(i,n){t(i,n,e)}},we=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,l.Z)(this,i),t.apply(this,arguments)}return(0,d.Z)(i,[{key:"updateLabel",value:function(){var e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return(0,_e.Z)((0,me.Z)(i.prototype),"updateLabel",this).call(this);this.label&&(this.label.textContent=(0,R.NC)({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",this._action.label,i.symbolPrintEnter(e)))}}],[{key:"symbolPrintEnter",value:function(e){var t;return null===(t=e.getLabel())||void 0===t?void 0:t.replace(/\benter\b/gi,"\u23ce")}}]),i}(ye.Mm),Ce=function(){function e(t,i,n,o,s){(0,l.Z)(this,e),this._menuId=i,this._menuService=o,this._contextKeyService=s,this._menuDisposables=new m.SL,this.element=he.append(t,he.$(".suggest-status-bar"));var r=function(e){return e instanceof be.U8?n.createInstance(we,e,void 0):void 0};this._leftActions=new ve.o(this.element,{actionViewItemProvider:r}),this._rightActions=new ve.o(this.element,{actionViewItemProvider:r}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}return(0,d.Z)(e,[{key:"dispose",value:function(){this._menuDisposables.dispose(),this._leftActions.dispose(),this._rightActions.dispose(),this.element.remove()}},{key:"show",value:function(){var e=this,t=this._menuService.createMenu(this._menuId,this._contextKeyService);this._menuDisposables.add(t.onDidChange((function(){return function(){var i,n=[],o=[],s=(0,a.Z)(t.getActions());try{for(s.s();!(i=s.n()).done;){var l=(0,U.Z)(i.value,2),d=l[0],c=l[1];"left"===d?n.push.apply(n,(0,r.Z)(c)):o.push.apply(o,(0,r.Z)(c))}}catch(u){s.e(u)}finally{s.f()}e._leftActions.clear(),e._leftActions.push(n),e._rightActions.clear(),e._rightActions.push(o)}()}))),this._menuDisposables.add(t)}},{key:"hide",value:function(){this._menuDisposables.clear()}}]),e}();Ce=Se([ke(2,Z.TG),ke(3,be.co),ke(4,F.i6)],Ce);i(24988);var xe=i(88463),De=i(43980),Le=i(39707),Ne=i(41335),Ie=i(92763),Fe=i(15803),Te=i(77409),Pe=i(79730),Me=i(71047),Ee=i(46757),Re=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},Oe=function(e,t){return function(i,n){t(i,n,e)}};function Ze(e){return!!e&&Boolean(e.completion.documentation||e.completion.detail&&e.completion.detail!==e.completion.label)}var ze=function(){function e(t,i){var n=this;(0,l.Z)(this,e),this._editor=t,this._onDidClose=new p.Q5,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new p.Q5,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new m.SL,this._renderDisposeable=new m.SL,this._borderWidth=1,this._size=new he.Dimension(330,0),this.domNode=he.$(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=i.createInstance(Ee.$,{editor:t}),this._body=he.$(".body"),this._scrollbar=new Fe.s$(this._body,{alwaysConsumeMouseWheel:!0}),he.append(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=he.append(this._body,he.$(".header")),this._close=he.append(this._header,he.$("span"+Pe.k.asCSSSelector(Te.l.close))),this._close.title=R.NC("details.close","Close"),this._type=he.append(this._header,he.$("p.type")),this._docs=he.append(this._body,he.$("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration((function(e){e.hasChanged(50)&&n._configureFont()})))}return(0,d.Z)(e,[{key:"dispose",value:function(){this._disposables.dispose(),this._renderDisposeable.dispose()}},{key:"_configureFont",value:function(){var e=this._editor.getOptions(),t=e.get(50),i=t.getMassagedFontFamily(),n=e.get(118)||t.fontSize,o=e.get(119)||t.lineHeight,s=t.fontWeight,r="".concat(n,"px"),a="".concat(o,"px");this.domNode.style.fontSize=r,this.domNode.style.lineHeight="".concat(o/n),this.domNode.style.fontWeight=s,this.domNode.style.fontFeatureSettings=t.fontFeatureSettings,this._type.style.fontFamily=i,this._close.style.height=a,this._close.style.width=a}},{key:"getLayoutInfo",value:function(){var e=this._editor.getOption(119)||this._editor.getOption(50).lineHeight,t=this._borderWidth;return{lineHeight:e,borderWidth:t,borderHeight:2*t,verticalPadding:22,horizontalPadding:14}}},{key:"renderLoading",value:function(){this._type.textContent=R.NC("loading","Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,2*this.getLayoutInfo().lineHeight),this._onDidChangeContents.fire(this)}},{key:"renderItem",value:function(e,t){var i,n,o=this;this._renderDisposeable.clear();var s=e.completion,r=s.detail,a=s.documentation;if(t){var l="";l+="score: ".concat(e.score[0],"\n"),l+="prefix: ".concat(null!==(i=e.word)&&void 0!==i?i:"(no prefix)","\n"),l+="word: ".concat(e.completion.filterText?e.completion.filterText+" (filterText)":e.textLabel,"\n"),l+="distance: ".concat(e.distance," (localityBonus-setting)\n"),l+="index: ".concat(e.idx,", based on ").concat(e.completion.sortText&&'sortText: "'.concat(e.completion.sortText,'"')||"label","\n"),l+="commit_chars: ".concat(null===(n=e.completion.commitCharacters)||void 0===n?void 0:n.join(""),"\n"),a=(new Me.W5).appendCodeblock("empty",l),r="Provider: ".concat(e.provider._debugDisplayName)}if(t||Ze(e)){if(this.domNode.classList.remove("no-docs","no-type"),r){var d=r.length>1e5?"".concat(r.substr(0,1e5),"\u2026"):r;this._type.textContent=d,this._type.title=d,he.show(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gim.test(d))}else he.clearNode(this._type),this._type.title="",he.hide(this._type),this.domNode.classList.add("no-type");if(he.clearNode(this._docs),"string"===typeof a)this._docs.classList.remove("markdown-docs"),this._docs.textContent=a;else if(a){this._docs.classList.add("markdown-docs"),he.clearNode(this._docs);var c=this._markdownRenderer.render(a);this._docs.appendChild(c.element),this._renderDisposeable.add(c),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync((function(){o.layout(o._size.width,o._type.clientHeight+o._docs.clientHeight),o._onDidChangeContents.fire(o)})))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=function(e){e.preventDefault(),e.stopPropagation()},this._close.onclick=function(e){e.preventDefault(),e.stopPropagation(),o._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}else this.clearContents()}},{key:"clearContents",value:function(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}},{key:"size",get:function(){return this._size}},{key:"layout",value:function(e,t){var i=new he.Dimension(e,t);he.Dimension.equals(i,this._size)||(this._size=i,he.size(this.domNode,e,t)),this._scrollbar.scanDomNode()}},{key:"scrollDown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;this._body.scrollTop+=e}},{key:"scrollUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;this._body.scrollTop-=e}},{key:"scrollTop",value:function(){this._body.scrollTop=0}},{key:"scrollBottom",value:function(){this._body.scrollTop=this._body.scrollHeight}},{key:"pageDown",value:function(){this.scrollDown(80)}},{key:"pageUp",value:function(){this.scrollUp(80)}},{key:"borderWidth",get:function(){return this._borderWidth},set:function(e){this._borderWidth=e}}]),e}();ze=Re([Oe(1,Z.TG)],ze);var Ae,We=function(){function e(t,i){var n,o,s=this;(0,l.Z)(this,e),this.widget=t,this._editor=i,this._disposables=new m.SL,this._added=!1,this._preferAlignAtTop=!0,this._resizable=new Ie.f,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(t.domNode),this._resizable.enableSashes(!1,!0,!0,!1);var r=0,a=0;this._disposables.add(this._resizable.onDidWillResize((function(){n=s._topLeft,o=s._resizable.size}))),this._disposables.add(this._resizable.onDidResize((function(e){if(n&&o){s.widget.layout(e.dimension.width,e.dimension.height);var t=!1;e.west&&(a=o.width-e.dimension.width,t=!0),e.north&&(r=o.height-e.dimension.height,t=!0),t&&s._applyTopLeft({top:n.top+r,left:n.left+a})}e.done&&(n=void 0,o=void 0,r=0,a=0,s._userSize=e.dimension)}))),this._disposables.add(this.widget.onDidChangeContents((function(){var e;s._anchorBox&&s._placeAtAnchor(s._anchorBox,null!==(e=s._userSize)&&void 0!==e?e:s.widget.size,s._preferAlignAtTop)})))}return(0,d.Z)(e,[{key:"dispose",value:function(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}},{key:"getId",value:function(){return"suggest.details"}},{key:"getDomNode",value:function(){return this._resizable.domNode}},{key:"getPosition",value:function(){return null}},{key:"show",value:function(){this._added||(this._editor.addOverlayWidget(this),this.getDomNode().style.position="fixed",this._added=!0)}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),e&&(this._userSize=void 0,this.widget.clearContents())}},{key:"placeAtAnchor",value:function(e,t){var i,n=e.getBoundingClientRect();this._anchorBox=n,this._preferAlignAtTop=t,this._placeAtAnchor(this._anchorBox,null!==(i=this._userSize)&&void 0!==i?i:this.widget.size,t)}},{key:"_placeAtAnchor",value:function(e,t,i){var n,o,s,r=he.getClientArea(this.getDomNode().ownerDocument.body),a=this.widget.getLayoutInfo(),l=new he.Dimension(220,2*a.lineHeight),d=e.top,c=function(){var i=r.width-(e.left+e.width+a.borderWidth+a.horizontalPadding),n=-a.borderWidth+e.left+e.width,o=new he.Dimension(i,r.height-e.top-a.borderHeight-a.verticalPadding),s=o.with(void 0,e.top+e.height-a.borderHeight-a.verticalPadding);return{top:d,left:n,fit:i-t.width,maxSizeTop:o,maxSizeBottom:s,minSize:l.with(Math.min(i,l.width))}}(),u=[c,function(){var i=e.left-a.borderWidth-a.horizontalPadding,n=Math.max(a.horizontalPadding,e.left-t.width-a.borderWidth),o=new he.Dimension(i,r.height-e.top-a.borderHeight-a.verticalPadding),s=o.with(void 0,e.top+e.height-a.borderHeight-a.verticalPadding);return{top:d,left:n,fit:i-t.width,maxSizeTop:o,maxSizeBottom:s,minSize:l.with(Math.min(i,l.width))}}(),function(){var i=e.left,n=-a.borderWidth+e.top+e.height,o=new he.Dimension(e.width-a.borderHeight,r.height-e.top-e.height-a.verticalPadding);return{top:n,left:i,fit:o.height-t.height,maxSizeBottom:o,maxSizeTop:o,minSize:l.with(o.width)}}()],h=null!==(n=u.find((function(e){return e.fit>=0})))&&void 0!==n?n:u.sort((function(e,t){return t.fit-e.fit}))[0],g=e.top+e.height-a.borderHeight,f=t.height,p=Math.max(h.maxSizeTop.height,h.maxSizeBottom.height);f>p&&(f=p),i?f<=h.maxSizeTop.height?(o=!0,s=h.maxSizeTop):(o=!1,s=h.maxSizeBottom):f<=h.maxSizeBottom.height?(o=!1,s=h.maxSizeBottom):(o=!0,s=h.maxSizeTop),this._applyTopLeft({left:h.left,top:o?h.top:g-f}),this.getDomNode().style.position="fixed",this._resizable.enableSashes(!o,h===c,o,h!==c),this._resizable.minSize=h.minSize,this._resizable.maxSize=s,this._resizable.layout(f,Math.min(s.width,t.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}},{key:"_applyTopLeft",value:function(e){this._topLeft=e,this.getDomNode().style.left="".concat(this._topLeft.left,"px"),this.getDomNode().style.top="".concat(this._topLeft.top,"px")}}]),e}(),Ve=i(27691),He=i(38821),Ge=i(70133),Be=i(59128),Ke=i(26246),je=i(58188),Ue=i(58741),qe=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},$e=function(e,t){return function(i,n){t(i,n,e)}};function Qe(e){return"suggest-aria-id:".concat(e)}var Xe=(0,i(87288).q5)("suggest-more-info",Te.l.chevronRight,R.NC("suggestMoreInfoIcon","Icon for more information in the suggest widget.")),Je=new((Ae=function(){function e(){(0,l.Z)(this,e)}return(0,d.Z)(e,[{key:"extract",value:function(e,t){if(e.textLabel.match(Ae._regexStrict))return t[0]=e.textLabel,!0;if(e.completion.detail&&e.completion.detail.match(Ae._regexStrict))return t[0]=e.completion.detail,!0;if("string"===typeof e.completion.documentation){var i=Ae._regexRelaxed.exec(e.completion.documentation);if(i&&(0===i.index||i.index+i[0].length===e.completion.documentation.length))return t[0]=i[0],!0}return!1}}]),e}())._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/,Ae._regexStrict=new RegExp("^".concat(Ae._regexRelaxed.source,"$"),"i"),Ae),Ye=function(){function e(t,i,n,o){(0,l.Z)(this,e),this._editor=t,this._modelService=i,this._languageService=n,this._themeService=o,this._onDidToggleDetails=new p.Q5,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}return(0,d.Z)(e,[{key:"dispose",value:function(){this._onDidToggleDetails.dispose()}},{key:"renderTemplate",value:function(e){var t=this,i=new m.SL,n=e;n.classList.add("show-file-icons");var o=(0,he.append)(e,(0,he.$)(".icon")),s=(0,he.append)(o,(0,he.$)("span.colorspan")),r=(0,he.append)(e,(0,he.$)(".contents")),a=(0,he.append)(r,(0,he.$)(".main")),l=(0,he.append)(a,(0,he.$)(".icon-label.codicon")),d=(0,he.append)(a,(0,he.$)("span.left")),c=(0,he.append)(a,(0,he.$)("span.right")),u=new Ve.g(d,{supportHighlights:!0,supportIcons:!0});i.add(u);var h=(0,he.append)(d,(0,he.$)("span.signature-label")),g=(0,he.append)(d,(0,he.$)("span.qualifier-label")),f=(0,he.append)(c,(0,he.$)("span.details-label")),p=(0,he.append)(c,(0,he.$)("span.readMore"+Pe.k.asCSSSelector(Xe)));p.title=R.NC("readMore","Read More");var _=function(){var e=t._editor.getOptions(),i=e.get(50),s=i.getMassagedFontFamily(),r=i.fontFeatureSettings,l=e.get(118)||i.fontSize,d=e.get(119)||i.lineHeight,c=i.fontWeight,u=i.letterSpacing,h="".concat(l,"px"),g="".concat(d,"px"),f="".concat(u,"px");n.style.fontSize=h,n.style.fontWeight=c,n.style.letterSpacing=f,a.style.fontFamily=s,a.style.fontFeatureSettings=r,a.style.lineHeight=g,o.style.height=g,o.style.width=g,p.style.height=g,p.style.width=g};return _(),i.add(this._editor.onDidChangeConfiguration((function(e){(e.hasChanged(50)||e.hasChanged(118)||e.hasChanged(119))&&_()}))),{root:n,left:d,right:c,icon:o,colorspan:s,iconLabel:u,iconContainer:l,parametersLabel:h,qualifierLabel:g,detailsLabel:f,readMore:p,disposables:i}}},{key:"renderElement",value:function(e,t,i){var n=this,o=e.completion;i.root.id=Qe(t),i.colorspan.style.backgroundColor="";var s={labelEscapeNewLines:!0,matches:(0,ne.mB)(e.score)},a=[];if(19===o.kind&&Je.extract(e,a))i.icon.className="icon customcolor",i.iconContainer.className="icon hide",i.colorspan.style.backgroundColor=a[0];else if(20===o.kind&&this._themeService.getFileIconTheme().hasFileIcons){i.icon.className="icon hide",i.iconContainer.className="icon hide";var l=(0,Be.r)(this._modelService,this._languageService,He.o.from({scheme:"fake",path:e.textLabel}),Ue.R.FILE),d=(0,Be.r)(this._modelService,this._languageService,He.o.from({scheme:"fake",path:o.detail}),Ue.R.FILE);s.extraClasses=l.length>d.length?l:d}else if(23===o.kind&&this._themeService.getFileIconTheme().hasFolderIcons)i.icon.className="icon hide",i.iconContainer.className="icon hide",s.extraClasses=[(0,Be.r)(this._modelService,this._languageService,He.o.from({scheme:"fake",path:e.textLabel}),Ue.R.FOLDER),(0,Be.r)(this._modelService,this._languageService,He.o.from({scheme:"fake",path:o.detail}),Ue.R.FOLDER)].flat();else{var c;i.icon.className="icon hide",i.iconContainer.className="",(c=i.iconContainer.classList).add.apply(c,["suggest-icon"].concat((0,r.Z)(Pe.k.asClassNameArray(Ge.gX.toIcon(o.kind)))))}o.tags&&o.tags.indexOf(1)>=0&&(s.extraClasses=(s.extraClasses||[]).concat(["deprecated"]),s.matches=[]),i.iconLabel.setLabel(e.textLabel,void 0,s),"string"===typeof o.label?(i.parametersLabel.textContent="",i.detailsLabel.textContent=et(o.detail||""),i.root.classList.add("string-label")):(i.parametersLabel.textContent=et(o.label.detail||""),i.detailsLabel.textContent=et(o.label.description||""),i.root.classList.remove("string-label")),this._editor.getOption(117).showInlineDetails?(0,he.show)(i.detailsLabel):(0,he.hide)(i.detailsLabel),Ze(e)?(i.right.classList.add("can-expand-details"),(0,he.show)(i.readMore),i.readMore.onmousedown=function(e){e.stopPropagation(),e.preventDefault()},i.readMore.onclick=function(e){e.stopPropagation(),e.preventDefault(),n._onDidToggleDetails.fire()}):(i.right.classList.remove("can-expand-details"),(0,he.hide)(i.readMore),i.readMore.onmousedown=null,i.readMore.onclick=null)}},{key:"disposeTemplate",value:function(e){e.disposables.dispose()}}]),e}();function et(e){return e.replace(/\r\n|\r|\n/g,"")}Ye=qe([$e(1,Ke.q),$e(2,je.O),$e(3,Ne.XE)],Ye);var tt,it=i(87103),nt=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},ot=function(e,t){return function(i,n){t(i,n,e)}},st=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};(0,De.P6G)("editorSuggestWidget.background",{dark:De.D0T,light:De.D0T,hcDark:De.D0T,hcLight:De.D0T},R.NC("editorSuggestWidgetBackground","Background color of the suggest widget.")),(0,De.P6G)("editorSuggestWidget.border",{dark:De.D1_,light:De.D1_,hcDark:De.D1_,hcLight:De.D1_},R.NC("editorSuggestWidgetBorder","Border color of the suggest widget."));var rt=(0,De.P6G)("editorSuggestWidget.foreground",{dark:De.NOs,light:De.NOs,hcDark:De.NOs,hcLight:De.NOs},R.NC("editorSuggestWidgetForeground","Foreground color of the suggest widget."));(0,De.P6G)("editorSuggestWidget.selectedForeground",{dark:De.NPS,light:De.NPS,hcDark:De.NPS,hcLight:De.NPS},R.NC("editorSuggestWidgetSelectedForeground","Foreground color of the selected entry in the suggest widget.")),(0,De.P6G)("editorSuggestWidget.selectedIconForeground",{dark:De.cbQ,light:De.cbQ,hcDark:De.cbQ,hcLight:De.cbQ},R.NC("editorSuggestWidgetSelectedIconForeground","Icon foreground color of the selected entry in the suggest widget."));var at=(0,De.P6G)("editorSuggestWidget.selectedBackground",{dark:De.Vqd,light:De.Vqd,hcDark:De.Vqd,hcLight:De.Vqd},R.NC("editorSuggestWidgetSelectedBackground","Background color of the selected entry in the suggest widget."));(0,De.P6G)("editorSuggestWidget.highlightForeground",{dark:De.Gwp,light:De.Gwp,hcDark:De.Gwp,hcLight:De.Gwp},R.NC("editorSuggestWidgetHighlightForeground","Color of the match highlights in the suggest widget.")),(0,De.P6G)("editorSuggestWidget.focusHighlightForeground",{dark:De.PX0,light:De.PX0,hcDark:De.PX0,hcLight:De.PX0},R.NC("editorSuggestWidgetFocusHighlightForeground","Color of the match highlights in the suggest widget when an item is focused.")),(0,De.P6G)("editorSuggestWidgetStatus.foreground",{dark:(0,De.ZnX)(rt,.5),light:(0,De.ZnX)(rt,.5),hcDark:(0,De.ZnX)(rt,.5),hcLight:(0,De.ZnX)(rt,.5)},R.NC("editorSuggestWidgetStatusForeground","Foreground color of the suggest widget status."));var lt=function(){function e(t,i){(0,l.Z)(this,e),this._service=t,this._key="suggestWidget.size/".concat(i.getEditorType(),"/").concat(i instanceof pe.H)}return(0,d.Z)(e,[{key:"restore",value:function(){var e,t=null!==(e=this._service.get(this._key,0))&&void 0!==e?e:"";try{var i=JSON.parse(t);if(he.Dimension.is(i))return he.Dimension.lift(i)}catch(n){}}},{key:"store",value:function(e){this._service.store(this._key,JSON.stringify(e),0,1)}},{key:"reset",value:function(){this._service.remove(this._key,0)}}]),e}(),dt=tt=function(){function e(t,i,n,o,s){var r=this;(0,l.Z)(this,e),this.editor=t,this._storageService=i,this._state=0,this._isAuto=!1,this._pendingLayout=new m.XK,this._pendingShowDetails=new m.XK,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new h._F,this._disposables=new m.SL,this._onDidSelect=new p.K3,this._onDidFocus=new p.K3,this._onDidHide=new p.Q5,this._onDidShow=new p.Q5,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new p.Q5,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new Ie.f,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new ut(this,t),this._persistedSize=new lt(i,t);var a,c=(0,d.Z)((function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,l.Z)(this,e),this.persistedSize=t,this.currentSize=i,this.persistHeight=n,this.persistWidth=o}));this._disposables.add(this.element.onDidWillResize((function(){r._contentWidget.lockPreference(),a=new c(r._persistedSize.restore(),r.element.size)}))),this._disposables.add(this.element.onDidResize((function(e){var t,i,n,o;if(r._resize(e.dimension.width,e.dimension.height),a&&(a.persistHeight=a.persistHeight||!!e.north||!!e.south,a.persistWidth=a.persistWidth||!!e.east||!!e.west),e.done){if(a){var s=r.getLayoutInfo(),l=s.itemHeight,d=s.defaultSize,c=Math.round(l/2),u=r.element.size,h=u.width,g=u.height;(!a.persistHeight||Math.abs(a.currentSize.height-g)<=c)&&(g=null!==(i=null===(t=a.persistedSize)||void 0===t?void 0:t.height)&&void 0!==i?i:d.height),(!a.persistWidth||Math.abs(a.currentSize.width-h)<=c)&&(h=null!==(o=null===(n=a.persistedSize)||void 0===n?void 0:n.width)&&void 0!==o?o:d.width),r._persistedSize.store(new he.Dimension(h,g))}r._contentWidget.unlockPreference(),a=void 0}}))),this._messageElement=he.append(this.element.domNode,he.$(".message")),this._listElement=he.append(this.element.domNode,he.$(".tree"));var u=this._disposables.add(s.createInstance(ze,this.editor));u.onDidClose(this.toggleDetails,this,this._disposables),this._details=new We(u,this.editor);var g=function(){return r.element.domNode.classList.toggle("no-icons",!r.editor.getOption(117).showIcons)};g();var f=s.createInstance(Ye,this.editor);this._disposables.add(f),this._disposables.add(f.onDidToggleDetails((function(){return r.toggleDetails()}))),this._list=new ge.aV("SuggestWidget",this._listElement,{getHeight:function(e){return r.getLayoutInfo().itemHeight},getTemplateId:function(e){return"suggestion"}},[f],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:function(){return"option"},getWidgetAriaLabel:function(){return R.NC("suggest","Suggest")},getWidgetRole:function(){return"listbox"},getAriaLabel:function(e){var t=e.textLabel;if("string"!==typeof e.completion.label){var i=e.completion.label,n=i.detail,o=i.description;n&&o?t=R.NC("label.full","{0} {1}, {2}",t,n,o):n?t=R.NC("label.detail","{0} {1}",t,n):o&&(t=R.NC("label.desc","{0}, {1}",t,o))}if(!e.isResolved||!r._isDetailsVisible())return t;var s=e.completion,a=s.documentation,l=s.detail,d=q.WU("{0}{1}",l||"",a?"string"===typeof a?a:a.value:"");return R.NC("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",t,d)}}}),this._list.style((0,it.TU)({listInactiveFocusBackground:at,listInactiveFocusOutline:De.xL1})),this._status=s.createInstance(Ce,this.element.domNode,A.GI);var _=function(){return r.element.domNode.classList.toggle("with-status-bar",r.editor.getOption(117).showStatusBar)};_(),this._disposables.add(o.onDidColorThemeChange((function(e){return r._onThemeChange(e)}))),this._onThemeChange(o.getColorTheme()),this._disposables.add(this._list.onMouseDown((function(e){return r._onListMouseDownOrTap(e)}))),this._disposables.add(this._list.onTap((function(e){return r._onListMouseDownOrTap(e)}))),this._disposables.add(this._list.onDidChangeSelection((function(e){return r._onListSelection(e)}))),this._disposables.add(this._list.onDidChangeFocus((function(e){return r._onListFocus(e)}))),this._disposables.add(this.editor.onDidChangeCursorSelection((function(){return r._onCursorSelectionChanged()}))),this._disposables.add(this.editor.onDidChangeConfiguration((function(e){e.hasChanged(117)&&(_(),g())}))),this._ctxSuggestWidgetVisible=A._y.Visible.bindTo(n),this._ctxSuggestWidgetDetailsVisible=A._y.DetailsVisible.bindTo(n),this._ctxSuggestWidgetMultipleSuggestions=A._y.MultipleSuggestions.bindTo(n),this._ctxSuggestWidgetHasFocusedSuggestion=A._y.HasFocusedSuggestion.bindTo(n),this._disposables.add(he.addStandardDisposableListener(this._details.widget.domNode,"keydown",(function(e){r._onDetailsKeydown.fire(e)}))),this._disposables.add(this.editor.onMouseDown((function(e){return r._onEditorMouseDown(e)})))}return(0,d.Z)(e,[{key:"dispose",value:function(){var e;this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),null===(e=this._loadingTimeout)||void 0===e||e.dispose(),this._pendingLayout.dispose(),this._pendingShowDetails.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}},{key:"_onEditorMouseDown",value:function(e){this._details.widget.domNode.contains(e.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(e.target.element)&&this.editor.focus()}},{key:"_onCursorSelectionChanged",value:function(){0!==this._state&&this._contentWidget.layout()}},{key:"_onListMouseDownOrTap",value:function(e){"undefined"!==typeof e.element&&"undefined"!==typeof e.index&&(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}},{key:"_onListSelection",value:function(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}},{key:"_select",value:function(e,t){var i=this._completionModel;i&&(this._onDidSelect.fire({item:e,index:t,model:i}),this.editor.focus())}},{key:"_onThemeChange",value:function(e){this._details.widget.borderWidth=(0,Le.c3)(e.type)?2:1}},{key:"_onListFocus",value:function(e){var t,i=this;if(!this._ignoreFocusEvents){if(!e.elements.length)return this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0}),void this._ctxSuggestWidgetHasFocusedSuggestion.set(!1);if(this._completionModel){this._ctxSuggestWidgetHasFocusedSuggestion.set(!0);var n=e.elements[0],o=e.indexes[0];n!==this._focusedItem&&(null===(t=this._currentSuggestionDetails)||void 0===t||t.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=n,this._list.reveal(o),this._currentSuggestionDetails=(0,h.PG)((function(e){return st(i,void 0,void 0,(0,j.Z)().mark((function t(){var i,o,s=this;return(0,j.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=(0,h.Vg)((function(){s._isDetailsVisible()&&s.showDetails(!0)}),250),o=e.onCancellationRequested((function(){return i.dispose()})),t.prev=2,t.next=5,n.resolve(e);case 5:return t.abrupt("return",t.sent);case 6:return t.prev=6,i.dispose(),o.dispose(),t.finish(6);case 10:case"end":return t.stop()}}),t,null,[[2,,6,10]])})))})),this._currentSuggestionDetails.then((function(){o>=i._list.length||n!==i._list.element(o)||(i._ignoreFocusEvents=!0,i._list.splice(o,1,[n]),i._list.setFocus([o]),i._ignoreFocusEvents=!1,i._isDetailsVisible()?i.showDetails(!1):i.element.domNode.classList.remove("docs-side"),i.editor.setAriaOptions({activeDescendant:Qe(o)}))})).catch(f.dL)),this._onDidFocus.fire({item:n,index:o,model:this._completionModel})}}}},{key:"_setState",value:function(e){if(this._state!==e)switch(this._state=e,this.element.domNode.classList.toggle("frozen",4===e),this.element.domNode.classList.remove("message"),e){case 0:he.hide(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._ctxSuggestWidgetHasFocusedSuggestion.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=tt.LOADING_MESSAGE,he.hide(this._listElement,this._status.element),he.show(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,(0,c.i7)(tt.LOADING_MESSAGE);break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=tt.NO_SUGGESTIONS_MESSAGE,he.hide(this._listElement,this._status.element),he.show(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,(0,c.i7)(tt.NO_SUGGESTIONS_MESSAGE);break;case 3:case 4:he.hide(this._messageElement),he.show(this._listElement,this._status.element),this._show();break;case 5:he.hide(this._messageElement),he.show(this._listElement,this._status.element),this._details.show(),this._show()}}},{key:"_show",value:function(){var e=this;this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet((function(){e.element.domNode.classList.add("visible"),e._onDidShow.fire(e)}),100)}},{key:"showTriggered",value:function(e,t){var i=this;0===this._state&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!e,this._isAuto||(this._loadingTimeout=(0,h.Vg)((function(){return i._setState(1)}),t)))}},{key:"showSuggestions",value:function(e,t,i,n,o){var s,r,a=this;if(this._contentWidget.setPosition(this.editor.getPosition()),null===(s=this._loadingTimeout)||void 0===s||s.dispose(),null===(r=this._currentSuggestionDetails)||void 0===r||r.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==e&&(this._completionModel=e),i&&2!==this._state&&0!==this._state)this._setState(4);else{var l=this._completionModel.items.length,d=0===l;if(this._ctxSuggestWidgetMultipleSuggestions.set(l>1),d)return this._setState(n?0:2),void(this._completionModel=void 0);this._focusedItem=void 0,this._onDidFocus.pause(),this._onDidSelect.pause();try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(i?4:3),this._list.reveal(t,0),this._list.setFocus(o?[]:[t])}finally{this._onDidFocus.resume(),this._onDidSelect.resume()}this._pendingLayout.value=he.runAtThisOrScheduleAtNextAnimationFrame((function(){a._pendingLayout.clear(),a._layout(a.element.size),a._details.widget.domNode.classList.remove("focused")}))}}},{key:"focusSelected",value:function(){this._list.length>0&&this._list.setFocus([0])}},{key:"selectNextPage",value:function(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}},{key:"selectNext",value:function(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}},{key:"selectLast",value:function(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}},{key:"selectPreviousPage",value:function(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}},{key:"selectPrevious",value:function(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}},{key:"selectFirst",value:function(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}},{key:"getFocusedItem",value:function(){if(0!==this._state&&2!==this._state&&1!==this._state&&this._completionModel&&this._list.getFocus().length>0)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}},{key:"toggleDetailsFocus",value:function(){5===this._state?(this._setState(3),this._details.widget.domNode.classList.remove("focused")):3===this._state&&this._isDetailsVisible()&&(this._setState(5),this._details.widget.domNode.classList.add("focused"))}},{key:"toggleDetails",value:function(){this._isDetailsVisible()?(this._pendingShowDetails.clear(),this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):!Ze(this._list.getFocusedElements()[0])&&!this._explainMode||3!==this._state&&5!==this._state&&4!==this._state||(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this.showDetails(!1))}},{key:"showDetails",value:function(e){var t=this;this._pendingShowDetails.value=he.runAtThisOrScheduleAtNextAnimationFrame((function(){t._pendingShowDetails.clear(),t._details.show(),e?t._details.widget.renderLoading():t._details.widget.renderItem(t._list.getFocusedElements()[0],t._explainMode),t._positionDetails(),t.editor.focus(),t.element.domNode.classList.add("shows-details")}))}},{key:"toggleExplainMode",value:function(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this.showDetails(!1):this.toggleDetails())}},{key:"resetPersistedSize",value:function(){this._persistedSize.reset()}},{key:"hideWidget",value:function(){var e;this._pendingLayout.clear(),this._pendingShowDetails.clear(),null===(e=this._loadingTimeout)||void 0===e||e.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();var t=this._persistedSize.restore(),i=Math.ceil(4.3*this.getLayoutInfo().itemHeight);t&&t.height<i&&this._persistedSize.store(t.with(void 0,i))}},{key:"isFrozen",value:function(){return 4===this._state}},{key:"_afterRender",value:function(e){null!==e?2!==this._state&&1!==this._state&&(this._isDetailsVisible()&&this._details.show(),this._positionDetails()):this._isDetailsVisible()&&this._details.hide()}},{key:"_layout",value:function(e){var t,i,n;if(this.editor.hasModel()&&this.editor.getDomNode()){var o=he.getClientArea(this.element.domNode.ownerDocument.body),s=this.getLayoutInfo();e||(e=s.defaultSize);var r=e.height,a=e.width;if(this._status.element.style.height="".concat(s.itemHeight,"px"),2===this._state||1===this._state)r=s.itemHeight+s.borderHeight,a=s.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new he.Dimension(a,r),this._contentWidget.setPreference(2);else{var l=o.width-s.borderHeight-2*s.horizontalPadding;a>l&&(a=l);var d=this._completionModel?this._completionModel.stats.pLabelLen*s.typicalHalfwidthCharacterWidth:a,c=s.statusBarHeight+this._list.contentHeight+s.borderHeight,u=s.itemHeight+s.statusBarHeight,h=he.getDomNodePagePosition(this.editor.getDomNode()),g=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),f=h.top+g.top+g.height,p=Math.min(o.height-f-s.verticalPadding,c),_=h.top+g.top-s.verticalPadding,m=Math.min(_,c),v=Math.min(Math.max(m,p)+s.borderHeight,c);r===(null===(t=this._cappedHeight)||void 0===t?void 0:t.capped)&&(r=this._cappedHeight.wanted),r<u&&(r=u),r>v&&(r=v);r>p||this._forceRenderingAbove&&_>150?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),v=m):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),v=p),this.element.preferredSize=new he.Dimension(d,s.defaultSize.height),this.element.maxSize=new he.Dimension(l,v),this.element.minSize=new he.Dimension(220,u),this._cappedHeight=r===c?{wanted:null!==(n=null===(i=this._cappedHeight)||void 0===i?void 0:i.wanted)&&void 0!==n?n:e.height,capped:r}:void 0}this._resize(a,r)}}},{key:"_resize",value:function(e,t){var i=this.element.maxSize,n=i.width,o=i.height;e=Math.min(n,e),t=Math.min(o,t);var s=this.getLayoutInfo().statusBarHeight;this._list.layout(t-s,e),this._listElement.style.height="".concat(t-s,"px"),this.element.layout(t,e),this._contentWidget.layout(),this._positionDetails()}},{key:"_positionDetails",value:function(){var e;this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,2===(null===(e=this._contentWidget.getPosition())||void 0===e?void 0:e.preference[0]))}},{key:"getLayoutInfo",value:function(){var e=this.editor.getOption(50),t=(0,fe.uZ)(this.editor.getOption(119)||e.lineHeight,8,1e3),i=this.editor.getOption(117).showStatusBar&&2!==this._state&&1!==this._state?t:0,n=this._details.widget.borderWidth,o=2*n;return{itemHeight:t,statusBarHeight:i,borderWidth:n,borderHeight:o,typicalHalfwidthCharacterWidth:e.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new he.Dimension(430,i+12*t+o)}}},{key:"_isDetailsVisible",value:function(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}},{key:"_setDetailsVisible",value:function(e){this._storageService.store("expandSuggestionDocs",e,0,0)}},{key:"forceRenderingAbove",value:function(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}},{key:"stopForceRenderingAbove",value:function(){this._forceRenderingAbove=!1}}]),e}();dt.LOADING_MESSAGE=R.NC("suggestWidget.loading","Loading..."),dt.NO_SUGGESTIONS_MESSAGE=R.NC("suggestWidget.noSuggestions","No suggestions."),dt=tt=nt([ot(1,xe.Uy),ot(2,F.i6),ot(3,Ne.XE),ot(4,Z.TG)],dt);var ct,ut=function(){function e(t,i){(0,l.Z)(this,e),this._widget=t,this._editor=i,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}return(0,d.Z)(e,[{key:"dispose",value:function(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}},{key:"getId",value:function(){return"editor.widget.suggestWidget"}},{key:"getDomNode",value:function(){return this._widget.element.domNode}},{key:"show",value:function(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}},{key:"hide",value:function(){this._hidden||(this._hidden=!0,this.layout())}},{key:"layout",value:function(){this._editor.layoutContentWidget(this)}},{key:"getPosition",value:function(){return!this._hidden&&this._position&&this._preference?{position:this._position,preference:[this._preference]}:null}},{key:"beforeRender",value:function(){var e=this._widget.element.size,t=e.height,i=e.width,n=this._widget.getLayoutInfo(),o=n.borderWidth,s=n.horizontalPadding;return new he.Dimension(i+2*o+s,t+2*o)}},{key:"afterRender",value:function(e){this._widget._afterRender(e)}},{key:"setPreference",value:function(e){this._preferenceLocked||(this._preference=e)}},{key:"lockPreference",value:function(){this._preferenceLocked=!0}},{key:"unlockPreference",value:function(){this._preferenceLocked=!1}},{key:"setPosition",value:function(e){this._position=e}}]),e}(),ht=i(44641),gt=i(62204),ft=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},pt=function(e,t){return function(i,n){t(i,n,e)}},_t=function(){function e(t,i){if((0,l.Z)(this,e),this._model=t,this._position=i,t.getLineMaxColumn(i.lineNumber)!==i.column){var n=t.getOffsetAt(i),o=t.getPositionAt(n+1);this._marker=t.deltaDecorations([],[{range:x.e.fromPositions(i,o),options:{description:"suggest-line-suffix",stickiness:1}}])}}return(0,d.Z)(e,[{key:"dispose",value:function(){this._marker&&!this._model.isDisposed()&&this._model.deltaDecorations(this._marker,[])}},{key:"delta",value:function(e){if(this._model.isDisposed()||this._position.lineNumber!==e.lineNumber)return 0;if(this._marker){var t=this._model.getDecorationRange(this._marker[0]);return this._model.getOffsetAt(t.getStartPosition())-this._model.getOffsetAt(e)}return this._model.getLineMaxColumn(e.lineNumber)-e.column}}]),e}(),mt=ct=function(){function e(t,i,n,o,s,r,d){var c=this;(0,l.Z)(this,e),this._memoryService=i,this._commandService=n,this._contextKeyService=o,this._instantiationService=s,this._logService=r,this._telemetryService=d,this._lineSuffix=new m.XK,this._toDispose=new m.SL,this._selectors=new vt((function(e){return e.priority})),this._onWillInsertSuggestItem=new p.Q5,this.onWillInsertSuggestItem=this._onWillInsertSuggestItem.event,this.editor=t,this.model=s.createInstance(ce,this.editor),this._selectors.register({priority:0,select:function(e,t,i){return c._memoryService.select(e,t,i)}});var u=A._y.InsertMode.bindTo(o);u.set(t.getOption(117).insertMode),this._toDispose.add(this.model.onDidTrigger((function(){return u.set(t.getOption(117).insertMode)}))),this.widget=this._toDispose.add(new h.Ue((function(){var e=c._instantiationService.createInstance(dt,c.editor);c._toDispose.add(e),c._toDispose.add(e.onDidSelect((function(e){return c._insertSuggestion(e,0)}),c));var t=new K(c.editor,e,c.model,(function(e){return c._insertSuggestion(e,2)}));c._toDispose.add(t);var i=A._y.MakesTextEdit.bindTo(c._contextKeyService),n=A._y.HasInsertAndReplaceRange.bindTo(c._contextKeyService),o=A._y.CanResolve.bindTo(c._contextKeyService);return c._toDispose.add((0,m.OF)((function(){i.reset(),n.reset(),o.reset()}))),c._toDispose.add(e.onDidFocus((function(e){var t=e.item,s=c.editor.getPosition(),r=t.editStart.column,a=s.column,l=!0;"smart"!==c.editor.getOption(1)||2!==c.model.state||t.completion.additionalTextEdits||4&t.completion.insertTextRules||a-r!==t.completion.insertText.length||(l=c.editor.getModel().getValueInRange({startLineNumber:s.lineNumber,startColumn:r,endLineNumber:s.lineNumber,endColumn:a})!==t.completion.insertText);i.set(l),n.set(!C.L.equals(t.editInsertEnd,t.editReplaceEnd)),o.set(Boolean(t.provider.resolveCompletionItem)||Boolean(t.completion.documentation)||t.completion.detail!==t.completion.label)}))),c._toDispose.add(e.onDetailsKeyDown((function(e){e.toKeyCodeChord().equals(new _.$M(!0,!1,!1,!1,33))||v.dz&&e.toKeyCodeChord().equals(new _.$M(!1,!1,!1,!0,33))?e.stopPropagation():e.toKeyCodeChord().isModifierKey()||c.editor.focus()}))),e}))),this._overtypingCapturer=this._toDispose.add(new h.Ue((function(){return c._toDispose.add(new ue(c.editor,c.model))}))),this._alternatives=this._toDispose.add(new h.Ue((function(){return c._toDispose.add(new H(c.editor,c._contextKeyService))}))),this._toDispose.add(s.createInstance(M,t)),this._toDispose.add(this.model.onDidTrigger((function(e){c.widget.value.showTriggered(e.auto,e.shy?250:50),c._lineSuffix.value=new _t(c.editor.getModel(),e.position)}))),this._toDispose.add(this.model.onDidSuggest((function(e){if(!e.triggerOptions.shy){var t,i=-1,n=(0,a.Z)(c._selectors.itemsOrderedByPriorityDesc);try{for(n.s();!(t=n.n()).done;){if(-1!==(i=t.value.select(c.editor.getModel(),c.editor.getPosition(),e.completionModel.items)))break}}catch(r){n.e(r)}finally{n.f()}-1===i&&(i=0);var o=!1;if(e.triggerOptions.auto){var s=c.editor.getOption(117);"never"===s.selectionMode||"always"===s.selectionMode?o="never"===s.selectionMode:"whenTriggerCharacter"===s.selectionMode?o=1!==e.triggerOptions.triggerKind:"whenQuickSuggestion"===s.selectionMode&&(o=1===e.triggerOptions.triggerKind&&!e.triggerOptions.refilter)}c.widget.value.showSuggestions(e.completionModel,i,e.isFrozen,e.triggerOptions.auto,o)}}))),this._toDispose.add(this.model.onDidCancel((function(e){e.retrigger||c.widget.value.hideWidget()}))),this._toDispose.add(this.editor.onDidBlurEditorWidget((function(){c.model.cancel(),c.model.clear()})));var g=A._y.AcceptSuggestionsOnEnter.bindTo(o),f=function(){var e=c.editor.getOption(1);g.set("on"===e||"smart"===e)};this._toDispose.add(this.editor.onDidChangeConfiguration((function(){return f()}))),f()}return(0,d.Z)(e,[{key:"dispose",value:function(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose(),this._onWillInsertSuggestItem.dispose()}},{key:"_insertSuggestion",value:function(e,t){var i=this;if(!e||!e.item)return this._alternatives.value.reset(),this.model.cancel(),void this.model.clear();if(this.editor.hasModel()){var n=L.SnippetController2.get(this.editor);if(n){this._onWillInsertSuggestItem.fire({item:e.item});var o=this.editor.getModel(),s=o.getAlternativeVersionId(),l=e.item,d=[],c=new g.A;1&t||this.editor.pushUndoStop();var u=this.getOverwriteInfo(l,Boolean(8&t));this._memoryService.memorize(o,this.editor.getPosition(),l);var h=l.isResolved,p=-1,_=-1;if(Array.isArray(l.completion.additionalTextEdits)){this.model.cancel();var m=S.Z.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",l.completion.additionalTextEdits.map((function(e){return w.h.replaceMove(x.e.lift(e.range),e.text)}))),m.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!h){var v,b=new y.G,k=o.onDidChangeContent((function(e){if(e.isFlush)return c.cancel(),void k.dispose();var t,i=(0,a.Z)(e.changes);try{for(i.s();!(t=i.n()).done;){var n=t.value,o=x.e.getEndPosition(n.range);v&&!C.L.isBefore(o,v)||(v=o)}}catch(s){i.e(s)}finally{i.f()}})),D=t;t|=2;var I=!1,F=this.editor.onWillType((function(){F.dispose(),I=!0,2&D||i.editor.pushUndoStop()}));d.push(l.resolve(c.token).then((function(){if(l.completion.additionalTextEdits&&!c.token.isCancellationRequested){if(v&&l.completion.additionalTextEdits.some((function(e){return C.L.isBefore(v,x.e.getStartPosition(e.range))})))return!1;I&&i.editor.pushUndoStop();var e=S.Z.capture(i.editor);return i.editor.executeEdits("suggestController.additionalTextEdits.async",l.completion.additionalTextEdits.map((function(e){return w.h.replaceMove(x.e.lift(e.range),e.text)}))),e.restoreRelativeVerticalPositionOfCursor(i.editor),!I&&2&D||i.editor.pushUndoStop(),!0}})).then((function(e){i._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",b.elapsed(),e),_=!0===e?1:!1===e?0:-2})).finally((function(){k.dispose(),F.dispose()})))}var T=l.completion.insertText;if(4&l.completion.insertTextRules||(T=N.Yj.escape(T)),this.model.cancel(),n.insert(T,{overwriteBefore:u.overwriteBefore,overwriteAfter:u.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(1&l.completion.insertTextRules),clipboardText:e.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),2&t||this.editor.pushUndoStop(),l.completion.command)if(l.completion.command.id===yt.id)this.model.trigger({auto:!0,retrigger:!0});else{var P,M=new y.G;d.push((P=this._commandService).executeCommand.apply(P,[l.completion.command.id].concat((0,r.Z)(l.completion.command.arguments?(0,r.Z)(l.completion.command.arguments):[]))).catch((function(e){l.completion.extensionId?(0,f.Cp)(e):(0,f.dL)(e)})).finally((function(){p=M.elapsed()})))}4&t&&this._alternatives.value.set(e,(function(e){for(c.cancel();o.canUndo();){s!==o.getAlternativeVersionId()&&o.undo(),i._insertSuggestion(e,3|(8&t?8:0));break}})),this._alertCompletionItem(l),Promise.all(d).finally((function(){i._reportSuggestionAcceptedTelemetry(l,o,h,p,_),i.model.clear(),c.dispose()}))}}}},{key:"_reportSuggestionAcceptedTelemetry",value:function(e,t,i,n,o){var s,r,a;0!==Math.floor(100*Math.random())&&this._telemetryService.publicLog2("suggest.acceptedSuggestion",{extensionId:null!==(r=null===(s=e.extensionId)||void 0===s?void 0:s.value)&&void 0!==r?r:"unknown",providerId:null!==(a=e.provider._debugDisplayName)&&void 0!==a?a:"unknown",kind:e.completion.kind,basenameHash:(0,gt.vp)((0,ht.EZ)(t.uri)).toString(16),languageId:t.getLanguageId(),fileExtension:(0,ht.DZ)(t.uri),resolveInfo:e.provider.resolveCompletionItem?i?1:0:-1,resolveDuration:e.resolveDuration,commandDuration:n,additionalEditsAsync:o})}},{key:"getOverwriteInfo",value:function(e,t){(0,b.p_)(this.editor.hasModel());var i="replace"===this.editor.getOption(117).insertMode;t&&(i=!i);var n=e.position.column-e.editStart.column,o=(i?e.editReplaceEnd.column:e.editInsertEnd.column)-e.position.column;return{overwriteBefore:n+(this.editor.getPosition().column-e.position.column),overwriteAfter:o+(this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0)}}},{key:"_alertCompletionItem",value:function(e){if((0,u.Of)(e.completion.additionalTextEdits)){var t=R.NC("aria.alert.snippet","Accepting '{0}' made {1} additional edits",e.textLabel,e.completion.additionalTextEdits.length);(0,c.Z9)(t)}}},{key:"triggerSuggest",value:function(e,t,i){this.editor.hasModel()&&(this.model.trigger({auto:null!==t&&void 0!==t&&t,completionOptions:{providerFilter:e,kindFilter:i?new Set:void 0}}),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}},{key:"triggerSuggestAndAcceptBest",value:function(e){var t=this;if(this.editor.hasModel()){var i=this.editor.getPosition(),n=function(){i.equals(t.editor.getPosition())&&t._commandService.executeCommand(e.fallback)};p.ju.once(this.model.onDidTrigger)((function(e){var i=[];p.ju.any(t.model.onDidTrigger,t.model.onDidCancel)((function(){(0,m.B9)(i),n()}),void 0,i),t.model.onDidSuggest((function(e){var o=e.completionModel;if((0,m.B9)(i),0!==o.items.length){var s=t._memoryService.select(t.editor.getModel(),t.editor.getPosition(),o.items),r=o.items[s];!function(e){if(4&e.completion.insertTextRules||e.completion.additionalTextEdits)return!0;var i=t.editor.getPosition(),n=e.editStart.column,o=i.column;return o-n!==e.completion.insertText.length||t.editor.getModel().getValueInRange({startLineNumber:i.lineNumber,startColumn:n,endLineNumber:i.lineNumber,endColumn:o})!==e.completion.insertText}(r)?n():(t.editor.pushUndoStop(),t._insertSuggestion({index:s,item:r,model:o},7))}else n()}),void 0,i)})),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(i,0),this.editor.focus()}}},{key:"acceptSelectedSuggestion",value:function(e,t){var i=this.widget.value.getFocusedItem(),n=0;e&&(n|=4),t&&(n|=8),this._insertSuggestion(i,n)}},{key:"acceptNextSuggestion",value:function(){this._alternatives.value.next()}},{key:"acceptPrevSuggestion",value:function(){this._alternatives.value.prev()}},{key:"cancelSuggestWidget",value:function(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}},{key:"focusSuggestion",value:function(){this.widget.value.focusSelected()}},{key:"selectNextSuggestion",value:function(){this.widget.value.selectNext()}},{key:"selectNextPageSuggestion",value:function(){this.widget.value.selectNextPage()}},{key:"selectLastSuggestion",value:function(){this.widget.value.selectLast()}},{key:"selectPrevSuggestion",value:function(){this.widget.value.selectPrevious()}},{key:"selectPrevPageSuggestion",value:function(){this.widget.value.selectPreviousPage()}},{key:"selectFirstSuggestion",value:function(){this.widget.value.selectFirst()}},{key:"toggleSuggestionDetails",value:function(){this.widget.value.toggleDetails()}},{key:"toggleExplainMode",value:function(){this.widget.value.toggleExplainMode()}},{key:"toggleSuggestionFocus",value:function(){this.widget.value.toggleDetailsFocus()}},{key:"resetWidgetSize",value:function(){this.widget.value.resetPersistedSize()}},{key:"forceRenderingAbove",value:function(){this.widget.value.forceRenderingAbove()}},{key:"stopForceRenderingAbove",value:function(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}},{key:"registerSelector",value:function(e){return this._selectors.register(e)}}],[{key:"get",value:function(e){return e.getContribution(ct.ID)}}]),e}();mt.ID="editor.contrib.suggestController",mt=ct=ft([pt(1,I.Fh),pt(2,O.H),pt(3,F.i6),pt(4,Z.TG),pt(5,z.VZ),pt(6,ee.b)],mt);var vt=function(){function e(t){(0,l.Z)(this,e),this.prioritySelector=t,this._items=new Array}return(0,d.Z)(e,[{key:"register",value:function(e){var t=this;if(-1!==this._items.indexOf(e))throw new Error("Value is already registered");return this._items.push(e),this._items.sort((function(e,i){return t.prioritySelector(i)-t.prioritySelector(e)})),{dispose:function(){var i=t._items.indexOf(e);i>=0&&t._items.splice(i,1)}}}},{key:"itemsOrderedByPriorityDesc",get:function(){return this._items}}]),e}(),yt=function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,l.Z)(this,i),t.call(this,{id:i.id,label:R.NC("suggest.trigger.label","Trigger Suggest"),alias:"Trigger Suggest",precondition:F.Ao.and(D.u.writable,D.u.hasCompletionItemProvider,A._y.Visible.toNegated()),kbOpts:{kbExpr:D.u.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}return(0,d.Z)(i,[{key:"run",value:function(e,t,i){var n,o=mt.get(t);o&&(i&&"object"===typeof i&&!0===i.auto&&(n=!0),o.triggerSuggest(void 0,n,void 0))}}]),i}(k.R6);yt.id="editor.action.triggerSuggest",(0,k._K)(mt.ID,mt,2),(0,k.Qr)(yt);var bt=190,St=k._l.bindToContribution(mt.get);(0,k.fK)(new St({id:"acceptSelectedSuggestion",precondition:F.Ao.and(A._y.Visible,A._y.HasFocusedSuggestion),handler:function(e){e.acceptSelectedSuggestion(!0,!1)},kbOpts:[{primary:2,kbExpr:F.Ao.and(A._y.Visible,D.u.textInputFocus),weight:bt},{primary:3,kbExpr:F.Ao.and(A._y.Visible,D.u.textInputFocus,A._y.AcceptSuggestionsOnEnter,A._y.MakesTextEdit),weight:bt}],menuOpts:[{menuId:A.GI,title:R.NC("accept.insert","Insert"),group:"left",order:1,when:A._y.HasInsertAndReplaceRange.toNegated()},{menuId:A.GI,title:R.NC("accept.insert","Insert"),group:"left",order:1,when:F.Ao.and(A._y.HasInsertAndReplaceRange,A._y.InsertMode.isEqualTo("insert"))},{menuId:A.GI,title:R.NC("accept.replace","Replace"),group:"left",order:1,when:F.Ao.and(A._y.HasInsertAndReplaceRange,A._y.InsertMode.isEqualTo("replace"))}]})),(0,k.fK)(new St({id:"acceptAlternativeSelectedSuggestion",precondition:F.Ao.and(A._y.Visible,D.u.textInputFocus,A._y.HasFocusedSuggestion),kbOpts:{weight:bt,kbExpr:D.u.textInputFocus,primary:1027,secondary:[1026]},handler:function(e){e.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:A.GI,group:"left",order:2,when:F.Ao.and(A._y.HasInsertAndReplaceRange,A._y.InsertMode.isEqualTo("insert")),title:R.NC("accept.replace","Replace")},{menuId:A.GI,group:"left",order:2,when:F.Ao.and(A._y.HasInsertAndReplaceRange,A._y.InsertMode.isEqualTo("replace")),title:R.NC("accept.insert","Insert")}]})),O.P.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion"),(0,k.fK)(new St({id:"hideSuggestWidget",precondition:A._y.Visible,handler:function(e){return e.cancelSuggestWidget()},kbOpts:{weight:bt,kbExpr:D.u.textInputFocus,primary:9,secondary:[1033]}})),(0,k.fK)(new St({id:"selectNextSuggestion",precondition:F.Ao.and(A._y.Visible,F.Ao.or(A._y.MultipleSuggestions,A._y.HasFocusedSuggestion.negate())),handler:function(e){return e.selectNextSuggestion()},kbOpts:{weight:bt,kbExpr:D.u.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})),(0,k.fK)(new St({id:"selectNextPageSuggestion",precondition:F.Ao.and(A._y.Visible,F.Ao.or(A._y.MultipleSuggestions,A._y.HasFocusedSuggestion.negate())),handler:function(e){return e.selectNextPageSuggestion()},kbOpts:{weight:bt,kbExpr:D.u.textInputFocus,primary:12,secondary:[2060]}})),(0,k.fK)(new St({id:"selectLastSuggestion",precondition:F.Ao.and(A._y.Visible,F.Ao.or(A._y.MultipleSuggestions,A._y.HasFocusedSuggestion.negate())),handler:function(e){return e.selectLastSuggestion()}})),(0,k.fK)(new St({id:"selectPrevSuggestion",precondition:F.Ao.and(A._y.Visible,F.Ao.or(A._y.MultipleSuggestions,A._y.HasFocusedSuggestion.negate())),handler:function(e){return e.selectPrevSuggestion()},kbOpts:{weight:bt,kbExpr:D.u.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})),(0,k.fK)(new St({id:"selectPrevPageSuggestion",precondition:F.Ao.and(A._y.Visible,F.Ao.or(A._y.MultipleSuggestions,A._y.HasFocusedSuggestion.negate())),handler:function(e){return e.selectPrevPageSuggestion()},kbOpts:{weight:bt,kbExpr:D.u.textInputFocus,primary:11,secondary:[2059]}})),(0,k.fK)(new St({id:"selectFirstSuggestion",precondition:F.Ao.and(A._y.Visible,F.Ao.or(A._y.MultipleSuggestions,A._y.HasFocusedSuggestion.negate())),handler:function(e){return e.selectFirstSuggestion()}})),(0,k.fK)(new St({id:"focusSuggestion",precondition:F.Ao.and(A._y.Visible,A._y.HasFocusedSuggestion.negate()),handler:function(e){return e.focusSuggestion()},kbOpts:{weight:bt,kbExpr:D.u.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}}})),(0,k.fK)(new St({id:"focusAndAcceptSuggestion",precondition:F.Ao.and(A._y.Visible,A._y.HasFocusedSuggestion.negate()),handler:function(e){e.focusSuggestion(),e.acceptSelectedSuggestion(!0,!1)}})),(0,k.fK)(new St({id:"toggleSuggestionDetails",precondition:F.Ao.and(A._y.Visible,A._y.HasFocusedSuggestion),handler:function(e){return e.toggleSuggestionDetails()},kbOpts:{weight:bt,kbExpr:D.u.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:A.GI,group:"right",order:1,when:F.Ao.and(A._y.DetailsVisible,A._y.CanResolve),title:R.NC("detail.more","show less")},{menuId:A.GI,group:"right",order:1,when:F.Ao.and(A._y.DetailsVisible.toNegated(),A._y.CanResolve),title:R.NC("detail.less","show more")}]})),(0,k.fK)(new St({id:"toggleExplainMode",precondition:A._y.Visible,handler:function(e){return e.toggleExplainMode()},kbOpts:{weight:100,primary:2138}})),(0,k.fK)(new St({id:"toggleSuggestionFocus",precondition:A._y.Visible,handler:function(e){return e.toggleSuggestionFocus()},kbOpts:{weight:bt,kbExpr:D.u.textInputFocus,primary:2570,mac:{primary:778}}})),(0,k.fK)(new St({id:"insertBestCompletion",precondition:F.Ao.and(D.u.textInputFocus,F.Ao.equals("config.editor.tabCompletion","on"),M.AtEnd,A._y.Visible.toNegated(),H.OtherSuggestions.toNegated(),L.SnippetController2.InSnippetMode.toNegated()),handler:function(e,t){e.triggerSuggestAndAcceptBest((0,b.Kn)(t)?Object.assign({fallback:"tab"},t):{fallback:"tab"})},kbOpts:{weight:bt,primary:2}})),(0,k.fK)(new St({id:"insertNextSuggestion",precondition:F.Ao.and(D.u.textInputFocus,F.Ao.equals("config.editor.tabCompletion","on"),H.OtherSuggestions,A._y.Visible.toNegated(),L.SnippetController2.InSnippetMode.toNegated()),handler:function(e){return e.acceptNextSuggestion()},kbOpts:{weight:bt,kbExpr:D.u.textInputFocus,primary:2}})),(0,k.fK)(new St({id:"insertPrevSuggestion",precondition:F.Ao.and(D.u.textInputFocus,F.Ao.equals("config.editor.tabCompletion","on"),H.OtherSuggestions,A._y.Visible.toNegated(),L.SnippetController2.InSnippetMode.toNegated()),handler:function(e){return e.acceptPrevSuggestion()},kbOpts:{weight:bt,kbExpr:D.u.textInputFocus,primary:1026}})),(0,k.Qr)(function(e){(0,o.Z)(i,e);var t=(0,s.Z)(i);function i(){return(0,l.Z)(this,i),t.call(this,{id:"editor.action.resetSuggestSize",label:R.NC("suggest.reset.label","Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}return(0,d.Z)(i,[{key:"run",value:function(e,t){var i;null===(i=mt.get(t))||void 0===i||i.resetWidgetSize()}}]),i}(k.R6))},52650:function(e,t,i){i.r(t),i.d(t,{SuggestInlineCompletions:function(){return I}});var n,o=i(74165),s=i(37762),r=i(60136),a=i(27277),l=i(43144),d=i(15671),c=i(7388),u=i(21973),h=i(12928),g=i(65096),f=i(95253),p=i(76257),_=i(17429),m=i(65441),v=i(47799),y=i(51211),b=i(11522),S=i(53459),k=i(76344),w=i(64606),C=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},x=function(e,t){return function(i,n){t(i,n,e)}},D=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))},L=(0,l.Z)((function e(t,i,n,o,s,r){(0,d.Z)(this,e),this.range=t,this.insertText=i,this.filterText=n,this.additionalTextEdits=o,this.command=s,this.completion=r})),N=function(e){(0,r.Z)(i,e);var t=(0,a.Z)(i);function i(e,n,o,s,r,a){var l;return(0,d.Z)(this,i),(l=t.call(this,r.disposable)).model=e,l.line=n,l.word=o,l.completionModel=s,l._suggestMemoryService=a,l}return(0,l.Z)(i,[{key:"canBeReused",value:function(e,t,i){return this.model===e&&this.line===t&&this.word.word.length>0&&this.word.startColumn===i.startColumn&&this.word.endColumn<i.endColumn&&0===this.completionModel.getIncompleteProvider().size}},{key:"items",get:function(){var e,t,i=[],n=this.completionModel.items,o=this._suggestMemoryService.select(this.model,{lineNumber:this.line,column:this.word.endColumn+this.completionModel.lineContext.characterCountDelta},n),r=h.$.slice(n,o),a=h.$.slice(n,0,o),l=5,d=(0,s.Z)(h.$.concat(r,a));try{for(d.s();!(t=d.n()).done;){var g=t.value;if(g.score!==u.CL.Default){var f=new _.e(g.editStart.lineNumber,g.editStart.column,g.editInsertEnd.lineNumber,g.editInsertEnd.column+this.completionModel.lineContext.characterCountDelta),p=g.completion.insertTextRules&&4&g.completion.insertTextRules?{snippet:g.completion.insertText}:g.completion.insertText;i.push(new L(f,p,null!==(e=g.filterTextLow)&&void 0!==e?e:g.labelLow,g.completion.additionalTextEdits,g.completion.command,g)),l-- >=0&&g.resolve(c.T.None)}}}catch(m){d.e(m)}finally{d.f()}return i}}]),i}(g.L6);N=C([x(5,b.Fh)],N);var I=function(){function e(t,i,n,o){(0,d.Z)(this,e),this._getEditorOption=t,this._languageFeatureService=i,this._clipboardService=n,this._suggestMemoryService=o}return(0,l.Z)(e,[{key:"provideInlineCompletions",value:function(e,t,i,n){var s;return D(this,void 0,void 0,(0,o.Z)().mark((function r(){var a,l,d,c,u,h,g,f,p,m,b;return(0,o.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!i.selectedSuggestionInfo){o.next=2;break}return o.abrupt("return");case 2:if(a=this._getEditorOption(88,e),!y.tG.isAllOff(a)){o.next=5;break}return o.abrupt("return");case 5:if(e.tokenization.tokenizeIfCheap(t.lineNumber),l=e.tokenization.getLineTokens(t.lineNumber),d=l.getStandardTokenType(l.findTokenIndexAtOffset(Math.max(t.column-1-1,0))),"inline"===y.tG.valueFor(a,d)){o.next=10;break}return o.abrupt("return",void 0);case 10:if((null===(c=e.getWordAtPosition(t))||void 0===c?void 0:c.word)||(u=this._getTriggerCharacterInfo(e,t)),(null===c||void 0===c?void 0:c.word)||u){o.next=14;break}return o.abrupt("return");case 14:if(c||(c=e.getWordUntilPosition(t)),c.endColumn===t.column){o.next=17;break}return o.abrupt("return");case 17:if(g=e.getValueInRange(new _.e(t.lineNumber,1,t.lineNumber,t.column)),u||!(null===(s=this._lastResult)||void 0===s?void 0:s.canBeReused(e,t.lineNumber,c))){o.next=25;break}f=new v.t(g,t.column-this._lastResult.word.endColumn),this._lastResult.completionModel.lineContext=f,this._lastResult.acquire(),h=this._lastResult,o.next=34;break;case 25:return o.next=27,(0,y.kL)(this._languageFeatureService.completionProvider,e,t,new y.A9(void 0,void 0,null===u||void 0===u?void 0:u.providers),u&&{triggerKind:1,triggerCharacter:u.ch},n);case 27:if(!(p=o.sent).needsClipboard){o.next=32;break}return o.next=31,this._clipboardService.readText();case 31:m=o.sent;case 32:b=new v._(p.items,t.column,new v.t(g,0),S.K.None,this._getEditorOption(117,e),this._getEditorOption(111,e),{boostFullMatch:!1,firstMatchCanBeWeak:!1},m),h=new N(e,t.lineNumber,c,b,p,this._suggestMemoryService);case 34:return this._lastResult=h,o.abrupt("return",h);case 36:case"end":return o.stop()}}),r,this)})))}},{key:"handleItemDidShow",value:function(e,t){t.completion.resolve(c.T.None)}},{key:"freeInlineCompletions",value:function(e){e.release()}},{key:"_getTriggerCharacterInfo",value:function(e,t){var i,n,o=e.getValueInRange(_.e.fromPositions({lineNumber:t.lineNumber,column:t.column-1},t)),r=new Set,a=(0,s.Z)(this._languageFeatureService.completionProvider.all(e));try{for(a.s();!(n=a.n()).done;){var l=n.value;(null===(i=l.triggerCharacters)||void 0===i?void 0:i.includes(o))&&r.add(l)}}catch(d){a.e(d)}finally{a.f()}if(0!==r.size)return{providers:r,ch:o}}}]),e}();I=C([x(1,m.p),x(2,k.p),x(3,b.Fh)],I);var F=n=function(){function e(t,i,o,s){if((0,d.Z)(this,e),1===++n._counter){var r=s.createInstance(I,(function(e,i){var n;return(null!==(n=o.listCodeEditors().find((function(e){return e.getModel()===i})))&&void 0!==n?n:t).getOption(e)}));n._disposable=i.inlineCompletionsProvider.register("*",r)}}return(0,l.Z)(e,[{key:"dispose",value:function(){var e;0===--n._counter&&(null===(e=n._disposable)||void 0===e||e.dispose(),n._disposable=void 0)}}]),e}();F._counter=0,F=n=C([x(1,m.p),x(2,p.$),x(3,w.TG)],F),(0,f._K)("suggest.inlineCompletionsProvider",F,0)},11522:function(e,t,i){i.d(t,{Fh:function(){return N}});var n,o=i(29439),s=i(37762),r=i(11752),a=i(61120),l=i(60136),d=i(27277),c=i(15671),u=i(43144),h=i(71049),g=i(65096),f=i(29413),p=i(29976),_=i(70133),m=i(77819),v=i(57832),y=i(64606),b=i(88463),S=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},k=function(e,t){return function(i,n){t(i,n,e)}},w=function(){function e(t){(0,c.Z)(this,e),this.name=t}return(0,u.Z)(e,[{key:"select",value:function(e,t,i){if(0===i.length)return 0;for(var n=i[0].score[0],o=0;o<i.length;o++){var s=i[o],r=s.score,a=s.completion;if(r[0]!==n)break;if(a.preselect)return o}return 0}}]),e}(),C=function(e){(0,l.Z)(i,e);var t=(0,d.Z)(i);function i(){return(0,c.Z)(this,i),t.call(this,"first")}return(0,u.Z)(i,[{key:"memorize",value:function(e,t,i){}},{key:"toJSON",value:function(){}},{key:"fromJSON",value:function(){}}]),i}(w),x=function(e){(0,l.Z)(i,e);var t=(0,d.Z)(i);function i(){var e;return(0,c.Z)(this,i),(e=t.call(this,"recentlyUsed"))._cache=new f.z6(300,.66),e._seq=0,e}return(0,u.Z)(i,[{key:"memorize",value:function(e,t,i){var n="".concat(e.getLanguageId(),"/").concat(i.textLabel);this._cache.set(n,{touch:this._seq++,type:i.completion.kind,insertText:i.completion.insertText})}},{key:"select",value:function(e,t,n){if(0===n.length)return 0;var o=e.getLineContent(t.lineNumber).substr(t.column-10,t.column-1);if(/\s$/.test(o))return(0,r.Z)((0,a.Z)(i.prototype),"select",this).call(this,e,t,n);for(var s=n[0].score[0],l=-1,d=-1,c=-1,u=0;u<n.length&&n[u].score[0]===s;u++){var h="".concat(e.getLanguageId(),"/").concat(n[u].textLabel),g=this._cache.peek(h);if(g&&g.touch>c&&g.type===n[u].completion.kind&&g.insertText===n[u].completion.insertText&&(c=g.touch,d=u),n[u].completion.preselect&&-1===l)return u}return-1!==d?d:-1!==l?l:0}},{key:"toJSON",value:function(){return this._cache.toJSON()}},{key:"fromJSON",value:function(e){this._cache.clear();var t,i=(0,s.Z)(e);try{for(i.s();!(t=i.n()).done;){var n=(0,o.Z)(t.value,2),r=n[0],a=n[1];a.touch=0,a.type="number"===typeof a.type?a.type:_.gX.fromString(a.type),this._cache.set(r,a)}}catch(l){i.e(l)}finally{i.f()}this._seq=this._cache.size}}]),i}(w),D=function(e){(0,l.Z)(i,e);var t=(0,d.Z)(i);function i(){var e;return(0,c.Z)(this,i),(e=t.call(this,"recentlyUsedByPrefix"))._trie=p.Id.forStrings(),e._seq=0,e}return(0,u.Z)(i,[{key:"memorize",value:function(e,t,i){var n=e.getWordUntilPosition(t).word,o="".concat(e.getLanguageId(),"/").concat(n);this._trie.set(o,{type:i.completion.kind,insertText:i.completion.insertText,touch:this._seq++})}},{key:"select",value:function(e,t,n){var o=e.getWordUntilPosition(t).word;if(!o)return(0,r.Z)((0,a.Z)(i.prototype),"select",this).call(this,e,t,n);var s="".concat(e.getLanguageId(),"/").concat(o),l=this._trie.get(s);if(l||(l=this._trie.findSubstr(s)),l)for(var d=0;d<n.length;d++){var c=n[d].completion,u=c.kind,h=c.insertText;if(u===l.type&&h===l.insertText)return d}return(0,r.Z)((0,a.Z)(i.prototype),"select",this).call(this,e,t,n)}},{key:"toJSON",value:function(){var e=[];return this._trie.forEach((function(t,i){return e.push([i,t])})),e.sort((function(e,t){return-(e[1].touch-t[1].touch)})).forEach((function(e,t){return e[1].touch=t})),e.slice(0,200)}},{key:"fromJSON",value:function(e){if(this._trie.clear(),e.length>0){this._seq=e[0][1].touch+1;var t,i=(0,s.Z)(e);try{for(i.s();!(t=i.n()).done;){var n=(0,o.Z)(t.value,2),r=n[0],a=n[1];a.type="number"===typeof a.type?a.type:_.gX.fromString(a.type),this._trie.set(r,a)}}catch(l){i.e(l)}finally{i.f()}}}}]),i}(w),L=n=function(){function e(t,i){var n=this;(0,c.Z)(this,e),this._storageService=t,this._configService=i,this._disposables=new g.SL,this._persistSoon=new h.pY((function(){return n._saveState()}),500),this._disposables.add(t.onWillSaveState((function(e){e.reason===b.fk.SHUTDOWN&&n._saveState()})))}return(0,u.Z)(e,[{key:"dispose",value:function(){this._disposables.dispose(),this._persistSoon.dispose()}},{key:"memorize",value:function(e,t,i){this._withStrategy(e,t).memorize(e,t,i),this._persistSoon.schedule()}},{key:"select",value:function(e,t,i){return this._withStrategy(e,t).select(e,t,i)}},{key:"_withStrategy",value:function(e,t){var i,o=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:e.getLanguageIdAtPosition(t.lineNumber,t.column),resource:e.uri});if((null===(i=this._strategy)||void 0===i?void 0:i.name)!==o){this._saveState();var s=n._strategyCtors.get(o)||C;this._strategy=new s;try{var r=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,a=this._storageService.get("".concat(n._storagePrefix,"/").concat(o),r);a&&this._strategy.fromJSON(JSON.parse(a))}catch(l){}}return this._strategy}},{key:"_saveState",value:function(){if(this._strategy){var e=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,t=JSON.stringify(this._strategy);this._storageService.store("".concat(n._storagePrefix,"/").concat(this._strategy.name),t,e,1)}}}]),e}();L._strategyCtors=new Map([["recentlyUsedByPrefix",D],["recentlyUsed",x],["first",C]]),L._storagePrefix="suggest/memories",L=n=S([k(0,b.Uy),k(1,m.Ui)],L);var N=(0,y.yh)("ISuggestMemories");(0,v.z)(N,L,1)},53459:function(e,t,i){i.d(t,{K:function(){return f}});var n=i(74165),o=i(37762),s=i(60136),r=i(27277),a=i(29439),l=i(15671),d=i(43144),c=i(38102),u=i(17429),h=i(99344),g=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))},f=function(){function e(){(0,l.Z)(this,e)}return(0,d.Z)(e,null,[{key:"create",value:function(t,i){return g(this,void 0,void 0,(0,n.Z)().mark((function g(){var f,p,_,m,v,y,b;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i.getOption(117).localityBonus){n.next=2;break}return n.abrupt("return",e.None);case 2:if(i.hasModel()){n.next=4;break}return n.abrupt("return",e.None);case 4:if(f=i.getModel(),p=i.getPosition(),t.canComputeWordRanges(f.uri)){n.next=8;break}return n.abrupt("return",e.None);case 8:return n.next=10,(new h.x).provideSelectionRanges(f,[p]);case 10:if(_=n.sent,m=(0,a.Z)(_,1),0!==(v=m[0]).length){n.next=15;break}return n.abrupt("return",e.None);case 15:return n.next=17,t.computeWordRanges(f.uri,v[0].range);case 17:if(y=n.sent){n.next=20;break}return n.abrupt("return",e.None);case 20:return b=f.getWordUntilPosition(p),delete y[b.word],n.abrupt("return",new(function(e){(0,s.Z)(n,e);var t=(0,r.Z)(n);function n(){return(0,l.Z)(this,n),t.apply(this,arguments)}return(0,d.Z)(n,[{key:"distance",value:function(e,t){if(!p.equals(i.getPosition()))return 0;if(17===t.kind)return 2<<20;var n="string"===typeof t.label?t.label:t.label.label,s=y[n];if((0,c.XY)(s))return 2<<20;var r,a=(0,c.ry)(s,u.e.fromPositions(e),u.e.compareRangesUsingStarts),l=a>=0?s[a]:s[Math.max(0,~a-1)],d=v.length,h=(0,o.Z)(v);try{for(h.s();!(r=h.n()).done;){var g=r.value;if(!u.e.containsRange(g.range,l))break;d-=1}}catch(f){h.e(f)}finally{h.f()}return d}}]),n}(e)));case 23:case"end":return n.stop()}}),g)})))}}]),e}();f.None=new(function(e){(0,s.Z)(i,e);var t=(0,r.Z)(i);function i(){return(0,l.Z)(this,i),t.apply(this,arguments)}return(0,d.Z)(i,[{key:"distance",value:function(){return 0}}]),i}(f))},24988:function(e,t,i){var n=i(18420),o=i(43980);(0,o.P6G)("symbolIcon.arrayForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.booleanForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},(0,n.NC)("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.colorForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.constantForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},(0,n.NC)("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},(0,n.NC)("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,n.NC)("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},(0,n.NC)("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,n.NC)("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.fileForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.folderForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},(0,n.NC)("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,n.NC)("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.keyForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.keywordForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},(0,n.NC)("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.moduleForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.namespaceForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.nullForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.numberForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.objectForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.operatorForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.packageForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.propertyForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.referenceForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.snippetForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.stringForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.structForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.textForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.typeParameterForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.unitForeground",{dark:o.dRz,light:o.dRz,hcDark:o.dRz,hcLight:o.dRz},(0,n.NC)("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget.")),(0,o.P6G)("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},(0,n.NC)("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."))}}]);
//# sourceMappingURL=monaco-editor-vendor.77eea609.83f6a39e.js.map