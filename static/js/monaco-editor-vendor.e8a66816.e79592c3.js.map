{"version":3,"file":"static/js/monaco-editor-vendor.e8a66816.e79592c3.js","mappings":"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","sources":["../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/commandsQuickAccess.js","../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/editorNavigationQuickAccess.js","../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/gotoLineQuickAccess.js","../node_modules/monaco-editor/esm/vs/editor/contrib/quickAccess/browser/gotoSymbolQuickAccess.js","../node_modules/monaco-editor/esm/vs/editor/contrib/readOnlyMessage/browser/contribution.js","../node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/renameInputField.js","../node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/rename.js","../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/bracketSelections.js","../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/wordSelections.js","../node_modules/monaco-editor/esm/vs/editor/contrib/smartSelect/browser/smartSelect.js","../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetController2.js","../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetParser.js","../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetVariables.js","../node_modules/monaco-editor/esm/vs/editor/contrib/snippet/browser/snippetSession.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { stripIcons } from '../../../../base/common/iconLabels.js';\nimport { AbstractCommandsQuickAccessProvider } from '../../../../platform/quickinput/browser/commandsQuickAccess.js';\nexport class AbstractEditorCommandsQuickAccessProvider extends AbstractCommandsQuickAccessProvider {\n    constructor(options, instantiationService, keybindingService, commandService, telemetryService, dialogService) {\n        super(options, instantiationService, keybindingService, commandService, telemetryService, dialogService);\n    }\n    getCodeEditorCommandPicks() {\n        const activeTextEditorControl = this.activeTextEditorControl;\n        if (!activeTextEditorControl) {\n            return [];\n        }\n        const editorCommandPicks = [];\n        for (const editorAction of activeTextEditorControl.getSupportedActions()) {\n            editorCommandPicks.push({\n                commandId: editorAction.id,\n                commandAlias: editorAction.alias,\n                label: stripIcons(editorAction.label) || editorAction.id,\n            });\n        }\n        return editorCommandPicks;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { once } from '../../../../base/common/functional.js';\nimport { DisposableStore, MutableDisposable, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { withNullAsUndefined } from '../../../../base/common/types.js';\nimport { getCodeEditor, isDiffEditor } from '../../../browser/editorBrowser.js';\nimport { OverviewRulerLane } from '../../../common/model.js';\nimport { overviewRulerRangeHighlight } from '../../../common/core/editorColorRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\n/**\n * A reusable quick access provider for the editor with support\n * for adding decorations for navigating in the currently active file\n * (for example \"Go to line\", \"Go to symbol\").\n */\nexport class AbstractEditorNavigationQuickAccessProvider {\n    constructor(options) {\n        this.options = options;\n        //#endregion\n        //#region Decorations Utils\n        this.rangeHighlightDecorationId = undefined;\n    }\n    //#region Provider methods\n    provide(picker, token) {\n        var _a;\n        const disposables = new DisposableStore();\n        // Apply options if any\n        picker.canAcceptInBackground = !!((_a = this.options) === null || _a === void 0 ? void 0 : _a.canAcceptInBackground);\n        // Disable filtering & sorting, we control the results\n        picker.matchOnLabel = picker.matchOnDescription = picker.matchOnDetail = picker.sortByLabel = false;\n        // Provide based on current active editor\n        const pickerDisposable = disposables.add(new MutableDisposable());\n        pickerDisposable.value = this.doProvide(picker, token);\n        // Re-create whenever the active editor changes\n        disposables.add(this.onDidActiveTextEditorControlChange(() => {\n            // Clear old\n            pickerDisposable.value = undefined;\n            // Add new\n            pickerDisposable.value = this.doProvide(picker, token);\n        }));\n        return disposables;\n    }\n    doProvide(picker, token) {\n        const disposables = new DisposableStore();\n        // With text control\n        const editor = this.activeTextEditorControl;\n        if (editor && this.canProvideWithTextEditor(editor)) {\n            const context = { editor };\n            // Restore any view state if this picker was closed\n            // without actually going to a line\n            const codeEditor = getCodeEditor(editor);\n            if (codeEditor) {\n                // Remember view state and update it when the cursor position\n                // changes even later because it could be that the user has\n                // configured quick access to remain open when focus is lost and\n                // we always want to restore the current location.\n                let lastKnownEditorViewState = withNullAsUndefined(editor.saveViewState());\n                disposables.add(codeEditor.onDidChangeCursorPosition(() => {\n                    lastKnownEditorViewState = withNullAsUndefined(editor.saveViewState());\n                }));\n                context.restoreViewState = () => {\n                    if (lastKnownEditorViewState && editor === this.activeTextEditorControl) {\n                        editor.restoreViewState(lastKnownEditorViewState);\n                    }\n                };\n                disposables.add(once(token.onCancellationRequested)(() => { var _a; return (_a = context.restoreViewState) === null || _a === void 0 ? void 0 : _a.call(context); }));\n            }\n            // Clean up decorations on dispose\n            disposables.add(toDisposable(() => this.clearDecorations(editor)));\n            // Ask subclass for entries\n            disposables.add(this.provideWithTextEditor(context, picker, token));\n        }\n        // Without text control\n        else {\n            disposables.add(this.provideWithoutTextEditor(picker, token));\n        }\n        return disposables;\n    }\n    /**\n     * Subclasses to implement if they can operate on the text editor.\n     */\n    canProvideWithTextEditor(editor) {\n        return true;\n    }\n    gotoLocation({ editor }, options) {\n        editor.setSelection(options.range);\n        editor.revealRangeInCenter(options.range, 0 /* ScrollType.Smooth */);\n        if (!options.preserveFocus) {\n            editor.focus();\n        }\n    }\n    getModel(editor) {\n        var _a;\n        return isDiffEditor(editor) ?\n            (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.modified :\n            editor.getModel();\n    }\n    addDecorations(editor, range) {\n        editor.changeDecorations(changeAccessor => {\n            // Reset old decorations if any\n            const deleteDecorations = [];\n            if (this.rangeHighlightDecorationId) {\n                deleteDecorations.push(this.rangeHighlightDecorationId.overviewRulerDecorationId);\n                deleteDecorations.push(this.rangeHighlightDecorationId.rangeHighlightId);\n                this.rangeHighlightDecorationId = undefined;\n            }\n            // Add new decorations for the range\n            const newDecorations = [\n                // highlight the entire line on the range\n                {\n                    range,\n                    options: {\n                        description: 'quick-access-range-highlight',\n                        className: 'rangeHighlight',\n                        isWholeLine: true\n                    }\n                },\n                // also add overview ruler highlight\n                {\n                    range,\n                    options: {\n                        description: 'quick-access-range-highlight-overview',\n                        overviewRuler: {\n                            color: themeColorFromId(overviewRulerRangeHighlight),\n                            position: OverviewRulerLane.Full\n                        }\n                    }\n                }\n            ];\n            const [rangeHighlightId, overviewRulerDecorationId] = changeAccessor.deltaDecorations(deleteDecorations, newDecorations);\n            this.rangeHighlightDecorationId = { rangeHighlightId, overviewRulerDecorationId };\n        });\n    }\n    clearDecorations(editor) {\n        const rangeHighlightDecorationId = this.rangeHighlightDecorationId;\n        if (rangeHighlightDecorationId) {\n            editor.changeDecorations(changeAccessor => {\n                changeAccessor.deltaDecorations([\n                    rangeHighlightDecorationId.overviewRulerDecorationId,\n                    rangeHighlightDecorationId.rangeHighlightId\n                ], []);\n            });\n            this.rangeHighlightDecorationId = undefined;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { getCodeEditor } from '../../../browser/editorBrowser.js';\nimport { AbstractEditorNavigationQuickAccessProvider } from './editorNavigationQuickAccess.js';\nimport { localize } from '../../../../nls.js';\nexport class AbstractGotoLineQuickAccessProvider extends AbstractEditorNavigationQuickAccessProvider {\n    constructor() {\n        super({ canAcceptInBackground: true });\n    }\n    provideWithoutTextEditor(picker) {\n        const label = localize('cannotRunGotoLine', \"Open a text editor first to go to a line.\");\n        picker.items = [{ label }];\n        picker.ariaLabel = label;\n        return Disposable.None;\n    }\n    provideWithTextEditor(context, picker, token) {\n        const editor = context.editor;\n        const disposables = new DisposableStore();\n        // Goto line once picked\n        disposables.add(picker.onDidAccept(event => {\n            const [item] = picker.selectedItems;\n            if (item) {\n                if (!this.isValidLineNumber(editor, item.lineNumber)) {\n                    return;\n                }\n                this.gotoLocation(context, { range: this.toRange(item.lineNumber, item.column), keyMods: picker.keyMods, preserveFocus: event.inBackground });\n                if (!event.inBackground) {\n                    picker.hide();\n                }\n            }\n        }));\n        // React to picker changes\n        const updatePickerAndEditor = () => {\n            const position = this.parsePosition(editor, picker.value.trim().substr(AbstractGotoLineQuickAccessProvider.PREFIX.length));\n            const label = this.getPickLabel(editor, position.lineNumber, position.column);\n            // Picker\n            picker.items = [{\n                    lineNumber: position.lineNumber,\n                    column: position.column,\n                    label\n                }];\n            // ARIA Label\n            picker.ariaLabel = label;\n            // Clear decorations for invalid range\n            if (!this.isValidLineNumber(editor, position.lineNumber)) {\n                this.clearDecorations(editor);\n                return;\n            }\n            // Reveal\n            const range = this.toRange(position.lineNumber, position.column);\n            editor.revealRangeInCenter(range, 0 /* ScrollType.Smooth */);\n            // Decorate\n            this.addDecorations(editor, range);\n        };\n        updatePickerAndEditor();\n        disposables.add(picker.onDidChangeValue(() => updatePickerAndEditor()));\n        // Adjust line number visibility as needed\n        const codeEditor = getCodeEditor(editor);\n        if (codeEditor) {\n            const options = codeEditor.getOptions();\n            const lineNumbers = options.get(62 /* EditorOption.lineNumbers */);\n            if (lineNumbers.renderType === 2 /* RenderLineNumbersType.Relative */) {\n                codeEditor.updateOptions({ lineNumbers: 'on' });\n                disposables.add(toDisposable(() => codeEditor.updateOptions({ lineNumbers: 'relative' })));\n            }\n        }\n        return disposables;\n    }\n    toRange(lineNumber = 1, column = 1) {\n        return {\n            startLineNumber: lineNumber,\n            startColumn: column,\n            endLineNumber: lineNumber,\n            endColumn: column\n        };\n    }\n    parsePosition(editor, value) {\n        // Support line-col formats of `line,col`, `line:col`, `line#col`\n        const numbers = value.split(/,|:|#/).map(part => parseInt(part, 10)).filter(part => !isNaN(part));\n        const endLine = this.lineCount(editor) + 1;\n        return {\n            lineNumber: numbers[0] > 0 ? numbers[0] : endLine + numbers[0],\n            column: numbers[1]\n        };\n    }\n    getPickLabel(editor, lineNumber, column) {\n        // Location valid: indicate this as picker label\n        if (this.isValidLineNumber(editor, lineNumber)) {\n            if (this.isValidColumn(editor, lineNumber, column)) {\n                return localize('gotoLineColumnLabel', \"Go to line {0} and character {1}.\", lineNumber, column);\n            }\n            return localize('gotoLineLabel', \"Go to line {0}.\", lineNumber);\n        }\n        // Location invalid: show generic label\n        const position = editor.getPosition() || { lineNumber: 1, column: 1 };\n        const lineCount = this.lineCount(editor);\n        if (lineCount > 1) {\n            return localize('gotoLineLabelEmptyWithLimit', \"Current Line: {0}, Character: {1}. Type a line number between 1 and {2} to navigate to.\", position.lineNumber, position.column, lineCount);\n        }\n        return localize('gotoLineLabelEmpty', \"Current Line: {0}, Character: {1}. Type a line number to navigate to.\", position.lineNumber, position.column);\n    }\n    isValidLineNumber(editor, lineNumber) {\n        if (!lineNumber || typeof lineNumber !== 'number') {\n            return false;\n        }\n        return lineNumber > 0 && lineNumber <= this.lineCount(editor);\n    }\n    isValidColumn(editor, lineNumber, column) {\n        if (!column || typeof column !== 'number') {\n            return false;\n        }\n        const model = this.getModel(editor);\n        if (!model) {\n            return false;\n        }\n        const positionCandidate = { lineNumber, column };\n        return model.validatePosition(positionCandidate).equals(positionCandidate);\n    }\n    lineCount(editor) {\n        var _a, _b;\n        return (_b = (_a = this.getModel(editor)) === null || _a === void 0 ? void 0 : _a.getLineCount()) !== null && _b !== void 0 ? _b : 0;\n    }\n}\nAbstractGotoLineQuickAccessProvider.PREFIX = ':';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { DeferredPromise } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { pieceToQuery, prepareQuery, scoreFuzzy2 } from '../../../../base/common/fuzzyScorer.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { format, trim } from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { SymbolKinds } from '../../../common/languages.js';\nimport { IOutlineModelService } from '../../documentSymbols/browser/outlineModel.js';\nimport { AbstractEditorNavigationQuickAccessProvider } from './editorNavigationQuickAccess.js';\nimport { localize } from '../../../../nls.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { findLast } from '../../../../base/common/arrays.js';\nlet AbstractGotoSymbolQuickAccessProvider = class AbstractGotoSymbolQuickAccessProvider extends AbstractEditorNavigationQuickAccessProvider {\n    constructor(_languageFeaturesService, _outlineModelService, options = Object.create(null)) {\n        super(options);\n        this._languageFeaturesService = _languageFeaturesService;\n        this._outlineModelService = _outlineModelService;\n        this.options = options;\n        this.options.canAcceptInBackground = true;\n    }\n    provideWithoutTextEditor(picker) {\n        this.provideLabelPick(picker, localize('cannotRunGotoSymbolWithoutEditor', \"To go to a symbol, first open a text editor with symbol information.\"));\n        return Disposable.None;\n    }\n    provideWithTextEditor(context, picker, token) {\n        const editor = context.editor;\n        const model = this.getModel(editor);\n        if (!model) {\n            return Disposable.None;\n        }\n        // Provide symbols from model if available in registry\n        if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n            return this.doProvideWithEditorSymbols(context, model, picker, token);\n        }\n        // Otherwise show an entry for a model without registry\n        // But give a chance to resolve the symbols at a later\n        // point if possible\n        return this.doProvideWithoutEditorSymbols(context, model, picker, token);\n    }\n    doProvideWithoutEditorSymbols(context, model, picker, token) {\n        const disposables = new DisposableStore();\n        // Generic pick for not having any symbol information\n        this.provideLabelPick(picker, localize('cannotRunGotoSymbolWithoutSymbolProvider', \"The active text editor does not provide symbol information.\"));\n        // Wait for changes to the registry and see if eventually\n        // we do get symbols. This can happen if the picker is opened\n        // very early after the model has loaded but before the\n        // language registry is ready.\n        // https://github.com/microsoft/vscode/issues/70607\n        (() => __awaiter(this, void 0, void 0, function* () {\n            const result = yield this.waitForLanguageSymbolRegistry(model, disposables);\n            if (!result || token.isCancellationRequested) {\n                return;\n            }\n            disposables.add(this.doProvideWithEditorSymbols(context, model, picker, token));\n        }))();\n        return disposables;\n    }\n    provideLabelPick(picker, label) {\n        picker.items = [{ label, index: 0, kind: 14 /* SymbolKind.String */ }];\n        picker.ariaLabel = label;\n    }\n    waitForLanguageSymbolRegistry(model, disposables) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n                return true;\n            }\n            const symbolProviderRegistryPromise = new DeferredPromise();\n            // Resolve promise when registry knows model\n            const symbolProviderListener = disposables.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(() => {\n                if (this._languageFeaturesService.documentSymbolProvider.has(model)) {\n                    symbolProviderListener.dispose();\n                    symbolProviderRegistryPromise.complete(true);\n                }\n            }));\n            // Resolve promise when we get disposed too\n            disposables.add(toDisposable(() => symbolProviderRegistryPromise.complete(false)));\n            return symbolProviderRegistryPromise.p;\n        });\n    }\n    doProvideWithEditorSymbols(context, model, picker, token) {\n        var _a;\n        const editor = context.editor;\n        const disposables = new DisposableStore();\n        // Goto symbol once picked\n        disposables.add(picker.onDidAccept(event => {\n            const [item] = picker.selectedItems;\n            if (item && item.range) {\n                this.gotoLocation(context, { range: item.range.selection, keyMods: picker.keyMods, preserveFocus: event.inBackground });\n                if (!event.inBackground) {\n                    picker.hide();\n                }\n            }\n        }));\n        // Goto symbol side by side if enabled\n        disposables.add(picker.onDidTriggerItemButton(({ item }) => {\n            if (item && item.range) {\n                this.gotoLocation(context, { range: item.range.selection, keyMods: picker.keyMods, forceSideBySide: true });\n                picker.hide();\n            }\n        }));\n        // Resolve symbols from document once and reuse this\n        // request for all filtering and typing then on\n        const symbolsPromise = this.getDocumentSymbols(model, token);\n        // Set initial picks and update on type\n        let picksCts = undefined;\n        const updatePickerItems = (positionToEnclose) => __awaiter(this, void 0, void 0, function* () {\n            // Cancel any previous ask for picks and busy\n            picksCts === null || picksCts === void 0 ? void 0 : picksCts.dispose(true);\n            picker.busy = false;\n            // Create new cancellation source for this run\n            picksCts = new CancellationTokenSource(token);\n            // Collect symbol picks\n            picker.busy = true;\n            try {\n                const query = prepareQuery(picker.value.substr(AbstractGotoSymbolQuickAccessProvider.PREFIX.length).trim());\n                const items = yield this.doGetSymbolPicks(symbolsPromise, query, undefined, picksCts.token);\n                if (token.isCancellationRequested) {\n                    return;\n                }\n                if (items.length > 0) {\n                    picker.items = items;\n                    if (positionToEnclose && query.original.length === 0) {\n                        const candidate = findLast(items, item => Boolean(item.type !== 'separator' && item.range && Range.containsPosition(item.range.decoration, positionToEnclose)));\n                        if (candidate) {\n                            picker.activeItems = [candidate];\n                        }\n                    }\n                }\n                else {\n                    if (query.original.length > 0) {\n                        this.provideLabelPick(picker, localize('noMatchingSymbolResults', \"No matching editor symbols\"));\n                    }\n                    else {\n                        this.provideLabelPick(picker, localize('noSymbolResults', \"No editor symbols\"));\n                    }\n                }\n            }\n            finally {\n                if (!token.isCancellationRequested) {\n                    picker.busy = false;\n                }\n            }\n        });\n        disposables.add(picker.onDidChangeValue(() => updatePickerItems(undefined)));\n        updatePickerItems((_a = editor.getSelection()) === null || _a === void 0 ? void 0 : _a.getPosition());\n        // Reveal and decorate when active item changes\n        // However, ignore the very first two events so that\n        // opening the picker is not immediately revealing\n        // and decorating the first entry.\n        let ignoreFirstActiveEvent = 2;\n        disposables.add(picker.onDidChangeActive(() => {\n            const [item] = picker.activeItems;\n            if (item && item.range) {\n                if (ignoreFirstActiveEvent-- > 0) {\n                    return;\n                }\n                // Reveal\n                editor.revealRangeInCenter(item.range.selection, 0 /* ScrollType.Smooth */);\n                // Decorate\n                this.addDecorations(editor, item.range.decoration);\n            }\n        }));\n        return disposables;\n    }\n    doGetSymbolPicks(symbolsPromise, query, options, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const symbols = yield symbolsPromise;\n            if (token.isCancellationRequested) {\n                return [];\n            }\n            const filterBySymbolKind = query.original.indexOf(AbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX) === 0;\n            const filterPos = filterBySymbolKind ? 1 : 0;\n            // Split between symbol and container query\n            let symbolQuery;\n            let containerQuery;\n            if (query.values && query.values.length > 1) {\n                symbolQuery = pieceToQuery(query.values[0]); // symbol: only match on first part\n                containerQuery = pieceToQuery(query.values.slice(1)); // container: match on all but first parts\n            }\n            else {\n                symbolQuery = query;\n            }\n            // Convert to symbol picks and apply filtering\n            const filteredSymbolPicks = [];\n            for (let index = 0; index < symbols.length; index++) {\n                const symbol = symbols[index];\n                const symbolLabel = trim(symbol.name);\n                const symbolLabelWithIcon = `$(${SymbolKinds.toIcon(symbol.kind).id}) ${symbolLabel}`;\n                const symbolLabelIconOffset = symbolLabelWithIcon.length - symbolLabel.length;\n                let containerLabel = symbol.containerName;\n                if (options === null || options === void 0 ? void 0 : options.extraContainerLabel) {\n                    if (containerLabel) {\n                        containerLabel = `${options.extraContainerLabel} • ${containerLabel}`;\n                    }\n                    else {\n                        containerLabel = options.extraContainerLabel;\n                    }\n                }\n                let symbolScore = undefined;\n                let symbolMatches = undefined;\n                let containerScore = undefined;\n                let containerMatches = undefined;\n                if (query.original.length > filterPos) {\n                    // First: try to score on the entire query, it is possible that\n                    // the symbol matches perfectly (e.g. searching for \"change log\"\n                    // can be a match on a markdown symbol \"change log\"). In that\n                    // case we want to skip the container query altogether.\n                    let skipContainerQuery = false;\n                    if (symbolQuery !== query) {\n                        [symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, Object.assign(Object.assign({}, query), { values: undefined /* disable multi-query support */ }), filterPos, symbolLabelIconOffset);\n                        if (typeof symbolScore === 'number') {\n                            skipContainerQuery = true; // since we consumed the query, skip any container matching\n                        }\n                    }\n                    // Otherwise: score on the symbol query and match on the container later\n                    if (typeof symbolScore !== 'number') {\n                        [symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, symbolQuery, filterPos, symbolLabelIconOffset);\n                        if (typeof symbolScore !== 'number') {\n                            continue;\n                        }\n                    }\n                    // Score by container if specified\n                    if (!skipContainerQuery && containerQuery) {\n                        if (containerLabel && containerQuery.original.length > 0) {\n                            [containerScore, containerMatches] = scoreFuzzy2(containerLabel, containerQuery);\n                        }\n                        if (typeof containerScore !== 'number') {\n                            continue;\n                        }\n                        if (typeof symbolScore === 'number') {\n                            symbolScore += containerScore; // boost symbolScore by containerScore\n                        }\n                    }\n                }\n                const deprecated = symbol.tags && symbol.tags.indexOf(1 /* SymbolTag.Deprecated */) >= 0;\n                filteredSymbolPicks.push({\n                    index,\n                    kind: symbol.kind,\n                    score: symbolScore,\n                    label: symbolLabelWithIcon,\n                    ariaLabel: symbolLabel,\n                    description: containerLabel,\n                    highlights: deprecated ? undefined : {\n                        label: symbolMatches,\n                        description: containerMatches\n                    },\n                    range: {\n                        selection: Range.collapseToStart(symbol.selectionRange),\n                        decoration: symbol.range\n                    },\n                    strikethrough: deprecated,\n                    buttons: (() => {\n                        var _a, _b;\n                        const openSideBySideDirection = ((_a = this.options) === null || _a === void 0 ? void 0 : _a.openSideBySideDirection) ? (_b = this.options) === null || _b === void 0 ? void 0 : _b.openSideBySideDirection() : undefined;\n                        if (!openSideBySideDirection) {\n                            return undefined;\n                        }\n                        return [\n                            {\n                                iconClass: openSideBySideDirection === 'right' ? Codicon.splitHorizontal.classNames : Codicon.splitVertical.classNames,\n                                tooltip: openSideBySideDirection === 'right' ? localize('openToSide', \"Open to the Side\") : localize('openToBottom', \"Open to the Bottom\")\n                            }\n                        ];\n                    })()\n                });\n            }\n            // Sort by score\n            const sortedFilteredSymbolPicks = filteredSymbolPicks.sort((symbolA, symbolB) => filterBySymbolKind ?\n                this.compareByKindAndScore(symbolA, symbolB) :\n                this.compareByScore(symbolA, symbolB));\n            // Add separator for types\n            // - @  only total number of symbols\n            // - @: grouped by symbol kind\n            let symbolPicks = [];\n            if (filterBySymbolKind) {\n                let lastSymbolKind = undefined;\n                let lastSeparator = undefined;\n                let lastSymbolKindCounter = 0;\n                function updateLastSeparatorLabel() {\n                    if (lastSeparator && typeof lastSymbolKind === 'number' && lastSymbolKindCounter > 0) {\n                        lastSeparator.label = format(NLS_SYMBOL_KIND_CACHE[lastSymbolKind] || FALLBACK_NLS_SYMBOL_KIND, lastSymbolKindCounter);\n                    }\n                }\n                for (const symbolPick of sortedFilteredSymbolPicks) {\n                    // Found new kind\n                    if (lastSymbolKind !== symbolPick.kind) {\n                        // Update last separator with number of symbols we found for kind\n                        updateLastSeparatorLabel();\n                        lastSymbolKind = symbolPick.kind;\n                        lastSymbolKindCounter = 1;\n                        // Add new separator for new kind\n                        lastSeparator = { type: 'separator' };\n                        symbolPicks.push(lastSeparator);\n                    }\n                    // Existing kind, keep counting\n                    else {\n                        lastSymbolKindCounter++;\n                    }\n                    // Add to final result\n                    symbolPicks.push(symbolPick);\n                }\n                // Update last separator with number of symbols we found for kind\n                updateLastSeparatorLabel();\n            }\n            else if (sortedFilteredSymbolPicks.length > 0) {\n                symbolPicks = [\n                    { label: localize('symbols', \"symbols ({0})\", filteredSymbolPicks.length), type: 'separator' },\n                    ...sortedFilteredSymbolPicks\n                ];\n            }\n            return symbolPicks;\n        });\n    }\n    compareByScore(symbolA, symbolB) {\n        if (typeof symbolA.score !== 'number' && typeof symbolB.score === 'number') {\n            return 1;\n        }\n        else if (typeof symbolA.score === 'number' && typeof symbolB.score !== 'number') {\n            return -1;\n        }\n        if (typeof symbolA.score === 'number' && typeof symbolB.score === 'number') {\n            if (symbolA.score > symbolB.score) {\n                return -1;\n            }\n            else if (symbolA.score < symbolB.score) {\n                return 1;\n            }\n        }\n        if (symbolA.index < symbolB.index) {\n            return -1;\n        }\n        else if (symbolA.index > symbolB.index) {\n            return 1;\n        }\n        return 0;\n    }\n    compareByKindAndScore(symbolA, symbolB) {\n        const kindA = NLS_SYMBOL_KIND_CACHE[symbolA.kind] || FALLBACK_NLS_SYMBOL_KIND;\n        const kindB = NLS_SYMBOL_KIND_CACHE[symbolB.kind] || FALLBACK_NLS_SYMBOL_KIND;\n        // Sort by type first if scoped search\n        const result = kindA.localeCompare(kindB);\n        if (result === 0) {\n            return this.compareByScore(symbolA, symbolB);\n        }\n        return result;\n    }\n    getDocumentSymbols(document, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const model = yield this._outlineModelService.getOrCreate(document, token);\n            return token.isCancellationRequested ? [] : model.asListOfDocumentSymbols();\n        });\n    }\n};\nAbstractGotoSymbolQuickAccessProvider.PREFIX = '@';\nAbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX = ':';\nAbstractGotoSymbolQuickAccessProvider.PREFIX_BY_CATEGORY = `${AbstractGotoSymbolQuickAccessProvider.PREFIX}${AbstractGotoSymbolQuickAccessProvider.SCOPE_PREFIX}`;\nAbstractGotoSymbolQuickAccessProvider = __decorate([\n    __param(0, ILanguageFeaturesService),\n    __param(1, IOutlineModelService)\n], AbstractGotoSymbolQuickAccessProvider);\nexport { AbstractGotoSymbolQuickAccessProvider };\n// #region NLS Helpers\nconst FALLBACK_NLS_SYMBOL_KIND = localize('property', \"properties ({0})\");\nconst NLS_SYMBOL_KIND_CACHE = {\n    [5 /* SymbolKind.Method */]: localize('method', \"methods ({0})\"),\n    [11 /* SymbolKind.Function */]: localize('function', \"functions ({0})\"),\n    [8 /* SymbolKind.Constructor */]: localize('_constructor', \"constructors ({0})\"),\n    [12 /* SymbolKind.Variable */]: localize('variable', \"variables ({0})\"),\n    [4 /* SymbolKind.Class */]: localize('class', \"classes ({0})\"),\n    [22 /* SymbolKind.Struct */]: localize('struct', \"structs ({0})\"),\n    [23 /* SymbolKind.Event */]: localize('event', \"events ({0})\"),\n    [24 /* SymbolKind.Operator */]: localize('operator', \"operators ({0})\"),\n    [10 /* SymbolKind.Interface */]: localize('interface', \"interfaces ({0})\"),\n    [2 /* SymbolKind.Namespace */]: localize('namespace', \"namespaces ({0})\"),\n    [3 /* SymbolKind.Package */]: localize('package', \"packages ({0})\"),\n    [25 /* SymbolKind.TypeParameter */]: localize('typeParameter', \"type parameters ({0})\"),\n    [1 /* SymbolKind.Module */]: localize('modules', \"modules ({0})\"),\n    [6 /* SymbolKind.Property */]: localize('property', \"properties ({0})\"),\n    [9 /* SymbolKind.Enum */]: localize('enum', \"enumerations ({0})\"),\n    [21 /* SymbolKind.EnumMember */]: localize('enumMember', \"enumeration members ({0})\"),\n    [14 /* SymbolKind.String */]: localize('string', \"strings ({0})\"),\n    [0 /* SymbolKind.File */]: localize('file', \"files ({0})\"),\n    [17 /* SymbolKind.Array */]: localize('array', \"arrays ({0})\"),\n    [15 /* SymbolKind.Number */]: localize('number', \"numbers ({0})\"),\n    [16 /* SymbolKind.Boolean */]: localize('boolean', \"booleans ({0})\"),\n    [18 /* SymbolKind.Object */]: localize('object', \"objects ({0})\"),\n    [19 /* SymbolKind.Key */]: localize('key', \"keys ({0})\"),\n    [7 /* SymbolKind.Field */]: localize('field', \"fields ({0})\"),\n    [13 /* SymbolKind.Constant */]: localize('constant', \"constants ({0})\")\n};\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nexport class ReadOnlyMessageController extends Disposable {\n    constructor(editor) {\n        super();\n        this.editor = editor;\n        this._register(this.editor.onDidAttemptReadOnlyEdit(() => this._onDidAttemptReadOnlyEdit()));\n    }\n    _onDidAttemptReadOnlyEdit() {\n        const messageController = MessageController.get(this.editor);\n        if (messageController && this.editor.hasModel()) {\n            if (this.editor.isSimpleWidget) {\n                messageController.showMessage(nls.localize('editor.simple.readonly', \"Cannot edit in read-only input\"), this.editor.getPosition());\n            }\n            else {\n                messageController.showMessage(nls.localize('editor.readonly', \"Cannot edit in read-only editor\"), this.editor.getPosition());\n            }\n        }\n    }\n}\nReadOnlyMessageController.ID = 'editor.contrib.readOnlyMessageController';\nregisterEditorContribution(ReadOnlyMessageController.ID, ReadOnlyMessageController);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport './renameInputField.css';\nimport { Position } from '../../../common/core/position.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { editorWidgetBackground, inputBackground, inputBorder, inputForeground, widgetShadow } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nexport const CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey('renameInputVisible', false, localize('renameInputVisible', \"Whether the rename input widget is visible\"));\nlet RenameInputField = class RenameInputField {\n    constructor(_editor, _acceptKeybindings, _themeService, _keybindingService, contextKeyService) {\n        this._editor = _editor;\n        this._acceptKeybindings = _acceptKeybindings;\n        this._themeService = _themeService;\n        this._keybindingService = _keybindingService;\n        this._disposables = new DisposableStore();\n        this.allowEditorOverflow = true;\n        this._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n        this._editor.addContentWidget(this);\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(46 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._disposables.add(_themeService.onDidColorThemeChange(this._updateStyles, this));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return '__renameInputWidget';\n    }\n    getDomNode() {\n        if (!this._domNode) {\n            this._domNode = document.createElement('div');\n            this._domNode.className = 'monaco-editor rename-box';\n            this._input = document.createElement('input');\n            this._input.className = 'rename-input';\n            this._input.type = 'text';\n            this._input.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\n            this._domNode.appendChild(this._input);\n            this._label = document.createElement('div');\n            this._label.className = 'rename-label';\n            this._domNode.appendChild(this._label);\n            const updateLabel = () => {\n                var _a, _b;\n                const [accept, preview] = this._acceptKeybindings;\n                this._keybindingService.lookupKeybinding(accept);\n                this._label.innerText = localize({ key: 'label', comment: ['placeholders are keybindings, e.g \"F2 to Rename, Shift+F2 to Preview\"'] }, \"{0} to Rename, {1} to Preview\", (_a = this._keybindingService.lookupKeybinding(accept)) === null || _a === void 0 ? void 0 : _a.getLabel(), (_b = this._keybindingService.lookupKeybinding(preview)) === null || _b === void 0 ? void 0 : _b.getLabel());\n            };\n            updateLabel();\n            this._disposables.add(this._keybindingService.onDidUpdateKeybindings(updateLabel));\n            this._updateFont();\n            this._updateStyles(this._themeService.getColorTheme());\n        }\n        return this._domNode;\n    }\n    _updateStyles(theme) {\n        var _a, _b, _c, _d;\n        if (!this._input || !this._domNode) {\n            return;\n        }\n        const widgetShadowColor = theme.getColor(widgetShadow);\n        this._domNode.style.backgroundColor = String((_a = theme.getColor(editorWidgetBackground)) !== null && _a !== void 0 ? _a : '');\n        this._domNode.style.boxShadow = widgetShadowColor ? ` 0 0 8px 2px ${widgetShadowColor}` : '';\n        this._domNode.style.color = String((_b = theme.getColor(inputForeground)) !== null && _b !== void 0 ? _b : '');\n        this._input.style.backgroundColor = String((_c = theme.getColor(inputBackground)) !== null && _c !== void 0 ? _c : '');\n        // this._input.style.color = String(theme.getColor(inputForeground) ?? '');\n        const border = theme.getColor(inputBorder);\n        this._input.style.borderWidth = border ? '1px' : '0px';\n        this._input.style.borderStyle = border ? 'solid' : 'none';\n        this._input.style.borderColor = (_d = border === null || border === void 0 ? void 0 : border.toString()) !== null && _d !== void 0 ? _d : 'none';\n    }\n    _updateFont() {\n        if (!this._input || !this._label) {\n            return;\n        }\n        const fontInfo = this._editor.getOption(46 /* EditorOption.fontInfo */);\n        this._input.style.fontFamily = fontInfo.fontFamily;\n        this._input.style.fontWeight = fontInfo.fontWeight;\n        this._input.style.fontSize = `${fontInfo.fontSize}px`;\n        this._label.style.fontSize = `${fontInfo.fontSize * 0.8}px`;\n    }\n    getPosition() {\n        if (!this._visible) {\n            return null;\n        }\n        return {\n            position: this._position,\n            preference: [2 /* ContentWidgetPositionPreference.BELOW */, 1 /* ContentWidgetPositionPreference.ABOVE */]\n        };\n    }\n    afterRender(position) {\n        if (!position) {\n            // cancel rename when input widget isn't rendered anymore\n            this.cancelInput(true);\n        }\n    }\n    acceptInput(wantsPreview) {\n        var _a;\n        (_a = this._currentAcceptInput) === null || _a === void 0 ? void 0 : _a.call(this, wantsPreview);\n    }\n    cancelInput(focusEditor) {\n        var _a;\n        (_a = this._currentCancelInput) === null || _a === void 0 ? void 0 : _a.call(this, focusEditor);\n    }\n    getInput(where, value, selectionStart, selectionEnd, supportPreview, token) {\n        this._domNode.classList.toggle('preview', supportPreview);\n        this._position = new Position(where.startLineNumber, where.startColumn);\n        this._input.value = value;\n        this._input.setAttribute('selectionStart', selectionStart.toString());\n        this._input.setAttribute('selectionEnd', selectionEnd.toString());\n        this._input.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20);\n        const disposeOnDone = new DisposableStore();\n        return new Promise(resolve => {\n            this._currentCancelInput = (focusEditor) => {\n                this._currentAcceptInput = undefined;\n                this._currentCancelInput = undefined;\n                resolve(focusEditor);\n                return true;\n            };\n            this._currentAcceptInput = (wantsPreview) => {\n                if (this._input.value.trim().length === 0 || this._input.value === value) {\n                    // empty or whitespace only or not changed\n                    this.cancelInput(true);\n                    return;\n                }\n                this._currentAcceptInput = undefined;\n                this._currentCancelInput = undefined;\n                resolve({\n                    newName: this._input.value,\n                    wantsPreview: supportPreview && wantsPreview\n                });\n            };\n            disposeOnDone.add(token.onCancellationRequested(() => this.cancelInput(true)));\n            disposeOnDone.add(this._editor.onDidBlurEditorWidget(() => this.cancelInput(false)));\n            this._show();\n        }).finally(() => {\n            disposeOnDone.dispose();\n            this._hide();\n        });\n    }\n    _show() {\n        this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber, 0 /* ScrollType.Smooth */);\n        this._visible = true;\n        this._visibleContextKey.set(true);\n        this._editor.layoutContentWidget(this);\n        setTimeout(() => {\n            this._input.focus();\n            this._input.setSelectionRange(parseInt(this._input.getAttribute('selectionStart')), parseInt(this._input.getAttribute('selectionEnd')));\n        }, 100);\n    }\n    _hide() {\n        this._visible = false;\n        this._visibleContextKey.reset();\n        this._editor.layoutContentWidget(this);\n    }\n};\nRenameInputField = __decorate([\n    __param(2, IThemeService),\n    __param(3, IKeybindingService),\n    __param(4, IContextKeyService)\n], RenameInputField);\nexport { RenameInputField };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { IdleValue, raceCancellation } from '../../../../base/common/async.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution, registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { IBulkEditService, ResourceEdit } from '../../../browser/services/bulkEditService.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ITextResourceConfigurationService } from '../../../common/services/textResourceConfiguration.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport * as nls from '../../../../nls.js';\nimport { Extensions } from '../../../../platform/configuration/common/configurationRegistry.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { Registry } from '../../../../platform/registry/common/platform.js';\nimport { CONTEXT_RENAME_INPUT_VISIBLE, RenameInputField } from './renameInputField.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nclass RenameSkeleton {\n    constructor(model, position, registry) {\n        this.model = model;\n        this.position = position;\n        this._providerRenameIdx = 0;\n        this._providers = registry.ordered(model);\n    }\n    hasProvider() {\n        return this._providers.length > 0;\n    }\n    resolveRenameLocation(token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const rejects = [];\n            for (this._providerRenameIdx = 0; this._providerRenameIdx < this._providers.length; this._providerRenameIdx++) {\n                const provider = this._providers[this._providerRenameIdx];\n                if (!provider.resolveRenameLocation) {\n                    break;\n                }\n                const res = yield provider.resolveRenameLocation(this.model, this.position, token);\n                if (!res) {\n                    continue;\n                }\n                if (res.rejectReason) {\n                    rejects.push(res.rejectReason);\n                    continue;\n                }\n                return res;\n            }\n            const word = this.model.getWordAtPosition(this.position);\n            if (!word) {\n                return {\n                    range: Range.fromPositions(this.position),\n                    text: '',\n                    rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\n                };\n            }\n            return {\n                range: new Range(this.position.lineNumber, word.startColumn, this.position.lineNumber, word.endColumn),\n                text: word.word,\n                rejectReason: rejects.length > 0 ? rejects.join('\\n') : undefined\n            };\n        });\n    }\n    provideRenameEdits(newName, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return this._provideRenameEdits(newName, this._providerRenameIdx, [], token);\n        });\n    }\n    _provideRenameEdits(newName, i, rejects, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const provider = this._providers[i];\n            if (!provider) {\n                return {\n                    edits: [],\n                    rejectReason: rejects.join('\\n')\n                };\n            }\n            const result = yield provider.provideRenameEdits(this.model, this.position, newName, token);\n            if (!result) {\n                return this._provideRenameEdits(newName, i + 1, rejects.concat(nls.localize('no result', \"No result.\")), token);\n            }\n            else if (result.rejectReason) {\n                return this._provideRenameEdits(newName, i + 1, rejects.concat(result.rejectReason), token);\n            }\n            return result;\n        });\n    }\n}\nexport function rename(registry, model, position, newName) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const skeleton = new RenameSkeleton(model, position, registry);\n        const loc = yield skeleton.resolveRenameLocation(CancellationToken.None);\n        if (loc === null || loc === void 0 ? void 0 : loc.rejectReason) {\n            return { edits: [], rejectReason: loc.rejectReason };\n        }\n        return skeleton.provideRenameEdits(newName, CancellationToken.None);\n    });\n}\n// ---  register actions and commands\nlet RenameController = class RenameController {\n    constructor(editor, _instaService, _notificationService, _bulkEditService, _progressService, _logService, _configService, _languageFeaturesService) {\n        this.editor = editor;\n        this._instaService = _instaService;\n        this._notificationService = _notificationService;\n        this._bulkEditService = _bulkEditService;\n        this._progressService = _progressService;\n        this._logService = _logService;\n        this._configService = _configService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._disposableStore = new DisposableStore();\n        this._cts = new CancellationTokenSource();\n        this._renameInputField = this._disposableStore.add(new IdleValue(() => this._disposableStore.add(this._instaService.createInstance(RenameInputField, this.editor, ['acceptRenameInput', 'acceptRenameInputWithPreview']))));\n    }\n    static get(editor) {\n        return editor.getContribution(RenameController.ID);\n    }\n    dispose() {\n        this._disposableStore.dispose();\n        this._cts.dispose(true);\n    }\n    run() {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            this._cts.dispose(true);\n            if (!this.editor.hasModel()) {\n                return undefined;\n            }\n            const position = this.editor.getPosition();\n            const skeleton = new RenameSkeleton(this.editor.getModel(), position, this._languageFeaturesService.renameProvider);\n            if (!skeleton.hasProvider()) {\n                return undefined;\n            }\n            this._cts = new EditorStateCancellationTokenSource(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */);\n            // resolve rename location\n            let loc;\n            try {\n                const resolveLocationOperation = skeleton.resolveRenameLocation(this._cts.token);\n                this._progressService.showWhile(resolveLocationOperation, 250);\n                loc = yield resolveLocationOperation;\n            }\n            catch (e) {\n                (_a = MessageController.get(this.editor)) === null || _a === void 0 ? void 0 : _a.showMessage(e || nls.localize('resolveRenameLocationFailed', \"An unknown error occurred while resolving rename location\"), position);\n                return undefined;\n            }\n            if (!loc) {\n                return undefined;\n            }\n            if (loc.rejectReason) {\n                (_b = MessageController.get(this.editor)) === null || _b === void 0 ? void 0 : _b.showMessage(loc.rejectReason, position);\n                return undefined;\n            }\n            if (this._cts.token.isCancellationRequested) {\n                return undefined;\n            }\n            this._cts.dispose();\n            this._cts = new EditorStateCancellationTokenSource(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */, loc.range);\n            // do rename at location\n            const selection = this.editor.getSelection();\n            let selectionStart = 0;\n            let selectionEnd = loc.text.length;\n            if (!Range.isEmpty(selection) && !Range.spansMultipleLines(selection) && Range.containsRange(loc.range, selection)) {\n                selectionStart = Math.max(0, selection.startColumn - loc.range.startColumn);\n                selectionEnd = Math.min(loc.range.endColumn, selection.endColumn) - loc.range.startColumn;\n            }\n            const supportPreview = this._bulkEditService.hasPreviewHandler() && this._configService.getValue(this.editor.getModel().uri, 'editor.rename.enablePreview');\n            const inputFieldResult = yield this._renameInputField.value.getInput(loc.range, loc.text, selectionStart, selectionEnd, supportPreview, this._cts.token);\n            // no result, only hint to focus the editor or not\n            if (typeof inputFieldResult === 'boolean') {\n                if (inputFieldResult) {\n                    this.editor.focus();\n                }\n                return undefined;\n            }\n            this.editor.focus();\n            const renameOperation = raceCancellation(skeleton.provideRenameEdits(inputFieldResult.newName, this._cts.token), this._cts.token).then((renameResult) => __awaiter(this, void 0, void 0, function* () {\n                if (!renameResult || !this.editor.hasModel()) {\n                    return;\n                }\n                if (renameResult.rejectReason) {\n                    this._notificationService.info(renameResult.rejectReason);\n                    return;\n                }\n                // collapse selection to active end\n                this.editor.setSelection(Range.fromPositions(this.editor.getSelection().getPosition()));\n                this._bulkEditService.apply(ResourceEdit.convert(renameResult), {\n                    editor: this.editor,\n                    showPreview: inputFieldResult.wantsPreview,\n                    label: nls.localize('label', \"Renaming '{0}' to '{1}'\", loc === null || loc === void 0 ? void 0 : loc.text, inputFieldResult.newName),\n                    code: 'undoredo.rename',\n                    quotableLabel: nls.localize('quotableLabel', \"Renaming {0} to {1}\", loc === null || loc === void 0 ? void 0 : loc.text, inputFieldResult.newName),\n                    respectAutoSaveConfig: true\n                }).then(result => {\n                    if (result.ariaSummary) {\n                        alert(nls.localize('aria', \"Successfully renamed '{0}' to '{1}'. Summary: {2}\", loc.text, inputFieldResult.newName, result.ariaSummary));\n                    }\n                }).catch(err => {\n                    this._notificationService.error(nls.localize('rename.failedApply', \"Rename failed to apply edits\"));\n                    this._logService.error(err);\n                });\n            }), err => {\n                this._notificationService.error(nls.localize('rename.failed', \"Rename failed to compute edits\"));\n                this._logService.error(err);\n            });\n            this._progressService.showWhile(renameOperation, 250);\n            return renameOperation;\n        });\n    }\n    acceptRenameInput(wantsPreview) {\n        this._renameInputField.value.acceptInput(wantsPreview);\n    }\n    cancelRenameInput() {\n        this._renameInputField.value.cancelInput(true);\n    }\n};\nRenameController.ID = 'editor.contrib.renameController';\nRenameController = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, INotificationService),\n    __param(3, IBulkEditService),\n    __param(4, IEditorProgressService),\n    __param(5, ILogService),\n    __param(6, ITextResourceConfigurationService),\n    __param(7, ILanguageFeaturesService)\n], RenameController);\n// ---- action implementation\nexport class RenameAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.rename',\n            label: nls.localize('rename.label', \"Rename Symbol\"),\n            alias: 'Rename Symbol',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 60 /* KeyCode.F2 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.1\n            }\n        });\n    }\n    runCommand(accessor, args) {\n        const editorService = accessor.get(ICodeEditorService);\n        const [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\n        if (URI.isUri(uri) && Position.isIPosition(pos)) {\n            return editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(editor => {\n                if (!editor) {\n                    return;\n                }\n                editor.setPosition(pos);\n                editor.invokeWithinContext(accessor => {\n                    this.reportTelemetry(accessor, editor);\n                    return this.run(accessor, editor);\n                });\n            }, onUnexpectedError);\n        }\n        return super.runCommand(accessor, args);\n    }\n    run(accessor, editor) {\n        const controller = RenameController.get(editor);\n        if (controller) {\n            return controller.run();\n        }\n        return Promise.resolve();\n    }\n}\nregisterEditorContribution(RenameController.ID, RenameController);\nregisterEditorAction(RenameAction);\nconst RenameCommand = EditorCommand.bindToContribution(RenameController.get);\nregisterEditorCommand(new RenameCommand({\n    id: 'acceptRenameInput',\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n    handler: x => x.acceptRenameInput(false),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: EditorContextKeys.focus,\n        primary: 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new RenameCommand({\n    id: 'acceptRenameInputWithPreview',\n    precondition: ContextKeyExpr.and(CONTEXT_RENAME_INPUT_VISIBLE, ContextKeyExpr.has('config.editor.rename.enablePreview')),\n    handler: x => x.acceptRenameInput(true),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: EditorContextKeys.focus,\n        primary: 1024 /* KeyMod.Shift */ + 3 /* KeyCode.Enter */\n    }\n}));\nregisterEditorCommand(new RenameCommand({\n    id: 'cancelRenameInput',\n    precondition: CONTEXT_RENAME_INPUT_VISIBLE,\n    handler: x => x.cancelRenameInput(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 99,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\n// ---- api bridge command\nregisterModelAndPositionCommand('_executeDocumentRenameProvider', function (accessor, model, position, ...args) {\n    const [newName] = args;\n    assertType(typeof newName === 'string');\n    const { renameProvider } = accessor.get(ILanguageFeaturesService);\n    return rename(renameProvider, model, position, newName);\n});\nregisterModelAndPositionCommand('_executePrepareRename', function (accessor, model, position) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const { renameProvider } = accessor.get(ILanguageFeaturesService);\n        const skeleton = new RenameSkeleton(model, position, renameProvider);\n        const loc = yield skeleton.resolveRenameLocation(CancellationToken.None);\n        if (loc === null || loc === void 0 ? void 0 : loc.rejectReason) {\n            throw new Error(loc.rejectReason);\n        }\n        return loc;\n    });\n});\n//todo@jrieken use editor options world\nRegistry.as(Extensions.Configuration).registerConfiguration({\n    id: 'editor',\n    properties: {\n        'editor.rename.enablePreview': {\n            scope: 5 /* ConfigurationScope.LANGUAGE_OVERRIDABLE */,\n            description: nls.localize('enablePreview', \"Enable/disable the ability to preview changes before renaming\"),\n            default: true,\n            type: 'boolean'\n        }\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nexport class BracketSelectionRangeProvider {\n    provideSelectionRanges(model, positions) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const result = [];\n            for (const position of positions) {\n                const bucket = [];\n                result.push(bucket);\n                const ranges = new Map();\n                yield new Promise(resolve => BracketSelectionRangeProvider._bracketsRightYield(resolve, 0, model, position, ranges));\n                yield new Promise(resolve => BracketSelectionRangeProvider._bracketsLeftYield(resolve, 0, model, position, ranges, bucket));\n            }\n            return result;\n        });\n    }\n    static _bracketsRightYield(resolve, round, model, pos, ranges) {\n        const counts = new Map();\n        const t1 = Date.now();\n        while (true) {\n            if (round >= BracketSelectionRangeProvider._maxRounds) {\n                resolve();\n                break;\n            }\n            if (!pos) {\n                resolve();\n                break;\n            }\n            const bracket = model.bracketPairs.findNextBracket(pos);\n            if (!bracket) {\n                resolve();\n                break;\n            }\n            const d = Date.now() - t1;\n            if (d > BracketSelectionRangeProvider._maxDuration) {\n                setTimeout(() => BracketSelectionRangeProvider._bracketsRightYield(resolve, round + 1, model, pos, ranges));\n                break;\n            }\n            if (bracket.bracketInfo.isOpeningBracket) {\n                const key = bracket.bracketInfo.bracketText;\n                // wait for closing\n                const val = counts.has(key) ? counts.get(key) : 0;\n                counts.set(key, val + 1);\n            }\n            else {\n                const key = bracket.bracketInfo.getClosedBrackets()[0].bracketText;\n                // process closing\n                let val = counts.has(key) ? counts.get(key) : 0;\n                val -= 1;\n                counts.set(key, Math.max(0, val));\n                if (val < 0) {\n                    let list = ranges.get(key);\n                    if (!list) {\n                        list = new LinkedList();\n                        ranges.set(key, list);\n                    }\n                    list.push(bracket.range);\n                }\n            }\n            pos = bracket.range.getEndPosition();\n        }\n    }\n    static _bracketsLeftYield(resolve, round, model, pos, ranges, bucket) {\n        const counts = new Map();\n        const t1 = Date.now();\n        while (true) {\n            if (round >= BracketSelectionRangeProvider._maxRounds && ranges.size === 0) {\n                resolve();\n                break;\n            }\n            if (!pos) {\n                resolve();\n                break;\n            }\n            const bracket = model.bracketPairs.findPrevBracket(pos);\n            if (!bracket) {\n                resolve();\n                break;\n            }\n            const d = Date.now() - t1;\n            if (d > BracketSelectionRangeProvider._maxDuration) {\n                setTimeout(() => BracketSelectionRangeProvider._bracketsLeftYield(resolve, round + 1, model, pos, ranges, bucket));\n                break;\n            }\n            if (!bracket.bracketInfo.isOpeningBracket) {\n                const key = bracket.bracketInfo.getClosedBrackets()[0].bracketText;\n                // wait for opening\n                const val = counts.has(key) ? counts.get(key) : 0;\n                counts.set(key, val + 1);\n            }\n            else {\n                const key = bracket.bracketInfo.bracketText;\n                // opening\n                let val = counts.has(key) ? counts.get(key) : 0;\n                val -= 1;\n                counts.set(key, Math.max(0, val));\n                if (val < 0) {\n                    const list = ranges.get(key);\n                    if (list) {\n                        const closing = list.shift();\n                        if (list.size === 0) {\n                            ranges.delete(key);\n                        }\n                        const innerBracket = Range.fromPositions(bracket.range.getEndPosition(), closing.getStartPosition());\n                        const outerBracket = Range.fromPositions(bracket.range.getStartPosition(), closing.getEndPosition());\n                        bucket.push({ range: innerBracket });\n                        bucket.push({ range: outerBracket });\n                        BracketSelectionRangeProvider._addBracketLeading(model, outerBracket, bucket);\n                    }\n                }\n            }\n            pos = bracket.range.getStartPosition();\n        }\n    }\n    static _addBracketLeading(model, bracket, bucket) {\n        if (bracket.startLineNumber === bracket.endLineNumber) {\n            return;\n        }\n        // xxxxxxxx {\n        //\n        // }\n        const startLine = bracket.startLineNumber;\n        const column = model.getLineFirstNonWhitespaceColumn(startLine);\n        if (column !== 0 && column !== bracket.startColumn) {\n            bucket.push({ range: Range.fromPositions(new Position(startLine, column), bracket.getEndPosition()) });\n            bucket.push({ range: Range.fromPositions(new Position(startLine, 1), bracket.getEndPosition()) });\n        }\n        // xxxxxxxx\n        // {\n        //\n        // }\n        const aboveLine = startLine - 1;\n        if (aboveLine > 0) {\n            const column = model.getLineFirstNonWhitespaceColumn(aboveLine);\n            if (column === bracket.startColumn && column !== model.getLineLastNonWhitespaceColumn(aboveLine)) {\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, column), bracket.getEndPosition()) });\n                bucket.push({ range: Range.fromPositions(new Position(aboveLine, 1), bracket.getEndPosition()) });\n            }\n        }\n    }\n}\nBracketSelectionRangeProvider._maxDuration = 30;\nBracketSelectionRangeProvider._maxRounds = 2;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { isLowerAsciiLetter, isUpperAsciiLetter } from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nexport class WordSelectionRangeProvider {\n    provideSelectionRanges(model, positions) {\n        const result = [];\n        for (const position of positions) {\n            const bucket = [];\n            result.push(bucket);\n            this._addInWordRanges(bucket, model, position);\n            this._addWordRanges(bucket, model, position);\n            this._addWhitespaceLine(bucket, model, position);\n            bucket.push({ range: model.getFullModelRange() });\n        }\n        return result;\n    }\n    _addInWordRanges(bucket, model, pos) {\n        const obj = model.getWordAtPosition(pos);\n        if (!obj) {\n            return;\n        }\n        const { word, startColumn } = obj;\n        const offset = pos.column - startColumn;\n        let start = offset;\n        let end = offset;\n        let lastCh = 0;\n        // LEFT anchor (start)\n        for (; start >= 0; start--) {\n            const ch = word.charCodeAt(start);\n            if ((start !== offset) && (ch === 95 /* CharCode.Underline */ || ch === 45 /* CharCode.Dash */)) {\n                // foo-bar OR foo_bar\n                break;\n            }\n            else if (isLowerAsciiLetter(ch) && isUpperAsciiLetter(lastCh)) {\n                // fooBar\n                break;\n            }\n            lastCh = ch;\n        }\n        start += 1;\n        // RIGHT anchor (end)\n        for (; end < word.length; end++) {\n            const ch = word.charCodeAt(end);\n            if (isUpperAsciiLetter(ch) && isLowerAsciiLetter(lastCh)) {\n                // fooBar\n                break;\n            }\n            else if (ch === 95 /* CharCode.Underline */ || ch === 45 /* CharCode.Dash */) {\n                // foo-bar OR foo_bar\n                break;\n            }\n            lastCh = ch;\n        }\n        if (start < end) {\n            bucket.push({ range: new Range(pos.lineNumber, startColumn + start, pos.lineNumber, startColumn + end) });\n        }\n    }\n    _addWordRanges(bucket, model, pos) {\n        const word = model.getWordAtPosition(pos);\n        if (word) {\n            bucket.push({ range: new Range(pos.lineNumber, word.startColumn, pos.lineNumber, word.endColumn) });\n        }\n    }\n    _addWhitespaceLine(bucket, model, pos) {\n        if (model.getLineLength(pos.lineNumber) > 0\n            && model.getLineFirstNonWhitespaceColumn(pos.lineNumber) === 0\n            && model.getLineLastNonWhitespaceColumn(pos.lineNumber) === 0) {\n            bucket.push({ range: new Range(pos.lineNumber, 1, pos.lineNumber, model.getLineMaxColumn(pos.lineNumber)) });\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { BracketSelectionRangeProvider } from './bracketSelections.js';\nimport { WordSelectionRangeProvider } from './wordSelections.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nclass SelectionRanges {\n    constructor(index, ranges) {\n        this.index = index;\n        this.ranges = ranges;\n    }\n    mov(fwd) {\n        const index = this.index + (fwd ? 1 : -1);\n        if (index < 0 || index >= this.ranges.length) {\n            return this;\n        }\n        const res = new SelectionRanges(index, this.ranges);\n        if (res.ranges[index].equalsRange(this.ranges[this.index])) {\n            // next range equals this range, retry with next-next\n            return res.mov(fwd);\n        }\n        return res;\n    }\n}\nlet SmartSelectController = class SmartSelectController {\n    constructor(_editor, _languageFeaturesService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._ignoreSelection = false;\n    }\n    static get(editor) {\n        return editor.getContribution(SmartSelectController.ID);\n    }\n    dispose() {\n        var _a;\n        (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n    }\n    run(forward) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel()) {\n                return;\n            }\n            const selections = this._editor.getSelections();\n            const model = this._editor.getModel();\n            if (!this._state) {\n                yield provideSelectionRanges(this._languageFeaturesService.selectionRangeProvider, model, selections.map(s => s.getPosition()), this._editor.getOption(104 /* EditorOption.smartSelect */), CancellationToken.None).then(ranges => {\n                    var _a;\n                    if (!arrays.isNonEmptyArray(ranges) || ranges.length !== selections.length) {\n                        // invalid result\n                        return;\n                    }\n                    if (!this._editor.hasModel() || !arrays.equals(this._editor.getSelections(), selections, (a, b) => a.equalsSelection(b))) {\n                        // invalid editor state\n                        return;\n                    }\n                    for (let i = 0; i < ranges.length; i++) {\n                        ranges[i] = ranges[i].filter(range => {\n                            // filter ranges inside the selection\n                            return range.containsPosition(selections[i].getStartPosition()) && range.containsPosition(selections[i].getEndPosition());\n                        });\n                        // prepend current selection\n                        ranges[i].unshift(selections[i]);\n                    }\n                    this._state = ranges.map(ranges => new SelectionRanges(0, ranges));\n                    // listen to caret move and forget about state\n                    (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n                    this._selectionListener = this._editor.onDidChangeCursorPosition(() => {\n                        var _a;\n                        if (!this._ignoreSelection) {\n                            (_a = this._selectionListener) === null || _a === void 0 ? void 0 : _a.dispose();\n                            this._state = undefined;\n                        }\n                    });\n                });\n            }\n            if (!this._state) {\n                // no state\n                return;\n            }\n            this._state = this._state.map(state => state.mov(forward));\n            const newSelections = this._state.map(state => Selection.fromPositions(state.ranges[state.index].getStartPosition(), state.ranges[state.index].getEndPosition()));\n            this._ignoreSelection = true;\n            try {\n                this._editor.setSelections(newSelections);\n            }\n            finally {\n                this._ignoreSelection = false;\n            }\n        });\n    }\n};\nSmartSelectController.ID = 'editor.contrib.smartSelectController';\nSmartSelectController = __decorate([\n    __param(1, ILanguageFeaturesService)\n], SmartSelectController);\nclass AbstractSmartSelect extends EditorAction {\n    constructor(forward, opts) {\n        super(opts);\n        this._forward = forward;\n    }\n    run(_accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const controller = SmartSelectController.get(editor);\n            if (controller) {\n                yield controller.run(this._forward);\n            }\n        });\n    }\n}\nclass GrowSelectionAction extends AbstractSmartSelect {\n    constructor() {\n        super(true, {\n            id: 'editor.action.smartSelect.expand',\n            label: nls.localize('smartSelect.expand', \"Expand Selection\"),\n            alias: 'Expand Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */,\n                    secondary: [256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */],\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '1_basic',\n                title: nls.localize({ key: 'miSmartSelectGrow', comment: ['&& denotes a mnemonic'] }, \"&&Expand Selection\"),\n                order: 2\n            }\n        });\n    }\n}\n// renamed command id\nCommandsRegistry.registerCommandAlias('editor.action.smartSelect.grow', 'editor.action.smartSelect.expand');\nclass ShrinkSelectionAction extends AbstractSmartSelect {\n    constructor() {\n        super(false, {\n            id: 'editor.action.smartSelect.shrink',\n            label: nls.localize('smartSelect.shrink', \"Shrink Selection\"),\n            alias: 'Shrink Selection',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */,\n                    secondary: [256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */],\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarSelectionMenu,\n                group: '1_basic',\n                title: nls.localize({ key: 'miSmartSelectShrink', comment: ['&& denotes a mnemonic'] }, \"&&Shrink Selection\"),\n                order: 3\n            }\n        });\n    }\n}\nregisterEditorContribution(SmartSelectController.ID, SmartSelectController);\nregisterEditorAction(GrowSelectionAction);\nregisterEditorAction(ShrinkSelectionAction);\nexport function provideSelectionRanges(registry, model, positions, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = registry.all(model)\n            .concat(new WordSelectionRangeProvider()); // ALWAYS have word based selection range\n        if (providers.length === 1) {\n            // add word selection and bracket selection when no provider exists\n            providers.unshift(new BracketSelectionRangeProvider());\n        }\n        const work = [];\n        const allRawRanges = [];\n        for (const provider of providers) {\n            work.push(Promise.resolve(provider.provideSelectionRanges(model, positions, token)).then(allProviderRanges => {\n                if (arrays.isNonEmptyArray(allProviderRanges) && allProviderRanges.length === positions.length) {\n                    for (let i = 0; i < positions.length; i++) {\n                        if (!allRawRanges[i]) {\n                            allRawRanges[i] = [];\n                        }\n                        for (const oneProviderRanges of allProviderRanges[i]) {\n                            if (Range.isIRange(oneProviderRanges.range) && Range.containsPosition(oneProviderRanges.range, positions[i])) {\n                                allRawRanges[i].push(Range.lift(oneProviderRanges.range));\n                            }\n                        }\n                    }\n                }\n            }, onUnexpectedExternalError));\n        }\n        yield Promise.all(work);\n        return allRawRanges.map(oneRawRanges => {\n            if (oneRawRanges.length === 0) {\n                return [];\n            }\n            // sort all by start/end position\n            oneRawRanges.sort((a, b) => {\n                if (Position.isBefore(a.getStartPosition(), b.getStartPosition())) {\n                    return 1;\n                }\n                else if (Position.isBefore(b.getStartPosition(), a.getStartPosition())) {\n                    return -1;\n                }\n                else if (Position.isBefore(a.getEndPosition(), b.getEndPosition())) {\n                    return -1;\n                }\n                else if (Position.isBefore(b.getEndPosition(), a.getEndPosition())) {\n                    return 1;\n                }\n                else {\n                    return 0;\n                }\n            });\n            // remove ranges that don't contain the former range or that are equal to the\n            // former range\n            const oneRanges = [];\n            let last;\n            for (const range of oneRawRanges) {\n                if (!last || (Range.containsRange(range, last) && !Range.equalsRange(range, last))) {\n                    oneRanges.push(range);\n                    last = range;\n                }\n            }\n            if (!options.selectLeadingAndTrailingWhitespace) {\n                return oneRanges;\n            }\n            // add ranges that expand trivia at line starts and ends whenever a range\n            // wraps onto the a new line\n            const oneRangesWithTrivia = [oneRanges[0]];\n            for (let i = 1; i < oneRanges.length; i++) {\n                const prev = oneRanges[i - 1];\n                const cur = oneRanges[i];\n                if (cur.startLineNumber !== prev.startLineNumber || cur.endLineNumber !== prev.endLineNumber) {\n                    // add line/block range without leading/failing whitespace\n                    const rangeNoWhitespace = new Range(prev.startLineNumber, model.getLineFirstNonWhitespaceColumn(prev.startLineNumber), prev.endLineNumber, model.getLineLastNonWhitespaceColumn(prev.endLineNumber));\n                    if (rangeNoWhitespace.containsRange(prev) && !rangeNoWhitespace.equalsRange(prev) && cur.containsRange(rangeNoWhitespace) && !cur.equalsRange(rangeNoWhitespace)) {\n                        oneRangesWithTrivia.push(rangeNoWhitespace);\n                    }\n                    // add line/block range\n                    const rangeFull = new Range(prev.startLineNumber, 1, prev.endLineNumber, model.getLineMaxColumn(prev.endLineNumber));\n                    if (rangeFull.containsRange(prev) && !rangeFull.equalsRange(rangeNoWhitespace) && cur.containsRange(rangeFull) && !cur.equalsRange(rangeFull)) {\n                        oneRangesWithTrivia.push(rangeFull);\n                    }\n                }\n                oneRangesWithTrivia.push(cur);\n            }\n            return oneRangesWithTrivia;\n        });\n    });\n}\nCommandsRegistry.registerCommand('_executeSelectionRangeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, positions] = args;\n        assertType(URI.isUri(resource));\n        const registry = accessor.get(ILanguageFeaturesService).selectionRangeProvider;\n        const reference = yield accessor.get(ITextModelService).createModelReference(resource);\n        try {\n            return provideSelectionRanges(registry, reference.object.textEditorModel, positions, { selectLeadingAndTrailingWhitespace: true }, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { EditorCommand, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { showSimpleSuggestions } from '../../suggest/browser/suggest.js';\nimport { localize } from '../../../../nls.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { SnippetSession } from './snippetSession.js';\nconst _defaultOptions = {\n    overwriteBefore: 0,\n    overwriteAfter: 0,\n    undoStopBefore: true,\n    undoStopAfter: true,\n    adjustWhitespace: true,\n    clipboardText: undefined,\n    overtypingCapturer: undefined\n};\nlet SnippetController2 = class SnippetController2 {\n    constructor(_editor, _logService, _languageFeaturesService, contextKeyService, _languageConfigurationService) {\n        this._editor = _editor;\n        this._logService = _logService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._snippetListener = new DisposableStore();\n        this._modelVersionId = -1;\n        this._inSnippet = SnippetController2.InSnippetMode.bindTo(contextKeyService);\n        this._hasNextTabstop = SnippetController2.HasNextTabstop.bindTo(contextKeyService);\n        this._hasPrevTabstop = SnippetController2.HasPrevTabstop.bindTo(contextKeyService);\n    }\n    static get(editor) {\n        return editor.getContribution(SnippetController2.ID);\n    }\n    dispose() {\n        var _a;\n        this._inSnippet.reset();\n        this._hasPrevTabstop.reset();\n        this._hasNextTabstop.reset();\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._snippetListener.dispose();\n    }\n    apply(edits, opts) {\n        try {\n            this._doInsert(edits, typeof opts === 'undefined' ? _defaultOptions : Object.assign(Object.assign({}, _defaultOptions), opts));\n        }\n        catch (e) {\n            this.cancel();\n            this._logService.error(e);\n            this._logService.error('snippet_error');\n            this._logService.error('insert_edits=', edits);\n            this._logService.error('existing_template=', this._session ? this._session._logInfo() : '<no_session>');\n        }\n    }\n    insert(template, opts) {\n        // this is here to find out more about the yet-not-understood\n        // error that sometimes happens when we fail to inserted a nested\n        // snippet\n        try {\n            this._doInsert(template, typeof opts === 'undefined' ? _defaultOptions : Object.assign(Object.assign({}, _defaultOptions), opts));\n        }\n        catch (e) {\n            this.cancel();\n            this._logService.error(e);\n            this._logService.error('snippet_error');\n            this._logService.error('insert_template=', template);\n            this._logService.error('existing_template=', this._session ? this._session._logInfo() : '<no_session>');\n        }\n    }\n    _doInsert(template, opts) {\n        var _a;\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // don't listen while inserting the snippet\n        // as that is the inflight state causing cancelation\n        this._snippetListener.clear();\n        if (opts.undoStopBefore) {\n            this._editor.getModel().pushStackElement();\n        }\n        // don't merge\n        if (this._session && typeof template !== 'string') {\n            this.cancel();\n        }\n        if (!this._session) {\n            this._modelVersionId = this._editor.getModel().getAlternativeVersionId();\n            this._session = new SnippetSession(this._editor, template, opts, this._languageConfigurationService);\n            this._session.insert();\n        }\n        else {\n            assertType(typeof template === 'string');\n            this._session.merge(template, opts);\n        }\n        if (opts.undoStopAfter) {\n            this._editor.getModel().pushStackElement();\n        }\n        // regster completion item provider when there is any choice element\n        if ((_a = this._session) === null || _a === void 0 ? void 0 : _a.hasChoice) {\n            this._choiceCompletionItemProvider = {\n                provideCompletionItems: (model, position) => {\n                    if (!this._session || model !== this._editor.getModel() || !Position.equals(this._editor.getPosition(), position)) {\n                        return undefined;\n                    }\n                    const { activeChoice } = this._session;\n                    if (!activeChoice || activeChoice.choice.options.length === 0) {\n                        return undefined;\n                    }\n                    const word = model.getValueInRange(activeChoice.range);\n                    const isAnyOfOptions = Boolean(activeChoice.choice.options.find(o => o.value === word));\n                    const suggestions = [];\n                    for (let i = 0; i < activeChoice.choice.options.length; i++) {\n                        const option = activeChoice.choice.options[i];\n                        suggestions.push({\n                            kind: 13 /* CompletionItemKind.Value */,\n                            label: option.value,\n                            insertText: option.value,\n                            sortText: 'a'.repeat(i + 1),\n                            range: activeChoice.range,\n                            filterText: isAnyOfOptions ? `${word}_${option.value}` : undefined,\n                            command: { id: 'jumpToNextSnippetPlaceholder', title: localize('next', 'Go to next placeholder...') }\n                        });\n                    }\n                    return { suggestions };\n                }\n            };\n            const registration = this._languageFeaturesService.completionProvider.register({\n                language: this._editor.getModel().getLanguageId(),\n                pattern: this._editor.getModel().uri.fsPath,\n                scheme: this._editor.getModel().uri.scheme\n            }, this._choiceCompletionItemProvider);\n            this._snippetListener.add(registration);\n        }\n        this._updateState();\n        this._snippetListener.add(this._editor.onDidChangeModelContent(e => e.isFlush && this.cancel()));\n        this._snippetListener.add(this._editor.onDidChangeModel(() => this.cancel()));\n        this._snippetListener.add(this._editor.onDidChangeCursorSelection(() => this._updateState()));\n    }\n    _updateState() {\n        if (!this._session || !this._editor.hasModel()) {\n            // canceled in the meanwhile\n            return;\n        }\n        if (this._modelVersionId === this._editor.getModel().getAlternativeVersionId()) {\n            // undo until the 'before' state happened\n            // and makes use cancel snippet mode\n            return this.cancel();\n        }\n        if (!this._session.hasPlaceholder) {\n            // don't listen for selection changes and don't\n            // update context keys when the snippet is plain text\n            return this.cancel();\n        }\n        if (this._session.isAtLastPlaceholder || !this._session.isSelectionWithinPlaceholders()) {\n            this._editor.getModel().pushStackElement();\n            return this.cancel();\n        }\n        this._inSnippet.set(true);\n        this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder);\n        this._hasNextTabstop.set(!this._session.isAtLastPlaceholder);\n        this._handleChoice();\n    }\n    _handleChoice() {\n        if (!this._session || !this._editor.hasModel()) {\n            this._currentChoice = undefined;\n            return;\n        }\n        const { activeChoice } = this._session;\n        if (!activeChoice || !this._choiceCompletionItemProvider) {\n            this._currentChoice = undefined;\n            return;\n        }\n        if (this._currentChoice !== activeChoice.choice) {\n            this._currentChoice = activeChoice.choice;\n            // trigger suggest with the special choice completion provider\n            queueMicrotask(() => {\n                showSimpleSuggestions(this._editor, this._choiceCompletionItemProvider);\n            });\n        }\n    }\n    finish() {\n        while (this._inSnippet.get()) {\n            this.next();\n        }\n    }\n    cancel(resetSelection = false) {\n        var _a;\n        this._inSnippet.reset();\n        this._hasPrevTabstop.reset();\n        this._hasNextTabstop.reset();\n        this._snippetListener.clear();\n        this._currentChoice = undefined;\n        (_a = this._session) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._session = undefined;\n        this._modelVersionId = -1;\n        if (resetSelection) {\n            // reset selection to the primary cursor when being asked\n            // for. this happens when explicitly cancelling snippet mode,\n            // e.g. when pressing ESC\n            this._editor.setSelections([this._editor.getSelection()]);\n        }\n    }\n    prev() {\n        if (this._session) {\n            this._session.prev();\n        }\n        this._updateState();\n    }\n    next() {\n        if (this._session) {\n            this._session.next();\n        }\n        this._updateState();\n    }\n    isInSnippet() {\n        return Boolean(this._inSnippet.get());\n    }\n};\nSnippetController2.ID = 'snippetController2';\nSnippetController2.InSnippetMode = new RawContextKey('inSnippetMode', false, localize('inSnippetMode', \"Whether the editor in current in snippet mode\"));\nSnippetController2.HasNextTabstop = new RawContextKey('hasNextTabstop', false, localize('hasNextTabstop', \"Whether there is a next tab stop when in snippet mode\"));\nSnippetController2.HasPrevTabstop = new RawContextKey('hasPrevTabstop', false, localize('hasPrevTabstop', \"Whether there is a previous tab stop when in snippet mode\"));\nSnippetController2 = __decorate([\n    __param(1, ILogService),\n    __param(2, ILanguageFeaturesService),\n    __param(3, IContextKeyService),\n    __param(4, ILanguageConfigurationService)\n], SnippetController2);\nexport { SnippetController2 };\nregisterEditorContribution(SnippetController2.ID, SnippetController2);\nconst CommandCtor = EditorCommand.bindToContribution(SnippetController2.get);\nregisterEditorCommand(new CommandCtor({\n    id: 'jumpToNextSnippetPlaceholder',\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasNextTabstop),\n    handler: ctrl => ctrl.next(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'jumpToPrevSnippetPlaceholder',\n    precondition: ContextKeyExpr.and(SnippetController2.InSnippetMode, SnippetController2.HasPrevTabstop),\n    handler: ctrl => ctrl.prev(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'leaveSnippet',\n    precondition: SnippetController2.InSnippetMode,\n    handler: ctrl => ctrl.cancel(true),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 30,\n        kbExpr: EditorContextKeys.editorTextFocus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\nregisterEditorCommand(new CommandCtor({\n    id: 'acceptSnippet',\n    precondition: SnippetController2.InSnippetMode,\n    handler: ctrl => ctrl.finish(),\n    // kbOpts: {\n    // \tweight: KeybindingWeight.EditorContrib + 30,\n    // \tkbExpr: EditorContextKeys.textFocus,\n    // \tprimary: KeyCode.Enter,\n    // }\n}));\n// ---\nexport function performSnippetEdit(editor, snippet, selections) {\n    const controller = SnippetController2.get(editor);\n    if (!controller) {\n        return false;\n    }\n    editor.focus();\n    controller.apply(selections.map(selection => {\n        return {\n            range: Selection.liftSelection(selection),\n            template: snippet\n        };\n    }));\n    return controller.isInSnippet();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class Scanner {\n    constructor() {\n        this.value = '';\n        this.pos = 0;\n    }\n    static isDigitCharacter(ch) {\n        return ch >= 48 /* CharCode.Digit0 */ && ch <= 57 /* CharCode.Digit9 */;\n    }\n    static isVariableCharacter(ch) {\n        return ch === 95 /* CharCode.Underline */\n            || (ch >= 97 /* CharCode.a */ && ch <= 122 /* CharCode.z */)\n            || (ch >= 65 /* CharCode.A */ && ch <= 90 /* CharCode.Z */);\n    }\n    text(value) {\n        this.value = value;\n        this.pos = 0;\n    }\n    tokenText(token) {\n        return this.value.substr(token.pos, token.len);\n    }\n    next() {\n        if (this.pos >= this.value.length) {\n            return { type: 14 /* TokenType.EOF */, pos: this.pos, len: 0 };\n        }\n        const pos = this.pos;\n        let len = 0;\n        let ch = this.value.charCodeAt(pos);\n        let type;\n        // static types\n        type = Scanner._table[ch];\n        if (typeof type === 'number') {\n            this.pos += 1;\n            return { type, pos, len: 1 };\n        }\n        // number\n        if (Scanner.isDigitCharacter(ch)) {\n            type = 8 /* TokenType.Int */;\n            do {\n                len += 1;\n                ch = this.value.charCodeAt(pos + len);\n            } while (Scanner.isDigitCharacter(ch));\n            this.pos += len;\n            return { type, pos, len };\n        }\n        // variable name\n        if (Scanner.isVariableCharacter(ch)) {\n            type = 9 /* TokenType.VariableName */;\n            do {\n                ch = this.value.charCodeAt(pos + (++len));\n            } while (Scanner.isVariableCharacter(ch) || Scanner.isDigitCharacter(ch));\n            this.pos += len;\n            return { type, pos, len };\n        }\n        // format\n        type = 10 /* TokenType.Format */;\n        do {\n            len += 1;\n            ch = this.value.charCodeAt(pos + len);\n        } while (!isNaN(ch)\n            && typeof Scanner._table[ch] === 'undefined' // not static token\n            && !Scanner.isDigitCharacter(ch) // not number\n            && !Scanner.isVariableCharacter(ch) // not variable\n        );\n        this.pos += len;\n        return { type, pos, len };\n    }\n}\nScanner._table = {\n    [36 /* CharCode.DollarSign */]: 0 /* TokenType.Dollar */,\n    [58 /* CharCode.Colon */]: 1 /* TokenType.Colon */,\n    [44 /* CharCode.Comma */]: 2 /* TokenType.Comma */,\n    [123 /* CharCode.OpenCurlyBrace */]: 3 /* TokenType.CurlyOpen */,\n    [125 /* CharCode.CloseCurlyBrace */]: 4 /* TokenType.CurlyClose */,\n    [92 /* CharCode.Backslash */]: 5 /* TokenType.Backslash */,\n    [47 /* CharCode.Slash */]: 6 /* TokenType.Forwardslash */,\n    [124 /* CharCode.Pipe */]: 7 /* TokenType.Pipe */,\n    [43 /* CharCode.Plus */]: 11 /* TokenType.Plus */,\n    [45 /* CharCode.Dash */]: 12 /* TokenType.Dash */,\n    [63 /* CharCode.QuestionMark */]: 13 /* TokenType.QuestionMark */,\n};\nexport class Marker {\n    constructor() {\n        this._children = [];\n    }\n    appendChild(child) {\n        if (child instanceof Text && this._children[this._children.length - 1] instanceof Text) {\n            // this and previous child are text -> merge them\n            this._children[this._children.length - 1].value += child.value;\n        }\n        else {\n            // normal adoption of child\n            child.parent = this;\n            this._children.push(child);\n        }\n        return this;\n    }\n    replace(child, others) {\n        const { parent } = child;\n        const idx = parent.children.indexOf(child);\n        const newChildren = parent.children.slice(0);\n        newChildren.splice(idx, 1, ...others);\n        parent._children = newChildren;\n        (function _fixParent(children, parent) {\n            for (const child of children) {\n                child.parent = parent;\n                _fixParent(child.children, child);\n            }\n        })(others, parent);\n    }\n    get children() {\n        return this._children;\n    }\n    get snippet() {\n        let candidate = this;\n        while (true) {\n            if (!candidate) {\n                return undefined;\n            }\n            if (candidate instanceof TextmateSnippet) {\n                return candidate;\n            }\n            candidate = candidate.parent;\n        }\n    }\n    toString() {\n        return this.children.reduce((prev, cur) => prev + cur.toString(), '');\n    }\n    len() {\n        return 0;\n    }\n}\nexport class Text extends Marker {\n    constructor(value) {\n        super();\n        this.value = value;\n    }\n    toString() {\n        return this.value;\n    }\n    len() {\n        return this.value.length;\n    }\n    clone() {\n        return new Text(this.value);\n    }\n}\nexport class TransformableMarker extends Marker {\n}\nexport class Placeholder extends TransformableMarker {\n    constructor(index) {\n        super();\n        this.index = index;\n    }\n    static compareByIndex(a, b) {\n        if (a.index === b.index) {\n            return 0;\n        }\n        else if (a.isFinalTabstop) {\n            return 1;\n        }\n        else if (b.isFinalTabstop) {\n            return -1;\n        }\n        else if (a.index < b.index) {\n            return -1;\n        }\n        else if (a.index > b.index) {\n            return 1;\n        }\n        else {\n            return 0;\n        }\n    }\n    get isFinalTabstop() {\n        return this.index === 0;\n    }\n    get choice() {\n        return this._children.length === 1 && this._children[0] instanceof Choice\n            ? this._children[0]\n            : undefined;\n    }\n    clone() {\n        const ret = new Placeholder(this.index);\n        if (this.transform) {\n            ret.transform = this.transform.clone();\n        }\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nexport class Choice extends Marker {\n    constructor() {\n        super(...arguments);\n        this.options = [];\n    }\n    appendChild(marker) {\n        if (marker instanceof Text) {\n            marker.parent = this;\n            this.options.push(marker);\n        }\n        return this;\n    }\n    toString() {\n        return this.options[0].value;\n    }\n    len() {\n        return this.options[0].len();\n    }\n    clone() {\n        const ret = new Choice();\n        this.options.forEach(ret.appendChild, ret);\n        return ret;\n    }\n}\nexport class Transform extends Marker {\n    constructor() {\n        super(...arguments);\n        this.regexp = new RegExp('');\n    }\n    resolve(value) {\n        const _this = this;\n        let didMatch = false;\n        let ret = value.replace(this.regexp, function () {\n            didMatch = true;\n            return _this._replace(Array.prototype.slice.call(arguments, 0, -2));\n        });\n        // when the regex didn't match and when the transform has\n        // else branches, then run those\n        if (!didMatch && this._children.some(child => child instanceof FormatString && Boolean(child.elseValue))) {\n            ret = this._replace([]);\n        }\n        return ret;\n    }\n    _replace(groups) {\n        let ret = '';\n        for (const marker of this._children) {\n            if (marker instanceof FormatString) {\n                let value = groups[marker.index] || '';\n                value = marker.resolve(value);\n                ret += value;\n            }\n            else {\n                ret += marker.toString();\n            }\n        }\n        return ret;\n    }\n    toString() {\n        return '';\n    }\n    clone() {\n        const ret = new Transform();\n        ret.regexp = new RegExp(this.regexp.source, '' + (this.regexp.ignoreCase ? 'i' : '') + (this.regexp.global ? 'g' : ''));\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nexport class FormatString extends Marker {\n    constructor(index, shorthandName, ifValue, elseValue) {\n        super();\n        this.index = index;\n        this.shorthandName = shorthandName;\n        this.ifValue = ifValue;\n        this.elseValue = elseValue;\n    }\n    resolve(value) {\n        if (this.shorthandName === 'upcase') {\n            return !value ? '' : value.toLocaleUpperCase();\n        }\n        else if (this.shorthandName === 'downcase') {\n            return !value ? '' : value.toLocaleLowerCase();\n        }\n        else if (this.shorthandName === 'capitalize') {\n            return !value ? '' : (value[0].toLocaleUpperCase() + value.substr(1));\n        }\n        else if (this.shorthandName === 'pascalcase') {\n            return !value ? '' : this._toPascalCase(value);\n        }\n        else if (this.shorthandName === 'camelcase') {\n            return !value ? '' : this._toCamelCase(value);\n        }\n        else if (Boolean(value) && typeof this.ifValue === 'string') {\n            return this.ifValue;\n        }\n        else if (!Boolean(value) && typeof this.elseValue === 'string') {\n            return this.elseValue;\n        }\n        else {\n            return value || '';\n        }\n    }\n    _toPascalCase(value) {\n        const match = value.match(/[a-z0-9]+/gi);\n        if (!match) {\n            return value;\n        }\n        return match.map(word => {\n            return word.charAt(0).toUpperCase() + word.substr(1);\n        })\n            .join('');\n    }\n    _toCamelCase(value) {\n        const match = value.match(/[a-z0-9]+/gi);\n        if (!match) {\n            return value;\n        }\n        return match.map((word, index) => {\n            if (index === 0) {\n                return word.charAt(0).toLowerCase() + word.substr(1);\n            }\n            return word.charAt(0).toUpperCase() + word.substr(1);\n        })\n            .join('');\n    }\n    clone() {\n        const ret = new FormatString(this.index, this.shorthandName, this.ifValue, this.elseValue);\n        return ret;\n    }\n}\nexport class Variable extends TransformableMarker {\n    constructor(name) {\n        super();\n        this.name = name;\n    }\n    resolve(resolver) {\n        let value = resolver.resolve(this);\n        if (this.transform) {\n            value = this.transform.resolve(value || '');\n        }\n        if (value !== undefined) {\n            this._children = [new Text(value)];\n            return true;\n        }\n        return false;\n    }\n    clone() {\n        const ret = new Variable(this.name);\n        if (this.transform) {\n            ret.transform = this.transform.clone();\n        }\n        ret._children = this.children.map(child => child.clone());\n        return ret;\n    }\n}\nfunction walk(marker, visitor) {\n    const stack = [...marker];\n    while (stack.length > 0) {\n        const marker = stack.shift();\n        const recurse = visitor(marker);\n        if (!recurse) {\n            break;\n        }\n        stack.unshift(...marker.children);\n    }\n}\nexport class TextmateSnippet extends Marker {\n    get placeholderInfo() {\n        if (!this._placeholders) {\n            // fill in placeholders\n            const all = [];\n            let last;\n            this.walk(function (candidate) {\n                if (candidate instanceof Placeholder) {\n                    all.push(candidate);\n                    last = !last || last.index < candidate.index ? candidate : last;\n                }\n                return true;\n            });\n            this._placeholders = { all, last };\n        }\n        return this._placeholders;\n    }\n    get placeholders() {\n        const { all } = this.placeholderInfo;\n        return all;\n    }\n    offset(marker) {\n        let pos = 0;\n        let found = false;\n        this.walk(candidate => {\n            if (candidate === marker) {\n                found = true;\n                return false;\n            }\n            pos += candidate.len();\n            return true;\n        });\n        if (!found) {\n            return -1;\n        }\n        return pos;\n    }\n    fullLen(marker) {\n        let ret = 0;\n        walk([marker], marker => {\n            ret += marker.len();\n            return true;\n        });\n        return ret;\n    }\n    enclosingPlaceholders(placeholder) {\n        const ret = [];\n        let { parent } = placeholder;\n        while (parent) {\n            if (parent instanceof Placeholder) {\n                ret.push(parent);\n            }\n            parent = parent.parent;\n        }\n        return ret;\n    }\n    resolveVariables(resolver) {\n        this.walk(candidate => {\n            if (candidate instanceof Variable) {\n                if (candidate.resolve(resolver)) {\n                    this._placeholders = undefined;\n                }\n            }\n            return true;\n        });\n        return this;\n    }\n    appendChild(child) {\n        this._placeholders = undefined;\n        return super.appendChild(child);\n    }\n    replace(child, others) {\n        this._placeholders = undefined;\n        return super.replace(child, others);\n    }\n    clone() {\n        const ret = new TextmateSnippet();\n        this._children = this.children.map(child => child.clone());\n        return ret;\n    }\n    walk(visitor) {\n        walk(this.children, visitor);\n    }\n}\nexport class SnippetParser {\n    constructor() {\n        this._scanner = new Scanner();\n        this._token = { type: 14 /* TokenType.EOF */, pos: 0, len: 0 };\n    }\n    static escape(value) {\n        return value.replace(/\\$|}|\\\\/g, '\\\\$&');\n    }\n    static guessNeedsClipboard(template) {\n        return /\\${?CLIPBOARD/.test(template);\n    }\n    parse(value, insertFinalTabstop, enforceFinalTabstop) {\n        const snippet = new TextmateSnippet();\n        this.parseFragment(value, snippet);\n        this.ensureFinalTabstop(snippet, enforceFinalTabstop !== null && enforceFinalTabstop !== void 0 ? enforceFinalTabstop : false, insertFinalTabstop !== null && insertFinalTabstop !== void 0 ? insertFinalTabstop : false);\n        return snippet;\n    }\n    parseFragment(value, snippet) {\n        const offset = snippet.children.length;\n        this._scanner.text(value);\n        this._token = this._scanner.next();\n        while (this._parse(snippet)) {\n            // nothing\n        }\n        // fill in values for placeholders. the first placeholder of an index\n        // that has a value defines the value for all placeholders with that index\n        const placeholderDefaultValues = new Map();\n        const incompletePlaceholders = [];\n        snippet.walk(marker => {\n            if (marker instanceof Placeholder) {\n                if (marker.isFinalTabstop) {\n                    placeholderDefaultValues.set(0, undefined);\n                }\n                else if (!placeholderDefaultValues.has(marker.index) && marker.children.length > 0) {\n                    placeholderDefaultValues.set(marker.index, marker.children);\n                }\n                else {\n                    incompletePlaceholders.push(marker);\n                }\n            }\n            return true;\n        });\n        for (const placeholder of incompletePlaceholders) {\n            const defaultValues = placeholderDefaultValues.get(placeholder.index);\n            if (defaultValues) {\n                const clone = new Placeholder(placeholder.index);\n                clone.transform = placeholder.transform;\n                for (const child of defaultValues) {\n                    clone.appendChild(child.clone());\n                }\n                snippet.replace(placeholder, [clone]);\n            }\n        }\n        return snippet.children.slice(offset);\n    }\n    ensureFinalTabstop(snippet, enforceFinalTabstop, insertFinalTabstop) {\n        if (enforceFinalTabstop || insertFinalTabstop && snippet.placeholders.length > 0) {\n            const finalTabstop = snippet.placeholders.find(p => p.index === 0);\n            if (!finalTabstop) {\n                // the snippet uses placeholders but has no\n                // final tabstop defined -> insert at the end\n                snippet.appendChild(new Placeholder(0));\n            }\n        }\n    }\n    _accept(type, value) {\n        if (type === undefined || this._token.type === type) {\n            const ret = !value ? true : this._scanner.tokenText(this._token);\n            this._token = this._scanner.next();\n            return ret;\n        }\n        return false;\n    }\n    _backTo(token) {\n        this._scanner.pos = token.pos + token.len;\n        this._token = token;\n        return false;\n    }\n    _until(type) {\n        const start = this._token;\n        while (this._token.type !== type) {\n            if (this._token.type === 14 /* TokenType.EOF */) {\n                return false;\n            }\n            else if (this._token.type === 5 /* TokenType.Backslash */) {\n                const nextToken = this._scanner.next();\n                if (nextToken.type !== 0 /* TokenType.Dollar */\n                    && nextToken.type !== 4 /* TokenType.CurlyClose */\n                    && nextToken.type !== 5 /* TokenType.Backslash */) {\n                    return false;\n                }\n            }\n            this._token = this._scanner.next();\n        }\n        const value = this._scanner.value.substring(start.pos, this._token.pos).replace(/\\\\(\\$|}|\\\\)/g, '$1');\n        this._token = this._scanner.next();\n        return value;\n    }\n    _parse(marker) {\n        return this._parseEscaped(marker)\n            || this._parseTabstopOrVariableName(marker)\n            || this._parseComplexPlaceholder(marker)\n            || this._parseComplexVariable(marker)\n            || this._parseAnything(marker);\n    }\n    // \\$, \\\\, \\} -> just text\n    _parseEscaped(marker) {\n        let value;\n        if (value = this._accept(5 /* TokenType.Backslash */, true)) {\n            // saw a backslash, append escaped token or that backslash\n            value = this._accept(0 /* TokenType.Dollar */, true)\n                || this._accept(4 /* TokenType.CurlyClose */, true)\n                || this._accept(5 /* TokenType.Backslash */, true)\n                || value;\n            marker.appendChild(new Text(value));\n            return true;\n        }\n        return false;\n    }\n    // $foo -> variable, $1 -> tabstop\n    _parseTabstopOrVariableName(parent) {\n        let value;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && (value = this._accept(9 /* TokenType.VariableName */, true) || this._accept(8 /* TokenType.Int */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        parent.appendChild(/^\\d+$/.test(value)\n            ? new Placeholder(Number(value))\n            : new Variable(value));\n        return true;\n    }\n    // ${1:<children>}, ${1} -> placeholder\n    _parseComplexPlaceholder(parent) {\n        let index;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && this._accept(3 /* TokenType.CurlyOpen */)\n            && (index = this._accept(8 /* TokenType.Int */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        const placeholder = new Placeholder(Number(index));\n        if (this._accept(1 /* TokenType.Colon */)) {\n            // ${1:<children>}\n            while (true) {\n                // ...} -> done\n                if (this._accept(4 /* TokenType.CurlyClose */)) {\n                    parent.appendChild(placeholder);\n                    return true;\n                }\n                if (this._parse(placeholder)) {\n                    continue;\n                }\n                // fallback\n                parent.appendChild(new Text('${' + index + ':'));\n                placeholder.children.forEach(parent.appendChild, parent);\n                return true;\n            }\n        }\n        else if (placeholder.index > 0 && this._accept(7 /* TokenType.Pipe */)) {\n            // ${1|one,two,three|}\n            const choice = new Choice();\n            while (true) {\n                if (this._parseChoiceElement(choice)) {\n                    if (this._accept(2 /* TokenType.Comma */)) {\n                        // opt, -> more\n                        continue;\n                    }\n                    if (this._accept(7 /* TokenType.Pipe */)) {\n                        placeholder.appendChild(choice);\n                        if (this._accept(4 /* TokenType.CurlyClose */)) {\n                            // ..|} -> done\n                            parent.appendChild(placeholder);\n                            return true;\n                        }\n                    }\n                }\n                this._backTo(token);\n                return false;\n            }\n        }\n        else if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${1/<regex>/<format>/<options>}\n            if (this._parseTransform(placeholder)) {\n                parent.appendChild(placeholder);\n                return true;\n            }\n            this._backTo(token);\n            return false;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${1}\n            parent.appendChild(placeholder);\n            return true;\n        }\n        else {\n            // ${1 <- missing curly or colon\n            return this._backTo(token);\n        }\n    }\n    _parseChoiceElement(parent) {\n        const token = this._token;\n        const values = [];\n        while (true) {\n            if (this._token.type === 2 /* TokenType.Comma */ || this._token.type === 7 /* TokenType.Pipe */) {\n                break;\n            }\n            let value;\n            if (value = this._accept(5 /* TokenType.Backslash */, true)) {\n                // \\, \\|, or \\\\\n                value = this._accept(2 /* TokenType.Comma */, true)\n                    || this._accept(7 /* TokenType.Pipe */, true)\n                    || this._accept(5 /* TokenType.Backslash */, true)\n                    || value;\n            }\n            else {\n                value = this._accept(undefined, true);\n            }\n            if (!value) {\n                // EOF\n                this._backTo(token);\n                return false;\n            }\n            values.push(value);\n        }\n        if (values.length === 0) {\n            this._backTo(token);\n            return false;\n        }\n        parent.appendChild(new Text(values.join('')));\n        return true;\n    }\n    // ${foo:<children>}, ${foo} -> variable\n    _parseComplexVariable(parent) {\n        let name;\n        const token = this._token;\n        const match = this._accept(0 /* TokenType.Dollar */)\n            && this._accept(3 /* TokenType.CurlyOpen */)\n            && (name = this._accept(9 /* TokenType.VariableName */, true));\n        if (!match) {\n            return this._backTo(token);\n        }\n        const variable = new Variable(name);\n        if (this._accept(1 /* TokenType.Colon */)) {\n            // ${foo:<children>}\n            while (true) {\n                // ...} -> done\n                if (this._accept(4 /* TokenType.CurlyClose */)) {\n                    parent.appendChild(variable);\n                    return true;\n                }\n                if (this._parse(variable)) {\n                    continue;\n                }\n                // fallback\n                parent.appendChild(new Text('${' + name + ':'));\n                variable.children.forEach(parent.appendChild, parent);\n                return true;\n            }\n        }\n        else if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${foo/<regex>/<format>/<options>}\n            if (this._parseTransform(variable)) {\n                parent.appendChild(variable);\n                return true;\n            }\n            this._backTo(token);\n            return false;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${foo}\n            parent.appendChild(variable);\n            return true;\n        }\n        else {\n            // ${foo <- missing curly or colon\n            return this._backTo(token);\n        }\n    }\n    _parseTransform(parent) {\n        // ...<regex>/<format>/<options>}\n        const transform = new Transform();\n        let regexValue = '';\n        let regexOptions = '';\n        // (1) /regex\n        while (true) {\n            if (this._accept(6 /* TokenType.Forwardslash */)) {\n                break;\n            }\n            let escaped;\n            if (escaped = this._accept(5 /* TokenType.Backslash */, true)) {\n                escaped = this._accept(6 /* TokenType.Forwardslash */, true) || escaped;\n                regexValue += escaped;\n                continue;\n            }\n            if (this._token.type !== 14 /* TokenType.EOF */) {\n                regexValue += this._accept(undefined, true);\n                continue;\n            }\n            return false;\n        }\n        // (2) /format\n        while (true) {\n            if (this._accept(6 /* TokenType.Forwardslash */)) {\n                break;\n            }\n            let escaped;\n            if (escaped = this._accept(5 /* TokenType.Backslash */, true)) {\n                escaped = this._accept(5 /* TokenType.Backslash */, true) || this._accept(6 /* TokenType.Forwardslash */, true) || escaped;\n                transform.appendChild(new Text(escaped));\n                continue;\n            }\n            if (this._parseFormatString(transform) || this._parseAnything(transform)) {\n                continue;\n            }\n            return false;\n        }\n        // (3) /option\n        while (true) {\n            if (this._accept(4 /* TokenType.CurlyClose */)) {\n                break;\n            }\n            if (this._token.type !== 14 /* TokenType.EOF */) {\n                regexOptions += this._accept(undefined, true);\n                continue;\n            }\n            return false;\n        }\n        try {\n            transform.regexp = new RegExp(regexValue, regexOptions);\n        }\n        catch (e) {\n            // invalid regexp\n            return false;\n        }\n        parent.transform = transform;\n        return true;\n    }\n    _parseFormatString(parent) {\n        const token = this._token;\n        if (!this._accept(0 /* TokenType.Dollar */)) {\n            return false;\n        }\n        let complex = false;\n        if (this._accept(3 /* TokenType.CurlyOpen */)) {\n            complex = true;\n        }\n        const index = this._accept(8 /* TokenType.Int */, true);\n        if (!index) {\n            this._backTo(token);\n            return false;\n        }\n        else if (!complex) {\n            // $1\n            parent.appendChild(new FormatString(Number(index)));\n            return true;\n        }\n        else if (this._accept(4 /* TokenType.CurlyClose */)) {\n            // ${1}\n            parent.appendChild(new FormatString(Number(index)));\n            return true;\n        }\n        else if (!this._accept(1 /* TokenType.Colon */)) {\n            this._backTo(token);\n            return false;\n        }\n        if (this._accept(6 /* TokenType.Forwardslash */)) {\n            // ${1:/upcase}\n            const shorthand = this._accept(9 /* TokenType.VariableName */, true);\n            if (!shorthand || !this._accept(4 /* TokenType.CurlyClose */)) {\n                this._backTo(token);\n                return false;\n            }\n            else {\n                parent.appendChild(new FormatString(Number(index), shorthand));\n                return true;\n            }\n        }\n        else if (this._accept(11 /* TokenType.Plus */)) {\n            // ${1:+<if>}\n            const ifValue = this._until(4 /* TokenType.CurlyClose */);\n            if (ifValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, ifValue, undefined));\n                return true;\n            }\n        }\n        else if (this._accept(12 /* TokenType.Dash */)) {\n            // ${2:-<else>}\n            const elseValue = this._until(4 /* TokenType.CurlyClose */);\n            if (elseValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\n                return true;\n            }\n        }\n        else if (this._accept(13 /* TokenType.QuestionMark */)) {\n            // ${2:?<if>:<else>}\n            const ifValue = this._until(1 /* TokenType.Colon */);\n            if (ifValue) {\n                const elseValue = this._until(4 /* TokenType.CurlyClose */);\n                if (elseValue) {\n                    parent.appendChild(new FormatString(Number(index), undefined, ifValue, elseValue));\n                    return true;\n                }\n            }\n        }\n        else {\n            // ${1:<else>}\n            const elseValue = this._until(4 /* TokenType.CurlyClose */);\n            if (elseValue) {\n                parent.appendChild(new FormatString(Number(index), undefined, undefined, elseValue));\n                return true;\n            }\n        }\n        this._backTo(token);\n        return false;\n    }\n    _parseAnything(marker) {\n        if (this._token.type !== 14 /* TokenType.EOF */) {\n            marker.appendChild(new Text(this._scanner.tokenText(this._token)));\n            this._accept(undefined);\n            return true;\n        }\n        return false;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { normalizeDriveLetter } from '../../../../base/common/labels.js';\nimport * as path from '../../../../base/common/path.js';\nimport { dirname } from '../../../../base/common/resources.js';\nimport { commonPrefixLength, getLeadingWhitespace, isFalsyOrWhitespace, splitLines } from '../../../../base/common/strings.js';\nimport { generateUuid } from '../../../../base/common/uuid.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { Text } from './snippetParser.js';\nimport * as nls from '../../../../nls.js';\nimport { WORKSPACE_EXTENSION, isSingleFolderWorkspaceIdentifier, toWorkspaceIdentifier } from '../../../../platform/workspace/common/workspace.js';\nexport const KnownSnippetVariableNames = Object.freeze({\n    'CURRENT_YEAR': true,\n    'CURRENT_YEAR_SHORT': true,\n    'CURRENT_MONTH': true,\n    'CURRENT_DATE': true,\n    'CURRENT_HOUR': true,\n    'CURRENT_MINUTE': true,\n    'CURRENT_SECOND': true,\n    'CURRENT_DAY_NAME': true,\n    'CURRENT_DAY_NAME_SHORT': true,\n    'CURRENT_MONTH_NAME': true,\n    'CURRENT_MONTH_NAME_SHORT': true,\n    'CURRENT_SECONDS_UNIX': true,\n    'SELECTION': true,\n    'CLIPBOARD': true,\n    'TM_SELECTED_TEXT': true,\n    'TM_CURRENT_LINE': true,\n    'TM_CURRENT_WORD': true,\n    'TM_LINE_INDEX': true,\n    'TM_LINE_NUMBER': true,\n    'TM_FILENAME': true,\n    'TM_FILENAME_BASE': true,\n    'TM_DIRECTORY': true,\n    'TM_FILEPATH': true,\n    'CURSOR_INDEX': true,\n    'CURSOR_NUMBER': true,\n    'RELATIVE_FILEPATH': true,\n    'BLOCK_COMMENT_START': true,\n    'BLOCK_COMMENT_END': true,\n    'LINE_COMMENT': true,\n    'WORKSPACE_NAME': true,\n    'WORKSPACE_FOLDER': true,\n    'RANDOM': true,\n    'RANDOM_HEX': true,\n    'UUID': true\n});\nexport class CompositeSnippetVariableResolver {\n    constructor(_delegates) {\n        this._delegates = _delegates;\n        //\n    }\n    resolve(variable) {\n        for (const delegate of this._delegates) {\n            const value = delegate.resolve(variable);\n            if (value !== undefined) {\n                return value;\n            }\n        }\n        return undefined;\n    }\n}\nexport class SelectionBasedVariableResolver {\n    constructor(_model, _selection, _selectionIdx, _overtypingCapturer) {\n        this._model = _model;\n        this._selection = _selection;\n        this._selectionIdx = _selectionIdx;\n        this._overtypingCapturer = _overtypingCapturer;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'SELECTION' || name === 'TM_SELECTED_TEXT') {\n            let value = this._model.getValueInRange(this._selection) || undefined;\n            let isMultiline = this._selection.startLineNumber !== this._selection.endLineNumber;\n            // If there was no selected text, try to get last overtyped text\n            if (!value && this._overtypingCapturer) {\n                const info = this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);\n                if (info) {\n                    value = info.value;\n                    isMultiline = info.multiline;\n                }\n            }\n            if (value && isMultiline && variable.snippet) {\n                // Selection is a multiline string which we indentation we now\n                // need to adjust. We compare the indentation of this variable\n                // with the indentation at the editor position and add potential\n                // extra indentation to the value\n                const line = this._model.getLineContent(this._selection.startLineNumber);\n                const lineLeadingWhitespace = getLeadingWhitespace(line, 0, this._selection.startColumn - 1);\n                let varLeadingWhitespace = lineLeadingWhitespace;\n                variable.snippet.walk(marker => {\n                    if (marker === variable) {\n                        return false;\n                    }\n                    if (marker instanceof Text) {\n                        varLeadingWhitespace = getLeadingWhitespace(splitLines(marker.value).pop());\n                    }\n                    return true;\n                });\n                const whitespaceCommonLength = commonPrefixLength(varLeadingWhitespace, lineLeadingWhitespace);\n                value = value.replace(/(\\r\\n|\\r|\\n)(.*)/g, (m, newline, rest) => `${newline}${varLeadingWhitespace.substr(whitespaceCommonLength)}${rest}`);\n            }\n            return value;\n        }\n        else if (name === 'TM_CURRENT_LINE') {\n            return this._model.getLineContent(this._selection.positionLineNumber);\n        }\n        else if (name === 'TM_CURRENT_WORD') {\n            const info = this._model.getWordAtPosition({\n                lineNumber: this._selection.positionLineNumber,\n                column: this._selection.positionColumn\n            });\n            return info && info.word || undefined;\n        }\n        else if (name === 'TM_LINE_INDEX') {\n            return String(this._selection.positionLineNumber - 1);\n        }\n        else if (name === 'TM_LINE_NUMBER') {\n            return String(this._selection.positionLineNumber);\n        }\n        else if (name === 'CURSOR_INDEX') {\n            return String(this._selectionIdx);\n        }\n        else if (name === 'CURSOR_NUMBER') {\n            return String(this._selectionIdx + 1);\n        }\n        return undefined;\n    }\n}\nexport class ModelBasedVariableResolver {\n    constructor(_labelService, _model) {\n        this._labelService = _labelService;\n        this._model = _model;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'TM_FILENAME') {\n            return path.basename(this._model.uri.fsPath);\n        }\n        else if (name === 'TM_FILENAME_BASE') {\n            const name = path.basename(this._model.uri.fsPath);\n            const idx = name.lastIndexOf('.');\n            if (idx <= 0) {\n                return name;\n            }\n            else {\n                return name.slice(0, idx);\n            }\n        }\n        else if (name === 'TM_DIRECTORY') {\n            if (path.dirname(this._model.uri.fsPath) === '.') {\n                return '';\n            }\n            return this._labelService.getUriLabel(dirname(this._model.uri));\n        }\n        else if (name === 'TM_FILEPATH') {\n            return this._labelService.getUriLabel(this._model.uri);\n        }\n        else if (name === 'RELATIVE_FILEPATH') {\n            return this._labelService.getUriLabel(this._model.uri, { relative: true, noPrefix: true });\n        }\n        return undefined;\n    }\n}\nexport class ClipboardBasedVariableResolver {\n    constructor(_readClipboardText, _selectionIdx, _selectionCount, _spread) {\n        this._readClipboardText = _readClipboardText;\n        this._selectionIdx = _selectionIdx;\n        this._selectionCount = _selectionCount;\n        this._spread = _spread;\n        //\n    }\n    resolve(variable) {\n        if (variable.name !== 'CLIPBOARD') {\n            return undefined;\n        }\n        const clipboardText = this._readClipboardText();\n        if (!clipboardText) {\n            return undefined;\n        }\n        // `spread` is assigning each cursor a line of the clipboard\n        // text whenever there the line count equals the cursor count\n        // and when enabled\n        if (this._spread) {\n            const lines = clipboardText.split(/\\r\\n|\\n|\\r/).filter(s => !isFalsyOrWhitespace(s));\n            if (lines.length === this._selectionCount) {\n                return lines[this._selectionIdx];\n            }\n        }\n        return clipboardText;\n    }\n}\nlet CommentBasedVariableResolver = class CommentBasedVariableResolver {\n    constructor(_model, _selection, _languageConfigurationService) {\n        this._model = _model;\n        this._selection = _selection;\n        this._languageConfigurationService = _languageConfigurationService;\n        //\n    }\n    resolve(variable) {\n        const { name } = variable;\n        const langId = this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber, this._selection.selectionStartColumn);\n        const config = this._languageConfigurationService.getLanguageConfiguration(langId).comments;\n        if (!config) {\n            return undefined;\n        }\n        if (name === 'LINE_COMMENT') {\n            return config.lineCommentToken || undefined;\n        }\n        else if (name === 'BLOCK_COMMENT_START') {\n            return config.blockCommentStartToken || undefined;\n        }\n        else if (name === 'BLOCK_COMMENT_END') {\n            return config.blockCommentEndToken || undefined;\n        }\n        return undefined;\n    }\n};\nCommentBasedVariableResolver = __decorate([\n    __param(2, ILanguageConfigurationService)\n], CommentBasedVariableResolver);\nexport { CommentBasedVariableResolver };\nexport class TimeBasedVariableResolver {\n    constructor() {\n        this._date = new Date();\n    }\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'CURRENT_YEAR') {\n            return String(this._date.getFullYear());\n        }\n        else if (name === 'CURRENT_YEAR_SHORT') {\n            return String(this._date.getFullYear()).slice(-2);\n        }\n        else if (name === 'CURRENT_MONTH') {\n            return String(this._date.getMonth().valueOf() + 1).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_DATE') {\n            return String(this._date.getDate().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_HOUR') {\n            return String(this._date.getHours().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_MINUTE') {\n            return String(this._date.getMinutes().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_SECOND') {\n            return String(this._date.getSeconds().valueOf()).padStart(2, '0');\n        }\n        else if (name === 'CURRENT_DAY_NAME') {\n            return TimeBasedVariableResolver.dayNames[this._date.getDay()];\n        }\n        else if (name === 'CURRENT_DAY_NAME_SHORT') {\n            return TimeBasedVariableResolver.dayNamesShort[this._date.getDay()];\n        }\n        else if (name === 'CURRENT_MONTH_NAME') {\n            return TimeBasedVariableResolver.monthNames[this._date.getMonth()];\n        }\n        else if (name === 'CURRENT_MONTH_NAME_SHORT') {\n            return TimeBasedVariableResolver.monthNamesShort[this._date.getMonth()];\n        }\n        else if (name === 'CURRENT_SECONDS_UNIX') {\n            return String(Math.floor(this._date.getTime() / 1000));\n        }\n        return undefined;\n    }\n}\nTimeBasedVariableResolver.dayNames = [nls.localize('Sunday', \"Sunday\"), nls.localize('Monday', \"Monday\"), nls.localize('Tuesday', \"Tuesday\"), nls.localize('Wednesday', \"Wednesday\"), nls.localize('Thursday', \"Thursday\"), nls.localize('Friday', \"Friday\"), nls.localize('Saturday', \"Saturday\")];\nTimeBasedVariableResolver.dayNamesShort = [nls.localize('SundayShort', \"Sun\"), nls.localize('MondayShort', \"Mon\"), nls.localize('TuesdayShort', \"Tue\"), nls.localize('WednesdayShort', \"Wed\"), nls.localize('ThursdayShort', \"Thu\"), nls.localize('FridayShort', \"Fri\"), nls.localize('SaturdayShort', \"Sat\")];\nTimeBasedVariableResolver.monthNames = [nls.localize('January', \"January\"), nls.localize('February', \"February\"), nls.localize('March', \"March\"), nls.localize('April', \"April\"), nls.localize('May', \"May\"), nls.localize('June', \"June\"), nls.localize('July', \"July\"), nls.localize('August', \"August\"), nls.localize('September', \"September\"), nls.localize('October', \"October\"), nls.localize('November', \"November\"), nls.localize('December', \"December\")];\nTimeBasedVariableResolver.monthNamesShort = [nls.localize('JanuaryShort', \"Jan\"), nls.localize('FebruaryShort', \"Feb\"), nls.localize('MarchShort', \"Mar\"), nls.localize('AprilShort', \"Apr\"), nls.localize('MayShort', \"May\"), nls.localize('JuneShort', \"Jun\"), nls.localize('JulyShort', \"Jul\"), nls.localize('AugustShort', \"Aug\"), nls.localize('SeptemberShort', \"Sep\"), nls.localize('OctoberShort', \"Oct\"), nls.localize('NovemberShort', \"Nov\"), nls.localize('DecemberShort', \"Dec\")];\nexport class WorkspaceBasedVariableResolver {\n    constructor(_workspaceService) {\n        this._workspaceService = _workspaceService;\n        //\n    }\n    resolve(variable) {\n        if (!this._workspaceService) {\n            return undefined;\n        }\n        const workspaceIdentifier = toWorkspaceIdentifier(this._workspaceService.getWorkspace());\n        if (!workspaceIdentifier) {\n            return undefined;\n        }\n        if (variable.name === 'WORKSPACE_NAME') {\n            return this._resolveWorkspaceName(workspaceIdentifier);\n        }\n        else if (variable.name === 'WORKSPACE_FOLDER') {\n            return this._resoveWorkspacePath(workspaceIdentifier);\n        }\n        return undefined;\n    }\n    _resolveWorkspaceName(workspaceIdentifier) {\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n            return path.basename(workspaceIdentifier.uri.path);\n        }\n        let filename = path.basename(workspaceIdentifier.configPath.path);\n        if (filename.endsWith(WORKSPACE_EXTENSION)) {\n            filename = filename.substr(0, filename.length - WORKSPACE_EXTENSION.length - 1);\n        }\n        return filename;\n    }\n    _resoveWorkspacePath(workspaceIdentifier) {\n        if (isSingleFolderWorkspaceIdentifier(workspaceIdentifier)) {\n            return normalizeDriveLetter(workspaceIdentifier.uri.fsPath);\n        }\n        const filename = path.basename(workspaceIdentifier.configPath.path);\n        let folderpath = workspaceIdentifier.configPath.fsPath;\n        if (folderpath.endsWith(filename)) {\n            folderpath = folderpath.substr(0, folderpath.length - filename.length - 1);\n        }\n        return (folderpath ? normalizeDriveLetter(folderpath) : '/');\n    }\n}\nexport class RandomBasedVariableResolver {\n    resolve(variable) {\n        const { name } = variable;\n        if (name === 'RANDOM') {\n            return Math.random().toString().slice(-6);\n        }\n        else if (name === 'RANDOM_HEX') {\n            return Math.random().toString(16).slice(-6);\n        }\n        else if (name === 'UUID') {\n            return generateUuid();\n        }\n        return undefined;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { groupBy } from '../../../../base/common/arrays.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { getLeadingWhitespace } from '../../../../base/common/strings.js';\nimport './snippetSession.css';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { IWorkspaceContextService } from '../../../../platform/workspace/common/workspace.js';\nimport { Choice, Placeholder, SnippetParser, Text, TextmateSnippet } from './snippetParser.js';\nimport { ClipboardBasedVariableResolver, CommentBasedVariableResolver, CompositeSnippetVariableResolver, ModelBasedVariableResolver, RandomBasedVariableResolver, SelectionBasedVariableResolver, TimeBasedVariableResolver, WorkspaceBasedVariableResolver } from './snippetVariables.js';\nexport class OneSnippet {\n    constructor(_editor, _snippet, _snippetLineLeadingWhitespace) {\n        this._editor = _editor;\n        this._snippet = _snippet;\n        this._snippetLineLeadingWhitespace = _snippetLineLeadingWhitespace;\n        this._offset = -1;\n        this._nestingLevel = 1;\n        this._placeholderGroups = groupBy(_snippet.placeholders, Placeholder.compareByIndex);\n        this._placeholderGroupsIdx = -1;\n    }\n    initialize(textChange) {\n        this._offset = textChange.newPosition;\n    }\n    dispose() {\n        if (this._placeholderDecorations) {\n            this._editor.removeDecorations([...this._placeholderDecorations.values()]);\n        }\n        this._placeholderGroups.length = 0;\n    }\n    _initDecorations() {\n        if (this._offset === -1) {\n            throw new Error(`Snippet not initialized!`);\n        }\n        if (this._placeholderDecorations) {\n            // already initialized\n            return;\n        }\n        this._placeholderDecorations = new Map();\n        const model = this._editor.getModel();\n        this._editor.changeDecorations(accessor => {\n            // create a decoration for each placeholder\n            for (const placeholder of this._snippet.placeholders) {\n                const placeholderOffset = this._snippet.offset(placeholder);\n                const placeholderLen = this._snippet.fullLen(placeholder);\n                const range = Range.fromPositions(model.getPositionAt(this._offset + placeholderOffset), model.getPositionAt(this._offset + placeholderOffset + placeholderLen));\n                const options = placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive;\n                const handle = accessor.addDecoration(range, options);\n                this._placeholderDecorations.set(placeholder, handle);\n            }\n        });\n    }\n    move(fwd) {\n        if (!this._editor.hasModel()) {\n            return [];\n        }\n        this._initDecorations();\n        // Transform placeholder text if necessary\n        if (this._placeholderGroupsIdx >= 0) {\n            const operations = [];\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                // Check if the placeholder has a transformation\n                if (placeholder.transform) {\n                    const id = this._placeholderDecorations.get(placeholder);\n                    const range = this._editor.getModel().getDecorationRange(id);\n                    const currentValue = this._editor.getModel().getValueInRange(range);\n                    const transformedValueLines = placeholder.transform.resolve(currentValue).split(/\\r\\n|\\r|\\n/);\n                    // fix indentation for transformed lines\n                    for (let i = 1; i < transformedValueLines.length; i++) {\n                        transformedValueLines[i] = this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace + transformedValueLines[i]);\n                    }\n                    operations.push(EditOperation.replace(range, transformedValueLines.join(this._editor.getModel().getEOL())));\n                }\n            }\n            if (operations.length > 0) {\n                this._editor.executeEdits('snippet.placeholderTransform', operations);\n            }\n        }\n        let couldSkipThisPlaceholder = false;\n        if (fwd === true && this._placeholderGroupsIdx < this._placeholderGroups.length - 1) {\n            this._placeholderGroupsIdx += 1;\n            couldSkipThisPlaceholder = true;\n        }\n        else if (fwd === false && this._placeholderGroupsIdx > 0) {\n            this._placeholderGroupsIdx -= 1;\n            couldSkipThisPlaceholder = true;\n        }\n        else {\n            // the selection of the current placeholder might\n            // not acurate any more -> simply restore it\n        }\n        const newSelections = this._editor.getModel().changeDecorations(accessor => {\n            const activePlaceholders = new Set();\n            // change stickiness to always grow when typing at its edges\n            // because these decorations represent the currently active\n            // tabstop.\n            // Special case #1: reaching the final tabstop\n            // Special case #2: placeholders enclosing active placeholders\n            const selections = [];\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                const id = this._placeholderDecorations.get(placeholder);\n                const range = this._editor.getModel().getDecorationRange(id);\n                selections.push(new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn));\n                // consider to skip this placeholder index when the decoration\n                // range is empty but when the placeholder wasn't. that's a strong\n                // hint that the placeholder has been deleted. (all placeholder must match this)\n                couldSkipThisPlaceholder = couldSkipThisPlaceholder && this._hasPlaceholderBeenCollapsed(placeholder);\n                accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\n                activePlaceholders.add(placeholder);\n                for (const enclosingPlaceholder of this._snippet.enclosingPlaceholders(placeholder)) {\n                    const id = this._placeholderDecorations.get(enclosingPlaceholder);\n                    accessor.changeDecorationOptions(id, enclosingPlaceholder.isFinalTabstop ? OneSnippet._decor.activeFinal : OneSnippet._decor.active);\n                    activePlaceholders.add(enclosingPlaceholder);\n                }\n            }\n            // change stickness to never grow when typing at its edges\n            // so that in-active tabstops never grow\n            for (const [placeholder, id] of this._placeholderDecorations) {\n                if (!activePlaceholders.has(placeholder)) {\n                    accessor.changeDecorationOptions(id, placeholder.isFinalTabstop ? OneSnippet._decor.inactiveFinal : OneSnippet._decor.inactive);\n                }\n            }\n            return selections;\n        });\n        return !couldSkipThisPlaceholder ? newSelections !== null && newSelections !== void 0 ? newSelections : [] : this.move(fwd);\n    }\n    _hasPlaceholderBeenCollapsed(placeholder) {\n        // A placeholder is empty when it wasn't empty when authored but\n        // when its tracking decoration is empty. This also applies to all\n        // potential parent placeholders\n        let marker = placeholder;\n        while (marker) {\n            if (marker instanceof Placeholder) {\n                const id = this._placeholderDecorations.get(marker);\n                const range = this._editor.getModel().getDecorationRange(id);\n                if (range.isEmpty() && marker.toString().length > 0) {\n                    return true;\n                }\n            }\n            marker = marker.parent;\n        }\n        return false;\n    }\n    get isAtFirstPlaceholder() {\n        return this._placeholderGroupsIdx <= 0 || this._placeholderGroups.length === 0;\n    }\n    get isAtLastPlaceholder() {\n        return this._placeholderGroupsIdx === this._placeholderGroups.length - 1;\n    }\n    get hasPlaceholder() {\n        return this._snippet.placeholders.length > 0;\n    }\n    get isTrivialSnippet() {\n        return this._snippet.placeholders.length === 0\n            || (this._snippet.placeholders.length === 1 && this._snippet.placeholders[0].isFinalTabstop);\n    }\n    computePossibleSelections() {\n        const result = new Map();\n        for (const placeholdersWithEqualIndex of this._placeholderGroups) {\n            let ranges;\n            for (const placeholder of placeholdersWithEqualIndex) {\n                if (placeholder.isFinalTabstop) {\n                    // ignore those\n                    break;\n                }\n                if (!ranges) {\n                    ranges = [];\n                    result.set(placeholder.index, ranges);\n                }\n                const id = this._placeholderDecorations.get(placeholder);\n                const range = this._editor.getModel().getDecorationRange(id);\n                if (!range) {\n                    // one of the placeholder lost its decoration and\n                    // therefore we bail out and pretend the placeholder\n                    // (with its mirrors) doesn't exist anymore.\n                    result.delete(placeholder.index);\n                    break;\n                }\n                ranges.push(range);\n            }\n        }\n        return result;\n    }\n    get activeChoice() {\n        if (!this._placeholderDecorations) {\n            return undefined;\n        }\n        const placeholder = this._placeholderGroups[this._placeholderGroupsIdx][0];\n        if (!(placeholder === null || placeholder === void 0 ? void 0 : placeholder.choice)) {\n            return undefined;\n        }\n        const id = this._placeholderDecorations.get(placeholder);\n        if (!id) {\n            return undefined;\n        }\n        const range = this._editor.getModel().getDecorationRange(id);\n        if (!range) {\n            return undefined;\n        }\n        return { range, choice: placeholder.choice };\n    }\n    get hasChoice() {\n        let result = false;\n        this._snippet.walk(marker => {\n            result = marker instanceof Choice;\n            return !result;\n        });\n        return result;\n    }\n    merge(others) {\n        const model = this._editor.getModel();\n        this._nestingLevel *= 10;\n        this._editor.changeDecorations(accessor => {\n            // For each active placeholder take one snippet and merge it\n            // in that the placeholder (can be many for `$1foo$1foo`). Because\n            // everything is sorted by editor selection we can simply remove\n            // elements from the beginning of the array\n            for (const placeholder of this._placeholderGroups[this._placeholderGroupsIdx]) {\n                const nested = others.shift();\n                console.assert(nested._offset !== -1);\n                console.assert(!nested._placeholderDecorations);\n                // Massage placeholder-indicies of the nested snippet to be\n                // sorted right after the insertion point. This ensures we move\n                // through the placeholders in the correct order\n                const indexLastPlaceholder = nested._snippet.placeholderInfo.last.index;\n                for (const nestedPlaceholder of nested._snippet.placeholderInfo.all) {\n                    if (nestedPlaceholder.isFinalTabstop) {\n                        nestedPlaceholder.index = placeholder.index + ((indexLastPlaceholder + 1) / this._nestingLevel);\n                    }\n                    else {\n                        nestedPlaceholder.index = placeholder.index + (nestedPlaceholder.index / this._nestingLevel);\n                    }\n                }\n                this._snippet.replace(placeholder, nested._snippet.children);\n                // Remove the placeholder at which position are inserting\n                // the snippet and also remove its decoration.\n                const id = this._placeholderDecorations.get(placeholder);\n                accessor.removeDecoration(id);\n                this._placeholderDecorations.delete(placeholder);\n                // For each *new* placeholder we create decoration to monitor\n                // how and if it grows/shrinks.\n                for (const placeholder of nested._snippet.placeholders) {\n                    const placeholderOffset = nested._snippet.offset(placeholder);\n                    const placeholderLen = nested._snippet.fullLen(placeholder);\n                    const range = Range.fromPositions(model.getPositionAt(nested._offset + placeholderOffset), model.getPositionAt(nested._offset + placeholderOffset + placeholderLen));\n                    const handle = accessor.addDecoration(range, OneSnippet._decor.inactive);\n                    this._placeholderDecorations.set(placeholder, handle);\n                }\n            }\n            // Last, re-create the placeholder groups by sorting placeholders by their index.\n            this._placeholderGroups = groupBy(this._snippet.placeholders, Placeholder.compareByIndex);\n        });\n    }\n}\nOneSnippet._decor = {\n    active: ModelDecorationOptions.register({ description: 'snippet-placeholder-1', stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\n    inactive: ModelDecorationOptions.register({ description: 'snippet-placeholder-2', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'snippet-placeholder' }),\n    activeFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-3', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\n    inactiveFinal: ModelDecorationOptions.register({ description: 'snippet-placeholder-4', stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */, className: 'finish-snippet-placeholder' }),\n};\nconst _defaultOptions = {\n    overwriteBefore: 0,\n    overwriteAfter: 0,\n    adjustWhitespace: true,\n    clipboardText: undefined,\n    overtypingCapturer: undefined\n};\nlet SnippetSession = class SnippetSession {\n    constructor(_editor, _template, _options = _defaultOptions, _languageConfigurationService) {\n        this._editor = _editor;\n        this._template = _template;\n        this._options = _options;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._templateMerges = [];\n        this._snippets = [];\n    }\n    static adjustWhitespace(model, position, snippet, adjustIndentation, adjustNewlines) {\n        const line = model.getLineContent(position.lineNumber);\n        const lineLeadingWhitespace = getLeadingWhitespace(line, 0, position.column - 1);\n        // the snippet as inserted\n        let snippetTextString;\n        snippet.walk(marker => {\n            // all text elements that are not inside choice\n            if (!(marker instanceof Text) || marker.parent instanceof Choice) {\n                return true;\n            }\n            const lines = marker.value.split(/\\r\\n|\\r|\\n/);\n            if (adjustIndentation) {\n                // adjust indentation of snippet test\n                // -the snippet-start doesn't get extra-indented (lineLeadingWhitespace), only normalized\n                // -all N+1 lines get extra-indented and normalized\n                // -the text start get extra-indented and normalized when following a linebreak\n                const offset = snippet.offset(marker);\n                if (offset === 0) {\n                    // snippet start\n                    lines[0] = model.normalizeIndentation(lines[0]);\n                }\n                else {\n                    // check if text start is after a linebreak\n                    snippetTextString = snippetTextString !== null && snippetTextString !== void 0 ? snippetTextString : snippet.toString();\n                    const prevChar = snippetTextString.charCodeAt(offset - 1);\n                    if (prevChar === 10 /* CharCode.LineFeed */ || prevChar === 13 /* CharCode.CarriageReturn */) {\n                        lines[0] = model.normalizeIndentation(lineLeadingWhitespace + lines[0]);\n                    }\n                }\n                for (let i = 1; i < lines.length; i++) {\n                    lines[i] = model.normalizeIndentation(lineLeadingWhitespace + lines[i]);\n                }\n            }\n            const newValue = lines.join(model.getEOL());\n            if (newValue !== marker.value) {\n                marker.parent.replace(marker, [new Text(newValue)]);\n                snippetTextString = undefined;\n            }\n            return true;\n        });\n        return lineLeadingWhitespace;\n    }\n    static adjustSelection(model, selection, overwriteBefore, overwriteAfter) {\n        if (overwriteBefore !== 0 || overwriteAfter !== 0) {\n            // overwrite[Before|After] is compute using the position, not the whole\n            // selection. therefore we adjust the selection around that position\n            const { positionLineNumber, positionColumn } = selection;\n            const positionColumnBefore = positionColumn - overwriteBefore;\n            const positionColumnAfter = positionColumn + overwriteAfter;\n            const range = model.validateRange({\n                startLineNumber: positionLineNumber,\n                startColumn: positionColumnBefore,\n                endLineNumber: positionLineNumber,\n                endColumn: positionColumnAfter\n            });\n            selection = Selection.createWithDirection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn, selection.getDirection());\n        }\n        return selection;\n    }\n    static createEditsAndSnippetsFromSelections(editor, template, overwriteBefore, overwriteAfter, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer, languageConfigurationService) {\n        const edits = [];\n        const snippets = [];\n        if (!editor.hasModel()) {\n            return { edits, snippets };\n        }\n        const model = editor.getModel();\n        const workspaceService = editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService));\n        const modelBasedVariableResolver = editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService), model));\n        const readClipboardText = () => clipboardText;\n        // know what text the overwrite[Before|After] extensions\n        // of the primary curser have selected because only when\n        // secondary selections extend to the same text we can grow them\n        const firstBeforeText = model.getValueInRange(SnippetSession.adjustSelection(model, editor.getSelection(), overwriteBefore, 0));\n        const firstAfterText = model.getValueInRange(SnippetSession.adjustSelection(model, editor.getSelection(), 0, overwriteAfter));\n        // remember the first non-whitespace column to decide if\n        // `keepWhitespace` should be overruled for secondary selections\n        const firstLineFirstNonWhitespace = model.getLineFirstNonWhitespaceColumn(editor.getSelection().positionLineNumber);\n        // sort selections by their start position but remeber\n        // the original index. that allows you to create correct\n        // offset-based selection logic without changing the\n        // primary selection\n        const indexedSelections = editor.getSelections()\n            .map((selection, idx) => ({ selection, idx }))\n            .sort((a, b) => Range.compareRangesUsingStarts(a.selection, b.selection));\n        for (const { selection, idx } of indexedSelections) {\n            // extend selection with the `overwriteBefore` and `overwriteAfter` and then\n            // compare if this matches the extensions of the primary selection\n            let extensionBefore = SnippetSession.adjustSelection(model, selection, overwriteBefore, 0);\n            let extensionAfter = SnippetSession.adjustSelection(model, selection, 0, overwriteAfter);\n            if (firstBeforeText !== model.getValueInRange(extensionBefore)) {\n                extensionBefore = selection;\n            }\n            if (firstAfterText !== model.getValueInRange(extensionAfter)) {\n                extensionAfter = selection;\n            }\n            // merge the before and after selection into one\n            const snippetSelection = selection\n                .setStartPosition(extensionBefore.startLineNumber, extensionBefore.startColumn)\n                .setEndPosition(extensionAfter.endLineNumber, extensionAfter.endColumn);\n            const snippet = new SnippetParser().parse(template, true, enforceFinalTabstop);\n            // adjust the template string to match the indentation and\n            // whitespace rules of this insert location (can be different for each cursor)\n            // happens when being asked for (default) or when this is a secondary\n            // cursor and the leading whitespace is different\n            const start = snippetSelection.getStartPosition();\n            const snippetLineLeadingWhitespace = SnippetSession.adjustWhitespace(model, start, snippet, adjustWhitespace || (idx > 0 && firstLineFirstNonWhitespace !== model.getLineFirstNonWhitespaceColumn(selection.positionLineNumber)), true);\n            snippet.resolveVariables(new CompositeSnippetVariableResolver([\n                modelBasedVariableResolver,\n                new ClipboardBasedVariableResolver(readClipboardText, idx, indexedSelections.length, editor.getOption(73 /* EditorOption.multiCursorPaste */) === 'spread'),\n                new SelectionBasedVariableResolver(model, selection, idx, overtypingCapturer),\n                new CommentBasedVariableResolver(model, selection, languageConfigurationService),\n                new TimeBasedVariableResolver,\n                new WorkspaceBasedVariableResolver(workspaceService),\n                new RandomBasedVariableResolver,\n            ]));\n            // store snippets with the index of their originating selection.\n            // that ensures the primiary cursor stays primary despite not being\n            // the one with lowest start position\n            edits[idx] = EditOperation.replace(snippetSelection, snippet.toString());\n            edits[idx].identifier = { major: idx, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\n            edits[idx]._isTracked = true;\n            snippets[idx] = new OneSnippet(editor, snippet, snippetLineLeadingWhitespace);\n        }\n        return { edits, snippets };\n    }\n    static createEditsAndSnippetsFromEdits(editor, snippetEdits, enforceFinalTabstop, adjustWhitespace, clipboardText, overtypingCapturer, languageConfigurationService) {\n        if (!editor.hasModel() || snippetEdits.length === 0) {\n            return { edits: [], snippets: [] };\n        }\n        const edits = [];\n        const model = editor.getModel();\n        const parser = new SnippetParser();\n        const snippet = new TextmateSnippet();\n        // snippet variables resolver\n        const resolver = new CompositeSnippetVariableResolver([\n            editor.invokeWithinContext(accessor => new ModelBasedVariableResolver(accessor.get(ILabelService), model)),\n            new ClipboardBasedVariableResolver(() => clipboardText, 0, editor.getSelections().length, editor.getOption(73 /* EditorOption.multiCursorPaste */) === 'spread'),\n            new SelectionBasedVariableResolver(model, editor.getSelection(), 0, overtypingCapturer),\n            new CommentBasedVariableResolver(model, editor.getSelection(), languageConfigurationService),\n            new TimeBasedVariableResolver,\n            new WorkspaceBasedVariableResolver(editor.invokeWithinContext(accessor => accessor.get(IWorkspaceContextService))),\n            new RandomBasedVariableResolver,\n        ]);\n        //\n        snippetEdits = snippetEdits.sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n        let offset = 0;\n        for (let i = 0; i < snippetEdits.length; i++) {\n            const { range, template } = snippetEdits[i];\n            // gaps between snippet edits are appended as text nodes. this\n            // ensures placeholder-offsets are later correct\n            if (i > 0) {\n                const lastRange = snippetEdits[i - 1].range;\n                const textRange = Range.fromPositions(lastRange.getEndPosition(), range.getStartPosition());\n                const textNode = new Text(model.getValueInRange(textRange));\n                snippet.appendChild(textNode);\n                offset += textNode.value.length;\n            }\n            parser.parseFragment(template, snippet);\n            snippet.resolveVariables(resolver);\n            const snippetText = snippet.toString();\n            const snippetFragmentText = snippetText.slice(offset);\n            offset = snippetText.length;\n            // make edit\n            const edit = EditOperation.replace(range, snippetFragmentText);\n            edit.identifier = { major: i, minor: 0 }; // mark the edit so only our undo edits will be used to generate end cursors\n            edit._isTracked = true;\n            edits.push(edit);\n        }\n        //\n        parser.ensureFinalTabstop(snippet, enforceFinalTabstop, true);\n        return {\n            edits,\n            snippets: [new OneSnippet(editor, snippet, '')]\n        };\n    }\n    dispose() {\n        dispose(this._snippets);\n    }\n    _logInfo() {\n        return `template=\"${this._template}\", merged_templates=\"${this._templateMerges.join(' -> ')}\"`;\n    }\n    insert() {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        // make insert edit and start with first selections\n        const { edits, snippets } = typeof this._template === 'string'\n            ? SnippetSession.createEditsAndSnippetsFromSelections(this._editor, this._template, this._options.overwriteBefore, this._options.overwriteAfter, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer, this._languageConfigurationService)\n            : SnippetSession.createEditsAndSnippetsFromEdits(this._editor, this._template, false, this._options.adjustWhitespace, this._options.clipboardText, this._options.overtypingCapturer, this._languageConfigurationService);\n        this._snippets = snippets;\n        this._editor.executeEdits('snippet', edits, _undoEdits => {\n            // Sometimes, the text buffer will remove automatic whitespace when doing any edits,\n            // so we need to look only at the undo edits relevant for us.\n            // Our edits have an identifier set so that's how we can distinguish them\n            const undoEdits = _undoEdits.filter(edit => !!edit.identifier);\n            for (let idx = 0; idx < snippets.length; idx++) {\n                snippets[idx].initialize(undoEdits[idx].textChange);\n            }\n            if (this._snippets[0].hasPlaceholder) {\n                return this._move(true);\n            }\n            else {\n                return undoEdits\n                    .map(edit => Selection.fromPositions(edit.range.getEndPosition()));\n            }\n        });\n        this._editor.revealRange(this._editor.getSelections()[0]);\n    }\n    merge(template, options = _defaultOptions) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._templateMerges.push([this._snippets[0]._nestingLevel, this._snippets[0]._placeholderGroupsIdx, template]);\n        const { edits, snippets } = SnippetSession.createEditsAndSnippetsFromSelections(this._editor, template, options.overwriteBefore, options.overwriteAfter, true, options.adjustWhitespace, options.clipboardText, options.overtypingCapturer, this._languageConfigurationService);\n        this._editor.executeEdits('snippet', edits, _undoEdits => {\n            // Sometimes, the text buffer will remove automatic whitespace when doing any edits,\n            // so we need to look only at the undo edits relevant for us.\n            // Our edits have an identifier set so that's how we can distinguish them\n            const undoEdits = _undoEdits.filter(edit => !!edit.identifier);\n            for (let idx = 0; idx < snippets.length; idx++) {\n                snippets[idx].initialize(undoEdits[idx].textChange);\n            }\n            // Trivial snippets have no placeholder or are just the final placeholder. That means they\n            // are just text insertions and we don't need to merge the nested snippet into the existing\n            // snippet\n            const isTrivialSnippet = snippets[0].isTrivialSnippet;\n            if (!isTrivialSnippet) {\n                for (const snippet of this._snippets) {\n                    snippet.merge(snippets);\n                }\n                console.assert(snippets.length === 0);\n            }\n            if (this._snippets[0].hasPlaceholder && !isTrivialSnippet) {\n                return this._move(undefined);\n            }\n            else {\n                return undoEdits.map(edit => Selection.fromPositions(edit.range.getEndPosition()));\n            }\n        });\n    }\n    next() {\n        const newSelections = this._move(true);\n        this._editor.setSelections(newSelections);\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\n    }\n    prev() {\n        const newSelections = this._move(false);\n        this._editor.setSelections(newSelections);\n        this._editor.revealPositionInCenterIfOutsideViewport(newSelections[0].getPosition());\n    }\n    _move(fwd) {\n        const selections = [];\n        for (const snippet of this._snippets) {\n            const oneSelection = snippet.move(fwd);\n            selections.push(...oneSelection);\n        }\n        return selections;\n    }\n    get isAtFirstPlaceholder() {\n        return this._snippets[0].isAtFirstPlaceholder;\n    }\n    get isAtLastPlaceholder() {\n        return this._snippets[0].isAtLastPlaceholder;\n    }\n    get hasPlaceholder() {\n        return this._snippets[0].hasPlaceholder;\n    }\n    get hasChoice() {\n        return this._snippets[0].hasChoice;\n    }\n    get activeChoice() {\n        return this._snippets[0].activeChoice;\n    }\n    isSelectionWithinPlaceholders() {\n        if (!this.hasPlaceholder) {\n            return false;\n        }\n        const selections = this._editor.getSelections();\n        if (selections.length < this._snippets.length) {\n            // this means we started snippet mode with N\n            // selections and have M (N > M) selections.\n            // So one snippet is without selection -> cancel\n            return false;\n        }\n        const allPossibleSelections = new Map();\n        for (const snippet of this._snippets) {\n            const possibleSelections = snippet.computePossibleSelections();\n            // for the first snippet find the placeholder (and its ranges)\n            // that contain at least one selection. for all remaining snippets\n            // the same placeholder (and their ranges) must be used.\n            if (allPossibleSelections.size === 0) {\n                for (const [index, ranges] of possibleSelections) {\n                    ranges.sort(Range.compareRangesUsingStarts);\n                    for (const selection of selections) {\n                        if (ranges[0].containsRange(selection)) {\n                            allPossibleSelections.set(index, []);\n                            break;\n                        }\n                    }\n                }\n            }\n            if (allPossibleSelections.size === 0) {\n                // return false if we couldn't associate a selection to\n                // this (the first) snippet\n                return false;\n            }\n            // add selections from 'this' snippet so that we know all\n            // selections for this placeholder\n            allPossibleSelections.forEach((array, index) => {\n                array.push(...possibleSelections.get(index));\n            });\n        }\n        // sort selections (and later placeholder-ranges). then walk both\n        // arrays and make sure the placeholder-ranges contain the corresponding\n        // selection\n        selections.sort(Range.compareRangesUsingStarts);\n        for (const [index, ranges] of allPossibleSelections) {\n            if (ranges.length !== selections.length) {\n                allPossibleSelections.delete(index);\n                continue;\n            }\n            ranges.sort(Range.compareRangesUsingStarts);\n            for (let i = 0; i < ranges.length; i++) {\n                if (!ranges[i].containsRange(selections[i])) {\n                    allPossibleSelections.delete(index);\n                    continue;\n                }\n            }\n        }\n        // from all possible selections we have deleted those\n        // that don't match with the current selection. if we don't\n        // have any left, we don't have a selection anymore\n        return allPossibleSelections.size > 0;\n    }\n};\nSnippetSession = __decorate([\n    __param(3, ILanguageConfigurationService)\n], SnippetSession);\nexport { SnippetSession };\n"],"names":["AbstractEditorCommandsQuickAccessProvider","options","instantiationService","keybindingService","commandService","telemetryService","dialogService","activeTextEditorControl","this","editorCommandPicks","getSupportedActions","editorAction","push","commandId","id","commandAlias","alias","label","stripIcons","AbstractCommandsQuickAccessProvider","AbstractEditorNavigationQuickAccessProvider","rangeHighlightDecorationId","undefined","picker","token","_a","disposables","DisposableStore","canAcceptInBackground","matchOnLabel","matchOnDescription","matchOnDetail","sortByLabel","pickerDisposable","add","MutableDisposable","value","doProvide","onDidActiveTextEditorControlChange","editor","canProvideWithTextEditor","context","codeEditor","getCodeEditor","lastKnownEditorViewState","withNullAsUndefined","saveViewState","onDidChangeCursorPosition","restoreViewState","once","onCancellationRequested","call","toDisposable","clearDecorations","provideWithTextEditor","provideWithoutTextEditor","setSelection","range","revealRangeInCenter","preserveFocus","focus","isDiffEditor","getModel","modified","changeDecorations","changeAccessor","deleteDecorations","overviewRulerDecorationId","rangeHighlightId","newDecorations","description","className","isWholeLine","overviewRuler","color","themeColorFromId","overviewRulerRangeHighlight","position","OverviewRulerLane","deltaDecorations","AbstractGotoLineQuickAccessProvider","localize","items","ariaLabel","Disposable","onDidAccept","event","item","selectedItems","isValidLineNumber","lineNumber","gotoLocation","toRange","column","keyMods","inBackground","hide","updatePickerAndEditor","parsePosition","trim","substr","PREFIX","length","getPickLabel","addDecorations","onDidChangeValue","getOptions","get","renderType","updateOptions","lineNumbers","startLineNumber","startColumn","endLineNumber","endColumn","numbers","split","map","part","parseInt","filter","isNaN","endLine","lineCount","isValidColumn","getPosition","model","positionCandidate","validatePosition","equals","_b","getLineCount","__decorate","decorators","target","key","desc","d","c","arguments","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","apply","AbstractGotoSymbolQuickAccessProvider","_languageFeaturesService","_outlineModelService","create","provideLabelPick","documentSymbolProvider","has","doProvideWithEditorSymbols","doProvideWithoutEditorSymbols","waitForLanguageSymbolRegistry","isCancellationRequested","index","kind","symbolProviderRegistryPromise","DeferredPromise","symbolProviderListener","onDidChange","dispose","complete","p","selection","onDidTriggerItemButton","forceSideBySide","symbolsPromise","getDocumentSymbols","picksCts","updatePickerItems","positionToEnclose","busy","CancellationTokenSource","query","prepareQuery","doGetSymbolPicks","original","candidate","findLast","Boolean","type","Range","decoration","activeItems","getSelection","ignoreFirstActiveEvent","onDidChangeActive","symbols","filterBySymbolKind","indexOf","SCOPE_PREFIX","filterPos","values","symbolQuery","pieceToQuery","containerQuery","slice","filteredSymbolPicks","symbol","symbolLabel","name","symbolLabelWithIcon","SymbolKinds","symbolLabelIconOffset","containerLabel","containerName","extraContainerLabel","symbolScore","symbolMatches","containerScore","containerMatches","skipContainerQuery","scoreFuzzy2","assign","deprecated","tags","score","highlights","selectionRange","strikethrough","buttons","openSideBySideDirection","iconClass","Codicon","tooltip","sortedFilteredSymbolPicks","sort","symbolA","symbolB","compareByKindAndScore","compareByScore","symbolPicks","updateLastSeparatorLabel","lastSeparator","lastSymbolKind","lastSymbolKindCounter","format","NLS_SYMBOL_KIND_CACHE","FALLBACK_NLS_SYMBOL_KIND","symbolPick","kindA","kindB","localeCompare","document","getOrCreate","asListOfDocumentSymbols","PREFIX_BY_CATEGORY","ILanguageFeaturesService","IOutlineModelService","ReadOnlyMessageController","_register","onDidAttemptReadOnlyEdit","_onDidAttemptReadOnlyEdit","messageController","MessageController","hasModel","isSimpleWidget","showMessage","nls","ID","registerEditorContribution","CONTEXT_RENAME_INPUT_VISIBLE","RawContextKey","RenameInputField","_editor","_acceptKeybindings","_themeService","_keybindingService","contextKeyService","_disposables","allowEditorOverflow","_visibleContextKey","bindTo","addContentWidget","onDidChangeConfiguration","hasChanged","_updateFont","onDidColorThemeChange","_updateStyles","removeContentWidget","_domNode","createElement","_input","setAttribute","appendChild","_label","updateLabel","accept","preview","lookupKeybinding","innerText","comment","getLabel","onDidUpdateKeybindings","getColorTheme","theme","_c","_d","widgetShadowColor","getColor","widgetShadow","style","backgroundColor","String","editorWidgetBackground","boxShadow","inputForeground","inputBackground","border","inputBorder","borderWidth","borderStyle","borderColor","toString","fontInfo","getOption","fontFamily","fontWeight","fontSize","_visible","_position","preference","cancelInput","wantsPreview","_currentAcceptInput","focusEditor","_currentCancelInput","where","selectionStart","selectionEnd","supportPreview","classList","toggle","Position","size","Math","max","disposeOnDone","newName","onDidBlurEditorWidget","_show","finally","_hide","revealLineInCenterIfOutsideViewport","set","layoutContentWidget","setTimeout","setSelectionRange","getAttribute","reset","IThemeService","IKeybindingService","IContextKeyService","RenameSkeleton","registry","_providerRenameIdx","_providers","ordered","rejects","provider","resolveRenameLocation","res","rejectReason","word","getWordAtPosition","text","join","_provideRenameEdits","edits","provideRenameEdits","concat","rename","skeleton","CancellationToken","loc","RenameController","_instaService","_notificationService","_bulkEditService","_progressService","_logService","_configService","_disposableStore","_cts","_renameInputField","IdleValue","createInstance","renameProvider","hasProvider","EditorStateCancellationTokenSource","resolveLocationOperation","showWhile","min","hasPreviewHandler","getValue","uri","getInput","inputFieldResult","renameOperation","raceCancellation","renameResult","info","ResourceEdit","showPreview","code","quotableLabel","respectAutoSaveConfig","ariaSummary","alert","catch","err","error","acceptInput","getContribution","IInstantiationService","INotificationService","IBulkEditService","IEditorProgressService","ILogService","ITextResourceConfigurationService","RenameAction","precondition","ContextKeyExpr","EditorContextKeys","kbOpts","kbExpr","primary","weight","contextMenuOpts","group","order","accessor","args","editorService","ICodeEditorService","Array","isArray","pos","URI","openCodeEditor","resource","getActiveCodeEditor","setPosition","invokeWithinContext","reportTelemetry","run","onUnexpectedError","controller","EditorAction","registerEditorAction","RenameCommand","EditorCommand","registerEditorCommand","handler","x","acceptRenameInput","cancelRenameInput","secondary","registerModelAndPositionCommand","assertType","Error","Registry","Extensions","registerConfiguration","properties","scope","default","BracketSelectionRangeProvider","positions","bucket","ranges","Map","_bracketsRightYield","_bracketsLeftYield","f","round","counts","t1","Date","now","_maxRounds","bracket","bracketPairs","findNextBracket","_maxDuration","bracketInfo","isOpeningBracket","bracketText","val","getClosedBrackets","list","LinkedList","getEndPosition","findPrevBracket","closing","shift","delete","innerBracket","getStartPosition","outerBracket","_addBracketLeading","startLine","getLineFirstNonWhitespaceColumn","aboveLine","getLineLastNonWhitespaceColumn","WordSelectionRangeProvider","_addInWordRanges","_addWordRanges","_addWhitespaceLine","getFullModelRange","obj","offset","start","end","lastCh","ch","charCodeAt","isLowerAsciiLetter","isUpperAsciiLetter","getLineLength","getLineMaxColumn","SelectionRanges","fwd","equalsRange","mov","SmartSelectController","_ignoreSelection","_selectionListener","forward","selections","getSelections","_state","provideSelectionRanges","selectionRangeProvider","s","arrays","a","b","equalsSelection","containsPosition","unshift","state","newSelections","Selection","setSelections","AbstractSmartSelect","opts","_forward","_accessor","GrowSelectionAction","mac","menuOpts","menuId","MenuId","title","CommandsRegistry","ShrinkSelectionAction","providers","all","work","allRawRanges","allProviderRanges","oneProviderRanges","onUnexpectedExternalError","oneRawRanges","last","oneRanges","selectLeadingAndTrailingWhitespace","oneRangesWithTrivia","prev","cur","rangeNoWhitespace","containsRange","rangeFull","ITextModelService","createModelReference","reference","object","textEditorModel","_defaultOptions","overwriteBefore","overwriteAfter","undoStopBefore","undoStopAfter","adjustWhitespace","clipboardText","overtypingCapturer","SnippetController2","_languageConfigurationService","_snippetListener","_modelVersionId","_inSnippet","InSnippetMode","_hasNextTabstop","HasNextTabstop","_hasPrevTabstop","HasPrevTabstop","_session","_doInsert","cancel","_logInfo","template","clear","pushStackElement","merge","getAlternativeVersionId","SnippetSession","insert","hasChoice","_choiceCompletionItemProvider","provideCompletionItems","activeChoice","choice","getValueInRange","isAnyOfOptions","find","o","suggestions","option","insertText","sortText","repeat","filterText","command","registration","completionProvider","register","language","getLanguageId","pattern","fsPath","scheme","_updateState","onDidChangeModelContent","isFlush","onDidChangeModel","onDidChangeCursorSelection","hasPlaceholder","isAtLastPlaceholder","isSelectionWithinPlaceholders","isAtFirstPlaceholder","_handleChoice","_currentChoice","queueMicrotask","showSimpleSuggestions","resetSelection","ILanguageConfigurationService","CommandCtor","performSnippetEdit","snippet","isInSnippet","ctrl","finish","Scanner","len","_table","isDigitCharacter","isVariableCharacter","Marker","_children","child","Text","parent","others","idx","children","newChildren","splice","_fixParent","TextmateSnippet","reduce","TransformableMarker","Placeholder","Choice","ret","transform","clone","isFinalTabstop","marker","forEach","Transform","regexp","RegExp","_this","didMatch","replace","_replace","prototype","some","FormatString","elseValue","groups","source","ignoreCase","global","shorthandName","ifValue","toLocaleUpperCase","toLocaleLowerCase","_toPascalCase","_toCamelCase","match","charAt","toUpperCase","toLowerCase","Variable","resolver","walk","visitor","stack","_placeholders","placeholderInfo","found","placeholder","SnippetParser","_scanner","_token","insertFinalTabstop","enforceFinalTabstop","parseFragment","ensureFinalTabstop","_parse","placeholderDefaultValues","incompletePlaceholders","defaultValues","placeholders","tokenText","nextToken","substring","_parseEscaped","_parseTabstopOrVariableName","_parseComplexPlaceholder","_parseComplexVariable","_parseAnything","_accept","test","Number","_backTo","_parseTransform","_parseChoiceElement","variable","regexValue","regexOptions","escaped","_parseFormatString","complex","shorthand","_until","CompositeSnippetVariableResolver","freeze","_delegates","SelectionBasedVariableResolver","_model","_selection","_selectionIdx","_overtypingCapturer","isMultiline","getLastOvertypedInfo","multiline","line","getLineContent","lineLeadingWhitespace","getLeadingWhitespace","varLeadingWhitespace","splitLines","pop","whitespaceCommonLength","commonPrefixLength","m","newline","rest","positionLineNumber","positionColumn","ModelBasedVariableResolver","_labelService","path","lastIndexOf","getUriLabel","dirname","relative","noPrefix","ClipboardBasedVariableResolver","_readClipboardText","_selectionCount","_spread","lines","isFalsyOrWhitespace","CommentBasedVariableResolver","langId","getLanguageIdAtPosition","selectionStartLineNumber","selectionStartColumn","config","getLanguageConfiguration","comments","lineCommentToken","blockCommentStartToken","blockCommentEndToken","TimeBasedVariableResolver","_date","getFullYear","getMonth","valueOf","padStart","getDate","getHours","getMinutes","getSeconds","dayNames","getDay","dayNamesShort","monthNames","monthNamesShort","floor","getTime","WorkspaceBasedVariableResolver","_workspaceService","workspaceIdentifier","toWorkspaceIdentifier","getWorkspace","_resolveWorkspaceName","_resoveWorkspacePath","isSingleFolderWorkspaceIdentifier","filename","configPath","endsWith","WORKSPACE_EXTENSION","normalizeDriveLetter","folderpath","RandomBasedVariableResolver","random","generateUuid","OneSnippet","_snippet","_snippetLineLeadingWhitespace","_offset","_nestingLevel","_placeholderGroups","groupBy","_placeholderGroupsIdx","textChange","newPosition","_placeholderDecorations","removeDecorations","placeholderOffset","placeholderLen","fullLen","getPositionAt","_decor","inactiveFinal","inactive","handle","addDecoration","_initDecorations","operations","getDecorationRange","currentValue","transformedValueLines","normalizeIndentation","EditOperation","getEOL","executeEdits","couldSkipThisPlaceholder","activePlaceholders","Set","_hasPlaceholderBeenCollapsed","changeDecorationOptions","activeFinal","active","enclosingPlaceholders","enclosingPlaceholder","move","isEmpty","placeholdersWithEqualIndex","nested","console","assert","indexLastPlaceholder","nestedPlaceholder","removeDecoration","ModelDecorationOptions","stickiness","_template","_options","_templateMerges","_snippets","createEditsAndSnippetsFromSelections","createEditsAndSnippetsFromEdits","snippets","_undoEdits","undoEdits","edit","identifier","initialize","_move","revealRange","isTrivialSnippet","revealPositionInCenterIfOutsideViewport","oneSelection","allPossibleSelections","possibleSelections","computePossibleSelections","array","adjustIndentation","adjustNewlines","snippetTextString","prevChar","newValue","positionColumnBefore","positionColumnAfter","validateRange","getDirection","languageConfigurationService","workspaceService","IWorkspaceContextService","modelBasedVariableResolver","ILabelService","readClipboardText","firstBeforeText","adjustSelection","firstAfterText","firstLineFirstNonWhitespace","indexedSelections","extensionBefore","extensionAfter","snippetSelection","setStartPosition","setEndPosition","parse","snippetLineLeadingWhitespace","resolveVariables","major","minor","_isTracked","snippetEdits","parser","lastRange","textRange","textNode","snippetText","snippetFragmentText"],"sourceRoot":""}