{"version":3,"file":"static/js/monaco-editor-vendor.1b18e904.b5bdb0fa.js","mappings":"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","sources":["../node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/browser/fontZoom.js","../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/format.js","../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formatActions.js","../node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formattingEdit.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/markerNavigationService.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoErrorWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoError.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/symbolNavigation.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToCommands.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToSymbol.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesTree.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesController.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/referencesModel.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorZoom } from '../../../common/config/editorZoom.js';\nimport * as nls from '../../../../nls.js';\nclass EditorFontZoomIn extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomIn',\n            label: nls.localize('EditorFontZoomIn.label', \"Editor Font Zoom In\"),\n            alias: 'Editor Font Zoom In',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() + 1);\n    }\n}\nclass EditorFontZoomOut extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomOut',\n            label: nls.localize('EditorFontZoomOut.label', \"Editor Font Zoom Out\"),\n            alias: 'Editor Font Zoom Out',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() - 1);\n    }\n}\nclass EditorFontZoomReset extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomReset',\n            label: nls.localize('EditorFontZoomReset.label', \"Editor Font Zoom Reset\"),\n            alias: 'Editor Font Zoom Reset',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(0);\n    }\n}\nregisterEditorAction(EditorFontZoomIn);\nregisterEditorAction(EditorFontZoomOut);\nregisterEditorAction(EditorFontZoomReset);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { asArray, isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource, TextModelCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ExtensionIdentifier } from '../../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nexport function alertFormattingEdits(edits) {\n    edits = edits.filter(edit => edit.range);\n    if (!edits.length) {\n        return;\n    }\n    let { range } = edits[0];\n    for (let i = 1; i < edits.length; i++) {\n        range = Range.plusRange(range, edits[i].range);\n    }\n    const { startLineNumber, endLineNumber } = range;\n    if (startLineNumber === endLineNumber) {\n        if (edits.length === 1) {\n            alert(nls.localize('hint11', \"Made 1 formatting edit on line {0}\", startLineNumber));\n        }\n        else {\n            alert(nls.localize('hintn1', \"Made {0} formatting edits on line {1}\", edits.length, startLineNumber));\n        }\n    }\n    else {\n        if (edits.length === 1) {\n            alert(nls.localize('hint1n', \"Made 1 formatting edit between lines {0} and {1}\", startLineNumber, endLineNumber));\n        }\n        else {\n            alert(nls.localize('hintnn', \"Made {0} formatting edits between lines {1} and {2}\", edits.length, startLineNumber, endLineNumber));\n        }\n    }\n}\nexport function getRealAndSyntheticDocumentFormattersOrdered(documentFormattingEditProvider, documentRangeFormattingEditProvider, model) {\n    const result = [];\n    const seen = new Set();\n    // (1) add all document formatter\n    const docFormatter = documentFormattingEditProvider.ordered(model);\n    for (const formatter of docFormatter) {\n        result.push(formatter);\n        if (formatter.extensionId) {\n            seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\n        }\n    }\n    // (2) add all range formatter as document formatter (unless the same extension already did that)\n    const rangeFormatter = documentRangeFormattingEditProvider.ordered(model);\n    for (const formatter of rangeFormatter) {\n        if (formatter.extensionId) {\n            if (seen.has(ExtensionIdentifier.toKey(formatter.extensionId))) {\n                continue;\n            }\n            seen.add(ExtensionIdentifier.toKey(formatter.extensionId));\n        }\n        result.push({\n            displayName: formatter.displayName,\n            extensionId: formatter.extensionId,\n            provideDocumentFormattingEdits(model, options, token) {\n                return formatter.provideDocumentRangeFormattingEdits(model, model.getFullModelRange(), options, token);\n            }\n        });\n    }\n    return result;\n}\nexport class FormattingConflicts {\n    static setFormatterSelector(selector) {\n        const remove = FormattingConflicts._selectors.unshift(selector);\n        return { dispose: remove };\n    }\n    static select(formatter, document, mode) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (formatter.length === 0) {\n                return undefined;\n            }\n            const selector = Iterable.first(FormattingConflicts._selectors);\n            if (selector) {\n                return yield selector(formatter, document, mode);\n            }\n            return undefined;\n        });\n    }\n}\nFormattingConflicts._selectors = new LinkedList();\nexport function formatDocumentRangesWithSelectedProvider(accessor, editorOrModel, rangeOrRanges, mode, progress, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const instaService = accessor.get(IInstantiationService);\n        const { documentRangeFormattingEditProvider: documentRangeFormattingEditProviderRegistry } = accessor.get(ILanguageFeaturesService);\n        const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n        const provider = documentRangeFormattingEditProviderRegistry.ordered(model);\n        const selected = yield FormattingConflicts.select(provider, model, mode);\n        if (selected) {\n            progress.report(selected);\n            yield instaService.invokeFunction(formatDocumentRangesWithProvider, selected, editorOrModel, rangeOrRanges, token);\n        }\n    });\n}\nexport function formatDocumentRangesWithProvider(accessor, provider, editorOrModel, rangeOrRanges, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const workerService = accessor.get(IEditorWorkerService);\n        let model;\n        let cts;\n        if (isCodeEditor(editorOrModel)) {\n            model = editorOrModel.getModel();\n            cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n        }\n        else {\n            model = editorOrModel;\n            cts = new TextModelCancellationTokenSource(editorOrModel, token);\n        }\n        // make sure that ranges don't overlap nor touch each other\n        const ranges = [];\n        let len = 0;\n        for (const range of asArray(rangeOrRanges).sort(Range.compareRangesUsingStarts)) {\n            if (len > 0 && Range.areIntersectingOrTouching(ranges[len - 1], range)) {\n                ranges[len - 1] = Range.fromPositions(ranges[len - 1].getStartPosition(), range.getEndPosition());\n            }\n            else {\n                len = ranges.push(range);\n            }\n        }\n        const computeEdits = (range) => __awaiter(this, void 0, void 0, function* () {\n            return (yield provider.provideDocumentRangeFormattingEdits(model, range, model.getFormattingOptions(), cts.token)) || [];\n        });\n        const hasIntersectingEdit = (a, b) => {\n            if (!a.length || !b.length) {\n                return false;\n            }\n            // quick exit if the list of ranges are completely unrelated [O(n)]\n            const mergedA = a.reduce((acc, val) => { return Range.plusRange(acc, val.range); }, a[0].range);\n            if (!b.some(x => { return Range.intersectRanges(mergedA, x.range); })) {\n                return false;\n            }\n            // fallback to a complete check [O(n^2)]\n            for (const edit of a) {\n                for (const otherEdit of b) {\n                    if (Range.intersectRanges(edit.range, otherEdit.range)) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        };\n        const allEdits = [];\n        const rawEditsList = [];\n        try {\n            for (const range of ranges) {\n                if (cts.token.isCancellationRequested) {\n                    return true;\n                }\n                rawEditsList.push(yield computeEdits(range));\n            }\n            for (let i = 0; i < ranges.length; ++i) {\n                for (let j = i + 1; j < ranges.length; ++j) {\n                    if (cts.token.isCancellationRequested) {\n                        return true;\n                    }\n                    if (hasIntersectingEdit(rawEditsList[i], rawEditsList[j])) {\n                        // Merge ranges i and j into a single range, recompute the associated edits\n                        const mergedRange = Range.plusRange(ranges[i], ranges[j]);\n                        const edits = yield computeEdits(mergedRange);\n                        ranges.splice(j, 1);\n                        ranges.splice(i, 1);\n                        ranges.push(mergedRange);\n                        rawEditsList.splice(j, 1);\n                        rawEditsList.splice(i, 1);\n                        rawEditsList.push(edits);\n                        // Restart scanning\n                        i = 0;\n                        j = 0;\n                    }\n                }\n            }\n            for (const rawEdits of rawEditsList) {\n                if (cts.token.isCancellationRequested) {\n                    return true;\n                }\n                const minimalEdits = yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n                if (minimalEdits) {\n                    allEdits.push(...minimalEdits);\n                }\n            }\n        }\n        finally {\n            cts.dispose();\n        }\n        if (allEdits.length === 0) {\n            return false;\n        }\n        if (isCodeEditor(editorOrModel)) {\n            // use editor to apply edits\n            FormattingEdit.execute(editorOrModel, allEdits, true);\n            alertFormattingEdits(allEdits);\n            editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n        }\n        else {\n            // use model to apply edits\n            const [{ range }] = allEdits;\n            const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n            model.pushEditOperations([initialSelection], allEdits.map(edit => {\n                return {\n                    text: edit.text,\n                    range: Range.lift(edit.range),\n                    forceMoveMarkers: true\n                };\n            }), undoEdits => {\n                for (const { range } of undoEdits) {\n                    if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                        return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                    }\n                }\n                return null;\n            });\n        }\n        return true;\n    });\n}\nexport function formatDocumentWithSelectedProvider(accessor, editorOrModel, mode, progress, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const instaService = accessor.get(IInstantiationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n        const provider = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n        const selected = yield FormattingConflicts.select(provider, model, mode);\n        if (selected) {\n            progress.report(selected);\n            yield instaService.invokeFunction(formatDocumentWithProvider, selected, editorOrModel, mode, token);\n        }\n    });\n}\nexport function formatDocumentWithProvider(accessor, provider, editorOrModel, mode, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const workerService = accessor.get(IEditorWorkerService);\n        let model;\n        let cts;\n        if (isCodeEditor(editorOrModel)) {\n            model = editorOrModel.getModel();\n            cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n        }\n        else {\n            model = editorOrModel;\n            cts = new TextModelCancellationTokenSource(editorOrModel, token);\n        }\n        let edits;\n        try {\n            const rawEdits = yield provider.provideDocumentFormattingEdits(model, model.getFormattingOptions(), cts.token);\n            edits = yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            if (cts.token.isCancellationRequested) {\n                return true;\n            }\n        }\n        finally {\n            cts.dispose();\n        }\n        if (!edits || edits.length === 0) {\n            return false;\n        }\n        if (isCodeEditor(editorOrModel)) {\n            // use editor to apply edits\n            FormattingEdit.execute(editorOrModel, edits, mode !== 2 /* FormattingMode.Silent */);\n            if (mode !== 2 /* FormattingMode.Silent */) {\n                alertFormattingEdits(edits);\n                editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n            }\n        }\n        else {\n            // use model to apply edits\n            const [{ range }] = edits;\n            const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n            model.pushEditOperations([initialSelection], edits.map(edit => {\n                return {\n                    text: edit.text,\n                    range: Range.lift(edit.range),\n                    forceMoveMarkers: true\n                };\n            }), undoEdits => {\n                for (const { range } of undoEdits) {\n                    if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                        return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                    }\n                }\n                return null;\n            });\n        }\n        return true;\n    });\n}\nexport function getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, model, range, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = languageFeaturesService.documentRangeFormattingEditProvider.ordered(model);\n        for (const provider of providers) {\n            const rawEdits = yield Promise.resolve(provider.provideDocumentRangeFormattingEdits(model, range, options, token)).catch(onUnexpectedExternalError);\n            if (isNonEmptyArray(rawEdits)) {\n                return yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            }\n        }\n        return undefined;\n    });\n}\nexport function getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, model, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n        for (const provider of providers) {\n            const rawEdits = yield Promise.resolve(provider.provideDocumentFormattingEdits(model, options, token)).catch(onUnexpectedExternalError);\n            if (isNonEmptyArray(rawEdits)) {\n                return yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            }\n        }\n        return undefined;\n    });\n}\nexport function getOnTypeFormattingEdits(workerService, languageFeaturesService, model, position, ch, options, token) {\n    const providers = languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n    if (providers.length === 0) {\n        return Promise.resolve(undefined);\n    }\n    if (providers[0].autoFormatTriggerCharacters.indexOf(ch) < 0) {\n        return Promise.resolve(undefined);\n    }\n    return Promise.resolve(providers[0].provideOnTypeFormattingEdits(model, position, ch, options, token)).catch(onUnexpectedExternalError).then(edits => {\n        return workerService.computeMoreMinimalEdits(model.uri, edits);\n    });\n}\nCommandsRegistry.registerCommand('_executeFormatRangeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, range, options] = args;\n        assertType(URI.isUri(resource));\n        assertType(Range.isIRange(range));\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, Range.lift(range), options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\nCommandsRegistry.registerCommand('_executeFormatDocumentProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, options] = args;\n        assertType(URI.isUri(resource));\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\nCommandsRegistry.registerCommand('_executeFormatOnTypeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, position, ch, options] = args;\n        assertType(URI.isUri(resource));\n        assertType(Position.isIPosition(position));\n        assertType(typeof ch === 'string');\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getOnTypeFormattingEdits(workerService, languageFeaturesService, reference.object.textEditorModel, Position.lift(position), ch, options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { alertFormattingEdits, formatDocumentRangesWithSelectedProvider, formatDocumentWithSelectedProvider, getOnTypeFormattingEdits } from './format.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditorProgressService, Progress } from '../../../../platform/progress/common/progress.js';\nlet FormatOnType = class FormatOnType {\n    constructor(_editor, _languageFeaturesService, _workerService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._workerService = _workerService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._disposables.add(_languageFeaturesService.onTypeFormattingEditProvider.onDidChange(this._update, this));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(51 /* EditorOption.formatOnType */)) {\n                this._update();\n            }\n        }));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._sessionDisposables.dispose();\n    }\n    _update() {\n        // clean up\n        this._sessionDisposables.clear();\n        // we are disabled\n        if (!this._editor.getOption(51 /* EditorOption.formatOnType */)) {\n            return;\n        }\n        // no model\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        // no support\n        const [support] = this._languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n        if (!support || !support.autoFormatTriggerCharacters) {\n            return;\n        }\n        // register typing listeners that will trigger the format\n        const triggerChars = new CharacterSet();\n        for (const ch of support.autoFormatTriggerCharacters) {\n            triggerChars.add(ch.charCodeAt(0));\n        }\n        this._sessionDisposables.add(this._editor.onDidType((text) => {\n            const lastCharCode = text.charCodeAt(text.length - 1);\n            if (triggerChars.has(lastCharCode)) {\n                this._trigger(String.fromCharCode(lastCharCode));\n            }\n        }));\n    }\n    _trigger(ch) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (this._editor.getSelections().length > 1 || !this._editor.getSelection().isEmpty()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const position = this._editor.getPosition();\n        const cts = new CancellationTokenSource();\n        // install a listener that checks if edits happens before the\n        // position on which we format right now. If so, we won't\n        // apply the format edits\n        const unbind = this._editor.onDidChangeModelContent((e) => {\n            if (e.isFlush) {\n                // a model.setValue() was called\n                // cancel only once\n                cts.cancel();\n                unbind.dispose();\n                return;\n            }\n            for (let i = 0, len = e.changes.length; i < len; i++) {\n                const change = e.changes[i];\n                if (change.range.endLineNumber <= position.lineNumber) {\n                    // cancel only once\n                    cts.cancel();\n                    unbind.dispose();\n                    return;\n                }\n            }\n        });\n        getOnTypeFormattingEdits(this._workerService, this._languageFeaturesService, model, position, ch, model.getFormattingOptions(), cts.token).then(edits => {\n            if (cts.token.isCancellationRequested) {\n                return;\n            }\n            if (isNonEmptyArray(edits)) {\n                FormattingEdit.execute(this._editor, edits, true);\n                alertFormattingEdits(edits);\n            }\n        }).finally(() => {\n            unbind.dispose();\n        });\n    }\n};\nFormatOnType.ID = 'editor.contrib.autoFormat';\nFormatOnType = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IEditorWorkerService)\n], FormatOnType);\nlet FormatOnPaste = class FormatOnPaste {\n    constructor(editor, _languageFeaturesService, _instantiationService) {\n        this.editor = editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instantiationService = _instantiationService;\n        this._callOnDispose = new DisposableStore();\n        this._callOnModel = new DisposableStore();\n        this._callOnDispose.add(editor.onDidChangeConfiguration(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModel(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(() => this._update()));\n        this._callOnDispose.add(_languageFeaturesService.documentRangeFormattingEditProvider.onDidChange(this._update, this));\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        this._callOnModel.dispose();\n    }\n    _update() {\n        // clean up\n        this._callOnModel.clear();\n        // we are disabled\n        if (!this.editor.getOption(50 /* EditorOption.formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        // no formatter\n        if (!this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())) {\n            return;\n        }\n        this._callOnModel.add(this.editor.onDidPaste(({ range }) => this._trigger(range)));\n    }\n    _trigger(range) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (this.editor.getSelections().length > 1) {\n            return;\n        }\n        this._instantiationService.invokeFunction(formatDocumentRangesWithSelectedProvider, this.editor, range, 2 /* FormattingMode.Silent */, Progress.None, CancellationToken.None).catch(onUnexpectedError);\n    }\n};\nFormatOnPaste.ID = 'editor.contrib.formatOnPaste';\nFormatOnPaste = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IInstantiationService)\n], FormatOnPaste);\nclass FormatDocumentAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatDocument',\n            label: nls.localize('formatDocument.label', \"Format Document\"),\n            alias: 'Format Document',\n            precondition: ContextKeyExpr.and(EditorContextKeys.notInCompositeEditor, EditorContextKeys.writable, EditorContextKeys.hasDocumentFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 39 /* KeyCode.KeyI */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.3\n            }\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (editor.hasModel()) {\n                const instaService = accessor.get(IInstantiationService);\n                const progressService = accessor.get(IEditorProgressService);\n                yield progressService.showWhile(instaService.invokeFunction(formatDocumentWithSelectedProvider, editor, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None), 250);\n            }\n        });\n    }\n}\nclass FormatSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatSelection',\n            label: nls.localize('formatSelection.label', \"Format Selection\"),\n            alias: 'Format Selection',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentSelectionFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                when: EditorContextKeys.hasNonEmptySelection,\n                group: '1_modification',\n                order: 1.31\n            }\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!editor.hasModel()) {\n                return;\n            }\n            const instaService = accessor.get(IInstantiationService);\n            const model = editor.getModel();\n            const ranges = editor.getSelections().map(range => {\n                return range.isEmpty()\n                    ? new Range(range.startLineNumber, 1, range.startLineNumber, model.getLineMaxColumn(range.startLineNumber))\n                    : range;\n            });\n            const progressService = accessor.get(IEditorProgressService);\n            yield progressService.showWhile(instaService.invokeFunction(formatDocumentRangesWithSelectedProvider, editor, ranges, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None), 250);\n        });\n    }\n}\nregisterEditorContribution(FormatOnType.ID, FormatOnType);\nregisterEditorContribution(FormatOnPaste.ID, FormatOnPaste);\nregisterEditorAction(FormatDocumentAction);\nregisterEditorAction(FormatSelectionAction);\n// this is the old format action that does both (format document OR format selection)\n// and we keep it here such that existing keybinding configurations etc will still work\nCommandsRegistry.registerCommand('editor.action.format', (accessor) => __awaiter(void 0, void 0, void 0, function* () {\n    const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n    if (!editor || !editor.hasModel()) {\n        return;\n    }\n    const commandService = accessor.get(ICommandService);\n    if (editor.getSelection().isEmpty()) {\n        yield commandService.executeCommand('editor.action.formatDocument');\n    }\n    else {\n        yield commandService.executeCommand('editor.action.formatSelection');\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nexport class FormattingEdit {\n    static _handleEolEdits(editor, edits) {\n        let newEol = undefined;\n        const singleEdits = [];\n        for (const edit of edits) {\n            if (typeof edit.eol === 'number') {\n                newEol = edit.eol;\n            }\n            if (edit.range && typeof edit.text === 'string') {\n                singleEdits.push(edit);\n            }\n        }\n        if (typeof newEol === 'number') {\n            if (editor.hasModel()) {\n                editor.getModel().pushEOL(newEol);\n            }\n        }\n        return singleEdits;\n    }\n    static _isFullModelReplaceEdit(editor, edit) {\n        if (!editor.hasModel()) {\n            return false;\n        }\n        const model = editor.getModel();\n        const editRange = model.validateRange(edit.range);\n        const fullModelRange = model.getFullModelRange();\n        return fullModelRange.equalsRange(editRange);\n    }\n    static execute(editor, _edits, addUndoStops) {\n        if (addUndoStops) {\n            editor.pushUndoStop();\n        }\n        const edits = FormattingEdit._handleEolEdits(editor, _edits);\n        if (edits.length === 1 && FormattingEdit._isFullModelReplaceEdit(editor, edits[0])) {\n            // We use replace semantics and hope that markers stay put...\n            editor.executeEdits('formatEditsCommand', edits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text)));\n        }\n        else {\n            editor.executeEdits('formatEditsCommand', edits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n        }\n        if (addUndoStops) {\n            editor.pushUndoStop();\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport class MarkerCoordinate {\n    constructor(marker, index, total) {\n        this.marker = marker;\n        this.index = index;\n        this.total = total;\n    }\n}\nlet MarkerList = class MarkerList {\n    constructor(resourceFilter, _markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._dispoables = new DisposableStore();\n        this._markers = [];\n        this._nextIdx = -1;\n        if (URI.isUri(resourceFilter)) {\n            this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\n        }\n        else if (resourceFilter) {\n            this._resourceFilter = resourceFilter;\n        }\n        const compareOrder = this._configService.getValue('problems.sortOrder');\n        const compareMarker = (a, b) => {\n            let res = compare(a.resource.toString(), b.resource.toString());\n            if (res === 0) {\n                if (compareOrder === 'position') {\n                    res = Range.compareRangesUsingStarts(a, b) || MarkerSeverity.compare(a.severity, b.severity);\n                }\n                else {\n                    res = MarkerSeverity.compare(a.severity, b.severity) || Range.compareRangesUsingStarts(a, b);\n                }\n            }\n            return res;\n        };\n        const updateMarker = () => {\n            this._markers = this._markerService.read({\n                resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\n                severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n            });\n            if (typeof resourceFilter === 'function') {\n                this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\n            }\n            this._markers.sort(compareMarker);\n        };\n        updateMarker();\n        this._dispoables.add(_markerService.onMarkerChanged(uris => {\n            if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\n                updateMarker();\n                this._nextIdx = -1;\n                this._onDidChange.fire();\n            }\n        }));\n    }\n    dispose() {\n        this._dispoables.dispose();\n        this._onDidChange.dispose();\n    }\n    matches(uri) {\n        if (!this._resourceFilter && !uri) {\n            return true;\n        }\n        if (!this._resourceFilter || !uri) {\n            return false;\n        }\n        return this._resourceFilter(uri);\n    }\n    get selected() {\n        const marker = this._markers[this._nextIdx];\n        return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\n    }\n    _initIdx(model, position, fwd) {\n        let found = false;\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\n        if (idx < 0) {\n            idx = binarySearch(this._markers, { resource: model.uri }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\n            if (idx < 0) {\n                idx = ~idx;\n            }\n        }\n        for (let i = idx; i < this._markers.length; i++) {\n            let range = Range.lift(this._markers[i]);\n            if (range.isEmpty()) {\n                const word = model.getWordAtPosition(range.getStartPosition());\n                if (word) {\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n                }\n            }\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n                this._nextIdx = i;\n                found = true;\n                break;\n            }\n            if (this._markers[i].resource.toString() !== model.uri.toString()) {\n                break;\n            }\n        }\n        if (!found) {\n            // after the last change\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\n        }\n        if (this._nextIdx < 0) {\n            this._nextIdx = this._markers.length - 1;\n        }\n    }\n    resetIndex() {\n        this._nextIdx = -1;\n    }\n    move(fwd, model, position) {\n        if (this._markers.length === 0) {\n            return false;\n        }\n        const oldIdx = this._nextIdx;\n        if (this._nextIdx === -1) {\n            this._initIdx(model, position, fwd);\n        }\n        else if (fwd) {\n            this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n        }\n        else if (!fwd) {\n            this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n        }\n        if (oldIdx !== this._nextIdx) {\n            return true;\n        }\n        return false;\n    }\n    find(uri, position) {\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\n        if (idx < 0) {\n            return undefined;\n        }\n        for (; idx < this._markers.length; idx++) {\n            if (Range.containsPosition(this._markers[idx], position)) {\n                return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\n            }\n        }\n        return undefined;\n    }\n};\nMarkerList = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IConfigurationService)\n], MarkerList);\nexport { MarkerList };\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\nlet MarkerNavigationService = class MarkerNavigationService {\n    constructor(_markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._provider = new LinkedList();\n    }\n    getMarkerList(resource) {\n        for (const provider of this._provider) {\n            const result = provider.getMarkerList(resource);\n            if (result) {\n                return result;\n            }\n        }\n        // default\n        return new MarkerList(resource, this._markerService, this._configService);\n    }\n};\nMarkerNavigationService = __decorate([\n    __param(0, IMarkerService),\n    __param(1, IConfigurationService)\n], MarkerNavigationService);\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, true);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { splitLines } from '../../../../base/common/strings.js';\nimport './media/gotoErrorWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { peekViewTitleForeground, peekViewTitleInfoForeground, PeekViewWidget } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { createAndFillInActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { SeverityIcon } from '../../../../platform/severityIcon/common/severityIcon.js';\nimport { contrastBorder, editorBackground, editorErrorBorder, editorErrorForeground, editorInfoBorder, editorInfoForeground, editorWarningBorder, editorWarningForeground, oneOf, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nclass MessageWidget {\n    constructor(parent, editor, onRelatedInformation, _openerService, _labelService) {\n        this._openerService = _openerService;\n        this._labelService = _labelService;\n        this._lines = 0;\n        this._longestLineLength = 0;\n        this._relatedDiagnostics = new WeakMap();\n        this._disposables = new DisposableStore();\n        this._editor = editor;\n        const domNode = document.createElement('div');\n        domNode.className = 'descriptioncontainer';\n        this._messageBlock = document.createElement('div');\n        this._messageBlock.classList.add('message');\n        this._messageBlock.setAttribute('aria-live', 'assertive');\n        this._messageBlock.setAttribute('role', 'alert');\n        domNode.appendChild(this._messageBlock);\n        this._relatedBlock = document.createElement('div');\n        domNode.appendChild(this._relatedBlock);\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', event => {\n            event.preventDefault();\n            const related = this._relatedDiagnostics.get(event.target);\n            if (related) {\n                onRelatedInformation(related);\n            }\n        }));\n        this._scrollable = new ScrollableElement(domNode, {\n            horizontal: 1 /* ScrollbarVisibility.Auto */,\n            vertical: 1 /* ScrollbarVisibility.Auto */,\n            useShadows: false,\n            horizontalScrollbarSize: 6,\n            verticalScrollbarSize: 6\n        });\n        parent.appendChild(this._scrollable.getDomNode());\n        this._disposables.add(this._scrollable.onScroll(e => {\n            domNode.style.left = `-${e.scrollLeft}px`;\n            domNode.style.top = `-${e.scrollTop}px`;\n        }));\n        this._disposables.add(this._scrollable);\n    }\n    dispose() {\n        dispose(this._disposables);\n    }\n    update(marker) {\n        const { source, message, relatedInformation, code } = marker;\n        let sourceAndCodeLength = ((source === null || source === void 0 ? void 0 : source.length) || 0) + '()'.length;\n        if (code) {\n            if (typeof code === 'string') {\n                sourceAndCodeLength += code.length;\n            }\n            else {\n                sourceAndCodeLength += code.value.length;\n            }\n        }\n        const lines = splitLines(message);\n        this._lines = lines.length;\n        this._longestLineLength = 0;\n        for (const line of lines) {\n            this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\n        }\n        dom.clearNode(this._messageBlock);\n        this._messageBlock.setAttribute('aria-label', this.getAriaLabel(marker));\n        this._editor.applyFontInfo(this._messageBlock);\n        let lastLineElement = this._messageBlock;\n        for (const line of lines) {\n            lastLineElement = document.createElement('div');\n            lastLineElement.innerText = line;\n            if (line === '') {\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\n            }\n            this._messageBlock.appendChild(lastLineElement);\n        }\n        if (source || code) {\n            const detailsElement = document.createElement('span');\n            detailsElement.classList.add('details');\n            lastLineElement.appendChild(detailsElement);\n            if (source) {\n                const sourceElement = document.createElement('span');\n                sourceElement.innerText = source;\n                sourceElement.classList.add('source');\n                detailsElement.appendChild(sourceElement);\n            }\n            if (code) {\n                if (typeof code === 'string') {\n                    const codeElement = document.createElement('span');\n                    codeElement.innerText = `(${code})`;\n                    codeElement.classList.add('code');\n                    detailsElement.appendChild(codeElement);\n                }\n                else {\n                    this._codeLink = dom.$('a.code-link');\n                    this._codeLink.setAttribute('href', `${code.target.toString()}`);\n                    this._codeLink.onclick = (e) => {\n                        this._openerService.open(code.target, { allowCommands: true });\n                        e.preventDefault();\n                        e.stopPropagation();\n                    };\n                    const codeElement = dom.append(this._codeLink, dom.$('span'));\n                    codeElement.innerText = code.value;\n                    detailsElement.appendChild(this._codeLink);\n                }\n            }\n        }\n        dom.clearNode(this._relatedBlock);\n        this._editor.applyFontInfo(this._relatedBlock);\n        if (isNonEmptyArray(relatedInformation)) {\n            const relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\n            relatedInformationNode.style.paddingTop = `${Math.floor(this._editor.getOption(61 /* EditorOption.lineHeight */) * 0.66)}px`;\n            this._lines += 1;\n            for (const related of relatedInformation) {\n                const container = document.createElement('div');\n                const relatedResource = document.createElement('a');\n                relatedResource.classList.add('filename');\n                relatedResource.innerText = `${this._labelService.getUriBasenameLabel(related.resource)}(${related.startLineNumber}, ${related.startColumn}): `;\n                relatedResource.title = this._labelService.getUriLabel(related.resource);\n                this._relatedDiagnostics.set(relatedResource, related);\n                const relatedMessage = document.createElement('span');\n                relatedMessage.innerText = related.message;\n                container.appendChild(relatedResource);\n                container.appendChild(relatedMessage);\n                this._lines += 1;\n                relatedInformationNode.appendChild(container);\n            }\n        }\n        const fontInfo = this._editor.getOption(46 /* EditorOption.fontInfo */);\n        const scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\n        const scrollHeight = fontInfo.lineHeight * this._lines;\n        this._scrollable.setScrollDimensions({ scrollWidth, scrollHeight });\n    }\n    layout(height, width) {\n        this._scrollable.getDomNode().style.height = `${height}px`;\n        this._scrollable.getDomNode().style.width = `${width}px`;\n        this._scrollable.setScrollDimensions({ width, height });\n    }\n    getHeightInLines() {\n        return Math.min(17, this._lines);\n    }\n    getAriaLabel(marker) {\n        let severityLabel = '';\n        switch (marker.severity) {\n            case MarkerSeverity.Error:\n                severityLabel = nls.localize('Error', \"Error\");\n                break;\n            case MarkerSeverity.Warning:\n                severityLabel = nls.localize('Warning', \"Warning\");\n                break;\n            case MarkerSeverity.Info:\n                severityLabel = nls.localize('Info', \"Info\");\n                break;\n            case MarkerSeverity.Hint:\n                severityLabel = nls.localize('Hint', \"Hint\");\n                break;\n        }\n        let ariaLabel = nls.localize('marker aria', \"{0} at {1}. \", severityLabel, marker.startLineNumber + ':' + marker.startColumn);\n        const model = this._editor.getModel();\n        if (model && (marker.startLineNumber <= model.getLineCount()) && (marker.startLineNumber >= 1)) {\n            const lineContent = model.getLineContent(marker.startLineNumber);\n            ariaLabel = `${lineContent}, ${ariaLabel}`;\n        }\n        return ariaLabel;\n    }\n}\nlet MarkerNavigationWidget = class MarkerNavigationWidget extends PeekViewWidget {\n    constructor(editor, _themeService, _openerService, _menuService, instantiationService, _contextKeyService, _labelService) {\n        super(editor, { showArrow: true, showFrame: true, isAccessible: true, frameWidth: 1 }, instantiationService);\n        this._themeService = _themeService;\n        this._openerService = _openerService;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._labelService = _labelService;\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectRelatedInformation = new Emitter();\n        this.onDidSelectRelatedInformation = this._onDidSelectRelatedInformation.event;\n        this._severity = MarkerSeverity.Warning;\n        this._backgroundColor = Color.white;\n        this._applyTheme(_themeService.getColorTheme());\n        this._callOnDispose.add(_themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this.create();\n    }\n    _applyTheme(theme) {\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\n        let colorId = editorMarkerNavigationError;\n        let headerBackground = editorMarkerNavigationErrorHeader;\n        if (this._severity === MarkerSeverity.Warning) {\n            colorId = editorMarkerNavigationWarning;\n            headerBackground = editorMarkerNavigationWarningHeader;\n        }\n        else if (this._severity === MarkerSeverity.Info) {\n            colorId = editorMarkerNavigationInfo;\n            headerBackground = editorMarkerNavigationInfoHeader;\n        }\n        const frameColor = theme.getColor(colorId);\n        const headerBg = theme.getColor(headerBackground);\n        this.style({\n            arrowColor: frameColor,\n            frameColor: frameColor,\n            headerBackgroundColor: headerBg,\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\n        }); // style() will trigger _applyStyles\n    }\n    _applyStyles() {\n        if (this._parentContainer) {\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\n        }\n        super._applyStyles();\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        super.dispose();\n    }\n    _fillHead(container) {\n        super._fillHead(container);\n        this._disposables.add(this._actionbarWidget.actionRunner.onBeforeRun(e => this.editor.focus()));\n        const actions = [];\n        const menu = this._menuService.createMenu(MarkerNavigationWidget.TitleMenu, this._contextKeyService);\n        createAndFillInActionBarActions(menu, undefined, actions);\n        this._actionbarWidget.push(actions, { label: false, icon: true, index: 0 });\n        menu.dispose();\n    }\n    _fillTitleIcon(container) {\n        this._icon = dom.append(container, dom.$(''));\n    }\n    _fillBody(container) {\n        this._parentContainer = container;\n        container.classList.add('marker-widget');\n        this._parentContainer.tabIndex = 0;\n        this._parentContainer.setAttribute('role', 'tooltip');\n        this._container = document.createElement('div');\n        container.appendChild(this._container);\n        this._message = new MessageWidget(this._container, this.editor, related => this._onDidSelectRelatedInformation.fire(related), this._openerService, this._labelService);\n        this._disposables.add(this._message);\n    }\n    show() {\n        throw new Error('call showAtMarker');\n    }\n    showAtMarker(marker, markerIdx, markerCount) {\n        // update:\n        // * title\n        // * message\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n        // update frame color (only applied on 'show')\n        this._severity = marker.severity;\n        this._applyTheme(this._themeService.getColorTheme());\n        // show\n        const range = Range.lift(marker);\n        const editorPosition = this.editor.getPosition();\n        const position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\n        super.show(position, this.computeRequiredHeight());\n        const model = this.editor.getModel();\n        if (model) {\n            const detail = markerCount > 1\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\n            this.setTitle(basename(model.uri), detail);\n        }\n        this._icon.className = `codicon ${SeverityIcon.className(MarkerSeverity.toSeverity(this._severity))}`;\n        this.editor.revealPositionNearTop(position, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    updateMarker(marker) {\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n    }\n    showStale() {\n        this._container.classList.add('stale');\n        this._relayout();\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._heightInPixel = heightInPixel;\n        this._message.layout(heightInPixel, widthInPixel);\n        this._container.style.height = `${heightInPixel}px`;\n    }\n    _onWidth(widthInPixel) {\n        this._message.layout(this._heightInPixel, widthInPixel);\n    }\n    _relayout() {\n        super._relayout(this.computeRequiredHeight());\n    }\n    computeRequiredHeight() {\n        return 3 + this._message.getHeightInLines();\n    }\n};\nMarkerNavigationWidget.TitleMenu = new MenuId('gotoErrorTitleMenu');\nMarkerNavigationWidget = __decorate([\n    __param(1, IThemeService),\n    __param(2, IOpenerService),\n    __param(3, IMenuService),\n    __param(4, IInstantiationService),\n    __param(5, IContextKeyService),\n    __param(6, ILabelService)\n], MarkerNavigationWidget);\nexport { MarkerNavigationWidget };\n// theming\nconst errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\nconst warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\nconst infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\nexport const editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\nexport const editorMarkerNavigationErrorHeader = registerColor('editorMarkerNavigationError.headerBackground', { dark: transparent(editorMarkerNavigationError, .1), light: transparent(editorMarkerNavigationError, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationErrorHeaderBackground', 'Editor marker navigation widget error heading background.'));\nexport const editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\nexport const editorMarkerNavigationWarningHeader = registerColor('editorMarkerNavigationWarning.headerBackground', { dark: transparent(editorMarkerNavigationWarning, .1), light: transparent(editorMarkerNavigationWarning, .1), hcDark: '#0C141F', hcLight: transparent(editorMarkerNavigationWarning, .2) }, nls.localize('editorMarkerNavigationWarningBackground', 'Editor marker navigation widget warning heading background.'));\nexport const editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\nexport const editorMarkerNavigationInfoHeader = registerColor('editorMarkerNavigationInfo.headerBackground', { dark: transparent(editorMarkerNavigationInfo, .1), light: transparent(editorMarkerNavigationInfo, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationInfoHeaderBackground', 'Editor marker navigation widget info heading background.'));\nexport const editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', { dark: editorBackground, light: editorBackground, hcDark: editorBackground, hcLight: editorBackground }, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IMarkerNavigationService } from './markerNavigationService.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\nlet MarkerController = class MarkerController {\n    constructor(editor, _markerNavigationService, _contextKeyService, _editorService, _instantiationService) {\n        this._markerNavigationService = _markerNavigationService;\n        this._contextKeyService = _contextKeyService;\n        this._editorService = _editorService;\n        this._instantiationService = _instantiationService;\n        this._sessionDispoables = new DisposableStore();\n        this._editor = editor;\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\n    }\n    static get(editor) {\n        return editor.getContribution(MarkerController.ID);\n    }\n    dispose() {\n        this._cleanUp();\n        this._sessionDispoables.dispose();\n    }\n    _cleanUp() {\n        this._widgetVisible.reset();\n        this._sessionDispoables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    _getOrCreateModel(uri) {\n        if (this._model && this._model.matches(uri)) {\n            return this._model;\n        }\n        let reusePosition = false;\n        if (this._model) {\n            reusePosition = true;\n            this._cleanUp();\n        }\n        this._model = this._markerNavigationService.getMarkerList(uri);\n        if (reusePosition) {\n            this._model.move(true, this._editor.getModel(), this._editor.getPosition());\n        }\n        this._widget = this._instantiationService.createInstance(MarkerNavigationWidget, this._editor);\n        this._widget.onDidClose(() => this.close(), this, this._sessionDispoables);\n        this._widgetVisible.set(true);\n        this._sessionDispoables.add(this._model);\n        this._sessionDispoables.add(this._widget);\n        // follow cursor\n        this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(e => {\n            var _a, _b, _c;\n            if (!((_a = this._model) === null || _a === void 0 ? void 0 : _a.selected) || !Range.containsPosition((_b = this._model) === null || _b === void 0 ? void 0 : _b.selected.marker, e.position)) {\n                (_c = this._model) === null || _c === void 0 ? void 0 : _c.resetIndex();\n            }\n        }));\n        // update markers\n        this._sessionDispoables.add(this._model.onDidChange(() => {\n            if (!this._widget || !this._widget.position || !this._model) {\n                return;\n            }\n            const info = this._model.find(this._editor.getModel().uri, this._widget.position);\n            if (info) {\n                this._widget.updateMarker(info.marker);\n            }\n            else {\n                this._widget.showStale();\n            }\n        }));\n        // open related\n        this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(related => {\n            this._editorService.openCodeEditor({\n                resource: related.resource,\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\n            }, this._editor);\n            this.close(false);\n        }));\n        this._sessionDispoables.add(this._editor.onDidChangeModel(() => this._cleanUp()));\n        return this._model;\n    }\n    close(focusEditor = true) {\n        this._cleanUp();\n        if (focusEditor) {\n            this._editor.focus();\n        }\n    }\n    showAtMarker(marker) {\n        if (this._editor.hasModel()) {\n            const model = this._getOrCreateModel(this._editor.getModel().uri);\n            model.resetIndex();\n            model.move(true, this._editor.getModel(), new Position(marker.startLineNumber, marker.startColumn));\n            if (model.selected) {\n                this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n            }\n        }\n    }\n    nagivate(next, multiFile) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._editor.hasModel()) {\n                const model = this._getOrCreateModel(multiFile ? undefined : this._editor.getModel().uri);\n                model.move(next, this._editor.getModel(), this._editor.getPosition());\n                if (!model.selected) {\n                    return;\n                }\n                if (model.selected.marker.resource.toString() !== this._editor.getModel().uri.toString()) {\n                    // show in different editor\n                    this._cleanUp();\n                    const otherEditor = yield this._editorService.openCodeEditor({\n                        resource: model.selected.marker.resource,\n                        options: { pinned: false, revealIfOpened: true, selectionRevealType: 2 /* TextEditorSelectionRevealType.NearTop */, selection: model.selected.marker }\n                    }, this._editor);\n                    if (otherEditor) {\n                        (_a = MarkerController.get(otherEditor)) === null || _a === void 0 ? void 0 : _a.close();\n                        (_b = MarkerController.get(otherEditor)) === null || _b === void 0 ? void 0 : _b.nagivate(next, multiFile);\n                    }\n                }\n                else {\n                    // show in this editor\n                    this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n                }\n            }\n        });\n    }\n};\nMarkerController.ID = 'editor.contrib.markerController';\nMarkerController = __decorate([\n    __param(1, IMarkerNavigationService),\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, IInstantiationService)\n], MarkerController);\nexport { MarkerController };\nclass MarkerNavigationAction extends EditorAction {\n    constructor(_next, _multiFile, opts) {\n        super(opts);\n        this._next = _next;\n        this._multiFile = _multiFile;\n    }\n    run(_accessor, editor) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (editor.hasModel()) {\n                (_a = MarkerController.get(editor)) === null || _a === void 0 ? void 0 : _a.nagivate(this._next, this._multiFile);\n            }\n        });\n    }\n}\nexport class NextMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, false, {\n            id: NextMarkerAction.ID,\n            label: NextMarkerAction.LABEL,\n            alias: 'Go to Next Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: NextMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-next', Codicon.arrowDown, nls.localize('nextMarkerIcon', 'Icon for goto next marker.')),\n                group: 'navigation',\n                order: 1\n            }\n        });\n    }\n}\nNextMarkerAction.ID = 'editor.action.marker.next';\nNextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\nclass PrevMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, false, {\n            id: PrevMarkerAction.ID,\n            label: PrevMarkerAction.LABEL,\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: PrevMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-previous', Codicon.arrowUp, nls.localize('previousMarkerIcon', 'Icon for goto previous marker.')),\n                group: 'navigation',\n                order: 2\n            }\n        });\n    }\n}\nPrevMarkerAction.ID = 'editor.action.marker.prev';\nPrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\nclass NextMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, true, {\n            id: 'editor.action.marker.nextInFiles',\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\"),\n                group: '6_problem_nav',\n                order: 1\n            }\n        });\n    }\n}\nclass PrevMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, true, {\n            id: 'editor.action.marker.prevInFiles',\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\"),\n                group: '6_problem_nav',\n                order: 2\n            }\n        });\n    }\n}\nregisterEditorContribution(MarkerController.ID, MarkerController);\nregisterEditorAction(NextMarkerAction);\nregisterEditorAction(PrevMarkerAction);\nregisterEditorAction(NextMarkerInFilesAction);\nregisterEditorAction(PrevMarkerInFilesAction);\nconst CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\nconst MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\nregisterEditorCommand(new MarkerCommand({\n    id: 'closeMarkersNavigation',\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\n    handler: x => x.close(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 50,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { combinedDisposable, DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nexport const ctxHasSymbols = new RawContextKey('hasSymbols', false, localize('hasSymbols', \"Whether there are symbol locations that can be navigated via keyboard-only.\"));\nexport const ISymbolNavigationService = createDecorator('ISymbolNavigationService');\nlet SymbolNavigationService = class SymbolNavigationService {\n    constructor(contextKeyService, _editorService, _notificationService, _keybindingService) {\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._keybindingService = _keybindingService;\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n        this._ignoreEditorChange = false;\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\n    }\n    reset() {\n        var _a, _b;\n        this._ctxHasSymbols.reset();\n        (_a = this._currentState) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentMessage) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n    }\n    put(anchor) {\n        const refModel = anchor.parent.parent;\n        if (refModel.references.length <= 1) {\n            this.reset();\n            return;\n        }\n        this._currentModel = refModel;\n        this._currentIdx = refModel.references.indexOf(anchor);\n        this._ctxHasSymbols.set(true);\n        this._showMessage();\n        const editorState = new EditorState(this._editorService);\n        const listener = editorState.onDidChange(_ => {\n            if (this._ignoreEditorChange) {\n                return;\n            }\n            const editor = this._editorService.getActiveCodeEditor();\n            if (!editor) {\n                return;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!model || !position) {\n                return;\n            }\n            let seenUri = false;\n            let seenPosition = false;\n            for (const reference of refModel.references) {\n                if (isEqual(reference.uri, model.uri)) {\n                    seenUri = true;\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\n                }\n                else if (seenUri) {\n                    break;\n                }\n            }\n            if (!seenUri || !seenPosition) {\n                this.reset();\n            }\n        });\n        this._currentState = combinedDisposable(editorState, listener);\n    }\n    revealNext(source) {\n        if (!this._currentModel) {\n            return Promise.resolve();\n        }\n        // get next result and advance\n        this._currentIdx += 1;\n        this._currentIdx %= this._currentModel.references.length;\n        const reference = this._currentModel.references[this._currentIdx];\n        // status\n        this._showMessage();\n        // open editor, ignore events while that happens\n        this._ignoreEditorChange = true;\n        return this._editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(reference.range),\n                selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */\n            }\n        }, source).finally(() => {\n            this._ignoreEditorChange = false;\n        });\n    }\n    _showMessage() {\n        var _a;\n        (_a = this._currentMessage) === null || _a === void 0 ? void 0 : _a.dispose();\n        const kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\n        const message = kb\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\n        this._currentMessage = this._notificationService.status(message);\n    }\n};\nSymbolNavigationService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ICodeEditorService),\n    __param(2, INotificationService),\n    __param(3, IKeybindingService)\n], SymbolNavigationService);\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, true);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.gotoNextSymbolFromResult',\n            precondition: ctxHasSymbols,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 70 /* KeyCode.F12 */\n            }\n        });\n    }\n    runEditorCommand(accessor, editor) {\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'editor.gotoNextSymbolFromResult.cancel',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    when: ctxHasSymbols,\n    primary: 9 /* KeyCode.Escape */,\n    handler(accessor) {\n        accessor.get(ISymbolNavigationService).reset();\n    }\n});\n//\nlet EditorState = class EditorState {\n    constructor(editorService) {\n        this._listener = new Map();\n        this._disposables = new DisposableStore();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._onDidChange.dispose();\n        dispose(this._listener.values());\n    }\n    _onDidAddEditor(editor) {\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(_ => this._onDidChange.fire({ editor })), editor.onDidChangeModelContent(_ => this._onDidChange.fire({ editor }))));\n    }\n    _onDidRemoveEditor(editor) {\n        var _a;\n        (_a = this._listener.get(editor)) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._listener.delete(editor);\n    }\n};\nEditorState = __decorate([\n    __param(0, ICodeEditorService)\n], EditorState);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar _a, _b, _c, _d, _e, _f, _g, _h;\nimport { isStandalone } from '../../../../base/browser/browser.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { isWeb } from '../../../../base/common/platform.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction, registerInstantiatedEditorAction } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport * as corePosition from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { isLocationLink } from '../../../common/languages.js';\nimport { ReferencesController } from './peek/referencesController.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ISymbolNavigationService } from './symbolNavigation.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { getDeclarationsAtPosition, getDefinitionsAtPosition, getImplementationsAtPosition, getReferencesAtPosition, getTypeDefinitionsAtPosition } from './goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\n    submenu: MenuId.EditorContextPeek,\n    title: nls.localize('peek.submenu', \"Peek\"),\n    group: 'navigation',\n    order: 100\n});\nconst _goToActionIds = new Set();\nfunction registerGoToAction(ctor) {\n    const result = new ctor();\n    registerInstantiatedEditorAction(result);\n    _goToActionIds.add(result.id);\n    return result;\n}\nexport class SymbolNavigationAnchor {\n    constructor(model, position) {\n        this.model = model;\n        this.position = position;\n    }\n    static is(thing) {\n        if (!thing || typeof thing !== 'object') {\n            return false;\n        }\n        if (thing instanceof SymbolNavigationAnchor) {\n            return true;\n        }\n        if (corePosition.Position.isIPosition(thing.position) && thing.model) {\n            return true;\n        }\n        return false;\n    }\n}\nexport class SymbolNavigationAction extends EditorAction {\n    constructor(configuration, opts) {\n        super(opts);\n        this.configuration = configuration;\n    }\n    run(accessor, editor, arg) {\n        if (!editor.hasModel()) {\n            return Promise.resolve(undefined);\n        }\n        const notificationService = accessor.get(INotificationService);\n        const editorService = accessor.get(ICodeEditorService);\n        const progressService = accessor.get(IEditorProgressService);\n        const symbolNavService = accessor.get(ISymbolNavigationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const model = editor.getModel();\n        const position = editor.getPosition();\n        const anchor = SymbolNavigationAnchor.is(arg) ? arg : new SymbolNavigationAnchor(model, position);\n        const cts = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */);\n        const promise = raceCancellation(this._getLocationModel(languageFeaturesService, anchor.model, anchor.position, cts.token), cts.token).then((references) => __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (!references || cts.token.isCancellationRequested) {\n                return;\n            }\n            alert(references.ariaMessage);\n            let altAction;\n            if (references.referenceAt(model.uri, position)) {\n                const altActionId = this._getAlternativeCommand(editor);\n                if (!SymbolNavigationAction._activeAlternativeCommands.has(altActionId) && _goToActionIds.has(altActionId)) {\n                    altAction = editor.getAction(altActionId);\n                }\n            }\n            const referenceCount = references.references.length;\n            if (referenceCount === 0) {\n                // no result -> show message\n                if (!this.configuration.muteMessage) {\n                    const info = model.getWordAtPosition(position);\n                    (_a = MessageController.get(editor)) === null || _a === void 0 ? void 0 : _a.showMessage(this._getNoResultFoundMessage(info), position);\n                }\n            }\n            else if (referenceCount === 1 && altAction) {\n                // already at the only result, run alternative\n                SymbolNavigationAction._activeAlternativeCommands.add(this.id);\n                altAction.run().finally(() => {\n                    SymbolNavigationAction._activeAlternativeCommands.delete(this.id);\n                });\n            }\n            else {\n                // normal results handling\n                return this._onResult(editorService, symbolNavService, editor, references);\n            }\n        }), (err) => {\n            // report an error\n            notificationService.error(err);\n        }).finally(() => {\n            cts.dispose();\n        });\n        progressService.showWhile(promise, 250);\n        return promise;\n    }\n    _onResult(editorService, symbolNavService, editor, model) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const gotoLocation = this._getGoToPreference(editor);\n            if (!(editor instanceof EmbeddedCodeEditorWidget) && (this.configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1))) {\n                this._openInPeek(editor, model);\n            }\n            else {\n                const next = model.firstReference();\n                const peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\n                const targetEditor = yield this._openReference(editor, editorService, next, this.configuration.openToSide, !peek);\n                if (peek && targetEditor) {\n                    this._openInPeek(targetEditor, model);\n                }\n                else {\n                    model.dispose();\n                }\n                // keep remaining locations around when using\n                // 'goto'-mode\n                if (gotoLocation === 'goto') {\n                    symbolNavService.put(next);\n                }\n            }\n        });\n    }\n    _openReference(editor, editorService, reference, sideBySide, highlight) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // range is the target-selection-range when we have one\n            // and the fallback is the 'full' range\n            let range = undefined;\n            if (isLocationLink(reference)) {\n                range = reference.targetSelectionRange;\n            }\n            if (!range) {\n                range = reference.range;\n            }\n            if (!range) {\n                return undefined;\n            }\n            const targetEditor = yield editorService.openCodeEditor({\n                resource: reference.uri,\n                options: {\n                    selection: Range.collapseToStart(range),\n                    selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */,\n                    selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */\n                }\n            }, editor, sideBySide);\n            if (!targetEditor) {\n                return undefined;\n            }\n            if (highlight) {\n                const modelNow = targetEditor.getModel();\n                const decorations = targetEditor.createDecorationsCollection([{ range, options: { description: 'symbol-navigate-action-highlight', className: 'symbolHighlight' } }]);\n                setTimeout(() => {\n                    if (targetEditor.getModel() === modelNow) {\n                        decorations.clear();\n                    }\n                }, 350);\n            }\n            return targetEditor;\n        });\n    }\n    _openInPeek(target, model) {\n        const controller = ReferencesController.get(target);\n        if (controller && target.hasModel()) {\n            controller.toggleWidget(target.getSelection(), createCancelablePromise(_ => Promise.resolve(model)), this.configuration.openInPeek);\n        }\n        else {\n            model.dispose();\n        }\n    }\n}\nSymbolNavigationAction._activeAlternativeCommands = new Set();\n//#region --- DEFINITION\nexport class DefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, token), nls.localize('def.title', 'Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\n            : nls.localize('generic.noResults', \"No definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).alternativeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).multipleDefinitions;\n    }\n}\nconst goToDefinitionKb = isWeb && !isStandalone()\n    ? 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */\n    : 70 /* KeyCode.F12 */;\nregisterGoToAction((_a = class GoToDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToDefinitionAction.id,\n                label: nls.localize('actions.goToDecl.label', \"Go to Definition\"),\n                alias: 'Go to Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: goToDefinitionKb,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.1\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', GoToDefinitionAction.id);\n        }\n    },\n    _a.id = 'editor.action.revealDefinition',\n    _a));\nregisterGoToAction((_b = class OpenDefinitionToSideAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: true,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: OpenDefinitionToSideAction.id,\n                label: nls.localize('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\n                alias: 'Open Definition to the Side',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, goToDefinitionKb),\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', OpenDefinitionToSideAction.id);\n        }\n    },\n    _b.id = 'editor.action.revealDefinitionAside',\n    _b));\nregisterGoToAction((_c = class PeekDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekDefinitionAction.id,\n                label: nls.localize('actions.previewDecl.label', \"Peek Definition\"),\n                alias: 'Peek Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 512 /* KeyMod.Alt */ | 70 /* KeyCode.F12 */,\n                    linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 68 /* KeyCode.F10 */ },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                contextMenuOpts: {\n                    menuId: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 2\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', PeekDefinitionAction.id);\n        }\n    },\n    _c.id = 'editor.action.peekDefinition',\n    _c));\n//#endregion\n//#region --- DECLARATION\nclass DeclarationAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, token), nls.localize('decl.title', 'Declarations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).alternativeDeclarationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).multipleDeclarations;\n    }\n}\nregisterGoToAction((_d = class GoToDeclarationAction extends DeclarationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToDeclarationAction.id,\n                label: nls.localize('actions.goToDeclaration.label', \"Go to Declaration\"),\n                alias: 'Go to Declaration',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.3\n                },\n            });\n        }\n        _getNoResultFoundMessage(info) {\n            return info && info.word\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\n        }\n    },\n    _d.id = 'editor.action.revealDeclaration',\n    _d));\nregisterGoToAction(class PeekDeclarationAction extends DeclarationAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.peekDeclaration',\n            label: nls.localize('actions.peekDecl.label', \"Peek Declaration\"),\n            alias: 'Peek Declaration',\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            contextMenuOpts: {\n                menuId: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 3\n            }\n        });\n    }\n});\n//#endregion\n//#region --- TYPE DEFINITION\nclass TypeDefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, token), nls.localize('typedef.title', 'Type Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).alternativeTypeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).multipleTypeDefinitions;\n    }\n}\nregisterGoToAction((_e = class GoToTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToTypeDefinitionAction.ID,\n                label: nls.localize('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\n                alias: 'Go to Type Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 0,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.4\n                }\n            });\n        }\n    },\n    _e.ID = 'editor.action.goToTypeDefinition',\n    _e));\nregisterGoToAction((_f = class PeekTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekTypeDefinitionAction.ID,\n                label: nls.localize('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\n                alias: 'Peek Type Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                contextMenuOpts: {\n                    menuId: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 4\n                }\n            });\n        }\n    },\n    _f.ID = 'editor.action.peekTypeDefinition',\n    _f));\n//#endregion\n//#region --- IMPLEMENTATION\nclass ImplementationAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, token), nls.localize('impl.title', 'Implementations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).alternativeImplementationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).multipleImplementations;\n    }\n}\nregisterGoToAction((_g = class GoToImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToImplementationAction.ID,\n                label: nls.localize('actions.goToImplementation.label', \"Go to Implementations\"),\n                alias: 'Go to Implementations',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.45\n                }\n            });\n        }\n    },\n    _g.ID = 'editor.action.goToImplementation',\n    _g));\nregisterGoToAction((_h = class PeekImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekImplementationAction.ID,\n                label: nls.localize('actions.peekImplementation.label', \"Peek Implementations\"),\n                alias: 'Peek Implementations',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                contextMenuOpts: {\n                    menuId: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 5\n                }\n            });\n        }\n    },\n    _h.ID = 'editor.action.peekImplementation',\n    _h));\n//#endregion\n//#region --- REFERENCES\nclass ReferencesAction extends SymbolNavigationAction {\n    _getNoResultFoundMessage(info) {\n        return info\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\n            : nls.localize('references.noGeneric', \"No references found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).alternativeReferenceCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(53 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n}\nregisterGoToAction(class GoToReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: 'editor.action.goToReferences',\n            label: nls.localize('goToReferences.label', \"Go to References\"),\n            alias: 'Go to References',\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: 'navigation',\n                order: 1.45\n            }\n        });\n    }\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, true, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\nregisterGoToAction(class PeekReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.referenceSearch.trigger',\n            label: nls.localize('references.action.label', \"Peek References\"),\n            alias: 'Peek References',\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            contextMenuOpts: {\n                menuId: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 6\n            }\n        });\n    }\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\n//#endregion\n//#region --- GENERIC goto symbols command\nclass GenericGoToLocationAction extends SymbolNavigationAction {\n    constructor(config, _references, _gotoMultipleBehaviour) {\n        super(config, {\n            id: 'editor.action.goToLocation',\n            label: nls.localize('label.generic', \"Go to Any Symbol\"),\n            alias: 'Go to Any Symbol',\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n        });\n        this._references = _references;\n        this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\n    }\n    _getLocationModel(languageFeaturesService, _model, _position, _token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\n    }\n    _getGoToPreference(editor) {\n        var _a;\n        return (_a = this._gotoMultipleBehaviour) !== null && _a !== void 0 ? _a : editor.getOption(53 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n    _getAlternativeCommand() { return ''; }\n}\nCommandsRegistry.registerCommand({\n    id: 'editor.action.goToLocations',\n    description: {\n        description: 'Go to locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n            { name: 'noResultsMessage', description: 'Human readable message that shows when locations is empty.' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple, noResultsMessage, openInPeek) => __awaiter(void 0, void 0, void 0, function* () {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        assertType(Array.isArray(references));\n        assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\n        assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\n        const editorService = accessor.get(ICodeEditorService);\n        const editor = yield editorService.openCodeEditor({ resource }, editorService.getFocusedCodeEditor());\n        if (isCodeEditor(editor)) {\n            editor.setPosition(position);\n            editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n            return editor.invokeWithinContext(accessor => {\n                const command = new class extends GenericGoToLocationAction {\n                    _getNoResultFoundMessage(info) {\n                        return noResultsMessage || super._getNoResultFoundMessage(info);\n                    }\n                }({\n                    muteMessage: !Boolean(noResultsMessage),\n                    openInPeek: Boolean(openInPeek),\n                    openToSide: false\n                }, references, multiple);\n                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\n            });\n        }\n    })\n});\nCommandsRegistry.registerCommand({\n    id: 'editor.action.peekLocations',\n    description: {\n        description: 'Peek locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple) => __awaiter(void 0, void 0, void 0, function* () {\n        accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, undefined, true);\n    })\n});\n//#endregion\n//#region --- REFERENCE search special commands\nCommandsRegistry.registerCommand({\n    id: 'editor.action.findReferences',\n    handler: (accessor, resource, position) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const codeEditorService = accessor.get(ICodeEditorService);\n        return codeEditorService.openCodeEditor({ resource }, codeEditorService.getFocusedCodeEditor()).then(control => {\n            if (!isCodeEditor(control) || !control.hasModel()) {\n                return undefined;\n            }\n            const controller = ReferencesController.get(control);\n            if (!controller) {\n                return undefined;\n            }\n            const references = createCancelablePromise(token => getReferencesAtPosition(languageFeaturesService.referenceProvider, control.getModel(), corePosition.Position.lift(position), false, token).then(references => new ReferencesModel(references, nls.localize('ref.title', 'References'))));\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            return Promise.resolve(controller.toggleWidget(range, references, false));\n        });\n    }\n});\n// use NEW command\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\n//#endregion\n// -- unconditionally register goto-action\nMenuRegistry.appendMenuItems([\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.revealDefinition',\n                title: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\")\n            },\n            group: '4_symbol_nav',\n            order: 2,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.revealDeclaration',\n                title: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\")\n            },\n            group: '4_symbol_nav',\n            order: 3,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.goToTypeDefinition',\n                title: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\")\n            },\n            group: '4_symbol_nav',\n            order: 3,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.goToImplementation',\n                title: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\")\n            },\n            group: '4_symbol_nav',\n            order: 4,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.goToReferences',\n                title: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\")\n            },\n            group: '4_symbol_nav',\n            order: 5,\n        },\n    },\n]);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nfunction getLocationLinks(model, position, registry, provide) {\n    const provider = registry.ordered(model);\n    // get results\n    const promises = provider.map((provider) => {\n        return Promise.resolve(provide(provider, model, position)).then(undefined, err => {\n            onUnexpectedExternalError(err);\n            return undefined;\n        });\n    });\n    return Promise.all(promises).then(values => {\n        const result = [];\n        for (const value of values) {\n            if (Array.isArray(value)) {\n                result.push(...value);\n            }\n            else if (value) {\n                result.push(value);\n            }\n        }\n        return result;\n    });\n}\nexport function getDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDefinition(model, position, token);\n    });\n}\nexport function getDeclarationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDeclaration(model, position, token);\n    });\n}\nexport function getImplementationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideImplementation(model, position, token);\n    });\n}\nexport function getTypeDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideTypeDefinition(model, position, token);\n    });\n}\nexport function getReferencesAtPosition(registry, model, position, compact, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => __awaiter(this, void 0, void 0, function* () {\n        const result = yield provider.provideReferences(model, position, { includeDeclaration: true }, token);\n        if (!compact || !result || result.length !== 2) {\n            return result;\n        }\n        const resultWithoutDeclaration = yield provider.provideReferences(model, position, { includeDeclaration: false }, token);\n        if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\n            return resultWithoutDeclaration;\n        }\n        return result;\n    }));\n}\n// -- API commands ----\nfunction _sortedAndDeduped(callback) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const rawLinks = yield callback();\n        const model = new ReferencesModel(rawLinks, '');\n        const modelLinks = model.references.map(ref => ref.link);\n        model.dispose();\n        return modelLinks;\n    });\n}\nregisterModelAndPositionCommand('_executeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeDeclarationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeReferenceProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeImplementationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../../base/common/platform.js';\nfunction hasModifier(e, modifier) {\n    return !!e[modifier];\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkMouseEvent {\n    constructor(source, opts) {\n        this.target = source.target;\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\n        this.isNoneOrSingleMouseDown = (source.event.detail <= 1);\n    }\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkKeyboardEvent {\n    constructor(source, opts) {\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\n    }\n}\nexport class ClickLinkOptions {\n    constructor(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\n        this.triggerKey = triggerKey;\n        this.triggerModifier = triggerModifier;\n        this.triggerSideBySideKey = triggerSideBySideKey;\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\n    }\n    equals(other) {\n        return (this.triggerKey === other.triggerKey\n            && this.triggerModifier === other.triggerModifier\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\n    }\n}\nfunction createOptions(multiCursorModifier) {\n    if (multiCursorModifier === 'altKey') {\n        if (platform.isMacintosh) {\n            return new ClickLinkOptions(57 /* KeyCode.Meta */, 'metaKey', 6 /* KeyCode.Alt */, 'altKey');\n        }\n        return new ClickLinkOptions(5 /* KeyCode.Ctrl */, 'ctrlKey', 6 /* KeyCode.Alt */, 'altKey');\n    }\n    if (platform.isMacintosh) {\n        return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 57 /* KeyCode.Meta */, 'metaKey');\n    }\n    return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 5 /* KeyCode.Ctrl */, 'ctrlKey');\n}\nexport class ClickLinkGesture extends Disposable {\n    constructor(editor) {\n        super();\n        this._onMouseMoveOrRelevantKeyDown = this._register(new Emitter());\n        this.onMouseMoveOrRelevantKeyDown = this._onMouseMoveOrRelevantKeyDown.event;\n        this._onExecute = this._register(new Emitter());\n        this.onExecute = this._onExecute.event;\n        this._onCancel = this._register(new Emitter());\n        this.onCancel = this._onCancel.event;\n        this._editor = editor;\n        this._opts = createOptions(this._editor.getOption(72 /* EditorOption.multiCursorModifier */));\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._lineNumberOnMouseDown = 0;\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(72 /* EditorOption.multiCursorModifier */)) {\n                const newOpts = createOptions(this._editor.getOption(72 /* EditorOption.multiCursorModifier */));\n                if (this._opts.equals(newOpts)) {\n                    return;\n                }\n                this._opts = newOpts;\n                this._lastMouseMoveEvent = null;\n                this._hasTriggerKeyOnMouseDown = false;\n                this._lineNumberOnMouseDown = 0;\n                this._onCancel.fire();\n            }\n        }));\n        this._register(this._editor.onMouseMove((e) => this._onEditorMouseMove(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onKeyDown((e) => this._onEditorKeyDown(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onKeyUp((e) => this._onEditorKeyUp(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onMouseDrag(() => this._resetHandler()));\n        this._register(this._editor.onDidChangeCursorSelection((e) => this._onDidChangeCursorSelection(e)));\n        this._register(this._editor.onDidChangeModel((e) => this._resetHandler()));\n        this._register(this._editor.onDidChangeModelContent(() => this._resetHandler()));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\n                this._resetHandler();\n            }\n        }));\n    }\n    _onDidChangeCursorSelection(e) {\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\n            this._resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/microsoft/vscode/issues/7827)\n        }\n    }\n    _onEditorMouseMove(mouseEvent) {\n        this._lastMouseMoveEvent = mouseEvent;\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\n    }\n    _onEditorMouseDown(mouseEvent) {\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\n        // release the mouse button without wanting to do the navigation.\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\n        this._hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\n        this._lineNumberOnMouseDown = mouseEvent.target.position ? mouseEvent.target.position.lineNumber : 0;\n    }\n    _onEditorMouseUp(mouseEvent) {\n        const currentLineNumber = mouseEvent.target.position ? mouseEvent.target.position.lineNumber : 0;\n        if (this._hasTriggerKeyOnMouseDown && this._lineNumberOnMouseDown && this._lineNumberOnMouseDown === currentLineNumber) {\n            this._onExecute.fire(mouseEvent);\n        }\n    }\n    _onEditorKeyDown(e) {\n        if (this._lastMouseMoveEvent\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\n            )) {\n            this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent, e]);\n        }\n        else if (e.hasTriggerModifier) {\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\n        }\n    }\n    _onEditorKeyUp(e) {\n        if (e.keyCodeIsTriggerKey) {\n            this._onCancel.fire();\n        }\n    }\n    _resetHandler() {\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._onCancel.fire();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { withNullAsUndefined } from '../../../../../base/common/types.js';\nimport './goToDefinitionAtPosition.css';\nimport { EditorState } from '../../../editorState/browser/editorState.js';\nimport { registerEditorContribution } from '../../../../browser/editorExtensions.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from './clickLinkGesture.js';\nimport { PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { editorActiveLinkForeground } from '../../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../../platform/theme/common/themeService.js';\nimport { DefinitionAction } from '../goToCommands.js';\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nlet GotoDefinitionAtPositionEditorContribution = class GotoDefinitionAtPositionEditorContribution {\n    constructor(editor, textModelResolverService, languageService, languageFeaturesService) {\n        this.textModelResolverService = textModelResolverService;\n        this.languageService = languageService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.toUnhook = new DisposableStore();\n        this.toUnhookForKeyboard = new DisposableStore();\n        this.currentWordAtPosition = null;\n        this.previousPromise = null;\n        this.editor = editor;\n        this.linkDecorations = this.editor.createDecorationsCollection();\n        const linkGesture = new ClickLinkGesture(editor);\n        this.toUnhook.add(linkGesture);\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this.startFindDefinitionFromMouse(mouseEvent, withNullAsUndefined(keyboardEvent));\n        }));\n        this.toUnhook.add(linkGesture.onExecute((mouseEvent) => {\n            if (this.isEnabled(mouseEvent)) {\n                this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier).then(() => {\n                    this.removeLinkDecorations();\n                }, (error) => {\n                    this.removeLinkDecorations();\n                    onUnexpectedError(error);\n                });\n            }\n        }));\n        this.toUnhook.add(linkGesture.onCancel(() => {\n            this.removeLinkDecorations();\n            this.currentWordAtPosition = null;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution.ID);\n    }\n    startFindDefinitionFromCursor(position) {\n        // For issue: https://github.com/microsoft/vscode/issues/46257\n        // equivalent to mouse move with meta/ctrl key\n        // First find the definition and add decorations\n        // to the editor to be shown with the content hover widget\n        return this.startFindDefinition(position).then(() => {\n            // Add listeners for editor cursor move and key down events\n            // Dismiss the \"extended\" editor decorations when the user hides\n            // the hover widget. There is no event for the widget itself so these\n            // serve as a best effort. After removing the link decorations, the hover\n            // widget is clean and will only show declarations per next request.\n            this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                this.toUnhookForKeyboard.clear();\n            }));\n            this.toUnhookForKeyboard.add(this.editor.onKeyDown((e) => {\n                if (e) {\n                    this.currentWordAtPosition = null;\n                    this.removeLinkDecorations();\n                    this.toUnhookForKeyboard.clear();\n                }\n            }));\n        });\n    }\n    startFindDefinitionFromMouse(mouseEvent, withKey) {\n        // check if we are active and on a content widget\n        if (mouseEvent.target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\n            return;\n        }\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        const position = mouseEvent.target.position;\n        this.startFindDefinition(position);\n    }\n    startFindDefinition(position) {\n        var _a;\n        // Dispose listeners for updating decorations when using keyboard to show definition hover\n        this.toUnhookForKeyboard.clear();\n        // Find word at mouse position\n        const word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\n        if (!word) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return Promise.resolve(0);\n        }\n        // Return early if word at position is still the same\n        if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\n            return Promise.resolve(0);\n        }\n        this.currentWordAtPosition = word;\n        // Find definition and decorate word if found\n        const state = new EditorState(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */ | 8 /* CodeEditorStateFlag.Scroll */);\n        if (this.previousPromise) {\n            this.previousPromise.cancel();\n            this.previousPromise = null;\n        }\n        this.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\n        return this.previousPromise.then(results => {\n            if (!results || !results.length || !state.validate(this.editor)) {\n                this.removeLinkDecorations();\n                return;\n            }\n            // Multiple results\n            if (results.length > 1) {\n                this.addDecoration(new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn), new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\n            }\n            // Single result\n            else {\n                const result = results[0];\n                if (!result.uri) {\n                    return;\n                }\n                this.textModelResolverService.createModelReference(result.uri).then(ref => {\n                    if (!ref.object || !ref.object.textEditorModel) {\n                        ref.dispose();\n                        return;\n                    }\n                    const { object: { textEditorModel } } = ref;\n                    const { startLineNumber } = result.range;\n                    if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\n                        // invalid range\n                        ref.dispose();\n                        return;\n                    }\n                    const previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\n                    let wordRange;\n                    if (result.originSelectionRange) {\n                        wordRange = Range.lift(result.originSelectionRange);\n                    }\n                    else {\n                        wordRange = new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n                    }\n                    const languageId = this.languageService.guessLanguageIdByFilepathOrFirstLine(textEditorModel.uri);\n                    this.addDecoration(wordRange, new MarkdownString().appendCodeblock(languageId ? languageId : '', previewValue));\n                    ref.dispose();\n                });\n            }\n        }).then(undefined, onUnexpectedError);\n    }\n    getPreviewValue(textEditorModel, startLineNumber, result) {\n        let rangeToUse = result.range;\n        const numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES) {\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\n        }\n        const previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\n        return previewValue;\n    }\n    stripIndentationFromPreviewRange(textEditorModel, startLineNumber, previewRange) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        let minIndent = startIndent;\n        for (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            minIndent = Math.min(minIndent, endIndent);\n        }\n        const previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\n        return previewValue;\n    }\n    getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\n        let endLineNumber = startLineNumber + 1;\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            if (startIndent === endIndent) {\n                break;\n            }\n        }\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n    }\n    addDecoration(range, hoverMessage) {\n        const newDecorations = {\n            range: range,\n            options: {\n                description: 'goto-definition-link',\n                inlineClassName: 'goto-definition-link',\n                hoverMessage\n            }\n        };\n        this.linkDecorations.set([newDecorations]);\n    }\n    removeLinkDecorations() {\n        this.linkDecorations.clear();\n    }\n    isEnabled(mouseEvent, withKey) {\n        return this.editor.hasModel() &&\n            mouseEvent.isNoneOrSingleMouseDown &&\n            (mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */) &&\n            (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false)) &&\n            this.languageFeaturesService.definitionProvider.has(this.editor.getModel());\n    }\n    findDefinition(position, token) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return Promise.resolve(null);\n        }\n        return getDefinitionsAtPosition(this.languageFeaturesService.definitionProvider, model, position, token);\n    }\n    gotoDefinition(position, openToSide) {\n        this.editor.setPosition(position);\n        return this.editor.invokeWithinContext((accessor) => {\n            const canPeek = !openToSide && this.editor.getOption(80 /* EditorOption.definitionLinkOpensInPeek */) && !this.isInPeekEditor(accessor);\n            const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { alias: '', label: '', id: '', precondition: undefined });\n            return action.run(accessor, this.editor);\n        });\n    }\n    isInPeekEditor(accessor) {\n        const contextKeyService = accessor.get(IContextKeyService);\n        return PeekContext.inPeekEditor.getValue(contextKeyService);\n    }\n    dispose() {\n        this.toUnhook.dispose();\n    }\n};\nGotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\nGotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\nGotoDefinitionAtPositionEditorContribution = __decorate([\n    __param(1, ITextModelService),\n    __param(2, ILanguageService),\n    __param(3, ILanguageFeaturesService)\n], GotoDefinitionAtPositionEditorContribution);\nexport { GotoDefinitionAtPositionEditorContribution };\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution);\nregisterThemingParticipant((theme, collector) => {\n    const activeLinkForeground = theme.getColor(editorActiveLinkForeground);\n    if (activeLinkForeground) {\n        collector.addRule(`.monaco-editor .goto-definition-link { color: ${activeLinkForeground} !important; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { CountBadge } from '../../../../../base/browser/ui/countBadge/countBadge.js';\nimport { HighlightedLabel } from '../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\nimport { IconLabel } from '../../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { createMatches, FuzzyScore } from '../../../../../base/common/filters.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { basename, dirname } from '../../../../../base/common/resources.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { localize } from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { attachBadgeStyler } from '../../../../../platform/theme/common/styler.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { FileReferences, OneReference, ReferencesModel } from '../referencesModel.js';\nlet DataSource = class DataSource {\n    constructor(_resolverService) {\n        this._resolverService = _resolverService;\n    }\n    hasChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return true;\n        }\n        if (element instanceof FileReferences) {\n            return true;\n        }\n        return false;\n    }\n    getChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return element.groups;\n        }\n        if (element instanceof FileReferences) {\n            return element.resolve(this._resolverService).then(val => {\n                // if (element.failure) {\n                // \t// refresh the element on failure so that\n                // \t// we can update its rendering\n                // \treturn tree.refresh(element).then(() => val.children);\n                // }\n                return val.children;\n            });\n        }\n        throw new Error('bad tree');\n    }\n};\nDataSource = __decorate([\n    __param(0, ITextModelService)\n], DataSource);\nexport { DataSource };\n//#endregion\nexport class Delegate {\n    getHeight() {\n        return 23;\n    }\n    getTemplateId(element) {\n        if (element instanceof FileReferences) {\n            return FileReferencesRenderer.id;\n        }\n        else {\n            return OneReferenceRenderer.id;\n        }\n    }\n}\nlet StringRepresentationProvider = class StringRepresentationProvider {\n    constructor(_keybindingService) {\n        this._keybindingService = _keybindingService;\n    }\n    getKeyboardNavigationLabel(element) {\n        var _a;\n        if (element instanceof OneReference) {\n            const parts = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n            if (parts) {\n                return parts.value;\n            }\n        }\n        // FileReferences or unresolved OneReference\n        return basename(element.uri);\n    }\n};\nStringRepresentationProvider = __decorate([\n    __param(0, IKeybindingService)\n], StringRepresentationProvider);\nexport { StringRepresentationProvider };\nexport class IdentityProvider {\n    getId(element) {\n        return element instanceof OneReference ? element.id : element.uri;\n    }\n}\n//#region render: File\nlet FileReferencesTemplate = class FileReferencesTemplate extends Disposable {\n    constructor(container, _labelService, themeService) {\n        super();\n        this._labelService = _labelService;\n        const parent = document.createElement('div');\n        parent.classList.add('reference-file');\n        this.file = this._register(new IconLabel(parent, { supportHighlights: true }));\n        this.badge = new CountBadge(dom.append(parent, dom.$('.count')));\n        this._register(attachBadgeStyler(this.badge, themeService));\n        container.appendChild(parent);\n    }\n    set(element, matches) {\n        const parent = dirname(element.uri);\n        this.file.setLabel(this._labelService.getUriBasenameLabel(element.uri), this._labelService.getUriLabel(parent, { relative: true }), { title: this._labelService.getUriLabel(element.uri), matches });\n        const len = element.children.length;\n        this.badge.setCount(len);\n        if (len > 1) {\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\n        }\n        else {\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\n        }\n    }\n};\nFileReferencesTemplate = __decorate([\n    __param(1, ILabelService),\n    __param(2, IThemeService)\n], FileReferencesTemplate);\nlet FileReferencesRenderer = class FileReferencesRenderer {\n    constructor(_instantiationService) {\n        this._instantiationService = _instantiationService;\n        this.templateId = FileReferencesRenderer.id;\n    }\n    renderTemplate(container) {\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\n    }\n    renderElement(node, index, template) {\n        template.set(node.element, createMatches(node.filterData));\n    }\n    disposeTemplate(templateData) {\n        templateData.dispose();\n    }\n};\nFileReferencesRenderer.id = 'FileReferencesRenderer';\nFileReferencesRenderer = __decorate([\n    __param(0, IInstantiationService)\n], FileReferencesRenderer);\nexport { FileReferencesRenderer };\n//#endregion\n//#region render: Reference\nclass OneReferenceTemplate {\n    constructor(container) {\n        this.label = new HighlightedLabel(container);\n    }\n    set(element, score) {\n        var _a;\n        const preview = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n        if (!preview || !preview.value) {\n            // this means we FAILED to resolve the document or the value is the empty string\n            this.label.set(`${basename(element.uri)}:${element.range.startLineNumber + 1}:${element.range.startColumn + 1}`);\n        }\n        else {\n            // render search match as highlight unless\n            // we have score, then render the score\n            const { value, highlight } = preview;\n            if (score && !FuzzyScore.isDefault(score)) {\n                this.label.element.classList.toggle('referenceMatch', false);\n                this.label.set(value, createMatches(score));\n            }\n            else {\n                this.label.element.classList.toggle('referenceMatch', true);\n                this.label.set(value, [highlight]);\n            }\n        }\n    }\n}\nexport class OneReferenceRenderer {\n    constructor() {\n        this.templateId = OneReferenceRenderer.id;\n    }\n    renderTemplate(container) {\n        return new OneReferenceTemplate(container);\n    }\n    renderElement(node, index, templateData) {\n        templateData.set(node.element, node.filterData);\n    }\n    disposeTemplate() {\n    }\n}\nOneReferenceRenderer.id = 'OneReferenceRenderer';\n//#endregion\nexport class AccessibilityProvider {\n    getWidgetAriaLabel() {\n        return localize('treeAriaLabel', \"References\");\n    }\n    getAriaLabel(element) {\n        return element.ariaMessage;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { Sizing, SplitView } from '../../../../../base/browser/ui/splitview/splitview.js';\nimport { Color } from '../../../../../base/common/color.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { basenameOrAuthority, dirname } from '../../../../../base/common/resources.js';\nimport './referencesWidget.css';\nimport { EmbeddedCodeEditorWidget } from '../../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ModelDecorationOptions, TextModel } from '../../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../../common/languages/modesRegistry.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, IdentityProvider, OneReferenceRenderer, StringRepresentationProvider } from './referencesTree.js';\nimport * as peekView from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { WorkbenchAsyncDataTree } from '../../../../../platform/list/browser/listService.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { FileReferences, OneReference } from '../referencesModel.js';\nclass DecorationsManager {\n    constructor(_editor, _model) {\n        this._editor = _editor;\n        this._model = _model;\n        this._decorations = new Map();\n        this._decorationIgnoreSet = new Set();\n        this._callOnDispose = new DisposableStore();\n        this._callOnModelChange = new DisposableStore();\n        this._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\n        this._onModelChanged();\n    }\n    dispose() {\n        this._callOnModelChange.dispose();\n        this._callOnDispose.dispose();\n        this.removeDecorations();\n    }\n    _onModelChanged() {\n        this._callOnModelChange.clear();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const ref of this._model.references) {\n            if (ref.uri.toString() === model.uri.toString()) {\n                this._addDecorations(ref.parent);\n                return;\n            }\n        }\n    }\n    _addDecorations(reference) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\n        const newDecorations = [];\n        const newDecorationsActualIndex = [];\n        for (let i = 0, len = reference.children.length; i < len; i++) {\n            const oneReference = reference.children[i];\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\n                continue;\n            }\n            if (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\n                continue;\n            }\n            newDecorations.push({\n                range: oneReference.range,\n                options: DecorationsManager.DecorationOptions\n            });\n            newDecorationsActualIndex.push(i);\n        }\n        this._editor.changeDecorations((changeAccessor) => {\n            const decorations = changeAccessor.deltaDecorations([], newDecorations);\n            for (let i = 0; i < decorations.length; i++) {\n                this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\n            }\n        });\n    }\n    _onDecorationChanged() {\n        const toRemove = [];\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const [decorationId, reference] of this._decorations) {\n            const newRange = model.getDecorationRange(decorationId);\n            if (!newRange) {\n                continue;\n            }\n            let ignore = false;\n            if (Range.equalsRange(newRange, reference.range)) {\n                continue;\n            }\n            if (Range.spansMultipleLines(newRange)) {\n                ignore = true;\n            }\n            else {\n                const lineLength = reference.range.endColumn - reference.range.startColumn;\n                const newLineLength = newRange.endColumn - newRange.startColumn;\n                if (lineLength !== newLineLength) {\n                    ignore = true;\n                }\n            }\n            if (ignore) {\n                this._decorationIgnoreSet.add(reference.id);\n                toRemove.push(decorationId);\n            }\n            else {\n                reference.range = newRange;\n            }\n        }\n        for (let i = 0, len = toRemove.length; i < len; i++) {\n            this._decorations.delete(toRemove[i]);\n        }\n        this._editor.removeDecorations(toRemove);\n    }\n    removeDecorations() {\n        this._editor.removeDecorations([...this._decorations.keys()]);\n        this._decorations.clear();\n    }\n}\nDecorationsManager.DecorationOptions = ModelDecorationOptions.register({\n    description: 'reference-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'reference-decoration'\n});\nexport class LayoutData {\n    constructor() {\n        this.ratio = 0.7;\n        this.heightInLines = 18;\n    }\n    static fromJSON(raw) {\n        let ratio;\n        let heightInLines;\n        try {\n            const data = JSON.parse(raw);\n            ratio = data.ratio;\n            heightInLines = data.heightInLines;\n        }\n        catch (_a) {\n            //\n        }\n        return {\n            ratio: ratio || 0.7,\n            heightInLines: heightInLines || 18\n        };\n    }\n}\nclass ReferencesTree extends WorkbenchAsyncDataTree {\n}\n/**\n * ZoneWidget that is shown inside the editor\n */\nlet ReferenceWidget = class ReferenceWidget extends peekView.PeekViewWidget {\n    constructor(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel, _undoRedoService, _keybindingService, _languageService, _languageConfigurationService) {\n        super(editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true, supportOnTitleClick: true }, _instantiationService);\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this.layoutData = layoutData;\n        this._textModelResolverService = _textModelResolverService;\n        this._instantiationService = _instantiationService;\n        this._peekViewService = _peekViewService;\n        this._uriLabel = _uriLabel;\n        this._undoRedoService = _undoRedoService;\n        this._keybindingService = _keybindingService;\n        this._languageService = _languageService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._disposeOnNewModel = new DisposableStore();\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectReference = new Emitter();\n        this.onDidSelectReference = this._onDidSelectReference.event;\n        this._dim = new dom.Dimension(0, 0);\n        this._applyTheme(themeService.getColorTheme());\n        this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this._peekViewService.addExclusiveWidget(editor, this);\n        this.create();\n    }\n    dispose() {\n        this.setModel(undefined);\n        this._callOnDispose.dispose();\n        this._disposeOnNewModel.dispose();\n        dispose(this._preview);\n        dispose(this._previewNotAvailableMessage);\n        dispose(this._tree);\n        dispose(this._previewModelReference);\n        this._splitView.dispose();\n        super.dispose();\n    }\n    _applyTheme(theme) {\n        const borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\n        this.style({\n            arrowColor: borderColor,\n            frameColor: borderColor,\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\n        });\n    }\n    show(where) {\n        super.show(where, this.layoutData.heightInLines || 18);\n    }\n    focusOnReferenceTree() {\n        this._tree.domFocus();\n    }\n    focusOnPreviewEditor() {\n        this._preview.focus();\n    }\n    isPreviewEditorFocused() {\n        return this._preview.hasTextFocus();\n    }\n    _onTitleClick(e) {\n        if (this._preview && this._preview.getModel()) {\n            this._onDidSelectReference.fire({\n                element: this._getFocusedReference(),\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\n                source: 'title'\n            });\n        }\n    }\n    _fillBody(containerElement) {\n        this.setCssClass('reference-zone-widget');\n        // message pane\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\n        dom.hide(this._messageContainer);\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* Orientation.HORIZONTAL */ });\n        // editor\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\n        const options = {\n            scrollBeyondLastLine: false,\n            scrollbar: {\n                verticalScrollbarSize: 14,\n                horizontal: 'auto',\n                useShadows: true,\n                verticalHasArrows: false,\n                horizontalHasArrows: false,\n                alwaysConsumeMouseWheel: false\n            },\n            overviewRulerLanes: 2,\n            fixedOverflowWidgets: true,\n            minimap: {\n                enabled: false\n            }\n        };\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, this.editor);\n        dom.hide(this._previewContainer);\n        this._previewNotAvailableMessage = new TextModel(nls.localize('missingPreviewMessage', \"no preview available\"), PLAINTEXT_LANGUAGE_ID, TextModel.DEFAULT_CREATION_OPTIONS, null, this._undoRedoService, this._languageService, this._languageConfigurationService);\n        // tree\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\n        const treeOptions = {\n            keyboardSupport: this._defaultTreeKeyboardSupport,\n            accessibilityProvider: new AccessibilityProvider(),\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\n            identityProvider: new IdentityProvider(),\n            openOnSingleClick: true,\n            selectionNavigation: true,\n            overrideStyles: {\n                listBackground: peekView.peekViewResultsBackground\n            }\n        };\n        if (this._defaultTreeKeyboardSupport) {\n            // the tree will consume `Escape` and prevent the widget from closing\n            this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', (e) => {\n                if (e.equals(9 /* KeyCode.Escape */)) {\n                    this._keybindingService.dispatchEvent(e, e.target);\n                    e.stopPropagation();\n                }\n            }, true));\n        }\n        this._tree = this._instantiationService.createInstance(ReferencesTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\n            this._instantiationService.createInstance(FileReferencesRenderer),\n            this._instantiationService.createInstance(OneReferenceRenderer),\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\n        // split stuff\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._previewContainer,\n            minimumSize: 200,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._preview.layout({ height: this._dim.height, width });\n            }\n        }, Sizing.Distribute);\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._treeContainer,\n            minimumSize: 100,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._treeContainer.style.height = `${this._dim.height}px`;\n                this._treeContainer.style.width = `${width}px`;\n                this._tree.layout(this._dim.height, width);\n            }\n        }, Sizing.Distribute);\n        this._disposables.add(this._splitView.onDidSashChange(() => {\n            if (this._dim.width) {\n                this.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\n            }\n        }, undefined));\n        // listen on selection and focus\n        const onEvent = (element, kind) => {\n            if (element instanceof OneReference) {\n                if (kind === 'show') {\n                    this._revealReference(element, false);\n                }\n                this._onDidSelectReference.fire({ element, kind, source: 'tree' });\n            }\n        };\n        this._tree.onDidOpen(e => {\n            if (e.sideBySide) {\n                onEvent(e.element, 'side');\n            }\n            else if (e.editorOptions.pinned) {\n                onEvent(e.element, 'goto');\n            }\n            else {\n                onEvent(e.element, 'show');\n            }\n        });\n        dom.hide(this._treeContainer);\n    }\n    _onWidth(width) {\n        if (this._dim) {\n            this._doLayoutBody(this._dim.height, width);\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._dim = new dom.Dimension(widthInPixel, heightInPixel);\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\n        this._splitView.layout(widthInPixel);\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\n    }\n    setSelection(selection) {\n        return this._revealReference(selection, true).then(() => {\n            if (!this._model) {\n                // disposed\n                return;\n            }\n            // show in tree\n            this._tree.setSelection([selection]);\n            this._tree.setFocus([selection]);\n        });\n    }\n    setModel(newModel) {\n        // clean up\n        this._disposeOnNewModel.clear();\n        this._model = newModel;\n        if (this._model) {\n            return this._onNewModel();\n        }\n        return Promise.resolve();\n    }\n    _onNewModel() {\n        if (!this._model) {\n            return Promise.resolve(undefined);\n        }\n        if (this._model.isEmpty) {\n            this.setTitle('');\n            this._messageContainer.innerText = nls.localize('noResults', \"No results\");\n            dom.show(this._messageContainer);\n            return Promise.resolve(undefined);\n        }\n        dom.hide(this._messageContainer);\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\n        this._disposeOnNewModel.add(this._decorationsManager);\n        // listen on model changes\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference)));\n        // listen on editor\n        this._disposeOnNewModel.add(this._preview.onMouseDown(e => {\n            const { event, target } = e;\n            if (event.detail !== 2) {\n                return;\n            }\n            const element = this._getFocusedReference();\n            if (!element) {\n                return;\n            }\n            this._onDidSelectReference.fire({\n                element: { uri: element.uri, range: target.range },\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\n                source: 'editor'\n            });\n        }));\n        // make sure things are rendered\n        this.container.classList.add('results-loaded');\n        dom.show(this._treeContainer);\n        dom.show(this._previewContainer);\n        this._splitView.layout(this._dim.width);\n        this.focusOnReferenceTree();\n        // pick input and a reference to begin with\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\n    }\n    _getFocusedReference() {\n        const [element] = this._tree.getFocus();\n        if (element instanceof OneReference) {\n            return element;\n        }\n        else if (element instanceof FileReferences) {\n            if (element.children.length > 0) {\n                return element.children[0];\n            }\n        }\n        return undefined;\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._revealReference(reference, false);\n            this._onDidSelectReference.fire({ element: reference, kind: 'goto', source: 'tree' });\n        });\n    }\n    _revealReference(reference, revealParent) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // check if there is anything to do...\n            if (this._revealedReference === reference) {\n                return;\n            }\n            this._revealedReference = reference;\n            // Update widget header\n            if (reference.uri.scheme !== Schemas.inMemory) {\n                this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\n            }\n            else {\n                this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\n            }\n            const promise = this._textModelResolverService.createModelReference(reference.uri);\n            if (this._tree.getInput() === reference.parent) {\n                this._tree.reveal(reference);\n            }\n            else {\n                if (revealParent) {\n                    this._tree.reveal(reference.parent);\n                }\n                yield this._tree.expand(reference.parent);\n                this._tree.reveal(reference);\n            }\n            const ref = yield promise;\n            if (!this._model) {\n                // disposed\n                ref.dispose();\n                return;\n            }\n            dispose(this._previewModelReference);\n            // show in editor\n            const model = ref.object;\n            if (model) {\n                const scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* ScrollType.Smooth */ : 1 /* ScrollType.Immediate */;\n                const sel = Range.lift(reference.range).collapseToStart();\n                this._previewModelReference = ref;\n                this._preview.setModel(model.textEditorModel);\n                this._preview.setSelection(sel);\n                this._preview.revealRangeInCenter(sel, scrollType);\n            }\n            else {\n                this._preview.setModel(this._previewNotAvailableMessage);\n                ref.dispose();\n            }\n        });\n    }\n};\nReferenceWidget = __decorate([\n    __param(3, IThemeService),\n    __param(4, ITextModelService),\n    __param(5, IInstantiationService),\n    __param(6, peekView.IPeekViewService),\n    __param(7, ILabelService),\n    __param(8, IUndoRedoService),\n    __param(9, IKeybindingService),\n    __param(10, ILanguageService),\n    __param(11, ILanguageConfigurationService)\n], ReferenceWidget);\nexport { ReferenceWidget };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { getOuterEditor, PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { CommandsRegistry } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingsRegistry } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { IListService, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse, WorkbenchTreeElementCanExpand } from '../../../../../platform/list/browser/listService.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { OneReference } from '../referencesModel.js';\nimport { LayoutData, ReferenceWidget } from './referencesWidget.js';\nexport const ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false, nls.localize('referenceSearchVisible', \"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'\"));\nlet ReferencesController = class ReferencesController {\n    constructor(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this._editor = _editor;\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._instantiationService = _instantiationService;\n        this._storageService = _storageService;\n        this._configurationService = _configurationService;\n        this._disposables = new DisposableStore();\n        this._requestIdPool = 0;\n        this._ignoreModelChangeEvent = false;\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\n    }\n    static get(editor) {\n        return editor.getContribution(ReferencesController.ID);\n    }\n    dispose() {\n        var _a, _b;\n        this._referenceSearchVisible.reset();\n        this._disposables.dispose();\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    toggleWidget(range, modelPromise, peekMode) {\n        // close current widget and return early is position didn't change\n        let widgetPosition;\n        if (this._widget) {\n            widgetPosition = this._widget.position;\n        }\n        this.closeWidget();\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\n            return;\n        }\n        this._peekMode = peekMode;\n        this._referenceSearchVisible.set(true);\n        // close the widget on model/mode changes\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => { this.closeWidget(); }));\n        this._disposables.add(this._editor.onDidChangeModel(() => {\n            if (!this._ignoreModelChangeEvent) {\n                this.closeWidget();\n            }\n        }));\n        const storageKey = 'peekViewLayout';\n        const data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* StorageScope.PROFILE */, '{}'));\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\n        this._widget.show(range);\n        this._disposables.add(this._widget.onDidClose(() => {\n            modelPromise.cancel();\n            if (this._widget) {\n                this._storageService.store(storageKey, JSON.stringify(this._widget.layoutData), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n                this._widget = undefined;\n            }\n            this.closeWidget();\n        }));\n        this._disposables.add(this._widget.onDidSelectReference(event => {\n            const { element, kind } = event;\n            if (!element) {\n                return;\n            }\n            switch (kind) {\n                case 'open':\n                    if (event.source !== 'editor' || !this._configurationService.getValue('editor.stablePeek')) {\n                        // when stable peek is configured we don't close\n                        // the peek window on selecting the editor\n                        this.openReference(element, false, false);\n                    }\n                    break;\n                case 'side':\n                    this.openReference(element, true, false);\n                    break;\n                case 'goto':\n                    if (peekMode) {\n                        this._gotoReference(element);\n                    }\n                    else {\n                        this.openReference(element, false, true);\n                    }\n                    break;\n            }\n        }));\n        const requestId = ++this._requestIdPool;\n        modelPromise.then(model => {\n            var _a;\n            // still current request? widget still open?\n            if (requestId !== this._requestIdPool || !this._widget) {\n                model.dispose();\n                return undefined;\n            }\n            (_a = this._model) === null || _a === void 0 ? void 0 : _a.dispose();\n            this._model = model;\n            // show widget\n            return this._widget.setModel(this._model).then(() => {\n                if (this._widget && this._model && this._editor.hasModel()) { // might have been closed\n                    // set title\n                    if (!this._model.isEmpty) {\n                        this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", this._model.title, this._model.references.length));\n                    }\n                    else {\n                        this._widget.setMetaTitle('');\n                    }\n                    // set 'best' selection\n                    const uri = this._editor.getModel().uri;\n                    const pos = new Position(range.startLineNumber, range.startColumn);\n                    const selection = this._model.nearestReference(uri, pos);\n                    if (selection) {\n                        return this._widget.setSelection(selection).then(() => {\n                            if (this._widget && this._editor.getOption(79 /* EditorOption.peekWidgetDefaultFocus */) === 'editor') {\n                                this._widget.focusOnPreviewEditor();\n                            }\n                        });\n                    }\n                }\n                return undefined;\n            });\n        }, error => {\n            this._notificationService.error(error);\n        });\n    }\n    changeFocusBetweenPreviewAndReferences() {\n        if (!this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        if (this._widget.isPreviewEditorFocused()) {\n            this._widget.focusOnReferenceTree();\n        }\n        else {\n            this._widget.focusOnPreviewEditor();\n        }\n    }\n    goToNextOrPreviousReference(fwd) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\n                // can be called while still resolving...\n                return;\n            }\n            const currentPosition = this._widget.position;\n            if (!currentPosition) {\n                return;\n            }\n            const source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\n            if (!source) {\n                return;\n            }\n            const target = this._model.nextOrPreviousReference(source, fwd);\n            const editorFocus = this._editor.hasTextFocus();\n            const previewEditorFocus = this._widget.isPreviewEditorFocused();\n            yield this._widget.setSelection(target);\n            yield this._gotoReference(target);\n            if (editorFocus) {\n                this._editor.focus();\n            }\n            else if (this._widget && previewEditorFocus) {\n                this._widget.focusOnPreviewEditor();\n            }\n        });\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\n                // can be called while still resolving...\n                return;\n            }\n            yield this._widget.revealReference(reference);\n        });\n    }\n    closeWidget(focusEditor = true) {\n        var _a, _b;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._referenceSearchVisible.reset();\n        this._disposables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n        if (focusEditor) {\n            this._editor.focus();\n        }\n        this._requestIdPool += 1; // Cancel pending requests\n    }\n    _gotoReference(ref) {\n        if (this._widget) {\n            this._widget.hide();\n        }\n        this._ignoreModelChangeEvent = true;\n        const range = Range.lift(ref.range).collapseToStart();\n        return this._editorService.openCodeEditor({\n            resource: ref.uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */ }\n        }, this._editor).then(openedEditor => {\n            var _a;\n            this._ignoreModelChangeEvent = false;\n            if (!openedEditor || !this._widget) {\n                // something went wrong...\n                this.closeWidget();\n                return;\n            }\n            if (this._editor === openedEditor) {\n                //\n                this._widget.show(range);\n                this._widget.focusOnReferenceTree();\n            }\n            else {\n                // we opened a different editor instance which means a different controller instance.\n                // therefore we stop with this controller and continue with the other\n                const other = ReferencesController.get(openedEditor);\n                const model = this._model.clone();\n                this.closeWidget();\n                openedEditor.focus();\n                other === null || other === void 0 ? void 0 : other.toggleWidget(range, createCancelablePromise(_ => Promise.resolve(model)), (_a = this._peekMode) !== null && _a !== void 0 ? _a : false);\n            }\n        }, (err) => {\n            this._ignoreModelChangeEvent = false;\n            onUnexpectedError(err);\n        });\n    }\n    openReference(ref, sideBySide, pinned) {\n        // clear stage\n        if (!sideBySide) {\n            this.closeWidget();\n        }\n        const { uri, range } = ref;\n        this._editorService.openCodeEditor({\n            resource: uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor, sideBySide);\n    }\n};\nReferencesController.ID = 'editor.contrib.referencesController';\nReferencesController = __decorate([\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, INotificationService),\n    __param(5, IInstantiationService),\n    __param(6, IStorageService),\n    __param(7, IConfigurationService)\n], ReferencesController);\nexport { ReferencesController };\nfunction withController(accessor, fn) {\n    const outerEditor = getOuterEditor(accessor);\n    if (!outerEditor) {\n        return;\n    }\n    const controller = ReferencesController.get(outerEditor);\n    if (controller) {\n        fn(controller);\n    }\n}\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'togglePeekWidgetFocus',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 60 /* KeyCode.F2 */),\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.changeFocusBetweenPreviewAndReferences();\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToNextReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 62 /* KeyCode.F4 */,\n    secondary: [70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(true);\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToPreviousReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 1024 /* KeyMod.Shift */ | 62 /* KeyCode.F4 */,\n    secondary: [1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(false);\n        });\n    }\n});\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\nCommandsRegistry.registerCommandAlias('goToNextReferenceFromEmbeddedEditor', 'goToNextReference');\nCommandsRegistry.registerCommandAlias('goToPreviousReferenceFromEmbeddedEditor', 'goToPreviousReference');\n// close\nCommandsRegistry.registerCommandAlias('closeReferenceSearchEditor', 'closeReferenceSearch');\nCommandsRegistry.registerCommand('closeReferenceSearch', accessor => withController(accessor, controller => controller.closeWidget()));\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 101,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */ + 50,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'revealReference',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */,\n    primary: 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 3 /* KeyCode.Enter */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */]\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.revealReference(focus[0]));\n        }\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'openReferenceToSide',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 256 /* KeyMod.WinCtrl */ | 3 /* KeyCode.Enter */\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.openReference(focus[0], true, true));\n        }\n    }\n});\nCommandsRegistry.registerCommand('openReference', (accessor) => {\n    var _a;\n    const listService = accessor.get(IListService);\n    const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n    if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n        withController(accessor, controller => controller.openReference(focus[0], false, true));\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { defaultGenerator } from '../../../../base/common/idGenerator.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { basename, extUri } from '../../../../base/common/resources.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nexport class OneReference {\n    constructor(isProviderFirst, parent, link, _rangeCallback) {\n        this.isProviderFirst = isProviderFirst;\n        this.parent = parent;\n        this.link = link;\n        this._rangeCallback = _rangeCallback;\n        this.id = defaultGenerator.nextId();\n    }\n    get uri() {\n        return this.link.uri;\n    }\n    get range() {\n        var _a, _b;\n        return (_b = (_a = this._range) !== null && _a !== void 0 ? _a : this.link.targetSelectionRange) !== null && _b !== void 0 ? _b : this.link.range;\n    }\n    set range(value) {\n        this._range = value;\n        this._rangeCallback(this);\n    }\n    get ariaMessage() {\n        var _a;\n        const preview = (_a = this.parent.getPreview(this)) === null || _a === void 0 ? void 0 : _a.preview(this.range);\n        if (!preview) {\n            return localize('aria.oneReference', \"symbol in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n        else {\n            return localize({ key: 'aria.oneReference.preview', comment: ['Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code'] }, \"symbol in {0} on line {1} at column {2}, {3}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn, preview.value);\n        }\n    }\n}\nexport class FilePreview {\n    constructor(_modelReference) {\n        this._modelReference = _modelReference;\n    }\n    dispose() {\n        this._modelReference.dispose();\n    }\n    preview(range, n = 8) {\n        const model = this._modelReference.object.textEditorModel;\n        if (!model) {\n            return undefined;\n        }\n        const { startLineNumber, startColumn, endLineNumber, endColumn } = range;\n        const word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\n        const beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\n        const afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        const before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\n        const inside = model.getValueInRange(range);\n        const after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\n        return {\n            value: before + inside + after,\n            highlight: { start: before.length, end: before.length + inside.length }\n        };\n    }\n}\nexport class FileReferences {\n    constructor(parent, uri) {\n        this.parent = parent;\n        this.uri = uri;\n        this.children = [];\n        this._previews = new ResourceMap();\n    }\n    dispose() {\n        dispose(this._previews.values());\n        this._previews.clear();\n    }\n    getPreview(child) {\n        return this._previews.get(child.uri);\n    }\n    get ariaMessage() {\n        const len = this.children.length;\n        if (len === 1) {\n            return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\n        }\n        else {\n            return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\n        }\n    }\n    resolve(textModelResolverService) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._previews.size !== 0) {\n                return this;\n            }\n            for (const child of this.children) {\n                if (this._previews.has(child.uri)) {\n                    continue;\n                }\n                try {\n                    const ref = yield textModelResolverService.createModelReference(child.uri);\n                    this._previews.set(child.uri, new FilePreview(ref));\n                }\n                catch (err) {\n                    onUnexpectedError(err);\n                }\n            }\n            return this;\n        });\n    }\n}\nexport class ReferencesModel {\n    constructor(links, title) {\n        this.groups = [];\n        this.references = [];\n        this._onDidChangeReferenceRange = new Emitter();\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\n        this._links = links;\n        this._title = title;\n        // grouping and sorting\n        const [providersFirst] = links;\n        links.sort(ReferencesModel._compareReferences);\n        let current;\n        for (const link of links) {\n            if (!current || !extUri.isEqual(current.uri, link.uri, true)) {\n                // new group\n                current = new FileReferences(this, link.uri);\n                this.groups.push(current);\n            }\n            // append, check for equality first!\n            if (current.children.length === 0 || ReferencesModel._compareReferences(link, current.children[current.children.length - 1]) !== 0) {\n                const oneRef = new OneReference(providersFirst === link, current, link, ref => this._onDidChangeReferenceRange.fire(ref));\n                this.references.push(oneRef);\n                current.children.push(oneRef);\n            }\n        }\n    }\n    dispose() {\n        dispose(this.groups);\n        this._onDidChangeReferenceRange.dispose();\n        this.groups.length = 0;\n    }\n    clone() {\n        return new ReferencesModel(this._links, this._title);\n    }\n    get title() {\n        return this._title;\n    }\n    get isEmpty() {\n        return this.groups.length === 0;\n    }\n    get ariaMessage() {\n        if (this.isEmpty) {\n            return localize('aria.result.0', \"No results found\");\n        }\n        else if (this.references.length === 1) {\n            return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\n        }\n        else if (this.groups.length === 1) {\n            return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\n        }\n        else {\n            return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\n        }\n    }\n    nextOrPreviousReference(reference, next) {\n        const { parent } = reference;\n        let idx = parent.children.indexOf(reference);\n        const childCount = parent.children.length;\n        const groupCount = parent.parent.groups.length;\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\n            // cycling within one file\n            if (next) {\n                idx = (idx + 1) % childCount;\n            }\n            else {\n                idx = (idx + childCount - 1) % childCount;\n            }\n            return parent.children[idx];\n        }\n        idx = parent.parent.groups.indexOf(parent);\n        if (next) {\n            idx = (idx + 1) % groupCount;\n            return parent.parent.groups[idx].children[0];\n        }\n        else {\n            idx = (idx + groupCount - 1) % groupCount;\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\n        }\n    }\n    nearestReference(resource, position) {\n        const nearest = this.references.map((ref, idx) => {\n            return {\n                idx,\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\n            };\n        }).sort((a, b) => {\n            if (a.prefixLen > b.prefixLen) {\n                return -1;\n            }\n            else if (a.prefixLen < b.prefixLen) {\n                return 1;\n            }\n            else if (a.offsetDist < b.offsetDist) {\n                return -1;\n            }\n            else if (a.offsetDist > b.offsetDist) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n        })[0];\n        if (nearest) {\n            return this.references[nearest.idx];\n        }\n        return undefined;\n    }\n    referenceAt(resource, position) {\n        for (const ref of this.references) {\n            if (ref.uri.toString() === resource.toString()) {\n                if (Range.containsPosition(ref.range, position)) {\n                    return ref;\n                }\n            }\n        }\n        return undefined;\n    }\n    firstReference() {\n        for (const ref of this.references) {\n            if (ref.isProviderFirst) {\n                return ref;\n            }\n        }\n        return this.references[0];\n    }\n    static _compareReferences(a, b) {\n        return extUri.compare(a.uri, b.uri) || Range.compareRangesUsingStarts(a.range, b.range);\n    }\n}\n"],"names":["EditorFontZoomIn","id","label","nls","alias","precondition","undefined","accessor","editor","EditorZoom","EditorAction","EditorFontZoomOut","EditorFontZoomReset","registerEditorAction","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","alertFormattingEdits","edits","filter","edit","range","length","i","Range","startLineNumber","endLineNumber","alert","getRealAndSyntheticDocumentFormattersOrdered","documentFormattingEditProvider","documentRangeFormattingEditProvider","model","seen","Set","docFormatter","ordered","formatter","push","extensionId","add","ExtensionIdentifier","rangeFormatter","has","displayName","provideDocumentFormattingEdits","options","token","provideDocumentRangeFormattingEdits","getFullModelRange","FormattingConflicts","selector","dispose","_selectors","unshift","document","mode","this","Iterable","formatDocumentRangesWithSelectedProvider","editorOrModel","rangeOrRanges","progress","instaService","get","IInstantiationService","ILanguageFeaturesService","documentRangeFormattingEditProviderRegistry","isCodeEditor","getModel","provider","select","selected","report","invokeFunction","formatDocumentRangesWithProvider","workerService","IEditorWorkerService","cts","EditorStateCancellationTokenSource","TextModelCancellationTokenSource","ranges","len","asArray","sort","getStartPosition","getEndPosition","computeEdits","getFormattingOptions","hasIntersectingEdit","a","b","mergedA","reduce","acc","val","some","x","otherEdit","allEdits","rawEditsList","isCancellationRequested","j","mergedRange","splice","rawEdits","computeMoreMinimalEdits","uri","minimalEdits","FormattingEdit","revealPositionInCenterIfOutsideViewport","getPosition","initialSelection","Selection","startColumn","endColumn","pushEditOperations","map","text","forceMoveMarkers","undoEdits","formatDocumentWithSelectedProvider","languageFeaturesService","formatDocumentWithProvider","getDocumentRangeFormattingEditsUntilResult","providers","catch","onUnexpectedExternalError","isNonEmptyArray","getDocumentFormattingEditsUntilResult","getOnTypeFormattingEdits","position","ch","onTypeFormattingEditProvider","autoFormatTriggerCharacters","indexOf","provideOnTypeFormattingEdits","LinkedList","CommandsRegistry","args","resource","assertType","URI","resolverService","ITextModelService","createModelReference","reference","object","textEditorModel","CancellationToken","Position","__decorate","decorators","target","key","desc","d","c","arguments","r","Object","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","FormatOnType","_editor","_languageFeaturesService","_workerService","_disposables","DisposableStore","_sessionDisposables","onDidChange","_update","onDidChangeModel","onDidChangeModelLanguage","onDidChangeConfiguration","hasChanged","clear","getOption","hasModel","support","triggerChars","CharacterSet","charCodeAt","onDidType","lastCharCode","_trigger","String","fromCharCode","getSelections","getSelection","isEmpty","CancellationTokenSource","unbind","onDidChangeModelContent","isFlush","cancel","changes","lineNumber","finally","ID","FormatOnPaste","_instantiationService","_callOnDispose","_callOnModel","onDidPaste","Progress","onUnexpectedError","FormatDocumentAction","ContextKeyExpr","EditorContextKeys","kbOpts","kbExpr","primary","linux","weight","contextMenuOpts","group","order","progressService","IEditorProgressService","showWhile","FormatSelectionAction","KeyChord","when","getLineMaxColumn","registerEditorContribution","ICodeEditorService","getFocusedCodeEditor","commandService","ICommandService","executeCommand","newEol","singleEdits","eol","pushEOL","editRange","validateRange","equalsRange","_edits","addUndoStops","pushUndoStop","_handleEolEdits","_isFullModelReplaceEdit","executeEdits","EditOperation","MarkerCoordinate","marker","index","total","MarkerList","resourceFilter","_markerService","_configService","_onDidChange","Emitter","event","_dispoables","_markers","_nextIdx","_resourceFilter","toString","compareOrder","getValue","compareMarker","res","compare","MarkerSeverity","severity","updateMarker","read","severities","m","onMarkerChanged","uris","fire","fwd","found","idx","findIndex","binarySearch","word","getWordAtPosition","containsPosition","isBeforeOrEqual","oldIdx","_initIdx","IMarkerService","IConfigurationService","IMarkerNavigationService","createDecorator","MarkerNavigationService","_provider","getMarkerList","registerSingleton","MessageWidget","parent","onRelatedInformation","_openerService","_labelService","_lines","_longestLineLength","_relatedDiagnostics","WeakMap","domNode","createElement","className","_messageBlock","classList","setAttribute","appendChild","_relatedBlock","dom","addStandardDisposableListener","preventDefault","related","_scrollable","ScrollableElement","horizontal","vertical","useShadows","horizontalScrollbarSize","verticalScrollbarSize","getDomNode","onScroll","style","left","scrollLeft","top","scrollTop","source","message","relatedInformation","code","sourceAndCodeLength","lines","splitLines","line","Math","max","clearNode","getAriaLabel","applyFontInfo","lastLineElement","innerText","height","lineHeight","detailsElement","sourceElement","codeElement","_codeLink","$","onclick","open","allowCommands","stopPropagation","append","relatedInformationNode","paddingTop","floor","container","relatedResource","getUriBasenameLabel","title","getUriLabel","set","relatedMessage","fontInfo","scrollWidth","ceil","typicalFullwidthCharacterWidth","scrollHeight","setScrollDimensions","width","min","severityLabel","ariaLabel","getLineCount","lineContent","getLineContent","MarkerNavigationWidget","_themeService","_menuService","instantiationService","_contextKeyService","showArrow","showFrame","isAccessible","frameWidth","_onDidSelectRelatedInformation","onDidSelectRelatedInformation","_severity","_backgroundColor","Color","_applyTheme","getColorTheme","onDidColorThemeChange","bind","create","theme","getColor","editorMarkerNavigationBackground","colorId","editorMarkerNavigationError","headerBackground","editorMarkerNavigationErrorHeader","editorMarkerNavigationWarning","editorMarkerNavigationWarningHeader","editorMarkerNavigationInfo","editorMarkerNavigationInfoHeader","frameColor","headerBg","arrowColor","headerBackgroundColor","primaryHeadingColor","peekViewTitleForeground","secondaryHeadingColor","peekViewTitleInfoForeground","_parentContainer","backgroundColor","_actionbarWidget","actionRunner","onBeforeRun","focus","actions","menu","createMenu","TitleMenu","createAndFillInActionBarActions","icon","_icon","tabIndex","_container","_message","Error","markerIdx","markerCount","remove","update","editorPosition","computeRequiredHeight","detail","setTitle","basename","SeverityIcon","revealPositionNearTop","_relayout","heightInPixel","widthInPixel","_heightInPixel","layout","getHeightInLines","PeekViewWidget","MenuId","IThemeService","IOpenerService","IMenuService","IContextKeyService","ILabelService","errorDefault","oneOf","editorErrorForeground","editorErrorBorder","warningDefault","editorWarningForeground","editorWarningBorder","infoDefault","editorInfoForeground","editorInfoBorder","registerColor","dark","light","hcDark","contrastBorder","hcLight","transparent","editorBackground","MarkerController","_markerNavigationService","_editorService","_sessionDispoables","_widgetVisible","CONTEXT_MARKERS_NAVIGATION_VISIBLE","bindTo","_cleanUp","reset","_widget","_model","matches","reusePosition","move","createInstance","onDidClose","close","onDidChangeCursorPosition","_a","_b","_c","resetIndex","info","find","showStale","openCodeEditor","pinned","revealIfOpened","selection","collapseToStart","focusEditor","_getOrCreateModel","showAtMarker","multiFile","selectionRevealType","otherEditor","nagivate","getContribution","MarkerNavigationAction","_next","_multiFile","opts","_accessor","NextMarkerAction","LABEL","menuOpts","menuId","registerIcon","Codicon","PrevMarkerAction","NextMarkerInFilesAction","comment","PrevMarkerInFilesAction","RawContextKey","MarkerCommand","EditorCommand","registerEditorCommand","handler","secondary","ctxHasSymbols","localize","ISymbolNavigationService","SymbolNavigationService","contextKeyService","_notificationService","_keybindingService","_currentModel","_currentIdx","_ignoreEditorChange","_ctxHasSymbols","_currentState","_currentMessage","anchor","refModel","references","_showMessage","editorState","EditorState","listener","_","getActiveCodeEditor","seenUri","seenPosition","isEqual","combinedDisposable","kb","lookupKeybinding","getLabel","status","INotificationService","IKeybindingService","revealNext","KeybindingsRegistry","editorService","_listener","Map","onCodeEditorRemove","_onDidRemoveEditor","onCodeEditorAdd","_onDidAddEditor","listCodeEditors","forEach","values","delete","_d","_e","_f","_g","_h","MenuRegistry","submenu","_goToActionIds","registerGoToAction","ctor","registerInstantiatedEditorAction","SymbolNavigationAnchor","thing","corePosition","SymbolNavigationAction","configuration","arg","notificationService","symbolNavService","is","promise","raceCancellation","_getLocationModel","ariaMessage","referenceAt","altActionId","_getAlternativeCommand","_activeAlternativeCommands","altAction","getAction","referenceCount","muteMessage","MessageController","showMessage","_getNoResultFoundMessage","run","_onResult","err","error","gotoLocation","_getGoToPreference","EmbeddedCodeEditorWidget","openInPeek","_openInPeek","firstReference","peek","_openReference","openToSide","targetEditor","put","sideBySide","highlight","isLocationLink","targetSelectionRange","selectionSource","modelNow","decorations","createDecorationsCollection","description","setTimeout","controller","ReferencesController","toggleWidget","createCancelablePromise","DefinitionAction","ReferencesModel","getDefinitionsAtPosition","definitionProvider","alternativeDefinitionCommand","multipleDefinitions","goToDefinitionKb","isWeb","isStandalone","GoToDefinitionAction","OpenDefinitionToSideAction","PeekDefinitionAction","PeekContext","DeclarationAction","getDeclarationsAtPosition","declarationProvider","alternativeDeclarationCommand","multipleDeclarations","GoToDeclarationAction","TypeDefinitionAction","getTypeDefinitionsAtPosition","typeDefinitionProvider","alternativeTypeDefinitionCommand","multipleTypeDefinitions","GoToTypeDefinitionAction","PeekTypeDefinitionAction","ImplementationAction","getImplementationsAtPosition","implementationProvider","alternativeImplementationCommand","multipleImplementations","GoToImplementationAction","PeekImplementationAction","ReferencesAction","alternativeReferenceCommand","multipleReferences","getReferencesAtPosition","referenceProvider","GenericGoToLocationAction","config","_references","_gotoMultipleBehaviour","_position","_token","name","constraint","Array","multiple","noResultsMessage","isArray","setPosition","invokeWithinContext","command","Boolean","codeEditorService","control","column","item","getLocationLinks","registry","provide","promises","all","provideDefinition","provideDeclaration","provideImplementation","provideTypeDefinition","compact","provideReferences","includeDeclaration","resultWithoutDeclaration","_sortedAndDeduped","callback","rawLinks","modelLinks","ref","link","registerModelAndPositionCommand","hasModifier","modifier","ClickLinkMouseEvent","hasTriggerModifier","triggerModifier","hasSideBySideModifier","triggerSideBySideModifier","isNoneOrSingleMouseDown","ClickLinkKeyboardEvent","keyCodeIsTriggerKey","keyCode","triggerKey","keyCodeIsSideBySideKey","triggerSideBySideKey","ClickLinkOptions","other","createOptions","multiCursorModifier","platform","ClickLinkGesture","_onMouseMoveOrRelevantKeyDown","_register","onMouseMoveOrRelevantKeyDown","_onExecute","onExecute","_onCancel","onCancel","_opts","_lastMouseMoveEvent","_hasTriggerKeyOnMouseDown","_lineNumberOnMouseDown","newOpts","equals","onMouseMove","_onEditorMouseMove","onMouseDown","_onEditorMouseDown","onMouseUp","_onEditorMouseUp","onKeyDown","_onEditorKeyDown","onKeyUp","_onEditorKeyUp","onMouseDrag","_resetHandler","onDidChangeCursorSelection","_onDidChangeCursorSelection","onDidScrollChange","scrollTopChanged","scrollLeftChanged","mouseEvent","currentLineNumber","Disposable","GotoDefinitionAtPositionEditorContribution","textModelResolverService","languageService","toUnhook","toUnhookForKeyboard","currentWordAtPosition","previousPromise","linkDecorations","linkGesture","keyboardEvent","startFindDefinitionFromMouse","withNullAsUndefined","isEnabled","gotoDefinition","removeLinkDecorations","startFindDefinition","withKey","type","state","findDefinition","results","validate","addDecoration","MarkdownString","appendText","wordRange","previewValue","getPreviewValue","originSelectionRange","languageId","guessLanguageIdByFilepathOrFirstLine","appendCodeblock","rangeToUse","MAX_SOURCE_PREVIEW_LINES","getPreviewRangeBasedOnIndentation","stripIndentationFromPreviewRange","previewRange","minIndent","getLineFirstNonWhitespaceColumn","endIndent","getValueInRange","replace","RegExp","trim","startIndent","maxLineNumber","hoverMessage","newDecorations","inlineClassName","canPeek","isInPeekEditor","ILanguageService","registerThemingParticipant","collector","activeLinkForeground","editorActiveLinkForeground","addRule","DataSource","_resolverService","element","FileReferences","groups","children","Delegate","FileReferencesRenderer","OneReferenceRenderer","StringRepresentationProvider","OneReference","parts","getPreview","preview","IdentityProvider","FileReferencesTemplate","themeService","file","IconLabel","supportHighlights","badge","CountBadge","attachBadgeStyler","dirname","setLabel","relative","setCount","setTitleFormat","templateId","node","template","createMatches","filterData","templateData","OneReferenceTemplate","HighlightedLabel","score","FuzzyScore","toggle","AccessibilityProvider","DecorationsManager","_decorations","_decorationIgnoreSet","_callOnModelChange","_onModelChanged","removeDecorations","_addDecorations","onDidChangeDecorations","_onDecorationChanged","newDecorationsActualIndex","oneReference","DecorationOptions","changeDecorations","changeAccessor","deltaDecorations","toRemove","decorationId","newRange","getDecorationRange","ignore","keys","ModelDecorationOptions","stickiness","LayoutData","ratio","heightInLines","raw","data","JSON","parse","ReferencesTree","WorkbenchAsyncDataTree","ReferenceWidget","_defaultTreeKeyboardSupport","layoutData","_textModelResolverService","_peekViewService","_uriLabel","_undoRedoService","_languageService","_languageConfigurationService","isResizeable","supportOnTitleClick","_disposeOnNewModel","_onDidSelectReference","onDidSelectReference","_dim","Dimension","addExclusiveWidget","setModel","_preview","_previewNotAvailableMessage","_tree","_previewModelReference","_splitView","borderColor","peekView","where","domFocus","hasTextFocus","_getFocusedReference","kind","ctrlKey","metaKey","altKey","containerElement","setCssClass","_messageContainer","hide","SplitView","orientation","_previewContainer","scrollBeyondLastLine","scrollbar","verticalHasArrows","horizontalHasArrows","alwaysConsumeMouseWheel","overviewRulerLanes","fixedOverflowWidgets","minimap","enabled","TextModel","PLAINTEXT_LANGUAGE_ID","_treeContainer","treeOptions","keyboardSupport","accessibilityProvider","keyboardNavigationLabelProvider","identityProvider","openOnSingleClick","selectionNavigation","overrideStyles","listBackground","dispatchEvent","addView","Event","minimumSize","maximumSize","Number","MAX_VALUE","Sizing","onDidSashChange","getViewSize","onEvent","_revealReference","onDidOpen","editorOptions","_doLayoutBody","_viewZone","resizeView","setSelection","setFocus","newModel","_onNewModel","show","_decorationsManager","onDidChangeReferenceRange","rerender","focusOnReferenceTree","setInput","getFocus","revealParent","_revealedReference","scheme","Schemas","basenameOrAuthority","getInput","reveal","expand","scrollType","sel","revealRangeInCenter","IUndoRedoService","ILanguageConfigurationService","ctxReferenceSearchVisible","_storageService","_configurationService","_requestIdPool","_ignoreModelChangeEvent","_referenceSearchVisible","modelPromise","peekMode","widgetPosition","closeWidget","_peekMode","storageKey","fromJSON","store","stringify","openReference","_gotoReference","requestId","setMetaTitle","pos","nearestReference","focusOnPreviewEditor","isPreviewEditorFocused","currentPosition","nextOrPreviousReference","editorFocus","previewEditorFocus","revealReference","openedEditor","clone","withController","fn","outerEditor","getOuterEditor","IStorageService","changeFocusBetweenPreviewAndReferences","goToNextOrPreviousReference","mac","WorkbenchListFocusContextKey","WorkbenchTreeElementCanCollapse","WorkbenchTreeElementCanExpand","IListService","lastFocusedList","isProviderFirst","_rangeCallback","defaultGenerator","_range","FilePreview","_modelReference","n","getWordUntilPosition","beforeRange","afterRange","before","inside","after","start","end","_previews","ResourceMap","child","fsPath","size","links","_onDidChangeReferenceRange","_links","_title","current","providersFirst","_compareReferences","extUri","oneRef","childCount","groupCount","nearest","prefixLen","strings","offsetDist","abs"],"sourceRoot":""}