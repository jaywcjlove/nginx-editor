{"version":3,"file":"static/js/monaco-editor-vendor.ec2afca6.7f4ad1d6.js","mappings":"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","sources":["../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/symbolNavigation.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToCommands.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToSymbol.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesTree.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesController.js","../node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/referencesModel.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/getHover.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/colorHoverParticipant.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverOperation.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/markerHoverParticipant.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/contentHover.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/marginHover.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hover.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/hoverTypes.js","../node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/markdownHoverParticipant.js","../node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplaceCommand.js","../node_modules/monaco-editor/esm/vs/editor/contrib/inPlaceReplace/browser/inPlaceReplace.js","../node_modules/monaco-editor/esm/vs/editor/contrib/indentation/browser/indentUtils.js","../node_modules/monaco-editor/esm/vs/editor/contrib/indentation/browser/indentation.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { combinedDisposable, DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nexport const ctxHasSymbols = new RawContextKey('hasSymbols', false, localize('hasSymbols', \"Whether there are symbol locations that can be navigated via keyboard-only.\"));\nexport const ISymbolNavigationService = createDecorator('ISymbolNavigationService');\nlet SymbolNavigationService = class SymbolNavigationService {\n    constructor(contextKeyService, _editorService, _notificationService, _keybindingService) {\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._keybindingService = _keybindingService;\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n        this._ignoreEditorChange = false;\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\n    }\n    reset() {\n        var _a, _b;\n        this._ctxHasSymbols.reset();\n        (_a = this._currentState) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentMessage) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n    }\n    put(anchor) {\n        const refModel = anchor.parent.parent;\n        if (refModel.references.length <= 1) {\n            this.reset();\n            return;\n        }\n        this._currentModel = refModel;\n        this._currentIdx = refModel.references.indexOf(anchor);\n        this._ctxHasSymbols.set(true);\n        this._showMessage();\n        const editorState = new EditorState(this._editorService);\n        const listener = editorState.onDidChange(_ => {\n            if (this._ignoreEditorChange) {\n                return;\n            }\n            const editor = this._editorService.getActiveCodeEditor();\n            if (!editor) {\n                return;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!model || !position) {\n                return;\n            }\n            let seenUri = false;\n            let seenPosition = false;\n            for (const reference of refModel.references) {\n                if (isEqual(reference.uri, model.uri)) {\n                    seenUri = true;\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\n                }\n                else if (seenUri) {\n                    break;\n                }\n            }\n            if (!seenUri || !seenPosition) {\n                this.reset();\n            }\n        });\n        this._currentState = combinedDisposable(editorState, listener);\n    }\n    revealNext(source) {\n        if (!this._currentModel) {\n            return Promise.resolve();\n        }\n        // get next result and advance\n        this._currentIdx += 1;\n        this._currentIdx %= this._currentModel.references.length;\n        const reference = this._currentModel.references[this._currentIdx];\n        // status\n        this._showMessage();\n        // open editor, ignore events while that happens\n        this._ignoreEditorChange = true;\n        return this._editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(reference.range),\n                selectionRevealType: 3 /* NearTopIfOutsideViewport */\n            }\n        }, source).finally(() => {\n            this._ignoreEditorChange = false;\n        });\n    }\n    _showMessage() {\n        var _a;\n        (_a = this._currentMessage) === null || _a === void 0 ? void 0 : _a.dispose();\n        const kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\n        const message = kb\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\n        this._currentMessage = this._notificationService.status(message);\n    }\n};\nSymbolNavigationService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ICodeEditorService),\n    __param(2, INotificationService),\n    __param(3, IKeybindingService)\n], SymbolNavigationService);\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, true);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.gotoNextSymbolFromResult',\n            precondition: ctxHasSymbols,\n            kbOpts: {\n                weight: 100 /* EditorContrib */,\n                primary: 70 /* F12 */\n            }\n        });\n    }\n    runEditorCommand(accessor, editor) {\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'editor.gotoNextSymbolFromResult.cancel',\n    weight: 100 /* EditorContrib */,\n    when: ctxHasSymbols,\n    primary: 9 /* Escape */,\n    handler(accessor) {\n        accessor.get(ISymbolNavigationService).reset();\n    }\n});\n//\nlet EditorState = class EditorState {\n    constructor(editorService) {\n        this._listener = new Map();\n        this._disposables = new DisposableStore();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._onDidChange.dispose();\n        dispose(this._listener.values());\n    }\n    _onDidAddEditor(editor) {\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(_ => this._onDidChange.fire({ editor })), editor.onDidChangeModelContent(_ => this._onDidChange.fire({ editor }))));\n    }\n    _onDidRemoveEditor(editor) {\n        var _a;\n        (_a = this._listener.get(editor)) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._listener.delete(editor);\n    }\n};\nEditorState = __decorate([\n    __param(0, ICodeEditorService)\n], EditorState);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar _a, _b, _c, _d, _e, _f, _g, _h;\nimport { isStandalone } from '../../../../base/browser/browser.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { isWeb } from '../../../../base/common/platform.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction, registerInstantiatedEditorAction } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport * as corePosition from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { isLocationLink } from '../../../common/languages.js';\nimport { ReferencesController } from './peek/referencesController.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ISymbolNavigationService } from './symbolNavigation.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { getDeclarationsAtPosition, getDefinitionsAtPosition, getImplementationsAtPosition, getReferencesAtPosition, getTypeDefinitionsAtPosition } from './goToSymbol.js';\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\n    submenu: MenuId.EditorContextPeek,\n    title: nls.localize('peek.submenu', \"Peek\"),\n    group: 'navigation',\n    order: 100\n});\nconst _goToActionIds = new Set();\nfunction registerGoToAction(ctor) {\n    const result = new ctor();\n    registerInstantiatedEditorAction(result);\n    _goToActionIds.add(result.id);\n    return result;\n}\nexport class SymbolNavigationAnchor {\n    constructor(model, position) {\n        this.model = model;\n        this.position = position;\n    }\n    static is(thing) {\n        if (!thing || typeof thing !== 'object') {\n            return false;\n        }\n        if (thing instanceof SymbolNavigationAnchor) {\n            return true;\n        }\n        if (corePosition.Position.isIPosition(thing.position) && thing.model) {\n            return true;\n        }\n        return false;\n    }\n}\nexport class SymbolNavigationAction extends EditorAction {\n    constructor(configuration, opts) {\n        super(opts);\n        this.configuration = configuration;\n    }\n    run(accessor, editor, arg) {\n        if (!editor.hasModel()) {\n            return Promise.resolve(undefined);\n        }\n        const notificationService = accessor.get(INotificationService);\n        const editorService = accessor.get(ICodeEditorService);\n        const progressService = accessor.get(IEditorProgressService);\n        const symbolNavService = accessor.get(ISymbolNavigationService);\n        const model = editor.getModel();\n        const position = editor.getPosition();\n        const anchor = SymbolNavigationAnchor.is(arg) ? arg : new SymbolNavigationAnchor(model, position);\n        const cts = new EditorStateCancellationTokenSource(editor, 1 /* Value */ | 4 /* Position */);\n        const promise = raceCancellation(this._getLocationModel(anchor.model, anchor.position, cts.token), cts.token).then((references) => __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (!references || cts.token.isCancellationRequested) {\n                return;\n            }\n            alert(references.ariaMessage);\n            let altAction;\n            if (references.referenceAt(model.uri, position)) {\n                const altActionId = this._getAlternativeCommand(editor);\n                if (altActionId !== this.id && _goToActionIds.has(altActionId)) {\n                    altAction = editor.getAction(altActionId);\n                }\n            }\n            const referenceCount = references.references.length;\n            if (referenceCount === 0) {\n                // no result -> show message\n                if (!this.configuration.muteMessage) {\n                    const info = model.getWordAtPosition(position);\n                    (_a = MessageController.get(editor)) === null || _a === void 0 ? void 0 : _a.showMessage(this._getNoResultFoundMessage(info), position);\n                }\n            }\n            else if (referenceCount === 1 && altAction) {\n                // already at the only result, run alternative\n                altAction.run();\n            }\n            else {\n                // normal results handling\n                return this._onResult(editorService, symbolNavService, editor, references);\n            }\n        }), (err) => {\n            // report an error\n            notificationService.error(err);\n        }).finally(() => {\n            cts.dispose();\n        });\n        progressService.showWhile(promise, 250);\n        return promise;\n    }\n    _onResult(editorService, symbolNavService, editor, model) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const gotoLocation = this._getGoToPreference(editor);\n            if (!(editor instanceof EmbeddedCodeEditorWidget) && (this.configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1))) {\n                this._openInPeek(editor, model);\n            }\n            else {\n                const next = model.firstReference();\n                const peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\n                const targetEditor = yield this._openReference(editor, editorService, next, this.configuration.openToSide, !peek);\n                if (peek && targetEditor) {\n                    this._openInPeek(targetEditor, model);\n                }\n                else {\n                    model.dispose();\n                }\n                // keep remaining locations around when using\n                // 'goto'-mode\n                if (gotoLocation === 'goto') {\n                    symbolNavService.put(next);\n                }\n            }\n        });\n    }\n    _openReference(editor, editorService, reference, sideBySide, highlight) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // range is the target-selection-range when we have one\n            // and the fallback is the 'full' range\n            let range = undefined;\n            if (isLocationLink(reference)) {\n                range = reference.targetSelectionRange;\n            }\n            if (!range) {\n                range = reference.range;\n            }\n            if (!range) {\n                return undefined;\n            }\n            const targetEditor = yield editorService.openCodeEditor({\n                resource: reference.uri,\n                options: {\n                    selection: Range.collapseToStart(range),\n                    selectionRevealType: 3 /* NearTopIfOutsideViewport */\n                }\n            }, editor, sideBySide);\n            if (!targetEditor) {\n                return undefined;\n            }\n            if (highlight) {\n                const modelNow = targetEditor.getModel();\n                const ids = targetEditor.deltaDecorations([], [{ range, options: { description: 'symbol-navigate-action-highlight', className: 'symbolHighlight' } }]);\n                setTimeout(() => {\n                    if (targetEditor.getModel() === modelNow) {\n                        targetEditor.deltaDecorations(ids, []);\n                    }\n                }, 350);\n            }\n            return targetEditor;\n        });\n    }\n    _openInPeek(target, model) {\n        const controller = ReferencesController.get(target);\n        if (controller && target.hasModel()) {\n            controller.toggleWidget(target.getSelection(), createCancelablePromise(_ => Promise.resolve(model)), this.configuration.openInPeek);\n        }\n        else {\n            model.dispose();\n        }\n    }\n}\n//#region --- DEFINITION\nexport class DefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDefinitionsAtPosition(model, position, token), nls.localize('def.title', 'Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\n            : nls.localize('generic.noResults', \"No definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(51 /* gotoLocation */).alternativeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(51 /* gotoLocation */).multipleDefinitions;\n    }\n}\nconst goToDefinitionKb = isWeb && !isStandalone\n    ? 2048 /* CtrlCmd */ | 70 /* F12 */\n    : 70 /* F12 */;\nregisterGoToAction((_a = class GoToDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToDefinitionAction.id,\n                label: nls.localize('actions.goToDecl.label', \"Go to Definition\"),\n                alias: 'Go to Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: goToDefinitionKb,\n                    weight: 100 /* EditorContrib */\n                },\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.1\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', GoToDefinitionAction.id);\n        }\n    },\n    _a.id = 'editor.action.revealDefinition',\n    _a));\nregisterGoToAction((_b = class OpenDefinitionToSideAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: true,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: OpenDefinitionToSideAction.id,\n                label: nls.localize('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\n                alias: 'Open Definition to the Side',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KeyK */, goToDefinitionKb),\n                    weight: 100 /* EditorContrib */\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', OpenDefinitionToSideAction.id);\n        }\n    },\n    _b.id = 'editor.action.revealDefinitionAside',\n    _b));\nregisterGoToAction((_c = class PeekDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekDefinitionAction.id,\n                label: nls.localize('actions.previewDecl.label', \"Peek Definition\"),\n                alias: 'Peek Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 512 /* Alt */ | 70 /* F12 */,\n                    linux: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 68 /* F10 */ },\n                    weight: 100 /* EditorContrib */\n                },\n                contextMenuOpts: {\n                    menuId: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 2\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', PeekDefinitionAction.id);\n        }\n    },\n    _c.id = 'editor.action.peekDefinition',\n    _c));\n//#endregion\n//#region --- DECLARATION\nclass DeclarationAction extends SymbolNavigationAction {\n    _getLocationModel(model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDeclarationsAtPosition(model, position, token), nls.localize('decl.title', 'Declarations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(51 /* gotoLocation */).alternativeDeclarationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(51 /* gotoLocation */).multipleDeclarations;\n    }\n}\nregisterGoToAction((_d = class GoToDeclarationAction extends DeclarationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToDeclarationAction.id,\n                label: nls.localize('actions.goToDeclaration.label', \"Go to Declaration\"),\n                alias: 'Go to Declaration',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.3\n                },\n            });\n        }\n        _getNoResultFoundMessage(info) {\n            return info && info.word\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\n        }\n    },\n    _d.id = 'editor.action.revealDeclaration',\n    _d));\nregisterGoToAction(class PeekDeclarationAction extends DeclarationAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.peekDeclaration',\n            label: nls.localize('actions.peekDecl.label', \"Peek Declaration\"),\n            alias: 'Peek Declaration',\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            contextMenuOpts: {\n                menuId: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 3\n            }\n        });\n    }\n});\n//#endregion\n//#region --- TYPE DEFINITION\nclass TypeDefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getTypeDefinitionsAtPosition(model, position, token), nls.localize('typedef.title', 'Type Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(51 /* gotoLocation */).alternativeTypeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(51 /* gotoLocation */).multipleTypeDefinitions;\n    }\n}\nregisterGoToAction((_e = class GoToTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToTypeDefinitionAction.ID,\n                label: nls.localize('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\n                alias: 'Go to Type Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 0,\n                    weight: 100 /* EditorContrib */\n                },\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.4\n                }\n            });\n        }\n    },\n    _e.ID = 'editor.action.goToTypeDefinition',\n    _e));\nregisterGoToAction((_f = class PeekTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekTypeDefinitionAction.ID,\n                label: nls.localize('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\n                alias: 'Peek Type Definition',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                contextMenuOpts: {\n                    menuId: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 4\n                }\n            });\n        }\n    },\n    _f.ID = 'editor.action.peekTypeDefinition',\n    _f));\n//#endregion\n//#region --- IMPLEMENTATION\nclass ImplementationAction extends SymbolNavigationAction {\n    _getLocationModel(model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getImplementationsAtPosition(model, position, token), nls.localize('impl.title', 'Implementations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(51 /* gotoLocation */).alternativeImplementationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(51 /* gotoLocation */).multipleImplementations;\n    }\n}\nregisterGoToAction((_g = class GoToImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToImplementationAction.ID,\n                label: nls.localize('actions.goToImplementation.label', \"Go to Implementations\"),\n                alias: 'Go to Implementations',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* CtrlCmd */ | 70 /* F12 */,\n                    weight: 100 /* EditorContrib */\n                },\n                contextMenuOpts: {\n                    group: 'navigation',\n                    order: 1.45\n                }\n            });\n        }\n    },\n    _g.ID = 'editor.action.goToImplementation',\n    _g));\nregisterGoToAction((_h = class PeekImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekImplementationAction.ID,\n                label: nls.localize('actions.peekImplementation.label', \"Peek Implementations\"),\n                alias: 'Peek Implementations',\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                kbOpts: {\n                    kbExpr: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 70 /* F12 */,\n                    weight: 100 /* EditorContrib */\n                },\n                contextMenuOpts: {\n                    menuId: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 5\n                }\n            });\n        }\n    },\n    _h.ID = 'editor.action.peekImplementation',\n    _h));\n//#endregion\n//#region --- REFERENCES\nclass ReferencesAction extends SymbolNavigationAction {\n    _getNoResultFoundMessage(info) {\n        return info\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\n            : nls.localize('references.noGeneric', \"No references found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(51 /* gotoLocation */).alternativeReferenceCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(51 /* gotoLocation */).multipleReferences;\n    }\n}\nregisterGoToAction(class GoToReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: 'editor.action.goToReferences',\n            label: nls.localize('goToReferences.label', \"Go to References\"),\n            alias: 'Go to References',\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* Shift */ | 70 /* F12 */,\n                weight: 100 /* EditorContrib */\n            },\n            contextMenuOpts: {\n                group: 'navigation',\n                order: 1.45\n            }\n        });\n    }\n    _getLocationModel(model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(model, position, true, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\nregisterGoToAction(class PeekReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.referenceSearch.trigger',\n            label: nls.localize('references.action.label', \"Peek References\"),\n            alias: 'Peek References',\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            contextMenuOpts: {\n                menuId: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 6\n            }\n        });\n    }\n    _getLocationModel(model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(model, position, false, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\n//#endregion\n//#region --- GENERIC goto symbols command\nclass GenericGoToLocationAction extends SymbolNavigationAction {\n    constructor(config, _references, _gotoMultipleBehaviour) {\n        super(config, {\n            id: 'editor.action.goToLocation',\n            label: nls.localize('label.generic', \"Go to Any Symbol\"),\n            alias: 'Go to Any Symbol',\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n        });\n        this._references = _references;\n        this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\n    }\n    _getLocationModel(_model, _position, _token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\n    }\n    _getGoToPreference(editor) {\n        var _a;\n        return (_a = this._gotoMultipleBehaviour) !== null && _a !== void 0 ? _a : editor.getOption(51 /* gotoLocation */).multipleReferences;\n    }\n    _getAlternativeCommand() { return ''; }\n}\nCommandsRegistry.registerCommand({\n    id: 'editor.action.goToLocations',\n    description: {\n        description: 'Go to locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n            { name: 'noResultsMessage', description: 'Human readable message that shows when locations is empty.' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple, noResultsMessage, openInPeek) => __awaiter(void 0, void 0, void 0, function* () {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        assertType(Array.isArray(references));\n        assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\n        assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\n        const editorService = accessor.get(ICodeEditorService);\n        const editor = yield editorService.openCodeEditor({ resource }, editorService.getFocusedCodeEditor());\n        if (isCodeEditor(editor)) {\n            editor.setPosition(position);\n            editor.revealPositionInCenterIfOutsideViewport(position, 0 /* Smooth */);\n            return editor.invokeWithinContext(accessor => {\n                const command = new class extends GenericGoToLocationAction {\n                    _getNoResultFoundMessage(info) {\n                        return noResultsMessage || super._getNoResultFoundMessage(info);\n                    }\n                }({\n                    muteMessage: !Boolean(noResultsMessage),\n                    openInPeek: Boolean(openInPeek),\n                    openToSide: false\n                }, references, multiple);\n                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\n            });\n        }\n    })\n});\nCommandsRegistry.registerCommand({\n    id: 'editor.action.peekLocations',\n    description: {\n        description: 'Peek locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple) => __awaiter(void 0, void 0, void 0, function* () {\n        accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, undefined, true);\n    })\n});\n//#endregion\n//#region --- REFERENCE search special commands\nCommandsRegistry.registerCommand({\n    id: 'editor.action.findReferences',\n    handler: (accessor, resource, position) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        const codeEditorService = accessor.get(ICodeEditorService);\n        return codeEditorService.openCodeEditor({ resource }, codeEditorService.getFocusedCodeEditor()).then(control => {\n            if (!isCodeEditor(control) || !control.hasModel()) {\n                return undefined;\n            }\n            const controller = ReferencesController.get(control);\n            if (!controller) {\n                return undefined;\n            }\n            const references = createCancelablePromise(token => getReferencesAtPosition(control.getModel(), corePosition.Position.lift(position), false, token).then(references => new ReferencesModel(references, nls.localize('ref.title', 'References'))));\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            return Promise.resolve(controller.toggleWidget(range, references, false));\n        });\n    }\n});\n// use NEW command\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\n//#endregion\n// -- unconditionally register goto-action\nMenuRegistry.appendMenuItems([\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.revealDefinition',\n                title: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\")\n            },\n            group: '4_symbol_nav',\n            order: 2,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.revealDeclaration',\n                title: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\")\n            },\n            group: '4_symbol_nav',\n            order: 3,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.goToTypeDefinition',\n                title: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\")\n            },\n            group: '4_symbol_nav',\n            order: 3,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.goToImplementation',\n                title: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\")\n            },\n            group: '4_symbol_nav',\n            order: 4,\n        },\n    },\n    {\n        id: MenuId.MenubarGoMenu,\n        item: {\n            command: {\n                id: 'editor.action.goToReferences',\n                title: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\")\n            },\n            group: '4_symbol_nav',\n            order: 5,\n        },\n    },\n]);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { DeclarationProviderRegistry, DefinitionProviderRegistry, ImplementationProviderRegistry, ReferenceProviderRegistry, TypeDefinitionProviderRegistry } from '../../../common/languages.js';\nimport { ReferencesModel } from './referencesModel.js';\nfunction getLocationLinks(model, position, registry, provide) {\n    const provider = registry.ordered(model);\n    // get results\n    const promises = provider.map((provider) => {\n        return Promise.resolve(provide(provider, model, position)).then(undefined, err => {\n            onUnexpectedExternalError(err);\n            return undefined;\n        });\n    });\n    return Promise.all(promises).then(values => {\n        const result = [];\n        for (let value of values) {\n            if (Array.isArray(value)) {\n                result.push(...value);\n            }\n            else if (value) {\n                result.push(value);\n            }\n        }\n        return result;\n    });\n}\nexport function getDefinitionsAtPosition(model, position, token) {\n    return getLocationLinks(model, position, DefinitionProviderRegistry, (provider, model, position) => {\n        return provider.provideDefinition(model, position, token);\n    });\n}\nexport function getDeclarationsAtPosition(model, position, token) {\n    return getLocationLinks(model, position, DeclarationProviderRegistry, (provider, model, position) => {\n        return provider.provideDeclaration(model, position, token);\n    });\n}\nexport function getImplementationsAtPosition(model, position, token) {\n    return getLocationLinks(model, position, ImplementationProviderRegistry, (provider, model, position) => {\n        return provider.provideImplementation(model, position, token);\n    });\n}\nexport function getTypeDefinitionsAtPosition(model, position, token) {\n    return getLocationLinks(model, position, TypeDefinitionProviderRegistry, (provider, model, position) => {\n        return provider.provideTypeDefinition(model, position, token);\n    });\n}\nexport function getReferencesAtPosition(model, position, compact, token) {\n    return getLocationLinks(model, position, ReferenceProviderRegistry, (provider, model, position) => __awaiter(this, void 0, void 0, function* () {\n        const result = yield provider.provideReferences(model, position, { includeDeclaration: true }, token);\n        if (!compact || !result || result.length !== 2) {\n            return result;\n        }\n        const resultWithoutDeclaration = yield provider.provideReferences(model, position, { includeDeclaration: false }, token);\n        if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\n            return resultWithoutDeclaration;\n        }\n        return result;\n    }));\n}\n// -- API commands ----\nfunction _sortedAndDeduped(callback) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const rawLinks = yield callback();\n        const model = new ReferencesModel(rawLinks, '');\n        const modelLinks = model.references.map(ref => ref.link);\n        model.dispose();\n        return modelLinks;\n    });\n}\nregisterModelAndPositionCommand('_executeDefinitionProvider', (model, position) => _sortedAndDeduped(() => getDefinitionsAtPosition(model, position, CancellationToken.None)));\nregisterModelAndPositionCommand('_executeDeclarationProvider', (model, position) => _sortedAndDeduped(() => getDeclarationsAtPosition(model, position, CancellationToken.None)));\nregisterModelAndPositionCommand('_executeImplementationProvider', (model, position) => _sortedAndDeduped(() => getImplementationsAtPosition(model, position, CancellationToken.None)));\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider', (model, position) => _sortedAndDeduped(() => getTypeDefinitionsAtPosition(model, position, CancellationToken.None)));\nregisterModelAndPositionCommand('_executeReferenceProvider', (model, position) => _sortedAndDeduped(() => getReferencesAtPosition(model, position, false, CancellationToken.None)));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../../base/common/platform.js';\nfunction hasModifier(e, modifier) {\n    return !!e[modifier];\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkMouseEvent {\n    constructor(source, opts) {\n        this.target = source.target;\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\n        this.isNoneOrSingleMouseDown = (source.event.detail <= 1);\n    }\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkKeyboardEvent {\n    constructor(source, opts) {\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\n    }\n}\nexport class ClickLinkOptions {\n    constructor(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\n        this.triggerKey = triggerKey;\n        this.triggerModifier = triggerModifier;\n        this.triggerSideBySideKey = triggerSideBySideKey;\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\n    }\n    equals(other) {\n        return (this.triggerKey === other.triggerKey\n            && this.triggerModifier === other.triggerModifier\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\n    }\n}\nfunction createOptions(multiCursorModifier) {\n    if (multiCursorModifier === 'altKey') {\n        if (platform.isMacintosh) {\n            return new ClickLinkOptions(57 /* Meta */, 'metaKey', 6 /* Alt */, 'altKey');\n        }\n        return new ClickLinkOptions(5 /* Ctrl */, 'ctrlKey', 6 /* Alt */, 'altKey');\n    }\n    if (platform.isMacintosh) {\n        return new ClickLinkOptions(6 /* Alt */, 'altKey', 57 /* Meta */, 'metaKey');\n    }\n    return new ClickLinkOptions(6 /* Alt */, 'altKey', 5 /* Ctrl */, 'ctrlKey');\n}\nexport class ClickLinkGesture extends Disposable {\n    constructor(editor) {\n        super();\n        this._onMouseMoveOrRelevantKeyDown = this._register(new Emitter());\n        this.onMouseMoveOrRelevantKeyDown = this._onMouseMoveOrRelevantKeyDown.event;\n        this._onExecute = this._register(new Emitter());\n        this.onExecute = this._onExecute.event;\n        this._onCancel = this._register(new Emitter());\n        this.onCancel = this._onCancel.event;\n        this._editor = editor;\n        this._opts = createOptions(this._editor.getOption(70 /* multiCursorModifier */));\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._lineNumberOnMouseDown = 0;\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(70 /* multiCursorModifier */)) {\n                const newOpts = createOptions(this._editor.getOption(70 /* multiCursorModifier */));\n                if (this._opts.equals(newOpts)) {\n                    return;\n                }\n                this._opts = newOpts;\n                this._lastMouseMoveEvent = null;\n                this._hasTriggerKeyOnMouseDown = false;\n                this._lineNumberOnMouseDown = 0;\n                this._onCancel.fire();\n            }\n        }));\n        this._register(this._editor.onMouseMove((e) => this._onEditorMouseMove(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onKeyDown((e) => this._onEditorKeyDown(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onKeyUp((e) => this._onEditorKeyUp(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onMouseDrag(() => this._resetHandler()));\n        this._register(this._editor.onDidChangeCursorSelection((e) => this._onDidChangeCursorSelection(e)));\n        this._register(this._editor.onDidChangeModel((e) => this._resetHandler()));\n        this._register(this._editor.onDidChangeModelContent(() => this._resetHandler()));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\n                this._resetHandler();\n            }\n        }));\n    }\n    _onDidChangeCursorSelection(e) {\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\n            this._resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/microsoft/vscode/issues/7827)\n        }\n    }\n    _onEditorMouseMove(mouseEvent) {\n        this._lastMouseMoveEvent = mouseEvent;\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\n    }\n    _onEditorMouseDown(mouseEvent) {\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\n        // release the mouse button without wanting to do the navigation.\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\n        this._hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\n        this._lineNumberOnMouseDown = mouseEvent.target.position ? mouseEvent.target.position.lineNumber : 0;\n    }\n    _onEditorMouseUp(mouseEvent) {\n        const currentLineNumber = mouseEvent.target.position ? mouseEvent.target.position.lineNumber : 0;\n        if (this._hasTriggerKeyOnMouseDown && this._lineNumberOnMouseDown && this._lineNumberOnMouseDown === currentLineNumber) {\n            this._onExecute.fire(mouseEvent);\n        }\n    }\n    _onEditorKeyDown(e) {\n        if (this._lastMouseMoveEvent\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\n            )) {\n            this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent, e]);\n        }\n        else if (e.hasTriggerModifier) {\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\n        }\n    }\n    _onEditorKeyUp(e) {\n        if (e.keyCodeIsTriggerKey) {\n            this._onCancel.fire();\n        }\n    }\n    _resetHandler() {\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._onCancel.fire();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { withNullAsUndefined } from '../../../../../base/common/types.js';\nimport './goToDefinitionAtPosition.css';\nimport { EditorState } from '../../../editorState/browser/editorState.js';\nimport { registerEditorContribution } from '../../../../browser/editorExtensions.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { DefinitionProviderRegistry } from '../../../../common/languages.js';\nimport { ILanguageService } from '../../../../common/services/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from './clickLinkGesture.js';\nimport { PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { editorActiveLinkForeground } from '../../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../../platform/theme/common/themeService.js';\nimport { DefinitionAction } from '../goToCommands.js';\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\nlet GotoDefinitionAtPositionEditorContribution = class GotoDefinitionAtPositionEditorContribution {\n    constructor(editor, textModelResolverService, languageService) {\n        this.textModelResolverService = textModelResolverService;\n        this.languageService = languageService;\n        this.toUnhook = new DisposableStore();\n        this.toUnhookForKeyboard = new DisposableStore();\n        this.linkDecorations = [];\n        this.currentWordAtPosition = null;\n        this.previousPromise = null;\n        this.editor = editor;\n        let linkGesture = new ClickLinkGesture(editor);\n        this.toUnhook.add(linkGesture);\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this.startFindDefinitionFromMouse(mouseEvent, withNullAsUndefined(keyboardEvent));\n        }));\n        this.toUnhook.add(linkGesture.onExecute((mouseEvent) => {\n            if (this.isEnabled(mouseEvent)) {\n                this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier).then(() => {\n                    this.removeLinkDecorations();\n                }, (error) => {\n                    this.removeLinkDecorations();\n                    onUnexpectedError(error);\n                });\n            }\n        }));\n        this.toUnhook.add(linkGesture.onCancel(() => {\n            this.removeLinkDecorations();\n            this.currentWordAtPosition = null;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution.ID);\n    }\n    startFindDefinitionFromCursor(position) {\n        // For issue: https://github.com/microsoft/vscode/issues/46257\n        // equivalent to mouse move with meta/ctrl key\n        // First find the definition and add decorations\n        // to the editor to be shown with the content hover widget\n        return this.startFindDefinition(position).then(() => {\n            // Add listeners for editor cursor move and key down events\n            // Dismiss the \"extended\" editor decorations when the user hides\n            // the hover widget. There is no event for the widget itself so these\n            // serve as a best effort. After removing the link decorations, the hover\n            // widget is clean and will only show declarations per next request.\n            this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                this.toUnhookForKeyboard.clear();\n            }));\n            this.toUnhookForKeyboard.add(this.editor.onKeyDown((e) => {\n                if (e) {\n                    this.currentWordAtPosition = null;\n                    this.removeLinkDecorations();\n                    this.toUnhookForKeyboard.clear();\n                }\n            }));\n        });\n    }\n    startFindDefinitionFromMouse(mouseEvent, withKey) {\n        // check if we are active and on a content widget\n        if (mouseEvent.target.type === 9 /* CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\n            return;\n        }\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        const position = mouseEvent.target.position;\n        this.startFindDefinition(position);\n    }\n    startFindDefinition(position) {\n        var _a;\n        // Dispose listeners for updating decorations when using keyboard to show definition hover\n        this.toUnhookForKeyboard.clear();\n        // Find word at mouse position\n        const word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\n        if (!word) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return Promise.resolve(0);\n        }\n        // Return early if word at position is still the same\n        if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\n            return Promise.resolve(0);\n        }\n        this.currentWordAtPosition = word;\n        // Find definition and decorate word if found\n        let state = new EditorState(this.editor, 4 /* Position */ | 1 /* Value */ | 2 /* Selection */ | 8 /* Scroll */);\n        if (this.previousPromise) {\n            this.previousPromise.cancel();\n            this.previousPromise = null;\n        }\n        this.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\n        return this.previousPromise.then(results => {\n            if (!results || !results.length || !state.validate(this.editor)) {\n                this.removeLinkDecorations();\n                return;\n            }\n            // Multiple results\n            if (results.length > 1) {\n                this.addDecoration(new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn), new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\n            }\n            // Single result\n            else {\n                let result = results[0];\n                if (!result.uri) {\n                    return;\n                }\n                this.textModelResolverService.createModelReference(result.uri).then(ref => {\n                    if (!ref.object || !ref.object.textEditorModel) {\n                        ref.dispose();\n                        return;\n                    }\n                    const { object: { textEditorModel } } = ref;\n                    const { startLineNumber } = result.range;\n                    if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\n                        // invalid range\n                        ref.dispose();\n                        return;\n                    }\n                    const previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\n                    let wordRange;\n                    if (result.originSelectionRange) {\n                        wordRange = Range.lift(result.originSelectionRange);\n                    }\n                    else {\n                        wordRange = new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n                    }\n                    const languageId = this.languageService.guessLanguageIdByFilepathOrFirstLine(textEditorModel.uri);\n                    this.addDecoration(wordRange, new MarkdownString().appendCodeblock(languageId ? languageId : '', previewValue));\n                    ref.dispose();\n                });\n            }\n        }).then(undefined, onUnexpectedError);\n    }\n    getPreviewValue(textEditorModel, startLineNumber, result) {\n        let rangeToUse = result.targetSelectionRange ? result.range : this.getPreviewRangeBasedOnBrackets(textEditorModel, startLineNumber);\n        const numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES) {\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\n        }\n        const previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\n        return previewValue;\n    }\n    stripIndentationFromPreviewRange(textEditorModel, startLineNumber, previewRange) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        let minIndent = startIndent;\n        for (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            minIndent = Math.min(minIndent, endIndent);\n        }\n        const previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\n        return previewValue;\n    }\n    getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\n        let endLineNumber = startLineNumber + 1;\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\n            let endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            if (startIndent === endIndent) {\n                break;\n            }\n        }\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n    }\n    getPreviewRangeBasedOnBrackets(textEditorModel, startLineNumber) {\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\n        const brackets = [];\n        let ignoreFirstEmpty = true;\n        let currentBracket = textEditorModel.bracketPairs.findNextBracket(new Position(startLineNumber, 1));\n        while (currentBracket !== null) {\n            if (brackets.length === 0) {\n                brackets.push(currentBracket);\n            }\n            else {\n                const lastBracket = brackets[brackets.length - 1];\n                if (lastBracket.open[0] === currentBracket.open[0] && lastBracket.isOpen && !currentBracket.isOpen) {\n                    brackets.pop();\n                }\n                else {\n                    brackets.push(currentBracket);\n                }\n                if (brackets.length === 0) {\n                    if (ignoreFirstEmpty) {\n                        ignoreFirstEmpty = false;\n                    }\n                    else {\n                        return new Range(startLineNumber, 1, currentBracket.range.endLineNumber + 1, 1);\n                    }\n                }\n            }\n            const maxColumn = textEditorModel.getLineMaxColumn(startLineNumber);\n            let nextLineNumber = currentBracket.range.endLineNumber;\n            let nextColumn = currentBracket.range.endColumn;\n            if (maxColumn === currentBracket.range.endColumn) {\n                nextLineNumber++;\n                nextColumn = 1;\n            }\n            if (nextLineNumber > maxLineNumber) {\n                return new Range(startLineNumber, 1, maxLineNumber + 1, 1);\n            }\n            currentBracket = textEditorModel.bracketPairs.findNextBracket(new Position(nextLineNumber, nextColumn));\n        }\n        return new Range(startLineNumber, 1, maxLineNumber + 1, 1);\n    }\n    addDecoration(range, hoverMessage) {\n        const newDecorations = {\n            range: range,\n            options: {\n                description: 'goto-definition-link',\n                inlineClassName: 'goto-definition-link',\n                hoverMessage\n            }\n        };\n        this.linkDecorations = this.editor.deltaDecorations(this.linkDecorations, [newDecorations]);\n    }\n    removeLinkDecorations() {\n        if (this.linkDecorations.length > 0) {\n            this.linkDecorations = this.editor.deltaDecorations(this.linkDecorations, []);\n        }\n    }\n    isEnabled(mouseEvent, withKey) {\n        return this.editor.hasModel() &&\n            mouseEvent.isNoneOrSingleMouseDown &&\n            (mouseEvent.target.type === 6 /* CONTENT_TEXT */) &&\n            (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false)) &&\n            DefinitionProviderRegistry.has(this.editor.getModel());\n    }\n    findDefinition(position, token) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return Promise.resolve(null);\n        }\n        return getDefinitionsAtPosition(model, position, token);\n    }\n    gotoDefinition(position, openToSide) {\n        this.editor.setPosition(position);\n        return this.editor.invokeWithinContext((accessor) => {\n            const canPeek = !openToSide && this.editor.getOption(78 /* definitionLinkOpensInPeek */) && !this.isInPeekEditor(accessor);\n            const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { alias: '', label: '', id: '', precondition: undefined });\n            return action.run(accessor, this.editor);\n        });\n    }\n    isInPeekEditor(accessor) {\n        const contextKeyService = accessor.get(IContextKeyService);\n        return PeekContext.inPeekEditor.getValue(contextKeyService);\n    }\n    dispose() {\n        this.toUnhook.dispose();\n    }\n};\nGotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\nGotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\nGotoDefinitionAtPositionEditorContribution = __decorate([\n    __param(1, ITextModelService),\n    __param(2, ILanguageService)\n], GotoDefinitionAtPositionEditorContribution);\nexport { GotoDefinitionAtPositionEditorContribution };\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution);\nregisterThemingParticipant((theme, collector) => {\n    const activeLinkForeground = theme.getColor(editorActiveLinkForeground);\n    if (activeLinkForeground) {\n        collector.addRule(`.monaco-editor .goto-definition-link { color: ${activeLinkForeground} !important; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { CountBadge } from '../../../../../base/browser/ui/countBadge/countBadge.js';\nimport { HighlightedLabel } from '../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\nimport { IconLabel } from '../../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { createMatches, FuzzyScore } from '../../../../../base/common/filters.js';\nimport { getBaseLabel } from '../../../../../base/common/labels.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { basename, dirname } from '../../../../../base/common/resources.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { localize } from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { attachBadgeStyler } from '../../../../../platform/theme/common/styler.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { FileReferences, OneReference, ReferencesModel } from '../referencesModel.js';\nlet DataSource = class DataSource {\n    constructor(_resolverService) {\n        this._resolverService = _resolverService;\n    }\n    hasChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return true;\n        }\n        if (element instanceof FileReferences) {\n            return true;\n        }\n        return false;\n    }\n    getChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return element.groups;\n        }\n        if (element instanceof FileReferences) {\n            return element.resolve(this._resolverService).then(val => {\n                // if (element.failure) {\n                // \t// refresh the element on failure so that\n                // \t// we can update its rendering\n                // \treturn tree.refresh(element).then(() => val.children);\n                // }\n                return val.children;\n            });\n        }\n        throw new Error('bad tree');\n    }\n};\nDataSource = __decorate([\n    __param(0, ITextModelService)\n], DataSource);\nexport { DataSource };\n//#endregion\nexport class Delegate {\n    getHeight() {\n        return 23;\n    }\n    getTemplateId(element) {\n        if (element instanceof FileReferences) {\n            return FileReferencesRenderer.id;\n        }\n        else {\n            return OneReferenceRenderer.id;\n        }\n    }\n}\nlet StringRepresentationProvider = class StringRepresentationProvider {\n    constructor(_keybindingService) {\n        this._keybindingService = _keybindingService;\n    }\n    getKeyboardNavigationLabel(element) {\n        var _a;\n        if (element instanceof OneReference) {\n            const parts = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n            if (parts) {\n                return parts.value;\n            }\n        }\n        // FileReferences or unresolved OneReference\n        return basename(element.uri);\n    }\n};\nStringRepresentationProvider = __decorate([\n    __param(0, IKeybindingService)\n], StringRepresentationProvider);\nexport { StringRepresentationProvider };\nexport class IdentityProvider {\n    getId(element) {\n        return element instanceof OneReference ? element.id : element.uri;\n    }\n}\n//#region render: File\nlet FileReferencesTemplate = class FileReferencesTemplate extends Disposable {\n    constructor(container, _uriLabel, themeService) {\n        super();\n        this._uriLabel = _uriLabel;\n        const parent = document.createElement('div');\n        parent.classList.add('reference-file');\n        this.file = this._register(new IconLabel(parent, { supportHighlights: true }));\n        this.badge = new CountBadge(dom.append(parent, dom.$('.count')));\n        this._register(attachBadgeStyler(this.badge, themeService));\n        container.appendChild(parent);\n    }\n    set(element, matches) {\n        let parent = dirname(element.uri);\n        this.file.setLabel(getBaseLabel(element.uri), this._uriLabel.getUriLabel(parent, { relative: true }), { title: this._uriLabel.getUriLabel(element.uri), matches });\n        const len = element.children.length;\n        this.badge.setCount(len);\n        if (len > 1) {\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\n        }\n        else {\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\n        }\n    }\n};\nFileReferencesTemplate = __decorate([\n    __param(1, ILabelService),\n    __param(2, IThemeService)\n], FileReferencesTemplate);\nlet FileReferencesRenderer = class FileReferencesRenderer {\n    constructor(_instantiationService) {\n        this._instantiationService = _instantiationService;\n        this.templateId = FileReferencesRenderer.id;\n    }\n    renderTemplate(container) {\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\n    }\n    renderElement(node, index, template) {\n        template.set(node.element, createMatches(node.filterData));\n    }\n    disposeTemplate(templateData) {\n        templateData.dispose();\n    }\n};\nFileReferencesRenderer.id = 'FileReferencesRenderer';\nFileReferencesRenderer = __decorate([\n    __param(0, IInstantiationService)\n], FileReferencesRenderer);\nexport { FileReferencesRenderer };\n//#endregion\n//#region render: Reference\nclass OneReferenceTemplate {\n    constructor(container) {\n        this.label = new HighlightedLabel(container);\n    }\n    set(element, score) {\n        var _a;\n        const preview = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n        if (!preview || !preview.value) {\n            // this means we FAILED to resolve the document or the value is the empty string\n            this.label.set(`${basename(element.uri)}:${element.range.startLineNumber + 1}:${element.range.startColumn + 1}`);\n        }\n        else {\n            // render search match as highlight unless\n            // we have score, then render the score\n            const { value, highlight } = preview;\n            if (score && !FuzzyScore.isDefault(score)) {\n                this.label.element.classList.toggle('referenceMatch', false);\n                this.label.set(value, createMatches(score));\n            }\n            else {\n                this.label.element.classList.toggle('referenceMatch', true);\n                this.label.set(value, [highlight]);\n            }\n        }\n    }\n}\nexport class OneReferenceRenderer {\n    constructor() {\n        this.templateId = OneReferenceRenderer.id;\n    }\n    renderTemplate(container) {\n        return new OneReferenceTemplate(container);\n    }\n    renderElement(node, index, templateData) {\n        templateData.set(node.element, node.filterData);\n    }\n    disposeTemplate() {\n    }\n}\nOneReferenceRenderer.id = 'OneReferenceRenderer';\n//#endregion\nexport class AccessibilityProvider {\n    getWidgetAriaLabel() {\n        return localize('treeAriaLabel', \"References\");\n    }\n    getAriaLabel(element) {\n        return element.ariaMessage;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { Sizing, SplitView } from '../../../../../base/browser/ui/splitview/splitview.js';\nimport { Color } from '../../../../../base/common/color.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { basenameOrAuthority, dirname } from '../../../../../base/common/resources.js';\nimport './referencesWidget.css';\nimport { EmbeddedCodeEditorWidget } from '../../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ModelDecorationOptions, TextModel } from '../../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../../common/languages/modesRegistry.js';\nimport { ILanguageService } from '../../../../common/services/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, IdentityProvider, OneReferenceRenderer, StringRepresentationProvider } from './referencesTree.js';\nimport * as peekView from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { WorkbenchAsyncDataTree } from '../../../../../platform/list/browser/listService.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { FileReferences, OneReference } from '../referencesModel.js';\nclass DecorationsManager {\n    constructor(_editor, _model) {\n        this._editor = _editor;\n        this._model = _model;\n        this._decorations = new Map();\n        this._decorationIgnoreSet = new Set();\n        this._callOnDispose = new DisposableStore();\n        this._callOnModelChange = new DisposableStore();\n        this._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\n        this._onModelChanged();\n    }\n    dispose() {\n        this._callOnModelChange.dispose();\n        this._callOnDispose.dispose();\n        this.removeDecorations();\n    }\n    _onModelChanged() {\n        this._callOnModelChange.clear();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (let ref of this._model.references) {\n            if (ref.uri.toString() === model.uri.toString()) {\n                this._addDecorations(ref.parent);\n                return;\n            }\n        }\n    }\n    _addDecorations(reference) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\n        const newDecorations = [];\n        const newDecorationsActualIndex = [];\n        for (let i = 0, len = reference.children.length; i < len; i++) {\n            let oneReference = reference.children[i];\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\n                continue;\n            }\n            if (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\n                continue;\n            }\n            newDecorations.push({\n                range: oneReference.range,\n                options: DecorationsManager.DecorationOptions\n            });\n            newDecorationsActualIndex.push(i);\n        }\n        const decorations = this._editor.deltaDecorations([], newDecorations);\n        for (let i = 0; i < decorations.length; i++) {\n            this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\n        }\n    }\n    _onDecorationChanged() {\n        const toRemove = [];\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (let [decorationId, reference] of this._decorations) {\n            const newRange = model.getDecorationRange(decorationId);\n            if (!newRange) {\n                continue;\n            }\n            let ignore = false;\n            if (Range.equalsRange(newRange, reference.range)) {\n                continue;\n            }\n            if (Range.spansMultipleLines(newRange)) {\n                ignore = true;\n            }\n            else {\n                const lineLength = reference.range.endColumn - reference.range.startColumn;\n                const newLineLength = newRange.endColumn - newRange.startColumn;\n                if (lineLength !== newLineLength) {\n                    ignore = true;\n                }\n            }\n            if (ignore) {\n                this._decorationIgnoreSet.add(reference.id);\n                toRemove.push(decorationId);\n            }\n            else {\n                reference.range = newRange;\n            }\n        }\n        for (let i = 0, len = toRemove.length; i < len; i++) {\n            this._decorations.delete(toRemove[i]);\n        }\n        this._editor.deltaDecorations(toRemove, []);\n    }\n    removeDecorations() {\n        this._editor.deltaDecorations([...this._decorations.keys()], []);\n        this._decorations.clear();\n    }\n}\nDecorationsManager.DecorationOptions = ModelDecorationOptions.register({\n    description: 'reference-decoration',\n    stickiness: 1 /* NeverGrowsWhenTypingAtEdges */,\n    className: 'reference-decoration'\n});\nexport class LayoutData {\n    constructor() {\n        this.ratio = 0.7;\n        this.heightInLines = 18;\n    }\n    static fromJSON(raw) {\n        let ratio;\n        let heightInLines;\n        try {\n            const data = JSON.parse(raw);\n            ratio = data.ratio;\n            heightInLines = data.heightInLines;\n        }\n        catch (_a) {\n            //\n        }\n        return {\n            ratio: ratio || 0.7,\n            heightInLines: heightInLines || 18\n        };\n    }\n}\nclass ReferencesTree extends WorkbenchAsyncDataTree {\n}\n/**\n * ZoneWidget that is shown inside the editor\n */\nlet ReferenceWidget = class ReferenceWidget extends peekView.PeekViewWidget {\n    constructor(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel, _undoRedoService, _keybindingService, _languageService, _languageConfigurationService) {\n        super(editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true, supportOnTitleClick: true }, _instantiationService);\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this.layoutData = layoutData;\n        this._textModelResolverService = _textModelResolverService;\n        this._instantiationService = _instantiationService;\n        this._peekViewService = _peekViewService;\n        this._uriLabel = _uriLabel;\n        this._undoRedoService = _undoRedoService;\n        this._keybindingService = _keybindingService;\n        this._languageService = _languageService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._disposeOnNewModel = new DisposableStore();\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectReference = new Emitter();\n        this.onDidSelectReference = this._onDidSelectReference.event;\n        this._dim = new dom.Dimension(0, 0);\n        this._applyTheme(themeService.getColorTheme());\n        this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this._peekViewService.addExclusiveWidget(editor, this);\n        this.create();\n    }\n    dispose() {\n        this.setModel(undefined);\n        this._callOnDispose.dispose();\n        this._disposeOnNewModel.dispose();\n        dispose(this._preview);\n        dispose(this._previewNotAvailableMessage);\n        dispose(this._tree);\n        dispose(this._previewModelReference);\n        this._splitView.dispose();\n        super.dispose();\n    }\n    _applyTheme(theme) {\n        const borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\n        this.style({\n            arrowColor: borderColor,\n            frameColor: borderColor,\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\n        });\n    }\n    show(where) {\n        this.editor.revealRangeInCenterIfOutsideViewport(where, 0 /* Smooth */);\n        super.show(where, this.layoutData.heightInLines || 18);\n    }\n    focusOnReferenceTree() {\n        this._tree.domFocus();\n    }\n    focusOnPreviewEditor() {\n        this._preview.focus();\n    }\n    isPreviewEditorFocused() {\n        return this._preview.hasTextFocus();\n    }\n    _onTitleClick(e) {\n        if (this._preview && this._preview.getModel()) {\n            this._onDidSelectReference.fire({\n                element: this._getFocusedReference(),\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\n                source: 'title'\n            });\n        }\n    }\n    _fillBody(containerElement) {\n        this.setCssClass('reference-zone-widget');\n        // message pane\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\n        dom.hide(this._messageContainer);\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* HORIZONTAL */ });\n        // editor\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\n        let options = {\n            scrollBeyondLastLine: false,\n            scrollbar: {\n                verticalScrollbarSize: 14,\n                horizontal: 'auto',\n                useShadows: true,\n                verticalHasArrows: false,\n                horizontalHasArrows: false,\n                alwaysConsumeMouseWheel: false\n            },\n            overviewRulerLanes: 2,\n            fixedOverflowWidgets: true,\n            minimap: {\n                enabled: false\n            }\n        };\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, this.editor);\n        dom.hide(this._previewContainer);\n        this._previewNotAvailableMessage = new TextModel(nls.localize('missingPreviewMessage', \"no preview available\"), PLAINTEXT_LANGUAGE_ID, TextModel.DEFAULT_CREATION_OPTIONS, null, this._undoRedoService, this._languageService, this._languageConfigurationService);\n        // tree\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\n        const treeOptions = {\n            keyboardSupport: this._defaultTreeKeyboardSupport,\n            accessibilityProvider: new AccessibilityProvider(),\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\n            identityProvider: new IdentityProvider(),\n            openOnSingleClick: true,\n            selectionNavigation: true,\n            overrideStyles: {\n                listBackground: peekView.peekViewResultsBackground\n            }\n        };\n        if (this._defaultTreeKeyboardSupport) {\n            // the tree will consume `Escape` and prevent the widget from closing\n            this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', (e) => {\n                if (e.equals(9 /* Escape */)) {\n                    this._keybindingService.dispatchEvent(e, e.target);\n                    e.stopPropagation();\n                }\n            }, true));\n        }\n        this._tree = this._instantiationService.createInstance(ReferencesTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\n            this._instantiationService.createInstance(FileReferencesRenderer),\n            this._instantiationService.createInstance(OneReferenceRenderer),\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\n        // split stuff\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._previewContainer,\n            minimumSize: 200,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._preview.layout({ height: this._dim.height, width });\n            }\n        }, Sizing.Distribute);\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._treeContainer,\n            minimumSize: 100,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._treeContainer.style.height = `${this._dim.height}px`;\n                this._treeContainer.style.width = `${width}px`;\n                this._tree.layout(this._dim.height, width);\n            }\n        }, Sizing.Distribute);\n        this._disposables.add(this._splitView.onDidSashChange(() => {\n            if (this._dim.width) {\n                this.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\n            }\n        }, undefined));\n        // listen on selection and focus\n        let onEvent = (element, kind) => {\n            if (element instanceof OneReference) {\n                if (kind === 'show') {\n                    this._revealReference(element, false);\n                }\n                this._onDidSelectReference.fire({ element, kind, source: 'tree' });\n            }\n        };\n        this._tree.onDidOpen(e => {\n            if (e.sideBySide) {\n                onEvent(e.element, 'side');\n            }\n            else if (e.editorOptions.pinned) {\n                onEvent(e.element, 'goto');\n            }\n            else {\n                onEvent(e.element, 'show');\n            }\n        });\n        dom.hide(this._treeContainer);\n    }\n    _onWidth(width) {\n        if (this._dim) {\n            this._doLayoutBody(this._dim.height, width);\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._dim = new dom.Dimension(widthInPixel, heightInPixel);\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\n        this._splitView.layout(widthInPixel);\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\n    }\n    setSelection(selection) {\n        return this._revealReference(selection, true).then(() => {\n            if (!this._model) {\n                // disposed\n                return;\n            }\n            // show in tree\n            this._tree.setSelection([selection]);\n            this._tree.setFocus([selection]);\n        });\n    }\n    setModel(newModel) {\n        // clean up\n        this._disposeOnNewModel.clear();\n        this._model = newModel;\n        if (this._model) {\n            return this._onNewModel();\n        }\n        return Promise.resolve();\n    }\n    _onNewModel() {\n        if (!this._model) {\n            return Promise.resolve(undefined);\n        }\n        if (this._model.isEmpty) {\n            this.setTitle('');\n            this._messageContainer.innerText = nls.localize('noResults', \"No results\");\n            dom.show(this._messageContainer);\n            return Promise.resolve(undefined);\n        }\n        dom.hide(this._messageContainer);\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\n        this._disposeOnNewModel.add(this._decorationsManager);\n        // listen on model changes\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference)));\n        // listen on editor\n        this._disposeOnNewModel.add(this._preview.onMouseDown(e => {\n            const { event, target } = e;\n            if (event.detail !== 2) {\n                return;\n            }\n            const element = this._getFocusedReference();\n            if (!element) {\n                return;\n            }\n            this._onDidSelectReference.fire({\n                element: { uri: element.uri, range: target.range },\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\n                source: 'editor'\n            });\n        }));\n        // make sure things are rendered\n        this.container.classList.add('results-loaded');\n        dom.show(this._treeContainer);\n        dom.show(this._previewContainer);\n        this._splitView.layout(this._dim.width);\n        this.focusOnReferenceTree();\n        // pick input and a reference to begin with\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\n    }\n    _getFocusedReference() {\n        const [element] = this._tree.getFocus();\n        if (element instanceof OneReference) {\n            return element;\n        }\n        else if (element instanceof FileReferences) {\n            if (element.children.length > 0) {\n                return element.children[0];\n            }\n        }\n        return undefined;\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._revealReference(reference, false);\n            this._onDidSelectReference.fire({ element: reference, kind: 'goto', source: 'tree' });\n        });\n    }\n    _revealReference(reference, revealParent) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // check if there is anything to do...\n            if (this._revealedReference === reference) {\n                return;\n            }\n            this._revealedReference = reference;\n            // Update widget header\n            if (reference.uri.scheme !== Schemas.inMemory) {\n                this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\n            }\n            else {\n                this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\n            }\n            const promise = this._textModelResolverService.createModelReference(reference.uri);\n            if (this._tree.getInput() === reference.parent) {\n                this._tree.reveal(reference);\n            }\n            else {\n                if (revealParent) {\n                    this._tree.reveal(reference.parent);\n                }\n                yield this._tree.expand(reference.parent);\n                this._tree.reveal(reference);\n            }\n            const ref = yield promise;\n            if (!this._model) {\n                // disposed\n                ref.dispose();\n                return;\n            }\n            dispose(this._previewModelReference);\n            // show in editor\n            const model = ref.object;\n            if (model) {\n                const scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* Smooth */ : 1 /* Immediate */;\n                const sel = Range.lift(reference.range).collapseToStart();\n                this._previewModelReference = ref;\n                this._preview.setModel(model.textEditorModel);\n                this._preview.setSelection(sel);\n                this._preview.revealRangeInCenter(sel, scrollType);\n            }\n            else {\n                this._preview.setModel(this._previewNotAvailableMessage);\n                ref.dispose();\n            }\n        });\n    }\n};\nReferenceWidget = __decorate([\n    __param(3, IThemeService),\n    __param(4, ITextModelService),\n    __param(5, IInstantiationService),\n    __param(6, peekView.IPeekViewService),\n    __param(7, ILabelService),\n    __param(8, IUndoRedoService),\n    __param(9, IKeybindingService),\n    __param(10, ILanguageService),\n    __param(11, ILanguageConfigurationService)\n], ReferenceWidget);\nexport { ReferenceWidget };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { getOuterEditor, PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { CommandsRegistry } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingsRegistry } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { IListService, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse, WorkbenchTreeElementCanExpand } from '../../../../../platform/list/browser/listService.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { OneReference } from '../referencesModel.js';\nimport { LayoutData, ReferenceWidget } from './referencesWidget.js';\nexport const ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false, nls.localize('referenceSearchVisible', \"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'\"));\nlet ReferencesController = class ReferencesController {\n    constructor(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this._editor = _editor;\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._instantiationService = _instantiationService;\n        this._storageService = _storageService;\n        this._configurationService = _configurationService;\n        this._disposables = new DisposableStore();\n        this._requestIdPool = 0;\n        this._ignoreModelChangeEvent = false;\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\n    }\n    static get(editor) {\n        return editor.getContribution(ReferencesController.ID);\n    }\n    dispose() {\n        var _a, _b;\n        this._referenceSearchVisible.reset();\n        this._disposables.dispose();\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    toggleWidget(range, modelPromise, peekMode) {\n        // close current widget and return early is position didn't change\n        let widgetPosition;\n        if (this._widget) {\n            widgetPosition = this._widget.position;\n        }\n        this.closeWidget();\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\n            return;\n        }\n        this._peekMode = peekMode;\n        this._referenceSearchVisible.set(true);\n        // close the widget on model/mode changes\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => { this.closeWidget(); }));\n        this._disposables.add(this._editor.onDidChangeModel(() => {\n            if (!this._ignoreModelChangeEvent) {\n                this.closeWidget();\n            }\n        }));\n        const storageKey = 'peekViewLayout';\n        const data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* GLOBAL */, '{}'));\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\n        this._widget.show(range);\n        this._disposables.add(this._widget.onDidClose(() => {\n            modelPromise.cancel();\n            if (this._widget) {\n                this._storageService.store(storageKey, JSON.stringify(this._widget.layoutData), 0 /* GLOBAL */, 1 /* MACHINE */);\n                this._widget = undefined;\n            }\n            this.closeWidget();\n        }));\n        this._disposables.add(this._widget.onDidSelectReference(event => {\n            let { element, kind } = event;\n            if (!element) {\n                return;\n            }\n            switch (kind) {\n                case 'open':\n                    if (event.source !== 'editor' || !this._configurationService.getValue('editor.stablePeek')) {\n                        // when stable peek is configured we don't close\n                        // the peek window on selecting the editor\n                        this.openReference(element, false, false);\n                    }\n                    break;\n                case 'side':\n                    this.openReference(element, true, false);\n                    break;\n                case 'goto':\n                    if (peekMode) {\n                        this._gotoReference(element);\n                    }\n                    else {\n                        this.openReference(element, false, true);\n                    }\n                    break;\n            }\n        }));\n        const requestId = ++this._requestIdPool;\n        modelPromise.then(model => {\n            var _a;\n            // still current request? widget still open?\n            if (requestId !== this._requestIdPool || !this._widget) {\n                model.dispose();\n                return undefined;\n            }\n            (_a = this._model) === null || _a === void 0 ? void 0 : _a.dispose();\n            this._model = model;\n            // show widget\n            return this._widget.setModel(this._model).then(() => {\n                if (this._widget && this._model && this._editor.hasModel()) { // might have been closed\n                    // set title\n                    if (!this._model.isEmpty) {\n                        this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", this._model.title, this._model.references.length));\n                    }\n                    else {\n                        this._widget.setMetaTitle('');\n                    }\n                    // set 'best' selection\n                    let uri = this._editor.getModel().uri;\n                    let pos = new Position(range.startLineNumber, range.startColumn);\n                    let selection = this._model.nearestReference(uri, pos);\n                    if (selection) {\n                        return this._widget.setSelection(selection).then(() => {\n                            if (this._widget && this._editor.getOption(77 /* peekWidgetDefaultFocus */) === 'editor') {\n                                this._widget.focusOnPreviewEditor();\n                            }\n                        });\n                    }\n                }\n                return undefined;\n            });\n        }, error => {\n            this._notificationService.error(error);\n        });\n    }\n    changeFocusBetweenPreviewAndReferences() {\n        if (!this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        if (this._widget.isPreviewEditorFocused()) {\n            this._widget.focusOnReferenceTree();\n        }\n        else {\n            this._widget.focusOnPreviewEditor();\n        }\n    }\n    goToNextOrPreviousReference(fwd) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\n                // can be called while still resolving...\n                return;\n            }\n            const currentPosition = this._widget.position;\n            if (!currentPosition) {\n                return;\n            }\n            const source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\n            if (!source) {\n                return;\n            }\n            const target = this._model.nextOrPreviousReference(source, fwd);\n            const editorFocus = this._editor.hasTextFocus();\n            const previewEditorFocus = this._widget.isPreviewEditorFocused();\n            yield this._widget.setSelection(target);\n            yield this._gotoReference(target);\n            if (editorFocus) {\n                this._editor.focus();\n            }\n            else if (this._widget && previewEditorFocus) {\n                this._widget.focusOnPreviewEditor();\n            }\n        });\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\n                // can be called while still resolving...\n                return;\n            }\n            yield this._widget.revealReference(reference);\n        });\n    }\n    closeWidget(focusEditor = true) {\n        var _a, _b;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._referenceSearchVisible.reset();\n        this._disposables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n        if (focusEditor) {\n            this._editor.focus();\n        }\n        this._requestIdPool += 1; // Cancel pending requests\n    }\n    _gotoReference(ref) {\n        if (this._widget) {\n            this._widget.hide();\n        }\n        this._ignoreModelChangeEvent = true;\n        const range = Range.lift(ref.range).collapseToStart();\n        return this._editorService.openCodeEditor({\n            resource: ref.uri,\n            options: { selection: range }\n        }, this._editor).then(openedEditor => {\n            var _a;\n            this._ignoreModelChangeEvent = false;\n            if (!openedEditor || !this._widget) {\n                // something went wrong...\n                this.closeWidget();\n                return;\n            }\n            if (this._editor === openedEditor) {\n                //\n                this._widget.show(range);\n                this._widget.focusOnReferenceTree();\n            }\n            else {\n                // we opened a different editor instance which means a different controller instance.\n                // therefore we stop with this controller and continue with the other\n                const other = ReferencesController.get(openedEditor);\n                const model = this._model.clone();\n                this.closeWidget();\n                openedEditor.focus();\n                other === null || other === void 0 ? void 0 : other.toggleWidget(range, createCancelablePromise(_ => Promise.resolve(model)), (_a = this._peekMode) !== null && _a !== void 0 ? _a : false);\n            }\n        }, (err) => {\n            this._ignoreModelChangeEvent = false;\n            onUnexpectedError(err);\n        });\n    }\n    openReference(ref, sideBySide, pinned) {\n        // clear stage\n        if (!sideBySide) {\n            this.closeWidget();\n        }\n        const { uri, range } = ref;\n        this._editorService.openCodeEditor({\n            resource: uri,\n            options: { selection: range, pinned }\n        }, this._editor, sideBySide);\n    }\n};\nReferencesController.ID = 'editor.contrib.referencesController';\nReferencesController = __decorate([\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, INotificationService),\n    __param(5, IInstantiationService),\n    __param(6, IStorageService),\n    __param(7, IConfigurationService)\n], ReferencesController);\nexport { ReferencesController };\nfunction withController(accessor, fn) {\n    const outerEditor = getOuterEditor(accessor);\n    if (!outerEditor) {\n        return;\n    }\n    const controller = ReferencesController.get(outerEditor);\n    if (controller) {\n        fn(controller);\n    }\n}\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'togglePeekWidgetFocus',\n    weight: 100 /* EditorContrib */,\n    primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KeyK */, 60 /* F2 */),\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.changeFocusBetweenPreviewAndReferences();\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToNextReference',\n    weight: 100 /* EditorContrib */ - 10,\n    primary: 62 /* F4 */,\n    secondary: [70 /* F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(true);\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToPreviousReference',\n    weight: 100 /* EditorContrib */ - 10,\n    primary: 1024 /* Shift */ | 62 /* F4 */,\n    secondary: [1024 /* Shift */ | 70 /* F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(false);\n        });\n    }\n});\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\nCommandsRegistry.registerCommandAlias('goToNextReferenceFromEmbeddedEditor', 'goToNextReference');\nCommandsRegistry.registerCommandAlias('goToPreviousReferenceFromEmbeddedEditor', 'goToPreviousReference');\n// close\nCommandsRegistry.registerCommandAlias('closeReferenceSearchEditor', 'closeReferenceSearch');\nCommandsRegistry.registerCommand('closeReferenceSearch', accessor => withController(accessor, controller => controller.closeWidget()));\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 100 /* EditorContrib */ - 101,\n    primary: 9 /* Escape */,\n    secondary: [1024 /* Shift */ | 9 /* Escape */],\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 200 /* WorkbenchContrib */ + 50,\n    primary: 9 /* Escape */,\n    secondary: [1024 /* Shift */ | 9 /* Escape */],\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'revealReference',\n    weight: 200 /* WorkbenchContrib */,\n    primary: 3 /* Enter */,\n    mac: {\n        primary: 3 /* Enter */,\n        secondary: [2048 /* CtrlCmd */ | 18 /* DownArrow */]\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.revealReference(focus[0]));\n        }\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'openReferenceToSide',\n    weight: 100 /* EditorContrib */,\n    primary: 2048 /* CtrlCmd */ | 3 /* Enter */,\n    mac: {\n        primary: 256 /* WinCtrl */ | 3 /* Enter */\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.openReference(focus[0], true, true));\n        }\n    }\n});\nCommandsRegistry.registerCommand('openReference', (accessor) => {\n    var _a;\n    const listService = accessor.get(IListService);\n    const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n    if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n        withController(accessor, controller => controller.openReference(focus[0], false, true));\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { defaultGenerator } from '../../../../base/common/idGenerator.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { basename, extUri } from '../../../../base/common/resources.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nexport class OneReference {\n    constructor(isProviderFirst, parent, link, _rangeCallback) {\n        this.isProviderFirst = isProviderFirst;\n        this.parent = parent;\n        this.link = link;\n        this._rangeCallback = _rangeCallback;\n        this.id = defaultGenerator.nextId();\n    }\n    get uri() {\n        return this.link.uri;\n    }\n    get range() {\n        var _a, _b;\n        return (_b = (_a = this._range) !== null && _a !== void 0 ? _a : this.link.targetSelectionRange) !== null && _b !== void 0 ? _b : this.link.range;\n    }\n    set range(value) {\n        this._range = value;\n        this._rangeCallback(this);\n    }\n    get ariaMessage() {\n        var _a;\n        const preview = (_a = this.parent.getPreview(this)) === null || _a === void 0 ? void 0 : _a.preview(this.range);\n        if (!preview) {\n            return localize('aria.oneReference', \"symbol in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n        else {\n            return localize({ key: 'aria.oneReference.preview', comment: ['Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code'] }, \"symbol in {0} on line {1} at column {2}, {3}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn, preview.value);\n        }\n    }\n}\nexport class FilePreview {\n    constructor(_modelReference) {\n        this._modelReference = _modelReference;\n    }\n    dispose() {\n        this._modelReference.dispose();\n    }\n    preview(range, n = 8) {\n        const model = this._modelReference.object.textEditorModel;\n        if (!model) {\n            return undefined;\n        }\n        const { startLineNumber, startColumn, endLineNumber, endColumn } = range;\n        const word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\n        const beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\n        const afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* MAX_SAFE_SMALL_INTEGER */);\n        const before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\n        const inside = model.getValueInRange(range);\n        const after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\n        return {\n            value: before + inside + after,\n            highlight: { start: before.length, end: before.length + inside.length }\n        };\n    }\n}\nexport class FileReferences {\n    constructor(parent, uri) {\n        this.parent = parent;\n        this.uri = uri;\n        this.children = [];\n        this._previews = new ResourceMap();\n    }\n    dispose() {\n        dispose(this._previews.values());\n        this._previews.clear();\n    }\n    getPreview(child) {\n        return this._previews.get(child.uri);\n    }\n    get ariaMessage() {\n        const len = this.children.length;\n        if (len === 1) {\n            return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\n        }\n        else {\n            return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\n        }\n    }\n    resolve(textModelResolverService) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._previews.size !== 0) {\n                return this;\n            }\n            for (let child of this.children) {\n                if (this._previews.has(child.uri)) {\n                    continue;\n                }\n                try {\n                    const ref = yield textModelResolverService.createModelReference(child.uri);\n                    this._previews.set(child.uri, new FilePreview(ref));\n                }\n                catch (err) {\n                    onUnexpectedError(err);\n                }\n            }\n            return this;\n        });\n    }\n}\nexport class ReferencesModel {\n    constructor(links, title) {\n        this.groups = [];\n        this.references = [];\n        this._onDidChangeReferenceRange = new Emitter();\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\n        this._links = links;\n        this._title = title;\n        // grouping and sorting\n        const [providersFirst] = links;\n        links.sort(ReferencesModel._compareReferences);\n        let current;\n        for (let link of links) {\n            if (!current || !extUri.isEqual(current.uri, link.uri, true)) {\n                // new group\n                current = new FileReferences(this, link.uri);\n                this.groups.push(current);\n            }\n            // append, check for equality first!\n            if (current.children.length === 0 || ReferencesModel._compareReferences(link, current.children[current.children.length - 1]) !== 0) {\n                const oneRef = new OneReference(providersFirst === link, current, link, ref => this._onDidChangeReferenceRange.fire(ref));\n                this.references.push(oneRef);\n                current.children.push(oneRef);\n            }\n        }\n    }\n    dispose() {\n        dispose(this.groups);\n        this._onDidChangeReferenceRange.dispose();\n        this.groups.length = 0;\n    }\n    clone() {\n        return new ReferencesModel(this._links, this._title);\n    }\n    get title() {\n        return this._title;\n    }\n    get isEmpty() {\n        return this.groups.length === 0;\n    }\n    get ariaMessage() {\n        if (this.isEmpty) {\n            return localize('aria.result.0', \"No results found\");\n        }\n        else if (this.references.length === 1) {\n            return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\n        }\n        else if (this.groups.length === 1) {\n            return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\n        }\n        else {\n            return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\n        }\n    }\n    nextOrPreviousReference(reference, next) {\n        let { parent } = reference;\n        let idx = parent.children.indexOf(reference);\n        let childCount = parent.children.length;\n        let groupCount = parent.parent.groups.length;\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\n            // cycling within one file\n            if (next) {\n                idx = (idx + 1) % childCount;\n            }\n            else {\n                idx = (idx + childCount - 1) % childCount;\n            }\n            return parent.children[idx];\n        }\n        idx = parent.parent.groups.indexOf(parent);\n        if (next) {\n            idx = (idx + 1) % groupCount;\n            return parent.parent.groups[idx].children[0];\n        }\n        else {\n            idx = (idx + groupCount - 1) % groupCount;\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\n        }\n    }\n    nearestReference(resource, position) {\n        const nearest = this.references.map((ref, idx) => {\n            return {\n                idx,\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\n            };\n        }).sort((a, b) => {\n            if (a.prefixLen > b.prefixLen) {\n                return -1;\n            }\n            else if (a.prefixLen < b.prefixLen) {\n                return 1;\n            }\n            else if (a.offsetDist < b.offsetDist) {\n                return -1;\n            }\n            else if (a.offsetDist > b.offsetDist) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n        })[0];\n        if (nearest) {\n            return this.references[nearest.idx];\n        }\n        return undefined;\n    }\n    referenceAt(resource, position) {\n        for (const ref of this.references) {\n            if (ref.uri.toString() === resource.toString()) {\n                if (Range.containsPosition(ref.range, position)) {\n                    return ref;\n                }\n            }\n        }\n        return undefined;\n    }\n    firstReference() {\n        for (const ref of this.references) {\n            if (ref.isProviderFirst) {\n                return ref;\n            }\n        }\n        return this.references[0];\n    }\n    static _compareReferences(a, b) {\n        return extUri.compare(a.uri, b.uri) || Range.compareRangesUsingStarts(a.range, b.range);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { HoverProviderRegistry } from '../../../common/languages.js';\nexport class HoverProviderResult {\n    constructor(provider, hover, ordinal) {\n        this.provider = provider;\n        this.hover = hover;\n        this.ordinal = ordinal;\n    }\n}\nfunction executeProvider(provider, ordinal, model, position, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        try {\n            const result = yield Promise.resolve(provider.provideHover(model, position, token));\n            if (result && isValid(result)) {\n                return new HoverProviderResult(provider, result, ordinal);\n            }\n        }\n        catch (err) {\n            onUnexpectedExternalError(err);\n        }\n        return undefined;\n    });\n}\nexport function getHover(model, position, token) {\n    const providers = HoverProviderRegistry.ordered(model);\n    const promises = providers.map((provider, index) => executeProvider(provider, index, model, position, token));\n    return AsyncIterableObject.fromPromises(promises).coalesce();\n}\nexport function getHoverPromise(model, position, token) {\n    return getHover(model, position, token).map(item => item.hover).toPromise();\n}\nregisterModelAndPositionCommand('_executeHoverProvider', (model, position) => getHoverPromise(model, position, CancellationToken.None));\nfunction isValid(result) {\n    const hasRange = (typeof result.range !== 'undefined');\n    const hasHtmlContent = typeof result.contents !== 'undefined' && result.contents && result.contents.length > 0;\n    return hasRange && hasHtmlContent;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { Color, RGBA } from '../../../../base/common/color.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Range } from '../../../common/core/range.js';\nimport { getColorPresentations } from '../../colorPicker/browser/color.js';\nimport { ColorDetector } from '../../colorPicker/browser/colorDetector.js';\nimport { ColorPickerModel } from '../../colorPicker/browser/colorPickerModel.js';\nimport { ColorPickerWidget } from '../../colorPicker/browser/colorPickerWidget.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nexport class ColorHover {\n    constructor(owner, range, model, provider) {\n        this.owner = owner;\n        this.range = range;\n        this.model = model;\n        this.provider = provider;\n        /**\n         * Force the hover to always be rendered at this specific range,\n         * even in the case of multiple hover parts.\n         */\n        this.forceShowAtRange = true;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nlet ColorHoverParticipant = class ColorHoverParticipant {\n    constructor(_editor, _themeService) {\n        this._editor = _editor;\n        this._themeService = _themeService;\n    }\n    computeSync(anchor, lineDecorations) {\n        return [];\n    }\n    computeAsync(anchor, lineDecorations, token) {\n        return AsyncIterableObject.fromPromise(this._computeAsync(anchor, lineDecorations, token));\n    }\n    _computeAsync(anchor, lineDecorations, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel()) {\n                return [];\n            }\n            const colorDetector = ColorDetector.get(this._editor);\n            if (!colorDetector) {\n                return [];\n            }\n            for (const d of lineDecorations) {\n                if (!colorDetector.isColorDecorationId(d.id)) {\n                    continue;\n                }\n                const colorData = colorDetector.getColorData(d.range.getStartPosition());\n                if (colorData) {\n                    const colorHover = yield this._createColorHover(this._editor.getModel(), colorData.colorInfo, colorData.provider);\n                    return [colorHover];\n                }\n            }\n            return [];\n        });\n    }\n    _createColorHover(editorModel, colorInfo, provider) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const originalText = editorModel.getValueInRange(colorInfo.range);\n            const { red, green, blue, alpha } = colorInfo.color;\n            const rgba = new RGBA(Math.round(red * 255), Math.round(green * 255), Math.round(blue * 255), alpha);\n            const color = new Color(rgba);\n            const colorPresentations = yield getColorPresentations(editorModel, colorInfo, provider, CancellationToken.None);\n            const model = new ColorPickerModel(color, [], 0);\n            model.colorPresentations = colorPresentations || [];\n            model.guessColorPresentation(color, originalText);\n            return new ColorHover(this, Range.lift(colorInfo.range), model, provider);\n        });\n    }\n    renderHoverParts(context, hoverParts) {\n        if (hoverParts.length === 0 || !this._editor.hasModel()) {\n            return Disposable.None;\n        }\n        const disposables = new DisposableStore();\n        const colorHover = hoverParts[0];\n        const editorModel = this._editor.getModel();\n        const model = colorHover.model;\n        const widget = disposables.add(new ColorPickerWidget(context.fragment, model, this._editor.getOption(129 /* pixelRatio */), this._themeService));\n        context.setColorPicker(widget);\n        let range = new Range(colorHover.range.startLineNumber, colorHover.range.startColumn, colorHover.range.endLineNumber, colorHover.range.endColumn);\n        const updateEditorModel = () => {\n            let textEdits;\n            let newRange;\n            if (model.presentation.textEdit) {\n                textEdits = [model.presentation.textEdit];\n                newRange = new Range(model.presentation.textEdit.range.startLineNumber, model.presentation.textEdit.range.startColumn, model.presentation.textEdit.range.endLineNumber, model.presentation.textEdit.range.endColumn);\n                const trackedRange = this._editor.getModel()._setTrackedRange(null, newRange, 3 /* GrowsOnlyWhenTypingAfter */);\n                this._editor.pushUndoStop();\n                this._editor.executeEdits('colorpicker', textEdits);\n                newRange = this._editor.getModel()._getTrackedRange(trackedRange) || newRange;\n            }\n            else {\n                textEdits = [{ identifier: null, range, text: model.presentation.label, forceMoveMarkers: false }];\n                newRange = range.setEndPosition(range.endLineNumber, range.startColumn + model.presentation.label.length);\n                this._editor.pushUndoStop();\n                this._editor.executeEdits('colorpicker', textEdits);\n            }\n            if (model.presentation.additionalTextEdits) {\n                textEdits = [...model.presentation.additionalTextEdits];\n                this._editor.executeEdits('colorpicker', textEdits);\n                context.hide();\n            }\n            this._editor.pushUndoStop();\n            range = newRange;\n        };\n        const updateColorPresentations = (color) => {\n            return getColorPresentations(editorModel, {\n                range: range,\n                color: {\n                    red: color.rgba.r / 255,\n                    green: color.rgba.g / 255,\n                    blue: color.rgba.b / 255,\n                    alpha: color.rgba.a\n                }\n            }, colorHover.provider, CancellationToken.None).then((colorPresentations) => {\n                model.colorPresentations = colorPresentations || [];\n            });\n        };\n        disposables.add(model.onColorFlushed((color) => {\n            updateColorPresentations(color).then(updateEditorModel);\n        }));\n        disposables.add(model.onDidChangeColor(updateColorPresentations));\n        return disposables;\n    }\n};\nColorHoverParticipant = __decorate([\n    __param(1, IThemeService)\n], ColorHoverParticipant);\nexport { ColorHoverParticipant };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __asyncValues = (this && this.__asyncValues) || function (o) {\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n    var m = o[Symbol.asyncIterator], i;\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n};\nimport { createCancelableAsyncIterable, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nexport class HoverResult {\n    constructor(value, isComplete, hasLoadingMessage) {\n        this.value = value;\n        this.isComplete = isComplete;\n        this.hasLoadingMessage = hasLoadingMessage;\n    }\n}\n/**\n * Computing the hover is very fine tuned.\n *\n * Suppose the hover delay is 300ms (the default). Then, when resting the mouse at an anchor:\n * - at 150ms, the async computation is triggered (i.e. semantic hover)\n *   - if async results already come in, they are not rendered yet.\n * - at 300ms, the sync computation is triggered (i.e. decorations, markers)\n *   - if there are sync or async results, they are rendered.\n * - at 900ms, if the async computation hasn't finished, a \"Loading...\" result is added.\n */\nexport class HoverOperation extends Disposable {\n    constructor(_editor, _computer) {\n        super();\n        this._editor = _editor;\n        this._computer = _computer;\n        this._onResult = this._register(new Emitter());\n        this.onResult = this._onResult.event;\n        this._firstWaitScheduler = this._register(new RunOnceScheduler(() => this._triggerAsyncComputation(), 0));\n        this._secondWaitScheduler = this._register(new RunOnceScheduler(() => this._triggerSyncComputation(), 0));\n        this._loadingMessageScheduler = this._register(new RunOnceScheduler(() => this._triggerLoadingMessage(), 0));\n        this._state = 0 /* Idle */;\n        this._asyncIterable = null;\n        this._asyncIterableDone = false;\n        this._result = [];\n    }\n    dispose() {\n        if (this._asyncIterable) {\n            this._asyncIterable.cancel();\n            this._asyncIterable = null;\n        }\n        super.dispose();\n    }\n    get _hoverTime() {\n        return this._editor.getOption(53 /* hover */).delay;\n    }\n    get _firstWaitTime() {\n        return this._hoverTime / 2;\n    }\n    get _secondWaitTime() {\n        return this._hoverTime - this._firstWaitTime;\n    }\n    get _loadingMessageTime() {\n        return 3 * this._hoverTime;\n    }\n    _setState(state, fireResult = true) {\n        this._state = state;\n        if (fireResult) {\n            this._fireResult();\n        }\n    }\n    _triggerAsyncComputation() {\n        this._setState(2 /* SecondWait */);\n        this._secondWaitScheduler.schedule(this._secondWaitTime);\n        if (this._computer.computeAsync) {\n            this._asyncIterableDone = false;\n            this._asyncIterable = createCancelableAsyncIterable(token => this._computer.computeAsync(token));\n            (() => __awaiter(this, void 0, void 0, function* () {\n                var e_1, _a;\n                try {\n                    try {\n                        for (var _b = __asyncValues(this._asyncIterable), _c; _c = yield _b.next(), !_c.done;) {\n                            const item = _c.value;\n                            if (item) {\n                                this._result.push(item);\n                                this._fireResult();\n                            }\n                        }\n                    }\n                    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                    finally {\n                        try {\n                            if (_c && !_c.done && (_a = _b.return)) yield _a.call(_b);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                    }\n                    this._asyncIterableDone = true;\n                    if (this._state === 3 /* WaitingForAsync */ || this._state === 4 /* WaitingForAsyncShowingLoading */) {\n                        this._setState(0 /* Idle */);\n                    }\n                }\n                catch (e) {\n                    onUnexpectedError(e);\n                }\n            }))();\n        }\n        else {\n            this._asyncIterableDone = true;\n        }\n    }\n    _triggerSyncComputation() {\n        if (this._computer.computeSync) {\n            this._result = this._result.concat(this._computer.computeSync());\n        }\n        this._setState(this._asyncIterableDone ? 0 /* Idle */ : 3 /* WaitingForAsync */);\n    }\n    _triggerLoadingMessage() {\n        if (this._state === 3 /* WaitingForAsync */) {\n            this._setState(4 /* WaitingForAsyncShowingLoading */);\n        }\n    }\n    _fireResult() {\n        if (this._state === 1 /* FirstWait */ || this._state === 2 /* SecondWait */) {\n            // Do not send out results before the hover time\n            return;\n        }\n        const isComplete = (this._state === 0 /* Idle */);\n        const hasLoadingMessage = (this._state === 4 /* WaitingForAsyncShowingLoading */);\n        this._onResult.fire(new HoverResult(this._result.slice(0), isComplete, hasLoadingMessage));\n    }\n    start(mode) {\n        if (mode === 0 /* Delayed */) {\n            if (this._state === 0 /* Idle */) {\n                this._setState(1 /* FirstWait */);\n                this._firstWaitScheduler.schedule(this._firstWaitTime);\n                this._loadingMessageScheduler.schedule(this._loadingMessageTime);\n            }\n        }\n        else {\n            switch (this._state) {\n                case 0 /* Idle */:\n                    this._triggerAsyncComputation();\n                    this._secondWaitScheduler.cancel();\n                    this._triggerSyncComputation();\n                    break;\n                case 2 /* SecondWait */:\n                    this._secondWaitScheduler.cancel();\n                    this._triggerSyncComputation();\n                    break;\n            }\n        }\n    }\n    cancel() {\n        this._firstWaitScheduler.cancel();\n        this._secondWaitScheduler.cancel();\n        this._loadingMessageScheduler.cancel();\n        if (this._asyncIterable) {\n            this._asyncIterable.cancel();\n            this._asyncIterable = null;\n        }\n        this._result = [];\n        this._setState(0 /* Idle */, false);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { createCancelablePromise, disposableTimeout } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { Range } from '../../../common/core/range.js';\nimport { IMarkerDecorationsService } from '../../../common/services/markerDecorations.js';\nimport { getCodeActions } from '../../codeAction/browser/codeAction.js';\nimport { QuickFixAction, QuickFixController } from '../../codeAction/browser/codeActionCommands.js';\nimport { CodeActionKind } from '../../codeAction/browser/types.js';\nimport { MarkerController, NextMarkerAction } from '../../gotoError/browser/gotoError.js';\nimport * as nls from '../../../../nls.js';\nimport { IMarkerData, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { Progress } from '../../../../platform/progress/common/progress.js';\nimport { textLinkActiveForeground, textLinkForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nconst $ = dom.$;\nexport class MarkerHover {\n    constructor(owner, range, marker) {\n        this.owner = owner;\n        this.range = range;\n        this.marker = marker;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nconst markerCodeActionTrigger = {\n    type: 1 /* Invoke */,\n    filter: { include: CodeActionKind.QuickFix }\n};\nlet MarkerHoverParticipant = class MarkerHoverParticipant {\n    constructor(_editor, _markerDecorationsService, _openerService) {\n        this._editor = _editor;\n        this._markerDecorationsService = _markerDecorationsService;\n        this._openerService = _openerService;\n        this.recentMarkerCodeActionsInfo = undefined;\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* Range */) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        const result = [];\n        for (const d of lineDecorations) {\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            const marker = this._markerDecorationsService.getMarker(model.uri, d);\n            if (!marker) {\n                continue;\n            }\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\n            result.push(new MarkerHover(this, range, marker));\n        }\n        return result;\n    }\n    renderHoverParts(context, hoverParts) {\n        if (!hoverParts.length) {\n            return Disposable.None;\n        }\n        const disposables = new DisposableStore();\n        hoverParts.forEach(msg => context.fragment.appendChild(this.renderMarkerHover(msg, disposables)));\n        const markerHoverForStatusbar = hoverParts.length === 1 ? hoverParts[0] : hoverParts.sort((a, b) => MarkerSeverity.compare(a.marker.severity, b.marker.severity))[0];\n        this.renderMarkerStatusbar(context, markerHoverForStatusbar, disposables);\n        return disposables;\n    }\n    renderMarkerHover(markerHover, disposables) {\n        const hoverElement = $('div.hover-row');\n        const markerElement = dom.append(hoverElement, $('div.marker.hover-contents'));\n        const { source, message, code, relatedInformation } = markerHover.marker;\n        this._editor.applyFontInfo(markerElement);\n        const messageElement = dom.append(markerElement, $('span'));\n        messageElement.style.whiteSpace = 'pre-wrap';\n        messageElement.innerText = message;\n        if (source || code) {\n            // Code has link\n            if (code && typeof code !== 'string') {\n                const sourceAndCodeElement = $('span');\n                if (source) {\n                    const sourceElement = dom.append(sourceAndCodeElement, $('span'));\n                    sourceElement.innerText = source;\n                }\n                const codeLink = dom.append(sourceAndCodeElement, $('a.code-link'));\n                codeLink.setAttribute('href', code.target.toString());\n                disposables.add(dom.addDisposableListener(codeLink, 'click', (e) => {\n                    this._openerService.open(code.target, { allowCommands: true });\n                    e.preventDefault();\n                    e.stopPropagation();\n                }));\n                const codeElement = dom.append(codeLink, $('span'));\n                codeElement.innerText = code.value;\n                const detailsElement = dom.append(markerElement, sourceAndCodeElement);\n                detailsElement.style.opacity = '0.6';\n                detailsElement.style.paddingLeft = '6px';\n            }\n            else {\n                const detailsElement = dom.append(markerElement, $('span'));\n                detailsElement.style.opacity = '0.6';\n                detailsElement.style.paddingLeft = '6px';\n                detailsElement.innerText = source && code ? `${source}(${code})` : source ? source : `(${code})`;\n            }\n        }\n        if (isNonEmptyArray(relatedInformation)) {\n            for (const { message, resource, startLineNumber, startColumn } of relatedInformation) {\n                const relatedInfoContainer = dom.append(markerElement, $('div'));\n                relatedInfoContainer.style.marginTop = '8px';\n                const a = dom.append(relatedInfoContainer, $('a'));\n                a.innerText = `${basename(resource)}(${startLineNumber}, ${startColumn}): `;\n                a.style.cursor = 'pointer';\n                disposables.add(dom.addDisposableListener(a, 'click', (e) => {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    if (this._openerService) {\n                        this._openerService.open(resource, {\n                            fromUserGesture: true,\n                            editorOptions: { selection: { startLineNumber, startColumn } }\n                        }).catch(onUnexpectedError);\n                    }\n                }));\n                const messageElement = dom.append(relatedInfoContainer, $('span'));\n                messageElement.innerText = message;\n                this._editor.applyFontInfo(messageElement);\n            }\n        }\n        return hoverElement;\n    }\n    renderMarkerStatusbar(context, markerHover, disposables) {\n        if (markerHover.marker.severity === MarkerSeverity.Error || markerHover.marker.severity === MarkerSeverity.Warning || markerHover.marker.severity === MarkerSeverity.Info) {\n            context.statusBar.addAction({\n                label: nls.localize('view problem', \"View Problem\"),\n                commandId: NextMarkerAction.ID,\n                run: () => {\n                    var _a;\n                    context.hide();\n                    (_a = MarkerController.get(this._editor)) === null || _a === void 0 ? void 0 : _a.showAtMarker(markerHover.marker);\n                    this._editor.focus();\n                }\n            });\n        }\n        if (!this._editor.getOption(81 /* readOnly */)) {\n            const quickfixPlaceholderElement = context.statusBar.append($('div'));\n            if (this.recentMarkerCodeActionsInfo) {\n                if (IMarkerData.makeKey(this.recentMarkerCodeActionsInfo.marker) === IMarkerData.makeKey(markerHover.marker)) {\n                    if (!this.recentMarkerCodeActionsInfo.hasCodeActions) {\n                        quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\n                    }\n                }\n                else {\n                    this.recentMarkerCodeActionsInfo = undefined;\n                }\n            }\n            const updatePlaceholderDisposable = this.recentMarkerCodeActionsInfo && !this.recentMarkerCodeActionsInfo.hasCodeActions ? Disposable.None : disposables.add(disposableTimeout(() => quickfixPlaceholderElement.textContent = nls.localize('checkingForQuickFixes', \"Checking for quick fixes...\"), 200));\n            if (!quickfixPlaceholderElement.textContent) {\n                // Have some content in here to avoid flickering\n                quickfixPlaceholderElement.textContent = String.fromCharCode(0xA0); // &nbsp;\n            }\n            const codeActionsPromise = this.getCodeActions(markerHover.marker);\n            disposables.add(toDisposable(() => codeActionsPromise.cancel()));\n            codeActionsPromise.then(actions => {\n                updatePlaceholderDisposable.dispose();\n                this.recentMarkerCodeActionsInfo = { marker: markerHover.marker, hasCodeActions: actions.validActions.length > 0 };\n                if (!this.recentMarkerCodeActionsInfo.hasCodeActions) {\n                    actions.dispose();\n                    quickfixPlaceholderElement.textContent = nls.localize('noQuickFixes', \"No quick fixes available\");\n                    return;\n                }\n                quickfixPlaceholderElement.style.display = 'none';\n                let showing = false;\n                disposables.add(toDisposable(() => {\n                    if (!showing) {\n                        actions.dispose();\n                    }\n                }));\n                context.statusBar.addAction({\n                    label: nls.localize('quick fixes', \"Quick Fix...\"),\n                    commandId: QuickFixAction.Id,\n                    run: (target) => {\n                        showing = true;\n                        const controller = QuickFixController.get(this._editor);\n                        const elementPosition = dom.getDomNodePagePosition(target);\n                        // Hide the hover pre-emptively, otherwise the editor can close the code actions\n                        // context menu as well when using keyboard navigation\n                        context.hide();\n                        controller === null || controller === void 0 ? void 0 : controller.showCodeActions(markerCodeActionTrigger, actions, {\n                            x: elementPosition.left + 6,\n                            y: elementPosition.top + elementPosition.height + 6\n                        });\n                    }\n                });\n            }, onUnexpectedError);\n        }\n    }\n    getCodeActions(marker) {\n        return createCancelablePromise(cancellationToken => {\n            return getCodeActions(this._editor.getModel(), new Range(marker.startLineNumber, marker.startColumn, marker.endLineNumber, marker.endColumn), markerCodeActionTrigger, Progress.None, cancellationToken);\n        });\n    }\n};\nMarkerHoverParticipant = __decorate([\n    __param(1, IMarkerDecorationsService),\n    __param(2, IOpenerService)\n], MarkerHoverParticipant);\nexport { MarkerHoverParticipant };\nregisterThemingParticipant((theme, collector) => {\n    const linkFg = theme.getColor(textLinkForeground);\n    if (linkFg) {\n        collector.addRule(`.monaco-hover .hover-contents a.code-link span { color: ${linkFg}; }`);\n    }\n    const activeLinkFg = theme.getColor(textLinkActiveForeground);\n    if (activeLinkFg) {\n        collector.addRule(`.monaco-hover .hover-contents a.code-link span:hover { color: ${activeLinkFg}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { HoverAction, HoverWidget } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { TokenizationRegistry } from '../../../common/languages.js';\nimport { ColorHoverParticipant } from './colorHoverParticipant.js';\nimport { HoverOperation } from './hoverOperation.js';\nimport { HoverRangeAnchor } from './hoverTypes.js';\nimport { MarkdownHoverParticipant } from './markdownHoverParticipant.js';\nimport { MarkerHoverParticipant } from './markerHoverParticipant.js';\nimport { InlineCompletionsHoverParticipant } from '../../inlineCompletions/browser/inlineCompletionsHoverParticipant.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { Context as SuggestContext } from '../../suggest/browser/suggest.js';\nimport { UnicodeHighlighterHoverParticipant } from '../../unicodeHighlighter/browser/unicodeHighlighter.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { InlayHintsHover } from '../../inlayHints/browser/inlayHintsHover.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { Emitter } from '../../../../base/common/event.js';\nconst $ = dom.$;\nlet ContentHoverController = class ContentHoverController extends Disposable {\n    constructor(_editor, _instantiationService, _keybindingService) {\n        super();\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._keybindingService = _keybindingService;\n        this._participants = [\n            this._instantiationService.createInstance(ColorHoverParticipant, this._editor),\n            this._instantiationService.createInstance(MarkdownHoverParticipant, this._editor),\n            this._instantiationService.createInstance(InlineCompletionsHoverParticipant, this._editor),\n            this._instantiationService.createInstance(UnicodeHighlighterHoverParticipant, this._editor),\n            this._instantiationService.createInstance(MarkerHoverParticipant, this._editor),\n            this._instantiationService.createInstance(InlayHintsHover, this._editor),\n        ];\n        this._widget = this._register(this._instantiationService.createInstance(ContentHoverWidget, this._editor));\n        this._decorationsChangerListener = this._register(new EditorDecorationsChangerListener(this._editor));\n        this._computer = new ContentHoverComputer(this._editor, this._participants);\n        this._hoverOperation = this._register(new HoverOperation(this._editor, this._computer));\n        this._messages = [];\n        this._messagesAreComplete = false;\n        this._register(this._hoverOperation.onResult((result) => {\n            this._withResult(result.value, result.isComplete, result.hasLoadingMessage);\n        }));\n        this._register(this._decorationsChangerListener.onDidChangeModelDecorations(() => this._onModelDecorationsChanged()));\n        this._register(dom.addStandardDisposableListener(this._widget.getDomNode(), 'keydown', (e) => {\n            if (e.equals(9 /* Escape */)) {\n                this.hide();\n            }\n        }));\n        this._register(TokenizationRegistry.onDidChange(() => {\n            if (this._widget.position && this._computer.anchor && this._messages.length > 0) {\n                this._widget.clear();\n                this._renderMessages(this._computer.anchor, this._messages);\n            }\n        }));\n    }\n    _onModelDecorationsChanged() {\n        if (this._widget.position) {\n            // The decorations have changed and the hover is visible,\n            // we need to recompute the displayed text\n            this._hoverOperation.cancel();\n            if (!this._widget.colorPicker) { // TODO@Michel ensure that displayed text for other decorations is computed even if color picker is in place\n                this._hoverOperation.start(0 /* Delayed */);\n            }\n        }\n    }\n    maybeShowAt(mouseEvent) {\n        const anchorCandidates = [];\n        for (const participant of this._participants) {\n            if (participant.suggestHoverAnchor) {\n                const anchor = participant.suggestHoverAnchor(mouseEvent);\n                if (anchor) {\n                    anchorCandidates.push(anchor);\n                }\n            }\n        }\n        const target = mouseEvent.target;\n        if (target.type === 6 /* CONTENT_TEXT */) {\n            anchorCandidates.push(new HoverRangeAnchor(0, target.range));\n        }\n        if (target.type === 7 /* CONTENT_EMPTY */) {\n            const epsilon = this._editor.getOption(44 /* fontInfo */).typicalHalfwidthCharacterWidth / 2;\n            if (!target.detail.isAfterLines && typeof target.detail.horizontalDistanceToText === 'number' && target.detail.horizontalDistanceToText < epsilon) {\n                // Let hover kick in even when the mouse is technically in the empty area after a line, given the distance is small enough\n                anchorCandidates.push(new HoverRangeAnchor(0, target.range));\n            }\n        }\n        if (anchorCandidates.length === 0) {\n            return false;\n        }\n        anchorCandidates.sort((a, b) => b.priority - a.priority);\n        this._startShowingAt(anchorCandidates[0], 0 /* Delayed */, false);\n        return true;\n    }\n    startShowingAtRange(range, mode, focus) {\n        this._startShowingAt(new HoverRangeAnchor(0, range), mode, focus);\n    }\n    _startShowingAt(anchor, mode, focus) {\n        if (this._computer.anchor && this._computer.anchor.equals(anchor)) {\n            // We have to show the widget at the exact same range as before, so no work is needed\n            return;\n        }\n        this._hoverOperation.cancel();\n        if (this._widget.position) {\n            // The range might have changed, but the hover is visible\n            // Instead of hiding it completely, filter out messages that are still in the new range and\n            // kick off a new computation\n            if (!this._computer.anchor || !anchor.canAdoptVisibleHover(this._computer.anchor, this._widget.position)) {\n                this.hide();\n            }\n            else {\n                const filteredMessages = this._messages.filter((m) => m.isValidForHoverAnchor(anchor));\n                if (filteredMessages.length === 0) {\n                    this.hide();\n                }\n                else if (filteredMessages.length === this._messages.length && this._messagesAreComplete) {\n                    // no change\n                    return;\n                }\n                else {\n                    this._renderMessages(anchor, filteredMessages);\n                }\n            }\n        }\n        this._computer.anchor = anchor;\n        this._computer.shouldFocus = focus;\n        this._hoverOperation.start(mode);\n    }\n    hide() {\n        this._computer.anchor = null;\n        this._hoverOperation.cancel();\n        this._widget.hide();\n    }\n    isColorPickerVisible() {\n        return !!this._widget.colorPicker;\n    }\n    _addLoadingMessage(result) {\n        if (this._computer.anchor) {\n            for (const participant of this._participants) {\n                if (participant.createLoadingMessage) {\n                    const loadingMessage = participant.createLoadingMessage(this._computer.anchor);\n                    if (loadingMessage) {\n                        return result.slice(0).concat([loadingMessage]);\n                    }\n                }\n            }\n        }\n        return result;\n    }\n    _withResult(result, isComplete, hasLoadingMessage) {\n        this._messages = (hasLoadingMessage ? this._addLoadingMessage(result) : result);\n        this._messagesAreComplete = isComplete;\n        if (this._computer.anchor && this._messages.length > 0) {\n            this._renderMessages(this._computer.anchor, this._messages);\n        }\n        else if (isComplete) {\n            this.hide();\n        }\n    }\n    _renderMessages(anchor, messages) {\n        // update column from which to show\n        let renderColumn = 1073741824 /* MAX_SAFE_SMALL_INTEGER */;\n        let highlightRange = messages[0].range;\n        let forceShowAtRange = null;\n        for (const msg of messages) {\n            renderColumn = Math.min(renderColumn, msg.range.startColumn);\n            highlightRange = Range.plusRange(highlightRange, msg.range);\n            if (msg.forceShowAtRange) {\n                forceShowAtRange = msg.range;\n            }\n        }\n        const disposables = new DisposableStore();\n        const statusBar = disposables.add(new EditorHoverStatusBar(this._keybindingService));\n        const fragment = document.createDocumentFragment();\n        let colorPicker = null;\n        const context = {\n            fragment,\n            statusBar,\n            setColorPicker: (widget) => colorPicker = widget,\n            onContentsChanged: () => this._widget.onContentsChanged(),\n            hide: () => this.hide()\n        };\n        for (const participant of this._participants) {\n            const hoverParts = messages.filter(msg => msg.owner === participant);\n            if (hoverParts.length > 0) {\n                disposables.add(participant.renderHoverParts(context, hoverParts));\n            }\n        }\n        if (statusBar.hasContent) {\n            fragment.appendChild(statusBar.hoverElement);\n        }\n        if (fragment.hasChildNodes()) {\n            if (highlightRange) {\n                const highlightDecorations = this._decorationsChangerListener.deltaDecorations([], [{\n                        range: highlightRange,\n                        options: ContentHoverController._DECORATION_OPTIONS\n                    }]);\n                disposables.add(toDisposable(() => {\n                    this._decorationsChangerListener.deltaDecorations(highlightDecorations, []);\n                }));\n            }\n            this._widget.showAt(fragment, new ContentHoverVisibleData(colorPicker, forceShowAtRange ? forceShowAtRange.getStartPosition() : new Position(anchor.range.startLineNumber, renderColumn), forceShowAtRange ? forceShowAtRange : highlightRange, this._editor.getOption(53 /* hover */).above, this._computer.shouldFocus, disposables));\n        }\n        else {\n            disposables.dispose();\n        }\n    }\n};\nContentHoverController._DECORATION_OPTIONS = ModelDecorationOptions.register({\n    description: 'content-hover-highlight',\n    className: 'hoverHighlight'\n});\nContentHoverController = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IKeybindingService)\n], ContentHoverController);\nexport { ContentHoverController };\n/**\n * Allows listening to `ICodeEditor.onDidChangeModelDecorations` and ignores the change caused by itself.\n */\nclass EditorDecorationsChangerListener extends Disposable {\n    constructor(_editor) {\n        super();\n        this._editor = _editor;\n        this._onDidChangeModelDecorations = this._register(new Emitter());\n        this.onDidChangeModelDecorations = this._onDidChangeModelDecorations.event;\n        this._isChangingDecorations = false;\n        this._register(this._editor.onDidChangeModelDecorations((e) => {\n            if (this._isChangingDecorations) {\n                return;\n            }\n            this._onDidChangeModelDecorations.fire(e);\n        }));\n    }\n    deltaDecorations(oldDecorations, newDecorations) {\n        try {\n            this._isChangingDecorations = true;\n            return this._editor.deltaDecorations(oldDecorations, newDecorations);\n        }\n        finally {\n            this._isChangingDecorations = false;\n        }\n    }\n}\nclass ContentHoverVisibleData {\n    constructor(colorPicker, showAtPosition, showAtRange, preferAbove, stoleFocus, disposables) {\n        this.colorPicker = colorPicker;\n        this.showAtPosition = showAtPosition;\n        this.showAtRange = showAtRange;\n        this.preferAbove = preferAbove;\n        this.stoleFocus = stoleFocus;\n        this.disposables = disposables;\n    }\n}\nlet ContentHoverWidget = class ContentHoverWidget extends Disposable {\n    constructor(_editor, _contextKeyService) {\n        super();\n        this._editor = _editor;\n        this._contextKeyService = _contextKeyService;\n        this.allowEditorOverflow = true;\n        this._hoverVisibleKey = EditorContextKeys.hoverVisible.bindTo(this._contextKeyService);\n        this._hover = this._register(new HoverWidget());\n        this._visibleData = null;\n        this._register(this._editor.onDidLayoutChange(() => this._layout()));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(44 /* fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._setVisibleData(null);\n        this._layout();\n        this._editor.addContentWidget(this);\n    }\n    /**\n     * Returns `null` if the hover is not visible.\n     */\n    get position() {\n        var _a, _b;\n        return (_b = (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.showAtPosition) !== null && _b !== void 0 ? _b : null;\n    }\n    /**\n     * Returns `null` if the color picker is not visible.\n     */\n    get colorPicker() {\n        var _a, _b;\n        return (_b = (_a = this._visibleData) === null || _a === void 0 ? void 0 : _a.colorPicker) !== null && _b !== void 0 ? _b : null;\n    }\n    dispose() {\n        this._editor.removeContentWidget(this);\n        if (this._visibleData) {\n            this._visibleData.disposables.dispose();\n        }\n        super.dispose();\n    }\n    getId() {\n        return ContentHoverWidget.ID;\n    }\n    getDomNode() {\n        return this._hover.containerDomNode;\n    }\n    getPosition() {\n        if (!this._visibleData) {\n            return null;\n        }\n        let preferAbove = this._visibleData.preferAbove;\n        if (!preferAbove && this._contextKeyService.getContextKeyValue(SuggestContext.Visible.key)) {\n            // Prefer rendering above if the suggest widget is visible\n            preferAbove = true;\n        }\n        return {\n            position: this._visibleData.showAtPosition,\n            range: this._visibleData.showAtRange,\n            preference: (preferAbove\n                ? [1 /* ABOVE */, 2 /* BELOW */]\n                : [2 /* BELOW */, 1 /* ABOVE */]),\n        };\n    }\n    _setVisibleData(visibleData) {\n        if (this._visibleData) {\n            this._visibleData.disposables.dispose();\n        }\n        this._visibleData = visibleData;\n        this._hoverVisibleKey.set(!!this._visibleData);\n        this._hover.containerDomNode.classList.toggle('hidden', !this._visibleData);\n    }\n    _layout() {\n        const height = Math.max(this._editor.getLayoutInfo().height / 4, 250);\n        const { fontSize, lineHeight } = this._editor.getOption(44 /* fontInfo */);\n        this._hover.contentsDomNode.style.fontSize = `${fontSize}px`;\n        this._hover.contentsDomNode.style.lineHeight = `${lineHeight / fontSize}`;\n        this._hover.contentsDomNode.style.maxHeight = `${height}px`;\n        this._hover.contentsDomNode.style.maxWidth = `${Math.max(this._editor.getLayoutInfo().width * 0.66, 500)}px`;\n    }\n    _updateFont() {\n        const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\n        codeClasses.forEach(node => this._editor.applyFontInfo(node));\n    }\n    showAt(node, visibleData) {\n        this._setVisibleData(visibleData);\n        this._hover.contentsDomNode.textContent = '';\n        this._hover.contentsDomNode.appendChild(node);\n        this._hover.contentsDomNode.style.paddingBottom = '';\n        this._updateFont();\n        this._editor.layoutContentWidget(this);\n        this.onContentsChanged();\n        // Simply force a synchronous render on the editor\n        // such that the widget does not really render with left = '0px'\n        this._editor.render();\n        // See https://github.com/microsoft/vscode/issues/140339\n        // TODO: Doing a second layout of the hover after force rendering the editor\n        this._editor.layoutContentWidget(this);\n        this.onContentsChanged();\n        if (visibleData.stoleFocus) {\n            this._hover.containerDomNode.focus();\n        }\n        if (visibleData.colorPicker) {\n            visibleData.colorPicker.layout();\n        }\n    }\n    hide() {\n        if (this._visibleData) {\n            const stoleFocus = this._visibleData.stoleFocus;\n            this._setVisibleData(null);\n            this._editor.layoutContentWidget(this);\n            if (stoleFocus) {\n                this._editor.focus();\n            }\n        }\n    }\n    onContentsChanged() {\n        this._hover.onContentsChanged();\n        const scrollDimensions = this._hover.scrollbar.getScrollDimensions();\n        const hasHorizontalScrollbar = (scrollDimensions.scrollWidth > scrollDimensions.width);\n        if (hasHorizontalScrollbar) {\n            // There is just a horizontal scrollbar\n            const extraBottomPadding = `${this._hover.scrollbar.options.horizontalScrollbarSize}px`;\n            if (this._hover.contentsDomNode.style.paddingBottom !== extraBottomPadding) {\n                this._hover.contentsDomNode.style.paddingBottom = extraBottomPadding;\n                this._editor.layoutContentWidget(this);\n                this._hover.onContentsChanged();\n            }\n        }\n    }\n    clear() {\n        this._hover.contentsDomNode.textContent = '';\n    }\n};\nContentHoverWidget.ID = 'editor.contrib.contentHoverWidget';\nContentHoverWidget = __decorate([\n    __param(1, IContextKeyService)\n], ContentHoverWidget);\nexport { ContentHoverWidget };\nlet EditorHoverStatusBar = class EditorHoverStatusBar extends Disposable {\n    constructor(_keybindingService) {\n        super();\n        this._keybindingService = _keybindingService;\n        this._hasContent = false;\n        this.hoverElement = $('div.hover-row.status-bar');\n        this.actionsElement = dom.append(this.hoverElement, $('div.actions'));\n    }\n    get hasContent() {\n        return this._hasContent;\n    }\n    addAction(actionOptions) {\n        const keybinding = this._keybindingService.lookupKeybinding(actionOptions.commandId);\n        const keybindingLabel = keybinding ? keybinding.getLabel() : null;\n        this._hasContent = true;\n        return this._register(HoverAction.render(this.actionsElement, actionOptions, keybindingLabel));\n    }\n    append(element) {\n        const result = dom.append(this.actionsElement, element);\n        this._hasContent = true;\n        return result;\n    }\n};\nEditorHoverStatusBar = __decorate([\n    __param(0, IKeybindingService)\n], EditorHoverStatusBar);\nclass ContentHoverComputer {\n    constructor(_editor, _participants) {\n        this._editor = _editor;\n        this._participants = _participants;\n        this._anchor = null;\n        this._shouldFocus = false;\n    }\n    get anchor() { return this._anchor; }\n    set anchor(value) { this._anchor = value; }\n    get shouldFocus() { return this._shouldFocus; }\n    set shouldFocus(value) { this._shouldFocus = value; }\n    static _getLineDecorations(editor, anchor) {\n        if (anchor.type !== 1 /* Range */) {\n            return [];\n        }\n        const model = editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        return editor.getLineDecorations(lineNumber).filter((d) => {\n            if (d.options.isWholeLine) {\n                return true;\n            }\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            if (d.options.showIfCollapsed) {\n                // Relax check around `showIfCollapsed` decorations to also include +/- 1 character\n                if (startColumn > anchor.range.startColumn + 1 || anchor.range.endColumn - 1 > endColumn) {\n                    return false;\n                }\n            }\n            else {\n                if (startColumn > anchor.range.startColumn || anchor.range.endColumn > endColumn) {\n                    return false;\n                }\n            }\n            return true;\n        });\n    }\n    computeAsync(token) {\n        const anchor = this._anchor;\n        if (!this._editor.hasModel() || !anchor) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, anchor);\n        return AsyncIterableObject.merge(this._participants.map((participant) => {\n            if (!participant.computeAsync) {\n                return AsyncIterableObject.EMPTY;\n            }\n            return participant.computeAsync(anchor, lineDecorations, token);\n        }));\n    }\n    computeSync() {\n        if (!this._editor.hasModel() || !this._anchor) {\n            return [];\n        }\n        const lineDecorations = ContentHoverComputer._getLineDecorations(this._editor, this._anchor);\n        let result = [];\n        for (const participant of this._participants) {\n            result = result.concat(participant.computeSync(this._anchor, lineDecorations));\n        }\n        return coalesce(result);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { asArray } from '../../../../base/common/arrays.js';\nimport { isEmptyMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../markdownRenderer/browser/markdownRenderer.js';\nimport { HoverOperation } from './hoverOperation.js';\nimport { NullOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { HoverWidget } from '../../../../base/browser/ui/hover/hoverWidget.js';\nconst $ = dom.$;\nexport class MarginHoverWidget extends Disposable {\n    constructor(editor, languageService, openerService = NullOpenerService) {\n        super();\n        this._renderDisposeables = this._register(new DisposableStore());\n        this._editor = editor;\n        this._isVisible = false;\n        this._messages = [];\n        this._hover = this._register(new HoverWidget());\n        this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n        this._markdownRenderer = this._register(new MarkdownRenderer({ editor: this._editor }, languageService, openerService));\n        this._computer = new MarginHoverComputer(this._editor);\n        this._hoverOperation = this._register(new HoverOperation(this._editor, this._computer));\n        this._register(this._hoverOperation.onResult((result) => {\n            this._withResult(result.value);\n        }));\n        this._register(this._editor.onDidChangeModelDecorations(() => this._onModelDecorationsChanged()));\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(44 /* fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._editor.addOverlayWidget(this);\n    }\n    dispose() {\n        this._editor.removeOverlayWidget(this);\n        super.dispose();\n    }\n    getId() {\n        return MarginHoverWidget.ID;\n    }\n    getDomNode() {\n        return this._hover.containerDomNode;\n    }\n    getPosition() {\n        return null;\n    }\n    _updateFont() {\n        const codeClasses = Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName('code'));\n        codeClasses.forEach(node => this._editor.applyFontInfo(node));\n    }\n    _onModelDecorationsChanged() {\n        if (this._isVisible) {\n            // The decorations have changed and the hover is visible,\n            // we need to recompute the displayed text\n            this._hoverOperation.cancel();\n            this._hoverOperation.start(0 /* Delayed */);\n        }\n    }\n    startShowingAt(lineNumber) {\n        if (this._computer.lineNumber === lineNumber) {\n            // We have to show the widget at the exact same line number as before, so no work is needed\n            return;\n        }\n        this._hoverOperation.cancel();\n        this.hide();\n        this._computer.lineNumber = lineNumber;\n        this._hoverOperation.start(0 /* Delayed */);\n    }\n    hide() {\n        this._computer.lineNumber = -1;\n        this._hoverOperation.cancel();\n        if (!this._isVisible) {\n            return;\n        }\n        this._isVisible = false;\n        this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n    }\n    _withResult(result) {\n        this._messages = result;\n        if (this._messages.length > 0) {\n            this._renderMessages(this._computer.lineNumber, this._messages);\n        }\n        else {\n            this.hide();\n        }\n    }\n    _renderMessages(lineNumber, messages) {\n        this._renderDisposeables.clear();\n        const fragment = document.createDocumentFragment();\n        for (const msg of messages) {\n            const markdownHoverElement = $('div.hover-row.markdown-hover');\n            const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n            const renderedContents = this._renderDisposeables.add(this._markdownRenderer.render(msg.value));\n            hoverContentsElement.appendChild(renderedContents.element);\n            fragment.appendChild(markdownHoverElement);\n        }\n        this._updateContents(fragment);\n        this._showAt(lineNumber);\n    }\n    _updateContents(node) {\n        this._hover.contentsDomNode.textContent = '';\n        this._hover.contentsDomNode.appendChild(node);\n        this._updateFont();\n    }\n    _showAt(lineNumber) {\n        if (!this._isVisible) {\n            this._isVisible = true;\n            this._hover.containerDomNode.classList.toggle('hidden', !this._isVisible);\n        }\n        const editorLayout = this._editor.getLayoutInfo();\n        const topForLineNumber = this._editor.getTopForLineNumber(lineNumber);\n        const editorScrollTop = this._editor.getScrollTop();\n        const lineHeight = this._editor.getOption(59 /* lineHeight */);\n        const nodeHeight = this._hover.containerDomNode.clientHeight;\n        const top = topForLineNumber - editorScrollTop - ((nodeHeight - lineHeight) / 2);\n        this._hover.containerDomNode.style.left = `${editorLayout.glyphMarginLeft + editorLayout.glyphMarginWidth}px`;\n        this._hover.containerDomNode.style.top = `${Math.max(Math.round(top), 0)}px`;\n    }\n}\nMarginHoverWidget.ID = 'editor.contrib.modesGlyphHoverWidget';\nclass MarginHoverComputer {\n    constructor(_editor) {\n        this._editor = _editor;\n        this._lineNumber = -1;\n    }\n    get lineNumber() {\n        return this._lineNumber;\n    }\n    set lineNumber(value) {\n        this._lineNumber = value;\n    }\n    computeSync() {\n        const toHoverMessage = (contents) => {\n            return {\n                value: contents\n            };\n        };\n        const lineDecorations = this._editor.getLineDecorations(this._lineNumber);\n        const result = [];\n        if (!lineDecorations) {\n            return result;\n        }\n        for (const d of lineDecorations) {\n            if (!d.options.glyphMarginClassName) {\n                continue;\n            }\n            const hoverMessage = d.options.glyphMarginHoverMessage;\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\n                continue;\n            }\n            result.push(...asArray(hoverMessage).map(toHoverMessage));\n        }\n        return result;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ILanguageService } from '../../../common/services/language.js';\nimport { GotoDefinitionAtPositionEditorContribution } from '../../gotoSymbol/browser/link/goToDefinitionAtPosition.js';\nimport { ContentHoverWidget, ContentHoverController } from './contentHover.js';\nimport { MarginHoverWidget } from './marginHover.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { editorHoverBackground, editorHoverBorder, editorHoverForeground, editorHoverHighlight, editorHoverStatusBarBackground, textCodeBlockBackground, textLinkActiveForeground, textLinkForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nlet ModesHoverController = class ModesHoverController {\n    constructor(_editor, _instantiationService, _openerService, _languageService, _contextKeyService) {\n        this._editor = _editor;\n        this._instantiationService = _instantiationService;\n        this._openerService = _openerService;\n        this._languageService = _languageService;\n        this._toUnhook = new DisposableStore();\n        this._isMouseDown = false;\n        this._hoverClicked = false;\n        this._contentWidget = null;\n        this._glyphWidget = null;\n        this._hookEvents();\n        this._didChangeConfigurationHandler = this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(53 /* hover */)) {\n                this._unhookEvents();\n                this._hookEvents();\n            }\n        });\n    }\n    static get(editor) {\n        return editor.getContribution(ModesHoverController.ID);\n    }\n    _hookEvents() {\n        const hideWidgetsEventHandler = () => this._hideWidgets();\n        const hoverOpts = this._editor.getOption(53 /* hover */);\n        this._isHoverEnabled = hoverOpts.enabled;\n        this._isHoverSticky = hoverOpts.sticky;\n        if (this._isHoverEnabled) {\n            this._toUnhook.add(this._editor.onMouseDown((e) => this._onEditorMouseDown(e)));\n            this._toUnhook.add(this._editor.onMouseUp((e) => this._onEditorMouseUp(e)));\n            this._toUnhook.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\n            this._toUnhook.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\n        }\n        else {\n            this._toUnhook.add(this._editor.onMouseMove((e) => this._onEditorMouseMove(e)));\n            this._toUnhook.add(this._editor.onKeyDown((e) => this._onKeyDown(e)));\n        }\n        this._toUnhook.add(this._editor.onMouseLeave(hideWidgetsEventHandler));\n        this._toUnhook.add(this._editor.onDidChangeModel(hideWidgetsEventHandler));\n        this._toUnhook.add(this._editor.onDidScrollChange((e) => this._onEditorScrollChanged(e)));\n    }\n    _unhookEvents() {\n        this._toUnhook.clear();\n    }\n    _onEditorScrollChanged(e) {\n        if (e.scrollTopChanged || e.scrollLeftChanged) {\n            this._hideWidgets();\n        }\n    }\n    _onEditorMouseDown(mouseEvent) {\n        this._isMouseDown = true;\n        const target = mouseEvent.target;\n        if (target.type === 9 /* CONTENT_WIDGET */ && target.detail === ContentHoverWidget.ID) {\n            this._hoverClicked = true;\n            // mouse down on top of content hover widget\n            return;\n        }\n        if (target.type === 12 /* OVERLAY_WIDGET */ && target.detail === MarginHoverWidget.ID) {\n            // mouse down on top of overlay hover widget\n            return;\n        }\n        if (target.type !== 12 /* OVERLAY_WIDGET */) {\n            this._hoverClicked = false;\n        }\n        this._hideWidgets();\n    }\n    _onEditorMouseUp(mouseEvent) {\n        this._isMouseDown = false;\n    }\n    _onEditorMouseMove(mouseEvent) {\n        var _a, _b, _c, _d, _e;\n        const target = mouseEvent.target;\n        if (this._isMouseDown && this._hoverClicked) {\n            return;\n        }\n        if (this._isHoverSticky && target.type === 9 /* CONTENT_WIDGET */ && target.detail === ContentHoverWidget.ID) {\n            // mouse moved on top of content hover widget\n            return;\n        }\n        if (this._isHoverSticky && !((_b = (_a = mouseEvent.event.browserEvent.view) === null || _a === void 0 ? void 0 : _a.getSelection()) === null || _b === void 0 ? void 0 : _b.isCollapsed)) {\n            // selected text within content hover widget\n            return;\n        }\n        if (!this._isHoverSticky && target.type === 9 /* CONTENT_WIDGET */ && target.detail === ContentHoverWidget.ID\n            && ((_c = this._contentWidget) === null || _c === void 0 ? void 0 : _c.isColorPickerVisible())) {\n            // though the hover is not sticky, the color picker needs to.\n            return;\n        }\n        if (this._isHoverSticky && target.type === 12 /* OVERLAY_WIDGET */ && target.detail === MarginHoverWidget.ID) {\n            // mouse moved on top of overlay hover widget\n            return;\n        }\n        if (!this._isHoverEnabled) {\n            this._hideWidgets();\n            return;\n        }\n        const contentWidget = this._getOrCreateContentWidget();\n        if (contentWidget.maybeShowAt(mouseEvent)) {\n            (_d = this._glyphWidget) === null || _d === void 0 ? void 0 : _d.hide();\n            return;\n        }\n        if (target.type === 2 /* GUTTER_GLYPH_MARGIN */ && target.position) {\n            (_e = this._contentWidget) === null || _e === void 0 ? void 0 : _e.hide();\n            if (!this._glyphWidget) {\n                this._glyphWidget = new MarginHoverWidget(this._editor, this._languageService, this._openerService);\n            }\n            this._glyphWidget.startShowingAt(target.position.lineNumber);\n            return;\n        }\n        this._hideWidgets();\n    }\n    _onKeyDown(e) {\n        if (e.keyCode !== 5 /* Ctrl */ && e.keyCode !== 6 /* Alt */ && e.keyCode !== 57 /* Meta */ && e.keyCode !== 4 /* Shift */) {\n            // Do not hide hover when a modifier key is pressed\n            this._hideWidgets();\n        }\n    }\n    _hideWidgets() {\n        var _a, _b, _c;\n        if ((this._isMouseDown && this._hoverClicked && ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isColorPickerVisible()))) {\n            return;\n        }\n        this._hoverClicked = false;\n        (_b = this._glyphWidget) === null || _b === void 0 ? void 0 : _b.hide();\n        (_c = this._contentWidget) === null || _c === void 0 ? void 0 : _c.hide();\n    }\n    _getOrCreateContentWidget() {\n        if (!this._contentWidget) {\n            this._contentWidget = this._instantiationService.createInstance(ContentHoverController, this._editor);\n        }\n        return this._contentWidget;\n    }\n    isColorPickerVisible() {\n        var _a;\n        return ((_a = this._contentWidget) === null || _a === void 0 ? void 0 : _a.isColorPickerVisible()) || false;\n    }\n    showContentHover(range, mode, focus) {\n        this._getOrCreateContentWidget().startShowingAtRange(range, mode, focus);\n    }\n    dispose() {\n        var _a, _b;\n        this._unhookEvents();\n        this._toUnhook.dispose();\n        this._didChangeConfigurationHandler.dispose();\n        (_a = this._glyphWidget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._contentWidget) === null || _b === void 0 ? void 0 : _b.dispose();\n    }\n};\nModesHoverController.ID = 'editor.contrib.hover';\nModesHoverController = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IOpenerService),\n    __param(3, ILanguageService),\n    __param(4, IContextKeyService)\n], ModesHoverController);\nexport { ModesHoverController };\nclass ShowHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.showHover',\n            label: nls.localize({\n                key: 'showHover',\n                comment: [\n                    'Label for action that will trigger the showing of a hover in the editor.',\n                    'This allows for users to show the hover without using the mouse.'\n                ]\n            }, \"Show Hover\"),\n            alias: 'Show Hover',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* CtrlCmd */ | 41 /* KeyK */, 2048 /* CtrlCmd */ | 39 /* KeyI */),\n                weight: 100 /* EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        if (!editor.hasModel()) {\n            return;\n        }\n        let controller = ModesHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const position = editor.getPosition();\n        const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n        const focus = editor.getOption(2 /* accessibilitySupport */) === 2 /* Enabled */;\n        controller.showContentHover(range, 1 /* Immediate */, focus);\n    }\n}\nclass ShowDefinitionPreviewHoverAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.showDefinitionPreviewHover',\n            label: nls.localize({\n                key: 'showDefinitionPreviewHover',\n                comment: [\n                    'Label for action that will trigger the showing of definition preview hover in the editor.',\n                    'This allows for users to show the definition preview hover without using the mouse.'\n                ]\n            }, \"Show Definition Preview Hover\"),\n            alias: 'Show Definition Preview Hover',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        const controller = ModesHoverController.get(editor);\n        if (!controller) {\n            return;\n        }\n        const position = editor.getPosition();\n        if (!position) {\n            return;\n        }\n        const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n        const goto = GotoDefinitionAtPositionEditorContribution.get(editor);\n        if (!goto) {\n            return;\n        }\n        const promise = goto.startFindDefinitionFromCursor(position);\n        promise.then(() => {\n            controller.showContentHover(range, 1 /* Immediate */, true);\n        });\n    }\n}\nregisterEditorContribution(ModesHoverController.ID, ModesHoverController);\nregisterEditorAction(ShowHoverAction);\nregisterEditorAction(ShowDefinitionPreviewHoverAction);\n// theming\nregisterThemingParticipant((theme, collector) => {\n    const editorHoverHighlightColor = theme.getColor(editorHoverHighlight);\n    if (editorHoverHighlightColor) {\n        collector.addRule(`.monaco-editor .hoverHighlight { background-color: ${editorHoverHighlightColor}; }`);\n    }\n    const hoverBackground = theme.getColor(editorHoverBackground);\n    if (hoverBackground) {\n        collector.addRule(`.monaco-editor .monaco-hover { background-color: ${hoverBackground}; }`);\n    }\n    const hoverBorder = theme.getColor(editorHoverBorder);\n    if (hoverBorder) {\n        collector.addRule(`.monaco-editor .monaco-hover { border: 1px solid ${hoverBorder}; }`);\n        collector.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${hoverBorder.transparent(0.5)}; }`);\n    }\n    const link = theme.getColor(textLinkForeground);\n    if (link) {\n        collector.addRule(`.monaco-editor .monaco-hover a { color: ${link}; }`);\n    }\n    const linkHover = theme.getColor(textLinkActiveForeground);\n    if (linkHover) {\n        collector.addRule(`.monaco-editor .monaco-hover a:hover { color: ${linkHover}; }`);\n    }\n    const hoverForeground = theme.getColor(editorHoverForeground);\n    if (hoverForeground) {\n        collector.addRule(`.monaco-editor .monaco-hover { color: ${hoverForeground}; }`);\n    }\n    const actionsBackground = theme.getColor(editorHoverStatusBarBackground);\n    if (actionsBackground) {\n        collector.addRule(`.monaco-editor .monaco-hover .hover-row .actions { background-color: ${actionsBackground}; }`);\n    }\n    const codeBackground = theme.getColor(textCodeBlockBackground);\n    if (codeBackground) {\n        collector.addRule(`.monaco-editor .monaco-hover code { background-color: ${codeBackground}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class HoverRangeAnchor {\n    constructor(priority, range) {\n        this.priority = priority;\n        this.range = range;\n        this.type = 1 /* Range */;\n    }\n    equals(other) {\n        return (other.type === 1 /* Range */ && this.range.equalsRange(other.range));\n    }\n    canAdoptVisibleHover(lastAnchor, showAtPosition) {\n        return (lastAnchor.type === 1 /* Range */ && showAtPosition.lineNumber === this.range.startLineNumber);\n    }\n}\nexport class HoverForeignElementAnchor {\n    constructor(priority, owner, range) {\n        this.priority = priority;\n        this.owner = owner;\n        this.range = range;\n        this.type = 2 /* ForeignElement */;\n    }\n    equals(other) {\n        return (other.type === 2 /* ForeignElement */ && this.owner === other.owner);\n    }\n    canAdoptVisibleHover(lastAnchor, showAtPosition) {\n        return (lastAnchor.type === 2 /* ForeignElement */ && this.owner === lastAnchor.owner);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { asArray } from '../../../../base/common/arrays.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { isEmptyMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../markdownRenderer/browser/markdownRenderer.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { HoverProviderRegistry } from '../../../common/languages.js';\nimport { ILanguageService } from '../../../common/services/language.js';\nimport { getHover } from './getHover.js';\nimport * as nls from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nconst $ = dom.$;\nexport class MarkdownHover {\n    constructor(owner, range, contents, ordinal) {\n        this.owner = owner;\n        this.range = range;\n        this.contents = contents;\n        this.ordinal = ordinal;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nlet MarkdownHoverParticipant = class MarkdownHoverParticipant {\n    constructor(_editor, _languageService, _openerService, _configurationService) {\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this._configurationService = _configurationService;\n    }\n    createLoadingMessage(anchor) {\n        return new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(nls.localize('modesContentHover.loading', \"Loading...\"))], 2000);\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* Range */) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        const result = [];\n        let index = 1000;\n        const lineLength = model.getLineLength(lineNumber);\n        const languageId = model.getLanguageIdAtPosition(anchor.range.startLineNumber, anchor.range.startColumn);\n        const maxTokenizationLineLength = this._configurationService.getValue('editor.maxTokenizationLineLength', {\n            overrideIdentifier: languageId\n        });\n        if (typeof maxTokenizationLineLength === 'number' && lineLength >= maxTokenizationLineLength) {\n            result.push(new MarkdownHover(this, anchor.range, [{\n                    value: nls.localize('too many characters', \"Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.\")\n                }], index++));\n        }\n        for (const d of lineDecorations) {\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            const hoverMessage = d.options.hoverMessage;\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\n                continue;\n            }\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\n            result.push(new MarkdownHover(this, range, asArray(hoverMessage), index++));\n        }\n        return result;\n    }\n    computeAsync(anchor, lineDecorations, token) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* Range */) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const model = this._editor.getModel();\n        if (!HoverProviderRegistry.has(model)) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const position = new Position(anchor.range.startLineNumber, anchor.range.startColumn);\n        return getHover(model, position, token)\n            .filter(item => !isEmptyMarkdownString(item.hover.contents))\n            .map(item => {\n            const rng = item.hover.range ? Range.lift(item.hover.range) : anchor.range;\n            return new MarkdownHover(this, rng, item.hover.contents, item.ordinal);\n        });\n    }\n    renderHoverParts(context, hoverParts) {\n        return renderMarkdownHovers(context, hoverParts, this._editor, this._languageService, this._openerService);\n    }\n};\nMarkdownHoverParticipant = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService),\n    __param(3, IConfigurationService)\n], MarkdownHoverParticipant);\nexport { MarkdownHoverParticipant };\nexport function renderMarkdownHovers(context, hoverParts, editor, languageService, openerService) {\n    // Sort hover parts to keep them stable since they might come in async, out-of-order\n    hoverParts.sort((a, b) => a.ordinal - b.ordinal);\n    const disposables = new DisposableStore();\n    for (const hoverPart of hoverParts) {\n        for (const contents of hoverPart.contents) {\n            if (isEmptyMarkdownString(contents)) {\n                continue;\n            }\n            const markdownHoverElement = $('div.hover-row.markdown-hover');\n            const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n            const renderer = disposables.add(new MarkdownRenderer({ editor }, languageService, openerService));\n            disposables.add(renderer.onDidRenderAsync(() => {\n                hoverContentsElement.className = 'hover-contents code-hover-contents';\n                context.onContentsChanged();\n            }));\n            const renderedContents = disposables.add(renderer.render(contents));\n            hoverContentsElement.appendChild(renderedContents.element);\n            context.fragment.appendChild(markdownHoverElement);\n        }\n    }\n    return disposables;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Selection } from '../../../common/core/selection.js';\nexport class InPlaceReplaceCommand {\n    constructor(editRange, originalSelection, text) {\n        this._editRange = editRange;\n        this._originalSelection = originalSelection;\n        this._text = text;\n    }\n    getEditOperations(model, builder) {\n        builder.addTrackedEditOperation(this._editRange, this._text);\n    }\n    computeCursorState(model, helper) {\n        const inverseEditOperations = helper.getInverseEditOperations();\n        const srcRange = inverseEditOperations[0].range;\n        if (!this._originalSelection.isEmpty()) {\n            // Preserve selection and extends to typed text\n            return new Selection(srcRange.endLineNumber, srcRange.endColumn - this._text.length, srcRange.endLineNumber, srcRange.endColumn);\n        }\n        return new Selection(srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn), srcRange.endLineNumber, Math.min(this._originalSelection.positionColumn, srcRange.endColumn));\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { createCancelablePromise, timeout } from '../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { EditorState } from '../../editorState/browser/editorState.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { editorBracketMatchBorder } from '../../../common/core/editorColorRegistry.js';\nimport * as nls from '../../../../nls.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { InPlaceReplaceCommand } from './inPlaceReplaceCommand.js';\nlet InPlaceReplaceController = class InPlaceReplaceController {\n    constructor(editor, editorWorkerService) {\n        this.decorationIds = [];\n        this.editor = editor;\n        this.editorWorkerService = editorWorkerService;\n    }\n    static get(editor) {\n        return editor.getContribution(InPlaceReplaceController.ID);\n    }\n    dispose() {\n    }\n    run(source, up) {\n        // cancel any pending request\n        if (this.currentRequest) {\n            this.currentRequest.cancel();\n        }\n        const editorSelection = this.editor.getSelection();\n        const model = this.editor.getModel();\n        if (!model || !editorSelection) {\n            return undefined;\n        }\n        let selection = editorSelection;\n        if (selection.startLineNumber !== selection.endLineNumber) {\n            // Can't accept multiline selection\n            return undefined;\n        }\n        const state = new EditorState(this.editor, 1 /* Value */ | 4 /* Position */);\n        const modelURI = model.uri;\n        if (!this.editorWorkerService.canNavigateValueSet(modelURI)) {\n            return Promise.resolve(undefined);\n        }\n        this.currentRequest = createCancelablePromise(token => this.editorWorkerService.navigateValueSet(modelURI, selection, up));\n        return this.currentRequest.then(result => {\n            if (!result || !result.range || !result.value) {\n                // No proper result\n                return;\n            }\n            if (!state.validate(this.editor)) {\n                // state has changed\n                return;\n            }\n            // Selection\n            let editRange = Range.lift(result.range);\n            let highlightRange = result.range;\n            let diff = result.value.length - (selection.endColumn - selection.startColumn);\n            // highlight\n            highlightRange = {\n                startLineNumber: highlightRange.startLineNumber,\n                startColumn: highlightRange.startColumn,\n                endLineNumber: highlightRange.endLineNumber,\n                endColumn: highlightRange.startColumn + result.value.length\n            };\n            if (diff > 1) {\n                selection = new Selection(selection.startLineNumber, selection.startColumn, selection.endLineNumber, selection.endColumn + diff - 1);\n            }\n            // Insert new text\n            const command = new InPlaceReplaceCommand(editRange, selection, result.value);\n            this.editor.pushUndoStop();\n            this.editor.executeCommand(source, command);\n            this.editor.pushUndoStop();\n            // add decoration\n            this.decorationIds = this.editor.deltaDecorations(this.decorationIds, [{\n                    range: highlightRange,\n                    options: InPlaceReplaceController.DECORATION\n                }]);\n            // remove decoration after delay\n            if (this.decorationRemover) {\n                this.decorationRemover.cancel();\n            }\n            this.decorationRemover = timeout(350);\n            this.decorationRemover.then(() => this.decorationIds = this.editor.deltaDecorations(this.decorationIds, [])).catch(onUnexpectedError);\n        }).catch(onUnexpectedError);\n    }\n};\nInPlaceReplaceController.ID = 'editor.contrib.inPlaceReplaceController';\nInPlaceReplaceController.DECORATION = ModelDecorationOptions.register({\n    description: 'in-place-replace',\n    className: 'valueSetReplacement'\n});\nInPlaceReplaceController = __decorate([\n    __param(1, IEditorWorkerService)\n], InPlaceReplaceController);\nclass InPlaceReplaceUp extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inPlaceReplace.up',\n            label: nls.localize('InPlaceReplaceAction.previous.label', \"Replace with Previous Value\"),\n            alias: 'Replace with Previous Value',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 82 /* Comma */,\n                weight: 100 /* EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = InPlaceReplaceController.get(editor);\n        if (!controller) {\n            return Promise.resolve(undefined);\n        }\n        return controller.run(this.id, true);\n    }\n}\nclass InPlaceReplaceDown extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.inPlaceReplace.down',\n            label: nls.localize('InPlaceReplaceAction.next.label', \"Replace with Next Value\"),\n            alias: 'Replace with Next Value',\n            precondition: EditorContextKeys.writable,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 84 /* Period */,\n                weight: 100 /* EditorContrib */\n            }\n        });\n    }\n    run(accessor, editor) {\n        const controller = InPlaceReplaceController.get(editor);\n        if (!controller) {\n            return Promise.resolve(undefined);\n        }\n        return controller.run(this.id, false);\n    }\n}\nregisterEditorContribution(InPlaceReplaceController.ID, InPlaceReplaceController);\nregisterEditorAction(InPlaceReplaceUp);\nregisterEditorAction(InPlaceReplaceDown);\nregisterThemingParticipant((theme, collector) => {\n    const border = theme.getColor(editorBracketMatchBorder);\n    if (border) {\n        collector.addRule(`.monaco-editor.vs .valueSetReplacement { outline: solid 2px ${border}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport function getSpaceCnt(str, tabSize) {\n    let spacesCnt = 0;\n    for (let i = 0; i < str.length; i++) {\n        if (str.charAt(i) === '\\t') {\n            spacesCnt += tabSize;\n        }\n        else {\n            spacesCnt++;\n        }\n    }\n    return spacesCnt;\n}\nexport function generateIndent(spacesCnt, tabSize, insertSpaces) {\n    spacesCnt = spacesCnt < 0 ? 0 : spacesCnt;\n    let result = '';\n    if (!insertSpaces) {\n        let tabsCnt = Math.floor(spacesCnt / tabSize);\n        spacesCnt = spacesCnt % tabSize;\n        for (let i = 0; i < tabsCnt; i++) {\n            result += '\\t';\n        }\n    }\n    for (let i = 0; i < spacesCnt; i++) {\n        result += ' ';\n    }\n    return result;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ShiftCommand } from '../../../common/commands/shiftCommand.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { TextModel } from '../../../common/model/textModel.js';\nimport { ILanguageConfigurationService, LanguageConfigurationRegistry } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport * as indentUtils from './indentUtils.js';\nimport * as nls from '../../../../nls.js';\nimport { IQuickInputService } from '../../../../platform/quickinput/common/quickInput.js';\nexport function getReindentEditOperations(model, languageConfigurationService, startLineNumber, endLineNumber, inheritedIndent) {\n    if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n        // Model is empty\n        return [];\n    }\n    const indentationRules = languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).indentationRules;\n    if (!indentationRules) {\n        return [];\n    }\n    endLineNumber = Math.min(endLineNumber, model.getLineCount());\n    // Skip `unIndentedLinePattern` lines\n    while (startLineNumber <= endLineNumber) {\n        if (!indentationRules.unIndentedLinePattern) {\n            break;\n        }\n        let text = model.getLineContent(startLineNumber);\n        if (!indentationRules.unIndentedLinePattern.test(text)) {\n            break;\n        }\n        startLineNumber++;\n    }\n    if (startLineNumber > endLineNumber - 1) {\n        return [];\n    }\n    const { tabSize, indentSize, insertSpaces } = model.getOptions();\n    const shiftIndent = (indentation, count) => {\n        count = count || 1;\n        return ShiftCommand.shiftIndent(indentation, indentation.length + count, tabSize, indentSize, insertSpaces);\n    };\n    const unshiftIndent = (indentation, count) => {\n        count = count || 1;\n        return ShiftCommand.unshiftIndent(indentation, indentation.length + count, tabSize, indentSize, insertSpaces);\n    };\n    let indentEdits = [];\n    // indentation being passed to lines below\n    let globalIndent;\n    // Calculate indentation for the first line\n    // If there is no passed-in indentation, we use the indentation of the first line as base.\n    let currentLineText = model.getLineContent(startLineNumber);\n    let adjustedLineContent = currentLineText;\n    if (inheritedIndent !== undefined && inheritedIndent !== null) {\n        globalIndent = inheritedIndent;\n        let oldIndentation = strings.getLeadingWhitespace(currentLineText);\n        adjustedLineContent = globalIndent + currentLineText.substring(oldIndentation.length);\n        if (indentationRules.decreaseIndentPattern && indentationRules.decreaseIndentPattern.test(adjustedLineContent)) {\n            globalIndent = unshiftIndent(globalIndent);\n            adjustedLineContent = globalIndent + currentLineText.substring(oldIndentation.length);\n        }\n        if (currentLineText !== adjustedLineContent) {\n            indentEdits.push(EditOperation.replaceMove(new Selection(startLineNumber, 1, startLineNumber, oldIndentation.length + 1), TextModel.normalizeIndentation(globalIndent, indentSize, insertSpaces)));\n        }\n    }\n    else {\n        globalIndent = strings.getLeadingWhitespace(currentLineText);\n    }\n    // idealIndentForNextLine doesn't equal globalIndent when there is a line matching `indentNextLinePattern`.\n    let idealIndentForNextLine = globalIndent;\n    if (indentationRules.increaseIndentPattern && indentationRules.increaseIndentPattern.test(adjustedLineContent)) {\n        idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n        globalIndent = shiftIndent(globalIndent);\n    }\n    else if (indentationRules.indentNextLinePattern && indentationRules.indentNextLinePattern.test(adjustedLineContent)) {\n        idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n    }\n    startLineNumber++;\n    // Calculate indentation adjustment for all following lines\n    for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n        let text = model.getLineContent(lineNumber);\n        let oldIndentation = strings.getLeadingWhitespace(text);\n        let adjustedLineContent = idealIndentForNextLine + text.substring(oldIndentation.length);\n        if (indentationRules.decreaseIndentPattern && indentationRules.decreaseIndentPattern.test(adjustedLineContent)) {\n            idealIndentForNextLine = unshiftIndent(idealIndentForNextLine);\n            globalIndent = unshiftIndent(globalIndent);\n        }\n        if (oldIndentation !== idealIndentForNextLine) {\n            indentEdits.push(EditOperation.replaceMove(new Selection(lineNumber, 1, lineNumber, oldIndentation.length + 1), TextModel.normalizeIndentation(idealIndentForNextLine, indentSize, insertSpaces)));\n        }\n        // calculate idealIndentForNextLine\n        if (indentationRules.unIndentedLinePattern && indentationRules.unIndentedLinePattern.test(text)) {\n            // In reindent phase, if the line matches `unIndentedLinePattern` we inherit indentation from above lines\n            // but don't change globalIndent and idealIndentForNextLine.\n            continue;\n        }\n        else if (indentationRules.increaseIndentPattern && indentationRules.increaseIndentPattern.test(adjustedLineContent)) {\n            globalIndent = shiftIndent(globalIndent);\n            idealIndentForNextLine = globalIndent;\n        }\n        else if (indentationRules.indentNextLinePattern && indentationRules.indentNextLinePattern.test(adjustedLineContent)) {\n            idealIndentForNextLine = shiftIndent(idealIndentForNextLine);\n        }\n        else {\n            idealIndentForNextLine = globalIndent;\n        }\n    }\n    return indentEdits;\n}\nexport class IndentationToSpacesAction extends EditorAction {\n    constructor() {\n        super({\n            id: IndentationToSpacesAction.ID,\n            label: nls.localize('indentationToSpaces', \"Convert Indentation to Spaces\"),\n            alias: 'Convert Indentation to Spaces',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        let model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        let modelOpts = model.getOptions();\n        let selection = editor.getSelection();\n        if (!selection) {\n            return;\n        }\n        const command = new IndentationToSpacesCommand(selection, modelOpts.tabSize);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n        model.updateOptions({\n            insertSpaces: true\n        });\n    }\n}\nIndentationToSpacesAction.ID = 'editor.action.indentationToSpaces';\nexport class IndentationToTabsAction extends EditorAction {\n    constructor() {\n        super({\n            id: IndentationToTabsAction.ID,\n            label: nls.localize('indentationToTabs', \"Convert Indentation to Tabs\"),\n            alias: 'Convert Indentation to Tabs',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        let model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        let modelOpts = model.getOptions();\n        let selection = editor.getSelection();\n        if (!selection) {\n            return;\n        }\n        const command = new IndentationToTabsCommand(selection, modelOpts.tabSize);\n        editor.pushUndoStop();\n        editor.executeCommands(this.id, [command]);\n        editor.pushUndoStop();\n        model.updateOptions({\n            insertSpaces: false\n        });\n    }\n}\nIndentationToTabsAction.ID = 'editor.action.indentationToTabs';\nexport class ChangeIndentationSizeAction extends EditorAction {\n    constructor(insertSpaces, opts) {\n        super(opts);\n        this.insertSpaces = insertSpaces;\n    }\n    run(accessor, editor) {\n        const quickInputService = accessor.get(IQuickInputService);\n        const modelService = accessor.get(IModelService);\n        let model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const creationOpts = modelService.getCreationOptions(model.getLanguageId(), model.uri, model.isForSimpleWidget);\n        const picks = [1, 2, 3, 4, 5, 6, 7, 8].map(n => ({\n            id: n.toString(),\n            label: n.toString(),\n            // add description for tabSize value set in the configuration\n            description: n === creationOpts.tabSize ? nls.localize('configuredTabSize', \"Configured Tab Size\") : undefined\n        }));\n        // auto focus the tabSize set for the current editor\n        const autoFocusIndex = Math.min(model.getOptions().tabSize - 1, 7);\n        setTimeout(() => {\n            quickInputService.pick(picks, { placeHolder: nls.localize({ key: 'selectTabWidth', comment: ['Tab corresponds to the tab key'] }, \"Select Tab Size for Current File\"), activeItem: picks[autoFocusIndex] }).then(pick => {\n                if (pick) {\n                    if (model && !model.isDisposed()) {\n                        model.updateOptions({\n                            tabSize: parseInt(pick.label, 10),\n                            insertSpaces: this.insertSpaces\n                        });\n                    }\n                }\n            });\n        }, 50 /* quick input is sensitive to being opened so soon after another */);\n    }\n}\nexport class IndentUsingTabs extends ChangeIndentationSizeAction {\n    constructor() {\n        super(false, {\n            id: IndentUsingTabs.ID,\n            label: nls.localize('indentUsingTabs', \"Indent Using Tabs\"),\n            alias: 'Indent Using Tabs',\n            precondition: undefined\n        });\n    }\n}\nIndentUsingTabs.ID = 'editor.action.indentUsingTabs';\nexport class IndentUsingSpaces extends ChangeIndentationSizeAction {\n    constructor() {\n        super(true, {\n            id: IndentUsingSpaces.ID,\n            label: nls.localize('indentUsingSpaces', \"Indent Using Spaces\"),\n            alias: 'Indent Using Spaces',\n            precondition: undefined\n        });\n    }\n}\nIndentUsingSpaces.ID = 'editor.action.indentUsingSpaces';\nexport class DetectIndentation extends EditorAction {\n    constructor() {\n        super({\n            id: DetectIndentation.ID,\n            label: nls.localize('detectIndentation', \"Detect Indentation from Content\"),\n            alias: 'Detect Indentation from Content',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        const modelService = accessor.get(IModelService);\n        let model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const creationOpts = modelService.getCreationOptions(model.getLanguageId(), model.uri, model.isForSimpleWidget);\n        model.detectIndentation(creationOpts.insertSpaces, creationOpts.tabSize);\n    }\n}\nDetectIndentation.ID = 'editor.action.detectIndentation';\nexport class ReindentLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.reindentlines',\n            label: nls.localize('editor.reindentlines', \"Reindent Lines\"),\n            alias: 'Reindent Lines',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        let model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        let edits = getReindentEditOperations(model, languageConfigurationService, 1, model.getLineCount());\n        if (edits.length > 0) {\n            editor.pushUndoStop();\n            editor.executeEdits(this.id, edits);\n            editor.pushUndoStop();\n        }\n    }\n}\nexport class ReindentSelectedLinesAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.reindentselectedlines',\n            label: nls.localize('editor.reindentselectedlines', \"Reindent Selected Lines\"),\n            alias: 'Reindent Selected Lines',\n            precondition: EditorContextKeys.writable\n        });\n    }\n    run(accessor, editor) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        let model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        let selections = editor.getSelections();\n        if (selections === null) {\n            return;\n        }\n        let edits = [];\n        for (let selection of selections) {\n            let startLineNumber = selection.startLineNumber;\n            let endLineNumber = selection.endLineNumber;\n            if (startLineNumber !== endLineNumber && selection.endColumn === 1) {\n                endLineNumber--;\n            }\n            if (startLineNumber === 1) {\n                if (startLineNumber === endLineNumber) {\n                    continue;\n                }\n            }\n            else {\n                startLineNumber--;\n            }\n            let editOperations = getReindentEditOperations(model, languageConfigurationService, startLineNumber, endLineNumber);\n            edits.push(...editOperations);\n        }\n        if (edits.length > 0) {\n            editor.pushUndoStop();\n            editor.executeEdits(this.id, edits);\n            editor.pushUndoStop();\n        }\n    }\n}\nexport class AutoIndentOnPasteCommand {\n    constructor(edits, initialSelection) {\n        this._initialSelection = initialSelection;\n        this._edits = [];\n        this._selectionId = null;\n        for (let edit of edits) {\n            if (edit.range && typeof edit.text === 'string') {\n                this._edits.push(edit);\n            }\n        }\n    }\n    getEditOperations(model, builder) {\n        for (let edit of this._edits) {\n            builder.addEditOperation(Range.lift(edit.range), edit.text);\n        }\n        let selectionIsSet = false;\n        if (Array.isArray(this._edits) && this._edits.length === 1 && this._initialSelection.isEmpty()) {\n            if (this._edits[0].range.startColumn === this._initialSelection.endColumn &&\n                this._edits[0].range.startLineNumber === this._initialSelection.endLineNumber) {\n                selectionIsSet = true;\n                this._selectionId = builder.trackSelection(this._initialSelection, true);\n            }\n            else if (this._edits[0].range.endColumn === this._initialSelection.startColumn &&\n                this._edits[0].range.endLineNumber === this._initialSelection.startLineNumber) {\n                selectionIsSet = true;\n                this._selectionId = builder.trackSelection(this._initialSelection, false);\n            }\n        }\n        if (!selectionIsSet) {\n            this._selectionId = builder.trackSelection(this._initialSelection);\n        }\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this._selectionId);\n    }\n}\nexport class AutoIndentOnPaste {\n    constructor(editor) {\n        this.callOnDispose = new DisposableStore();\n        this.callOnModel = new DisposableStore();\n        this.editor = editor;\n        this.callOnDispose.add(editor.onDidChangeConfiguration(() => this.update()));\n        this.callOnDispose.add(editor.onDidChangeModel(() => this.update()));\n        this.callOnDispose.add(editor.onDidChangeModelLanguage(() => this.update()));\n    }\n    update() {\n        // clean up\n        this.callOnModel.clear();\n        // we are disabled\n        if (this.editor.getOption(9 /* autoIndent */) < 4 /* Full */ || this.editor.getOption(48 /* formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        this.callOnModel.add(this.editor.onDidPaste(({ range }) => {\n            this.trigger(range);\n        }));\n    }\n    trigger(range) {\n        let selections = this.editor.getSelections();\n        if (selections === null || selections.length > 1) {\n            return;\n        }\n        const model = this.editor.getModel();\n        if (!model) {\n            return;\n        }\n        if (!model.isCheapToTokenize(range.getStartPosition().lineNumber)) {\n            return;\n        }\n        const autoIndent = this.editor.getOption(9 /* autoIndent */);\n        const { tabSize, indentSize, insertSpaces } = model.getOptions();\n        let textEdits = [];\n        let indentConverter = {\n            shiftIndent: (indentation) => {\n                return ShiftCommand.shiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            },\n            unshiftIndent: (indentation) => {\n                return ShiftCommand.unshiftIndent(indentation, indentation.length + 1, tabSize, indentSize, insertSpaces);\n            }\n        };\n        let startLineNumber = range.startLineNumber;\n        while (startLineNumber <= range.endLineNumber) {\n            if (this.shouldIgnoreLine(model, startLineNumber)) {\n                startLineNumber++;\n                continue;\n            }\n            break;\n        }\n        if (startLineNumber > range.endLineNumber) {\n            return;\n        }\n        let firstLineText = model.getLineContent(startLineNumber);\n        if (!/\\S/.test(firstLineText.substring(0, range.startColumn - 1))) {\n            const indentOfFirstLine = LanguageConfigurationRegistry.getGoodIndentForLine(autoIndent, model, model.getLanguageId(), startLineNumber, indentConverter);\n            if (indentOfFirstLine !== null) {\n                let oldIndentation = strings.getLeadingWhitespace(firstLineText);\n                let newSpaceCnt = indentUtils.getSpaceCnt(indentOfFirstLine, tabSize);\n                let oldSpaceCnt = indentUtils.getSpaceCnt(oldIndentation, tabSize);\n                if (newSpaceCnt !== oldSpaceCnt) {\n                    let newIndent = indentUtils.generateIndent(newSpaceCnt, tabSize, insertSpaces);\n                    textEdits.push({\n                        range: new Range(startLineNumber, 1, startLineNumber, oldIndentation.length + 1),\n                        text: newIndent\n                    });\n                    firstLineText = newIndent + firstLineText.substr(oldIndentation.length);\n                }\n                else {\n                    let indentMetadata = LanguageConfigurationRegistry.getIndentMetadata(model, startLineNumber);\n                    if (indentMetadata === 0 || indentMetadata === 8 /* UNINDENT_MASK */) {\n                        // we paste content into a line where only contains whitespaces\n                        // after pasting, the indentation of the first line is already correct\n                        // the first line doesn't match any indentation rule\n                        // then no-op.\n                        return;\n                    }\n                }\n            }\n        }\n        const firstLineNumber = startLineNumber;\n        // ignore empty or ignored lines\n        while (startLineNumber < range.endLineNumber) {\n            if (!/\\S/.test(model.getLineContent(startLineNumber + 1))) {\n                startLineNumber++;\n                continue;\n            }\n            break;\n        }\n        if (startLineNumber !== range.endLineNumber) {\n            let virtualModel = {\n                getLineTokens: (lineNumber) => {\n                    return model.getLineTokens(lineNumber);\n                },\n                getLanguageId: () => {\n                    return model.getLanguageId();\n                },\n                getLanguageIdAtPosition: (lineNumber, column) => {\n                    return model.getLanguageIdAtPosition(lineNumber, column);\n                },\n                getLineContent: (lineNumber) => {\n                    if (lineNumber === firstLineNumber) {\n                        return firstLineText;\n                    }\n                    else {\n                        return model.getLineContent(lineNumber);\n                    }\n                }\n            };\n            let indentOfSecondLine = LanguageConfigurationRegistry.getGoodIndentForLine(autoIndent, virtualModel, model.getLanguageId(), startLineNumber + 1, indentConverter);\n            if (indentOfSecondLine !== null) {\n                let newSpaceCntOfSecondLine = indentUtils.getSpaceCnt(indentOfSecondLine, tabSize);\n                let oldSpaceCntOfSecondLine = indentUtils.getSpaceCnt(strings.getLeadingWhitespace(model.getLineContent(startLineNumber + 1)), tabSize);\n                if (newSpaceCntOfSecondLine !== oldSpaceCntOfSecondLine) {\n                    let spaceCntOffset = newSpaceCntOfSecondLine - oldSpaceCntOfSecondLine;\n                    for (let i = startLineNumber + 1; i <= range.endLineNumber; i++) {\n                        let lineContent = model.getLineContent(i);\n                        let originalIndent = strings.getLeadingWhitespace(lineContent);\n                        let originalSpacesCnt = indentUtils.getSpaceCnt(originalIndent, tabSize);\n                        let newSpacesCnt = originalSpacesCnt + spaceCntOffset;\n                        let newIndent = indentUtils.generateIndent(newSpacesCnt, tabSize, insertSpaces);\n                        if (newIndent !== originalIndent) {\n                            textEdits.push({\n                                range: new Range(i, 1, i, originalIndent.length + 1),\n                                text: newIndent\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        if (textEdits.length > 0) {\n            this.editor.pushUndoStop();\n            let cmd = new AutoIndentOnPasteCommand(textEdits, this.editor.getSelection());\n            this.editor.executeCommand('autoIndentOnPaste', cmd);\n            this.editor.pushUndoStop();\n        }\n    }\n    shouldIgnoreLine(model, lineNumber) {\n        model.forceTokenization(lineNumber);\n        let nonWhitespaceColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\n        if (nonWhitespaceColumn === 0) {\n            return true;\n        }\n        let tokens = model.getLineTokens(lineNumber);\n        if (tokens.getCount() > 0) {\n            let firstNonWhitespaceTokenIndex = tokens.findTokenIndexAtOffset(nonWhitespaceColumn);\n            if (firstNonWhitespaceTokenIndex >= 0 && tokens.getStandardTokenType(firstNonWhitespaceTokenIndex) === 1 /* Comment */) {\n                return true;\n            }\n        }\n        return false;\n    }\n    dispose() {\n        this.callOnDispose.dispose();\n        this.callOnModel.dispose();\n    }\n}\nAutoIndentOnPaste.ID = 'editor.contrib.autoIndentOnPaste';\nfunction getIndentationEditOperations(model, builder, tabSize, tabsToSpaces) {\n    if (model.getLineCount() === 1 && model.getLineMaxColumn(1) === 1) {\n        // Model is empty\n        return;\n    }\n    let spaces = '';\n    for (let i = 0; i < tabSize; i++) {\n        spaces += ' ';\n    }\n    let spacesRegExp = new RegExp(spaces, 'gi');\n    for (let lineNumber = 1, lineCount = model.getLineCount(); lineNumber <= lineCount; lineNumber++) {\n        let lastIndentationColumn = model.getLineFirstNonWhitespaceColumn(lineNumber);\n        if (lastIndentationColumn === 0) {\n            lastIndentationColumn = model.getLineMaxColumn(lineNumber);\n        }\n        if (lastIndentationColumn === 1) {\n            continue;\n        }\n        const originalIndentationRange = new Range(lineNumber, 1, lineNumber, lastIndentationColumn);\n        const originalIndentation = model.getValueInRange(originalIndentationRange);\n        const newIndentation = (tabsToSpaces\n            ? originalIndentation.replace(/\\t/ig, spaces)\n            : originalIndentation.replace(spacesRegExp, '\\t'));\n        builder.addEditOperation(originalIndentationRange, newIndentation);\n    }\n}\nexport class IndentationToSpacesCommand {\n    constructor(selection, tabSize) {\n        this.selection = selection;\n        this.tabSize = tabSize;\n        this.selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        this.selectionId = builder.trackSelection(this.selection);\n        getIndentationEditOperations(model, builder, this.tabSize, true);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n}\nexport class IndentationToTabsCommand {\n    constructor(selection, tabSize) {\n        this.selection = selection;\n        this.tabSize = tabSize;\n        this.selectionId = null;\n    }\n    getEditOperations(model, builder) {\n        this.selectionId = builder.trackSelection(this.selection);\n        getIndentationEditOperations(model, builder, this.tabSize, false);\n    }\n    computeCursorState(model, helper) {\n        return helper.getTrackedSelection(this.selectionId);\n    }\n}\nregisterEditorContribution(AutoIndentOnPaste.ID, AutoIndentOnPaste);\nregisterEditorAction(IndentationToSpacesAction);\nregisterEditorAction(IndentationToTabsAction);\nregisterEditorAction(IndentUsingTabs);\nregisterEditorAction(IndentUsingSpaces);\nregisterEditorAction(DetectIndentation);\nregisterEditorAction(ReindentLinesAction);\nregisterEditorAction(ReindentSelectedLinesAction);\n"],"names":["__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","ctxHasSymbols","RawContextKey","localize","ISymbolNavigationService","createDecorator","SymbolNavigationService","contextKeyService","_editorService","_notificationService","_keybindingService","this","_currentModel","undefined","_currentIdx","_ignoreEditorChange","_ctxHasSymbols","bindTo","_a","_b","reset","_currentState","dispose","_currentMessage","anchor","refModel","parent","references","indexOf","set","_showMessage","editorState","EditorState","listener","onDidChange","_","editor","getActiveCodeEditor","model","getModel","position","getPosition","seenUri","seenPosition","reference","isEqual","uri","Range","range","combinedDisposable","source","Promise","resolve","openCodeEditor","resource","options","selection","selectionRevealType","finally","kb","lookupKeybinding","message","getLabel","status","IContextKeyService","ICodeEditorService","INotificationService","IKeybindingService","registerSingleton","registerEditorCommand","id","precondition","kbOpts","weight","primary","accessor","get","revealNext","EditorCommand","KeybindingsRegistry","when","handler","editorService","_listener","Map","_disposables","DisposableStore","_onDidChange","Emitter","event","add","onCodeEditorRemove","_onDidRemoveEditor","onCodeEditorAdd","_onDidAddEditor","listCodeEditors","forEach","values","onDidChangeCursorPosition","fire","onDidChangeModelContent","delete","_c","_d","_e","_f","_g","_h","__awaiter","thisArg","_arguments","P","generator","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","MenuRegistry","MenuId","submenu","title","nls","group","order","_goToActionIds","Set","registerGoToAction","ctor","registerInstantiatedEditorAction","SymbolNavigationAnchor","thing","corePosition","SymbolNavigationAction","configuration","opts","arg","hasModel","notificationService","progressService","IEditorProgressService","symbolNavService","is","cts","EditorStateCancellationTokenSource","promise","raceCancellation","_getLocationModel","token","isCancellationRequested","alert","ariaMessage","referenceAt","altActionId","_getAlternativeCommand","has","altAction","getAction","referenceCount","muteMessage","info","getWordAtPosition","MessageController","showMessage","_getNoResultFoundMessage","run","_onResult","err","error","showWhile","gotoLocation","_getGoToPreference","EmbeddedCodeEditorWidget","openInPeek","_openInPeek","firstReference","peek","_openReference","openToSide","targetEditor","put","sideBySide","highlight","isLocationLink","targetSelectionRange","modelNow","ids","deltaDecorations","description","className","setTimeout","controller","ReferencesController","toggleWidget","getSelection","createCancelablePromise","EditorAction","DefinitionAction","ReferencesModel","getDefinitionsAtPosition","word","getOption","alternativeDefinitionCommand","multipleDefinitions","goToDefinitionKb","isWeb","isStandalone","GoToDefinitionAction","label","alias","ContextKeyExpr","EditorContextKeys","kbExpr","contextMenuOpts","CommandsRegistry","OpenDefinitionToSideAction","KeyChord","PeekDefinitionAction","PeekContext","linux","menuId","DeclarationAction","getDeclarationsAtPosition","alternativeDeclarationCommand","multipleDeclarations","GoToDeclarationAction","TypeDefinitionAction","getTypeDefinitionsAtPosition","alternativeTypeDefinitionCommand","multipleTypeDefinitions","GoToTypeDefinitionAction","ID","PeekTypeDefinitionAction","ImplementationAction","getImplementationsAtPosition","alternativeImplementationCommand","multipleImplementations","GoToImplementationAction","PeekImplementationAction","ReferencesAction","alternativeReferenceCommand","multipleReferences","getReferencesAtPosition","GenericGoToLocationAction","config","_references","_gotoMultipleBehaviour","_model","_position","_token","args","name","constraint","URI","Array","multiple","noResultsMessage","assertType","isArray","getFocusedCodeEditor","isCodeEditor","setPosition","revealPositionInCenterIfOutsideViewport","invokeWithinContext","command","Boolean","IInstantiationService","invokeFunction","bind","ICommandService","executeCommand","codeEditorService","control","lineNumber","column","item","comment","getLocationLinks","registry","provide","promises","ordered","map","provider","onUnexpectedExternalError","all","push","DefinitionProviderRegistry","provideDefinition","DeclarationProviderRegistry","provideDeclaration","ImplementationProviderRegistry","provideImplementation","TypeDefinitionProviderRegistry","provideTypeDefinition","compact","ReferenceProviderRegistry","provideReferences","includeDeclaration","resultWithoutDeclaration","_sortedAndDeduped","callback","rawLinks","modelLinks","ref","link","registerModelAndPositionCommand","CancellationToken","hasModifier","modifier","ClickLinkMouseEvent","hasTriggerModifier","triggerModifier","hasSideBySideModifier","triggerSideBySideModifier","isNoneOrSingleMouseDown","detail","ClickLinkKeyboardEvent","keyCodeIsTriggerKey","keyCode","triggerKey","keyCodeIsSideBySideKey","triggerSideBySideKey","ClickLinkOptions","other","createOptions","multiCursorModifier","platform","ClickLinkGesture","_onMouseMoveOrRelevantKeyDown","_register","onMouseMoveOrRelevantKeyDown","_onExecute","onExecute","_onCancel","onCancel","_editor","_opts","_lastMouseMoveEvent","_hasTriggerKeyOnMouseDown","_lineNumberOnMouseDown","onDidChangeConfiguration","hasChanged","newOpts","equals","onMouseMove","_onEditorMouseMove","onMouseDown","_onEditorMouseDown","onMouseUp","_onEditorMouseUp","onKeyDown","_onEditorKeyDown","onKeyUp","_onEditorKeyUp","onMouseDrag","_resetHandler","onDidChangeCursorSelection","_onDidChangeCursorSelection","onDidChangeModel","onDidScrollChange","scrollTopChanged","scrollLeftChanged","startColumn","endColumn","mouseEvent","currentLineNumber","Disposable","GotoDefinitionAtPositionEditorContribution","textModelResolverService","languageService","toUnhook","toUnhookForKeyboard","linkDecorations","currentWordAtPosition","previousPromise","linkGesture","keyboardEvent","startFindDefinitionFromMouse","withNullAsUndefined","isEnabled","gotoDefinition","removeLinkDecorations","onUnexpectedError","startFindDefinition","clear","withKey","type","state","cancel","findDefinition","results","validate","addDecoration","MarkdownString","appendText","createModelReference","object","textEditorModel","startLineNumber","getLineCount","wordRange","previewValue","getPreviewValue","originSelectionRange","languageId","guessLanguageIdByFilepathOrFirstLine","appendCodeblock","rangeToUse","getPreviewRangeBasedOnBrackets","endLineNumber","MAX_SOURCE_PREVIEW_LINES","getPreviewRangeBasedOnIndentation","stripIndentationFromPreviewRange","previewRange","minIndent","getLineFirstNonWhitespaceColumn","endIndent","Math","min","getValueInRange","replace","RegExp","trim","startIndent","maxLineNumber","brackets","ignoreFirstEmpty","currentBracket","bracketPairs","findNextBracket","Position","lastBracket","open","isOpen","pop","maxColumn","getLineMaxColumn","nextLineNumber","nextColumn","hoverMessage","newDecorations","inlineClassName","canPeek","isInPeekEditor","getContribution","ITextModelService","ILanguageService","registerEditorContribution","registerThemingParticipant","theme","collector","activeLinkForeground","getColor","editorActiveLinkForeground","addRule","DataSource","_resolverService","element","FileReferences","groups","val","children","Error","Delegate","FileReferencesRenderer","OneReferenceRenderer","StringRepresentationProvider","OneReference","parts","getPreview","preview","basename","IdentityProvider","FileReferencesTemplate","container","_uriLabel","themeService","document","createElement","classList","file","IconLabel","supportHighlights","badge","CountBadge","dom","append","$","attachBadgeStyler","appendChild","matches","dirname","setLabel","getBaseLabel","getUriLabel","relative","len","setCount","setTitleFormat","ILabelService","IThemeService","_instantiationService","templateId","createInstance","node","index","template","createMatches","filterData","templateData","OneReferenceTemplate","HighlightedLabel","score","FuzzyScore","toggle","AccessibilityProvider","DecorationsManager","_decorations","_decorationIgnoreSet","_callOnDispose","_callOnModelChange","_onModelChanged","removeDecorations","toString","_addDecorations","onDidChangeDecorations","_onDecorationChanged","newDecorationsActualIndex","oneReference","DecorationOptions","decorations","toRemove","decorationId","newRange","getDecorationRange","ignore","keys","ModelDecorationOptions","stickiness","LayoutData","ratio","heightInLines","raw","data","JSON","parse","ReferencesTree","WorkbenchAsyncDataTree","ReferenceWidget","_defaultTreeKeyboardSupport","layoutData","_textModelResolverService","_peekViewService","_undoRedoService","_languageService","_languageConfigurationService","showFrame","showArrow","isResizeable","isAccessible","supportOnTitleClick","_disposeOnNewModel","_onDidSelectReference","onDidSelectReference","_dim","Dimension","_applyTheme","getColorTheme","onDidColorThemeChange","addExclusiveWidget","create","setModel","_preview","_previewNotAvailableMessage","_tree","_previewModelReference","_splitView","borderColor","peekView","Color","style","arrowColor","frameColor","headerBackgroundColor","primaryHeadingColor","secondaryHeadingColor","where","revealRangeInCenterIfOutsideViewport","domFocus","focus","hasTextFocus","_getFocusedReference","kind","ctrlKey","metaKey","altKey","containerElement","setCssClass","_messageContainer","hide","SplitView","orientation","_previewContainer","scrollBeyondLastLine","scrollbar","verticalScrollbarSize","horizontal","useShadows","verticalHasArrows","horizontalHasArrows","alwaysConsumeMouseWheel","overviewRulerLanes","fixedOverflowWidgets","minimap","enabled","TextModel","PLAINTEXT_LANGUAGE_ID","_treeContainer","treeOptions","keyboardSupport","accessibilityProvider","keyboardNavigationLabelProvider","identityProvider","openOnSingleClick","selectionNavigation","overrideStyles","listBackground","addStandardDisposableListener","dispatchEvent","stopPropagation","addView","Event","minimumSize","maximumSize","Number","MAX_VALUE","layout","width","height","Sizing","onDidSashChange","getViewSize","onEvent","_revealReference","onDidOpen","editorOptions","pinned","_doLayoutBody","heightInPixel","widthInPixel","_viewZone","resizeView","setSelection","setFocus","newModel","_onNewModel","isEmpty","setTitle","innerText","show","_decorationsManager","onDidChangeReferenceRange","rerender","focusOnReferenceTree","setInput","getFocus","revealParent","_revealedReference","scheme","Schemas","basenameOrAuthority","getInput","reveal","expand","scrollType","sel","collapseToStart","revealRangeInCenter","IUndoRedoService","ILanguageConfigurationService","ctxReferenceSearchVisible","_storageService","_configurationService","_requestIdPool","_ignoreModelChangeEvent","_referenceSearchVisible","_widget","modelPromise","peekMode","widgetPosition","closeWidget","containsPosition","_peekMode","onDidChangeModelLanguage","storageKey","fromJSON","onDidClose","store","stringify","getValue","openReference","_gotoReference","requestId","setMetaTitle","pos","nearestReference","focusOnPreviewEditor","isPreviewEditorFocused","fwd","currentPosition","nextOrPreviousReference","editorFocus","previewEditorFocus","revealReference","focusEditor","openedEditor","clone","withController","fn","outerEditor","getOuterEditor","IStorageService","IConfigurationService","changeFocusBetweenPreviewAndReferences","secondary","goToNextOrPreviousReference","mac","WorkbenchListFocusContextKey","WorkbenchTreeElementCanCollapse","WorkbenchTreeElementCanExpand","IListService","lastFocusedList","isProviderFirst","_rangeCallback","defaultGenerator","_range","FilePreview","_modelReference","n","getWordUntilPosition","beforeRange","afterRange","before","inside","after","start","end","_previews","ResourceMap","child","fsPath","size","f","links","_onDidChangeReferenceRange","_links","_title","current","providersFirst","sort","_compareReferences","extUri","oneRef","idx","childCount","groupCount","nearest","prefixLen","strings","offsetDist","abs","a","b","HoverProviderResult","hover","ordinal","getHover","HoverProviderRegistry","provideHover","isValid","executeProvider","AsyncIterableObject","coalesce","hasRange","hasHtmlContent","contents","toPromise","getHoverPromise","ColorHover","owner","forceShowAtRange","ColorHoverParticipant","_themeService","lineDecorations","_computeAsync","colorDetector","ColorDetector","isColorDecorationId","colorData","getColorData","getStartPosition","_createColorHover","colorInfo","colorHover","editorModel","originalText","color","red","green","blue","alpha","rgba","RGBA","round","getColorPresentations","colorPresentations","ColorPickerModel","guessColorPresentation","context","hoverParts","disposables","widget","ColorPickerWidget","fragment","setColorPicker","updateEditorModel","textEdits","presentation","textEdit","trackedRange","_setTrackedRange","pushUndoStop","executeEdits","_getTrackedRange","identifier","text","forceMoveMarkers","setEndPosition","additionalTextEdits","updateColorPresentations","g","onColorFlushed","onDidChangeColor","__asyncValues","o","Symbol","asyncIterator","TypeError","m","call","__values","iterator","verb","v","settle","HoverResult","isComplete","hasLoadingMessage","HoverOperation","_computer","onResult","_firstWaitScheduler","RunOnceScheduler","_triggerAsyncComputation","_secondWaitScheduler","_triggerSyncComputation","_loadingMessageScheduler","_triggerLoadingMessage","_state","_asyncIterable","_asyncIterableDone","_result","delay","_hoverTime","_firstWaitTime","fireResult","_fireResult","_setState","schedule","_secondWaitTime","computeAsync","createCancelableAsyncIterable","e_1","return","computeSync","concat","slice","mode","_loadingMessageTime","MarkerHover","marker","markerCodeActionTrigger","filter","include","CodeActionKind","MarkerHoverParticipant","_markerDecorationsService","_openerService","recentMarkerCodeActionsInfo","getMarker","msg","renderMarkerHover","markerHoverForStatusbar","MarkerSeverity","severity","renderMarkerStatusbar","markerHover","hoverElement","markerElement","code","relatedInformation","applyFontInfo","messageElement","whiteSpace","sourceAndCodeElement","codeLink","setAttribute","addDisposableListener","allowCommands","preventDefault","detailsElement","opacity","paddingLeft","isNonEmptyArray","relatedInfoContainer","marginTop","cursor","fromUserGesture","catch","statusBar","addAction","commandId","NextMarkerAction","MarkerController","showAtMarker","quickfixPlaceholderElement","IMarkerData","hasCodeActions","textContent","updatePlaceholderDisposable","disposableTimeout","String","fromCharCode","codeActionsPromise","getCodeActions","toDisposable","actions","validActions","display","showing","QuickFixAction","QuickFixController","elementPosition","getDomNodePagePosition","showCodeActions","x","left","y","top","cancellationToken","Progress","IMarkerDecorationsService","IOpenerService","linkFg","textLinkForeground","activeLinkFg","textLinkActiveForeground","ContentHoverController","_participants","MarkdownHoverParticipant","InlineCompletionsHoverParticipant","UnicodeHighlighterHoverParticipant","InlayHintsHover","ContentHoverWidget","_decorationsChangerListener","EditorDecorationsChangerListener","ContentHoverComputer","_hoverOperation","_messages","_messagesAreComplete","_withResult","onDidChangeModelDecorations","_onModelDecorationsChanged","getDomNode","TokenizationRegistry","_renderMessages","colorPicker","anchorCandidates","participant","suggestHoverAnchor","HoverRangeAnchor","epsilon","typicalHalfwidthCharacterWidth","isAfterLines","horizontalDistanceToText","priority","_startShowingAt","canAdoptVisibleHover","filteredMessages","isValidForHoverAnchor","shouldFocus","createLoadingMessage","loadingMessage","_addLoadingMessage","messages","renderColumn","highlightRange","EditorHoverStatusBar","createDocumentFragment","onContentsChanged","renderHoverParts","hasContent","hasChildNodes","highlightDecorations","_DECORATION_OPTIONS","showAt","ContentHoverVisibleData","above","_onDidChangeModelDecorations","_isChangingDecorations","oldDecorations","showAtPosition","showAtRange","preferAbove","stoleFocus","_contextKeyService","allowEditorOverflow","_hoverVisibleKey","_hover","HoverWidget","_visibleData","onDidLayoutChange","_layout","_updateFont","_setVisibleData","addContentWidget","removeContentWidget","containerDomNode","getContextKeyValue","SuggestContext","preference","visibleData","max","getLayoutInfo","fontSize","lineHeight","contentsDomNode","maxHeight","maxWidth","prototype","getElementsByClassName","paddingBottom","layoutContentWidget","render","scrollDimensions","getScrollDimensions","scrollWidth","extraBottomPadding","horizontalScrollbarSize","_hasContent","actionsElement","actionOptions","keybinding","keybindingLabel","HoverAction","_anchor","_shouldFocus","_getLineDecorations","getLineDecorations","isWholeLine","showIfCollapsed","MarginHoverWidget","openerService","NullOpenerService","_renderDisposeables","_isVisible","_markdownRenderer","MarkdownRenderer","MarginHoverComputer","addOverlayWidget","removeOverlayWidget","markdownHoverElement","hoverContentsElement","renderedContents","_updateContents","_showAt","editorLayout","topForLineNumber","getTopForLineNumber","editorScrollTop","getScrollTop","clientHeight","glyphMarginLeft","glyphMarginWidth","_lineNumber","toHoverMessage","glyphMarginClassName","glyphMarginHoverMessage","isEmptyMarkdownString","asArray","ModesHoverController","_toUnhook","_isMouseDown","_hoverClicked","_contentWidget","_glyphWidget","_hookEvents","_didChangeConfigurationHandler","_unhookEvents","hideWidgetsEventHandler","_hideWidgets","hoverOpts","_isHoverEnabled","_isHoverSticky","sticky","_onKeyDown","onMouseLeave","_onEditorScrollChanged","browserEvent","view","isCollapsed","isColorPickerVisible","_getOrCreateContentWidget","maybeShowAt","startShowingAt","startShowingAtRange","ShowHoverAction","showContentHover","ShowDefinitionPreviewHoverAction","goto","startFindDefinitionFromCursor","registerEditorAction","editorHoverHighlightColor","editorHoverHighlight","hoverBackground","editorHoverBackground","hoverBorder","editorHoverBorder","transparent","linkHover","hoverForeground","editorHoverForeground","actionsBackground","editorHoverStatusBarBackground","codeBackground","textCodeBlockBackground","equalsRange","lastAnchor","HoverForeignElementAnchor","MarkdownHover","lineLength","getLineLength","getLanguageIdAtPosition","maxTokenizationLineLength","overrideIdentifier","rng","renderMarkdownHovers","hoverPart","renderer","onDidRenderAsync","InPlaceReplaceCommand","editRange","originalSelection","_editRange","_originalSelection","_text","builder","addTrackedEditOperation","helper","srcRange","getInverseEditOperations","Selection","positionColumn","InPlaceReplaceController","editorWorkerService","decorationIds","up","currentRequest","editorSelection","modelURI","canNavigateValueSet","navigateValueSet","diff","DECORATION","decorationRemover","timeout","IEditorWorkerService","InPlaceReplaceUp","InPlaceReplaceDown","border","editorBracketMatchBorder","getSpaceCnt","str","tabSize","spacesCnt","charAt","generateIndent","insertSpaces","tabsCnt","floor","getReindentEditOperations","languageConfigurationService","inheritedIndent","indentationRules","getLanguageConfiguration","getLanguageId","unIndentedLinePattern","getLineContent","test","globalIndent","getOptions","indentSize","shiftIndent","indentation","count","ShiftCommand","unshiftIndent","indentEdits","currentLineText","adjustedLineContent","oldIndentation","substring","decreaseIndentPattern","EditOperation","idealIndentForNextLine","increaseIndentPattern","indentNextLinePattern","IndentationToSpacesAction","modelOpts","IndentationToSpacesCommand","executeCommands","updateOptions","IndentationToTabsAction","IndentationToTabsCommand","ChangeIndentationSizeAction","quickInputService","IQuickInputService","modelService","IModelService","creationOpts","getCreationOptions","isForSimpleWidget","picks","autoFocusIndex","pick","placeHolder","activeItem","isDisposed","parseInt","IndentUsingTabs","IndentUsingSpaces","DetectIndentation","detectIndentation","ReindentLinesAction","edits","ReindentSelectedLinesAction","selections","getSelections","editOperations","AutoIndentOnPasteCommand","initialSelection","_initialSelection","_edits","_selectionId","edit","addEditOperation","selectionIsSet","trackSelection","getTrackedSelection","AutoIndentOnPaste","callOnDispose","callOnModel","update","onDidPaste","trigger","isCheapToTokenize","autoIndent","indentConverter","shouldIgnoreLine","firstLineText","indentOfFirstLine","LanguageConfigurationRegistry","newSpaceCnt","indentUtils","newIndent","substr","indentMetadata","firstLineNumber","virtualModel","getLineTokens","indentOfSecondLine","newSpaceCntOfSecondLine","oldSpaceCntOfSecondLine","spaceCntOffset","lineContent","originalIndent","newSpacesCnt","cmd","forceTokenization","nonWhitespaceColumn","tokens","getCount","firstNonWhitespaceTokenIndex","findTokenIndexAtOffset","getStandardTokenType","getIndentationEditOperations","tabsToSpaces","spaces","spacesRegExp","lineCount","lastIndentationColumn","originalIndentationRange","originalIndentation","newIndentation","selectionId"],"sourceRoot":""}