{"version":3,"file":"static/js/monaco-editor-vendor.b8ed73b1.54dc31d0.js","mappings":"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","sources":["../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/contentWidgets/contentWidgets.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/currentLineHighlight/currentLineHighlight.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/decorations/decorations.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/editorScrollbar/editorScrollbar.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/glyphMargin/glyphMargin.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/indentGuides/indentGuides.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/domReadingContext.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLines.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/linesDecorations/linesDecorations.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/marginDecorations/marginDecorations.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapCharSheet.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapCharRenderer.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapPreBaked.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapCharRendererFactory.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimap.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overlayWidgets/overlayWidgets.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overviewRuler/decorationsOverviewRuler.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overviewRuler/overviewRuler.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/rulers/rulers.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/scrollDecoration/scrollDecoration.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/selections/selections.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewCursors/viewCursor.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewCursors/viewCursors.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewZones/viewZones.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/blockDecorations/blockDecorations.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/whitespace/whitespace.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/view.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/view/domLineBreaksComputer.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/view/dynamicViewOverlay.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lineNumbers/lineNumbers.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/rangeUtil.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLine.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/viewParts/margin/margin.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\nexport class ViewContentWidgets extends ViewPart {\n    constructor(context, viewDomNode) {\n        super(context);\n        this._viewDomNode = viewDomNode;\n        this._widgets = {};\n        this.domNode = createFastDomNode(document.createElement('div'));\n        PartFingerprints.write(this.domNode, 1 /* PartFingerprint.ContentWidgets */);\n        this.domNode.setClassName('contentWidgets');\n        this.domNode.setPosition('absolute');\n        this.domNode.setTop(0);\n        this.overflowingContentWidgetsDomNode = createFastDomNode(document.createElement('div'));\n        PartFingerprints.write(this.overflowingContentWidgetsDomNode, 2 /* PartFingerprint.OverflowingContentWidgets */);\n        this.overflowingContentWidgetsDomNode.setClassName('overflowingContentWidgets');\n    }\n    dispose() {\n        super.dispose();\n        this._widgets = {};\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const keys = Object.keys(this._widgets);\n        for (const widgetId of keys) {\n            this._widgets[widgetId].onConfigurationChanged(e);\n        }\n        return true;\n    }\n    onDecorationsChanged(e) {\n        // true for inline decorations that can end up relayouting text\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLineMappingChanged(e) {\n        this._updateAnchorsViewPositions();\n        return true;\n    }\n    onLinesChanged(e) {\n        this._updateAnchorsViewPositions();\n        return true;\n    }\n    onLinesDeleted(e) {\n        this._updateAnchorsViewPositions();\n        return true;\n    }\n    onLinesInserted(e) {\n        this._updateAnchorsViewPositions();\n        return true;\n    }\n    onScrollChanged(e) {\n        return true;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // ---- end view event handlers\n    _updateAnchorsViewPositions() {\n        const keys = Object.keys(this._widgets);\n        for (const widgetId of keys) {\n            this._widgets[widgetId].updateAnchorViewPosition();\n        }\n    }\n    addWidget(_widget) {\n        const myWidget = new Widget(this._context, this._viewDomNode, _widget);\n        this._widgets[myWidget.id] = myWidget;\n        if (myWidget.allowEditorOverflow) {\n            this.overflowingContentWidgetsDomNode.appendChild(myWidget.domNode);\n        }\n        else {\n            this.domNode.appendChild(myWidget.domNode);\n        }\n        this.setShouldRender();\n    }\n    setWidgetPosition(widget, primaryAnchor, secondaryAnchor, preference, affinity) {\n        const myWidget = this._widgets[widget.getId()];\n        myWidget.setPosition(primaryAnchor, secondaryAnchor, preference, affinity);\n        this.setShouldRender();\n    }\n    removeWidget(widget) {\n        const widgetId = widget.getId();\n        if (this._widgets.hasOwnProperty(widgetId)) {\n            const myWidget = this._widgets[widgetId];\n            delete this._widgets[widgetId];\n            const domNode = myWidget.domNode.domNode;\n            domNode.parentNode.removeChild(domNode);\n            domNode.removeAttribute('monaco-visible-content-widget');\n            this.setShouldRender();\n        }\n    }\n    shouldSuppressMouseDownOnWidget(widgetId) {\n        if (this._widgets.hasOwnProperty(widgetId)) {\n            return this._widgets[widgetId].suppressMouseDown;\n        }\n        return false;\n    }\n    onBeforeRender(viewportData) {\n        const keys = Object.keys(this._widgets);\n        for (const widgetId of keys) {\n            this._widgets[widgetId].onBeforeRender(viewportData);\n        }\n    }\n    prepareRender(ctx) {\n        const keys = Object.keys(this._widgets);\n        for (const widgetId of keys) {\n            this._widgets[widgetId].prepareRender(ctx);\n        }\n    }\n    render(ctx) {\n        const keys = Object.keys(this._widgets);\n        for (const widgetId of keys) {\n            this._widgets[widgetId].render(ctx);\n        }\n    }\n}\nclass Widget {\n    constructor(context, viewDomNode, actual) {\n        this._primaryAnchor = new PositionPair(null, null);\n        this._secondaryAnchor = new PositionPair(null, null);\n        this._context = context;\n        this._viewDomNode = viewDomNode;\n        this._actual = actual;\n        this.domNode = createFastDomNode(this._actual.getDomNode());\n        this.id = this._actual.getId();\n        this.allowEditorOverflow = this._actual.allowEditorOverflow || false;\n        this.suppressMouseDown = this._actual.suppressMouseDown || false;\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._fixedOverflowWidgets = options.get(39 /* EditorOption.fixedOverflowWidgets */);\n        this._contentWidth = layoutInfo.contentWidth;\n        this._contentLeft = layoutInfo.contentLeft;\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._affinity = null;\n        this._preference = [];\n        this._cachedDomNodeOffsetWidth = -1;\n        this._cachedDomNodeOffsetHeight = -1;\n        this._maxWidth = this._getMaxWidth();\n        this._isVisible = false;\n        this._renderData = null;\n        this.domNode.setPosition((this._fixedOverflowWidgets && this.allowEditorOverflow) ? 'fixed' : 'absolute');\n        this.domNode.setDisplay('none');\n        this.domNode.setVisibility('hidden');\n        this.domNode.setAttribute('widgetId', this.id);\n        this.domNode.setMaxWidth(this._maxWidth);\n    }\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        if (e.hasChanged(138 /* EditorOption.layoutInfo */)) {\n            const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n            this._contentLeft = layoutInfo.contentLeft;\n            this._contentWidth = layoutInfo.contentWidth;\n            this._maxWidth = this._getMaxWidth();\n        }\n    }\n    updateAnchorViewPosition() {\n        this._setPosition(this._affinity, this._primaryAnchor.modelPosition, this._secondaryAnchor.modelPosition);\n    }\n    _setPosition(affinity, primaryAnchor, secondaryAnchor) {\n        this._affinity = affinity;\n        this._primaryAnchor = getValidPositionPair(primaryAnchor, this._context.viewModel, this._affinity);\n        this._secondaryAnchor = getValidPositionPair(secondaryAnchor, this._context.viewModel, this._affinity);\n        function getValidPositionPair(position, viewModel, affinity) {\n            if (!position) {\n                return new PositionPair(null, null);\n            }\n            // Do not trust that widgets give a valid position\n            const validModelPosition = viewModel.model.validatePosition(position);\n            if (viewModel.coordinatesConverter.modelPositionIsVisible(validModelPosition)) {\n                const viewPosition = viewModel.coordinatesConverter.convertModelPositionToViewPosition(validModelPosition, affinity !== null && affinity !== void 0 ? affinity : undefined);\n                return new PositionPair(position, viewPosition);\n            }\n            return new PositionPair(position, null);\n        }\n    }\n    _getMaxWidth() {\n        return (this.allowEditorOverflow\n            ? window.innerWidth || document.documentElement.offsetWidth || document.body.offsetWidth\n            : this._contentWidth);\n    }\n    setPosition(primaryAnchor, secondaryAnchor, preference, affinity) {\n        this._setPosition(affinity, primaryAnchor, secondaryAnchor);\n        this._preference = preference;\n        if (this._primaryAnchor.viewPosition && this._preference && this._preference.length > 0) {\n            // this content widget would like to be visible if possible\n            // we change it from `display:none` to `display:block` even if it\n            // might be outside the viewport such that we can measure its size\n            // in `prepareRender`\n            this.domNode.setDisplay('block');\n        }\n        else {\n            this.domNode.setDisplay('none');\n        }\n        this._cachedDomNodeOffsetWidth = -1;\n        this._cachedDomNodeOffsetHeight = -1;\n    }\n    _layoutBoxInViewport(anchor, width, height, ctx) {\n        // Our visible box is split horizontally by the current line => 2 boxes\n        // a) the box above the line\n        const aboveLineTop = anchor.top;\n        const heightAvailableAboveLine = aboveLineTop;\n        // b) the box under the line\n        const underLineTop = anchor.top + anchor.height;\n        const heightAvailableUnderLine = ctx.viewportHeight - underLineTop;\n        const aboveTop = aboveLineTop - height;\n        const fitsAbove = (heightAvailableAboveLine >= height);\n        const belowTop = underLineTop;\n        const fitsBelow = (heightAvailableUnderLine >= height);\n        // And its left\n        let left = anchor.left;\n        if (left + width > ctx.scrollLeft + ctx.viewportWidth) {\n            left = ctx.scrollLeft + ctx.viewportWidth - width;\n        }\n        if (left < ctx.scrollLeft) {\n            left = ctx.scrollLeft;\n        }\n        return { fitsAbove, aboveTop, fitsBelow, belowTop, left };\n    }\n    _layoutHorizontalSegmentInPage(windowSize, domNodePosition, left, width) {\n        // Leave some clearance to the left/right\n        const LEFT_PADDING = 15;\n        const RIGHT_PADDING = 15;\n        // Initially, the limits are defined as the dom node limits\n        const MIN_LIMIT = Math.max(LEFT_PADDING, domNodePosition.left - width);\n        const MAX_LIMIT = Math.min(domNodePosition.left + domNodePosition.width + width, windowSize.width - RIGHT_PADDING);\n        let absoluteLeft = domNodePosition.left + left - window.scrollX;\n        if (absoluteLeft + width > MAX_LIMIT) {\n            const delta = absoluteLeft - (MAX_LIMIT - width);\n            absoluteLeft -= delta;\n            left -= delta;\n        }\n        if (absoluteLeft < MIN_LIMIT) {\n            const delta = absoluteLeft - MIN_LIMIT;\n            absoluteLeft -= delta;\n            left -= delta;\n        }\n        return [left, absoluteLeft];\n    }\n    _layoutBoxInPage(anchor, width, height, ctx) {\n        const aboveTop = anchor.top - height;\n        const belowTop = anchor.top + anchor.height;\n        const domNodePosition = dom.getDomNodePagePosition(this._viewDomNode.domNode);\n        const absoluteAboveTop = domNodePosition.top + aboveTop - window.scrollY;\n        const absoluteBelowTop = domNodePosition.top + belowTop - window.scrollY;\n        const windowSize = dom.getClientArea(document.body);\n        const [left, absoluteAboveLeft] = this._layoutHorizontalSegmentInPage(windowSize, domNodePosition, anchor.left - ctx.scrollLeft + this._contentLeft, width);\n        // Leave some clearance to the top/bottom\n        const TOP_PADDING = 22;\n        const BOTTOM_PADDING = 22;\n        const fitsAbove = (absoluteAboveTop >= TOP_PADDING);\n        const fitsBelow = (absoluteBelowTop + height <= windowSize.height - BOTTOM_PADDING);\n        if (this._fixedOverflowWidgets) {\n            return {\n                fitsAbove,\n                aboveTop: Math.max(absoluteAboveTop, TOP_PADDING),\n                fitsBelow,\n                belowTop: absoluteBelowTop,\n                left: absoluteAboveLeft\n            };\n        }\n        return { fitsAbove, aboveTop, fitsBelow, belowTop, left };\n    }\n    _prepareRenderWidgetAtExactPositionOverflowing(topLeft) {\n        return new Coordinate(topLeft.top, topLeft.left + this._contentLeft);\n    }\n    /**\n     * Compute the coordinates above and below the primary and secondary anchors.\n     * The content widget *must* touch the primary anchor.\n     * The content widget should touch if possible the secondary anchor.\n     */\n    _getAnchorsCoordinates(ctx) {\n        var _a, _b;\n        const primary = getCoordinates(this._primaryAnchor.viewPosition, this._affinity, this._lineHeight);\n        const secondaryViewPosition = (((_a = this._secondaryAnchor.viewPosition) === null || _a === void 0 ? void 0 : _a.lineNumber) === ((_b = this._primaryAnchor.viewPosition) === null || _b === void 0 ? void 0 : _b.lineNumber) ? this._secondaryAnchor.viewPosition : null);\n        const secondary = getCoordinates(secondaryViewPosition, this._affinity, this._lineHeight);\n        return { primary, secondary };\n        function getCoordinates(position, affinity, lineHeight) {\n            if (!position) {\n                return null;\n            }\n            const horizontalPosition = ctx.visibleRangeForPosition(position);\n            if (!horizontalPosition) {\n                return null;\n            }\n            // Left-align widgets that should appear :before content\n            const left = (position.column === 1 && affinity === 3 /* PositionAffinity.LeftOfInjectedText */ ? 0 : horizontalPosition.left);\n            const top = ctx.getVerticalOffsetForLineNumber(position.lineNumber) - ctx.scrollTop;\n            return new AnchorCoordinate(top, left, lineHeight);\n        }\n    }\n    _reduceAnchorCoordinates(primary, secondary, width) {\n        if (!secondary) {\n            return primary;\n        }\n        const fontInfo = this._context.configuration.options.get(47 /* EditorOption.fontInfo */);\n        let left = secondary.left;\n        if (left < primary.left) {\n            left = Math.max(left, primary.left - width + fontInfo.typicalFullwidthCharacterWidth);\n        }\n        else {\n            left = Math.min(left, primary.left + width - fontInfo.typicalFullwidthCharacterWidth);\n        }\n        return new AnchorCoordinate(primary.top, left, primary.height);\n    }\n    _prepareRenderWidget(ctx) {\n        if (!this._preference || this._preference.length === 0) {\n            return null;\n        }\n        const { primary, secondary } = this._getAnchorsCoordinates(ctx);\n        if (!primary) {\n            return null;\n        }\n        if (this._cachedDomNodeOffsetWidth === -1 || this._cachedDomNodeOffsetHeight === -1) {\n            let preferredDimensions = null;\n            if (typeof this._actual.beforeRender === 'function') {\n                preferredDimensions = safeInvoke(this._actual.beforeRender, this._actual);\n            }\n            if (preferredDimensions) {\n                this._cachedDomNodeOffsetWidth = preferredDimensions.width;\n                this._cachedDomNodeOffsetHeight = preferredDimensions.height;\n            }\n            else {\n                const domNode = this.domNode.domNode;\n                const clientRect = domNode.getBoundingClientRect();\n                this._cachedDomNodeOffsetWidth = Math.round(clientRect.width);\n                this._cachedDomNodeOffsetHeight = Math.round(clientRect.height);\n            }\n        }\n        const anchor = this._reduceAnchorCoordinates(primary, secondary, this._cachedDomNodeOffsetWidth);\n        let placement;\n        if (this.allowEditorOverflow) {\n            placement = this._layoutBoxInPage(anchor, this._cachedDomNodeOffsetWidth, this._cachedDomNodeOffsetHeight, ctx);\n        }\n        else {\n            placement = this._layoutBoxInViewport(anchor, this._cachedDomNodeOffsetWidth, this._cachedDomNodeOffsetHeight, ctx);\n        }\n        // Do two passes, first for perfect fit, second picks first option\n        for (let pass = 1; pass <= 2; pass++) {\n            for (const pref of this._preference) {\n                // placement\n                if (pref === 1 /* ContentWidgetPositionPreference.ABOVE */) {\n                    if (!placement) {\n                        // Widget outside of viewport\n                        return null;\n                    }\n                    if (pass === 2 || placement.fitsAbove) {\n                        return { coordinate: new Coordinate(placement.aboveTop, placement.left), position: 1 /* ContentWidgetPositionPreference.ABOVE */ };\n                    }\n                }\n                else if (pref === 2 /* ContentWidgetPositionPreference.BELOW */) {\n                    if (!placement) {\n                        // Widget outside of viewport\n                        return null;\n                    }\n                    if (pass === 2 || placement.fitsBelow) {\n                        return { coordinate: new Coordinate(placement.belowTop, placement.left), position: 2 /* ContentWidgetPositionPreference.BELOW */ };\n                    }\n                }\n                else {\n                    if (this.allowEditorOverflow) {\n                        return { coordinate: this._prepareRenderWidgetAtExactPositionOverflowing(new Coordinate(anchor.top, anchor.left)), position: 0 /* ContentWidgetPositionPreference.EXACT */ };\n                    }\n                    else {\n                        return { coordinate: new Coordinate(anchor.top, anchor.left), position: 0 /* ContentWidgetPositionPreference.EXACT */ };\n                    }\n                }\n            }\n        }\n        return null;\n    }\n    /**\n     * On this first pass, we ensure that the content widget (if it is in the viewport) has the max width set correctly.\n     */\n    onBeforeRender(viewportData) {\n        if (!this._primaryAnchor.viewPosition || !this._preference) {\n            return;\n        }\n        if (this._primaryAnchor.viewPosition.lineNumber < viewportData.startLineNumber || this._primaryAnchor.viewPosition.lineNumber > viewportData.endLineNumber) {\n            // Outside of viewport\n            return;\n        }\n        this.domNode.setMaxWidth(this._maxWidth);\n    }\n    prepareRender(ctx) {\n        this._renderData = this._prepareRenderWidget(ctx);\n    }\n    render(ctx) {\n        if (!this._renderData) {\n            // This widget should be invisible\n            if (this._isVisible) {\n                this.domNode.removeAttribute('monaco-visible-content-widget');\n                this._isVisible = false;\n                this.domNode.setVisibility('hidden');\n            }\n            if (typeof this._actual.afterRender === 'function') {\n                safeInvoke(this._actual.afterRender, this._actual, null);\n            }\n            return;\n        }\n        // This widget should be visible\n        if (this.allowEditorOverflow) {\n            this.domNode.setTop(this._renderData.coordinate.top);\n            this.domNode.setLeft(this._renderData.coordinate.left);\n        }\n        else {\n            this.domNode.setTop(this._renderData.coordinate.top + ctx.scrollTop - ctx.bigNumbersDelta);\n            this.domNode.setLeft(this._renderData.coordinate.left);\n        }\n        if (!this._isVisible) {\n            this.domNode.setVisibility('inherit');\n            this.domNode.setAttribute('monaco-visible-content-widget', 'true');\n            this._isVisible = true;\n        }\n        if (typeof this._actual.afterRender === 'function') {\n            safeInvoke(this._actual.afterRender, this._actual, this._renderData.position);\n        }\n    }\n}\nclass PositionPair {\n    constructor(modelPosition, viewPosition) {\n        this.modelPosition = modelPosition;\n        this.viewPosition = viewPosition;\n    }\n}\nclass Coordinate {\n    constructor(top, left) {\n        this.top = top;\n        this.left = left;\n        this._coordinateBrand = undefined;\n    }\n}\nclass AnchorCoordinate {\n    constructor(top, left, height) {\n        this.top = top;\n        this.left = left;\n        this.height = height;\n        this._anchorCoordinateBrand = undefined;\n    }\n}\nfunction safeInvoke(fn, thisArg, ...args) {\n    try {\n        return fn.call(thisArg, ...args);\n    }\n    catch (_a) {\n        // ignore\n        return null;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './currentLineHighlight.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport { editorLineHighlight, editorLineHighlightBorder } from '../../../common/core/editorColorRegistry.js';\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nexport class AbstractLineHighlightOverlay extends DynamicViewOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._renderLineHighlight = options.get(90 /* EditorOption.renderLineHighlight */);\n        this._renderLineHighlightOnlyWhenFocus = options.get(91 /* EditorOption.renderLineHighlightOnlyWhenFocus */);\n        this._contentLeft = layoutInfo.contentLeft;\n        this._contentWidth = layoutInfo.contentWidth;\n        this._selectionIsEmpty = true;\n        this._focused = false;\n        this._cursorLineNumbers = [1];\n        this._selections = [new Selection(1, 1, 1, 1)];\n        this._renderData = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        super.dispose();\n    }\n    _readFromSelections() {\n        let hasChanged = false;\n        const cursorsLineNumbers = this._selections.map(s => s.positionLineNumber);\n        cursorsLineNumbers.sort((a, b) => a - b);\n        if (!arrays.equals(this._cursorLineNumbers, cursorsLineNumbers)) {\n            this._cursorLineNumbers = cursorsLineNumbers;\n            hasChanged = true;\n        }\n        const selectionIsEmpty = this._selections.every(s => s.isEmpty());\n        if (this._selectionIsEmpty !== selectionIsEmpty) {\n            this._selectionIsEmpty = selectionIsEmpty;\n            hasChanged = true;\n        }\n        return hasChanged;\n    }\n    // --- begin event handlers\n    onThemeChanged(e) {\n        return this._readFromSelections();\n    }\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._renderLineHighlight = options.get(90 /* EditorOption.renderLineHighlight */);\n        this._renderLineHighlightOnlyWhenFocus = options.get(91 /* EditorOption.renderLineHighlightOnlyWhenFocus */);\n        this._contentLeft = layoutInfo.contentLeft;\n        this._contentWidth = layoutInfo.contentWidth;\n        return true;\n    }\n    onCursorStateChanged(e) {\n        this._selections = e.selections;\n        return this._readFromSelections();\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollWidthChanged || e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    onFocusChanged(e) {\n        if (!this._renderLineHighlightOnlyWhenFocus) {\n            return false;\n        }\n        this._focused = e.isFocused;\n        return true;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        if (!this._shouldRenderThis()) {\n            this._renderData = null;\n            return;\n        }\n        const renderedLine = this._renderOne(ctx);\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const len = this._cursorLineNumbers.length;\n        let index = 0;\n        const renderData = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            while (index < len && this._cursorLineNumbers[index] < lineNumber) {\n                index++;\n            }\n            if (index < len && this._cursorLineNumbers[index] === lineNumber) {\n                renderData[lineIndex] = renderedLine;\n            }\n            else {\n                renderData[lineIndex] = '';\n            }\n        }\n        this._renderData = renderData;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderData) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex >= this._renderData.length) {\n            return '';\n        }\n        return this._renderData[lineIndex];\n    }\n    _shouldRenderInMargin() {\n        return ((this._renderLineHighlight === 'gutter' || this._renderLineHighlight === 'all')\n            && (!this._renderLineHighlightOnlyWhenFocus || this._focused));\n    }\n    _shouldRenderInContent() {\n        return ((this._renderLineHighlight === 'line' || this._renderLineHighlight === 'all')\n            && this._selectionIsEmpty\n            && (!this._renderLineHighlightOnlyWhenFocus || this._focused));\n    }\n}\nexport class CurrentLineHighlightOverlay extends AbstractLineHighlightOverlay {\n    _renderOne(ctx) {\n        const className = 'current-line' + (this._shouldRenderOther() ? ' current-line-both' : '');\n        return `<div class=\"${className}\" style=\"width:${Math.max(ctx.scrollWidth, this._contentWidth)}px; height:${this._lineHeight}px;\"></div>`;\n    }\n    _shouldRenderThis() {\n        return this._shouldRenderInContent();\n    }\n    _shouldRenderOther() {\n        return this._shouldRenderInMargin();\n    }\n}\nexport class CurrentLineMarginHighlightOverlay extends AbstractLineHighlightOverlay {\n    _renderOne(ctx) {\n        const className = 'current-line' + (this._shouldRenderInMargin() ? ' current-line-margin' : '') + (this._shouldRenderOther() ? ' current-line-margin-both' : '');\n        return `<div class=\"${className}\" style=\"width:${this._contentLeft}px; height:${this._lineHeight}px;\"></div>`;\n    }\n    _shouldRenderThis() {\n        return true;\n    }\n    _shouldRenderOther() {\n        return this._shouldRenderInContent();\n    }\n}\nregisterThemingParticipant((theme, collector) => {\n    const lineHighlight = theme.getColor(editorLineHighlight);\n    if (lineHighlight) {\n        collector.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${lineHighlight}; }`);\n        collector.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${lineHighlight}; border: none; }`);\n    }\n    if (!lineHighlight || lineHighlight.isTransparent() || theme.defines(editorLineHighlightBorder)) {\n        const lineHighlightBorder = theme.getColor(editorLineHighlightBorder);\n        if (lineHighlightBorder) {\n            collector.addRule(`.monaco-editor .view-overlays .current-line { border: 2px solid ${lineHighlightBorder}; }`);\n            collector.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid ${lineHighlightBorder}; }`);\n            if (isHighContrast(theme.type)) {\n                collector.addRule(`.monaco-editor .view-overlays .current-line { border-width: 1px; }`);\n                collector.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }`);\n            }\n        }\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './decorations.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport { Range } from '../../../common/core/range.js';\nimport { HorizontalRange } from '../../view/renderingContext.js';\nexport class DecorationsOverlay extends DynamicViewOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        const options = this._context.configuration.options;\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = options.get(47 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = options.get(47 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n        return true;\n    }\n    onDecorationsChanged(e) {\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged || e.scrollWidthChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        const _decorations = ctx.getDecorationsInViewport();\n        // Keep only decorations with `className`\n        let decorations = [];\n        let decorationsLen = 0;\n        for (let i = 0, len = _decorations.length; i < len; i++) {\n            const d = _decorations[i];\n            if (d.options.className) {\n                decorations[decorationsLen++] = d;\n            }\n        }\n        // Sort decorations for consistent render output\n        decorations = decorations.sort((a, b) => {\n            if (a.options.zIndex < b.options.zIndex) {\n                return -1;\n            }\n            if (a.options.zIndex > b.options.zIndex) {\n                return 1;\n            }\n            const aClassName = a.options.className;\n            const bClassName = b.options.className;\n            if (aClassName < bClassName) {\n                return -1;\n            }\n            if (aClassName > bClassName) {\n                return 1;\n            }\n            return Range.compareRangesUsingStarts(a.range, b.range);\n        });\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            output[lineIndex] = '';\n        }\n        // Render first whole line decorations and then regular decorations\n        this._renderWholeLineDecorations(ctx, decorations, output);\n        this._renderNormalDecorations(ctx, decorations, output);\n        this._renderResult = output;\n    }\n    _renderWholeLineDecorations(ctx, decorations, output) {\n        const lineHeight = String(this._lineHeight);\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        for (let i = 0, lenI = decorations.length; i < lenI; i++) {\n            const d = decorations[i];\n            if (!d.options.isWholeLine) {\n                continue;\n            }\n            const decorationOutput = ('<div class=\"cdr '\n                + d.options.className\n                + '\" style=\"left:0;width:100%;height:'\n                + lineHeight\n                + 'px;\"></div>');\n            const startLineNumber = Math.max(d.range.startLineNumber, visibleStartLineNumber);\n            const endLineNumber = Math.min(d.range.endLineNumber, visibleEndLineNumber);\n            for (let j = startLineNumber; j <= endLineNumber; j++) {\n                const lineIndex = j - visibleStartLineNumber;\n                output[lineIndex] += decorationOutput;\n            }\n        }\n    }\n    _renderNormalDecorations(ctx, decorations, output) {\n        const lineHeight = String(this._lineHeight);\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        let prevClassName = null;\n        let prevShowIfCollapsed = false;\n        let prevRange = null;\n        for (let i = 0, lenI = decorations.length; i < lenI; i++) {\n            const d = decorations[i];\n            if (d.options.isWholeLine) {\n                continue;\n            }\n            const className = d.options.className;\n            const showIfCollapsed = Boolean(d.options.showIfCollapsed);\n            let range = d.range;\n            if (showIfCollapsed && range.endColumn === 1 && range.endLineNumber !== range.startLineNumber) {\n                range = new Range(range.startLineNumber, range.startColumn, range.endLineNumber - 1, this._context.viewModel.getLineMaxColumn(range.endLineNumber - 1));\n            }\n            if (prevClassName === className && prevShowIfCollapsed === showIfCollapsed && Range.areIntersectingOrTouching(prevRange, range)) {\n                // merge into previous decoration\n                prevRange = Range.plusRange(prevRange, range);\n                continue;\n            }\n            // flush previous decoration\n            if (prevClassName !== null) {\n                this._renderNormalDecoration(ctx, prevRange, prevClassName, prevShowIfCollapsed, lineHeight, visibleStartLineNumber, output);\n            }\n            prevClassName = className;\n            prevShowIfCollapsed = showIfCollapsed;\n            prevRange = range;\n        }\n        if (prevClassName !== null) {\n            this._renderNormalDecoration(ctx, prevRange, prevClassName, prevShowIfCollapsed, lineHeight, visibleStartLineNumber, output);\n        }\n    }\n    _renderNormalDecoration(ctx, range, className, showIfCollapsed, lineHeight, visibleStartLineNumber, output) {\n        const linesVisibleRanges = ctx.linesVisibleRangesForRange(range, /*TODO@Alex*/ className === 'findMatch');\n        if (!linesVisibleRanges) {\n            return;\n        }\n        for (let j = 0, lenJ = linesVisibleRanges.length; j < lenJ; j++) {\n            const lineVisibleRanges = linesVisibleRanges[j];\n            if (lineVisibleRanges.outsideRenderedLine) {\n                continue;\n            }\n            const lineIndex = lineVisibleRanges.lineNumber - visibleStartLineNumber;\n            if (showIfCollapsed && lineVisibleRanges.ranges.length === 1) {\n                const singleVisibleRange = lineVisibleRanges.ranges[0];\n                if (singleVisibleRange.width < this._typicalHalfwidthCharacterWidth) {\n                    // collapsed/very small range case => make the decoration visible by expanding its width\n                    // expand its size on both sides (both to the left and to the right, keeping it centered)\n                    const center = Math.round(singleVisibleRange.left + singleVisibleRange.width / 2);\n                    const left = Math.max(0, Math.round(center - this._typicalHalfwidthCharacterWidth / 2));\n                    lineVisibleRanges.ranges[0] = new HorizontalRange(left, this._typicalHalfwidthCharacterWidth);\n                }\n            }\n            for (let k = 0, lenK = lineVisibleRanges.ranges.length; k < lenK; k++) {\n                const visibleRange = lineVisibleRanges.ranges[k];\n                const decorationOutput = ('<div class=\"cdr '\n                    + className\n                    + '\" style=\"left:'\n                    + String(visibleRange.left)\n                    + 'px;width:'\n                    + String(visibleRange.width)\n                    + 'px;height:'\n                    + lineHeight\n                    + 'px;\"></div>');\n                output[lineIndex] += decorationOutput;\n            }\n        }\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\n            return '';\n        }\n        return this._renderResult[lineIndex];\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { SmoothScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\nimport { getThemeTypeSelector } from '../../../../platform/theme/common/themeService.js';\nexport class EditorScrollbar extends ViewPart {\n    constructor(context, linesContent, viewDomNode, overflowGuardDomNode) {\n        super(context);\n        const options = this._context.configuration.options;\n        const scrollbar = options.get(97 /* EditorOption.scrollbar */);\n        const mouseWheelScrollSensitivity = options.get(71 /* EditorOption.mouseWheelScrollSensitivity */);\n        const fastScrollSensitivity = options.get(37 /* EditorOption.fastScrollSensitivity */);\n        const scrollPredominantAxis = options.get(100 /* EditorOption.scrollPredominantAxis */);\n        const scrollbarOptions = {\n            listenOnDomNode: viewDomNode.domNode,\n            className: 'editor-scrollable' + ' ' + getThemeTypeSelector(context.theme.type),\n            useShadows: false,\n            lazyRender: true,\n            vertical: scrollbar.vertical,\n            horizontal: scrollbar.horizontal,\n            verticalHasArrows: scrollbar.verticalHasArrows,\n            horizontalHasArrows: scrollbar.horizontalHasArrows,\n            verticalScrollbarSize: scrollbar.verticalScrollbarSize,\n            verticalSliderSize: scrollbar.verticalSliderSize,\n            horizontalScrollbarSize: scrollbar.horizontalScrollbarSize,\n            horizontalSliderSize: scrollbar.horizontalSliderSize,\n            handleMouseWheel: scrollbar.handleMouseWheel,\n            alwaysConsumeMouseWheel: scrollbar.alwaysConsumeMouseWheel,\n            arrowSize: scrollbar.arrowSize,\n            mouseWheelScrollSensitivity: mouseWheelScrollSensitivity,\n            fastScrollSensitivity: fastScrollSensitivity,\n            scrollPredominantAxis: scrollPredominantAxis,\n            scrollByPage: scrollbar.scrollByPage,\n        };\n        this.scrollbar = this._register(new SmoothScrollableElement(linesContent.domNode, scrollbarOptions, this._context.viewLayout.getScrollable()));\n        PartFingerprints.write(this.scrollbar.getDomNode(), 5 /* PartFingerprint.ScrollableElement */);\n        this.scrollbarDomNode = createFastDomNode(this.scrollbar.getDomNode());\n        this.scrollbarDomNode.setPosition('absolute');\n        this._setLayout();\n        // When having a zone widget that calls .focus() on one of its dom elements,\n        // the browser will try desperately to reveal that dom node, unexpectedly\n        // changing the .scrollTop of this.linesContent\n        const onBrowserDesperateReveal = (domNode, lookAtScrollTop, lookAtScrollLeft) => {\n            const newScrollPosition = {};\n            if (lookAtScrollTop) {\n                const deltaTop = domNode.scrollTop;\n                if (deltaTop) {\n                    newScrollPosition.scrollTop = this._context.viewLayout.getCurrentScrollTop() + deltaTop;\n                    domNode.scrollTop = 0;\n                }\n            }\n            if (lookAtScrollLeft) {\n                const deltaLeft = domNode.scrollLeft;\n                if (deltaLeft) {\n                    newScrollPosition.scrollLeft = this._context.viewLayout.getCurrentScrollLeft() + deltaLeft;\n                    domNode.scrollLeft = 0;\n                }\n            }\n            this._context.viewModel.viewLayout.setScrollPosition(newScrollPosition, 1 /* ScrollType.Immediate */);\n        };\n        // I've seen this happen both on the view dom node & on the lines content dom node.\n        this._register(dom.addDisposableListener(viewDomNode.domNode, 'scroll', (e) => onBrowserDesperateReveal(viewDomNode.domNode, true, true)));\n        this._register(dom.addDisposableListener(linesContent.domNode, 'scroll', (e) => onBrowserDesperateReveal(linesContent.domNode, true, false)));\n        this._register(dom.addDisposableListener(overflowGuardDomNode.domNode, 'scroll', (e) => onBrowserDesperateReveal(overflowGuardDomNode.domNode, true, false)));\n        this._register(dom.addDisposableListener(this.scrollbarDomNode.domNode, 'scroll', (e) => onBrowserDesperateReveal(this.scrollbarDomNode.domNode, true, false)));\n    }\n    dispose() {\n        super.dispose();\n    }\n    _setLayout() {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this.scrollbarDomNode.setLeft(layoutInfo.contentLeft);\n        const minimap = options.get(69 /* EditorOption.minimap */);\n        const side = minimap.side;\n        if (side === 'right') {\n            this.scrollbarDomNode.setWidth(layoutInfo.contentWidth + layoutInfo.minimap.minimapWidth);\n        }\n        else {\n            this.scrollbarDomNode.setWidth(layoutInfo.contentWidth);\n        }\n        this.scrollbarDomNode.setHeight(layoutInfo.height);\n    }\n    getOverviewRulerLayoutInfo() {\n        return this.scrollbar.getOverviewRulerLayoutInfo();\n    }\n    getDomNode() {\n        return this.scrollbarDomNode;\n    }\n    delegateVerticalScrollbarPointerDown(browserEvent) {\n        this.scrollbar.delegateVerticalScrollbarPointerDown(browserEvent);\n    }\n    delegateScrollFromMouseWheelEvent(browserEvent) {\n        this.scrollbar.delegateScrollFromMouseWheelEvent(browserEvent);\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        if (e.hasChanged(97 /* EditorOption.scrollbar */)\n            || e.hasChanged(71 /* EditorOption.mouseWheelScrollSensitivity */)\n            || e.hasChanged(37 /* EditorOption.fastScrollSensitivity */)) {\n            const options = this._context.configuration.options;\n            const scrollbar = options.get(97 /* EditorOption.scrollbar */);\n            const mouseWheelScrollSensitivity = options.get(71 /* EditorOption.mouseWheelScrollSensitivity */);\n            const fastScrollSensitivity = options.get(37 /* EditorOption.fastScrollSensitivity */);\n            const scrollPredominantAxis = options.get(100 /* EditorOption.scrollPredominantAxis */);\n            const newOpts = {\n                vertical: scrollbar.vertical,\n                horizontal: scrollbar.horizontal,\n                verticalScrollbarSize: scrollbar.verticalScrollbarSize,\n                horizontalScrollbarSize: scrollbar.horizontalScrollbarSize,\n                scrollByPage: scrollbar.scrollByPage,\n                handleMouseWheel: scrollbar.handleMouseWheel,\n                mouseWheelScrollSensitivity: mouseWheelScrollSensitivity,\n                fastScrollSensitivity: fastScrollSensitivity,\n                scrollPredominantAxis: scrollPredominantAxis\n            };\n            this.scrollbar.updateOptions(newOpts);\n        }\n        if (e.hasChanged(138 /* EditorOption.layoutInfo */)) {\n            this._setLayout();\n        }\n        return true;\n    }\n    onScrollChanged(e) {\n        return true;\n    }\n    onThemeChanged(e) {\n        this.scrollbar.updateClassName('editor-scrollable' + ' ' + getThemeTypeSelector(this._context.theme.type));\n        return true;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        // Nothing to do\n    }\n    render(ctx) {\n        this.scrollbar.renderNow();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './glyphMargin.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nexport class DecorationToRender {\n    constructor(startLineNumber, endLineNumber, className) {\n        this._decorationToRenderBrand = undefined;\n        this.startLineNumber = +startLineNumber;\n        this.endLineNumber = +endLineNumber;\n        this.className = String(className);\n    }\n}\nexport class DedupOverlay extends DynamicViewOverlay {\n    _render(visibleStartLineNumber, visibleEndLineNumber, decorations) {\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            output[lineIndex] = [];\n        }\n        if (decorations.length === 0) {\n            return output;\n        }\n        decorations.sort((a, b) => {\n            if (a.className === b.className) {\n                if (a.startLineNumber === b.startLineNumber) {\n                    return a.endLineNumber - b.endLineNumber;\n                }\n                return a.startLineNumber - b.startLineNumber;\n            }\n            return (a.className < b.className ? -1 : 1);\n        });\n        let prevClassName = null;\n        let prevEndLineIndex = 0;\n        for (let i = 0, len = decorations.length; i < len; i++) {\n            const d = decorations[i];\n            const className = d.className;\n            let startLineIndex = Math.max(d.startLineNumber, visibleStartLineNumber) - visibleStartLineNumber;\n            const endLineIndex = Math.min(d.endLineNumber, visibleEndLineNumber) - visibleStartLineNumber;\n            if (prevClassName === className) {\n                startLineIndex = Math.max(prevEndLineIndex + 1, startLineIndex);\n                prevEndLineIndex = Math.max(prevEndLineIndex, endLineIndex);\n            }\n            else {\n                prevClassName = className;\n                prevEndLineIndex = endLineIndex;\n            }\n            for (let i = startLineIndex; i <= prevEndLineIndex; i++) {\n                output[i].push(prevClassName);\n            }\n        }\n        return output;\n    }\n}\nexport class GlyphMarginOverlay extends DedupOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._glyphMargin = options.get(54 /* EditorOption.glyphMargin */);\n        this._glyphMarginLeft = layoutInfo.glyphMarginLeft;\n        this._glyphMarginWidth = layoutInfo.glyphMarginWidth;\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._glyphMargin = options.get(54 /* EditorOption.glyphMargin */);\n        this._glyphMarginLeft = layoutInfo.glyphMarginLeft;\n        this._glyphMarginWidth = layoutInfo.glyphMarginWidth;\n        return true;\n    }\n    onDecorationsChanged(e) {\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    _getDecorations(ctx) {\n        const decorations = ctx.getDecorationsInViewport();\n        const r = [];\n        let rLen = 0;\n        for (let i = 0, len = decorations.length; i < len; i++) {\n            const d = decorations[i];\n            const glyphMarginClassName = d.options.glyphMarginClassName;\n            if (glyphMarginClassName) {\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.endLineNumber, glyphMarginClassName);\n            }\n        }\n        return r;\n    }\n    prepareRender(ctx) {\n        if (!this._glyphMargin) {\n            this._renderResult = null;\n            return;\n        }\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const toRender = this._render(visibleStartLineNumber, visibleEndLineNumber, this._getDecorations(ctx));\n        const lineHeight = this._lineHeight.toString();\n        const left = this._glyphMarginLeft.toString();\n        const width = this._glyphMarginWidth.toString();\n        const common = '\" style=\"left:' + left + 'px;width:' + width + 'px' + ';height:' + lineHeight + 'px;\"></div>';\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            const classNames = toRender[lineIndex];\n            if (classNames.length === 0) {\n                output[lineIndex] = '';\n            }\n            else {\n                output[lineIndex] = ('<div class=\"cgmr codicon '\n                    + classNames.join(' ')\n                    + common);\n            }\n        }\n        this._renderResult = output;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\n            return '';\n        }\n        return this._renderResult[lineIndex];\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './indentGuides.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport { editorBracketHighlightingForeground1, editorBracketHighlightingForeground2, editorBracketHighlightingForeground3, editorBracketHighlightingForeground4, editorBracketHighlightingForeground5, editorBracketHighlightingForeground6, editorBracketPairGuideActiveBackground1, editorBracketPairGuideActiveBackground2, editorBracketPairGuideActiveBackground3, editorBracketPairGuideActiveBackground4, editorBracketPairGuideActiveBackground5, editorBracketPairGuideActiveBackground6, editorBracketPairGuideBackground1, editorBracketPairGuideBackground2, editorBracketPairGuideBackground3, editorBracketPairGuideBackground4, editorBracketPairGuideBackground5, editorBracketPairGuideBackground6 } from '../../../common/core/editorColorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { ArrayQueue } from '../../../../base/common/arrays.js';\nimport { isDefined } from '../../../../base/common/types.js';\nimport { BracketPairGuidesClassNames } from '../../../common/model/guidesTextModelPart.js';\nimport { IndentGuide, HorizontalGuidesState } from '../../../common/textModelGuides.js';\nexport class IndentGuidesOverlay extends DynamicViewOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        this._primaryPosition = null;\n        const options = this._context.configuration.options;\n        const wrappingInfo = options.get(139 /* EditorOption.wrappingInfo */);\n        const fontInfo = options.get(47 /* EditorOption.fontInfo */);\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._spaceWidth = fontInfo.spaceWidth;\n        this._maxIndentLeft = wrappingInfo.wrappingColumn === -1 ? -1 : (wrappingInfo.wrappingColumn * fontInfo.typicalHalfwidthCharacterWidth);\n        this._bracketPairGuideOptions = options.get(13 /* EditorOption.guides */);\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const wrappingInfo = options.get(139 /* EditorOption.wrappingInfo */);\n        const fontInfo = options.get(47 /* EditorOption.fontInfo */);\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._spaceWidth = fontInfo.spaceWidth;\n        this._maxIndentLeft = wrappingInfo.wrappingColumn === -1 ? -1 : (wrappingInfo.wrappingColumn * fontInfo.typicalHalfwidthCharacterWidth);\n        this._bracketPairGuideOptions = options.get(13 /* EditorOption.guides */);\n        return true;\n    }\n    onCursorStateChanged(e) {\n        var _a;\n        const selection = e.selections[0];\n        const newPosition = selection.getPosition();\n        if (!((_a = this._primaryPosition) === null || _a === void 0 ? void 0 : _a.equals(newPosition))) {\n            this._primaryPosition = newPosition;\n            return true;\n        }\n        return false;\n    }\n    onDecorationsChanged(e) {\n        // true for inline decorations\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged; // || e.scrollWidthChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    onLanguageConfigurationChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        var _a, _b, _c, _d;\n        if (!this._bracketPairGuideOptions.indentation && this._bracketPairGuideOptions.bracketPairs === false) {\n            this._renderResult = null;\n            return;\n        }\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const scrollWidth = ctx.scrollWidth;\n        const lineHeight = this._lineHeight;\n        const activeCursorPosition = this._primaryPosition;\n        const indents = this.getGuidesByLine(visibleStartLineNumber, Math.min(visibleEndLineNumber + 1, this._context.viewModel.getLineCount()), activeCursorPosition);\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            const indent = indents[lineIndex];\n            let result = '';\n            const leftOffset = (_b = (_a = ctx.visibleRangeForPosition(new Position(lineNumber, 1))) === null || _a === void 0 ? void 0 : _a.left) !== null && _b !== void 0 ? _b : 0;\n            for (const guide of indent) {\n                const left = guide.column === -1\n                    ? leftOffset + (guide.visibleColumn - 1) * this._spaceWidth\n                    : ctx.visibleRangeForPosition(new Position(lineNumber, guide.column)).left;\n                if (left > scrollWidth || (this._maxIndentLeft > 0 && left > this._maxIndentLeft)) {\n                    break;\n                }\n                const className = guide.horizontalLine ? (guide.horizontalLine.top ? 'horizontal-top' : 'horizontal-bottom') : 'vertical';\n                const width = guide.horizontalLine\n                    ? ((_d = (_c = ctx.visibleRangeForPosition(new Position(lineNumber, guide.horizontalLine.endColumn))) === null || _c === void 0 ? void 0 : _c.left) !== null && _d !== void 0 ? _d : (left + this._spaceWidth)) - left\n                    : this._spaceWidth;\n                result += `<div class=\"core-guide ${guide.className} ${className}\" style=\"left:${left}px;height:${lineHeight}px;width:${width}px\"></div>`;\n            }\n            output[lineIndex] = result;\n        }\n        this._renderResult = output;\n    }\n    getGuidesByLine(visibleStartLineNumber, visibleEndLineNumber, activeCursorPosition) {\n        const bracketGuides = this._bracketPairGuideOptions.bracketPairs !== false\n            ? this._context.viewModel.getBracketGuidesInRangeByLine(visibleStartLineNumber, visibleEndLineNumber, activeCursorPosition, {\n                highlightActive: this._bracketPairGuideOptions.highlightActiveBracketPair,\n                horizontalGuides: this._bracketPairGuideOptions.bracketPairsHorizontal === true\n                    ? HorizontalGuidesState.Enabled\n                    : this._bracketPairGuideOptions.bracketPairsHorizontal === 'active'\n                        ? HorizontalGuidesState.EnabledForActive\n                        : HorizontalGuidesState.Disabled,\n                includeInactive: this._bracketPairGuideOptions.bracketPairs === true,\n            })\n            : null;\n        const indentGuides = this._bracketPairGuideOptions.indentation\n            ? this._context.viewModel.getLinesIndentGuides(visibleStartLineNumber, visibleEndLineNumber)\n            : null;\n        let activeIndentStartLineNumber = 0;\n        let activeIndentEndLineNumber = 0;\n        let activeIndentLevel = 0;\n        if (this._bracketPairGuideOptions.highlightActiveIndentation !== false && activeCursorPosition) {\n            const activeIndentInfo = this._context.viewModel.getActiveIndentGuide(activeCursorPosition.lineNumber, visibleStartLineNumber, visibleEndLineNumber);\n            activeIndentStartLineNumber = activeIndentInfo.startLineNumber;\n            activeIndentEndLineNumber = activeIndentInfo.endLineNumber;\n            activeIndentLevel = activeIndentInfo.indent;\n        }\n        const { indentSize } = this._context.viewModel.model.getOptions();\n        const result = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineGuides = new Array();\n            result.push(lineGuides);\n            const bracketGuidesInLine = bracketGuides ? bracketGuides[lineNumber - visibleStartLineNumber] : [];\n            const bracketGuidesInLineQueue = new ArrayQueue(bracketGuidesInLine);\n            const indentGuidesInLine = indentGuides ? indentGuides[lineNumber - visibleStartLineNumber] : 0;\n            for (let indentLvl = 1; indentLvl <= indentGuidesInLine; indentLvl++) {\n                const indentGuide = (indentLvl - 1) * indentSize + 1;\n                const isActive = \n                // Disable active indent guide if there are bracket guides.\n                (this._bracketPairGuideOptions.highlightActiveIndentation === 'always' || bracketGuidesInLine.length === 0) &&\n                    activeIndentStartLineNumber <= lineNumber &&\n                    lineNumber <= activeIndentEndLineNumber &&\n                    indentLvl === activeIndentLevel;\n                lineGuides.push(...bracketGuidesInLineQueue.takeWhile(g => g.visibleColumn < indentGuide) || []);\n                const peeked = bracketGuidesInLineQueue.peek();\n                if (!peeked || peeked.visibleColumn !== indentGuide || peeked.horizontalLine) {\n                    lineGuides.push(new IndentGuide(indentGuide, -1, isActive ? 'core-guide-indent-active' : 'core-guide-indent', null, -1, -1));\n                }\n            }\n            lineGuides.push(...bracketGuidesInLineQueue.takeWhile(g => true) || []);\n        }\n        return result;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\n            return '';\n        }\n        return this._renderResult[lineIndex];\n    }\n}\nfunction transparentToUndefined(color) {\n    if (color && color.isTransparent()) {\n        return undefined;\n    }\n    return color;\n}\nregisterThemingParticipant((theme, collector) => {\n    const colors = [\n        { bracketColor: editorBracketHighlightingForeground1, guideColor: editorBracketPairGuideBackground1, guideColorActive: editorBracketPairGuideActiveBackground1 },\n        { bracketColor: editorBracketHighlightingForeground2, guideColor: editorBracketPairGuideBackground2, guideColorActive: editorBracketPairGuideActiveBackground2 },\n        { bracketColor: editorBracketHighlightingForeground3, guideColor: editorBracketPairGuideBackground3, guideColorActive: editorBracketPairGuideActiveBackground3 },\n        { bracketColor: editorBracketHighlightingForeground4, guideColor: editorBracketPairGuideBackground4, guideColorActive: editorBracketPairGuideActiveBackground4 },\n        { bracketColor: editorBracketHighlightingForeground5, guideColor: editorBracketPairGuideBackground5, guideColorActive: editorBracketPairGuideActiveBackground5 },\n        { bracketColor: editorBracketHighlightingForeground6, guideColor: editorBracketPairGuideBackground6, guideColorActive: editorBracketPairGuideActiveBackground6 }\n    ];\n    const colorProvider = new BracketPairGuidesClassNames();\n    const colorValues = colors\n        .map(c => {\n        var _a, _b;\n        const bracketColor = theme.getColor(c.bracketColor);\n        const guideColor = theme.getColor(c.guideColor);\n        const guideColorActive = theme.getColor(c.guideColorActive);\n        const effectiveGuideColor = transparentToUndefined((_a = transparentToUndefined(guideColor)) !== null && _a !== void 0 ? _a : bracketColor === null || bracketColor === void 0 ? void 0 : bracketColor.transparent(0.3));\n        const effectiveGuideColorActive = transparentToUndefined((_b = transparentToUndefined(guideColorActive)) !== null && _b !== void 0 ? _b : bracketColor);\n        if (!effectiveGuideColor || !effectiveGuideColorActive) {\n            return undefined;\n        }\n        return {\n            guideColor: effectiveGuideColor,\n            guideColorActive: effectiveGuideColorActive,\n        };\n    })\n        .filter(isDefined);\n    if (colorValues.length > 0) {\n        for (let level = 0; level < 30; level++) {\n            const colors = colorValues[level % colorValues.length];\n            collector.addRule(`.monaco-editor .${colorProvider.getInlineClassNameOfLevel(level).replace(/ /g, '.')} { --guide-color: ${colors.guideColor}; --guide-color-active: ${colors.guideColorActive}; }`);\n        }\n        collector.addRule(`.monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }`);\n        collector.addRule(`.monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }`);\n        collector.addRule(`.monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }`);\n        collector.addRule(`.monaco-editor .vertical.${colorProvider.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`);\n        collector.addRule(`.monaco-editor .horizontal-top.${colorProvider.activeClassName} { border-top: 1px solid var(--guide-color-active); }`);\n        collector.addRule(`.monaco-editor .horizontal-bottom.${colorProvider.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class DomReadingContext {\n    get didDomLayout() {\n        return this._didDomLayout;\n    }\n    readClientRect() {\n        if (!this._clientRectRead) {\n            this._clientRectRead = true;\n            const rect = this._domNode.getBoundingClientRect();\n            this.markDidDomLayout();\n            this._clientRectDeltaLeft = rect.left;\n            this._clientRectScale = rect.width / this._domNode.offsetWidth;\n        }\n    }\n    get clientRectDeltaLeft() {\n        if (!this._clientRectRead) {\n            this.readClientRect();\n        }\n        return this._clientRectDeltaLeft;\n    }\n    get clientRectScale() {\n        if (!this._clientRectRead) {\n            this.readClientRect();\n        }\n        return this._clientRectScale;\n    }\n    constructor(_domNode, endNode) {\n        this._domNode = _domNode;\n        this.endNode = endNode;\n        this._didDomLayout = false;\n        this._clientRectDeltaLeft = 0;\n        this._clientRectScale = 1;\n        this._clientRectRead = false;\n    }\n    markDidDomLayout() {\n        this._didDomLayout = true;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './viewLines.css';\nimport * as platform from '../../../../base/common/platform.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { applyFontInfo } from '../../config/domFontInfo.js';\nimport { VisibleLinesCollection } from '../../view/viewLayer.js';\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\nimport { ViewLine, ViewLineOptions } from './viewLine.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { LineVisibleRanges, HorizontalPosition, HorizontalRange } from '../../view/renderingContext.js';\nimport { MOUSE_CURSOR_TEXT_CSS_CLASS_NAME } from '../../../../base/browser/ui/mouseCursor/mouseCursor.js';\nimport { DomReadingContext } from './domReadingContext.js';\nclass LastRenderedData {\n    constructor() {\n        this._currentVisibleRange = new Range(1, 1, 1, 1);\n    }\n    getCurrentVisibleRange() {\n        return this._currentVisibleRange;\n    }\n    setCurrentVisibleRange(currentVisibleRange) {\n        this._currentVisibleRange = currentVisibleRange;\n    }\n}\nclass HorizontalRevealRangeRequest {\n    constructor(minimalReveal, lineNumber, startColumn, endColumn, startScrollTop, stopScrollTop, scrollType) {\n        this.minimalReveal = minimalReveal;\n        this.lineNumber = lineNumber;\n        this.startColumn = startColumn;\n        this.endColumn = endColumn;\n        this.startScrollTop = startScrollTop;\n        this.stopScrollTop = stopScrollTop;\n        this.scrollType = scrollType;\n        this.type = 'range';\n        this.minLineNumber = lineNumber;\n        this.maxLineNumber = lineNumber;\n    }\n}\nclass HorizontalRevealSelectionsRequest {\n    constructor(minimalReveal, selections, startScrollTop, stopScrollTop, scrollType) {\n        this.minimalReveal = minimalReveal;\n        this.selections = selections;\n        this.startScrollTop = startScrollTop;\n        this.stopScrollTop = stopScrollTop;\n        this.scrollType = scrollType;\n        this.type = 'selections';\n        let minLineNumber = selections[0].startLineNumber;\n        let maxLineNumber = selections[0].endLineNumber;\n        for (let i = 1, len = selections.length; i < len; i++) {\n            const selection = selections[i];\n            minLineNumber = Math.min(minLineNumber, selection.startLineNumber);\n            maxLineNumber = Math.max(maxLineNumber, selection.endLineNumber);\n        }\n        this.minLineNumber = minLineNumber;\n        this.maxLineNumber = maxLineNumber;\n    }\n}\nclass ViewLines extends ViewPart {\n    constructor(context, linesContent) {\n        super(context);\n        this._linesContent = linesContent;\n        this._textRangeRestingSpot = document.createElement('div');\n        this._visibleLines = new VisibleLinesCollection(this);\n        this.domNode = this._visibleLines.domNode;\n        const conf = this._context.configuration;\n        const options = this._context.configuration.options;\n        const fontInfo = options.get(47 /* EditorOption.fontInfo */);\n        const wrappingInfo = options.get(139 /* EditorOption.wrappingInfo */);\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n        this._isViewportWrapping = wrappingInfo.isViewportWrapping;\n        this._revealHorizontalRightPadding = options.get(94 /* EditorOption.revealHorizontalRightPadding */);\n        this._cursorSurroundingLines = options.get(26 /* EditorOption.cursorSurroundingLines */);\n        this._cursorSurroundingLinesStyle = options.get(27 /* EditorOption.cursorSurroundingLinesStyle */);\n        this._canUseLayerHinting = !options.get(29 /* EditorOption.disableLayerHinting */);\n        this._viewLineOptions = new ViewLineOptions(conf, this._context.theme.type);\n        PartFingerprints.write(this.domNode, 7 /* PartFingerprint.ViewLines */);\n        this.domNode.setClassName(`view-lines ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`);\n        applyFontInfo(this.domNode, fontInfo);\n        // --- width & height\n        this._maxLineWidth = 0;\n        this._asyncUpdateLineWidths = new RunOnceScheduler(() => {\n            this._updateLineWidthsSlow();\n        }, 200);\n        this._asyncCheckMonospaceFontAssumptions = new RunOnceScheduler(() => {\n            this._checkMonospaceFontAssumptions();\n        }, 2000);\n        this._lastRenderedData = new LastRenderedData();\n        this._horizontalRevealRequest = null;\n        // sticky scroll widget\n        this._stickyScrollEnabled = options.get(109 /* EditorOption.stickyScroll */).enabled;\n        this._maxNumberStickyLines = options.get(109 /* EditorOption.stickyScroll */).maxLineCount;\n    }\n    dispose() {\n        this._asyncUpdateLineWidths.dispose();\n        this._asyncCheckMonospaceFontAssumptions.dispose();\n        super.dispose();\n    }\n    getDomNode() {\n        return this.domNode;\n    }\n    // ---- begin IVisibleLinesHost\n    createVisibleLine() {\n        return new ViewLine(this._viewLineOptions);\n    }\n    // ---- end IVisibleLinesHost\n    // ---- begin view event handlers\n    onConfigurationChanged(e) {\n        this._visibleLines.onConfigurationChanged(e);\n        if (e.hasChanged(139 /* EditorOption.wrappingInfo */)) {\n            this._maxLineWidth = 0;\n        }\n        const options = this._context.configuration.options;\n        const fontInfo = options.get(47 /* EditorOption.fontInfo */);\n        const wrappingInfo = options.get(139 /* EditorOption.wrappingInfo */);\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n        this._isViewportWrapping = wrappingInfo.isViewportWrapping;\n        this._revealHorizontalRightPadding = options.get(94 /* EditorOption.revealHorizontalRightPadding */);\n        this._cursorSurroundingLines = options.get(26 /* EditorOption.cursorSurroundingLines */);\n        this._cursorSurroundingLinesStyle = options.get(27 /* EditorOption.cursorSurroundingLinesStyle */);\n        this._canUseLayerHinting = !options.get(29 /* EditorOption.disableLayerHinting */);\n        // sticky scroll\n        this._stickyScrollEnabled = options.get(109 /* EditorOption.stickyScroll */).enabled;\n        this._maxNumberStickyLines = options.get(109 /* EditorOption.stickyScroll */).maxLineCount;\n        applyFontInfo(this.domNode, fontInfo);\n        this._onOptionsMaybeChanged();\n        if (e.hasChanged(138 /* EditorOption.layoutInfo */)) {\n            this._maxLineWidth = 0;\n        }\n        return true;\n    }\n    _onOptionsMaybeChanged() {\n        const conf = this._context.configuration;\n        const newViewLineOptions = new ViewLineOptions(conf, this._context.theme.type);\n        if (!this._viewLineOptions.equals(newViewLineOptions)) {\n            this._viewLineOptions = newViewLineOptions;\n            const startLineNumber = this._visibleLines.getStartLineNumber();\n            const endLineNumber = this._visibleLines.getEndLineNumber();\n            for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n                const line = this._visibleLines.getVisibleLine(lineNumber);\n                line.onOptionsChanged(this._viewLineOptions);\n            }\n            return true;\n        }\n        return false;\n    }\n    onCursorStateChanged(e) {\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        let r = false;\n        for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n            r = this._visibleLines.getVisibleLine(lineNumber).onSelectionChanged() || r;\n        }\n        return r;\n    }\n    onDecorationsChanged(e) {\n        if (true /*e.inlineDecorationsChanged*/) {\n            const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n            const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n            for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n                this._visibleLines.getVisibleLine(lineNumber).onDecorationsChanged();\n            }\n        }\n        return true;\n    }\n    onFlushed(e) {\n        const shouldRender = this._visibleLines.onFlushed(e);\n        this._maxLineWidth = 0;\n        return shouldRender;\n    }\n    onLinesChanged(e) {\n        return this._visibleLines.onLinesChanged(e);\n    }\n    onLinesDeleted(e) {\n        return this._visibleLines.onLinesDeleted(e);\n    }\n    onLinesInserted(e) {\n        return this._visibleLines.onLinesInserted(e);\n    }\n    onRevealRangeRequest(e) {\n        // Using the future viewport here in order to handle multiple\n        // incoming reveal range requests that might all desire to be animated\n        const desiredScrollTop = this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(), e.source, e.minimalReveal, e.range, e.selections, e.verticalType);\n        if (desiredScrollTop === -1) {\n            // marker to abort the reveal range request\n            return false;\n        }\n        // validate the new desired scroll top\n        let newScrollPosition = this._context.viewLayout.validateScrollPosition({ scrollTop: desiredScrollTop });\n        if (e.revealHorizontal) {\n            if (e.range && e.range.startLineNumber !== e.range.endLineNumber) {\n                // Two or more lines? => scroll to base (That's how you see most of the two lines)\n                newScrollPosition = {\n                    scrollTop: newScrollPosition.scrollTop,\n                    scrollLeft: 0\n                };\n            }\n            else if (e.range) {\n                // We don't necessarily know the horizontal offset of this range since the line might not be in the view...\n                this._horizontalRevealRequest = new HorizontalRevealRangeRequest(e.minimalReveal, e.range.startLineNumber, e.range.startColumn, e.range.endColumn, this._context.viewLayout.getCurrentScrollTop(), newScrollPosition.scrollTop, e.scrollType);\n            }\n            else if (e.selections && e.selections.length > 0) {\n                this._horizontalRevealRequest = new HorizontalRevealSelectionsRequest(e.minimalReveal, e.selections, this._context.viewLayout.getCurrentScrollTop(), newScrollPosition.scrollTop, e.scrollType);\n            }\n        }\n        else {\n            this._horizontalRevealRequest = null;\n        }\n        const scrollTopDelta = Math.abs(this._context.viewLayout.getCurrentScrollTop() - newScrollPosition.scrollTop);\n        const scrollType = (scrollTopDelta <= this._lineHeight ? 1 /* ScrollType.Immediate */ : e.scrollType);\n        this._context.viewModel.viewLayout.setScrollPosition(newScrollPosition, scrollType);\n        return true;\n    }\n    onScrollChanged(e) {\n        if (this._horizontalRevealRequest && e.scrollLeftChanged) {\n            // cancel any outstanding horizontal reveal request if someone else scrolls horizontally.\n            this._horizontalRevealRequest = null;\n        }\n        if (this._horizontalRevealRequest && e.scrollTopChanged) {\n            const min = Math.min(this._horizontalRevealRequest.startScrollTop, this._horizontalRevealRequest.stopScrollTop);\n            const max = Math.max(this._horizontalRevealRequest.startScrollTop, this._horizontalRevealRequest.stopScrollTop);\n            if (e.scrollTop < min || e.scrollTop > max) {\n                // cancel any outstanding horizontal reveal request if someone else scrolls vertically.\n                this._horizontalRevealRequest = null;\n            }\n        }\n        this.domNode.setWidth(e.scrollWidth);\n        return this._visibleLines.onScrollChanged(e) || true;\n    }\n    onTokensChanged(e) {\n        return this._visibleLines.onTokensChanged(e);\n    }\n    onZonesChanged(e) {\n        this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth);\n        return this._visibleLines.onZonesChanged(e);\n    }\n    onThemeChanged(e) {\n        return this._onOptionsMaybeChanged();\n    }\n    // ---- end view event handlers\n    // ----------- HELPERS FOR OTHERS\n    getPositionFromDOMInfo(spanNode, offset) {\n        const viewLineDomNode = this._getViewLineDomNode(spanNode);\n        if (viewLineDomNode === null) {\n            // Couldn't find view line node\n            return null;\n        }\n        const lineNumber = this._getLineNumberFor(viewLineDomNode);\n        if (lineNumber === -1) {\n            // Couldn't find view line node\n            return null;\n        }\n        if (lineNumber < 1 || lineNumber > this._context.viewModel.getLineCount()) {\n            // lineNumber is outside range\n            return null;\n        }\n        if (this._context.viewModel.getLineMaxColumn(lineNumber) === 1) {\n            // Line is empty\n            return new Position(lineNumber, 1);\n        }\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\n            // Couldn't find line\n            return null;\n        }\n        let column = this._visibleLines.getVisibleLine(lineNumber).getColumnOfNodeOffset(lineNumber, spanNode, offset);\n        const minColumn = this._context.viewModel.getLineMinColumn(lineNumber);\n        if (column < minColumn) {\n            column = minColumn;\n        }\n        return new Position(lineNumber, column);\n    }\n    _getViewLineDomNode(node) {\n        while (node && node.nodeType === 1) {\n            if (node.className === ViewLine.CLASS_NAME) {\n                return node;\n            }\n            node = node.parentElement;\n        }\n        return null;\n    }\n    /**\n     * @returns the line number of this view line dom node.\n     */\n    _getLineNumberFor(domNode) {\n        const startLineNumber = this._visibleLines.getStartLineNumber();\n        const endLineNumber = this._visibleLines.getEndLineNumber();\n        for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n            const line = this._visibleLines.getVisibleLine(lineNumber);\n            if (domNode === line.getDomNode()) {\n                return lineNumber;\n            }\n        }\n        return -1;\n    }\n    getLineWidth(lineNumber) {\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\n            // Couldn't find line\n            return -1;\n        }\n        const context = new DomReadingContext(this.domNode.domNode, this._textRangeRestingSpot);\n        const result = this._visibleLines.getVisibleLine(lineNumber).getWidth(context);\n        this._updateLineWidthsSlowIfDomDidLayout(context);\n        return result;\n    }\n    linesVisibleRangesForRange(_range, includeNewLines) {\n        if (this.shouldRender()) {\n            // Cannot read from the DOM because it is dirty\n            // i.e. the model & the dom are out of sync, so I'd be reading something stale\n            return null;\n        }\n        const originalEndLineNumber = _range.endLineNumber;\n        const range = Range.intersectRanges(_range, this._lastRenderedData.getCurrentVisibleRange());\n        if (!range) {\n            return null;\n        }\n        const visibleRanges = [];\n        let visibleRangesLen = 0;\n        const domReadingContext = new DomReadingContext(this.domNode.domNode, this._textRangeRestingSpot);\n        let nextLineModelLineNumber = 0;\n        if (includeNewLines) {\n            nextLineModelLineNumber = this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position(range.startLineNumber, 1)).lineNumber;\n        }\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        for (let lineNumber = range.startLineNumber; lineNumber <= range.endLineNumber; lineNumber++) {\n            if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\n                continue;\n            }\n            const startColumn = lineNumber === range.startLineNumber ? range.startColumn : 1;\n            const endColumn = lineNumber === range.endLineNumber ? range.endColumn : this._context.viewModel.getLineMaxColumn(lineNumber);\n            const visibleRangesForLine = this._visibleLines.getVisibleLine(lineNumber).getVisibleRangesForRange(lineNumber, startColumn, endColumn, domReadingContext);\n            if (!visibleRangesForLine) {\n                continue;\n            }\n            if (includeNewLines && lineNumber < originalEndLineNumber) {\n                const currentLineModelLineNumber = nextLineModelLineNumber;\n                nextLineModelLineNumber = this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position(lineNumber + 1, 1)).lineNumber;\n                if (currentLineModelLineNumber !== nextLineModelLineNumber) {\n                    visibleRangesForLine.ranges[visibleRangesForLine.ranges.length - 1].width += this._typicalHalfwidthCharacterWidth;\n                }\n            }\n            visibleRanges[visibleRangesLen++] = new LineVisibleRanges(visibleRangesForLine.outsideRenderedLine, lineNumber, HorizontalRange.from(visibleRangesForLine.ranges));\n        }\n        this._updateLineWidthsSlowIfDomDidLayout(domReadingContext);\n        if (visibleRangesLen === 0) {\n            return null;\n        }\n        return visibleRanges;\n    }\n    _visibleRangesForLineRange(lineNumber, startColumn, endColumn) {\n        if (this.shouldRender()) {\n            // Cannot read from the DOM because it is dirty\n            // i.e. the model & the dom are out of sync, so I'd be reading something stale\n            return null;\n        }\n        if (lineNumber < this._visibleLines.getStartLineNumber() || lineNumber > this._visibleLines.getEndLineNumber()) {\n            return null;\n        }\n        const domReadingContext = new DomReadingContext(this.domNode.domNode, this._textRangeRestingSpot);\n        const result = this._visibleLines.getVisibleLine(lineNumber).getVisibleRangesForRange(lineNumber, startColumn, endColumn, domReadingContext);\n        this._updateLineWidthsSlowIfDomDidLayout(domReadingContext);\n        return result;\n    }\n    visibleRangeForPosition(position) {\n        const visibleRanges = this._visibleRangesForLineRange(position.lineNumber, position.column, position.column);\n        if (!visibleRanges) {\n            return null;\n        }\n        return new HorizontalPosition(visibleRanges.outsideRenderedLine, visibleRanges.ranges[0].left);\n    }\n    /**\n     * Updates the max line width if it is fast to compute.\n     * Returns true if all lines were taken into account.\n     * Returns false if some lines need to be reevaluated (in a slow fashion).\n     */\n    _updateLineWidthsFast() {\n        return this._updateLineWidths(true);\n    }\n    _updateLineWidthsSlow() {\n        this._updateLineWidths(false);\n    }\n    /**\n     * Update the line widths using DOM layout information after someone else\n     * has caused a synchronous layout.\n     */\n    _updateLineWidthsSlowIfDomDidLayout(domReadingContext) {\n        if (!domReadingContext.didDomLayout) {\n            // only proceed if we just did a layout\n            return;\n        }\n        if (this._asyncUpdateLineWidths.isScheduled()) {\n            // reading widths is not scheduled => widths are up-to-date\n            return;\n        }\n        this._asyncUpdateLineWidths.cancel();\n        this._updateLineWidthsSlow();\n    }\n    _updateLineWidths(fast) {\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        let localMaxLineWidth = 1;\n        let allWidthsComputed = true;\n        for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n            const visibleLine = this._visibleLines.getVisibleLine(lineNumber);\n            if (fast && !visibleLine.getWidthIsFast()) {\n                // Cannot compute width in a fast way for this line\n                allWidthsComputed = false;\n                continue;\n            }\n            localMaxLineWidth = Math.max(localMaxLineWidth, visibleLine.getWidth(null));\n        }\n        if (allWidthsComputed && rendStartLineNumber === 1 && rendEndLineNumber === this._context.viewModel.getLineCount()) {\n            // we know the max line width for all the lines\n            this._maxLineWidth = 0;\n        }\n        this._ensureMaxLineWidth(localMaxLineWidth);\n        return allWidthsComputed;\n    }\n    _checkMonospaceFontAssumptions() {\n        // Problems with monospace assumptions are more apparent for longer lines,\n        // as small rounding errors start to sum up, so we will select the longest\n        // line for a closer inspection\n        let longestLineNumber = -1;\n        let longestWidth = -1;\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n            const visibleLine = this._visibleLines.getVisibleLine(lineNumber);\n            if (visibleLine.needsMonospaceFontCheck()) {\n                const lineWidth = visibleLine.getWidth(null);\n                if (lineWidth > longestWidth) {\n                    longestWidth = lineWidth;\n                    longestLineNumber = lineNumber;\n                }\n            }\n        }\n        if (longestLineNumber === -1) {\n            return;\n        }\n        if (!this._visibleLines.getVisibleLine(longestLineNumber).monospaceAssumptionsAreValid()) {\n            for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n                const visibleLine = this._visibleLines.getVisibleLine(lineNumber);\n                visibleLine.onMonospaceAssumptionsInvalidated();\n            }\n        }\n    }\n    prepareRender() {\n        throw new Error('Not supported');\n    }\n    render() {\n        throw new Error('Not supported');\n    }\n    renderText(viewportData) {\n        // (1) render lines - ensures lines are in the DOM\n        this._visibleLines.renderLines(viewportData);\n        this._lastRenderedData.setCurrentVisibleRange(viewportData.visibleRange);\n        this.domNode.setWidth(this._context.viewLayout.getScrollWidth());\n        this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(), 1000000));\n        // (2) compute horizontal scroll position:\n        //  - this must happen after the lines are in the DOM since it might need a line that rendered just now\n        //  - it might change `scrollWidth` and `scrollLeft`\n        if (this._horizontalRevealRequest) {\n            const horizontalRevealRequest = this._horizontalRevealRequest;\n            // Check that we have the line that contains the horizontal range in the viewport\n            if (viewportData.startLineNumber <= horizontalRevealRequest.minLineNumber && horizontalRevealRequest.maxLineNumber <= viewportData.endLineNumber) {\n                this._horizontalRevealRequest = null;\n                // allow `visibleRangesForRange2` to work\n                this.onDidRender();\n                // compute new scroll position\n                const newScrollLeft = this._computeScrollLeftToReveal(horizontalRevealRequest);\n                if (newScrollLeft) {\n                    if (!this._isViewportWrapping) {\n                        // ensure `scrollWidth` is large enough\n                        this._ensureMaxLineWidth(newScrollLeft.maxHorizontalOffset);\n                    }\n                    // set `scrollLeft`\n                    this._context.viewModel.viewLayout.setScrollPosition({\n                        scrollLeft: newScrollLeft.scrollLeft\n                    }, horizontalRevealRequest.scrollType);\n                }\n            }\n        }\n        // Update max line width (not so important, it is just so the horizontal scrollbar doesn't get too small)\n        if (!this._updateLineWidthsFast()) {\n            // Computing the width of some lines would be slow => delay it\n            this._asyncUpdateLineWidths.schedule();\n        }\n        else {\n            this._asyncUpdateLineWidths.cancel();\n        }\n        if (platform.isLinux && !this._asyncCheckMonospaceFontAssumptions.isScheduled()) {\n            const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n            const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n            for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n                const visibleLine = this._visibleLines.getVisibleLine(lineNumber);\n                if (visibleLine.needsMonospaceFontCheck()) {\n                    this._asyncCheckMonospaceFontAssumptions.schedule();\n                    break;\n                }\n            }\n        }\n        // (3) handle scrolling\n        this._linesContent.setLayerHinting(this._canUseLayerHinting);\n        this._linesContent.setContain('strict');\n        const adjustedScrollTop = this._context.viewLayout.getCurrentScrollTop() - viewportData.bigNumbersDelta;\n        this._linesContent.setTop(-adjustedScrollTop);\n        this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft());\n    }\n    // --- width\n    _ensureMaxLineWidth(lineWidth) {\n        const iLineWidth = Math.ceil(lineWidth);\n        if (this._maxLineWidth < iLineWidth) {\n            this._maxLineWidth = iLineWidth;\n            this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth);\n        }\n    }\n    _computeScrollTopToRevealRange(viewport, source, minimalReveal, range, selections, verticalType) {\n        const viewportStartY = viewport.top;\n        const viewportHeight = viewport.height;\n        const viewportEndY = viewportStartY + viewportHeight;\n        let boxIsSingleRange;\n        let boxStartY;\n        let boxEndY;\n        if (selections && selections.length > 0) {\n            let minLineNumber = selections[0].startLineNumber;\n            let maxLineNumber = selections[0].endLineNumber;\n            for (let i = 1, len = selections.length; i < len; i++) {\n                const selection = selections[i];\n                minLineNumber = Math.min(minLineNumber, selection.startLineNumber);\n                maxLineNumber = Math.max(maxLineNumber, selection.endLineNumber);\n            }\n            boxIsSingleRange = false;\n            boxStartY = this._context.viewLayout.getVerticalOffsetForLineNumber(minLineNumber);\n            boxEndY = this._context.viewLayout.getVerticalOffsetForLineNumber(maxLineNumber) + this._lineHeight;\n        }\n        else if (range) {\n            boxIsSingleRange = true;\n            boxStartY = this._context.viewLayout.getVerticalOffsetForLineNumber(range.startLineNumber);\n            boxEndY = this._context.viewLayout.getVerticalOffsetForLineNumber(range.endLineNumber) + this._lineHeight;\n        }\n        else {\n            return -1;\n        }\n        const shouldIgnoreScrollOff = (source === 'mouse' || minimalReveal) && this._cursorSurroundingLinesStyle === 'default';\n        let paddingTop = 0;\n        let paddingBottom = 0;\n        if (!shouldIgnoreScrollOff) {\n            const context = Math.min((viewportHeight / this._lineHeight) / 2, this._cursorSurroundingLines);\n            if (this._stickyScrollEnabled) {\n                paddingTop = Math.max(context, this._maxNumberStickyLines) * this._lineHeight;\n            }\n            else {\n                paddingTop = context * this._lineHeight;\n            }\n            paddingBottom = Math.max(0, (context - 1)) * this._lineHeight;\n        }\n        else {\n            if (!minimalReveal) {\n                // Reveal one more line above (this case is hit when dragging)\n                paddingTop = this._lineHeight;\n            }\n        }\n        if (!minimalReveal) {\n            if (verticalType === 0 /* viewEvents.VerticalRevealType.Simple */ || verticalType === 4 /* viewEvents.VerticalRevealType.Bottom */) {\n                // Reveal one line more when the last line would be covered by the scrollbar - arrow down case or revealing a line explicitly at bottom\n                paddingBottom += this._lineHeight;\n            }\n        }\n        boxStartY -= paddingTop;\n        boxEndY += paddingBottom;\n        let newScrollTop;\n        if (boxEndY - boxStartY > viewportHeight) {\n            // the box is larger than the viewport ... scroll to its top\n            if (!boxIsSingleRange) {\n                // do not reveal multiple cursors if there are more than fit the viewport\n                return -1;\n            }\n            newScrollTop = boxStartY;\n        }\n        else if (verticalType === 5 /* viewEvents.VerticalRevealType.NearTop */ || verticalType === 6 /* viewEvents.VerticalRevealType.NearTopIfOutsideViewport */) {\n            if (verticalType === 6 /* viewEvents.VerticalRevealType.NearTopIfOutsideViewport */ && viewportStartY <= boxStartY && boxEndY <= viewportEndY) {\n                // Box is already in the viewport... do nothing\n                newScrollTop = viewportStartY;\n            }\n            else {\n                // We want a gap that is 20% of the viewport, but with a minimum of 5 lines\n                const desiredGapAbove = Math.max(5 * this._lineHeight, viewportHeight * 0.2);\n                // Try to scroll just above the box with the desired gap\n                const desiredScrollTop = boxStartY - desiredGapAbove;\n                // But ensure that the box is not pushed out of viewport\n                const minScrollTop = boxEndY - viewportHeight;\n                newScrollTop = Math.max(minScrollTop, desiredScrollTop);\n            }\n        }\n        else if (verticalType === 1 /* viewEvents.VerticalRevealType.Center */ || verticalType === 2 /* viewEvents.VerticalRevealType.CenterIfOutsideViewport */) {\n            if (verticalType === 2 /* viewEvents.VerticalRevealType.CenterIfOutsideViewport */ && viewportStartY <= boxStartY && boxEndY <= viewportEndY) {\n                // Box is already in the viewport... do nothing\n                newScrollTop = viewportStartY;\n            }\n            else {\n                // Box is outside the viewport... center it\n                const boxMiddleY = (boxStartY + boxEndY) / 2;\n                newScrollTop = Math.max(0, boxMiddleY - viewportHeight / 2);\n            }\n        }\n        else {\n            newScrollTop = this._computeMinimumScrolling(viewportStartY, viewportEndY, boxStartY, boxEndY, verticalType === 3 /* viewEvents.VerticalRevealType.Top */, verticalType === 4 /* viewEvents.VerticalRevealType.Bottom */);\n        }\n        return newScrollTop;\n    }\n    _computeScrollLeftToReveal(horizontalRevealRequest) {\n        const viewport = this._context.viewLayout.getCurrentViewport();\n        const layoutInfo = this._context.configuration.options.get(138 /* EditorOption.layoutInfo */);\n        const viewportStartX = viewport.left;\n        const viewportEndX = viewportStartX + viewport.width - layoutInfo.verticalScrollbarWidth;\n        let boxStartX = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n        let boxEndX = 0;\n        if (horizontalRevealRequest.type === 'range') {\n            const visibleRanges = this._visibleRangesForLineRange(horizontalRevealRequest.lineNumber, horizontalRevealRequest.startColumn, horizontalRevealRequest.endColumn);\n            if (!visibleRanges) {\n                return null;\n            }\n            for (const visibleRange of visibleRanges.ranges) {\n                boxStartX = Math.min(boxStartX, Math.round(visibleRange.left));\n                boxEndX = Math.max(boxEndX, Math.round(visibleRange.left + visibleRange.width));\n            }\n        }\n        else {\n            for (const selection of horizontalRevealRequest.selections) {\n                if (selection.startLineNumber !== selection.endLineNumber) {\n                    return null;\n                }\n                const visibleRanges = this._visibleRangesForLineRange(selection.startLineNumber, selection.startColumn, selection.endColumn);\n                if (!visibleRanges) {\n                    return null;\n                }\n                for (const visibleRange of visibleRanges.ranges) {\n                    boxStartX = Math.min(boxStartX, Math.round(visibleRange.left));\n                    boxEndX = Math.max(boxEndX, Math.round(visibleRange.left + visibleRange.width));\n                }\n            }\n        }\n        if (!horizontalRevealRequest.minimalReveal) {\n            boxStartX = Math.max(0, boxStartX - ViewLines.HORIZONTAL_EXTRA_PX);\n            boxEndX += this._revealHorizontalRightPadding;\n        }\n        if (horizontalRevealRequest.type === 'selections' && boxEndX - boxStartX > viewport.width) {\n            return null;\n        }\n        const newScrollLeft = this._computeMinimumScrolling(viewportStartX, viewportEndX, boxStartX, boxEndX);\n        return {\n            scrollLeft: newScrollLeft,\n            maxHorizontalOffset: boxEndX\n        };\n    }\n    _computeMinimumScrolling(viewportStart, viewportEnd, boxStart, boxEnd, revealAtStart, revealAtEnd) {\n        viewportStart = viewportStart | 0;\n        viewportEnd = viewportEnd | 0;\n        boxStart = boxStart | 0;\n        boxEnd = boxEnd | 0;\n        revealAtStart = !!revealAtStart;\n        revealAtEnd = !!revealAtEnd;\n        const viewportLength = viewportEnd - viewportStart;\n        const boxLength = boxEnd - boxStart;\n        if (boxLength < viewportLength) {\n            // The box would fit in the viewport\n            if (revealAtStart) {\n                return boxStart;\n            }\n            if (revealAtEnd) {\n                return Math.max(0, boxEnd - viewportLength);\n            }\n            if (boxStart < viewportStart) {\n                // The box is above the viewport\n                return boxStart;\n            }\n            else if (boxEnd > viewportEnd) {\n                // The box is below the viewport\n                return Math.max(0, boxEnd - viewportLength);\n            }\n        }\n        else {\n            // The box would not fit in the viewport\n            // Reveal the beginning of the box\n            return boxStart;\n        }\n        return viewportStart;\n    }\n}\n/**\n * Adds this amount of pixels to the right of lines (no-one wants to type near the edge of the viewport)\n */\nViewLines.HORIZONTAL_EXTRA_PX = 30;\nexport { ViewLines };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './linesDecorations.css';\nimport { DecorationToRender, DedupOverlay } from '../glyphMargin/glyphMargin.js';\nexport class LinesDecorationsOverlay extends DedupOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._decorationsLeft = layoutInfo.decorationsLeft;\n        this._decorationsWidth = layoutInfo.decorationsWidth;\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._decorationsLeft = layoutInfo.decorationsLeft;\n        this._decorationsWidth = layoutInfo.decorationsWidth;\n        return true;\n    }\n    onDecorationsChanged(e) {\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    _getDecorations(ctx) {\n        const decorations = ctx.getDecorationsInViewport();\n        const r = [];\n        let rLen = 0;\n        for (let i = 0, len = decorations.length; i < len; i++) {\n            const d = decorations[i];\n            const linesDecorationsClassName = d.options.linesDecorationsClassName;\n            if (linesDecorationsClassName) {\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.endLineNumber, linesDecorationsClassName);\n            }\n            const firstLineDecorationClassName = d.options.firstLineDecorationClassName;\n            if (firstLineDecorationClassName) {\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.startLineNumber, firstLineDecorationClassName);\n            }\n        }\n        return r;\n    }\n    prepareRender(ctx) {\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const toRender = this._render(visibleStartLineNumber, visibleEndLineNumber, this._getDecorations(ctx));\n        const left = this._decorationsLeft.toString();\n        const width = this._decorationsWidth.toString();\n        const common = '\" style=\"left:' + left + 'px;width:' + width + 'px;\"></div>';\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            const classNames = toRender[lineIndex];\n            let lineOutput = '';\n            for (let i = 0, len = classNames.length; i < len; i++) {\n                lineOutput += '<div class=\"cldr ' + classNames[i] + common;\n            }\n            output[lineIndex] = lineOutput;\n        }\n        this._renderResult = output;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        return this._renderResult[lineNumber - startLineNumber];\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './marginDecorations.css';\nimport { DecorationToRender, DedupOverlay } from '../glyphMargin/glyphMargin.js';\nexport class MarginViewLineDecorationsOverlay extends DedupOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        return true;\n    }\n    onDecorationsChanged(e) {\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    _getDecorations(ctx) {\n        const decorations = ctx.getDecorationsInViewport();\n        const r = [];\n        let rLen = 0;\n        for (let i = 0, len = decorations.length; i < len; i++) {\n            const d = decorations[i];\n            const marginClassName = d.options.marginClassName;\n            if (marginClassName) {\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.endLineNumber, marginClassName);\n            }\n        }\n        return r;\n    }\n    prepareRender(ctx) {\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const toRender = this._render(visibleStartLineNumber, visibleEndLineNumber, this._getDecorations(ctx));\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            const classNames = toRender[lineIndex];\n            let lineOutput = '';\n            for (let i = 0, len = classNames.length; i < len; i++) {\n                lineOutput += '<div class=\"cmdr ' + classNames[i] + '\" style=\"\"></div>';\n            }\n            output[lineIndex] = lineOutput;\n        }\n        this._renderResult = output;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        return this._renderResult[lineNumber - startLineNumber];\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const allCharCodes = (() => {\n    const v = [];\n    for (let i = 32 /* Constants.START_CH_CODE */; i <= 126 /* Constants.END_CH_CODE */; i++) {\n        v.push(i);\n    }\n    v.push(65533 /* Constants.UNKNOWN_CODE */);\n    return v;\n})();\nexport const getCharIndex = (chCode, fontScale) => {\n    chCode -= 32 /* Constants.START_CH_CODE */;\n    if (chCode < 0 || chCode > 96 /* Constants.CHAR_COUNT */) {\n        if (fontScale <= 2) {\n            // for smaller scales, we can get away with using any ASCII character...\n            return (chCode + 96 /* Constants.CHAR_COUNT */) % 96 /* Constants.CHAR_COUNT */;\n        }\n        return 96 /* Constants.CHAR_COUNT */ - 1; // unknown symbol\n    }\n    return chCode;\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { getCharIndex } from './minimapCharSheet.js';\nimport { toUint8 } from '../../../../base/common/uint.js';\nexport class MinimapCharRenderer {\n    constructor(charData, scale) {\n        this.scale = scale;\n        this._minimapCharRendererBrand = undefined;\n        this.charDataNormal = MinimapCharRenderer.soften(charData, 12 / 15);\n        this.charDataLight = MinimapCharRenderer.soften(charData, 50 / 60);\n    }\n    static soften(input, ratio) {\n        const result = new Uint8ClampedArray(input.length);\n        for (let i = 0, len = input.length; i < len; i++) {\n            result[i] = toUint8(input[i] * ratio);\n        }\n        return result;\n    }\n    renderChar(target, dx, dy, chCode, color, foregroundAlpha, backgroundColor, backgroundAlpha, fontScale, useLighterFont, force1pxHeight) {\n        const charWidth = 1 /* Constants.BASE_CHAR_WIDTH */ * this.scale;\n        const charHeight = 2 /* Constants.BASE_CHAR_HEIGHT */ * this.scale;\n        const renderHeight = (force1pxHeight ? 1 : charHeight);\n        if (dx + charWidth > target.width || dy + renderHeight > target.height) {\n            console.warn('bad render request outside image data');\n            return;\n        }\n        const charData = useLighterFont ? this.charDataLight : this.charDataNormal;\n        const charIndex = getCharIndex(chCode, fontScale);\n        const destWidth = target.width * 4 /* Constants.RGBA_CHANNELS_CNT */;\n        const backgroundR = backgroundColor.r;\n        const backgroundG = backgroundColor.g;\n        const backgroundB = backgroundColor.b;\n        const deltaR = color.r - backgroundR;\n        const deltaG = color.g - backgroundG;\n        const deltaB = color.b - backgroundB;\n        const destAlpha = Math.max(foregroundAlpha, backgroundAlpha);\n        const dest = target.data;\n        let sourceOffset = charIndex * charWidth * charHeight;\n        let row = dy * destWidth + dx * 4 /* Constants.RGBA_CHANNELS_CNT */;\n        for (let y = 0; y < renderHeight; y++) {\n            let column = row;\n            for (let x = 0; x < charWidth; x++) {\n                const c = (charData[sourceOffset++] / 255) * (foregroundAlpha / 255);\n                dest[column++] = backgroundR + deltaR * c;\n                dest[column++] = backgroundG + deltaG * c;\n                dest[column++] = backgroundB + deltaB * c;\n                dest[column++] = destAlpha;\n            }\n            row += destWidth;\n        }\n    }\n    blockRenderChar(target, dx, dy, color, foregroundAlpha, backgroundColor, backgroundAlpha, force1pxHeight) {\n        const charWidth = 1 /* Constants.BASE_CHAR_WIDTH */ * this.scale;\n        const charHeight = 2 /* Constants.BASE_CHAR_HEIGHT */ * this.scale;\n        const renderHeight = (force1pxHeight ? 1 : charHeight);\n        if (dx + charWidth > target.width || dy + renderHeight > target.height) {\n            console.warn('bad render request outside image data');\n            return;\n        }\n        const destWidth = target.width * 4 /* Constants.RGBA_CHANNELS_CNT */;\n        const c = 0.5 * (foregroundAlpha / 255);\n        const backgroundR = backgroundColor.r;\n        const backgroundG = backgroundColor.g;\n        const backgroundB = backgroundColor.b;\n        const deltaR = color.r - backgroundR;\n        const deltaG = color.g - backgroundG;\n        const deltaB = color.b - backgroundB;\n        const colorR = backgroundR + deltaR * c;\n        const colorG = backgroundG + deltaG * c;\n        const colorB = backgroundB + deltaB * c;\n        const destAlpha = Math.max(foregroundAlpha, backgroundAlpha);\n        const dest = target.data;\n        let row = dy * destWidth + dx * 4 /* Constants.RGBA_CHANNELS_CNT */;\n        for (let y = 0; y < renderHeight; y++) {\n            let column = row;\n            for (let x = 0; x < charWidth; x++) {\n                dest[column++] = colorR;\n                dest[column++] = colorG;\n                dest[column++] = colorB;\n                dest[column++] = destAlpha;\n            }\n            row += destWidth;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { once } from '../../../../base/common/functional.js';\nconst charTable = {\n    '0': 0,\n    '1': 1,\n    '2': 2,\n    '3': 3,\n    '4': 4,\n    '5': 5,\n    '6': 6,\n    '7': 7,\n    '8': 8,\n    '9': 9,\n    A: 10,\n    B: 11,\n    C: 12,\n    D: 13,\n    E: 14,\n    F: 15\n};\nconst decodeData = (str) => {\n    const output = new Uint8ClampedArray(str.length / 2);\n    for (let i = 0; i < str.length; i += 2) {\n        output[i >> 1] = (charTable[str[i]] << 4) | (charTable[str[i + 1]] & 0xF);\n    }\n    return output;\n};\n/*\nconst encodeData = (data: Uint8ClampedArray, length: string) => {\n    const chars = '0123456789ABCDEF';\n    let output = '';\n    for (let i = 0; i < data.length; i++) {\n        output += chars[data[i] >> 4] + chars[data[i] & 0xf];\n    }\n    return output;\n};\n*/\n/**\n * Map of minimap scales to prebaked sample data at those scales. We don't\n * sample much larger data, because then font family becomes visible, which\n * is use-configurable.\n */\nexport const prebakedMiniMaps = {\n    1: once(() => decodeData('0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792')),\n    2: once(() => decodeData('000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126'))\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { MinimapCharRenderer } from './minimapCharRenderer.js';\nimport { allCharCodes } from './minimapCharSheet.js';\nimport { prebakedMiniMaps } from './minimapPreBaked.js';\nimport { toUint8 } from '../../../../base/common/uint.js';\n/**\n * Creates character renderers. It takes a 'scale' that determines how large\n * characters should be drawn. Using this, it draws data into a canvas and\n * then downsamples the characters as necessary for the current display.\n * This makes rendering more efficient, rather than drawing a full (tiny)\n * font, or downsampling in real-time.\n */\nexport class MinimapCharRendererFactory {\n    /**\n     * Creates a new character renderer factory with the given scale.\n     */\n    static create(scale, fontFamily) {\n        // renderers are immutable. By default we'll 'create' a new minimap\n        // character renderer whenever we switch editors, no need to do extra work.\n        if (this.lastCreated && scale === this.lastCreated.scale && fontFamily === this.lastFontFamily) {\n            return this.lastCreated;\n        }\n        let factory;\n        if (prebakedMiniMaps[scale]) {\n            factory = new MinimapCharRenderer(prebakedMiniMaps[scale](), scale);\n        }\n        else {\n            factory = MinimapCharRendererFactory.createFromSampleData(MinimapCharRendererFactory.createSampleData(fontFamily).data, scale);\n        }\n        this.lastFontFamily = fontFamily;\n        this.lastCreated = factory;\n        return factory;\n    }\n    /**\n     * Creates the font sample data, writing to a canvas.\n     */\n    static createSampleData(fontFamily) {\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        canvas.style.height = `${16 /* Constants.SAMPLED_CHAR_HEIGHT */}px`;\n        canvas.height = 16 /* Constants.SAMPLED_CHAR_HEIGHT */;\n        canvas.width = 96 /* Constants.CHAR_COUNT */ * 10 /* Constants.SAMPLED_CHAR_WIDTH */;\n        canvas.style.width = 96 /* Constants.CHAR_COUNT */ * 10 /* Constants.SAMPLED_CHAR_WIDTH */ + 'px';\n        ctx.fillStyle = '#ffffff';\n        ctx.font = `bold ${16 /* Constants.SAMPLED_CHAR_HEIGHT */}px ${fontFamily}`;\n        ctx.textBaseline = 'middle';\n        let x = 0;\n        for (const code of allCharCodes) {\n            ctx.fillText(String.fromCharCode(code), x, 16 /* Constants.SAMPLED_CHAR_HEIGHT */ / 2);\n            x += 10 /* Constants.SAMPLED_CHAR_WIDTH */;\n        }\n        return ctx.getImageData(0, 0, 96 /* Constants.CHAR_COUNT */ * 10 /* Constants.SAMPLED_CHAR_WIDTH */, 16 /* Constants.SAMPLED_CHAR_HEIGHT */);\n    }\n    /**\n     * Creates a character renderer from the canvas sample data.\n     */\n    static createFromSampleData(source, scale) {\n        const expectedLength = 16 /* Constants.SAMPLED_CHAR_HEIGHT */ * 10 /* Constants.SAMPLED_CHAR_WIDTH */ * 4 /* Constants.RGBA_CHANNELS_CNT */ * 96 /* Constants.CHAR_COUNT */;\n        if (source.length !== expectedLength) {\n            throw new Error('Unexpected source in MinimapCharRenderer');\n        }\n        const charData = MinimapCharRendererFactory._downsample(source, scale);\n        return new MinimapCharRenderer(charData, scale);\n    }\n    static _downsampleChar(source, sourceOffset, dest, destOffset, scale) {\n        const width = 1 /* Constants.BASE_CHAR_WIDTH */ * scale;\n        const height = 2 /* Constants.BASE_CHAR_HEIGHT */ * scale;\n        let targetIndex = destOffset;\n        let brightest = 0;\n        // This is essentially an ad-hoc rescaling algorithm. Standard approaches\n        // like bicubic interpolation are awesome for scaling between image sizes,\n        // but don't work so well when scaling to very small pixel values, we end\n        // up with blurry, indistinct forms.\n        //\n        // The approach taken here is simply mapping each source pixel to the target\n        // pixels, and taking the weighted values for all pixels in each, and then\n        // averaging them out. Finally we apply an intensity boost in _downsample,\n        // since when scaling to the smallest pixel sizes there's more black space\n        // which causes characters to be much less distinct.\n        for (let y = 0; y < height; y++) {\n            // 1. For this destination pixel, get the source pixels we're sampling\n            // from (x1, y1) to the next pixel (x2, y2)\n            const sourceY1 = (y / height) * 16 /* Constants.SAMPLED_CHAR_HEIGHT */;\n            const sourceY2 = ((y + 1) / height) * 16 /* Constants.SAMPLED_CHAR_HEIGHT */;\n            for (let x = 0; x < width; x++) {\n                const sourceX1 = (x / width) * 10 /* Constants.SAMPLED_CHAR_WIDTH */;\n                const sourceX2 = ((x + 1) / width) * 10 /* Constants.SAMPLED_CHAR_WIDTH */;\n                // 2. Sample all of them, summing them up and weighting them. Similar\n                // to bilinear interpolation.\n                let value = 0;\n                let samples = 0;\n                for (let sy = sourceY1; sy < sourceY2; sy++) {\n                    const sourceRow = sourceOffset + Math.floor(sy) * 3840 /* Constants.RGBA_SAMPLED_ROW_WIDTH */;\n                    const yBalance = 1 - (sy - Math.floor(sy));\n                    for (let sx = sourceX1; sx < sourceX2; sx++) {\n                        const xBalance = 1 - (sx - Math.floor(sx));\n                        const sourceIndex = sourceRow + Math.floor(sx) * 4 /* Constants.RGBA_CHANNELS_CNT */;\n                        const weight = xBalance * yBalance;\n                        samples += weight;\n                        value += ((source[sourceIndex] * source[sourceIndex + 3]) / 255) * weight;\n                    }\n                }\n                const final = value / samples;\n                brightest = Math.max(brightest, final);\n                dest[targetIndex++] = toUint8(final);\n            }\n        }\n        return brightest;\n    }\n    static _downsample(data, scale) {\n        const pixelsPerCharacter = 2 /* Constants.BASE_CHAR_HEIGHT */ * scale * 1 /* Constants.BASE_CHAR_WIDTH */ * scale;\n        const resultLen = pixelsPerCharacter * 96 /* Constants.CHAR_COUNT */;\n        const result = new Uint8ClampedArray(resultLen);\n        let resultOffset = 0;\n        let sourceOffset = 0;\n        let brightest = 0;\n        for (let charIndex = 0; charIndex < 96 /* Constants.CHAR_COUNT */; charIndex++) {\n            brightest = Math.max(brightest, this._downsampleChar(data, sourceOffset, result, resultOffset, scale));\n            resultOffset += pixelsPerCharacter;\n            sourceOffset += 10 /* Constants.SAMPLED_CHAR_WIDTH */ * 4 /* Constants.RGBA_CHANNELS_CNT */;\n        }\n        if (brightest > 0) {\n            const adjust = 255 / brightest;\n            for (let i = 0; i < resultLen; i++) {\n                result[i] *= adjust;\n            }\n        }\n        return result;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './minimap.css';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { GlobalPointerMoveMonitor } from '../../../../base/browser/globalPointerMoveMonitor.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { RenderedLinesCollection } from '../../view/viewLayer.js';\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\nimport { MINIMAP_GUTTER_WIDTH, EditorLayoutInfoComputer } from '../../../common/config/editorOptions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { RGBA8 } from '../../../common/core/rgba.js';\nimport { MinimapTokensColorTracker } from '../../../common/viewModel/minimapTokensColorTracker.js';\nimport { ViewModelDecoration } from '../../../common/viewModel.js';\nimport { minimapSelection, minimapBackground, minimapForegroundOpacity } from '../../../../platform/theme/common/colorRegistry.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EventType, Gesture } from '../../../../base/browser/touch.js';\nimport { MinimapCharRendererFactory } from './minimapCharRendererFactory.js';\nimport { MinimapPosition } from '../../../common/model.js';\nimport { once } from '../../../../base/common/functional.js';\n/**\n * The orthogonal distance to the slider at which dragging \"resets\". This implements \"snapping\"\n */\nconst POINTER_DRAG_RESET_DISTANCE = 140;\nconst GUTTER_DECORATION_WIDTH = 2;\nclass MinimapOptions {\n    constructor(configuration, theme, tokensColorTracker) {\n        const options = configuration.options;\n        const pixelRatio = options.get(136 /* EditorOption.pixelRatio */);\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        const minimapLayout = layoutInfo.minimap;\n        const fontInfo = options.get(47 /* EditorOption.fontInfo */);\n        const minimapOpts = options.get(69 /* EditorOption.minimap */);\n        this.renderMinimap = minimapLayout.renderMinimap;\n        this.size = minimapOpts.size;\n        this.minimapHeightIsEditorHeight = minimapLayout.minimapHeightIsEditorHeight;\n        this.scrollBeyondLastLine = options.get(99 /* EditorOption.scrollBeyondLastLine */);\n        this.paddingTop = options.get(80 /* EditorOption.padding */).top;\n        this.paddingBottom = options.get(80 /* EditorOption.padding */).bottom;\n        this.showSlider = minimapOpts.showSlider;\n        this.autohide = minimapOpts.autohide;\n        this.pixelRatio = pixelRatio;\n        this.typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n        this.lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this.minimapLeft = minimapLayout.minimapLeft;\n        this.minimapWidth = minimapLayout.minimapWidth;\n        this.minimapHeight = layoutInfo.height;\n        this.canvasInnerWidth = minimapLayout.minimapCanvasInnerWidth;\n        this.canvasInnerHeight = minimapLayout.minimapCanvasInnerHeight;\n        this.canvasOuterWidth = minimapLayout.minimapCanvasOuterWidth;\n        this.canvasOuterHeight = minimapLayout.minimapCanvasOuterHeight;\n        this.isSampling = minimapLayout.minimapIsSampling;\n        this.editorHeight = layoutInfo.height;\n        this.fontScale = minimapLayout.minimapScale;\n        this.minimapLineHeight = minimapLayout.minimapLineHeight;\n        this.minimapCharWidth = 1 /* Constants.BASE_CHAR_WIDTH */ * this.fontScale;\n        this.charRenderer = once(() => MinimapCharRendererFactory.create(this.fontScale, fontInfo.fontFamily));\n        this.defaultBackgroundColor = tokensColorTracker.getColor(2 /* ColorId.DefaultBackground */);\n        this.backgroundColor = MinimapOptions._getMinimapBackground(theme, this.defaultBackgroundColor);\n        this.foregroundAlpha = MinimapOptions._getMinimapForegroundOpacity(theme);\n    }\n    static _getMinimapBackground(theme, defaultBackgroundColor) {\n        const themeColor = theme.getColor(minimapBackground);\n        if (themeColor) {\n            return new RGBA8(themeColor.rgba.r, themeColor.rgba.g, themeColor.rgba.b, Math.round(255 * themeColor.rgba.a));\n        }\n        return defaultBackgroundColor;\n    }\n    static _getMinimapForegroundOpacity(theme) {\n        const themeColor = theme.getColor(minimapForegroundOpacity);\n        if (themeColor) {\n            return RGBA8._clamp(Math.round(255 * themeColor.rgba.a));\n        }\n        return 255;\n    }\n    equals(other) {\n        return (this.renderMinimap === other.renderMinimap\n            && this.size === other.size\n            && this.minimapHeightIsEditorHeight === other.minimapHeightIsEditorHeight\n            && this.scrollBeyondLastLine === other.scrollBeyondLastLine\n            && this.paddingTop === other.paddingTop\n            && this.paddingBottom === other.paddingBottom\n            && this.showSlider === other.showSlider\n            && this.autohide === other.autohide\n            && this.pixelRatio === other.pixelRatio\n            && this.typicalHalfwidthCharacterWidth === other.typicalHalfwidthCharacterWidth\n            && this.lineHeight === other.lineHeight\n            && this.minimapLeft === other.minimapLeft\n            && this.minimapWidth === other.minimapWidth\n            && this.minimapHeight === other.minimapHeight\n            && this.canvasInnerWidth === other.canvasInnerWidth\n            && this.canvasInnerHeight === other.canvasInnerHeight\n            && this.canvasOuterWidth === other.canvasOuterWidth\n            && this.canvasOuterHeight === other.canvasOuterHeight\n            && this.isSampling === other.isSampling\n            && this.editorHeight === other.editorHeight\n            && this.fontScale === other.fontScale\n            && this.minimapLineHeight === other.minimapLineHeight\n            && this.minimapCharWidth === other.minimapCharWidth\n            && this.defaultBackgroundColor && this.defaultBackgroundColor.equals(other.defaultBackgroundColor)\n            && this.backgroundColor && this.backgroundColor.equals(other.backgroundColor)\n            && this.foregroundAlpha === other.foregroundAlpha);\n    }\n}\nclass MinimapLayout {\n    constructor(\n    /**\n     * The given editor scrollTop (input).\n     */\n    scrollTop, \n    /**\n     * The given editor scrollHeight (input).\n     */\n    scrollHeight, sliderNeeded, _computedSliderRatio, \n    /**\n     * slider dom node top (in CSS px)\n     */\n    sliderTop, \n    /**\n     * slider dom node height (in CSS px)\n     */\n    sliderHeight, \n    /**\n     * empty lines to reserve at the top of the minimap.\n     */\n    topPaddingLineCount, \n    /**\n     * minimap render start line number.\n     */\n    startLineNumber, \n    /**\n     * minimap render end line number.\n     */\n    endLineNumber) {\n        this.scrollTop = scrollTop;\n        this.scrollHeight = scrollHeight;\n        this.sliderNeeded = sliderNeeded;\n        this._computedSliderRatio = _computedSliderRatio;\n        this.sliderTop = sliderTop;\n        this.sliderHeight = sliderHeight;\n        this.topPaddingLineCount = topPaddingLineCount;\n        this.startLineNumber = startLineNumber;\n        this.endLineNumber = endLineNumber;\n    }\n    /**\n     * Compute a desired `scrollPosition` such that the slider moves by `delta`.\n     */\n    getDesiredScrollTopFromDelta(delta) {\n        return Math.round(this.scrollTop + delta / this._computedSliderRatio);\n    }\n    getDesiredScrollTopFromTouchLocation(pageY) {\n        return Math.round((pageY - this.sliderHeight / 2) / this._computedSliderRatio);\n    }\n    /**\n     * Intersect a line range with `this.startLineNumber` and `this.endLineNumber`.\n     */\n    intersectWithViewport(range) {\n        const startLineNumber = Math.max(this.startLineNumber, range.startLineNumber);\n        const endLineNumber = Math.min(this.endLineNumber, range.endLineNumber);\n        if (startLineNumber > endLineNumber) {\n            // entirely outside minimap's viewport\n            return null;\n        }\n        return [startLineNumber, endLineNumber];\n    }\n    /**\n     * Get the inner minimap y coordinate for a line number.\n     */\n    getYForLineNumber(lineNumber, minimapLineHeight) {\n        return +(lineNumber - this.startLineNumber + this.topPaddingLineCount) * minimapLineHeight;\n    }\n    static create(options, viewportStartLineNumber, viewportEndLineNumber, viewportStartLineNumberVerticalOffset, viewportHeight, viewportContainsWhitespaceGaps, lineCount, realLineCount, scrollTop, scrollHeight, previousLayout) {\n        const pixelRatio = options.pixelRatio;\n        const minimapLineHeight = options.minimapLineHeight;\n        const minimapLinesFitting = Math.floor(options.canvasInnerHeight / minimapLineHeight);\n        const lineHeight = options.lineHeight;\n        if (options.minimapHeightIsEditorHeight) {\n            let logicalScrollHeight = (realLineCount * options.lineHeight\n                + options.paddingTop\n                + options.paddingBottom);\n            if (options.scrollBeyondLastLine) {\n                logicalScrollHeight += Math.max(0, viewportHeight - options.lineHeight - options.paddingBottom);\n            }\n            const sliderHeight = Math.max(1, Math.floor(viewportHeight * viewportHeight / logicalScrollHeight));\n            const maxMinimapSliderTop = Math.max(0, options.minimapHeight - sliderHeight);\n            // The slider can move from 0 to `maxMinimapSliderTop`\n            // in the same way `scrollTop` can move from 0 to `scrollHeight` - `viewportHeight`.\n            const computedSliderRatio = (maxMinimapSliderTop) / (scrollHeight - viewportHeight);\n            const sliderTop = (scrollTop * computedSliderRatio);\n            const sliderNeeded = (maxMinimapSliderTop > 0);\n            const maxLinesFitting = Math.floor(options.canvasInnerHeight / options.minimapLineHeight);\n            const topPaddingLineCount = Math.floor(options.paddingTop / options.lineHeight);\n            return new MinimapLayout(scrollTop, scrollHeight, sliderNeeded, computedSliderRatio, sliderTop, sliderHeight, topPaddingLineCount, 1, Math.min(lineCount, maxLinesFitting));\n        }\n        // The visible line count in a viewport can change due to a number of reasons:\n        //  a) with the same viewport width, different scroll positions can result in partial lines being visible:\n        //    e.g. for a line height of 20, and a viewport height of 600\n        //          * scrollTop = 0  => visible lines are [1, 30]\n        //          * scrollTop = 10 => visible lines are [1, 31] (with lines 1 and 31 partially visible)\n        //          * scrollTop = 20 => visible lines are [2, 31]\n        //  b) whitespace gaps might make their way in the viewport (which results in a decrease in the visible line count)\n        //  c) we could be in the scroll beyond last line case (which also results in a decrease in the visible line count, down to possibly only one line being visible)\n        // We must first establish a desirable slider height.\n        let sliderHeight;\n        if (viewportContainsWhitespaceGaps && viewportEndLineNumber !== lineCount) {\n            // case b) from above: there are whitespace gaps in the viewport.\n            // In this case, the height of the slider directly reflects the visible line count.\n            const viewportLineCount = viewportEndLineNumber - viewportStartLineNumber + 1;\n            sliderHeight = Math.floor(viewportLineCount * minimapLineHeight / pixelRatio);\n        }\n        else {\n            // The slider has a stable height\n            const expectedViewportLineCount = viewportHeight / lineHeight;\n            sliderHeight = Math.floor(expectedViewportLineCount * minimapLineHeight / pixelRatio);\n        }\n        const extraLinesAtTheTop = Math.floor(options.paddingTop / lineHeight);\n        let extraLinesAtTheBottom = Math.floor(options.paddingBottom / lineHeight);\n        if (options.scrollBeyondLastLine) {\n            const expectedViewportLineCount = viewportHeight / lineHeight;\n            extraLinesAtTheBottom = Math.max(extraLinesAtTheBottom, expectedViewportLineCount - 1);\n        }\n        let maxMinimapSliderTop;\n        if (extraLinesAtTheBottom > 0) {\n            const expectedViewportLineCount = viewportHeight / lineHeight;\n            // The minimap slider, when dragged all the way down, will contain the last line at its top\n            maxMinimapSliderTop = (extraLinesAtTheTop + lineCount + extraLinesAtTheBottom - expectedViewportLineCount - 1) * minimapLineHeight / pixelRatio;\n        }\n        else {\n            // The minimap slider, when dragged all the way down, will contain the last line at its bottom\n            maxMinimapSliderTop = Math.max(0, (extraLinesAtTheTop + lineCount) * minimapLineHeight / pixelRatio - sliderHeight);\n        }\n        maxMinimapSliderTop = Math.min(options.minimapHeight - sliderHeight, maxMinimapSliderTop);\n        // The slider can move from 0 to `maxMinimapSliderTop`\n        // in the same way `scrollTop` can move from 0 to `scrollHeight` - `viewportHeight`.\n        const computedSliderRatio = (maxMinimapSliderTop) / (scrollHeight - viewportHeight);\n        const sliderTop = (scrollTop * computedSliderRatio);\n        if (minimapLinesFitting >= extraLinesAtTheTop + lineCount + extraLinesAtTheBottom) {\n            // All lines fit in the minimap\n            const sliderNeeded = (maxMinimapSliderTop > 0);\n            return new MinimapLayout(scrollTop, scrollHeight, sliderNeeded, computedSliderRatio, sliderTop, sliderHeight, extraLinesAtTheTop, 1, lineCount);\n        }\n        else {\n            let consideringStartLineNumber;\n            if (viewportStartLineNumber > 1) {\n                consideringStartLineNumber = viewportStartLineNumber + extraLinesAtTheTop;\n            }\n            else {\n                consideringStartLineNumber = Math.max(1, scrollTop / lineHeight);\n            }\n            let topPaddingLineCount;\n            let startLineNumber = Math.max(1, Math.floor(consideringStartLineNumber - sliderTop * pixelRatio / minimapLineHeight));\n            if (startLineNumber < extraLinesAtTheTop) {\n                topPaddingLineCount = extraLinesAtTheTop - startLineNumber + 1;\n                startLineNumber = 1;\n            }\n            else {\n                topPaddingLineCount = 0;\n                startLineNumber = Math.max(1, startLineNumber - extraLinesAtTheTop);\n            }\n            // Avoid flickering caused by a partial viewport start line\n            // by being consistent w.r.t. the previous layout decision\n            if (previousLayout && previousLayout.scrollHeight === scrollHeight) {\n                if (previousLayout.scrollTop > scrollTop) {\n                    // Scrolling up => never increase `startLineNumber`\n                    startLineNumber = Math.min(startLineNumber, previousLayout.startLineNumber);\n                    topPaddingLineCount = Math.max(topPaddingLineCount, previousLayout.topPaddingLineCount);\n                }\n                if (previousLayout.scrollTop < scrollTop) {\n                    // Scrolling down => never decrease `startLineNumber`\n                    startLineNumber = Math.max(startLineNumber, previousLayout.startLineNumber);\n                    topPaddingLineCount = Math.min(topPaddingLineCount, previousLayout.topPaddingLineCount);\n                }\n            }\n            const endLineNumber = Math.min(lineCount, startLineNumber - topPaddingLineCount + minimapLinesFitting - 1);\n            const partialLine = (scrollTop - viewportStartLineNumberVerticalOffset) / lineHeight;\n            let sliderTopAligned;\n            if (scrollTop > options.paddingTop) {\n                sliderTopAligned = (viewportStartLineNumber - startLineNumber + topPaddingLineCount + partialLine) * minimapLineHeight / pixelRatio;\n            }\n            else {\n                sliderTopAligned = (scrollTop / options.paddingTop) * (topPaddingLineCount + partialLine) * minimapLineHeight / pixelRatio;\n            }\n            return new MinimapLayout(scrollTop, scrollHeight, true, computedSliderRatio, sliderTopAligned, sliderHeight, topPaddingLineCount, startLineNumber, endLineNumber);\n        }\n    }\n}\nclass MinimapLine {\n    constructor(dy) {\n        this.dy = dy;\n    }\n    onContentChanged() {\n        this.dy = -1;\n    }\n    onTokensChanged() {\n        this.dy = -1;\n    }\n}\nMinimapLine.INVALID = new MinimapLine(-1);\nclass RenderData {\n    constructor(renderedLayout, imageData, lines) {\n        this.renderedLayout = renderedLayout;\n        this._imageData = imageData;\n        this._renderedLines = new RenderedLinesCollection(() => MinimapLine.INVALID);\n        this._renderedLines._set(renderedLayout.startLineNumber, lines);\n    }\n    /**\n     * Check if the current RenderData matches accurately the new desired layout and no painting is needed.\n     */\n    linesEquals(layout) {\n        if (!this.scrollEquals(layout)) {\n            return false;\n        }\n        const tmp = this._renderedLines._get();\n        const lines = tmp.lines;\n        for (let i = 0, len = lines.length; i < len; i++) {\n            if (lines[i].dy === -1) {\n                // This line is invalid\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Check if the current RenderData matches the new layout's scroll position\n     */\n    scrollEquals(layout) {\n        return this.renderedLayout.startLineNumber === layout.startLineNumber\n            && this.renderedLayout.endLineNumber === layout.endLineNumber;\n    }\n    _get() {\n        const tmp = this._renderedLines._get();\n        return {\n            imageData: this._imageData,\n            rendLineNumberStart: tmp.rendLineNumberStart,\n            lines: tmp.lines\n        };\n    }\n    onLinesChanged(changeFromLineNumber, changeCount) {\n        return this._renderedLines.onLinesChanged(changeFromLineNumber, changeCount);\n    }\n    onLinesDeleted(deleteFromLineNumber, deleteToLineNumber) {\n        this._renderedLines.onLinesDeleted(deleteFromLineNumber, deleteToLineNumber);\n    }\n    onLinesInserted(insertFromLineNumber, insertToLineNumber) {\n        this._renderedLines.onLinesInserted(insertFromLineNumber, insertToLineNumber);\n    }\n    onTokensChanged(ranges) {\n        return this._renderedLines.onTokensChanged(ranges);\n    }\n}\n/**\n * Some sort of double buffering.\n *\n * Keeps two buffers around that will be rotated for painting.\n * Always gives a buffer that is filled with the background color.\n */\nclass MinimapBuffers {\n    constructor(ctx, WIDTH, HEIGHT, background) {\n        this._backgroundFillData = MinimapBuffers._createBackgroundFillData(WIDTH, HEIGHT, background);\n        this._buffers = [\n            ctx.createImageData(WIDTH, HEIGHT),\n            ctx.createImageData(WIDTH, HEIGHT)\n        ];\n        this._lastUsedBuffer = 0;\n    }\n    getBuffer() {\n        // rotate buffers\n        this._lastUsedBuffer = 1 - this._lastUsedBuffer;\n        const result = this._buffers[this._lastUsedBuffer];\n        // fill with background color\n        result.data.set(this._backgroundFillData);\n        return result;\n    }\n    static _createBackgroundFillData(WIDTH, HEIGHT, background) {\n        const backgroundR = background.r;\n        const backgroundG = background.g;\n        const backgroundB = background.b;\n        const backgroundA = background.a;\n        const result = new Uint8ClampedArray(WIDTH * HEIGHT * 4);\n        let offset = 0;\n        for (let i = 0; i < HEIGHT; i++) {\n            for (let j = 0; j < WIDTH; j++) {\n                result[offset] = backgroundR;\n                result[offset + 1] = backgroundG;\n                result[offset + 2] = backgroundB;\n                result[offset + 3] = backgroundA;\n                offset += 4;\n            }\n        }\n        return result;\n    }\n}\nclass MinimapSamplingState {\n    static compute(options, viewLineCount, oldSamplingState) {\n        if (options.renderMinimap === 0 /* RenderMinimap.None */ || !options.isSampling) {\n            return [null, []];\n        }\n        // ratio is intentionally not part of the layout to avoid the layout changing all the time\n        // so we need to recompute it again...\n        const { minimapLineCount } = EditorLayoutInfoComputer.computeContainedMinimapLineCount({\n            viewLineCount: viewLineCount,\n            scrollBeyondLastLine: options.scrollBeyondLastLine,\n            paddingTop: options.paddingTop,\n            paddingBottom: options.paddingBottom,\n            height: options.editorHeight,\n            lineHeight: options.lineHeight,\n            pixelRatio: options.pixelRatio\n        });\n        const ratio = viewLineCount / minimapLineCount;\n        const halfRatio = ratio / 2;\n        if (!oldSamplingState || oldSamplingState.minimapLines.length === 0) {\n            const result = [];\n            result[0] = 1;\n            if (minimapLineCount > 1) {\n                for (let i = 0, lastIndex = minimapLineCount - 1; i < lastIndex; i++) {\n                    result[i] = Math.round(i * ratio + halfRatio);\n                }\n                result[minimapLineCount - 1] = viewLineCount;\n            }\n            return [new MinimapSamplingState(ratio, result), []];\n        }\n        const oldMinimapLines = oldSamplingState.minimapLines;\n        const oldLength = oldMinimapLines.length;\n        const result = [];\n        let oldIndex = 0;\n        let oldDeltaLineCount = 0;\n        let minViewLineNumber = 1;\n        const MAX_EVENT_COUNT = 10; // generate at most 10 events, if there are more than 10 changes, just flush all previous data\n        let events = [];\n        let lastEvent = null;\n        for (let i = 0; i < minimapLineCount; i++) {\n            const fromViewLineNumber = Math.max(minViewLineNumber, Math.round(i * ratio));\n            const toViewLineNumber = Math.max(fromViewLineNumber, Math.round((i + 1) * ratio));\n            while (oldIndex < oldLength && oldMinimapLines[oldIndex] < fromViewLineNumber) {\n                if (events.length < MAX_EVENT_COUNT) {\n                    const oldMinimapLineNumber = oldIndex + 1 + oldDeltaLineCount;\n                    if (lastEvent && lastEvent.type === 'deleted' && lastEvent._oldIndex === oldIndex - 1) {\n                        lastEvent.deleteToLineNumber++;\n                    }\n                    else {\n                        lastEvent = { type: 'deleted', _oldIndex: oldIndex, deleteFromLineNumber: oldMinimapLineNumber, deleteToLineNumber: oldMinimapLineNumber };\n                        events.push(lastEvent);\n                    }\n                    oldDeltaLineCount--;\n                }\n                oldIndex++;\n            }\n            let selectedViewLineNumber;\n            if (oldIndex < oldLength && oldMinimapLines[oldIndex] <= toViewLineNumber) {\n                // reuse the old sampled line\n                selectedViewLineNumber = oldMinimapLines[oldIndex];\n                oldIndex++;\n            }\n            else {\n                if (i === 0) {\n                    selectedViewLineNumber = 1;\n                }\n                else if (i + 1 === minimapLineCount) {\n                    selectedViewLineNumber = viewLineCount;\n                }\n                else {\n                    selectedViewLineNumber = Math.round(i * ratio + halfRatio);\n                }\n                if (events.length < MAX_EVENT_COUNT) {\n                    const oldMinimapLineNumber = oldIndex + 1 + oldDeltaLineCount;\n                    if (lastEvent && lastEvent.type === 'inserted' && lastEvent._i === i - 1) {\n                        lastEvent.insertToLineNumber++;\n                    }\n                    else {\n                        lastEvent = { type: 'inserted', _i: i, insertFromLineNumber: oldMinimapLineNumber, insertToLineNumber: oldMinimapLineNumber };\n                        events.push(lastEvent);\n                    }\n                    oldDeltaLineCount++;\n                }\n            }\n            result[i] = selectedViewLineNumber;\n            minViewLineNumber = selectedViewLineNumber;\n        }\n        if (events.length < MAX_EVENT_COUNT) {\n            while (oldIndex < oldLength) {\n                const oldMinimapLineNumber = oldIndex + 1 + oldDeltaLineCount;\n                if (lastEvent && lastEvent.type === 'deleted' && lastEvent._oldIndex === oldIndex - 1) {\n                    lastEvent.deleteToLineNumber++;\n                }\n                else {\n                    lastEvent = { type: 'deleted', _oldIndex: oldIndex, deleteFromLineNumber: oldMinimapLineNumber, deleteToLineNumber: oldMinimapLineNumber };\n                    events.push(lastEvent);\n                }\n                oldDeltaLineCount--;\n                oldIndex++;\n            }\n        }\n        else {\n            // too many events, just give up\n            events = [{ type: 'flush' }];\n        }\n        return [new MinimapSamplingState(ratio, result), events];\n    }\n    constructor(samplingRatio, minimapLines) {\n        this.samplingRatio = samplingRatio;\n        this.minimapLines = minimapLines;\n    }\n    modelLineToMinimapLine(lineNumber) {\n        return Math.min(this.minimapLines.length, Math.max(1, Math.round(lineNumber / this.samplingRatio)));\n    }\n    /**\n     * Will return null if the model line ranges are not intersecting with a sampled model line.\n     */\n    modelLineRangeToMinimapLineRange(fromLineNumber, toLineNumber) {\n        let fromLineIndex = this.modelLineToMinimapLine(fromLineNumber) - 1;\n        while (fromLineIndex > 0 && this.minimapLines[fromLineIndex - 1] >= fromLineNumber) {\n            fromLineIndex--;\n        }\n        let toLineIndex = this.modelLineToMinimapLine(toLineNumber) - 1;\n        while (toLineIndex + 1 < this.minimapLines.length && this.minimapLines[toLineIndex + 1] <= toLineNumber) {\n            toLineIndex++;\n        }\n        if (fromLineIndex === toLineIndex) {\n            const sampledLineNumber = this.minimapLines[fromLineIndex];\n            if (sampledLineNumber < fromLineNumber || sampledLineNumber > toLineNumber) {\n                // This line is not part of the sampled lines ==> nothing to do\n                return null;\n            }\n        }\n        return [fromLineIndex + 1, toLineIndex + 1];\n    }\n    /**\n     * Will always return a range, even if it is not intersecting with a sampled model line.\n     */\n    decorationLineRangeToMinimapLineRange(startLineNumber, endLineNumber) {\n        let minimapLineStart = this.modelLineToMinimapLine(startLineNumber);\n        let minimapLineEnd = this.modelLineToMinimapLine(endLineNumber);\n        if (startLineNumber !== endLineNumber && minimapLineEnd === minimapLineStart) {\n            if (minimapLineEnd === this.minimapLines.length) {\n                if (minimapLineStart > 1) {\n                    minimapLineStart--;\n                }\n            }\n            else {\n                minimapLineEnd++;\n            }\n        }\n        return [minimapLineStart, minimapLineEnd];\n    }\n    onLinesDeleted(e) {\n        // have the mapping be sticky\n        const deletedLineCount = e.toLineNumber - e.fromLineNumber + 1;\n        let changeStartIndex = this.minimapLines.length;\n        let changeEndIndex = 0;\n        for (let i = this.minimapLines.length - 1; i >= 0; i--) {\n            if (this.minimapLines[i] < e.fromLineNumber) {\n                break;\n            }\n            if (this.minimapLines[i] <= e.toLineNumber) {\n                // this line got deleted => move to previous available\n                this.minimapLines[i] = Math.max(1, e.fromLineNumber - 1);\n                changeStartIndex = Math.min(changeStartIndex, i);\n                changeEndIndex = Math.max(changeEndIndex, i);\n            }\n            else {\n                this.minimapLines[i] -= deletedLineCount;\n            }\n        }\n        return [changeStartIndex, changeEndIndex];\n    }\n    onLinesInserted(e) {\n        // have the mapping be sticky\n        const insertedLineCount = e.toLineNumber - e.fromLineNumber + 1;\n        for (let i = this.minimapLines.length - 1; i >= 0; i--) {\n            if (this.minimapLines[i] < e.fromLineNumber) {\n                break;\n            }\n            this.minimapLines[i] += insertedLineCount;\n        }\n    }\n}\nexport class Minimap extends ViewPart {\n    constructor(context) {\n        super(context);\n        this.tokensColorTracker = MinimapTokensColorTracker.getInstance();\n        this._selections = [];\n        this._minimapSelections = null;\n        this.options = new MinimapOptions(this._context.configuration, this._context.theme, this.tokensColorTracker);\n        const [samplingState,] = MinimapSamplingState.compute(this.options, this._context.viewModel.getLineCount(), null);\n        this._samplingState = samplingState;\n        this._shouldCheckSampling = false;\n        this._actual = new InnerMinimap(context.theme, this);\n    }\n    dispose() {\n        this._actual.dispose();\n        super.dispose();\n    }\n    getDomNode() {\n        return this._actual.getDomNode();\n    }\n    _onOptionsMaybeChanged() {\n        const opts = new MinimapOptions(this._context.configuration, this._context.theme, this.tokensColorTracker);\n        if (this.options.equals(opts)) {\n            return false;\n        }\n        this.options = opts;\n        this._recreateLineSampling();\n        this._actual.onDidChangeOptions();\n        return true;\n    }\n    // ---- begin view event handlers\n    onConfigurationChanged(e) {\n        return this._onOptionsMaybeChanged();\n    }\n    onCursorStateChanged(e) {\n        this._selections = e.selections;\n        this._minimapSelections = null;\n        return this._actual.onSelectionChanged();\n    }\n    onDecorationsChanged(e) {\n        if (e.affectsMinimap) {\n            return this._actual.onDecorationsChanged();\n        }\n        return false;\n    }\n    onFlushed(e) {\n        if (this._samplingState) {\n            this._shouldCheckSampling = true;\n        }\n        return this._actual.onFlushed();\n    }\n    onLinesChanged(e) {\n        if (this._samplingState) {\n            const minimapLineRange = this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber, e.fromLineNumber + e.count - 1);\n            if (minimapLineRange) {\n                return this._actual.onLinesChanged(minimapLineRange[0], minimapLineRange[1] - minimapLineRange[0] + 1);\n            }\n            else {\n                return false;\n            }\n        }\n        else {\n            return this._actual.onLinesChanged(e.fromLineNumber, e.count);\n        }\n    }\n    onLinesDeleted(e) {\n        if (this._samplingState) {\n            const [changeStartIndex, changeEndIndex] = this._samplingState.onLinesDeleted(e);\n            if (changeStartIndex <= changeEndIndex) {\n                this._actual.onLinesChanged(changeStartIndex + 1, changeEndIndex - changeStartIndex + 1);\n            }\n            this._shouldCheckSampling = true;\n            return true;\n        }\n        else {\n            return this._actual.onLinesDeleted(e.fromLineNumber, e.toLineNumber);\n        }\n    }\n    onLinesInserted(e) {\n        if (this._samplingState) {\n            this._samplingState.onLinesInserted(e);\n            this._shouldCheckSampling = true;\n            return true;\n        }\n        else {\n            return this._actual.onLinesInserted(e.fromLineNumber, e.toLineNumber);\n        }\n    }\n    onScrollChanged(e) {\n        return this._actual.onScrollChanged();\n    }\n    onThemeChanged(e) {\n        this._actual.onThemeChanged();\n        this._onOptionsMaybeChanged();\n        return true;\n    }\n    onTokensChanged(e) {\n        if (this._samplingState) {\n            const ranges = [];\n            for (const range of e.ranges) {\n                const minimapLineRange = this._samplingState.modelLineRangeToMinimapLineRange(range.fromLineNumber, range.toLineNumber);\n                if (minimapLineRange) {\n                    ranges.push({ fromLineNumber: minimapLineRange[0], toLineNumber: minimapLineRange[1] });\n                }\n            }\n            if (ranges.length) {\n                return this._actual.onTokensChanged(ranges);\n            }\n            else {\n                return false;\n            }\n        }\n        else {\n            return this._actual.onTokensChanged(e.ranges);\n        }\n    }\n    onTokensColorsChanged(e) {\n        this._onOptionsMaybeChanged();\n        return this._actual.onTokensColorsChanged();\n    }\n    onZonesChanged(e) {\n        return this._actual.onZonesChanged();\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        if (this._shouldCheckSampling) {\n            this._shouldCheckSampling = false;\n            this._recreateLineSampling();\n        }\n    }\n    render(ctx) {\n        let viewportStartLineNumber = ctx.visibleRange.startLineNumber;\n        let viewportEndLineNumber = ctx.visibleRange.endLineNumber;\n        if (this._samplingState) {\n            viewportStartLineNumber = this._samplingState.modelLineToMinimapLine(viewportStartLineNumber);\n            viewportEndLineNumber = this._samplingState.modelLineToMinimapLine(viewportEndLineNumber);\n        }\n        const minimapCtx = {\n            viewportContainsWhitespaceGaps: (ctx.viewportData.whitespaceViewportData.length > 0),\n            scrollWidth: ctx.scrollWidth,\n            scrollHeight: ctx.scrollHeight,\n            viewportStartLineNumber: viewportStartLineNumber,\n            viewportEndLineNumber: viewportEndLineNumber,\n            viewportStartLineNumberVerticalOffset: ctx.getVerticalOffsetForLineNumber(viewportStartLineNumber),\n            scrollTop: ctx.scrollTop,\n            scrollLeft: ctx.scrollLeft,\n            viewportWidth: ctx.viewportWidth,\n            viewportHeight: ctx.viewportHeight,\n        };\n        this._actual.render(minimapCtx);\n    }\n    //#region IMinimapModel\n    _recreateLineSampling() {\n        this._minimapSelections = null;\n        const wasSampling = Boolean(this._samplingState);\n        const [samplingState, events] = MinimapSamplingState.compute(this.options, this._context.viewModel.getLineCount(), this._samplingState);\n        this._samplingState = samplingState;\n        if (wasSampling && this._samplingState) {\n            // was sampling, is sampling\n            for (const event of events) {\n                switch (event.type) {\n                    case 'deleted':\n                        this._actual.onLinesDeleted(event.deleteFromLineNumber, event.deleteToLineNumber);\n                        break;\n                    case 'inserted':\n                        this._actual.onLinesInserted(event.insertFromLineNumber, event.insertToLineNumber);\n                        break;\n                    case 'flush':\n                        this._actual.onFlushed();\n                        break;\n                }\n            }\n        }\n    }\n    getLineCount() {\n        if (this._samplingState) {\n            return this._samplingState.minimapLines.length;\n        }\n        return this._context.viewModel.getLineCount();\n    }\n    getRealLineCount() {\n        return this._context.viewModel.getLineCount();\n    }\n    getLineContent(lineNumber) {\n        if (this._samplingState) {\n            return this._context.viewModel.getLineContent(this._samplingState.minimapLines[lineNumber - 1]);\n        }\n        return this._context.viewModel.getLineContent(lineNumber);\n    }\n    getLineMaxColumn(lineNumber) {\n        if (this._samplingState) {\n            return this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[lineNumber - 1]);\n        }\n        return this._context.viewModel.getLineMaxColumn(lineNumber);\n    }\n    getMinimapLinesRenderingData(startLineNumber, endLineNumber, needed) {\n        if (this._samplingState) {\n            const result = [];\n            for (let lineIndex = 0, lineCount = endLineNumber - startLineNumber + 1; lineIndex < lineCount; lineIndex++) {\n                if (needed[lineIndex]) {\n                    result[lineIndex] = this._context.viewModel.getViewLineData(this._samplingState.minimapLines[startLineNumber + lineIndex - 1]);\n                }\n                else {\n                    result[lineIndex] = null;\n                }\n            }\n            return result;\n        }\n        return this._context.viewModel.getMinimapLinesRenderingData(startLineNumber, endLineNumber, needed).data;\n    }\n    getSelections() {\n        if (this._minimapSelections === null) {\n            if (this._samplingState) {\n                this._minimapSelections = [];\n                for (const selection of this._selections) {\n                    const [minimapLineStart, minimapLineEnd] = this._samplingState.decorationLineRangeToMinimapLineRange(selection.startLineNumber, selection.endLineNumber);\n                    this._minimapSelections.push(new Selection(minimapLineStart, selection.startColumn, minimapLineEnd, selection.endColumn));\n                }\n            }\n            else {\n                this._minimapSelections = this._selections;\n            }\n        }\n        return this._minimapSelections;\n    }\n    getMinimapDecorationsInViewport(startLineNumber, endLineNumber) {\n        let visibleRange;\n        if (this._samplingState) {\n            const modelStartLineNumber = this._samplingState.minimapLines[startLineNumber - 1];\n            const modelEndLineNumber = this._samplingState.minimapLines[endLineNumber - 1];\n            visibleRange = new Range(modelStartLineNumber, 1, modelEndLineNumber, this._context.viewModel.getLineMaxColumn(modelEndLineNumber));\n        }\n        else {\n            visibleRange = new Range(startLineNumber, 1, endLineNumber, this._context.viewModel.getLineMaxColumn(endLineNumber));\n        }\n        const decorations = this._context.viewModel.getDecorationsInViewport(visibleRange, true);\n        if (this._samplingState) {\n            const result = [];\n            for (const decoration of decorations) {\n                if (!decoration.options.minimap) {\n                    continue;\n                }\n                const range = decoration.range;\n                const minimapStartLineNumber = this._samplingState.modelLineToMinimapLine(range.startLineNumber);\n                const minimapEndLineNumber = this._samplingState.modelLineToMinimapLine(range.endLineNumber);\n                result.push(new ViewModelDecoration(new Range(minimapStartLineNumber, range.startColumn, minimapEndLineNumber, range.endColumn), decoration.options));\n            }\n            return result;\n        }\n        return decorations;\n    }\n    getOptions() {\n        return this._context.viewModel.model.getOptions();\n    }\n    revealLineNumber(lineNumber) {\n        if (this._samplingState) {\n            lineNumber = this._samplingState.minimapLines[lineNumber - 1];\n        }\n        this._context.viewModel.revealRange('mouse', false, new Range(lineNumber, 1, lineNumber, 1), 1 /* viewEvents.VerticalRevealType.Center */, 0 /* ScrollType.Smooth */);\n    }\n    setScrollTop(scrollTop) {\n        this._context.viewModel.viewLayout.setScrollPosition({\n            scrollTop: scrollTop\n        }, 1 /* ScrollType.Immediate */);\n    }\n}\nclass InnerMinimap extends Disposable {\n    constructor(theme, model) {\n        super();\n        this._renderDecorations = false;\n        this._gestureInProgress = false;\n        this._theme = theme;\n        this._model = model;\n        this._lastRenderData = null;\n        this._buffers = null;\n        this._selectionColor = this._theme.getColor(minimapSelection);\n        this._domNode = createFastDomNode(document.createElement('div'));\n        PartFingerprints.write(this._domNode, 8 /* PartFingerprint.Minimap */);\n        this._domNode.setClassName(this._getMinimapDomNodeClassName());\n        this._domNode.setPosition('absolute');\n        this._domNode.setAttribute('role', 'presentation');\n        this._domNode.setAttribute('aria-hidden', 'true');\n        this._shadow = createFastDomNode(document.createElement('div'));\n        this._shadow.setClassName('minimap-shadow-hidden');\n        this._domNode.appendChild(this._shadow);\n        this._canvas = createFastDomNode(document.createElement('canvas'));\n        this._canvas.setPosition('absolute');\n        this._canvas.setLeft(0);\n        this._domNode.appendChild(this._canvas);\n        this._decorationsCanvas = createFastDomNode(document.createElement('canvas'));\n        this._decorationsCanvas.setPosition('absolute');\n        this._decorationsCanvas.setClassName('minimap-decorations-layer');\n        this._decorationsCanvas.setLeft(0);\n        this._domNode.appendChild(this._decorationsCanvas);\n        this._slider = createFastDomNode(document.createElement('div'));\n        this._slider.setPosition('absolute');\n        this._slider.setClassName('minimap-slider');\n        this._slider.setLayerHinting(true);\n        this._slider.setContain('strict');\n        this._domNode.appendChild(this._slider);\n        this._sliderHorizontal = createFastDomNode(document.createElement('div'));\n        this._sliderHorizontal.setPosition('absolute');\n        this._sliderHorizontal.setClassName('minimap-slider-horizontal');\n        this._slider.appendChild(this._sliderHorizontal);\n        this._applyLayout();\n        this._pointerDownListener = dom.addStandardDisposableListener(this._domNode.domNode, dom.EventType.POINTER_DOWN, (e) => {\n            e.preventDefault();\n            const renderMinimap = this._model.options.renderMinimap;\n            if (renderMinimap === 0 /* RenderMinimap.None */) {\n                return;\n            }\n            if (!this._lastRenderData) {\n                return;\n            }\n            if (this._model.options.size !== 'proportional') {\n                if (e.button === 0 && this._lastRenderData) {\n                    // pretend the click occurred in the center of the slider\n                    const position = dom.getDomNodePagePosition(this._slider.domNode);\n                    const initialPosY = position.top + position.height / 2;\n                    this._startSliderDragging(e, initialPosY, this._lastRenderData.renderedLayout);\n                }\n                return;\n            }\n            const minimapLineHeight = this._model.options.minimapLineHeight;\n            const internalOffsetY = (this._model.options.canvasInnerHeight / this._model.options.canvasOuterHeight) * e.offsetY;\n            const lineIndex = Math.floor(internalOffsetY / minimapLineHeight);\n            let lineNumber = lineIndex + this._lastRenderData.renderedLayout.startLineNumber - this._lastRenderData.renderedLayout.topPaddingLineCount;\n            lineNumber = Math.min(lineNumber, this._model.getLineCount());\n            this._model.revealLineNumber(lineNumber);\n        });\n        this._sliderPointerMoveMonitor = new GlobalPointerMoveMonitor();\n        this._sliderPointerDownListener = dom.addStandardDisposableListener(this._slider.domNode, dom.EventType.POINTER_DOWN, (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            if (e.button === 0 && this._lastRenderData) {\n                this._startSliderDragging(e, e.pageY, this._lastRenderData.renderedLayout);\n            }\n        });\n        this._gestureDisposable = Gesture.addTarget(this._domNode.domNode);\n        this._sliderTouchStartListener = dom.addDisposableListener(this._domNode.domNode, EventType.Start, (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            if (this._lastRenderData) {\n                this._slider.toggleClassName('active', true);\n                this._gestureInProgress = true;\n                this.scrollDueToTouchEvent(e);\n            }\n        }, { passive: false });\n        this._sliderTouchMoveListener = dom.addDisposableListener(this._domNode.domNode, EventType.Change, (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            if (this._lastRenderData && this._gestureInProgress) {\n                this.scrollDueToTouchEvent(e);\n            }\n        }, { passive: false });\n        this._sliderTouchEndListener = dom.addStandardDisposableListener(this._domNode.domNode, EventType.End, (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            this._gestureInProgress = false;\n            this._slider.toggleClassName('active', false);\n        });\n    }\n    _startSliderDragging(e, initialPosY, initialSliderState) {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n        const initialPosX = e.pageX;\n        this._slider.toggleClassName('active', true);\n        const handlePointerMove = (posy, posx) => {\n            const minimapPosition = dom.getDomNodePagePosition(this._domNode.domNode);\n            const pointerOrthogonalDelta = Math.min(Math.abs(posx - initialPosX), Math.abs(posx - minimapPosition.left), Math.abs(posx - minimapPosition.left - minimapPosition.width));\n            if (platform.isWindows && pointerOrthogonalDelta > POINTER_DRAG_RESET_DISTANCE) {\n                // The pointer has wondered away from the scrollbar => reset dragging\n                this._model.setScrollTop(initialSliderState.scrollTop);\n                return;\n            }\n            const pointerDelta = posy - initialPosY;\n            this._model.setScrollTop(initialSliderState.getDesiredScrollTopFromDelta(pointerDelta));\n        };\n        if (e.pageY !== initialPosY) {\n            handlePointerMove(e.pageY, initialPosX);\n        }\n        this._sliderPointerMoveMonitor.startMonitoring(e.target, e.pointerId, e.buttons, pointerMoveData => handlePointerMove(pointerMoveData.pageY, pointerMoveData.pageX), () => {\n            this._slider.toggleClassName('active', false);\n        });\n    }\n    scrollDueToTouchEvent(touch) {\n        const startY = this._domNode.domNode.getBoundingClientRect().top;\n        const scrollTop = this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(touch.pageY - startY);\n        this._model.setScrollTop(scrollTop);\n    }\n    dispose() {\n        this._pointerDownListener.dispose();\n        this._sliderPointerMoveMonitor.dispose();\n        this._sliderPointerDownListener.dispose();\n        this._gestureDisposable.dispose();\n        this._sliderTouchStartListener.dispose();\n        this._sliderTouchMoveListener.dispose();\n        this._sliderTouchEndListener.dispose();\n        super.dispose();\n    }\n    _getMinimapDomNodeClassName() {\n        const class_ = ['minimap'];\n        if (this._model.options.showSlider === 'always') {\n            class_.push('slider-always');\n        }\n        else {\n            class_.push('slider-mouseover');\n        }\n        if (this._model.options.autohide) {\n            class_.push('autohide');\n        }\n        return class_.join(' ');\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    _applyLayout() {\n        this._domNode.setLeft(this._model.options.minimapLeft);\n        this._domNode.setWidth(this._model.options.minimapWidth);\n        this._domNode.setHeight(this._model.options.minimapHeight);\n        this._shadow.setHeight(this._model.options.minimapHeight);\n        this._canvas.setWidth(this._model.options.canvasOuterWidth);\n        this._canvas.setHeight(this._model.options.canvasOuterHeight);\n        this._canvas.domNode.width = this._model.options.canvasInnerWidth;\n        this._canvas.domNode.height = this._model.options.canvasInnerHeight;\n        this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth);\n        this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight);\n        this._decorationsCanvas.domNode.width = this._model.options.canvasInnerWidth;\n        this._decorationsCanvas.domNode.height = this._model.options.canvasInnerHeight;\n        this._slider.setWidth(this._model.options.minimapWidth);\n    }\n    _getBuffer() {\n        if (!this._buffers) {\n            if (this._model.options.canvasInnerWidth > 0 && this._model.options.canvasInnerHeight > 0) {\n                this._buffers = new MinimapBuffers(this._canvas.domNode.getContext('2d'), this._model.options.canvasInnerWidth, this._model.options.canvasInnerHeight, this._model.options.backgroundColor);\n            }\n        }\n        return this._buffers ? this._buffers.getBuffer() : null;\n    }\n    // ---- begin view event handlers\n    onDidChangeOptions() {\n        this._lastRenderData = null;\n        this._buffers = null;\n        this._applyLayout();\n        this._domNode.setClassName(this._getMinimapDomNodeClassName());\n    }\n    onSelectionChanged() {\n        this._renderDecorations = true;\n        return true;\n    }\n    onDecorationsChanged() {\n        this._renderDecorations = true;\n        return true;\n    }\n    onFlushed() {\n        this._lastRenderData = null;\n        return true;\n    }\n    onLinesChanged(changeFromLineNumber, changeCount) {\n        if (this._lastRenderData) {\n            return this._lastRenderData.onLinesChanged(changeFromLineNumber, changeCount);\n        }\n        return false;\n    }\n    onLinesDeleted(deleteFromLineNumber, deleteToLineNumber) {\n        var _a;\n        (_a = this._lastRenderData) === null || _a === void 0 ? void 0 : _a.onLinesDeleted(deleteFromLineNumber, deleteToLineNumber);\n        return true;\n    }\n    onLinesInserted(insertFromLineNumber, insertToLineNumber) {\n        var _a;\n        (_a = this._lastRenderData) === null || _a === void 0 ? void 0 : _a.onLinesInserted(insertFromLineNumber, insertToLineNumber);\n        return true;\n    }\n    onScrollChanged() {\n        this._renderDecorations = true;\n        return true;\n    }\n    onThemeChanged() {\n        this._selectionColor = this._theme.getColor(minimapSelection);\n        this._renderDecorations = true;\n        return true;\n    }\n    onTokensChanged(ranges) {\n        if (this._lastRenderData) {\n            return this._lastRenderData.onTokensChanged(ranges);\n        }\n        return false;\n    }\n    onTokensColorsChanged() {\n        this._lastRenderData = null;\n        this._buffers = null;\n        return true;\n    }\n    onZonesChanged() {\n        this._lastRenderData = null;\n        return true;\n    }\n    // --- end event handlers\n    render(renderingCtx) {\n        const renderMinimap = this._model.options.renderMinimap;\n        if (renderMinimap === 0 /* RenderMinimap.None */) {\n            this._shadow.setClassName('minimap-shadow-hidden');\n            this._sliderHorizontal.setWidth(0);\n            this._sliderHorizontal.setHeight(0);\n            return;\n        }\n        if (renderingCtx.scrollLeft + renderingCtx.viewportWidth >= renderingCtx.scrollWidth) {\n            this._shadow.setClassName('minimap-shadow-hidden');\n        }\n        else {\n            this._shadow.setClassName('minimap-shadow-visible');\n        }\n        const layout = MinimapLayout.create(this._model.options, renderingCtx.viewportStartLineNumber, renderingCtx.viewportEndLineNumber, renderingCtx.viewportStartLineNumberVerticalOffset, renderingCtx.viewportHeight, renderingCtx.viewportContainsWhitespaceGaps, this._model.getLineCount(), this._model.getRealLineCount(), renderingCtx.scrollTop, renderingCtx.scrollHeight, this._lastRenderData ? this._lastRenderData.renderedLayout : null);\n        this._slider.setDisplay(layout.sliderNeeded ? 'block' : 'none');\n        this._slider.setTop(layout.sliderTop);\n        this._slider.setHeight(layout.sliderHeight);\n        // Compute horizontal slider coordinates\n        this._sliderHorizontal.setLeft(0);\n        this._sliderHorizontal.setWidth(this._model.options.minimapWidth);\n        this._sliderHorizontal.setTop(0);\n        this._sliderHorizontal.setHeight(layout.sliderHeight);\n        this.renderDecorations(layout);\n        this._lastRenderData = this.renderLines(layout);\n    }\n    renderDecorations(layout) {\n        if (this._renderDecorations) {\n            this._renderDecorations = false;\n            const selections = this._model.getSelections();\n            selections.sort(Range.compareRangesUsingStarts);\n            const decorations = this._model.getMinimapDecorationsInViewport(layout.startLineNumber, layout.endLineNumber);\n            decorations.sort((a, b) => (a.options.zIndex || 0) - (b.options.zIndex || 0));\n            const { canvasInnerWidth, canvasInnerHeight } = this._model.options;\n            const minimapLineHeight = this._model.options.minimapLineHeight;\n            const minimapCharWidth = this._model.options.minimapCharWidth;\n            const tabSize = this._model.getOptions().tabSize;\n            const canvasContext = this._decorationsCanvas.domNode.getContext('2d');\n            canvasContext.clearRect(0, 0, canvasInnerWidth, canvasInnerHeight);\n            // We first need to render line highlights and then render decorations on top of those.\n            // But we need to pick a single color for each line, and use that as a line highlight.\n            // This needs to be the color of the decoration with the highest `zIndex`, but priority\n            // is given to the selection.\n            const highlightedLines = new ContiguousLineMap(layout.startLineNumber, layout.endLineNumber, false);\n            this._renderSelectionLineHighlights(canvasContext, selections, highlightedLines, layout, minimapLineHeight);\n            this._renderDecorationsLineHighlights(canvasContext, decorations, highlightedLines, layout, minimapLineHeight);\n            const lineOffsetMap = new ContiguousLineMap(layout.startLineNumber, layout.endLineNumber, null);\n            this._renderSelectionsHighlights(canvasContext, selections, lineOffsetMap, layout, minimapLineHeight, tabSize, minimapCharWidth, canvasInnerWidth);\n            this._renderDecorationsHighlights(canvasContext, decorations, lineOffsetMap, layout, minimapLineHeight, tabSize, minimapCharWidth, canvasInnerWidth);\n        }\n    }\n    _renderSelectionLineHighlights(canvasContext, selections, highlightedLines, layout, minimapLineHeight) {\n        if (!this._selectionColor || this._selectionColor.isTransparent()) {\n            return;\n        }\n        canvasContext.fillStyle = this._selectionColor.transparent(0.5).toString();\n        let y1 = 0;\n        let y2 = 0;\n        for (const selection of selections) {\n            const intersection = layout.intersectWithViewport(selection);\n            if (!intersection) {\n                // entirely outside minimap's viewport\n                continue;\n            }\n            const [startLineNumber, endLineNumber] = intersection;\n            for (let line = startLineNumber; line <= endLineNumber; line++) {\n                highlightedLines.set(line, true);\n            }\n            const yy1 = layout.getYForLineNumber(startLineNumber, minimapLineHeight);\n            const yy2 = layout.getYForLineNumber(endLineNumber, minimapLineHeight);\n            if (y2 >= yy1) {\n                // merge into previous\n                y2 = yy2;\n            }\n            else {\n                if (y2 > y1) {\n                    // flush\n                    canvasContext.fillRect(MINIMAP_GUTTER_WIDTH, y1, canvasContext.canvas.width, y2 - y1);\n                }\n                y1 = yy1;\n                y2 = yy2;\n            }\n        }\n        if (y2 > y1) {\n            // flush\n            canvasContext.fillRect(MINIMAP_GUTTER_WIDTH, y1, canvasContext.canvas.width, y2 - y1);\n        }\n    }\n    _renderDecorationsLineHighlights(canvasContext, decorations, highlightedLines, layout, minimapLineHeight) {\n        const highlightColors = new Map();\n        // Loop backwards to hit first decorations with higher `zIndex`\n        for (let i = decorations.length - 1; i >= 0; i--) {\n            const decoration = decorations[i];\n            const minimapOptions = decoration.options.minimap;\n            if (!minimapOptions || minimapOptions.position !== MinimapPosition.Inline) {\n                continue;\n            }\n            const intersection = layout.intersectWithViewport(decoration.range);\n            if (!intersection) {\n                // entirely outside minimap's viewport\n                continue;\n            }\n            const [startLineNumber, endLineNumber] = intersection;\n            const decorationColor = minimapOptions.getColor(this._theme.value);\n            if (!decorationColor || decorationColor.isTransparent()) {\n                continue;\n            }\n            let highlightColor = highlightColors.get(decorationColor.toString());\n            if (!highlightColor) {\n                highlightColor = decorationColor.transparent(0.5).toString();\n                highlightColors.set(decorationColor.toString(), highlightColor);\n            }\n            canvasContext.fillStyle = highlightColor;\n            for (let line = startLineNumber; line <= endLineNumber; line++) {\n                if (highlightedLines.has(line)) {\n                    continue;\n                }\n                highlightedLines.set(line, true);\n                const y = layout.getYForLineNumber(startLineNumber, minimapLineHeight);\n                canvasContext.fillRect(MINIMAP_GUTTER_WIDTH, y, canvasContext.canvas.width, minimapLineHeight);\n            }\n        }\n    }\n    _renderSelectionsHighlights(canvasContext, selections, lineOffsetMap, layout, lineHeight, tabSize, characterWidth, canvasInnerWidth) {\n        if (!this._selectionColor || this._selectionColor.isTransparent()) {\n            return;\n        }\n        for (const selection of selections) {\n            const intersection = layout.intersectWithViewport(selection);\n            if (!intersection) {\n                // entirely outside minimap's viewport\n                continue;\n            }\n            const [startLineNumber, endLineNumber] = intersection;\n            for (let line = startLineNumber; line <= endLineNumber; line++) {\n                this.renderDecorationOnLine(canvasContext, lineOffsetMap, selection, this._selectionColor, layout, line, lineHeight, lineHeight, tabSize, characterWidth, canvasInnerWidth);\n            }\n        }\n    }\n    _renderDecorationsHighlights(canvasContext, decorations, lineOffsetMap, layout, minimapLineHeight, tabSize, characterWidth, canvasInnerWidth) {\n        // Loop forwards to hit first decorations with lower `zIndex`\n        for (const decoration of decorations) {\n            const minimapOptions = decoration.options.minimap;\n            if (!minimapOptions) {\n                continue;\n            }\n            const intersection = layout.intersectWithViewport(decoration.range);\n            if (!intersection) {\n                // entirely outside minimap's viewport\n                continue;\n            }\n            const [startLineNumber, endLineNumber] = intersection;\n            const decorationColor = minimapOptions.getColor(this._theme.value);\n            if (!decorationColor || decorationColor.isTransparent()) {\n                continue;\n            }\n            for (let line = startLineNumber; line <= endLineNumber; line++) {\n                switch (minimapOptions.position) {\n                    case MinimapPosition.Inline:\n                        this.renderDecorationOnLine(canvasContext, lineOffsetMap, decoration.range, decorationColor, layout, line, minimapLineHeight, minimapLineHeight, tabSize, characterWidth, canvasInnerWidth);\n                        continue;\n                    case MinimapPosition.Gutter: {\n                        const y = layout.getYForLineNumber(line, minimapLineHeight);\n                        const x = 2;\n                        this.renderDecoration(canvasContext, decorationColor, x, y, GUTTER_DECORATION_WIDTH, minimapLineHeight);\n                        continue;\n                    }\n                }\n            }\n        }\n    }\n    renderDecorationOnLine(canvasContext, lineOffsetMap, decorationRange, decorationColor, layout, lineNumber, height, minimapLineHeight, tabSize, charWidth, canvasInnerWidth) {\n        const y = layout.getYForLineNumber(lineNumber, minimapLineHeight);\n        // Skip rendering the line if it's vertically outside our viewport\n        if (y + height < 0 || y > this._model.options.canvasInnerHeight) {\n            return;\n        }\n        const { startLineNumber, endLineNumber } = decorationRange;\n        const startColumn = (startLineNumber === lineNumber ? decorationRange.startColumn : 1);\n        const endColumn = (endLineNumber === lineNumber ? decorationRange.endColumn : this._model.getLineMaxColumn(lineNumber));\n        const x1 = this.getXOffsetForPosition(lineOffsetMap, lineNumber, startColumn, tabSize, charWidth, canvasInnerWidth);\n        const x2 = this.getXOffsetForPosition(lineOffsetMap, lineNumber, endColumn, tabSize, charWidth, canvasInnerWidth);\n        this.renderDecoration(canvasContext, decorationColor, x1, y, x2 - x1, height);\n    }\n    getXOffsetForPosition(lineOffsetMap, lineNumber, column, tabSize, charWidth, canvasInnerWidth) {\n        if (column === 1) {\n            return MINIMAP_GUTTER_WIDTH;\n        }\n        const minimumXOffset = (column - 1) * charWidth;\n        if (minimumXOffset >= canvasInnerWidth) {\n            // there is no need to look at actual characters,\n            // as this column is certainly after the minimap width\n            return canvasInnerWidth;\n        }\n        // Cache line offset data so that it is only read once per line\n        let lineIndexToXOffset = lineOffsetMap.get(lineNumber);\n        if (!lineIndexToXOffset) {\n            const lineData = this._model.getLineContent(lineNumber);\n            lineIndexToXOffset = [MINIMAP_GUTTER_WIDTH];\n            let prevx = MINIMAP_GUTTER_WIDTH;\n            for (let i = 1; i < lineData.length + 1; i++) {\n                const charCode = lineData.charCodeAt(i - 1);\n                const dx = charCode === 9 /* CharCode.Tab */\n                    ? tabSize * charWidth\n                    : strings.isFullWidthCharacter(charCode)\n                        ? 2 * charWidth\n                        : charWidth;\n                const x = prevx + dx;\n                if (x >= canvasInnerWidth) {\n                    // no need to keep on going, as we've hit the canvas width\n                    lineIndexToXOffset[i] = canvasInnerWidth;\n                    break;\n                }\n                lineIndexToXOffset[i] = x;\n                prevx = x;\n            }\n            lineOffsetMap.set(lineNumber, lineIndexToXOffset);\n        }\n        if (column - 1 < lineIndexToXOffset.length) {\n            return lineIndexToXOffset[column - 1];\n        }\n        // goes over the canvas width\n        return canvasInnerWidth;\n    }\n    renderDecoration(canvasContext, decorationColor, x, y, width, height) {\n        canvasContext.fillStyle = decorationColor && decorationColor.toString() || '';\n        canvasContext.fillRect(x, y, width, height);\n    }\n    renderLines(layout) {\n        const startLineNumber = layout.startLineNumber;\n        const endLineNumber = layout.endLineNumber;\n        const minimapLineHeight = this._model.options.minimapLineHeight;\n        // Check if nothing changed w.r.t. lines from last frame\n        if (this._lastRenderData && this._lastRenderData.linesEquals(layout)) {\n            const _lastData = this._lastRenderData._get();\n            // Nice!! Nothing changed from last frame\n            return new RenderData(layout, _lastData.imageData, _lastData.lines);\n        }\n        // Oh well!! We need to repaint some lines...\n        const imageData = this._getBuffer();\n        if (!imageData) {\n            // 0 width or 0 height canvas, nothing to do\n            return null;\n        }\n        // Render untouched lines by using last rendered data.\n        const [_dirtyY1, _dirtyY2, needed] = InnerMinimap._renderUntouchedLines(imageData, layout.topPaddingLineCount, startLineNumber, endLineNumber, minimapLineHeight, this._lastRenderData);\n        // Fetch rendering info from view model for rest of lines that need rendering.\n        const lineInfo = this._model.getMinimapLinesRenderingData(startLineNumber, endLineNumber, needed);\n        const tabSize = this._model.getOptions().tabSize;\n        const defaultBackground = this._model.options.defaultBackgroundColor;\n        const background = this._model.options.backgroundColor;\n        const foregroundAlpha = this._model.options.foregroundAlpha;\n        const tokensColorTracker = this._model.tokensColorTracker;\n        const useLighterFont = tokensColorTracker.backgroundIsLight();\n        const renderMinimap = this._model.options.renderMinimap;\n        const charRenderer = this._model.options.charRenderer();\n        const fontScale = this._model.options.fontScale;\n        const minimapCharWidth = this._model.options.minimapCharWidth;\n        const baseCharHeight = (renderMinimap === 1 /* RenderMinimap.Text */ ? 2 /* Constants.BASE_CHAR_HEIGHT */ : 2 /* Constants.BASE_CHAR_HEIGHT */ + 1);\n        const renderMinimapLineHeight = baseCharHeight * fontScale;\n        const innerLinePadding = (minimapLineHeight > renderMinimapLineHeight ? Math.floor((minimapLineHeight - renderMinimapLineHeight) / 2) : 0);\n        // Render the rest of lines\n        const backgroundA = background.a / 255;\n        const renderBackground = new RGBA8(Math.round((background.r - defaultBackground.r) * backgroundA + defaultBackground.r), Math.round((background.g - defaultBackground.g) * backgroundA + defaultBackground.g), Math.round((background.b - defaultBackground.b) * backgroundA + defaultBackground.b), 255);\n        let dy = layout.topPaddingLineCount * minimapLineHeight;\n        const renderedLines = [];\n        for (let lineIndex = 0, lineCount = endLineNumber - startLineNumber + 1; lineIndex < lineCount; lineIndex++) {\n            if (needed[lineIndex]) {\n                InnerMinimap._renderLine(imageData, renderBackground, background.a, useLighterFont, renderMinimap, minimapCharWidth, tokensColorTracker, foregroundAlpha, charRenderer, dy, innerLinePadding, tabSize, lineInfo[lineIndex], fontScale, minimapLineHeight);\n            }\n            renderedLines[lineIndex] = new MinimapLine(dy);\n            dy += minimapLineHeight;\n        }\n        const dirtyY1 = (_dirtyY1 === -1 ? 0 : _dirtyY1);\n        const dirtyY2 = (_dirtyY2 === -1 ? imageData.height : _dirtyY2);\n        const dirtyHeight = dirtyY2 - dirtyY1;\n        // Finally, paint to the canvas\n        const ctx = this._canvas.domNode.getContext('2d');\n        ctx.putImageData(imageData, 0, 0, 0, dirtyY1, imageData.width, dirtyHeight);\n        // Save rendered data for reuse on next frame if possible\n        return new RenderData(layout, imageData, renderedLines);\n    }\n    static _renderUntouchedLines(target, topPaddingLineCount, startLineNumber, endLineNumber, minimapLineHeight, lastRenderData) {\n        const needed = [];\n        if (!lastRenderData) {\n            for (let i = 0, len = endLineNumber - startLineNumber + 1; i < len; i++) {\n                needed[i] = true;\n            }\n            return [-1, -1, needed];\n        }\n        const _lastData = lastRenderData._get();\n        const lastTargetData = _lastData.imageData.data;\n        const lastStartLineNumber = _lastData.rendLineNumberStart;\n        const lastLines = _lastData.lines;\n        const lastLinesLength = lastLines.length;\n        const WIDTH = target.width;\n        const targetData = target.data;\n        const maxDestPixel = (endLineNumber - startLineNumber + 1) * minimapLineHeight * WIDTH * 4;\n        let dirtyPixel1 = -1; // the pixel offset up to which all the data is equal to the prev frame\n        let dirtyPixel2 = -1; // the pixel offset after which all the data is equal to the prev frame\n        let copySourceStart = -1;\n        let copySourceEnd = -1;\n        let copyDestStart = -1;\n        let copyDestEnd = -1;\n        let dest_dy = topPaddingLineCount * minimapLineHeight;\n        for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - startLineNumber;\n            const lastLineIndex = lineNumber - lastStartLineNumber;\n            const source_dy = (lastLineIndex >= 0 && lastLineIndex < lastLinesLength ? lastLines[lastLineIndex].dy : -1);\n            if (source_dy === -1) {\n                needed[lineIndex] = true;\n                dest_dy += minimapLineHeight;\n                continue;\n            }\n            const sourceStart = source_dy * WIDTH * 4;\n            const sourceEnd = (source_dy + minimapLineHeight) * WIDTH * 4;\n            const destStart = dest_dy * WIDTH * 4;\n            const destEnd = (dest_dy + minimapLineHeight) * WIDTH * 4;\n            if (copySourceEnd === sourceStart && copyDestEnd === destStart) {\n                // contiguous zone => extend copy request\n                copySourceEnd = sourceEnd;\n                copyDestEnd = destEnd;\n            }\n            else {\n                if (copySourceStart !== -1) {\n                    // flush existing copy request\n                    targetData.set(lastTargetData.subarray(copySourceStart, copySourceEnd), copyDestStart);\n                    if (dirtyPixel1 === -1 && copySourceStart === 0 && copySourceStart === copyDestStart) {\n                        dirtyPixel1 = copySourceEnd;\n                    }\n                    if (dirtyPixel2 === -1 && copySourceEnd === maxDestPixel && copySourceStart === copyDestStart) {\n                        dirtyPixel2 = copySourceStart;\n                    }\n                }\n                copySourceStart = sourceStart;\n                copySourceEnd = sourceEnd;\n                copyDestStart = destStart;\n                copyDestEnd = destEnd;\n            }\n            needed[lineIndex] = false;\n            dest_dy += minimapLineHeight;\n        }\n        if (copySourceStart !== -1) {\n            // flush existing copy request\n            targetData.set(lastTargetData.subarray(copySourceStart, copySourceEnd), copyDestStart);\n            if (dirtyPixel1 === -1 && copySourceStart === 0 && copySourceStart === copyDestStart) {\n                dirtyPixel1 = copySourceEnd;\n            }\n            if (dirtyPixel2 === -1 && copySourceEnd === maxDestPixel && copySourceStart === copyDestStart) {\n                dirtyPixel2 = copySourceStart;\n            }\n        }\n        const dirtyY1 = (dirtyPixel1 === -1 ? -1 : dirtyPixel1 / (WIDTH * 4));\n        const dirtyY2 = (dirtyPixel2 === -1 ? -1 : dirtyPixel2 / (WIDTH * 4));\n        return [dirtyY1, dirtyY2, needed];\n    }\n    static _renderLine(target, backgroundColor, backgroundAlpha, useLighterFont, renderMinimap, charWidth, colorTracker, foregroundAlpha, minimapCharRenderer, dy, innerLinePadding, tabSize, lineData, fontScale, minimapLineHeight) {\n        const content = lineData.content;\n        const tokens = lineData.tokens;\n        const maxDx = target.width - charWidth;\n        const force1pxHeight = (minimapLineHeight === 1);\n        let dx = MINIMAP_GUTTER_WIDTH;\n        let charIndex = 0;\n        let tabsCharDelta = 0;\n        for (let tokenIndex = 0, tokensLen = tokens.getCount(); tokenIndex < tokensLen; tokenIndex++) {\n            const tokenEndIndex = tokens.getEndOffset(tokenIndex);\n            const tokenColorId = tokens.getForeground(tokenIndex);\n            const tokenColor = colorTracker.getColor(tokenColorId);\n            for (; charIndex < tokenEndIndex; charIndex++) {\n                if (dx > maxDx) {\n                    // hit edge of minimap\n                    return;\n                }\n                const charCode = content.charCodeAt(charIndex);\n                if (charCode === 9 /* CharCode.Tab */) {\n                    const insertSpacesCount = tabSize - (charIndex + tabsCharDelta) % tabSize;\n                    tabsCharDelta += insertSpacesCount - 1;\n                    // No need to render anything since tab is invisible\n                    dx += insertSpacesCount * charWidth;\n                }\n                else if (charCode === 32 /* CharCode.Space */) {\n                    // No need to render anything since space is invisible\n                    dx += charWidth;\n                }\n                else {\n                    // Render twice for a full width character\n                    const count = strings.isFullWidthCharacter(charCode) ? 2 : 1;\n                    for (let i = 0; i < count; i++) {\n                        if (renderMinimap === 2 /* RenderMinimap.Blocks */) {\n                            minimapCharRenderer.blockRenderChar(target, dx, dy + innerLinePadding, tokenColor, foregroundAlpha, backgroundColor, backgroundAlpha, force1pxHeight);\n                        }\n                        else { // RenderMinimap.Text\n                            minimapCharRenderer.renderChar(target, dx, dy + innerLinePadding, charCode, tokenColor, foregroundAlpha, backgroundColor, backgroundAlpha, fontScale, useLighterFont, force1pxHeight);\n                        }\n                        dx += charWidth;\n                        if (dx > maxDx) {\n                            // hit edge of minimap\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\nclass ContiguousLineMap {\n    constructor(startLineNumber, endLineNumber, defaultValue) {\n        this._startLineNumber = startLineNumber;\n        this._endLineNumber = endLineNumber;\n        this._defaultValue = defaultValue;\n        this._values = [];\n        for (let i = 0, count = this._endLineNumber - this._startLineNumber + 1; i < count; i++) {\n            this._values[i] = defaultValue;\n        }\n    }\n    has(lineNumber) {\n        return (this.get(lineNumber) !== this._defaultValue);\n    }\n    set(lineNumber, value) {\n        if (lineNumber < this._startLineNumber || lineNumber > this._endLineNumber) {\n            return;\n        }\n        this._values[lineNumber - this._startLineNumber] = value;\n    }\n    get(lineNumber) {\n        if (lineNumber < this._startLineNumber || lineNumber > this._endLineNumber) {\n            return this._defaultValue;\n        }\n        return this._values[lineNumber - this._startLineNumber];\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './overlayWidgets.css';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\nexport class ViewOverlayWidgets extends ViewPart {\n    constructor(context) {\n        super(context);\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._widgets = {};\n        this._verticalScrollbarWidth = layoutInfo.verticalScrollbarWidth;\n        this._minimapWidth = layoutInfo.minimap.minimapWidth;\n        this._horizontalScrollbarHeight = layoutInfo.horizontalScrollbarHeight;\n        this._editorHeight = layoutInfo.height;\n        this._editorWidth = layoutInfo.width;\n        this._domNode = createFastDomNode(document.createElement('div'));\n        PartFingerprints.write(this._domNode, 4 /* PartFingerprint.OverlayWidgets */);\n        this._domNode.setClassName('overlayWidgets');\n    }\n    dispose() {\n        super.dispose();\n        this._widgets = {};\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    // ---- begin view event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._verticalScrollbarWidth = layoutInfo.verticalScrollbarWidth;\n        this._minimapWidth = layoutInfo.minimap.minimapWidth;\n        this._horizontalScrollbarHeight = layoutInfo.horizontalScrollbarHeight;\n        this._editorHeight = layoutInfo.height;\n        this._editorWidth = layoutInfo.width;\n        return true;\n    }\n    // ---- end view event handlers\n    addWidget(widget) {\n        const domNode = createFastDomNode(widget.getDomNode());\n        this._widgets[widget.getId()] = {\n            widget: widget,\n            preference: null,\n            domNode: domNode\n        };\n        // This is sync because a widget wants to be in the dom\n        domNode.setPosition('absolute');\n        domNode.setAttribute('widgetId', widget.getId());\n        this._domNode.appendChild(domNode);\n        this.setShouldRender();\n    }\n    setWidgetPosition(widget, preference) {\n        const widgetData = this._widgets[widget.getId()];\n        if (widgetData.preference === preference) {\n            return false;\n        }\n        widgetData.preference = preference;\n        this.setShouldRender();\n        return true;\n    }\n    removeWidget(widget) {\n        const widgetId = widget.getId();\n        if (this._widgets.hasOwnProperty(widgetId)) {\n            const widgetData = this._widgets[widgetId];\n            const domNode = widgetData.domNode.domNode;\n            delete this._widgets[widgetId];\n            domNode.parentNode.removeChild(domNode);\n            this.setShouldRender();\n        }\n    }\n    _renderWidget(widgetData) {\n        const domNode = widgetData.domNode;\n        if (widgetData.preference === null) {\n            domNode.setTop('');\n            return;\n        }\n        if (widgetData.preference === 0 /* OverlayWidgetPositionPreference.TOP_RIGHT_CORNER */) {\n            domNode.setTop(0);\n            domNode.setRight((2 * this._verticalScrollbarWidth) + this._minimapWidth);\n        }\n        else if (widgetData.preference === 1 /* OverlayWidgetPositionPreference.BOTTOM_RIGHT_CORNER */) {\n            const widgetHeight = domNode.domNode.clientHeight;\n            domNode.setTop((this._editorHeight - widgetHeight - 2 * this._horizontalScrollbarHeight));\n            domNode.setRight((2 * this._verticalScrollbarWidth) + this._minimapWidth);\n        }\n        else if (widgetData.preference === 2 /* OverlayWidgetPositionPreference.TOP_CENTER */) {\n            domNode.setTop(0);\n            domNode.domNode.style.right = '50%';\n        }\n    }\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    render(ctx) {\n        this._domNode.setWidth(this._editorWidth);\n        const keys = Object.keys(this._widgets);\n        for (let i = 0, len = keys.length; i < len; i++) {\n            const widgetId = keys[i];\n            this._renderWidget(this._widgets[widgetId]);\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { ViewPart } from '../../view/viewPart.js';\nimport { Position } from '../../../common/core/position.js';\nimport { TokenizationRegistry } from '../../../common/languages.js';\nimport { editorCursorForeground, editorOverviewRulerBorder, editorOverviewRulerBackground } from '../../../common/core/editorColorRegistry.js';\nimport { OverviewRulerDecorationsGroup } from '../../../common/viewModel.js';\nclass Settings {\n    constructor(config, theme) {\n        const options = config.options;\n        this.lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this.pixelRatio = options.get(136 /* EditorOption.pixelRatio */);\n        this.overviewRulerLanes = options.get(79 /* EditorOption.overviewRulerLanes */);\n        this.renderBorder = options.get(78 /* EditorOption.overviewRulerBorder */);\n        const borderColor = theme.getColor(editorOverviewRulerBorder);\n        this.borderColor = borderColor ? borderColor.toString() : null;\n        this.hideCursor = options.get(56 /* EditorOption.hideCursorInOverviewRuler */);\n        const cursorColor = theme.getColor(editorCursorForeground);\n        this.cursorColor = cursorColor ? cursorColor.transparent(0.7).toString() : null;\n        this.themeType = theme.type;\n        const minimapOpts = options.get(69 /* EditorOption.minimap */);\n        const minimapEnabled = minimapOpts.enabled;\n        const minimapSide = minimapOpts.side;\n        const themeColor = theme.getColor(editorOverviewRulerBackground);\n        const defaultBackground = TokenizationRegistry.getDefaultBackground();\n        if (themeColor) {\n            this.backgroundColor = themeColor;\n        }\n        else if (minimapEnabled && minimapSide === 'right') {\n            this.backgroundColor = defaultBackground;\n        }\n        else {\n            this.backgroundColor = null;\n        }\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        const position = layoutInfo.overviewRuler;\n        this.top = position.top;\n        this.right = position.right;\n        this.domWidth = position.width;\n        this.domHeight = position.height;\n        if (this.overviewRulerLanes === 0) {\n            // overview ruler is off\n            this.canvasWidth = 0;\n            this.canvasHeight = 0;\n        }\n        else {\n            this.canvasWidth = (this.domWidth * this.pixelRatio) | 0;\n            this.canvasHeight = (this.domHeight * this.pixelRatio) | 0;\n        }\n        const [x, w] = this._initLanes(1, this.canvasWidth, this.overviewRulerLanes);\n        this.x = x;\n        this.w = w;\n    }\n    _initLanes(canvasLeftOffset, canvasWidth, laneCount) {\n        const remainingWidth = canvasWidth - canvasLeftOffset;\n        if (laneCount >= 3) {\n            const leftWidth = Math.floor(remainingWidth / 3);\n            const rightWidth = Math.floor(remainingWidth / 3);\n            const centerWidth = remainingWidth - leftWidth - rightWidth;\n            const leftOffset = canvasLeftOffset;\n            const centerOffset = leftOffset + leftWidth;\n            const rightOffset = leftOffset + leftWidth + centerWidth;\n            return [\n                [\n                    0,\n                    leftOffset,\n                    centerOffset,\n                    leftOffset,\n                    rightOffset,\n                    leftOffset,\n                    centerOffset,\n                    leftOffset, // Left | Center | Right\n                ], [\n                    0,\n                    leftWidth,\n                    centerWidth,\n                    leftWidth + centerWidth,\n                    rightWidth,\n                    leftWidth + centerWidth + rightWidth,\n                    centerWidth + rightWidth,\n                    leftWidth + centerWidth + rightWidth, // Left | Center | Right\n                ]\n            ];\n        }\n        else if (laneCount === 2) {\n            const leftWidth = Math.floor(remainingWidth / 2);\n            const rightWidth = remainingWidth - leftWidth;\n            const leftOffset = canvasLeftOffset;\n            const rightOffset = leftOffset + leftWidth;\n            return [\n                [\n                    0,\n                    leftOffset,\n                    leftOffset,\n                    leftOffset,\n                    rightOffset,\n                    leftOffset,\n                    leftOffset,\n                    leftOffset, // Left | Center | Right\n                ], [\n                    0,\n                    leftWidth,\n                    leftWidth,\n                    leftWidth,\n                    rightWidth,\n                    leftWidth + rightWidth,\n                    leftWidth + rightWidth,\n                    leftWidth + rightWidth, // Left | Center | Right\n                ]\n            ];\n        }\n        else {\n            const offset = canvasLeftOffset;\n            const width = remainingWidth;\n            return [\n                [\n                    0,\n                    offset,\n                    offset,\n                    offset,\n                    offset,\n                    offset,\n                    offset,\n                    offset, // Left | Center | Right\n                ], [\n                    0,\n                    width,\n                    width,\n                    width,\n                    width,\n                    width,\n                    width,\n                    width, // Left | Center | Right\n                ]\n            ];\n        }\n    }\n    equals(other) {\n        return (this.lineHeight === other.lineHeight\n            && this.pixelRatio === other.pixelRatio\n            && this.overviewRulerLanes === other.overviewRulerLanes\n            && this.renderBorder === other.renderBorder\n            && this.borderColor === other.borderColor\n            && this.hideCursor === other.hideCursor\n            && this.cursorColor === other.cursorColor\n            && this.themeType === other.themeType\n            && Color.equals(this.backgroundColor, other.backgroundColor)\n            && this.top === other.top\n            && this.right === other.right\n            && this.domWidth === other.domWidth\n            && this.domHeight === other.domHeight\n            && this.canvasWidth === other.canvasWidth\n            && this.canvasHeight === other.canvasHeight);\n    }\n}\nexport class DecorationsOverviewRuler extends ViewPart {\n    constructor(context) {\n        super(context);\n        this._domNode = createFastDomNode(document.createElement('canvas'));\n        this._domNode.setClassName('decorationsOverviewRuler');\n        this._domNode.setPosition('absolute');\n        this._domNode.setLayerHinting(true);\n        this._domNode.setContain('strict');\n        this._domNode.setAttribute('aria-hidden', 'true');\n        this._updateSettings(false);\n        this._tokensColorTrackerListener = TokenizationRegistry.onDidChange((e) => {\n            if (e.changedColorMap) {\n                this._updateSettings(true);\n            }\n        });\n        this._cursorPositions = [];\n    }\n    dispose() {\n        super.dispose();\n        this._tokensColorTrackerListener.dispose();\n    }\n    _updateSettings(renderNow) {\n        const newSettings = new Settings(this._context.configuration, this._context.theme);\n        if (this._settings && this._settings.equals(newSettings)) {\n            // nothing to do\n            return false;\n        }\n        this._settings = newSettings;\n        this._domNode.setTop(this._settings.top);\n        this._domNode.setRight(this._settings.right);\n        this._domNode.setWidth(this._settings.domWidth);\n        this._domNode.setHeight(this._settings.domHeight);\n        this._domNode.domNode.width = this._settings.canvasWidth;\n        this._domNode.domNode.height = this._settings.canvasHeight;\n        if (renderNow) {\n            this._render();\n        }\n        return true;\n    }\n    // ---- begin view event handlers\n    onConfigurationChanged(e) {\n        return this._updateSettings(false);\n    }\n    onCursorStateChanged(e) {\n        this._cursorPositions = [];\n        for (let i = 0, len = e.selections.length; i < len; i++) {\n            this._cursorPositions[i] = e.selections[i].getPosition();\n        }\n        this._cursorPositions.sort(Position.compare);\n        return true;\n    }\n    onDecorationsChanged(e) {\n        if (e.affectsOverviewRuler) {\n            return true;\n        }\n        return false;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollHeightChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    onThemeChanged(e) {\n        return this._updateSettings(false);\n    }\n    // ---- end view event handlers\n    getDomNode() {\n        return this._domNode.domNode;\n    }\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    render(editorCtx) {\n        this._render();\n    }\n    _render() {\n        const backgroundColor = this._settings.backgroundColor;\n        if (this._settings.overviewRulerLanes === 0) {\n            // overview ruler is off\n            this._domNode.setBackgroundColor(backgroundColor ? Color.Format.CSS.formatHexA(backgroundColor) : '');\n            this._domNode.setDisplay('none');\n            return;\n        }\n        this._domNode.setDisplay('block');\n        const canvasWidth = this._settings.canvasWidth;\n        const canvasHeight = this._settings.canvasHeight;\n        const lineHeight = this._settings.lineHeight;\n        const viewLayout = this._context.viewLayout;\n        const outerHeight = this._context.viewLayout.getScrollHeight();\n        const heightRatio = canvasHeight / outerHeight;\n        const decorations = this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);\n        const minDecorationHeight = (6 /* Constants.MIN_DECORATION_HEIGHT */ * this._settings.pixelRatio) | 0;\n        const halfMinDecorationHeight = (minDecorationHeight / 2) | 0;\n        const canvasCtx = this._domNode.domNode.getContext('2d');\n        if (backgroundColor) {\n            if (backgroundColor.isOpaque()) {\n                // We have a background color which is opaque, we can just paint the entire surface with it\n                canvasCtx.fillStyle = Color.Format.CSS.formatHexA(backgroundColor);\n                canvasCtx.fillRect(0, 0, canvasWidth, canvasHeight);\n            }\n            else {\n                // We have a background color which is transparent, we need to first clear the surface and\n                // then fill it\n                canvasCtx.clearRect(0, 0, canvasWidth, canvasHeight);\n                canvasCtx.fillStyle = Color.Format.CSS.formatHexA(backgroundColor);\n                canvasCtx.fillRect(0, 0, canvasWidth, canvasHeight);\n            }\n        }\n        else {\n            // We don't have a background color\n            canvasCtx.clearRect(0, 0, canvasWidth, canvasHeight);\n        }\n        const x = this._settings.x;\n        const w = this._settings.w;\n        decorations.sort(OverviewRulerDecorationsGroup.cmp);\n        for (const decorationGroup of decorations) {\n            const color = decorationGroup.color;\n            const decorationGroupData = decorationGroup.data;\n            canvasCtx.fillStyle = color;\n            let prevLane = 0;\n            let prevY1 = 0;\n            let prevY2 = 0;\n            for (let i = 0, len = decorationGroupData.length / 3; i < len; i++) {\n                const lane = decorationGroupData[3 * i];\n                const startLineNumber = decorationGroupData[3 * i + 1];\n                const endLineNumber = decorationGroupData[3 * i + 2];\n                let y1 = (viewLayout.getVerticalOffsetForLineNumber(startLineNumber) * heightRatio) | 0;\n                let y2 = ((viewLayout.getVerticalOffsetForLineNumber(endLineNumber) + lineHeight) * heightRatio) | 0;\n                const height = y2 - y1;\n                if (height < minDecorationHeight) {\n                    let yCenter = ((y1 + y2) / 2) | 0;\n                    if (yCenter < halfMinDecorationHeight) {\n                        yCenter = halfMinDecorationHeight;\n                    }\n                    else if (yCenter + halfMinDecorationHeight > canvasHeight) {\n                        yCenter = canvasHeight - halfMinDecorationHeight;\n                    }\n                    y1 = yCenter - halfMinDecorationHeight;\n                    y2 = yCenter + halfMinDecorationHeight;\n                }\n                if (y1 > prevY2 + 1 || lane !== prevLane) {\n                    // flush prev\n                    if (i !== 0) {\n                        canvasCtx.fillRect(x[prevLane], prevY1, w[prevLane], prevY2 - prevY1);\n                    }\n                    prevLane = lane;\n                    prevY1 = y1;\n                    prevY2 = y2;\n                }\n                else {\n                    // merge into prev\n                    if (y2 > prevY2) {\n                        prevY2 = y2;\n                    }\n                }\n            }\n            canvasCtx.fillRect(x[prevLane], prevY1, w[prevLane], prevY2 - prevY1);\n        }\n        // Draw cursors\n        if (!this._settings.hideCursor && this._settings.cursorColor) {\n            const cursorHeight = (2 * this._settings.pixelRatio) | 0;\n            const halfCursorHeight = (cursorHeight / 2) | 0;\n            const cursorX = this._settings.x[7 /* OverviewRulerLane.Full */];\n            const cursorW = this._settings.w[7 /* OverviewRulerLane.Full */];\n            canvasCtx.fillStyle = this._settings.cursorColor;\n            let prevY1 = -100;\n            let prevY2 = -100;\n            for (let i = 0, len = this._cursorPositions.length; i < len; i++) {\n                const cursor = this._cursorPositions[i];\n                let yCenter = (viewLayout.getVerticalOffsetForLineNumber(cursor.lineNumber) * heightRatio) | 0;\n                if (yCenter < halfCursorHeight) {\n                    yCenter = halfCursorHeight;\n                }\n                else if (yCenter + halfCursorHeight > canvasHeight) {\n                    yCenter = canvasHeight - halfCursorHeight;\n                }\n                const y1 = yCenter - halfCursorHeight;\n                const y2 = y1 + cursorHeight;\n                if (y1 > prevY2 + 1) {\n                    // flush prev\n                    if (i !== 0) {\n                        canvasCtx.fillRect(cursorX, prevY1, cursorW, prevY2 - prevY1);\n                    }\n                    prevY1 = y1;\n                    prevY2 = y2;\n                }\n                else {\n                    // merge into prev\n                    if (y2 > prevY2) {\n                        prevY2 = y2;\n                    }\n                }\n            }\n            canvasCtx.fillRect(cursorX, prevY1, cursorW, prevY2 - prevY1);\n        }\n        if (this._settings.renderBorder && this._settings.borderColor && this._settings.overviewRulerLanes > 0) {\n            canvasCtx.beginPath();\n            canvasCtx.lineWidth = 1;\n            canvasCtx.strokeStyle = this._settings.borderColor;\n            canvasCtx.moveTo(0, 0);\n            canvasCtx.lineTo(0, canvasHeight);\n            canvasCtx.stroke();\n            canvasCtx.moveTo(0, 0);\n            canvasCtx.lineTo(canvasWidth, 0);\n            canvasCtx.stroke();\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { OverviewZoneManager } from '../../../common/viewModel/overviewZoneManager.js';\nimport { ViewEventHandler } from '../../../common/viewEventHandler.js';\nexport class OverviewRuler extends ViewEventHandler {\n    constructor(context, cssClassName) {\n        super();\n        this._context = context;\n        const options = this._context.configuration.options;\n        this._domNode = createFastDomNode(document.createElement('canvas'));\n        this._domNode.setClassName(cssClassName);\n        this._domNode.setPosition('absolute');\n        this._domNode.setLayerHinting(true);\n        this._domNode.setContain('strict');\n        this._zoneManager = new OverviewZoneManager((lineNumber) => this._context.viewLayout.getVerticalOffsetForLineNumber(lineNumber));\n        this._zoneManager.setDOMWidth(0);\n        this._zoneManager.setDOMHeight(0);\n        this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight());\n        this._zoneManager.setLineHeight(options.get(63 /* EditorOption.lineHeight */));\n        this._zoneManager.setPixelRatio(options.get(136 /* EditorOption.pixelRatio */));\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        super.dispose();\n    }\n    // ---- begin view event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        if (e.hasChanged(63 /* EditorOption.lineHeight */)) {\n            this._zoneManager.setLineHeight(options.get(63 /* EditorOption.lineHeight */));\n            this._render();\n        }\n        if (e.hasChanged(136 /* EditorOption.pixelRatio */)) {\n            this._zoneManager.setPixelRatio(options.get(136 /* EditorOption.pixelRatio */));\n            this._domNode.setWidth(this._zoneManager.getDOMWidth());\n            this._domNode.setHeight(this._zoneManager.getDOMHeight());\n            this._domNode.domNode.width = this._zoneManager.getCanvasWidth();\n            this._domNode.domNode.height = this._zoneManager.getCanvasHeight();\n            this._render();\n        }\n        return true;\n    }\n    onFlushed(e) {\n        this._render();\n        return true;\n    }\n    onScrollChanged(e) {\n        if (e.scrollHeightChanged) {\n            this._zoneManager.setOuterHeight(e.scrollHeight);\n            this._render();\n        }\n        return true;\n    }\n    onZonesChanged(e) {\n        this._render();\n        return true;\n    }\n    // ---- end view event handlers\n    getDomNode() {\n        return this._domNode.domNode;\n    }\n    setLayout(position) {\n        this._domNode.setTop(position.top);\n        this._domNode.setRight(position.right);\n        let hasChanged = false;\n        hasChanged = this._zoneManager.setDOMWidth(position.width) || hasChanged;\n        hasChanged = this._zoneManager.setDOMHeight(position.height) || hasChanged;\n        if (hasChanged) {\n            this._domNode.setWidth(this._zoneManager.getDOMWidth());\n            this._domNode.setHeight(this._zoneManager.getDOMHeight());\n            this._domNode.domNode.width = this._zoneManager.getCanvasWidth();\n            this._domNode.domNode.height = this._zoneManager.getCanvasHeight();\n            this._render();\n        }\n    }\n    setZones(zones) {\n        this._zoneManager.setZones(zones);\n        this._render();\n    }\n    _render() {\n        if (this._zoneManager.getOuterHeight() === 0) {\n            return false;\n        }\n        const width = this._zoneManager.getCanvasWidth();\n        const height = this._zoneManager.getCanvasHeight();\n        const colorZones = this._zoneManager.resolveColorZones();\n        const id2Color = this._zoneManager.getId2Color();\n        const ctx = this._domNode.domNode.getContext('2d');\n        ctx.clearRect(0, 0, width, height);\n        if (colorZones.length > 0) {\n            this._renderOneLane(ctx, colorZones, id2Color, width);\n        }\n        return true;\n    }\n    _renderOneLane(ctx, colorZones, id2Color, width) {\n        let currentColorId = 0;\n        let currentFrom = 0;\n        let currentTo = 0;\n        for (const zone of colorZones) {\n            const zoneColorId = zone.colorId;\n            const zoneFrom = zone.from;\n            const zoneTo = zone.to;\n            if (zoneColorId !== currentColorId) {\n                ctx.fillRect(0, currentFrom, width, currentTo - currentFrom);\n                currentColorId = zoneColorId;\n                ctx.fillStyle = id2Color[currentColorId];\n                currentFrom = zoneFrom;\n                currentTo = zoneTo;\n            }\n            else {\n                if (currentTo >= zoneFrom) {\n                    currentTo = Math.max(currentTo, zoneTo);\n                }\n                else {\n                    ctx.fillRect(0, currentFrom, width, currentTo - currentFrom);\n                    currentFrom = zoneFrom;\n                    currentTo = zoneTo;\n                }\n            }\n        }\n        ctx.fillRect(0, currentFrom, width, currentTo - currentFrom);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './rulers.css';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { ViewPart } from '../../view/viewPart.js';\nexport class Rulers extends ViewPart {\n    constructor(context) {\n        super(context);\n        this.domNode = createFastDomNode(document.createElement('div'));\n        this.domNode.setAttribute('role', 'presentation');\n        this.domNode.setAttribute('aria-hidden', 'true');\n        this.domNode.setClassName('view-rulers');\n        this._renderedRulers = [];\n        const options = this._context.configuration.options;\n        this._rulers = options.get(96 /* EditorOption.rulers */);\n        this._typicalHalfwidthCharacterWidth = options.get(47 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n    }\n    dispose() {\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        this._rulers = options.get(96 /* EditorOption.rulers */);\n        this._typicalHalfwidthCharacterWidth = options.get(47 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollHeightChanged;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    _ensureRulersCount() {\n        const currentCount = this._renderedRulers.length;\n        const desiredCount = this._rulers.length;\n        if (currentCount === desiredCount) {\n            // Nothing to do\n            return;\n        }\n        if (currentCount < desiredCount) {\n            const { tabSize } = this._context.viewModel.model.getOptions();\n            const rulerWidth = tabSize;\n            let addCount = desiredCount - currentCount;\n            while (addCount > 0) {\n                const node = createFastDomNode(document.createElement('div'));\n                node.setClassName('view-ruler');\n                node.setWidth(rulerWidth);\n                this.domNode.appendChild(node);\n                this._renderedRulers.push(node);\n                addCount--;\n            }\n            return;\n        }\n        let removeCount = currentCount - desiredCount;\n        while (removeCount > 0) {\n            const node = this._renderedRulers.pop();\n            this.domNode.removeChild(node);\n            removeCount--;\n        }\n    }\n    render(ctx) {\n        this._ensureRulersCount();\n        for (let i = 0, len = this._rulers.length; i < len; i++) {\n            const node = this._renderedRulers[i];\n            const ruler = this._rulers[i];\n            node.setBoxShadow(ruler.color ? `1px 0 0 0 ${ruler.color} inset` : ``);\n            node.setHeight(Math.min(ctx.scrollHeight, 1000000));\n            node.setLeft(ruler.column * this._typicalHalfwidthCharacterWidth);\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './scrollDecoration.css';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { ViewPart } from '../../view/viewPart.js';\nexport class ScrollDecorationViewPart extends ViewPart {\n    constructor(context) {\n        super(context);\n        this._scrollTop = 0;\n        this._width = 0;\n        this._updateWidth();\n        this._shouldShow = false;\n        const options = this._context.configuration.options;\n        const scrollbar = options.get(97 /* EditorOption.scrollbar */);\n        this._useShadows = scrollbar.useShadows;\n        this._domNode = createFastDomNode(document.createElement('div'));\n        this._domNode.setAttribute('role', 'presentation');\n        this._domNode.setAttribute('aria-hidden', 'true');\n    }\n    dispose() {\n        super.dispose();\n    }\n    _updateShouldShow() {\n        const newShouldShow = (this._useShadows && this._scrollTop > 0);\n        if (this._shouldShow !== newShouldShow) {\n            this._shouldShow = newShouldShow;\n            return true;\n        }\n        return false;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    _updateWidth() {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        if (layoutInfo.minimap.renderMinimap === 0 || (layoutInfo.minimap.minimapWidth > 0 && layoutInfo.minimap.minimapLeft === 0)) {\n            this._width = layoutInfo.width;\n        }\n        else {\n            this._width = layoutInfo.width - layoutInfo.verticalScrollbarWidth;\n        }\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const scrollbar = options.get(97 /* EditorOption.scrollbar */);\n        this._useShadows = scrollbar.useShadows;\n        this._updateWidth();\n        this._updateShouldShow();\n        return true;\n    }\n    onScrollChanged(e) {\n        this._scrollTop = e.scrollTop;\n        return this._updateShouldShow();\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    render(ctx) {\n        this._domNode.setWidth(this._width);\n        this._domNode.setClassName(this._shouldShow ? 'scroll-decoration' : '');\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './selections.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport { editorSelectionForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nclass HorizontalRangeWithStyle {\n    constructor(other) {\n        this.left = other.left;\n        this.width = other.width;\n        this.startStyle = null;\n        this.endStyle = null;\n    }\n}\nclass LineVisibleRangesWithStyle {\n    constructor(lineNumber, ranges) {\n        this.lineNumber = lineNumber;\n        this.ranges = ranges;\n    }\n}\nfunction toStyledRange(item) {\n    return new HorizontalRangeWithStyle(item);\n}\nfunction toStyled(item) {\n    return new LineVisibleRangesWithStyle(item.lineNumber, item.ranges.map(toStyledRange));\n}\nclass SelectionsOverlay extends DynamicViewOverlay {\n    constructor(context) {\n        super();\n        this._previousFrameVisibleRangesWithStyle = [];\n        this._context = context;\n        const options = this._context.configuration.options;\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._roundedSelection = options.get(95 /* EditorOption.roundedSelection */);\n        this._typicalHalfwidthCharacterWidth = options.get(47 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n        this._selections = [];\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._roundedSelection = options.get(95 /* EditorOption.roundedSelection */);\n        this._typicalHalfwidthCharacterWidth = options.get(47 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n        return true;\n    }\n    onCursorStateChanged(e) {\n        this._selections = e.selections.slice(0);\n        return true;\n    }\n    onDecorationsChanged(e) {\n        // true for inline decorations that can end up relayouting text\n        return true; //e.inlineDecorationsChanged;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    _visibleRangesHaveGaps(linesVisibleRanges) {\n        for (let i = 0, len = linesVisibleRanges.length; i < len; i++) {\n            const lineVisibleRanges = linesVisibleRanges[i];\n            if (lineVisibleRanges.ranges.length > 1) {\n                // There are two ranges on the same line\n                return true;\n            }\n        }\n        return false;\n    }\n    _enrichVisibleRangesWithStyle(viewport, linesVisibleRanges, previousFrame) {\n        const epsilon = this._typicalHalfwidthCharacterWidth / 4;\n        let previousFrameTop = null;\n        let previousFrameBottom = null;\n        if (previousFrame && previousFrame.length > 0 && linesVisibleRanges.length > 0) {\n            const topLineNumber = linesVisibleRanges[0].lineNumber;\n            if (topLineNumber === viewport.startLineNumber) {\n                for (let i = 0; !previousFrameTop && i < previousFrame.length; i++) {\n                    if (previousFrame[i].lineNumber === topLineNumber) {\n                        previousFrameTop = previousFrame[i].ranges[0];\n                    }\n                }\n            }\n            const bottomLineNumber = linesVisibleRanges[linesVisibleRanges.length - 1].lineNumber;\n            if (bottomLineNumber === viewport.endLineNumber) {\n                for (let i = previousFrame.length - 1; !previousFrameBottom && i >= 0; i--) {\n                    if (previousFrame[i].lineNumber === bottomLineNumber) {\n                        previousFrameBottom = previousFrame[i].ranges[0];\n                    }\n                }\n            }\n            if (previousFrameTop && !previousFrameTop.startStyle) {\n                previousFrameTop = null;\n            }\n            if (previousFrameBottom && !previousFrameBottom.startStyle) {\n                previousFrameBottom = null;\n            }\n        }\n        for (let i = 0, len = linesVisibleRanges.length; i < len; i++) {\n            // We know for a fact that there is precisely one range on each line\n            const curLineRange = linesVisibleRanges[i].ranges[0];\n            const curLeft = curLineRange.left;\n            const curRight = curLineRange.left + curLineRange.width;\n            const startStyle = {\n                top: 0 /* CornerStyle.EXTERN */,\n                bottom: 0 /* CornerStyle.EXTERN */\n            };\n            const endStyle = {\n                top: 0 /* CornerStyle.EXTERN */,\n                bottom: 0 /* CornerStyle.EXTERN */\n            };\n            if (i > 0) {\n                // Look above\n                const prevLeft = linesVisibleRanges[i - 1].ranges[0].left;\n                const prevRight = linesVisibleRanges[i - 1].ranges[0].left + linesVisibleRanges[i - 1].ranges[0].width;\n                if (abs(curLeft - prevLeft) < epsilon) {\n                    startStyle.top = 2 /* CornerStyle.FLAT */;\n                }\n                else if (curLeft > prevLeft) {\n                    startStyle.top = 1 /* CornerStyle.INTERN */;\n                }\n                if (abs(curRight - prevRight) < epsilon) {\n                    endStyle.top = 2 /* CornerStyle.FLAT */;\n                }\n                else if (prevLeft < curRight && curRight < prevRight) {\n                    endStyle.top = 1 /* CornerStyle.INTERN */;\n                }\n            }\n            else if (previousFrameTop) {\n                // Accept some hiccups near the viewport edges to save on repaints\n                startStyle.top = previousFrameTop.startStyle.top;\n                endStyle.top = previousFrameTop.endStyle.top;\n            }\n            if (i + 1 < len) {\n                // Look below\n                const nextLeft = linesVisibleRanges[i + 1].ranges[0].left;\n                const nextRight = linesVisibleRanges[i + 1].ranges[0].left + linesVisibleRanges[i + 1].ranges[0].width;\n                if (abs(curLeft - nextLeft) < epsilon) {\n                    startStyle.bottom = 2 /* CornerStyle.FLAT */;\n                }\n                else if (nextLeft < curLeft && curLeft < nextRight) {\n                    startStyle.bottom = 1 /* CornerStyle.INTERN */;\n                }\n                if (abs(curRight - nextRight) < epsilon) {\n                    endStyle.bottom = 2 /* CornerStyle.FLAT */;\n                }\n                else if (curRight < nextRight) {\n                    endStyle.bottom = 1 /* CornerStyle.INTERN */;\n                }\n            }\n            else if (previousFrameBottom) {\n                // Accept some hiccups near the viewport edges to save on repaints\n                startStyle.bottom = previousFrameBottom.startStyle.bottom;\n                endStyle.bottom = previousFrameBottom.endStyle.bottom;\n            }\n            curLineRange.startStyle = startStyle;\n            curLineRange.endStyle = endStyle;\n        }\n    }\n    _getVisibleRangesWithStyle(selection, ctx, previousFrame) {\n        const _linesVisibleRanges = ctx.linesVisibleRangesForRange(selection, true) || [];\n        const linesVisibleRanges = _linesVisibleRanges.map(toStyled);\n        const visibleRangesHaveGaps = this._visibleRangesHaveGaps(linesVisibleRanges);\n        if (!visibleRangesHaveGaps && this._roundedSelection) {\n            this._enrichVisibleRangesWithStyle(ctx.visibleRange, linesVisibleRanges, previousFrame);\n        }\n        // The visible ranges are sorted TOP-BOTTOM and LEFT-RIGHT\n        return linesVisibleRanges;\n    }\n    _createSelectionPiece(top, height, className, left, width) {\n        return ('<div class=\"cslr '\n            + className\n            + '\" style=\"top:'\n            + top.toString()\n            + 'px;left:'\n            + left.toString()\n            + 'px;width:'\n            + width.toString()\n            + 'px;height:'\n            + height\n            + 'px;\"></div>');\n    }\n    _actualRenderOneSelection(output2, visibleStartLineNumber, hasMultipleSelections, visibleRanges) {\n        if (visibleRanges.length === 0) {\n            return;\n        }\n        const visibleRangesHaveStyle = !!visibleRanges[0].ranges[0].startStyle;\n        const fullLineHeight = (this._lineHeight).toString();\n        const reducedLineHeight = (this._lineHeight - 1).toString();\n        const firstLineNumber = visibleRanges[0].lineNumber;\n        const lastLineNumber = visibleRanges[visibleRanges.length - 1].lineNumber;\n        for (let i = 0, len = visibleRanges.length; i < len; i++) {\n            const lineVisibleRanges = visibleRanges[i];\n            const lineNumber = lineVisibleRanges.lineNumber;\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            const lineHeight = hasMultipleSelections ? (lineNumber === lastLineNumber || lineNumber === firstLineNumber ? reducedLineHeight : fullLineHeight) : fullLineHeight;\n            const top = hasMultipleSelections ? (lineNumber === firstLineNumber ? 1 : 0) : 0;\n            let innerCornerOutput = '';\n            let restOfSelectionOutput = '';\n            for (let j = 0, lenJ = lineVisibleRanges.ranges.length; j < lenJ; j++) {\n                const visibleRange = lineVisibleRanges.ranges[j];\n                if (visibleRangesHaveStyle) {\n                    const startStyle = visibleRange.startStyle;\n                    const endStyle = visibleRange.endStyle;\n                    if (startStyle.top === 1 /* CornerStyle.INTERN */ || startStyle.bottom === 1 /* CornerStyle.INTERN */) {\n                        // Reverse rounded corner to the left\n                        // First comes the selection (blue layer)\n                        innerCornerOutput += this._createSelectionPiece(top, lineHeight, SelectionsOverlay.SELECTION_CLASS_NAME, visibleRange.left - SelectionsOverlay.ROUNDED_PIECE_WIDTH, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\n                        // Second comes the background (white layer) with inverse border radius\n                        let className = SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;\n                        if (startStyle.top === 1 /* CornerStyle.INTERN */) {\n                            className += ' ' + SelectionsOverlay.SELECTION_TOP_RIGHT;\n                        }\n                        if (startStyle.bottom === 1 /* CornerStyle.INTERN */) {\n                            className += ' ' + SelectionsOverlay.SELECTION_BOTTOM_RIGHT;\n                        }\n                        innerCornerOutput += this._createSelectionPiece(top, lineHeight, className, visibleRange.left - SelectionsOverlay.ROUNDED_PIECE_WIDTH, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\n                    }\n                    if (endStyle.top === 1 /* CornerStyle.INTERN */ || endStyle.bottom === 1 /* CornerStyle.INTERN */) {\n                        // Reverse rounded corner to the right\n                        // First comes the selection (blue layer)\n                        innerCornerOutput += this._createSelectionPiece(top, lineHeight, SelectionsOverlay.SELECTION_CLASS_NAME, visibleRange.left + visibleRange.width, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\n                        // Second comes the background (white layer) with inverse border radius\n                        let className = SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;\n                        if (endStyle.top === 1 /* CornerStyle.INTERN */) {\n                            className += ' ' + SelectionsOverlay.SELECTION_TOP_LEFT;\n                        }\n                        if (endStyle.bottom === 1 /* CornerStyle.INTERN */) {\n                            className += ' ' + SelectionsOverlay.SELECTION_BOTTOM_LEFT;\n                        }\n                        innerCornerOutput += this._createSelectionPiece(top, lineHeight, className, visibleRange.left + visibleRange.width, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\n                    }\n                }\n                let className = SelectionsOverlay.SELECTION_CLASS_NAME;\n                if (visibleRangesHaveStyle) {\n                    const startStyle = visibleRange.startStyle;\n                    const endStyle = visibleRange.endStyle;\n                    if (startStyle.top === 0 /* CornerStyle.EXTERN */) {\n                        className += ' ' + SelectionsOverlay.SELECTION_TOP_LEFT;\n                    }\n                    if (startStyle.bottom === 0 /* CornerStyle.EXTERN */) {\n                        className += ' ' + SelectionsOverlay.SELECTION_BOTTOM_LEFT;\n                    }\n                    if (endStyle.top === 0 /* CornerStyle.EXTERN */) {\n                        className += ' ' + SelectionsOverlay.SELECTION_TOP_RIGHT;\n                    }\n                    if (endStyle.bottom === 0 /* CornerStyle.EXTERN */) {\n                        className += ' ' + SelectionsOverlay.SELECTION_BOTTOM_RIGHT;\n                    }\n                }\n                restOfSelectionOutput += this._createSelectionPiece(top, lineHeight, className, visibleRange.left, visibleRange.width);\n            }\n            output2[lineIndex][0] += innerCornerOutput;\n            output2[lineIndex][1] += restOfSelectionOutput;\n        }\n    }\n    prepareRender(ctx) {\n        // Build HTML for inner corners separate from HTML for the rest of selections,\n        // as the inner corner HTML can interfere with that of other selections.\n        // In final render, make sure to place the inner corner HTML before the rest of selection HTML. See issue #77777.\n        const output = [];\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            output[lineIndex] = ['', ''];\n        }\n        const thisFrameVisibleRangesWithStyle = [];\n        for (let i = 0, len = this._selections.length; i < len; i++) {\n            const selection = this._selections[i];\n            if (selection.isEmpty()) {\n                thisFrameVisibleRangesWithStyle[i] = null;\n                continue;\n            }\n            const visibleRangesWithStyle = this._getVisibleRangesWithStyle(selection, ctx, this._previousFrameVisibleRangesWithStyle[i]);\n            thisFrameVisibleRangesWithStyle[i] = visibleRangesWithStyle;\n            this._actualRenderOneSelection(output, visibleStartLineNumber, this._selections.length > 1, visibleRangesWithStyle);\n        }\n        this._previousFrameVisibleRangesWithStyle = thisFrameVisibleRangesWithStyle;\n        this._renderResult = output.map(([internalCorners, restOfSelection]) => internalCorners + restOfSelection);\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\n            return '';\n        }\n        return this._renderResult[lineIndex];\n    }\n}\nSelectionsOverlay.SELECTION_CLASS_NAME = 'selected-text';\nSelectionsOverlay.SELECTION_TOP_LEFT = 'top-left-radius';\nSelectionsOverlay.SELECTION_BOTTOM_LEFT = 'bottom-left-radius';\nSelectionsOverlay.SELECTION_TOP_RIGHT = 'top-right-radius';\nSelectionsOverlay.SELECTION_BOTTOM_RIGHT = 'bottom-right-radius';\nSelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME = 'monaco-editor-background';\nSelectionsOverlay.ROUNDED_PIECE_WIDTH = 10;\nexport { SelectionsOverlay };\nregisterThemingParticipant((theme, collector) => {\n    const editorSelectionForegroundColor = theme.getColor(editorSelectionForeground);\n    if (editorSelectionForegroundColor && !editorSelectionForegroundColor.isTransparent()) {\n        collector.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${editorSelectionForegroundColor}; }`);\n    }\n});\nfunction abs(n) {\n    return n < 0 ? -n : n;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { applyFontInfo } from '../../config/domFontInfo.js';\nimport { TextEditorCursorStyle } from '../../../common/config/editorOptions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { MOUSE_CURSOR_TEXT_CSS_CLASS_NAME } from '../../../../base/browser/ui/mouseCursor/mouseCursor.js';\nclass ViewCursorRenderData {\n    constructor(top, left, paddingLeft, width, height, textContent, textContentClassName) {\n        this.top = top;\n        this.left = left;\n        this.paddingLeft = paddingLeft;\n        this.width = width;\n        this.height = height;\n        this.textContent = textContent;\n        this.textContentClassName = textContentClassName;\n    }\n}\nexport class ViewCursor {\n    constructor(context) {\n        this._context = context;\n        const options = this._context.configuration.options;\n        const fontInfo = options.get(47 /* EditorOption.fontInfo */);\n        this._cursorStyle = options.get(25 /* EditorOption.cursorStyle */);\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n        this._lineCursorWidth = Math.min(options.get(28 /* EditorOption.cursorWidth */), this._typicalHalfwidthCharacterWidth);\n        this._isVisible = true;\n        // Create the dom node\n        this._domNode = createFastDomNode(document.createElement('div'));\n        this._domNode.setClassName(`cursor ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`);\n        this._domNode.setHeight(this._lineHeight);\n        this._domNode.setTop(0);\n        this._domNode.setLeft(0);\n        applyFontInfo(this._domNode, fontInfo);\n        this._domNode.setDisplay('none');\n        this._position = new Position(1, 1);\n        this._lastRenderedContent = '';\n        this._renderData = null;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return this._position;\n    }\n    show() {\n        if (!this._isVisible) {\n            this._domNode.setVisibility('inherit');\n            this._isVisible = true;\n        }\n    }\n    hide() {\n        if (this._isVisible) {\n            this._domNode.setVisibility('hidden');\n            this._isVisible = false;\n        }\n    }\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const fontInfo = options.get(47 /* EditorOption.fontInfo */);\n        this._cursorStyle = options.get(25 /* EditorOption.cursorStyle */);\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n        this._lineCursorWidth = Math.min(options.get(28 /* EditorOption.cursorWidth */), this._typicalHalfwidthCharacterWidth);\n        applyFontInfo(this._domNode, fontInfo);\n        return true;\n    }\n    onCursorPositionChanged(position, pauseAnimation) {\n        if (pauseAnimation) {\n            this._domNode.domNode.style.transitionProperty = 'none';\n        }\n        else {\n            this._domNode.domNode.style.transitionProperty = '';\n        }\n        this._position = position;\n        return true;\n    }\n    /**\n     * If `this._position` is inside a grapheme, returns the position where the grapheme starts.\n     * Also returns the next grapheme.\n     */\n    _getGraphemeAwarePosition() {\n        const { lineNumber, column } = this._position;\n        const lineContent = this._context.viewModel.getLineContent(lineNumber);\n        const [startOffset, endOffset] = strings.getCharContainingOffset(lineContent, column - 1);\n        return [new Position(lineNumber, startOffset + 1), lineContent.substring(startOffset, endOffset)];\n    }\n    _prepareRender(ctx) {\n        let textContent = '';\n        let textContentClassName = '';\n        const [position, nextGrapheme] = this._getGraphemeAwarePosition();\n        if (this._cursorStyle === TextEditorCursorStyle.Line || this._cursorStyle === TextEditorCursorStyle.LineThin) {\n            const visibleRange = ctx.visibleRangeForPosition(position);\n            if (!visibleRange || visibleRange.outsideRenderedLine) {\n                // Outside viewport\n                return null;\n            }\n            let width;\n            if (this._cursorStyle === TextEditorCursorStyle.Line) {\n                width = dom.computeScreenAwareSize(this._lineCursorWidth > 0 ? this._lineCursorWidth : 2);\n                if (width > 2) {\n                    textContent = nextGrapheme;\n                    textContentClassName = this._getTokenClassName(position);\n                }\n            }\n            else {\n                width = dom.computeScreenAwareSize(1);\n            }\n            let left = visibleRange.left;\n            let paddingLeft = 0;\n            if (width >= 2 && left >= 1) {\n                // shift the cursor a bit between the characters\n                paddingLeft = 1;\n                left -= paddingLeft;\n            }\n            const top = ctx.getVerticalOffsetForLineNumber(position.lineNumber) - ctx.bigNumbersDelta;\n            return new ViewCursorRenderData(top, left, paddingLeft, width, this._lineHeight, textContent, textContentClassName);\n        }\n        const visibleRangeForCharacter = ctx.linesVisibleRangesForRange(new Range(position.lineNumber, position.column, position.lineNumber, position.column + nextGrapheme.length), false);\n        if (!visibleRangeForCharacter || visibleRangeForCharacter.length === 0) {\n            // Outside viewport\n            return null;\n        }\n        const firstVisibleRangeForCharacter = visibleRangeForCharacter[0];\n        if (firstVisibleRangeForCharacter.outsideRenderedLine || firstVisibleRangeForCharacter.ranges.length === 0) {\n            // Outside viewport\n            return null;\n        }\n        const range = firstVisibleRangeForCharacter.ranges[0];\n        const width = (nextGrapheme === '\\t'\n            ? this._typicalHalfwidthCharacterWidth\n            : (range.width < 1\n                ? this._typicalHalfwidthCharacterWidth\n                : range.width));\n        if (this._cursorStyle === TextEditorCursorStyle.Block) {\n            textContent = nextGrapheme;\n            textContentClassName = this._getTokenClassName(position);\n        }\n        let top = ctx.getVerticalOffsetForLineNumber(position.lineNumber) - ctx.bigNumbersDelta;\n        let height = this._lineHeight;\n        // Underline might interfere with clicking\n        if (this._cursorStyle === TextEditorCursorStyle.Underline || this._cursorStyle === TextEditorCursorStyle.UnderlineThin) {\n            top += this._lineHeight - 2;\n            height = 2;\n        }\n        return new ViewCursorRenderData(top, range.left, 0, width, height, textContent, textContentClassName);\n    }\n    _getTokenClassName(position) {\n        const lineData = this._context.viewModel.getViewLineData(position.lineNumber);\n        const tokenIndex = lineData.tokens.findTokenIndexAtOffset(position.column - 1);\n        return lineData.tokens.getClassName(tokenIndex);\n    }\n    prepareRender(ctx) {\n        this._renderData = this._prepareRender(ctx);\n    }\n    render(ctx) {\n        if (!this._renderData) {\n            this._domNode.setDisplay('none');\n            return null;\n        }\n        if (this._lastRenderedContent !== this._renderData.textContent) {\n            this._lastRenderedContent = this._renderData.textContent;\n            this._domNode.domNode.textContent = this._lastRenderedContent;\n        }\n        this._domNode.setClassName(`cursor ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME} ${this._renderData.textContentClassName}`);\n        this._domNode.setDisplay('block');\n        this._domNode.setTop(this._renderData.top);\n        this._domNode.setLeft(this._renderData.left);\n        this._domNode.setPaddingLeft(this._renderData.paddingLeft);\n        this._domNode.setWidth(this._renderData.width);\n        this._domNode.setLineHeight(this._renderData.height);\n        this._domNode.setHeight(this._renderData.height);\n        return {\n            domNode: this._domNode.domNode,\n            position: this._position,\n            contentLeft: this._renderData.left,\n            height: this._renderData.height,\n            width: 2\n        };\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './viewCursors.css';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { IntervalTimer, TimeoutTimer } from '../../../../base/common/async.js';\nimport { ViewPart } from '../../view/viewPart.js';\nimport { ViewCursor } from './viewCursor.js';\nimport { TextEditorCursorStyle } from '../../../common/config/editorOptions.js';\nimport { editorCursorBackground, editorCursorForeground } from '../../../common/core/editorColorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nclass ViewCursors extends ViewPart {\n    constructor(context) {\n        super(context);\n        const options = this._context.configuration.options;\n        this._readOnly = options.get(86 /* EditorOption.readOnly */);\n        this._cursorBlinking = options.get(23 /* EditorOption.cursorBlinking */);\n        this._cursorStyle = options.get(25 /* EditorOption.cursorStyle */);\n        this._cursorSmoothCaretAnimation = options.get(24 /* EditorOption.cursorSmoothCaretAnimation */);\n        this._selectionIsEmpty = true;\n        this._isComposingInput = false;\n        this._isVisible = false;\n        this._primaryCursor = new ViewCursor(this._context);\n        this._secondaryCursors = [];\n        this._renderData = [];\n        this._domNode = createFastDomNode(document.createElement('div'));\n        this._domNode.setAttribute('role', 'presentation');\n        this._domNode.setAttribute('aria-hidden', 'true');\n        this._updateDomClassName();\n        this._domNode.appendChild(this._primaryCursor.getDomNode());\n        this._startCursorBlinkAnimation = new TimeoutTimer();\n        this._cursorFlatBlinkInterval = new IntervalTimer();\n        this._blinkingEnabled = false;\n        this._editorHasFocus = false;\n        this._updateBlinking();\n    }\n    dispose() {\n        super.dispose();\n        this._startCursorBlinkAnimation.dispose();\n        this._cursorFlatBlinkInterval.dispose();\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    // --- begin event handlers\n    onCompositionStart(e) {\n        this._isComposingInput = true;\n        this._updateBlinking();\n        return true;\n    }\n    onCompositionEnd(e) {\n        this._isComposingInput = false;\n        this._updateBlinking();\n        return true;\n    }\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        this._readOnly = options.get(86 /* EditorOption.readOnly */);\n        this._cursorBlinking = options.get(23 /* EditorOption.cursorBlinking */);\n        this._cursorStyle = options.get(25 /* EditorOption.cursorStyle */);\n        this._cursorSmoothCaretAnimation = options.get(24 /* EditorOption.cursorSmoothCaretAnimation */);\n        this._updateBlinking();\n        this._updateDomClassName();\n        this._primaryCursor.onConfigurationChanged(e);\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n            this._secondaryCursors[i].onConfigurationChanged(e);\n        }\n        return true;\n    }\n    _onCursorPositionChanged(position, secondaryPositions, reason) {\n        const pauseAnimation = (this._secondaryCursors.length !== secondaryPositions.length\n            || (this._cursorSmoothCaretAnimation === 'explicit' && reason !== 3 /* CursorChangeReason.Explicit */));\n        this._primaryCursor.onCursorPositionChanged(position, pauseAnimation);\n        this._updateBlinking();\n        if (this._secondaryCursors.length < secondaryPositions.length) {\n            // Create new cursors\n            const addCnt = secondaryPositions.length - this._secondaryCursors.length;\n            for (let i = 0; i < addCnt; i++) {\n                const newCursor = new ViewCursor(this._context);\n                this._domNode.domNode.insertBefore(newCursor.getDomNode().domNode, this._primaryCursor.getDomNode().domNode.nextSibling);\n                this._secondaryCursors.push(newCursor);\n            }\n        }\n        else if (this._secondaryCursors.length > secondaryPositions.length) {\n            // Remove some cursors\n            const removeCnt = this._secondaryCursors.length - secondaryPositions.length;\n            for (let i = 0; i < removeCnt; i++) {\n                this._domNode.removeChild(this._secondaryCursors[0].getDomNode());\n                this._secondaryCursors.splice(0, 1);\n            }\n        }\n        for (let i = 0; i < secondaryPositions.length; i++) {\n            this._secondaryCursors[i].onCursorPositionChanged(secondaryPositions[i], pauseAnimation);\n        }\n    }\n    onCursorStateChanged(e) {\n        const positions = [];\n        for (let i = 0, len = e.selections.length; i < len; i++) {\n            positions[i] = e.selections[i].getPosition();\n        }\n        this._onCursorPositionChanged(positions[0], positions.slice(1), e.reason);\n        const selectionIsEmpty = e.selections[0].isEmpty();\n        if (this._selectionIsEmpty !== selectionIsEmpty) {\n            this._selectionIsEmpty = selectionIsEmpty;\n            this._updateDomClassName();\n        }\n        return true;\n    }\n    onDecorationsChanged(e) {\n        // true for inline decorations that can end up relayouting text\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onFocusChanged(e) {\n        this._editorHasFocus = e.isFocused;\n        this._updateBlinking();\n        return false;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return true;\n    }\n    onTokensChanged(e) {\n        const shouldRender = (position) => {\n            for (let i = 0, len = e.ranges.length; i < len; i++) {\n                if (e.ranges[i].fromLineNumber <= position.lineNumber && position.lineNumber <= e.ranges[i].toLineNumber) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        if (shouldRender(this._primaryCursor.getPosition())) {\n            return true;\n        }\n        for (const secondaryCursor of this._secondaryCursors) {\n            if (shouldRender(secondaryCursor.getPosition())) {\n                return true;\n            }\n        }\n        return false;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    // ---- blinking logic\n    _getCursorBlinking() {\n        if (this._isComposingInput) {\n            // avoid double cursors\n            return 0 /* TextEditorCursorBlinkingStyle.Hidden */;\n        }\n        if (!this._editorHasFocus) {\n            return 0 /* TextEditorCursorBlinkingStyle.Hidden */;\n        }\n        if (this._readOnly) {\n            return 5 /* TextEditorCursorBlinkingStyle.Solid */;\n        }\n        return this._cursorBlinking;\n    }\n    _updateBlinking() {\n        this._startCursorBlinkAnimation.cancel();\n        this._cursorFlatBlinkInterval.cancel();\n        const blinkingStyle = this._getCursorBlinking();\n        // hidden and solid are special as they involve no animations\n        const isHidden = (blinkingStyle === 0 /* TextEditorCursorBlinkingStyle.Hidden */);\n        const isSolid = (blinkingStyle === 5 /* TextEditorCursorBlinkingStyle.Solid */);\n        if (isHidden) {\n            this._hide();\n        }\n        else {\n            this._show();\n        }\n        this._blinkingEnabled = false;\n        this._updateDomClassName();\n        if (!isHidden && !isSolid) {\n            if (blinkingStyle === 1 /* TextEditorCursorBlinkingStyle.Blink */) {\n                // flat blinking is handled by JavaScript to save battery life due to Chromium step timing issue https://bugs.chromium.org/p/chromium/issues/detail?id=361587\n                this._cursorFlatBlinkInterval.cancelAndSet(() => {\n                    if (this._isVisible) {\n                        this._hide();\n                    }\n                    else {\n                        this._show();\n                    }\n                }, ViewCursors.BLINK_INTERVAL);\n            }\n            else {\n                this._startCursorBlinkAnimation.setIfNotSet(() => {\n                    this._blinkingEnabled = true;\n                    this._updateDomClassName();\n                }, ViewCursors.BLINK_INTERVAL);\n            }\n        }\n    }\n    // --- end blinking logic\n    _updateDomClassName() {\n        this._domNode.setClassName(this._getClassName());\n    }\n    _getClassName() {\n        let result = 'cursors-layer';\n        if (!this._selectionIsEmpty) {\n            result += ' has-selection';\n        }\n        switch (this._cursorStyle) {\n            case TextEditorCursorStyle.Line:\n                result += ' cursor-line-style';\n                break;\n            case TextEditorCursorStyle.Block:\n                result += ' cursor-block-style';\n                break;\n            case TextEditorCursorStyle.Underline:\n                result += ' cursor-underline-style';\n                break;\n            case TextEditorCursorStyle.LineThin:\n                result += ' cursor-line-thin-style';\n                break;\n            case TextEditorCursorStyle.BlockOutline:\n                result += ' cursor-block-outline-style';\n                break;\n            case TextEditorCursorStyle.UnderlineThin:\n                result += ' cursor-underline-thin-style';\n                break;\n            default:\n                result += ' cursor-line-style';\n        }\n        if (this._blinkingEnabled) {\n            switch (this._getCursorBlinking()) {\n                case 1 /* TextEditorCursorBlinkingStyle.Blink */:\n                    result += ' cursor-blink';\n                    break;\n                case 2 /* TextEditorCursorBlinkingStyle.Smooth */:\n                    result += ' cursor-smooth';\n                    break;\n                case 3 /* TextEditorCursorBlinkingStyle.Phase */:\n                    result += ' cursor-phase';\n                    break;\n                case 4 /* TextEditorCursorBlinkingStyle.Expand */:\n                    result += ' cursor-expand';\n                    break;\n                case 5 /* TextEditorCursorBlinkingStyle.Solid */:\n                    result += ' cursor-solid';\n                    break;\n                default:\n                    result += ' cursor-solid';\n            }\n        }\n        else {\n            result += ' cursor-solid';\n        }\n        if (this._cursorSmoothCaretAnimation === 'on' || this._cursorSmoothCaretAnimation === 'explicit') {\n            result += ' cursor-smooth-caret-animation';\n        }\n        return result;\n    }\n    _show() {\n        this._primaryCursor.show();\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n            this._secondaryCursors[i].show();\n        }\n        this._isVisible = true;\n    }\n    _hide() {\n        this._primaryCursor.hide();\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n            this._secondaryCursors[i].hide();\n        }\n        this._isVisible = false;\n    }\n    // ---- IViewPart implementation\n    prepareRender(ctx) {\n        this._primaryCursor.prepareRender(ctx);\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n            this._secondaryCursors[i].prepareRender(ctx);\n        }\n    }\n    render(ctx) {\n        const renderData = [];\n        let renderDataLen = 0;\n        const primaryRenderData = this._primaryCursor.render(ctx);\n        if (primaryRenderData) {\n            renderData[renderDataLen++] = primaryRenderData;\n        }\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n            const secondaryRenderData = this._secondaryCursors[i].render(ctx);\n            if (secondaryRenderData) {\n                renderData[renderDataLen++] = secondaryRenderData;\n            }\n        }\n        this._renderData = renderData;\n    }\n    getLastRenderData() {\n        return this._renderData;\n    }\n}\nViewCursors.BLINK_INTERVAL = 500;\nexport { ViewCursors };\nregisterThemingParticipant((theme, collector) => {\n    const caret = theme.getColor(editorCursorForeground);\n    if (caret) {\n        let caretBackground = theme.getColor(editorCursorBackground);\n        if (!caretBackground) {\n            caretBackground = caret.opposite();\n        }\n        collector.addRule(`.monaco-editor .cursors-layer .cursor { background-color: ${caret}; border-color: ${caret}; color: ${caretBackground}; }`);\n        if (isHighContrast(theme.type)) {\n            collector.addRule(`.monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid ${caretBackground}; border-right: 1px solid ${caretBackground}; }`);\n        }\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { ViewPart } from '../../view/viewPart.js';\nimport { Position } from '../../../common/core/position.js';\nconst invalidFunc = () => { throw new Error(`Invalid change accessor`); };\nexport class ViewZones extends ViewPart {\n    constructor(context) {\n        super(context);\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._contentWidth = layoutInfo.contentWidth;\n        this._contentLeft = layoutInfo.contentLeft;\n        this.domNode = createFastDomNode(document.createElement('div'));\n        this.domNode.setClassName('view-zones');\n        this.domNode.setPosition('absolute');\n        this.domNode.setAttribute('role', 'presentation');\n        this.domNode.setAttribute('aria-hidden', 'true');\n        this.marginDomNode = createFastDomNode(document.createElement('div'));\n        this.marginDomNode.setClassName('margin-view-zones');\n        this.marginDomNode.setPosition('absolute');\n        this.marginDomNode.setAttribute('role', 'presentation');\n        this.marginDomNode.setAttribute('aria-hidden', 'true');\n        this._zones = {};\n    }\n    dispose() {\n        super.dispose();\n        this._zones = {};\n    }\n    // ---- begin view event handlers\n    _recomputeWhitespacesProps() {\n        const whitespaces = this._context.viewLayout.getWhitespaces();\n        const oldWhitespaces = new Map();\n        for (const whitespace of whitespaces) {\n            oldWhitespaces.set(whitespace.id, whitespace);\n        }\n        let hadAChange = false;\n        this._context.viewModel.changeWhitespace((whitespaceAccessor) => {\n            const keys = Object.keys(this._zones);\n            for (let i = 0, len = keys.length; i < len; i++) {\n                const id = keys[i];\n                const zone = this._zones[id];\n                const props = this._computeWhitespaceProps(zone.delegate);\n                zone.isInHiddenArea = props.isInHiddenArea;\n                const oldWhitespace = oldWhitespaces.get(id);\n                if (oldWhitespace && (oldWhitespace.afterLineNumber !== props.afterViewLineNumber || oldWhitespace.height !== props.heightInPx)) {\n                    whitespaceAccessor.changeOneWhitespace(id, props.afterViewLineNumber, props.heightInPx);\n                    this._safeCallOnComputedHeight(zone.delegate, props.heightInPx);\n                    hadAChange = true;\n                }\n            }\n        });\n        return hadAChange;\n    }\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this._contentWidth = layoutInfo.contentWidth;\n        this._contentLeft = layoutInfo.contentLeft;\n        if (e.hasChanged(63 /* EditorOption.lineHeight */)) {\n            this._recomputeWhitespacesProps();\n        }\n        return true;\n    }\n    onLineMappingChanged(e) {\n        return this._recomputeWhitespacesProps();\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged || e.scrollWidthChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    // ---- end view event handlers\n    _getZoneOrdinal(zone) {\n        if (typeof zone.afterColumn !== 'undefined') {\n            return zone.afterColumn;\n        }\n        return 10000;\n    }\n    _computeWhitespaceProps(zone) {\n        if (zone.afterLineNumber === 0) {\n            return {\n                isInHiddenArea: false,\n                afterViewLineNumber: 0,\n                heightInPx: this._heightInPixels(zone),\n                minWidthInPx: this._minWidthInPixels(zone)\n            };\n        }\n        let zoneAfterModelPosition;\n        if (typeof zone.afterColumn !== 'undefined') {\n            zoneAfterModelPosition = this._context.viewModel.model.validatePosition({\n                lineNumber: zone.afterLineNumber,\n                column: zone.afterColumn\n            });\n        }\n        else {\n            const validAfterLineNumber = this._context.viewModel.model.validatePosition({\n                lineNumber: zone.afterLineNumber,\n                column: 1\n            }).lineNumber;\n            zoneAfterModelPosition = new Position(validAfterLineNumber, this._context.viewModel.model.getLineMaxColumn(validAfterLineNumber));\n        }\n        let zoneBeforeModelPosition;\n        if (zoneAfterModelPosition.column === this._context.viewModel.model.getLineMaxColumn(zoneAfterModelPosition.lineNumber)) {\n            zoneBeforeModelPosition = this._context.viewModel.model.validatePosition({\n                lineNumber: zoneAfterModelPosition.lineNumber + 1,\n                column: 1\n            });\n        }\n        else {\n            zoneBeforeModelPosition = this._context.viewModel.model.validatePosition({\n                lineNumber: zoneAfterModelPosition.lineNumber,\n                column: zoneAfterModelPosition.column + 1\n            });\n        }\n        const viewPosition = this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(zoneAfterModelPosition, zone.afterColumnAffinity);\n        const isVisible = this._context.viewModel.coordinatesConverter.modelPositionIsVisible(zoneBeforeModelPosition);\n        return {\n            isInHiddenArea: !isVisible,\n            afterViewLineNumber: viewPosition.lineNumber,\n            heightInPx: (isVisible ? this._heightInPixels(zone) : 0),\n            minWidthInPx: this._minWidthInPixels(zone)\n        };\n    }\n    changeViewZones(callback) {\n        let zonesHaveChanged = false;\n        this._context.viewModel.changeWhitespace((whitespaceAccessor) => {\n            const changeAccessor = {\n                addZone: (zone) => {\n                    zonesHaveChanged = true;\n                    return this._addZone(whitespaceAccessor, zone);\n                },\n                removeZone: (id) => {\n                    if (!id) {\n                        return;\n                    }\n                    zonesHaveChanged = this._removeZone(whitespaceAccessor, id) || zonesHaveChanged;\n                },\n                layoutZone: (id) => {\n                    if (!id) {\n                        return;\n                    }\n                    zonesHaveChanged = this._layoutZone(whitespaceAccessor, id) || zonesHaveChanged;\n                }\n            };\n            safeInvoke1Arg(callback, changeAccessor);\n            // Invalidate changeAccessor\n            changeAccessor.addZone = invalidFunc;\n            changeAccessor.removeZone = invalidFunc;\n            changeAccessor.layoutZone = invalidFunc;\n        });\n        return zonesHaveChanged;\n    }\n    _addZone(whitespaceAccessor, zone) {\n        const props = this._computeWhitespaceProps(zone);\n        const whitespaceId = whitespaceAccessor.insertWhitespace(props.afterViewLineNumber, this._getZoneOrdinal(zone), props.heightInPx, props.minWidthInPx);\n        const myZone = {\n            whitespaceId: whitespaceId,\n            delegate: zone,\n            isInHiddenArea: props.isInHiddenArea,\n            isVisible: false,\n            domNode: createFastDomNode(zone.domNode),\n            marginDomNode: zone.marginDomNode ? createFastDomNode(zone.marginDomNode) : null\n        };\n        this._safeCallOnComputedHeight(myZone.delegate, props.heightInPx);\n        myZone.domNode.setPosition('absolute');\n        myZone.domNode.domNode.style.width = '100%';\n        myZone.domNode.setDisplay('none');\n        myZone.domNode.setAttribute('monaco-view-zone', myZone.whitespaceId);\n        this.domNode.appendChild(myZone.domNode);\n        if (myZone.marginDomNode) {\n            myZone.marginDomNode.setPosition('absolute');\n            myZone.marginDomNode.domNode.style.width = '100%';\n            myZone.marginDomNode.setDisplay('none');\n            myZone.marginDomNode.setAttribute('monaco-view-zone', myZone.whitespaceId);\n            this.marginDomNode.appendChild(myZone.marginDomNode);\n        }\n        this._zones[myZone.whitespaceId] = myZone;\n        this.setShouldRender();\n        return myZone.whitespaceId;\n    }\n    _removeZone(whitespaceAccessor, id) {\n        if (this._zones.hasOwnProperty(id)) {\n            const zone = this._zones[id];\n            delete this._zones[id];\n            whitespaceAccessor.removeWhitespace(zone.whitespaceId);\n            zone.domNode.removeAttribute('monaco-visible-view-zone');\n            zone.domNode.removeAttribute('monaco-view-zone');\n            zone.domNode.domNode.parentNode.removeChild(zone.domNode.domNode);\n            if (zone.marginDomNode) {\n                zone.marginDomNode.removeAttribute('monaco-visible-view-zone');\n                zone.marginDomNode.removeAttribute('monaco-view-zone');\n                zone.marginDomNode.domNode.parentNode.removeChild(zone.marginDomNode.domNode);\n            }\n            this.setShouldRender();\n            return true;\n        }\n        return false;\n    }\n    _layoutZone(whitespaceAccessor, id) {\n        if (this._zones.hasOwnProperty(id)) {\n            const zone = this._zones[id];\n            const props = this._computeWhitespaceProps(zone.delegate);\n            zone.isInHiddenArea = props.isInHiddenArea;\n            // const newOrdinal = this._getZoneOrdinal(zone.delegate);\n            whitespaceAccessor.changeOneWhitespace(zone.whitespaceId, props.afterViewLineNumber, props.heightInPx);\n            // TODO@Alex: change `newOrdinal` too\n            this._safeCallOnComputedHeight(zone.delegate, props.heightInPx);\n            this.setShouldRender();\n            return true;\n        }\n        return false;\n    }\n    shouldSuppressMouseDownOnViewZone(id) {\n        if (this._zones.hasOwnProperty(id)) {\n            const zone = this._zones[id];\n            return Boolean(zone.delegate.suppressMouseDown);\n        }\n        return false;\n    }\n    _heightInPixels(zone) {\n        if (typeof zone.heightInPx === 'number') {\n            return zone.heightInPx;\n        }\n        if (typeof zone.heightInLines === 'number') {\n            return this._lineHeight * zone.heightInLines;\n        }\n        return this._lineHeight;\n    }\n    _minWidthInPixels(zone) {\n        if (typeof zone.minWidthInPx === 'number') {\n            return zone.minWidthInPx;\n        }\n        return 0;\n    }\n    _safeCallOnComputedHeight(zone, height) {\n        if (typeof zone.onComputedHeight === 'function') {\n            try {\n                zone.onComputedHeight(height);\n            }\n            catch (e) {\n                onUnexpectedError(e);\n            }\n        }\n    }\n    _safeCallOnDomNodeTop(zone, top) {\n        if (typeof zone.onDomNodeTop === 'function') {\n            try {\n                zone.onDomNodeTop(top);\n            }\n            catch (e) {\n                onUnexpectedError(e);\n            }\n        }\n    }\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    render(ctx) {\n        const visibleWhitespaces = ctx.viewportData.whitespaceViewportData;\n        const visibleZones = {};\n        let hasVisibleZone = false;\n        for (const visibleWhitespace of visibleWhitespaces) {\n            if (this._zones[visibleWhitespace.id].isInHiddenArea) {\n                continue;\n            }\n            visibleZones[visibleWhitespace.id] = visibleWhitespace;\n            hasVisibleZone = true;\n        }\n        const keys = Object.keys(this._zones);\n        for (let i = 0, len = keys.length; i < len; i++) {\n            const id = keys[i];\n            const zone = this._zones[id];\n            let newTop = 0;\n            let newHeight = 0;\n            let newDisplay = 'none';\n            if (visibleZones.hasOwnProperty(id)) {\n                newTop = visibleZones[id].verticalOffset - ctx.bigNumbersDelta;\n                newHeight = visibleZones[id].height;\n                newDisplay = 'block';\n                // zone is visible\n                if (!zone.isVisible) {\n                    zone.domNode.setAttribute('monaco-visible-view-zone', 'true');\n                    zone.isVisible = true;\n                }\n                this._safeCallOnDomNodeTop(zone.delegate, ctx.getScrolledTopFromAbsoluteTop(visibleZones[id].verticalOffset));\n            }\n            else {\n                if (zone.isVisible) {\n                    zone.domNode.removeAttribute('monaco-visible-view-zone');\n                    zone.isVisible = false;\n                }\n                this._safeCallOnDomNodeTop(zone.delegate, ctx.getScrolledTopFromAbsoluteTop(-1000000));\n            }\n            zone.domNode.setTop(newTop);\n            zone.domNode.setHeight(newHeight);\n            zone.domNode.setDisplay(newDisplay);\n            if (zone.marginDomNode) {\n                zone.marginDomNode.setTop(newTop);\n                zone.marginDomNode.setHeight(newHeight);\n                zone.marginDomNode.setDisplay(newDisplay);\n            }\n        }\n        if (hasVisibleZone) {\n            this.domNode.setWidth(Math.max(ctx.scrollWidth, this._contentWidth));\n            this.marginDomNode.setWidth(this._contentLeft);\n        }\n    }\n}\nfunction safeInvoke1Arg(func, arg1) {\n    try {\n        return func(arg1);\n    }\n    catch (e) {\n        onUnexpectedError(e);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport './blockDecorations.css';\nimport { ViewPart } from '../../view/viewPart.js';\nexport class BlockDecorations extends ViewPart {\n    constructor(context) {\n        super(context);\n        this.blocks = [];\n        this.contentWidth = -1;\n        this.domNode = createFastDomNode(document.createElement('div'));\n        this.domNode.setAttribute('role', 'presentation');\n        this.domNode.setAttribute('aria-hidden', 'true');\n        this.domNode.setClassName('blockDecorations-container');\n        this.update();\n    }\n    update() {\n        let didChange = false;\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        const newContentWidth = layoutInfo.contentWidth - layoutInfo.verticalScrollbarWidth;\n        if (this.contentWidth !== newContentWidth) {\n            this.contentWidth = newContentWidth;\n            didChange = true;\n        }\n        return didChange;\n    }\n    dispose() {\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        return this.update();\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged || e.scrollLeftChanged;\n    }\n    onDecorationsChanged(e) {\n        return true;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    render(ctx) {\n        let count = 0;\n        const decorations = ctx.getDecorationsInViewport();\n        for (const decoration of decorations) {\n            if (!decoration.options.blockClassName) {\n                continue;\n            }\n            let block = this.blocks[count];\n            if (!block) {\n                block = this.blocks[count] = createFastDomNode(document.createElement('div'));\n                this.domNode.appendChild(block);\n            }\n            let top;\n            let bottom;\n            if (decoration.options.blockIsAfterEnd) {\n                // range must be empty\n                top = ctx.getVerticalOffsetAfterLineNumber(decoration.range.endLineNumber, false);\n                bottom = ctx.getVerticalOffsetAfterLineNumber(decoration.range.endLineNumber, true);\n            }\n            else {\n                top = ctx.getVerticalOffsetForLineNumber(decoration.range.startLineNumber, true);\n                bottom = decoration.range.isEmpty()\n                    ? ctx.getVerticalOffsetForLineNumber(decoration.range.startLineNumber, false)\n                    : ctx.getVerticalOffsetAfterLineNumber(decoration.range.endLineNumber, true);\n            }\n            block.setClassName('blockDecorations-block ' + decoration.options.blockClassName);\n            block.setLeft(ctx.scrollLeft);\n            block.setWidth(this.contentWidth);\n            block.setTop(top);\n            block.setHeight(bottom - top);\n            count++;\n        }\n        for (let i = count; i < this.blocks.length; i++) {\n            this.blocks[i].domNode.remove();\n        }\n        this.blocks.length = count;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './whitespace.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { LineRange } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { Position } from '../../../common/core/position.js';\nimport { editorWhitespaces } from '../../../common/core/editorColorRegistry.js';\nexport class WhitespaceOverlay extends DynamicViewOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        this._options = new WhitespaceOptions(this._context.configuration);\n        this._selection = [];\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const newOptions = new WhitespaceOptions(this._context.configuration);\n        if (this._options.equals(newOptions)) {\n            return e.hasChanged(138 /* EditorOption.layoutInfo */);\n        }\n        this._options = newOptions;\n        return true;\n    }\n    onCursorStateChanged(e) {\n        this._selection = e.selections;\n        if (this._options.renderWhitespace === 'selection') {\n            return true;\n        }\n        return false;\n    }\n    onDecorationsChanged(e) {\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        if (this._options.renderWhitespace === 'none') {\n            this._renderResult = null;\n            return;\n        }\n        const startLineNumber = ctx.visibleRange.startLineNumber;\n        const endLineNumber = ctx.visibleRange.endLineNumber;\n        const lineCount = endLineNumber - startLineNumber + 1;\n        const needed = new Array(lineCount);\n        for (let i = 0; i < lineCount; i++) {\n            needed[i] = true;\n        }\n        const viewportData = this._context.viewModel.getMinimapLinesRenderingData(ctx.viewportData.startLineNumber, ctx.viewportData.endLineNumber, needed);\n        this._renderResult = [];\n        for (let lineNumber = ctx.viewportData.startLineNumber; lineNumber <= ctx.viewportData.endLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - ctx.viewportData.startLineNumber;\n            const lineData = viewportData.data[lineIndex];\n            let selectionsOnLine = null;\n            if (this._options.renderWhitespace === 'selection') {\n                const selections = this._selection;\n                for (const selection of selections) {\n                    if (selection.endLineNumber < lineNumber || selection.startLineNumber > lineNumber) {\n                        // Selection does not intersect line\n                        continue;\n                    }\n                    const startColumn = (selection.startLineNumber === lineNumber ? selection.startColumn : lineData.minColumn);\n                    const endColumn = (selection.endLineNumber === lineNumber ? selection.endColumn : lineData.maxColumn);\n                    if (startColumn < endColumn) {\n                        if (!selectionsOnLine) {\n                            selectionsOnLine = [];\n                        }\n                        selectionsOnLine.push(new LineRange(startColumn - 1, endColumn - 1));\n                    }\n                }\n            }\n            this._renderResult[lineIndex] = this._applyRenderWhitespace(ctx, lineNumber, selectionsOnLine, lineData);\n        }\n    }\n    _applyRenderWhitespace(ctx, lineNumber, selections, lineData) {\n        if (this._options.renderWhitespace === 'selection' && !selections) {\n            return '';\n        }\n        if (this._options.renderWhitespace === 'trailing' && lineData.continuesWithWrappedLine) {\n            return '';\n        }\n        const color = this._context.theme.getColor(editorWhitespaces);\n        const USE_SVG = this._options.renderWithSVG;\n        const lineContent = lineData.content;\n        const len = (this._options.stopRenderingLineAfter === -1 ? lineContent.length : Math.min(this._options.stopRenderingLineAfter, lineContent.length));\n        const continuesWithWrappedLine = lineData.continuesWithWrappedLine;\n        const fauxIndentLength = lineData.minColumn - 1;\n        const onlyBoundary = (this._options.renderWhitespace === 'boundary');\n        const onlyTrailing = (this._options.renderWhitespace === 'trailing');\n        const lineHeight = this._options.lineHeight;\n        const middotWidth = this._options.middotWidth;\n        const wsmiddotWidth = this._options.wsmiddotWidth;\n        const spaceWidth = this._options.spaceWidth;\n        const wsmiddotDiff = Math.abs(wsmiddotWidth - spaceWidth);\n        const middotDiff = Math.abs(middotWidth - spaceWidth);\n        // U+2E31 - WORD SEPARATOR MIDDLE DOT\n        // U+00B7 - MIDDLE DOT\n        const renderSpaceCharCode = (wsmiddotDiff < middotDiff ? 0x2E31 : 0xB7);\n        const canUseHalfwidthRightwardsArrow = this._options.canUseHalfwidthRightwardsArrow;\n        let result = '';\n        let lineIsEmptyOrWhitespace = false;\n        let firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineContent);\n        let lastNonWhitespaceIndex;\n        if (firstNonWhitespaceIndex === -1) {\n            lineIsEmptyOrWhitespace = true;\n            firstNonWhitespaceIndex = len;\n            lastNonWhitespaceIndex = len;\n        }\n        else {\n            lastNonWhitespaceIndex = strings.lastNonWhitespaceIndex(lineContent);\n        }\n        let currentSelectionIndex = 0;\n        let currentSelection = selections && selections[currentSelectionIndex];\n        let maxLeft = 0;\n        for (let charIndex = fauxIndentLength; charIndex < len; charIndex++) {\n            const chCode = lineContent.charCodeAt(charIndex);\n            if (currentSelection && charIndex >= currentSelection.endOffset) {\n                currentSelectionIndex++;\n                currentSelection = selections && selections[currentSelectionIndex];\n            }\n            if (chCode !== 9 /* CharCode.Tab */ && chCode !== 32 /* CharCode.Space */) {\n                continue;\n            }\n            if (onlyTrailing && !lineIsEmptyOrWhitespace && charIndex <= lastNonWhitespaceIndex) {\n                // If rendering only trailing whitespace, check that the charIndex points to trailing whitespace.\n                continue;\n            }\n            if (onlyBoundary && charIndex >= firstNonWhitespaceIndex && charIndex <= lastNonWhitespaceIndex && chCode === 32 /* CharCode.Space */) {\n                // rendering only boundary whitespace\n                const prevChCode = (charIndex - 1 >= 0 ? lineContent.charCodeAt(charIndex - 1) : 0 /* CharCode.Null */);\n                const nextChCode = (charIndex + 1 < len ? lineContent.charCodeAt(charIndex + 1) : 0 /* CharCode.Null */);\n                if (prevChCode !== 32 /* CharCode.Space */ && nextChCode !== 32 /* CharCode.Space */) {\n                    continue;\n                }\n            }\n            if (onlyBoundary && continuesWithWrappedLine && charIndex === len - 1) {\n                const prevCharCode = (charIndex - 1 >= 0 ? lineContent.charCodeAt(charIndex - 1) : 0 /* CharCode.Null */);\n                const isSingleTrailingSpace = (chCode === 32 /* CharCode.Space */ && (prevCharCode !== 32 /* CharCode.Space */ && prevCharCode !== 9 /* CharCode.Tab */));\n                if (isSingleTrailingSpace) {\n                    continue;\n                }\n            }\n            if (selections && (!currentSelection || currentSelection.startOffset > charIndex || currentSelection.endOffset <= charIndex)) {\n                // If rendering whitespace on selection, check that the charIndex falls within a selection\n                continue;\n            }\n            const visibleRange = ctx.visibleRangeForPosition(new Position(lineNumber, charIndex + 1));\n            if (!visibleRange) {\n                continue;\n            }\n            if (USE_SVG) {\n                maxLeft = Math.max(maxLeft, visibleRange.left);\n                if (chCode === 9 /* CharCode.Tab */) {\n                    result += this._renderArrow(lineHeight, spaceWidth, visibleRange.left);\n                }\n                else {\n                    result += `<circle cx=\"${(visibleRange.left + spaceWidth / 2).toFixed(2)}\" cy=\"${(lineHeight / 2).toFixed(2)}\" r=\"${(spaceWidth / 7).toFixed(2)}\" />`;\n                }\n            }\n            else {\n                if (chCode === 9 /* CharCode.Tab */) {\n                    result += `<div class=\"mwh\" style=\"left:${visibleRange.left}px;height:${lineHeight}px;\">${canUseHalfwidthRightwardsArrow ? String.fromCharCode(0xFFEB) : String.fromCharCode(0x2192)}</div>`;\n                }\n                else {\n                    result += `<div class=\"mwh\" style=\"left:${visibleRange.left}px;height:${lineHeight}px;\">${String.fromCharCode(renderSpaceCharCode)}</div>`;\n                }\n            }\n        }\n        if (USE_SVG) {\n            maxLeft = Math.round(maxLeft + spaceWidth);\n            return (`<svg style=\"position:absolute;width:${maxLeft}px;height:${lineHeight}px\" viewBox=\"0 0 ${maxLeft} ${lineHeight}\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"${color}\">`\n                + result\n                + `</svg>`);\n        }\n        return result;\n    }\n    _renderArrow(lineHeight, spaceWidth, left) {\n        const strokeWidth = spaceWidth / 7;\n        const width = spaceWidth;\n        const dy = lineHeight / 2;\n        const dx = left;\n        const p1 = { x: 0, y: strokeWidth / 2 };\n        const p2 = { x: 100 / 125 * width, y: p1.y };\n        const p3 = { x: p2.x - 0.2 * p2.x, y: p2.y + 0.2 * p2.x };\n        const p4 = { x: p3.x + 0.1 * p2.x, y: p3.y + 0.1 * p2.x };\n        const p5 = { x: p4.x + 0.35 * p2.x, y: p4.y - 0.35 * p2.x };\n        const p6 = { x: p5.x, y: -p5.y };\n        const p7 = { x: p4.x, y: -p4.y };\n        const p8 = { x: p3.x, y: -p3.y };\n        const p9 = { x: p2.x, y: -p2.y };\n        const p10 = { x: p1.x, y: -p1.y };\n        const p = [p1, p2, p3, p4, p5, p6, p7, p8, p9, p10];\n        const parts = p.map((p) => `${(dx + p.x).toFixed(2)} ${(dy + p.y).toFixed(2)}`).join(' L ');\n        return `<path d=\"M ${parts}\" />`;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\n            return '';\n        }\n        return this._renderResult[lineIndex];\n    }\n}\nclass WhitespaceOptions {\n    constructor(config) {\n        const options = config.options;\n        const fontInfo = options.get(47 /* EditorOption.fontInfo */);\n        const experimentalWhitespaceRendering = options.get(35 /* EditorOption.experimentalWhitespaceRendering */);\n        if (experimentalWhitespaceRendering === 'off') {\n            // whitespace is rendered in the view line\n            this.renderWhitespace = 'none';\n            this.renderWithSVG = false;\n        }\n        else if (experimentalWhitespaceRendering === 'svg') {\n            this.renderWhitespace = options.get(93 /* EditorOption.renderWhitespace */);\n            this.renderWithSVG = true;\n        }\n        else {\n            this.renderWhitespace = options.get(93 /* EditorOption.renderWhitespace */);\n            this.renderWithSVG = false;\n        }\n        this.spaceWidth = fontInfo.spaceWidth;\n        this.middotWidth = fontInfo.middotWidth;\n        this.wsmiddotWidth = fontInfo.wsmiddotWidth;\n        this.canUseHalfwidthRightwardsArrow = fontInfo.canUseHalfwidthRightwardsArrow;\n        this.lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this.stopRenderingLineAfter = options.get(111 /* EditorOption.stopRenderingLineAfter */);\n    }\n    equals(other) {\n        return (this.renderWhitespace === other.renderWhitespace\n            && this.renderWithSVG === other.renderWithSVG\n            && this.spaceWidth === other.spaceWidth\n            && this.middotWidth === other.middotWidth\n            && this.wsmiddotWidth === other.wsmiddotWidth\n            && this.canUseHalfwidthRightwardsArrow === other.canUseHalfwidthRightwardsArrow\n            && this.lineHeight === other.lineHeight\n            && this.stopRenderingLineAfter === other.stopRenderingLineAfter);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../base/browser/dom.js';\nimport { Selection } from '../common/core/selection.js';\nimport { createFastDomNode } from '../../base/browser/fastDomNode.js';\nimport { onUnexpectedError } from '../../base/common/errors.js';\nimport { PointerHandler } from './controller/pointerHandler.js';\nimport { TextAreaHandler } from './controller/textAreaHandler.js';\nimport { ViewController } from './view/viewController.js';\nimport { ViewUserInputEvents } from './view/viewUserInputEvents.js';\nimport { ContentViewOverlays, MarginViewOverlays } from './view/viewOverlays.js';\nimport { PartFingerprints } from './view/viewPart.js';\nimport { ViewContentWidgets } from './viewParts/contentWidgets/contentWidgets.js';\nimport { CurrentLineHighlightOverlay, CurrentLineMarginHighlightOverlay } from './viewParts/currentLineHighlight/currentLineHighlight.js';\nimport { DecorationsOverlay } from './viewParts/decorations/decorations.js';\nimport { EditorScrollbar } from './viewParts/editorScrollbar/editorScrollbar.js';\nimport { GlyphMarginOverlay } from './viewParts/glyphMargin/glyphMargin.js';\nimport { IndentGuidesOverlay } from './viewParts/indentGuides/indentGuides.js';\nimport { LineNumbersOverlay } from './viewParts/lineNumbers/lineNumbers.js';\nimport { ViewLines } from './viewParts/lines/viewLines.js';\nimport { LinesDecorationsOverlay } from './viewParts/linesDecorations/linesDecorations.js';\nimport { Margin } from './viewParts/margin/margin.js';\nimport { MarginViewLineDecorationsOverlay } from './viewParts/marginDecorations/marginDecorations.js';\nimport { Minimap } from './viewParts/minimap/minimap.js';\nimport { ViewOverlayWidgets } from './viewParts/overlayWidgets/overlayWidgets.js';\nimport { DecorationsOverviewRuler } from './viewParts/overviewRuler/decorationsOverviewRuler.js';\nimport { OverviewRuler } from './viewParts/overviewRuler/overviewRuler.js';\nimport { Rulers } from './viewParts/rulers/rulers.js';\nimport { ScrollDecorationViewPart } from './viewParts/scrollDecoration/scrollDecoration.js';\nimport { SelectionsOverlay } from './viewParts/selections/selections.js';\nimport { ViewCursors } from './viewParts/viewCursors/viewCursors.js';\nimport { ViewZones } from './viewParts/viewZones/viewZones.js';\nimport { Position } from '../common/core/position.js';\nimport { RenderingContext } from './view/renderingContext.js';\nimport { ViewContext } from '../common/viewModel/viewContext.js';\nimport { ViewportData } from '../common/viewLayout/viewLinesViewportData.js';\nimport { ViewEventHandler } from '../common/viewEventHandler.js';\nimport { getThemeTypeSelector } from '../../platform/theme/common/themeService.js';\nimport { PointerHandlerLastRenderData } from './controller/mouseTarget.js';\nimport { BlockDecorations } from './viewParts/blockDecorations/blockDecorations.js';\nimport { inputLatency } from '../../base/browser/performance.js';\nimport { WhitespaceOverlay } from './viewParts/whitespace/whitespace.js';\nexport class View extends ViewEventHandler {\n    constructor(commandDelegate, configuration, colorTheme, model, userInputEvents, overflowWidgetsDomNode) {\n        super();\n        this._selections = [new Selection(1, 1, 1, 1)];\n        this._renderAnimationFrame = null;\n        const viewController = new ViewController(configuration, model, userInputEvents, commandDelegate);\n        // The view context is passed on to most classes (basically to reduce param. counts in ctors)\n        this._context = new ViewContext(configuration, colorTheme, model);\n        // Ensure the view is the first event handler in order to update the layout\n        this._context.addEventHandler(this);\n        this._viewParts = [];\n        // Keyboard handler\n        this._textAreaHandler = new TextAreaHandler(this._context, viewController, this._createTextAreaHandlerHelper());\n        this._viewParts.push(this._textAreaHandler);\n        // These two dom nodes must be constructed up front, since references are needed in the layout provider (scrolling & co.)\n        this._linesContent = createFastDomNode(document.createElement('div'));\n        this._linesContent.setClassName('lines-content' + ' monaco-editor-background');\n        this._linesContent.setPosition('absolute');\n        this.domNode = createFastDomNode(document.createElement('div'));\n        this.domNode.setClassName(this._getEditorClassName());\n        // Set role 'code' for better screen reader support https://github.com/microsoft/vscode/issues/93438\n        this.domNode.setAttribute('role', 'code');\n        this._overflowGuardContainer = createFastDomNode(document.createElement('div'));\n        PartFingerprints.write(this._overflowGuardContainer, 3 /* PartFingerprint.OverflowGuard */);\n        this._overflowGuardContainer.setClassName('overflow-guard');\n        this._scrollbar = new EditorScrollbar(this._context, this._linesContent, this.domNode, this._overflowGuardContainer);\n        this._viewParts.push(this._scrollbar);\n        // View Lines\n        this._viewLines = new ViewLines(this._context, this._linesContent);\n        // View Zones\n        this._viewZones = new ViewZones(this._context);\n        this._viewParts.push(this._viewZones);\n        // Decorations overview ruler\n        const decorationsOverviewRuler = new DecorationsOverviewRuler(this._context);\n        this._viewParts.push(decorationsOverviewRuler);\n        const scrollDecoration = new ScrollDecorationViewPart(this._context);\n        this._viewParts.push(scrollDecoration);\n        const contentViewOverlays = new ContentViewOverlays(this._context);\n        this._viewParts.push(contentViewOverlays);\n        contentViewOverlays.addDynamicOverlay(new CurrentLineHighlightOverlay(this._context));\n        contentViewOverlays.addDynamicOverlay(new SelectionsOverlay(this._context));\n        contentViewOverlays.addDynamicOverlay(new IndentGuidesOverlay(this._context));\n        contentViewOverlays.addDynamicOverlay(new DecorationsOverlay(this._context));\n        contentViewOverlays.addDynamicOverlay(new WhitespaceOverlay(this._context));\n        const marginViewOverlays = new MarginViewOverlays(this._context);\n        this._viewParts.push(marginViewOverlays);\n        marginViewOverlays.addDynamicOverlay(new CurrentLineMarginHighlightOverlay(this._context));\n        marginViewOverlays.addDynamicOverlay(new GlyphMarginOverlay(this._context));\n        marginViewOverlays.addDynamicOverlay(new MarginViewLineDecorationsOverlay(this._context));\n        marginViewOverlays.addDynamicOverlay(new LinesDecorationsOverlay(this._context));\n        marginViewOverlays.addDynamicOverlay(new LineNumbersOverlay(this._context));\n        const margin = new Margin(this._context);\n        margin.getDomNode().appendChild(this._viewZones.marginDomNode);\n        margin.getDomNode().appendChild(marginViewOverlays.getDomNode());\n        this._viewParts.push(margin);\n        // Content widgets\n        this._contentWidgets = new ViewContentWidgets(this._context, this.domNode);\n        this._viewParts.push(this._contentWidgets);\n        this._viewCursors = new ViewCursors(this._context);\n        this._viewParts.push(this._viewCursors);\n        // Overlay widgets\n        this._overlayWidgets = new ViewOverlayWidgets(this._context);\n        this._viewParts.push(this._overlayWidgets);\n        const rulers = new Rulers(this._context);\n        this._viewParts.push(rulers);\n        const blockOutline = new BlockDecorations(this._context);\n        this._viewParts.push(blockOutline);\n        const minimap = new Minimap(this._context);\n        this._viewParts.push(minimap);\n        // -------------- Wire dom nodes up\n        if (decorationsOverviewRuler) {\n            const overviewRulerData = this._scrollbar.getOverviewRulerLayoutInfo();\n            overviewRulerData.parent.insertBefore(decorationsOverviewRuler.getDomNode(), overviewRulerData.insertBefore);\n        }\n        this._linesContent.appendChild(contentViewOverlays.getDomNode());\n        this._linesContent.appendChild(rulers.domNode);\n        this._linesContent.appendChild(blockOutline.domNode);\n        this._linesContent.appendChild(this._viewZones.domNode);\n        this._linesContent.appendChild(this._viewLines.getDomNode());\n        this._linesContent.appendChild(this._contentWidgets.domNode);\n        this._linesContent.appendChild(this._viewCursors.getDomNode());\n        this._overflowGuardContainer.appendChild(margin.getDomNode());\n        this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode());\n        this._overflowGuardContainer.appendChild(scrollDecoration.getDomNode());\n        this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea);\n        this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover);\n        this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode());\n        this._overflowGuardContainer.appendChild(minimap.getDomNode());\n        this.domNode.appendChild(this._overflowGuardContainer);\n        if (overflowWidgetsDomNode) {\n            overflowWidgetsDomNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode);\n        }\n        else {\n            this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode);\n        }\n        this._applyLayout();\n        // Pointer handler\n        this._pointerHandler = this._register(new PointerHandler(this._context, viewController, this._createPointerHandlerHelper()));\n    }\n    _flushAccumulatedAndRenderNow() {\n        inputLatency.onRenderStart();\n        this._renderNow();\n    }\n    _createPointerHandlerHelper() {\n        return {\n            viewDomNode: this.domNode.domNode,\n            linesContentDomNode: this._linesContent.domNode,\n            viewLinesDomNode: this._viewLines.getDomNode().domNode,\n            focusTextArea: () => {\n                this.focus();\n            },\n            dispatchTextAreaEvent: (event) => {\n                this._textAreaHandler.textArea.domNode.dispatchEvent(event);\n            },\n            getLastRenderData: () => {\n                const lastViewCursorsRenderData = this._viewCursors.getLastRenderData() || [];\n                const lastTextareaPosition = this._textAreaHandler.getLastRenderData();\n                return new PointerHandlerLastRenderData(lastViewCursorsRenderData, lastTextareaPosition);\n            },\n            renderNow: () => {\n                this.render(true, false);\n            },\n            shouldSuppressMouseDownOnViewZone: (viewZoneId) => {\n                return this._viewZones.shouldSuppressMouseDownOnViewZone(viewZoneId);\n            },\n            shouldSuppressMouseDownOnWidget: (widgetId) => {\n                return this._contentWidgets.shouldSuppressMouseDownOnWidget(widgetId);\n            },\n            getPositionFromDOMInfo: (spanNode, offset) => {\n                this._flushAccumulatedAndRenderNow();\n                return this._viewLines.getPositionFromDOMInfo(spanNode, offset);\n            },\n            visibleRangeForPosition: (lineNumber, column) => {\n                this._flushAccumulatedAndRenderNow();\n                return this._viewLines.visibleRangeForPosition(new Position(lineNumber, column));\n            },\n            getLineWidth: (lineNumber) => {\n                this._flushAccumulatedAndRenderNow();\n                return this._viewLines.getLineWidth(lineNumber);\n            }\n        };\n    }\n    _createTextAreaHandlerHelper() {\n        return {\n            visibleRangeForPosition: (position) => {\n                this._flushAccumulatedAndRenderNow();\n                return this._viewLines.visibleRangeForPosition(position);\n            }\n        };\n    }\n    _applyLayout() {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this.domNode.setWidth(layoutInfo.width);\n        this.domNode.setHeight(layoutInfo.height);\n        this._overflowGuardContainer.setWidth(layoutInfo.width);\n        this._overflowGuardContainer.setHeight(layoutInfo.height);\n        this._linesContent.setWidth(1000000);\n        this._linesContent.setHeight(1000000);\n    }\n    _getEditorClassName() {\n        const focused = this._textAreaHandler.isFocused() ? ' focused' : '';\n        return this._context.configuration.options.get(135 /* EditorOption.editorClassName */) + ' ' + getThemeTypeSelector(this._context.theme.type) + focused;\n    }\n    // --- begin event handlers\n    handleEvents(events) {\n        super.handleEvents(events);\n        this._scheduleRender();\n    }\n    onConfigurationChanged(e) {\n        this.domNode.setClassName(this._getEditorClassName());\n        this._applyLayout();\n        return false;\n    }\n    onCursorStateChanged(e) {\n        this._selections = e.selections;\n        return false;\n    }\n    onFocusChanged(e) {\n        this.domNode.setClassName(this._getEditorClassName());\n        return false;\n    }\n    onThemeChanged(e) {\n        this._context.theme.update(e.theme);\n        this.domNode.setClassName(this._getEditorClassName());\n        return false;\n    }\n    // --- end event handlers\n    dispose() {\n        if (this._renderAnimationFrame !== null) {\n            this._renderAnimationFrame.dispose();\n            this._renderAnimationFrame = null;\n        }\n        this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove();\n        this._context.removeEventHandler(this);\n        this._viewLines.dispose();\n        // Destroy view parts\n        for (const viewPart of this._viewParts) {\n            viewPart.dispose();\n        }\n        super.dispose();\n    }\n    _scheduleRender() {\n        if (this._renderAnimationFrame === null) {\n            this._renderAnimationFrame = dom.runAtThisOrScheduleAtNextAnimationFrame(this._onRenderScheduled.bind(this), 100);\n        }\n    }\n    _onRenderScheduled() {\n        this._renderAnimationFrame = null;\n        this._flushAccumulatedAndRenderNow();\n    }\n    _renderNow() {\n        safeInvokeNoArg(() => this._actualRender());\n    }\n    _getViewPartsToRender() {\n        const result = [];\n        let resultLen = 0;\n        for (const viewPart of this._viewParts) {\n            if (viewPart.shouldRender()) {\n                result[resultLen++] = viewPart;\n            }\n        }\n        return result;\n    }\n    _actualRender() {\n        if (!dom.isInDOM(this.domNode.domNode)) {\n            return;\n        }\n        let viewPartsToRender = this._getViewPartsToRender();\n        if (!this._viewLines.shouldRender() && viewPartsToRender.length === 0) {\n            // Nothing to render\n            return;\n        }\n        const partialViewportData = this._context.viewLayout.getLinesViewportData();\n        this._context.viewModel.setViewport(partialViewportData.startLineNumber, partialViewportData.endLineNumber, partialViewportData.centeredLineNumber);\n        const viewportData = new ViewportData(this._selections, partialViewportData, this._context.viewLayout.getWhitespaceViewportData(), this._context.viewModel);\n        if (this._contentWidgets.shouldRender()) {\n            // Give the content widgets a chance to set their max width before a possible synchronous layout\n            this._contentWidgets.onBeforeRender(viewportData);\n        }\n        if (this._viewLines.shouldRender()) {\n            this._viewLines.renderText(viewportData);\n            this._viewLines.onDidRender();\n            // Rendering of viewLines might cause scroll events to occur, so collect view parts to render again\n            viewPartsToRender = this._getViewPartsToRender();\n        }\n        const renderingContext = new RenderingContext(this._context.viewLayout, viewportData, this._viewLines);\n        // Render the rest of the parts\n        for (const viewPart of viewPartsToRender) {\n            viewPart.prepareRender(renderingContext);\n        }\n        for (const viewPart of viewPartsToRender) {\n            viewPart.render(renderingContext);\n            viewPart.onDidRender();\n        }\n    }\n    // --- BEGIN CodeEditor helpers\n    delegateVerticalScrollbarPointerDown(browserEvent) {\n        this._scrollbar.delegateVerticalScrollbarPointerDown(browserEvent);\n    }\n    delegateScrollFromMouseWheelEvent(browserEvent) {\n        this._scrollbar.delegateScrollFromMouseWheelEvent(browserEvent);\n    }\n    restoreState(scrollPosition) {\n        this._context.viewModel.viewLayout.setScrollPosition({\n            scrollTop: scrollPosition.scrollTop,\n            scrollLeft: scrollPosition.scrollLeft\n        }, 1 /* ScrollType.Immediate */);\n        this._context.viewModel.tokenizeViewport();\n    }\n    getOffsetForColumn(modelLineNumber, modelColumn) {\n        const modelPosition = this._context.viewModel.model.validatePosition({\n            lineNumber: modelLineNumber,\n            column: modelColumn\n        });\n        const viewPosition = this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\n        this._flushAccumulatedAndRenderNow();\n        const visibleRange = this._viewLines.visibleRangeForPosition(new Position(viewPosition.lineNumber, viewPosition.column));\n        if (!visibleRange) {\n            return -1;\n        }\n        return visibleRange.left;\n    }\n    getTargetAtClientPoint(clientX, clientY) {\n        const mouseTarget = this._pointerHandler.getTargetAtClientPoint(clientX, clientY);\n        if (!mouseTarget) {\n            return null;\n        }\n        return ViewUserInputEvents.convertViewToModelMouseTarget(mouseTarget, this._context.viewModel.coordinatesConverter);\n    }\n    createOverviewRuler(cssClassName) {\n        return new OverviewRuler(this._context, cssClassName);\n    }\n    change(callback) {\n        this._viewZones.changeViewZones(callback);\n        this._scheduleRender();\n    }\n    render(now, everything) {\n        if (everything) {\n            // Force everything to render...\n            this._viewLines.forceShouldRender();\n            for (const viewPart of this._viewParts) {\n                viewPart.forceShouldRender();\n            }\n        }\n        if (now) {\n            this._flushAccumulatedAndRenderNow();\n        }\n        else {\n            this._scheduleRender();\n        }\n    }\n    writeScreenReaderContent(reason) {\n        this._textAreaHandler.writeScreenReaderContent(reason);\n    }\n    focus() {\n        this._textAreaHandler.focusTextArea();\n    }\n    isFocused() {\n        return this._textAreaHandler.isFocused();\n    }\n    setAriaOptions(options) {\n        this._textAreaHandler.setAriaOptions(options);\n    }\n    addContentWidget(widgetData) {\n        this._contentWidgets.addWidget(widgetData.widget);\n        this.layoutContentWidget(widgetData);\n        this._scheduleRender();\n    }\n    layoutContentWidget(widgetData) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        this._contentWidgets.setWidgetPosition(widgetData.widget, (_b = (_a = widgetData.position) === null || _a === void 0 ? void 0 : _a.position) !== null && _b !== void 0 ? _b : null, (_d = (_c = widgetData.position) === null || _c === void 0 ? void 0 : _c.secondaryPosition) !== null && _d !== void 0 ? _d : null, (_f = (_e = widgetData.position) === null || _e === void 0 ? void 0 : _e.preference) !== null && _f !== void 0 ? _f : null, (_h = (_g = widgetData.position) === null || _g === void 0 ? void 0 : _g.positionAffinity) !== null && _h !== void 0 ? _h : null);\n        this._scheduleRender();\n    }\n    removeContentWidget(widgetData) {\n        this._contentWidgets.removeWidget(widgetData.widget);\n        this._scheduleRender();\n    }\n    addOverlayWidget(widgetData) {\n        this._overlayWidgets.addWidget(widgetData.widget);\n        this.layoutOverlayWidget(widgetData);\n        this._scheduleRender();\n    }\n    layoutOverlayWidget(widgetData) {\n        const newPreference = widgetData.position ? widgetData.position.preference : null;\n        const shouldRender = this._overlayWidgets.setWidgetPosition(widgetData.widget, newPreference);\n        if (shouldRender) {\n            this._scheduleRender();\n        }\n    }\n    removeOverlayWidget(widgetData) {\n        this._overlayWidgets.removeWidget(widgetData.widget);\n        this._scheduleRender();\n    }\n}\nfunction safeInvokeNoArg(func) {\n    try {\n        return func();\n    }\n    catch (e) {\n        onUnexpectedError(e);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar _a;\nimport { StringBuilder } from '../../common/core/stringBuilder.js';\nimport * as strings from '../../../base/common/strings.js';\nimport { applyFontInfo } from '../config/domFontInfo.js';\nimport { LineInjectedText } from '../../common/textModelEvents.js';\nimport { ModelLineProjectionData } from '../../common/modelLineProjectionData.js';\nconst ttPolicy = (_a = window.trustedTypes) === null || _a === void 0 ? void 0 : _a.createPolicy('domLineBreaksComputer', { createHTML: value => value });\nexport class DOMLineBreaksComputerFactory {\n    static create() {\n        return new DOMLineBreaksComputerFactory();\n    }\n    constructor() {\n    }\n    createLineBreaksComputer(fontInfo, tabSize, wrappingColumn, wrappingIndent, wordBreak) {\n        const requests = [];\n        const injectedTexts = [];\n        return {\n            addRequest: (lineText, injectedText, previousLineBreakData) => {\n                requests.push(lineText);\n                injectedTexts.push(injectedText);\n            },\n            finalize: () => {\n                return createLineBreaks(requests, fontInfo, tabSize, wrappingColumn, wrappingIndent, wordBreak, injectedTexts);\n            }\n        };\n    }\n}\nfunction createLineBreaks(requests, fontInfo, tabSize, firstLineBreakColumn, wrappingIndent, wordBreak, injectedTextsPerLine) {\n    var _a;\n    function createEmptyLineBreakWithPossiblyInjectedText(requestIdx) {\n        const injectedTexts = injectedTextsPerLine[requestIdx];\n        if (injectedTexts) {\n            const lineText = LineInjectedText.applyInjectedText(requests[requestIdx], injectedTexts);\n            const injectionOptions = injectedTexts.map(t => t.options);\n            const injectionOffsets = injectedTexts.map(text => text.column - 1);\n            // creating a `LineBreakData` with an invalid `breakOffsetsVisibleColumn` is OK\n            // because `breakOffsetsVisibleColumn` will never be used because it contains injected text\n            return new ModelLineProjectionData(injectionOffsets, injectionOptions, [lineText.length], [], 0);\n        }\n        else {\n            return null;\n        }\n    }\n    if (firstLineBreakColumn === -1) {\n        const result = [];\n        for (let i = 0, len = requests.length; i < len; i++) {\n            result[i] = createEmptyLineBreakWithPossiblyInjectedText(i);\n        }\n        return result;\n    }\n    const overallWidth = Math.round(firstLineBreakColumn * fontInfo.typicalHalfwidthCharacterWidth);\n    const additionalIndent = (wrappingIndent === 3 /* WrappingIndent.DeepIndent */ ? 2 : wrappingIndent === 2 /* WrappingIndent.Indent */ ? 1 : 0);\n    const additionalIndentSize = Math.round(tabSize * additionalIndent);\n    const additionalIndentLength = Math.ceil(fontInfo.spaceWidth * additionalIndentSize);\n    const containerDomNode = document.createElement('div');\n    applyFontInfo(containerDomNode, fontInfo);\n    const sb = new StringBuilder(10000);\n    const firstNonWhitespaceIndices = [];\n    const wrappedTextIndentLengths = [];\n    const renderLineContents = [];\n    const allCharOffsets = [];\n    const allVisibleColumns = [];\n    for (let i = 0; i < requests.length; i++) {\n        const lineContent = LineInjectedText.applyInjectedText(requests[i], injectedTextsPerLine[i]);\n        let firstNonWhitespaceIndex = 0;\n        let wrappedTextIndentLength = 0;\n        let width = overallWidth;\n        if (wrappingIndent !== 0 /* WrappingIndent.None */) {\n            firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineContent);\n            if (firstNonWhitespaceIndex === -1) {\n                // all whitespace line\n                firstNonWhitespaceIndex = 0;\n            }\n            else {\n                // Track existing indent\n                for (let i = 0; i < firstNonWhitespaceIndex; i++) {\n                    const charWidth = (lineContent.charCodeAt(i) === 9 /* CharCode.Tab */\n                        ? (tabSize - (wrappedTextIndentLength % tabSize))\n                        : 1);\n                    wrappedTextIndentLength += charWidth;\n                }\n                const indentWidth = Math.ceil(fontInfo.spaceWidth * wrappedTextIndentLength);\n                // Force sticking to beginning of line if no character would fit except for the indentation\n                if (indentWidth + fontInfo.typicalFullwidthCharacterWidth > overallWidth) {\n                    firstNonWhitespaceIndex = 0;\n                    wrappedTextIndentLength = 0;\n                }\n                else {\n                    width = overallWidth - indentWidth;\n                }\n            }\n        }\n        const renderLineContent = lineContent.substr(firstNonWhitespaceIndex);\n        const tmp = renderLine(renderLineContent, wrappedTextIndentLength, tabSize, width, sb, additionalIndentLength);\n        firstNonWhitespaceIndices[i] = firstNonWhitespaceIndex;\n        wrappedTextIndentLengths[i] = wrappedTextIndentLength;\n        renderLineContents[i] = renderLineContent;\n        allCharOffsets[i] = tmp[0];\n        allVisibleColumns[i] = tmp[1];\n    }\n    const html = sb.build();\n    const trustedhtml = (_a = ttPolicy === null || ttPolicy === void 0 ? void 0 : ttPolicy.createHTML(html)) !== null && _a !== void 0 ? _a : html;\n    containerDomNode.innerHTML = trustedhtml;\n    containerDomNode.style.position = 'absolute';\n    containerDomNode.style.top = '10000';\n    if (wordBreak === 'keepAll') {\n        // word-break: keep-all; overflow-wrap: anywhere\n        containerDomNode.style.wordBreak = 'keep-all';\n        containerDomNode.style.overflowWrap = 'anywhere';\n    }\n    else {\n        // overflow-wrap: break-word\n        containerDomNode.style.wordBreak = 'inherit';\n        containerDomNode.style.overflowWrap = 'break-word';\n    }\n    document.body.appendChild(containerDomNode);\n    const range = document.createRange();\n    const lineDomNodes = Array.prototype.slice.call(containerDomNode.children, 0);\n    const result = [];\n    for (let i = 0; i < requests.length; i++) {\n        const lineDomNode = lineDomNodes[i];\n        const breakOffsets = readLineBreaks(range, lineDomNode, renderLineContents[i], allCharOffsets[i]);\n        if (breakOffsets === null) {\n            result[i] = createEmptyLineBreakWithPossiblyInjectedText(i);\n            continue;\n        }\n        const firstNonWhitespaceIndex = firstNonWhitespaceIndices[i];\n        const wrappedTextIndentLength = wrappedTextIndentLengths[i] + additionalIndentSize;\n        const visibleColumns = allVisibleColumns[i];\n        const breakOffsetsVisibleColumn = [];\n        for (let j = 0, len = breakOffsets.length; j < len; j++) {\n            breakOffsetsVisibleColumn[j] = visibleColumns[breakOffsets[j]];\n        }\n        if (firstNonWhitespaceIndex !== 0) {\n            // All break offsets are relative to the renderLineContent, make them absolute again\n            for (let j = 0, len = breakOffsets.length; j < len; j++) {\n                breakOffsets[j] += firstNonWhitespaceIndex;\n            }\n        }\n        let injectionOptions;\n        let injectionOffsets;\n        const curInjectedTexts = injectedTextsPerLine[i];\n        if (curInjectedTexts) {\n            injectionOptions = curInjectedTexts.map(t => t.options);\n            injectionOffsets = curInjectedTexts.map(text => text.column - 1);\n        }\n        else {\n            injectionOptions = null;\n            injectionOffsets = null;\n        }\n        result[i] = new ModelLineProjectionData(injectionOffsets, injectionOptions, breakOffsets, breakOffsetsVisibleColumn, wrappedTextIndentLength);\n    }\n    document.body.removeChild(containerDomNode);\n    return result;\n}\nfunction renderLine(lineContent, initialVisibleColumn, tabSize, width, sb, wrappingIndentLength) {\n    if (wrappingIndentLength !== 0) {\n        const hangingOffset = String(wrappingIndentLength);\n        sb.appendString('<div style=\"text-indent: -');\n        sb.appendString(hangingOffset);\n        sb.appendString('px; padding-left: ');\n        sb.appendString(hangingOffset);\n        sb.appendString('px; box-sizing: border-box; width:');\n    }\n    else {\n        sb.appendString('<div style=\"width:');\n    }\n    sb.appendString(String(width));\n    sb.appendString('px;\">');\n    // if (containsRTL) {\n    // \tsb.appendASCIIString('\" dir=\"ltr');\n    // }\n    const len = lineContent.length;\n    let visibleColumn = initialVisibleColumn;\n    let charOffset = 0;\n    const charOffsets = [];\n    const visibleColumns = [];\n    let nextCharCode = (0 < len ? lineContent.charCodeAt(0) : 0 /* CharCode.Null */);\n    sb.appendString('<span>');\n    for (let charIndex = 0; charIndex < len; charIndex++) {\n        if (charIndex !== 0 && charIndex % 16384 /* Constants.SPAN_MODULO_LIMIT */ === 0) {\n            sb.appendString('</span><span>');\n        }\n        charOffsets[charIndex] = charOffset;\n        visibleColumns[charIndex] = visibleColumn;\n        const charCode = nextCharCode;\n        nextCharCode = (charIndex + 1 < len ? lineContent.charCodeAt(charIndex + 1) : 0 /* CharCode.Null */);\n        let producedCharacters = 1;\n        let charWidth = 1;\n        switch (charCode) {\n            case 9 /* CharCode.Tab */:\n                producedCharacters = (tabSize - (visibleColumn % tabSize));\n                charWidth = producedCharacters;\n                for (let space = 1; space <= producedCharacters; space++) {\n                    if (space < producedCharacters) {\n                        sb.appendCharCode(0xA0); // &nbsp;\n                    }\n                    else {\n                        sb.appendASCIICharCode(32 /* CharCode.Space */);\n                    }\n                }\n                break;\n            case 32 /* CharCode.Space */:\n                if (nextCharCode === 32 /* CharCode.Space */) {\n                    sb.appendCharCode(0xA0); // &nbsp;\n                }\n                else {\n                    sb.appendASCIICharCode(32 /* CharCode.Space */);\n                }\n                break;\n            case 60 /* CharCode.LessThan */:\n                sb.appendString('&lt;');\n                break;\n            case 62 /* CharCode.GreaterThan */:\n                sb.appendString('&gt;');\n                break;\n            case 38 /* CharCode.Ampersand */:\n                sb.appendString('&amp;');\n                break;\n            case 0 /* CharCode.Null */:\n                sb.appendString('&#00;');\n                break;\n            case 65279 /* CharCode.UTF8_BOM */:\n            case 8232 /* CharCode.LINE_SEPARATOR */:\n            case 8233 /* CharCode.PARAGRAPH_SEPARATOR */:\n            case 133 /* CharCode.NEXT_LINE */:\n                sb.appendCharCode(0xFFFD);\n                break;\n            default:\n                if (strings.isFullWidthCharacter(charCode)) {\n                    charWidth++;\n                }\n                if (charCode < 32) {\n                    sb.appendCharCode(9216 + charCode);\n                }\n                else {\n                    sb.appendCharCode(charCode);\n                }\n        }\n        charOffset += producedCharacters;\n        visibleColumn += charWidth;\n    }\n    sb.appendString('</span>');\n    charOffsets[lineContent.length] = charOffset;\n    visibleColumns[lineContent.length] = visibleColumn;\n    sb.appendString('</div>');\n    return [charOffsets, visibleColumns];\n}\nfunction readLineBreaks(range, lineDomNode, lineContent, charOffsets) {\n    if (lineContent.length <= 1) {\n        return null;\n    }\n    const spans = Array.prototype.slice.call(lineDomNode.children, 0);\n    const breakOffsets = [];\n    try {\n        discoverBreaks(range, spans, charOffsets, 0, null, lineContent.length - 1, null, breakOffsets);\n    }\n    catch (err) {\n        console.log(err);\n        return null;\n    }\n    if (breakOffsets.length === 0) {\n        return null;\n    }\n    breakOffsets.push(lineContent.length);\n    return breakOffsets;\n}\nfunction discoverBreaks(range, spans, charOffsets, low, lowRects, high, highRects, result) {\n    if (low === high) {\n        return;\n    }\n    lowRects = lowRects || readClientRect(range, spans, charOffsets[low], charOffsets[low + 1]);\n    highRects = highRects || readClientRect(range, spans, charOffsets[high], charOffsets[high + 1]);\n    if (Math.abs(lowRects[0].top - highRects[0].top) <= 0.1) {\n        // same line\n        return;\n    }\n    // there is at least one line break between these two offsets\n    if (low + 1 === high) {\n        // the two characters are adjacent, so the line break must be exactly between them\n        result.push(high);\n        return;\n    }\n    const mid = low + ((high - low) / 2) | 0;\n    const midRects = readClientRect(range, spans, charOffsets[mid], charOffsets[mid + 1]);\n    discoverBreaks(range, spans, charOffsets, low, lowRects, mid, midRects, result);\n    discoverBreaks(range, spans, charOffsets, mid, midRects, high, highRects, result);\n}\nfunction readClientRect(range, spans, startOffset, endOffset) {\n    range.setStart(spans[(startOffset / 16384 /* Constants.SPAN_MODULO_LIMIT */) | 0].firstChild, startOffset % 16384 /* Constants.SPAN_MODULO_LIMIT */);\n    range.setEnd(spans[(endOffset / 16384 /* Constants.SPAN_MODULO_LIMIT */) | 0].firstChild, endOffset % 16384 /* Constants.SPAN_MODULO_LIMIT */);\n    return range.getClientRects();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { ViewEventHandler } from '../../common/viewEventHandler.js';\nexport class DynamicViewOverlay extends ViewEventHandler {\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './lineNumbers.css';\nimport * as platform from '../../../../base/common/platform.js';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport { Position } from '../../../common/core/position.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { editorDimmedLineNumber, editorLineNumbers } from '../../../common/core/editorColorRegistry.js';\nclass LineNumbersOverlay extends DynamicViewOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        this._readConfig();\n        this._lastCursorModelPosition = new Position(1, 1);\n        this._renderResult = null;\n        this._activeLineNumber = 1;\n        this._context.addEventHandler(this);\n    }\n    _readConfig() {\n        const options = this._context.configuration.options;\n        this._lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        const lineNumbers = options.get(64 /* EditorOption.lineNumbers */);\n        this._renderLineNumbers = lineNumbers.renderType;\n        this._renderCustomLineNumbers = lineNumbers.renderFn;\n        this._renderFinalNewline = options.get(89 /* EditorOption.renderFinalNewline */);\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._lineNumbersLeft = layoutInfo.lineNumbersLeft;\n        this._lineNumbersWidth = layoutInfo.lineNumbersWidth;\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        this._readConfig();\n        return true;\n    }\n    onCursorStateChanged(e) {\n        const primaryViewPosition = e.selections[0].getPosition();\n        this._lastCursorModelPosition = this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(primaryViewPosition);\n        let shouldRender = false;\n        if (this._activeLineNumber !== primaryViewPosition.lineNumber) {\n            this._activeLineNumber = primaryViewPosition.lineNumber;\n            shouldRender = true;\n        }\n        if (this._renderLineNumbers === 2 /* RenderLineNumbersType.Relative */ || this._renderLineNumbers === 3 /* RenderLineNumbersType.Interval */) {\n            shouldRender = true;\n        }\n        return shouldRender;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    _getLineRenderLineNumber(viewLineNumber) {\n        const modelPosition = this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position(viewLineNumber, 1));\n        if (modelPosition.column !== 1) {\n            return '';\n        }\n        const modelLineNumber = modelPosition.lineNumber;\n        if (this._renderCustomLineNumbers) {\n            return this._renderCustomLineNumbers(modelLineNumber);\n        }\n        if (this._renderLineNumbers === 2 /* RenderLineNumbersType.Relative */) {\n            const diff = Math.abs(this._lastCursorModelPosition.lineNumber - modelLineNumber);\n            if (diff === 0) {\n                return '<span class=\"relative-current-line-number\">' + modelLineNumber + '</span>';\n            }\n            return String(diff);\n        }\n        if (this._renderLineNumbers === 3 /* RenderLineNumbersType.Interval */) {\n            if (this._lastCursorModelPosition.lineNumber === modelLineNumber) {\n                return String(modelLineNumber);\n            }\n            if (modelLineNumber % 10 === 0) {\n                return String(modelLineNumber);\n            }\n            return '';\n        }\n        return String(modelLineNumber);\n    }\n    prepareRender(ctx) {\n        if (this._renderLineNumbers === 0 /* RenderLineNumbersType.Off */) {\n            this._renderResult = null;\n            return;\n        }\n        const lineHeightClassName = (platform.isLinux ? (this._lineHeight % 2 === 0 ? ' lh-even' : ' lh-odd') : '');\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const lineCount = this._context.viewModel.getLineCount();\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            const renderLineNumber = this._getLineRenderLineNumber(lineNumber);\n            if (!renderLineNumber) {\n                output[lineIndex] = '';\n                continue;\n            }\n            let extraClassName = '';\n            if (lineNumber === lineCount && this._context.viewModel.getLineLength(lineNumber) === 0) {\n                // this is the last line\n                if (this._renderFinalNewline === 'off') {\n                    output[lineIndex] = '';\n                    continue;\n                }\n                if (this._renderFinalNewline === 'dimmed') {\n                    extraClassName = ' dimmed-line-number';\n                }\n            }\n            if (lineNumber === this._activeLineNumber) {\n                extraClassName = ' active-line-number';\n            }\n            output[lineIndex] = (`<div class=\"${LineNumbersOverlay.CLASS_NAME}${lineHeightClassName}${extraClassName}\" style=\"left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;\">${renderLineNumber}</div>`);\n        }\n        this._renderResult = output;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\n            return '';\n        }\n        return this._renderResult[lineIndex];\n    }\n}\nLineNumbersOverlay.CLASS_NAME = 'line-numbers';\nexport { LineNumbersOverlay };\nregisterThemingParticipant((theme, collector) => {\n    const editorLineNumbersColor = theme.getColor(editorLineNumbers);\n    const editorDimmedLineNumberColor = theme.getColor(editorDimmedLineNumber);\n    if (editorDimmedLineNumberColor) {\n        collector.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${editorDimmedLineNumberColor}; }`);\n    }\n    else if (editorLineNumbersColor) {\n        collector.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${editorLineNumbersColor.transparent(0.4)}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { FloatHorizontalRange } from '../../view/renderingContext.js';\nexport class RangeUtil {\n    static _createRange() {\n        if (!this._handyReadyRange) {\n            this._handyReadyRange = document.createRange();\n        }\n        return this._handyReadyRange;\n    }\n    static _detachRange(range, endNode) {\n        // Move range out of the span node, IE doesn't like having many ranges in\n        // the same spot and will act badly for lines containing dashes ('-')\n        range.selectNodeContents(endNode);\n    }\n    static _readClientRects(startElement, startOffset, endElement, endOffset, endNode) {\n        const range = this._createRange();\n        try {\n            range.setStart(startElement, startOffset);\n            range.setEnd(endElement, endOffset);\n            return range.getClientRects();\n        }\n        catch (e) {\n            // This is life ...\n            return null;\n        }\n        finally {\n            this._detachRange(range, endNode);\n        }\n    }\n    static _mergeAdjacentRanges(ranges) {\n        if (ranges.length === 1) {\n            // There is nothing to merge\n            return ranges;\n        }\n        ranges.sort(FloatHorizontalRange.compare);\n        const result = [];\n        let resultLen = 0;\n        let prev = ranges[0];\n        for (let i = 1, len = ranges.length; i < len; i++) {\n            const range = ranges[i];\n            if (prev.left + prev.width + 0.9 /* account for browser's rounding errors*/ >= range.left) {\n                prev.width = Math.max(prev.width, range.left + range.width - prev.left);\n            }\n            else {\n                result[resultLen++] = prev;\n                prev = range;\n            }\n        }\n        result[resultLen++] = prev;\n        return result;\n    }\n    static _createHorizontalRangesFromClientRects(clientRects, clientRectDeltaLeft, clientRectScale) {\n        if (!clientRects || clientRects.length === 0) {\n            return null;\n        }\n        // We go through FloatHorizontalRange because it has been observed in bi-di text\n        // that the clientRects are not coming in sorted from the browser\n        const result = [];\n        for (let i = 0, len = clientRects.length; i < len; i++) {\n            const clientRect = clientRects[i];\n            result[i] = new FloatHorizontalRange(Math.max(0, (clientRect.left - clientRectDeltaLeft) / clientRectScale), clientRect.width / clientRectScale);\n        }\n        return this._mergeAdjacentRanges(result);\n    }\n    static readHorizontalRanges(domNode, startChildIndex, startOffset, endChildIndex, endOffset, context) {\n        // Panic check\n        const min = 0;\n        const max = domNode.children.length - 1;\n        if (min > max) {\n            return null;\n        }\n        startChildIndex = Math.min(max, Math.max(min, startChildIndex));\n        endChildIndex = Math.min(max, Math.max(min, endChildIndex));\n        if (startChildIndex === endChildIndex && startOffset === endOffset && startOffset === 0 && !domNode.children[startChildIndex].firstChild) {\n            // We must find the position at the beginning of a <span>\n            // To cover cases of empty <span>s, avoid using a range and use the <span>'s bounding box\n            const clientRects = domNode.children[startChildIndex].getClientRects();\n            context.markDidDomLayout();\n            return this._createHorizontalRangesFromClientRects(clientRects, context.clientRectDeltaLeft, context.clientRectScale);\n        }\n        // If crossing over to a span only to select offset 0, then use the previous span's maximum offset\n        // Chrome is buggy and doesn't handle 0 offsets well sometimes.\n        if (startChildIndex !== endChildIndex) {\n            if (endChildIndex > 0 && endOffset === 0) {\n                endChildIndex--;\n                endOffset = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n            }\n        }\n        let startElement = domNode.children[startChildIndex].firstChild;\n        let endElement = domNode.children[endChildIndex].firstChild;\n        if (!startElement || !endElement) {\n            // When having an empty <span> (without any text content), try to move to the previous <span>\n            if (!startElement && startOffset === 0 && startChildIndex > 0) {\n                startElement = domNode.children[startChildIndex - 1].firstChild;\n                startOffset = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n            }\n            if (!endElement && endOffset === 0 && endChildIndex > 0) {\n                endElement = domNode.children[endChildIndex - 1].firstChild;\n                endOffset = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n            }\n        }\n        if (!startElement || !endElement) {\n            return null;\n        }\n        startOffset = Math.min(startElement.textContent.length, Math.max(0, startOffset));\n        endOffset = Math.min(endElement.textContent.length, Math.max(0, endOffset));\n        const clientRects = this._readClientRects(startElement, startOffset, endElement, endOffset, context.endNode);\n        context.markDidDomLayout();\n        return this._createHorizontalRangesFromClientRects(clientRects, context.clientRectDeltaLeft, context.clientRectScale);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as browser from '../../../../base/browser/browser.js';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { RangeUtil } from './rangeUtil.js';\nimport { FloatHorizontalRange, VisibleRanges } from '../../view/renderingContext.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { RenderLineInput, renderViewLine, LineRange, DomPosition } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { EditorFontLigatures } from '../../../common/config/editorOptions.js';\nconst canUseFastRenderedViewLine = (function () {\n    if (platform.isNative) {\n        // In VSCode we know very well when the zoom level changes\n        return true;\n    }\n    if (platform.isLinux || browser.isFirefox || browser.isSafari) {\n        // On Linux, it appears that zooming affects char widths (in pixels), which is unexpected.\n        // --\n        // Even though we read character widths correctly, having read them at a specific zoom level\n        // does not mean they are the same at the current zoom level.\n        // --\n        // This could be improved if we ever figure out how to get an event when browsers zoom,\n        // but until then we have to stick with reading client rects.\n        // --\n        // The same has been observed with Firefox on Windows7\n        // --\n        // The same has been oversved with Safari\n        return false;\n    }\n    return true;\n})();\nlet monospaceAssumptionsAreValid = true;\nexport class ViewLineOptions {\n    constructor(config, themeType) {\n        this.themeType = themeType;\n        const options = config.options;\n        const fontInfo = options.get(47 /* EditorOption.fontInfo */);\n        const experimentalWhitespaceRendering = options.get(35 /* EditorOption.experimentalWhitespaceRendering */);\n        if (experimentalWhitespaceRendering === 'off') {\n            this.renderWhitespace = options.get(93 /* EditorOption.renderWhitespace */);\n        }\n        else {\n            // whitespace is rendered in a different layer\n            this.renderWhitespace = 'none';\n        }\n        this.renderControlCharacters = options.get(88 /* EditorOption.renderControlCharacters */);\n        this.spaceWidth = fontInfo.spaceWidth;\n        this.middotWidth = fontInfo.middotWidth;\n        this.wsmiddotWidth = fontInfo.wsmiddotWidth;\n        this.useMonospaceOptimizations = (fontInfo.isMonospace\n            && !options.get(30 /* EditorOption.disableMonospaceOptimizations */));\n        this.canUseHalfwidthRightwardsArrow = fontInfo.canUseHalfwidthRightwardsArrow;\n        this.lineHeight = options.get(63 /* EditorOption.lineHeight */);\n        this.stopRenderingLineAfter = options.get(111 /* EditorOption.stopRenderingLineAfter */);\n        this.fontLigatures = options.get(48 /* EditorOption.fontLigatures */);\n    }\n    equals(other) {\n        return (this.themeType === other.themeType\n            && this.renderWhitespace === other.renderWhitespace\n            && this.renderControlCharacters === other.renderControlCharacters\n            && this.spaceWidth === other.spaceWidth\n            && this.middotWidth === other.middotWidth\n            && this.wsmiddotWidth === other.wsmiddotWidth\n            && this.useMonospaceOptimizations === other.useMonospaceOptimizations\n            && this.canUseHalfwidthRightwardsArrow === other.canUseHalfwidthRightwardsArrow\n            && this.lineHeight === other.lineHeight\n            && this.stopRenderingLineAfter === other.stopRenderingLineAfter\n            && this.fontLigatures === other.fontLigatures);\n    }\n}\nclass ViewLine {\n    constructor(options) {\n        this._options = options;\n        this._isMaybeInvalid = true;\n        this._renderedViewLine = null;\n    }\n    // --- begin IVisibleLineData\n    getDomNode() {\n        if (this._renderedViewLine && this._renderedViewLine.domNode) {\n            return this._renderedViewLine.domNode.domNode;\n        }\n        return null;\n    }\n    setDomNode(domNode) {\n        if (this._renderedViewLine) {\n            this._renderedViewLine.domNode = createFastDomNode(domNode);\n        }\n        else {\n            throw new Error('I have no rendered view line to set the dom node to...');\n        }\n    }\n    onContentChanged() {\n        this._isMaybeInvalid = true;\n    }\n    onTokensChanged() {\n        this._isMaybeInvalid = true;\n    }\n    onDecorationsChanged() {\n        this._isMaybeInvalid = true;\n    }\n    onOptionsChanged(newOptions) {\n        this._isMaybeInvalid = true;\n        this._options = newOptions;\n    }\n    onSelectionChanged() {\n        if (isHighContrast(this._options.themeType) || this._options.renderWhitespace === 'selection') {\n            this._isMaybeInvalid = true;\n            return true;\n        }\n        return false;\n    }\n    renderLine(lineNumber, deltaTop, viewportData, sb) {\n        if (this._isMaybeInvalid === false) {\n            // it appears that nothing relevant has changed\n            return false;\n        }\n        this._isMaybeInvalid = false;\n        const lineData = viewportData.getViewLineRenderingData(lineNumber);\n        const options = this._options;\n        const actualInlineDecorations = LineDecoration.filter(lineData.inlineDecorations, lineNumber, lineData.minColumn, lineData.maxColumn);\n        // Only send selection information when needed for rendering whitespace\n        let selectionsOnLine = null;\n        if (isHighContrast(options.themeType) || this._options.renderWhitespace === 'selection') {\n            const selections = viewportData.selections;\n            for (const selection of selections) {\n                if (selection.endLineNumber < lineNumber || selection.startLineNumber > lineNumber) {\n                    // Selection does not intersect line\n                    continue;\n                }\n                const startColumn = (selection.startLineNumber === lineNumber ? selection.startColumn : lineData.minColumn);\n                const endColumn = (selection.endLineNumber === lineNumber ? selection.endColumn : lineData.maxColumn);\n                if (startColumn < endColumn) {\n                    if (isHighContrast(options.themeType)) {\n                        actualInlineDecorations.push(new LineDecoration(startColumn, endColumn, 'inline-selected-text', 0 /* InlineDecorationType.Regular */));\n                    }\n                    if (this._options.renderWhitespace === 'selection') {\n                        if (!selectionsOnLine) {\n                            selectionsOnLine = [];\n                        }\n                        selectionsOnLine.push(new LineRange(startColumn - 1, endColumn - 1));\n                    }\n                }\n            }\n        }\n        const renderLineInput = new RenderLineInput(options.useMonospaceOptimizations, options.canUseHalfwidthRightwardsArrow, lineData.content, lineData.continuesWithWrappedLine, lineData.isBasicASCII, lineData.containsRTL, lineData.minColumn - 1, lineData.tokens, actualInlineDecorations, lineData.tabSize, lineData.startVisibleColumn, options.spaceWidth, options.middotWidth, options.wsmiddotWidth, options.stopRenderingLineAfter, options.renderWhitespace, options.renderControlCharacters, options.fontLigatures !== EditorFontLigatures.OFF, selectionsOnLine);\n        if (this._renderedViewLine && this._renderedViewLine.input.equals(renderLineInput)) {\n            // no need to do anything, we have the same render input\n            return false;\n        }\n        sb.appendString('<div style=\"top:');\n        sb.appendString(String(deltaTop));\n        sb.appendString('px;height:');\n        sb.appendString(String(this._options.lineHeight));\n        sb.appendString('px;\" class=\"');\n        sb.appendString(ViewLine.CLASS_NAME);\n        sb.appendString('\">');\n        const output = renderViewLine(renderLineInput, sb);\n        sb.appendString('</div>');\n        let renderedViewLine = null;\n        if (monospaceAssumptionsAreValid && canUseFastRenderedViewLine && lineData.isBasicASCII && options.useMonospaceOptimizations && output.containsForeignElements === 0 /* ForeignElementType.None */) {\n            renderedViewLine = new FastRenderedViewLine(this._renderedViewLine ? this._renderedViewLine.domNode : null, renderLineInput, output.characterMapping);\n        }\n        if (!renderedViewLine) {\n            renderedViewLine = createRenderedLine(this._renderedViewLine ? this._renderedViewLine.domNode : null, renderLineInput, output.characterMapping, output.containsRTL, output.containsForeignElements);\n        }\n        this._renderedViewLine = renderedViewLine;\n        return true;\n    }\n    layoutLine(lineNumber, deltaTop) {\n        if (this._renderedViewLine && this._renderedViewLine.domNode) {\n            this._renderedViewLine.domNode.setTop(deltaTop);\n            this._renderedViewLine.domNode.setHeight(this._options.lineHeight);\n        }\n    }\n    // --- end IVisibleLineData\n    getWidth(context) {\n        if (!this._renderedViewLine) {\n            return 0;\n        }\n        return this._renderedViewLine.getWidth(context);\n    }\n    getWidthIsFast() {\n        if (!this._renderedViewLine) {\n            return true;\n        }\n        return this._renderedViewLine.getWidthIsFast();\n    }\n    needsMonospaceFontCheck() {\n        if (!this._renderedViewLine) {\n            return false;\n        }\n        return (this._renderedViewLine instanceof FastRenderedViewLine);\n    }\n    monospaceAssumptionsAreValid() {\n        if (!this._renderedViewLine) {\n            return monospaceAssumptionsAreValid;\n        }\n        if (this._renderedViewLine instanceof FastRenderedViewLine) {\n            return this._renderedViewLine.monospaceAssumptionsAreValid();\n        }\n        return monospaceAssumptionsAreValid;\n    }\n    onMonospaceAssumptionsInvalidated() {\n        if (this._renderedViewLine && this._renderedViewLine instanceof FastRenderedViewLine) {\n            this._renderedViewLine = this._renderedViewLine.toSlowRenderedLine();\n        }\n    }\n    getVisibleRangesForRange(lineNumber, startColumn, endColumn, context) {\n        if (!this._renderedViewLine) {\n            return null;\n        }\n        startColumn = Math.min(this._renderedViewLine.input.lineContent.length + 1, Math.max(1, startColumn));\n        endColumn = Math.min(this._renderedViewLine.input.lineContent.length + 1, Math.max(1, endColumn));\n        const stopRenderingLineAfter = this._renderedViewLine.input.stopRenderingLineAfter;\n        if (stopRenderingLineAfter !== -1 && startColumn > stopRenderingLineAfter + 1 && endColumn > stopRenderingLineAfter + 1) {\n            // This range is obviously not visible\n            return new VisibleRanges(true, [new FloatHorizontalRange(this.getWidth(context), 0)]);\n        }\n        if (stopRenderingLineAfter !== -1 && startColumn > stopRenderingLineAfter + 1) {\n            startColumn = stopRenderingLineAfter + 1;\n        }\n        if (stopRenderingLineAfter !== -1 && endColumn > stopRenderingLineAfter + 1) {\n            endColumn = stopRenderingLineAfter + 1;\n        }\n        const horizontalRanges = this._renderedViewLine.getVisibleRangesForRange(lineNumber, startColumn, endColumn, context);\n        if (horizontalRanges && horizontalRanges.length > 0) {\n            return new VisibleRanges(false, horizontalRanges);\n        }\n        return null;\n    }\n    getColumnOfNodeOffset(lineNumber, spanNode, offset) {\n        if (!this._renderedViewLine) {\n            return 1;\n        }\n        return this._renderedViewLine.getColumnOfNodeOffset(lineNumber, spanNode, offset);\n    }\n}\nViewLine.CLASS_NAME = 'view-line';\nexport { ViewLine };\n/**\n * A rendered line which is guaranteed to contain only regular ASCII and is rendered with a monospace font.\n */\nclass FastRenderedViewLine {\n    constructor(domNode, renderLineInput, characterMapping) {\n        this._cachedWidth = -1;\n        this.domNode = domNode;\n        this.input = renderLineInput;\n        const keyColumnCount = Math.floor(renderLineInput.lineContent.length / 300 /* Constants.MaxMonospaceDistance */);\n        if (keyColumnCount > 0) {\n            this._keyColumnPixelOffsetCache = new Float32Array(keyColumnCount);\n            for (let i = 0; i < keyColumnCount; i++) {\n                this._keyColumnPixelOffsetCache[i] = -1;\n            }\n        }\n        else {\n            this._keyColumnPixelOffsetCache = null;\n        }\n        this._characterMapping = characterMapping;\n        this._charWidth = renderLineInput.spaceWidth;\n    }\n    getWidth(context) {\n        if (!this.domNode || this.input.lineContent.length < 300 /* Constants.MaxMonospaceDistance */) {\n            const horizontalOffset = this._characterMapping.getHorizontalOffset(this._characterMapping.length);\n            return Math.round(this._charWidth * horizontalOffset);\n        }\n        if (this._cachedWidth === -1) {\n            this._cachedWidth = this._getReadingTarget(this.domNode).offsetWidth;\n            context === null || context === void 0 ? void 0 : context.markDidDomLayout();\n        }\n        return this._cachedWidth;\n    }\n    getWidthIsFast() {\n        return (this.input.lineContent.length < 300 /* Constants.MaxMonospaceDistance */) || this._cachedWidth !== -1;\n    }\n    monospaceAssumptionsAreValid() {\n        if (!this.domNode) {\n            return monospaceAssumptionsAreValid;\n        }\n        if (this.input.lineContent.length < 300 /* Constants.MaxMonospaceDistance */) {\n            const expectedWidth = this.getWidth(null);\n            const actualWidth = this.domNode.domNode.firstChild.offsetWidth;\n            if (Math.abs(expectedWidth - actualWidth) >= 2) {\n                // more than 2px off\n                console.warn(`monospace assumptions have been violated, therefore disabling monospace optimizations!`);\n                monospaceAssumptionsAreValid = false;\n            }\n        }\n        return monospaceAssumptionsAreValid;\n    }\n    toSlowRenderedLine() {\n        return createRenderedLine(this.domNode, this.input, this._characterMapping, false, 0 /* ForeignElementType.None */);\n    }\n    getVisibleRangesForRange(lineNumber, startColumn, endColumn, context) {\n        const startPosition = this._getColumnPixelOffset(lineNumber, startColumn, context);\n        const endPosition = this._getColumnPixelOffset(lineNumber, endColumn, context);\n        return [new FloatHorizontalRange(startPosition, endPosition - startPosition)];\n    }\n    _getColumnPixelOffset(lineNumber, column, context) {\n        if (column <= 300 /* Constants.MaxMonospaceDistance */) {\n            const horizontalOffset = this._characterMapping.getHorizontalOffset(column);\n            return this._charWidth * horizontalOffset;\n        }\n        const keyColumnOrdinal = Math.floor((column - 1) / 300 /* Constants.MaxMonospaceDistance */) - 1;\n        const keyColumn = (keyColumnOrdinal + 1) * 300 /* Constants.MaxMonospaceDistance */ + 1;\n        let keyColumnPixelOffset = -1;\n        if (this._keyColumnPixelOffsetCache) {\n            keyColumnPixelOffset = this._keyColumnPixelOffsetCache[keyColumnOrdinal];\n            if (keyColumnPixelOffset === -1) {\n                keyColumnPixelOffset = this._actualReadPixelOffset(lineNumber, keyColumn, context);\n                this._keyColumnPixelOffsetCache[keyColumnOrdinal] = keyColumnPixelOffset;\n            }\n        }\n        if (keyColumnPixelOffset === -1) {\n            // Could not read actual key column pixel offset\n            const horizontalOffset = this._characterMapping.getHorizontalOffset(column);\n            return this._charWidth * horizontalOffset;\n        }\n        const keyColumnHorizontalOffset = this._characterMapping.getHorizontalOffset(keyColumn);\n        const horizontalOffset = this._characterMapping.getHorizontalOffset(column);\n        return keyColumnPixelOffset + this._charWidth * (horizontalOffset - keyColumnHorizontalOffset);\n    }\n    _getReadingTarget(myDomNode) {\n        return myDomNode.domNode.firstChild;\n    }\n    _actualReadPixelOffset(lineNumber, column, context) {\n        if (!this.domNode) {\n            return -1;\n        }\n        const domPosition = this._characterMapping.getDomPosition(column);\n        const r = RangeUtil.readHorizontalRanges(this._getReadingTarget(this.domNode), domPosition.partIndex, domPosition.charIndex, domPosition.partIndex, domPosition.charIndex, context);\n        if (!r || r.length === 0) {\n            return -1;\n        }\n        return r[0].left;\n    }\n    getColumnOfNodeOffset(lineNumber, spanNode, offset) {\n        const spanNodeTextContentLength = spanNode.textContent.length;\n        let spanIndex = -1;\n        while (spanNode) {\n            spanNode = spanNode.previousSibling;\n            spanIndex++;\n        }\n        return this._characterMapping.getColumn(new DomPosition(spanIndex, offset), spanNodeTextContentLength);\n    }\n}\n/**\n * Every time we render a line, we save what we have rendered in an instance of this class.\n */\nclass RenderedViewLine {\n    constructor(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements) {\n        this.domNode = domNode;\n        this.input = renderLineInput;\n        this._characterMapping = characterMapping;\n        this._isWhitespaceOnly = /^\\s*$/.test(renderLineInput.lineContent);\n        this._containsForeignElements = containsForeignElements;\n        this._cachedWidth = -1;\n        this._pixelOffsetCache = null;\n        if (!containsRTL || this._characterMapping.length === 0 /* the line is empty */) {\n            this._pixelOffsetCache = new Float32Array(Math.max(2, this._characterMapping.length + 1));\n            for (let column = 0, len = this._characterMapping.length; column <= len; column++) {\n                this._pixelOffsetCache[column] = -1;\n            }\n        }\n    }\n    // --- Reading from the DOM methods\n    _getReadingTarget(myDomNode) {\n        return myDomNode.domNode.firstChild;\n    }\n    /**\n     * Width of the line in pixels\n     */\n    getWidth(context) {\n        if (!this.domNode) {\n            return 0;\n        }\n        if (this._cachedWidth === -1) {\n            this._cachedWidth = this._getReadingTarget(this.domNode).offsetWidth;\n            context === null || context === void 0 ? void 0 : context.markDidDomLayout();\n        }\n        return this._cachedWidth;\n    }\n    getWidthIsFast() {\n        if (this._cachedWidth === -1) {\n            return false;\n        }\n        return true;\n    }\n    /**\n     * Visible ranges for a model range\n     */\n    getVisibleRangesForRange(lineNumber, startColumn, endColumn, context) {\n        if (!this.domNode) {\n            return null;\n        }\n        if (this._pixelOffsetCache !== null) {\n            // the text is LTR\n            const startOffset = this._readPixelOffset(this.domNode, lineNumber, startColumn, context);\n            if (startOffset === -1) {\n                return null;\n            }\n            const endOffset = this._readPixelOffset(this.domNode, lineNumber, endColumn, context);\n            if (endOffset === -1) {\n                return null;\n            }\n            return [new FloatHorizontalRange(startOffset, endOffset - startOffset)];\n        }\n        return this._readVisibleRangesForRange(this.domNode, lineNumber, startColumn, endColumn, context);\n    }\n    _readVisibleRangesForRange(domNode, lineNumber, startColumn, endColumn, context) {\n        if (startColumn === endColumn) {\n            const pixelOffset = this._readPixelOffset(domNode, lineNumber, startColumn, context);\n            if (pixelOffset === -1) {\n                return null;\n            }\n            else {\n                return [new FloatHorizontalRange(pixelOffset, 0)];\n            }\n        }\n        else {\n            return this._readRawVisibleRangesForRange(domNode, startColumn, endColumn, context);\n        }\n    }\n    _readPixelOffset(domNode, lineNumber, column, context) {\n        if (this._characterMapping.length === 0) {\n            // This line has no content\n            if (this._containsForeignElements === 0 /* ForeignElementType.None */) {\n                // We can assume the line is really empty\n                return 0;\n            }\n            if (this._containsForeignElements === 2 /* ForeignElementType.After */) {\n                // We have foreign elements after the (empty) line\n                return 0;\n            }\n            if (this._containsForeignElements === 1 /* ForeignElementType.Before */) {\n                // We have foreign elements before the (empty) line\n                return this.getWidth(context);\n            }\n            // We have foreign elements before & after the (empty) line\n            const readingTarget = this._getReadingTarget(domNode);\n            if (readingTarget.firstChild) {\n                context.markDidDomLayout();\n                return readingTarget.firstChild.offsetWidth;\n            }\n            else {\n                return 0;\n            }\n        }\n        if (this._pixelOffsetCache !== null) {\n            // the text is LTR\n            const cachedPixelOffset = this._pixelOffsetCache[column];\n            if (cachedPixelOffset !== -1) {\n                return cachedPixelOffset;\n            }\n            const result = this._actualReadPixelOffset(domNode, lineNumber, column, context);\n            this._pixelOffsetCache[column] = result;\n            return result;\n        }\n        return this._actualReadPixelOffset(domNode, lineNumber, column, context);\n    }\n    _actualReadPixelOffset(domNode, lineNumber, column, context) {\n        if (this._characterMapping.length === 0) {\n            // This line has no content\n            const r = RangeUtil.readHorizontalRanges(this._getReadingTarget(domNode), 0, 0, 0, 0, context);\n            if (!r || r.length === 0) {\n                return -1;\n            }\n            return r[0].left;\n        }\n        if (column === this._characterMapping.length && this._isWhitespaceOnly && this._containsForeignElements === 0 /* ForeignElementType.None */) {\n            // This branch helps in the case of whitespace only lines which have a width set\n            return this.getWidth(context);\n        }\n        const domPosition = this._characterMapping.getDomPosition(column);\n        const r = RangeUtil.readHorizontalRanges(this._getReadingTarget(domNode), domPosition.partIndex, domPosition.charIndex, domPosition.partIndex, domPosition.charIndex, context);\n        if (!r || r.length === 0) {\n            return -1;\n        }\n        const result = r[0].left;\n        if (this.input.isBasicASCII) {\n            const horizontalOffset = this._characterMapping.getHorizontalOffset(column);\n            const expectedResult = Math.round(this.input.spaceWidth * horizontalOffset);\n            if (Math.abs(expectedResult - result) <= 1) {\n                return expectedResult;\n            }\n        }\n        return result;\n    }\n    _readRawVisibleRangesForRange(domNode, startColumn, endColumn, context) {\n        if (startColumn === 1 && endColumn === this._characterMapping.length) {\n            // This branch helps IE with bidi text & gives a performance boost to other browsers when reading visible ranges for an entire line\n            return [new FloatHorizontalRange(0, this.getWidth(context))];\n        }\n        const startDomPosition = this._characterMapping.getDomPosition(startColumn);\n        const endDomPosition = this._characterMapping.getDomPosition(endColumn);\n        return RangeUtil.readHorizontalRanges(this._getReadingTarget(domNode), startDomPosition.partIndex, startDomPosition.charIndex, endDomPosition.partIndex, endDomPosition.charIndex, context);\n    }\n    /**\n     * Returns the column for the text found at a specific offset inside a rendered dom node\n     */\n    getColumnOfNodeOffset(lineNumber, spanNode, offset) {\n        const spanNodeTextContentLength = spanNode.textContent.length;\n        let spanIndex = -1;\n        while (spanNode) {\n            spanNode = spanNode.previousSibling;\n            spanIndex++;\n        }\n        return this._characterMapping.getColumn(new DomPosition(spanIndex, offset), spanNodeTextContentLength);\n    }\n}\nclass WebKitRenderedViewLine extends RenderedViewLine {\n    _readVisibleRangesForRange(domNode, lineNumber, startColumn, endColumn, context) {\n        const output = super._readVisibleRangesForRange(domNode, lineNumber, startColumn, endColumn, context);\n        if (!output || output.length === 0 || startColumn === endColumn || (startColumn === 1 && endColumn === this._characterMapping.length)) {\n            return output;\n        }\n        // WebKit is buggy and returns an expanded range (to contain words in some cases)\n        // The last client rect is enlarged (I think)\n        if (!this.input.containsRTL) {\n            // This is an attempt to patch things up\n            // Find position of last column\n            const endPixelOffset = this._readPixelOffset(domNode, lineNumber, endColumn, context);\n            if (endPixelOffset !== -1) {\n                const lastRange = output[output.length - 1];\n                if (lastRange.left < endPixelOffset) {\n                    // Trim down the width of the last visible range to not go after the last column's position\n                    lastRange.width = endPixelOffset - lastRange.left;\n                }\n            }\n        }\n        return output;\n    }\n}\nconst createRenderedLine = (function () {\n    if (browser.isWebKit) {\n        return createWebKitRenderedLine;\n    }\n    return createNormalRenderedLine;\n})();\nfunction createWebKitRenderedLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements) {\n    return new WebKitRenderedViewLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements);\n}\nfunction createNormalRenderedLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements) {\n    return new RenderedViewLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './margin.css';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { ViewPart } from '../../view/viewPart.js';\nclass Margin extends ViewPart {\n    constructor(context) {\n        super(context);\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._canUseLayerHinting = !options.get(29 /* EditorOption.disableLayerHinting */);\n        this._contentLeft = layoutInfo.contentLeft;\n        this._glyphMarginLeft = layoutInfo.glyphMarginLeft;\n        this._glyphMarginWidth = layoutInfo.glyphMarginWidth;\n        this._domNode = createFastDomNode(document.createElement('div'));\n        this._domNode.setClassName(Margin.OUTER_CLASS_NAME);\n        this._domNode.setPosition('absolute');\n        this._domNode.setAttribute('role', 'presentation');\n        this._domNode.setAttribute('aria-hidden', 'true');\n        this._glyphMarginBackgroundDomNode = createFastDomNode(document.createElement('div'));\n        this._glyphMarginBackgroundDomNode.setClassName(Margin.CLASS_NAME);\n        this._domNode.appendChild(this._glyphMarginBackgroundDomNode);\n    }\n    dispose() {\n        super.dispose();\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(138 /* EditorOption.layoutInfo */);\n        this._canUseLayerHinting = !options.get(29 /* EditorOption.disableLayerHinting */);\n        this._contentLeft = layoutInfo.contentLeft;\n        this._glyphMarginLeft = layoutInfo.glyphMarginLeft;\n        this._glyphMarginWidth = layoutInfo.glyphMarginWidth;\n        return true;\n    }\n    onScrollChanged(e) {\n        return super.onScrollChanged(e) || e.scrollTopChanged;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    render(ctx) {\n        this._domNode.setLayerHinting(this._canUseLayerHinting);\n        this._domNode.setContain('strict');\n        const adjustedScrollTop = ctx.scrollTop - ctx.bigNumbersDelta;\n        this._domNode.setTop(-adjustedScrollTop);\n        const height = Math.min(ctx.scrollHeight, 1000000);\n        this._domNode.setHeight(height);\n        this._domNode.setWidth(this._contentLeft);\n        this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft);\n        this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth);\n        this._glyphMarginBackgroundDomNode.setHeight(height);\n    }\n}\nMargin.CLASS_NAME = 'glyph-margin';\nMargin.OUTER_CLASS_NAME = 'margin';\nexport { Margin };\n"],"names":["ViewContentWidgets","_ViewPart","_inherits","_super","_createSuper","context","viewDomNode","_this","_classCallCheck","call","_viewDomNode","_widgets","domNode","createFastDomNode","document","createElement","PartFingerprints","write","setClassName","setPosition","setTop","overflowingContentWidgetsDomNode","_createClass","key","value","_get","_getPrototypeOf","prototype","this","e","_i","_keys","Object","keys","length","widgetId","onConfigurationChanged","_updateAnchorsViewPositions","_i2","_keys2","updateAnchorViewPosition","_widget","myWidget","Widget","_context","id","allowEditorOverflow","appendChild","setShouldRender","widget","primaryAnchor","secondaryAnchor","preference","affinity","getId","hasOwnProperty","parentNode","removeChild","removeAttribute","suppressMouseDown","viewportData","_i3","_keys3","onBeforeRender","ctx","_i4","_keys4","prepareRender","_i5","_keys5","render","ViewPart","actual","_primaryAnchor","PositionPair","_secondaryAnchor","_actual","getDomNode","options","configuration","layoutInfo","get","_fixedOverflowWidgets","_contentWidth","contentWidth","_contentLeft","contentLeft","_lineHeight","_affinity","_preference","_cachedDomNodeOffsetWidth","_cachedDomNodeOffsetHeight","_maxWidth","_getMaxWidth","_isVisible","_renderData","setDisplay","setVisibility","setAttribute","setMaxWidth","hasChanged","_setPosition","modelPosition","getValidPositionPair","position","viewModel","validModelPosition","model","validatePosition","coordinatesConverter","modelPositionIsVisible","viewPosition","convertModelPositionToViewPosition","undefined","window","innerWidth","documentElement","offsetWidth","body","anchor","width","height","aboveLineTop","top","heightAvailableAboveLine","underLineTop","aboveTop","fitsAbove","belowTop","fitsBelow","viewportHeight","left","scrollLeft","viewportWidth","windowSize","domNodePosition","MIN_LIMIT","Math","max","MAX_LIMIT","min","absoluteLeft","scrollX","delta","dom","getDomNodePagePosition","absoluteAboveTop","scrollY","absoluteBelowTop","getClientArea","_this$_layoutHorizont","_layoutHorizontalSegmentInPage","_this$_layoutHorizont2","_slicedToArray","absoluteAboveLeft","topLeft","Coordinate","_a","_b","primary","getCoordinates","secondary","lineNumber","lineHeight","horizontalPosition","visibleRangeForPosition","column","getVerticalOffsetForLineNumber","scrollTop","AnchorCoordinate","fontInfo","typicalFullwidthCharacterWidth","_this$_getAnchorsCoor","_getAnchorsCoordinates","preferredDimensions","beforeRender","safeInvoke","clientRect","getBoundingClientRect","round","placement","_reduceAnchorCoordinates","_layoutBoxInPage","_layoutBoxInViewport","pass","_step","_iterator","_createForOfIteratorHelper","s","n","done","pref","coordinate","_prepareRenderWidgetAtExactPositionOverflowing","err","f","startLineNumber","endLineNumber","_prepareRenderWidget","afterRender","setLeft","bigNumbersDelta","_coordinateBrand","_anchorCoordinateBrand","fn","thisArg","_len","arguments","args","Array","_key","apply","concat","AbstractLineHighlightOverlay","_DynamicViewOverlay","_renderLineHighlight","_renderLineHighlightOnlyWhenFocus","_selectionIsEmpty","_focused","_cursorLineNumbers","_selections","Selection","addEventHandler","_assertThisInitialized","removeEventHandler","cursorsLineNumbers","map","positionLineNumber","sort","a","b","arrays","selectionIsEmpty","every","isEmpty","_readFromSelections","selections","scrollWidthChanged","scrollTopChanged","isFocused","_shouldRenderThis","renderedLine","_renderOne","visibleStartLineNumber","visibleRange","visibleEndLineNumber","len","index","renderData","lineIndex","DynamicViewOverlay","CurrentLineHighlightOverlay","_AbstractLineHighligh","_super2","className","_shouldRenderOther","scrollWidth","_shouldRenderInContent","_shouldRenderInMargin","CurrentLineMarginHighlightOverlay","_AbstractLineHighligh2","_super3","registerThemingParticipant","theme","collector","lineHighlight","getColor","editorLineHighlight","addRule","isTransparent","defines","editorLineHighlightBorder","lineHighlightBorder","isHighContrast","type","DecorationsOverlay","_typicalHalfwidthCharacterWidth","typicalHalfwidthCharacterWidth","_renderResult","_decorations","getDecorationsInViewport","decorations","decorationsLen","i","d","zIndex","aClassName","bClassName","Range","compareRangesUsingStarts","range","output","_renderWholeLineDecorations","_renderNormalDecorations","String","lenI","isWholeLine","decorationOutput","j","prevClassName","prevShowIfCollapsed","prevRange","showIfCollapsed","Boolean","endColumn","startColumn","getLineMaxColumn","areIntersectingOrTouching","plusRange","_renderNormalDecoration","linesVisibleRanges","linesVisibleRangesForRange","lenJ","lineVisibleRanges","outsideRenderedLine","ranges","singleVisibleRange","center","HorizontalRange","k","lenK","EditorScrollbar","linesContent","overflowGuardDomNode","scrollbar","mouseWheelScrollSensitivity","fastScrollSensitivity","scrollPredominantAxis","scrollbarOptions","listenOnDomNode","getThemeTypeSelector","useShadows","lazyRender","vertical","horizontal","verticalHasArrows","horizontalHasArrows","verticalScrollbarSize","verticalSliderSize","horizontalScrollbarSize","horizontalSliderSize","handleMouseWheel","alwaysConsumeMouseWheel","arrowSize","scrollByPage","_register","SmoothScrollableElement","viewLayout","getScrollable","scrollbarDomNode","_setLayout","onBrowserDesperateReveal","lookAtScrollTop","lookAtScrollLeft","newScrollPosition","deltaTop","getCurrentScrollTop","deltaLeft","getCurrentScrollLeft","setScrollPosition","addDisposableListener","side","setWidth","minimap","minimapWidth","setHeight","getOverviewRulerLayoutInfo","browserEvent","delegateVerticalScrollbarPointerDown","delegateScrollFromMouseWheelEvent","newOpts","updateOptions","updateClassName","renderNow","DecorationToRender","_decorationToRenderBrand","DedupOverlay","prevEndLineIndex","startLineIndex","endLineIndex","push","GlyphMarginOverlay","_DedupOverlay","_glyphMargin","_glyphMarginLeft","glyphMarginLeft","_glyphMarginWidth","glyphMarginWidth","r","rLen","glyphMarginClassName","toRender","_render","_getDecorations","toString","common","classNames","join","IndentGuidesOverlay","_primaryPosition","wrappingInfo","_spaceWidth","spaceWidth","_maxIndentLeft","wrappingColumn","_bracketPairGuideOptions","newPosition","getPosition","equals","_c","_d","indentation","bracketPairs","activeCursorPosition","indents","getGuidesByLine","getLineCount","indent","result","leftOffset","Position","guide","visibleColumn","horizontalLine","_this2","bracketGuides","getBracketGuidesInRangeByLine","highlightActive","highlightActiveBracketPair","horizontalGuides","bracketPairsHorizontal","HorizontalGuidesState","Enabled","EnabledForActive","Disabled","includeInactive","indentGuides","getLinesIndentGuides","activeIndentStartLineNumber","activeIndentEndLineNumber","activeIndentLevel","highlightActiveIndentation","activeIndentInfo","getActiveIndentGuide","indentSize","getOptions","lineGuides","bracketGuidesInLine","bracketGuidesInLineQueue","ArrayQueue","indentGuidesInLine","_loop","indentGuide","indentLvl","isActive","_toConsumableArray","takeWhile","g","peeked","peek","IndentGuide","transparentToUndefined","color","colors","bracketColor","editorBracketHighlightingForeground1","guideColor","editorBracketPairGuideBackground1","guideColorActive","editorBracketPairGuideActiveBackground1","editorBracketHighlightingForeground2","editorBracketPairGuideBackground2","editorBracketPairGuideActiveBackground2","editorBracketHighlightingForeground3","editorBracketPairGuideBackground3","editorBracketPairGuideActiveBackground3","editorBracketHighlightingForeground4","editorBracketPairGuideBackground4","editorBracketPairGuideActiveBackground4","editorBracketHighlightingForeground5","editorBracketPairGuideBackground5","editorBracketPairGuideActiveBackground5","editorBracketHighlightingForeground6","editorBracketPairGuideBackground6","editorBracketPairGuideActiveBackground6","colorProvider","BracketPairGuidesClassNames","colorValues","c","effectiveGuideColor","transparent","effectiveGuideColorActive","filter","isDefined","level","getInlineClassNameOfLevel","replace","activeClassName","DomReadingContext","_domNode","endNode","_didDomLayout","_clientRectDeltaLeft","_clientRectScale","_clientRectRead","rect","markDidDomLayout","readClientRect","LastRenderedData","_currentVisibleRange","currentVisibleRange","HorizontalRevealRangeRequest","minimalReveal","startScrollTop","stopScrollTop","scrollType","minLineNumber","maxLineNumber","HorizontalRevealSelectionsRequest","selection","ViewLines","_linesContent","_textRangeRestingSpot","_visibleLines","VisibleLinesCollection","conf","_isViewportWrapping","isViewportWrapping","_revealHorizontalRightPadding","_cursorSurroundingLines","_cursorSurroundingLinesStyle","_canUseLayerHinting","_viewLineOptions","ViewLineOptions","MOUSE_CURSOR_TEXT_CSS_CLASS_NAME","applyFontInfo","_maxLineWidth","_asyncUpdateLineWidths","RunOnceScheduler","_updateLineWidthsSlow","_asyncCheckMonospaceFontAssumptions","_checkMonospaceFontAssumptions","_lastRenderedData","_horizontalRevealRequest","_stickyScrollEnabled","enabled","_maxNumberStickyLines","maxLineCount","dispose","ViewLine","_onOptionsMaybeChanged","newViewLineOptions","getStartLineNumber","getEndLineNumber","getVisibleLine","onOptionsChanged","rendStartLineNumber","rendEndLineNumber","onSelectionChanged","onDecorationsChanged","shouldRender","onFlushed","onLinesChanged","onLinesDeleted","onLinesInserted","desiredScrollTop","_computeScrollTopToRevealRange","getFutureViewport","source","verticalType","validateScrollPosition","revealHorizontal","abs","scrollLeftChanged","onScrollChanged","onTokensChanged","setMaxLineWidth","onZonesChanged","spanNode","offset","viewLineDomNode","_getViewLineDomNode","_getLineNumberFor","getColumnOfNodeOffset","minColumn","getLineMinColumn","node","nodeType","CLASS_NAME","parentElement","getWidth","_updateLineWidthsSlowIfDomDidLayout","_range","includeNewLines","originalEndLineNumber","intersectRanges","getCurrentVisibleRange","visibleRanges","visibleRangesLen","domReadingContext","nextLineModelLineNumber","convertViewPositionToModelPosition","visibleRangesForLine","getVisibleRangesForRange","LineVisibleRanges","from","_visibleRangesForLineRange","HorizontalPosition","_updateLineWidths","didDomLayout","isScheduled","cancel","fast","localMaxLineWidth","allWidthsComputed","visibleLine","getWidthIsFast","_ensureMaxLineWidth","longestLineNumber","longestWidth","needsMonospaceFontCheck","lineWidth","monospaceAssumptionsAreValid","onMonospaceAssumptionsInvalidated","Error","renderLines","setCurrentVisibleRange","getScrollWidth","getScrollHeight","horizontalRevealRequest","onDidRender","newScrollLeft","_computeScrollLeftToReveal","maxHorizontalOffset","_updateLineWidthsFast","schedule","platform","setLayerHinting","setContain","adjustedScrollTop","iLineWidth","ceil","viewport","boxIsSingleRange","boxStartY","boxEndY","viewportStartY","viewportEndY","newScrollTop","paddingTop","paddingBottom","minScrollTop","boxMiddleY","_computeMinimumScrolling","getCurrentViewport","viewportStartX","viewportEndX","verticalScrollbarWidth","boxStartX","boxEndX","_step2","_iterator2","_step3","_iterator3","HORIZONTAL_EXTRA_PX","viewportStart","viewportEnd","boxStart","boxEnd","revealAtStart","revealAtEnd","viewportLength","LinesDecorationsOverlay","_decorationsLeft","decorationsLeft","_decorationsWidth","decorationsWidth","linesDecorationsClassName","firstLineDecorationClassName","lineOutput","MarginViewLineDecorationsOverlay","marginClassName","allCharCodes","v","MinimapCharRenderer","charData","scale","_minimapCharRendererBrand","charDataNormal","soften","charDataLight","target","dx","dy","chCode","foregroundAlpha","backgroundColor","backgroundAlpha","fontScale","useLighterFont","force1pxHeight","charWidth","charHeight","renderHeight","console","warn","charIndex","getCharIndex","destWidth","backgroundR","backgroundG","backgroundB","deltaR","deltaG","deltaB","destAlpha","dest","data","sourceOffset","row","y","x","colorR","colorG","colorB","input","ratio","Uint8ClampedArray","toUint8","charTable","A","B","C","D","E","F","decodeData","str","prebakedMiniMaps","once","MinimapCharRendererFactory","fontFamily","lastCreated","lastFontFamily","factory","createFromSampleData","createSampleData","canvas","getContext","style","fillStyle","font","textBaseline","code","fillText","fromCharCode","getImageData","_downsample","destOffset","targetIndex","brightest","sourceY1","sourceY2","sourceX1","sourceX2","samples","sy","sourceRow","floor","yBalance","sx","xBalance","sourceIndex","weight","final","pixelsPerCharacter","resultLen","resultOffset","_downsampleChar","adjust","MinimapOptions","tokensColorTracker","pixelRatio","minimapLayout","minimapOpts","renderMinimap","size","minimapHeightIsEditorHeight","scrollBeyondLastLine","bottom","showSlider","autohide","minimapLeft","minimapHeight","canvasInnerWidth","minimapCanvasInnerWidth","canvasInnerHeight","minimapCanvasInnerHeight","canvasOuterWidth","minimapCanvasOuterWidth","canvasOuterHeight","minimapCanvasOuterHeight","isSampling","minimapIsSampling","editorHeight","minimapScale","minimapLineHeight","minimapCharWidth","charRenderer","create","defaultBackgroundColor","_getMinimapBackground","_getMinimapForegroundOpacity","other","themeColor","minimapBackground","RGBA8","rgba","minimapForegroundOpacity","_clamp","MinimapLayout","scrollHeight","sliderNeeded","_computedSliderRatio","sliderTop","sliderHeight","topPaddingLineCount","pageY","viewportStartLineNumber","viewportEndLineNumber","viewportStartLineNumberVerticalOffset","viewportContainsWhitespaceGaps","lineCount","realLineCount","previousLayout","minimapLinesFitting","logicalScrollHeight","maxMinimapSliderTop","computedSliderRatio","maxLinesFitting","viewportLineCount","expectedViewportLineCount","extraLinesAtTheTop","extraLinesAtTheBottom","consideringStartLineNumber","partialLine","MinimapLine","INVALID","RenderData","renderedLayout","imageData","lines","_imageData","_renderedLines","RenderedLinesCollection","_set","layout","scrollEquals","tmp","rendLineNumberStart","changeFromLineNumber","changeCount","deleteFromLineNumber","deleteToLineNumber","insertFromLineNumber","insertToLineNumber","MinimapBuffers","WIDTH","HEIGHT","background","_backgroundFillData","_createBackgroundFillData","_buffers","createImageData","_lastUsedBuffer","set","backgroundA","MinimapSamplingState","samplingRatio","minimapLines","fromLineNumber","toLineNumber","fromLineIndex","modelLineToMinimapLine","toLineIndex","sampledLineNumber","minimapLineStart","minimapLineEnd","deletedLineCount","changeStartIndex","changeEndIndex","insertedLineCount","viewLineCount","oldSamplingState","minimapLineCount","EditorLayoutInfoComputer","computeContainedMinimapLineCount","halfRatio","lastIndex","oldMinimapLines","oldLength","oldIndex","oldDeltaLineCount","minViewLineNumber","events","lastEvent","fromViewLineNumber","toViewLineNumber","oldMinimapLineNumber","_oldIndex","selectedViewLineNumber","Minimap","MinimapTokensColorTracker","getInstance","_minimapSelections","_MinimapSamplingState","compute","samplingState","_samplingState","_shouldCheckSampling","InnerMinimap","_get2","opts","_recreateLineSampling","onDidChangeOptions","affectsMinimap","minimapLineRange","modelLineRangeToMinimapLineRange","count","_this$_samplingState$","_this$_samplingState$2","onThemeChanged","onTokensColorsChanged","minimapCtx","whitespaceViewportData","wasSampling","_MinimapSamplingState3","_MinimapSamplingState4","event","getLineContent","needed","getViewLineData","getMinimapLinesRenderingData","_this$_samplingState$3","decorationLineRangeToMinimapLineRange","_this$_samplingState$4","modelStartLineNumber","modelEndLineNumber","_step4","_iterator4","decoration","minimapStartLineNumber","minimapEndLineNumber","ViewModelDecoration","revealRange","_Disposable","_this3","_renderDecorations","_gestureInProgress","_theme","_model","_lastRenderData","_selectionColor","minimapSelection","_getMinimapDomNodeClassName","_shadow","_canvas","_decorationsCanvas","_slider","_sliderHorizontal","_applyLayout","_pointerDownListener","addStandardDisposableListener","EventType","POINTER_DOWN","preventDefault","internalOffsetY","offsetY","revealLineNumber","button","initialPosY","_startSliderDragging","_sliderPointerMoveMonitor","GlobalPointerMoveMonitor","_sliderPointerDownListener","stopPropagation","_gestureDisposable","Gesture","addTarget","_sliderTouchStartListener","Start","toggleClassName","scrollDueToTouchEvent","passive","_sliderTouchMoveListener","Change","_sliderTouchEndListener","End","initialSliderState","_this4","Element","initialPosX","pageX","handlePointerMove","posy","posx","minimapPosition","pointerOrthogonalDelta","setScrollTop","pointerDelta","getDesiredScrollTopFromDelta","startMonitoring","pointerId","buttons","pointerMoveData","touch","startY","getDesiredScrollTopFromTouchLocation","class_","getBuffer","renderingCtx","getRealLineCount","renderDecorations","getSelections","getMinimapDecorationsInViewport","_this$_model$options","tabSize","canvasContext","clearRect","highlightedLines","ContiguousLineMap","_renderSelectionLineHighlights","_renderDecorationsLineHighlights","lineOffsetMap","_renderSelectionsHighlights","_renderDecorationsHighlights","_step5","y1","y2","_iterator5","intersection","intersectWithViewport","_intersection","line","yy1","getYForLineNumber","yy2","fillRect","MINIMAP_GUTTER_WIDTH","highlightColors","Map","minimapOptions","MinimapPosition","Inline","_intersection2","decorationColor","highlightColor","has","characterWidth","_step6","_iterator6","_intersection3","renderDecorationOnLine","_step7","_iterator7","_intersection4","Gutter","renderDecoration","decorationRange","x1","getXOffsetForPosition","x2","lineIndexToXOffset","lineData","prevx","charCode","charCodeAt","strings","linesEquals","_lastData","_getBuffer","_InnerMinimap$_render","_renderUntouchedLines","_InnerMinimap$_render2","_dirtyY1","_dirtyY2","lineInfo","defaultBackground","backgroundIsLight","renderMinimapLineHeight","innerLinePadding","renderBackground","renderedLines","_renderLine","dirtyY1","dirtyHeight","putImageData","lastRenderData","lastTargetData","lastStartLineNumber","lastLines","lastLinesLength","targetData","maxDestPixel","dirtyPixel1","dirtyPixel2","copySourceStart","copySourceEnd","copyDestStart","copyDestEnd","dest_dy","lastLineIndex","source_dy","sourceStart","sourceEnd","destStart","destEnd","subarray","colorTracker","minimapCharRenderer","content","tokens","maxDx","tabsCharDelta","tokenIndex","tokensLen","getCount","tokenEndIndex","getEndOffset","tokenColorId","getForeground","tokenColor","insertSpacesCount","blockRenderChar","renderChar","Disposable","defaultValue","_startLineNumber","_endLineNumber","_defaultValue","_values","ViewOverlayWidgets","_verticalScrollbarWidth","_minimapWidth","_horizontalScrollbarHeight","horizontalScrollbarHeight","_editorHeight","_editorWidth","widgetData","setRight","widgetHeight","clientHeight","right","_renderWidget","Settings","config","overviewRulerLanes","renderBorder","borderColor","editorOverviewRulerBorder","hideCursor","cursorColor","editorCursorForeground","themeType","minimapEnabled","minimapSide","editorOverviewRulerBackground","TokenizationRegistry","getDefaultBackground","overviewRuler","domWidth","domHeight","canvasWidth","canvasHeight","_this$_initLanes","_initLanes","_this$_initLanes2","w","canvasLeftOffset","laneCount","remainingWidth","leftWidth","rightWidth","centerWidth","centerOffset","Color","DecorationsOverviewRuler","_updateSettings","_tokensColorTrackerListener","onDidChange","changedColorMap","_cursorPositions","newSettings","_settings","compare","affectsOverviewRuler","scrollHeightChanged","editorCtx","setBackgroundColor","Format","CSS","formatHexA","heightRatio","getAllOverviewRulerDecorations","minDecorationHeight","halfMinDecorationHeight","canvasCtx","isOpaque","OverviewRulerDecorationsGroup","cmp","decorationGroup","decorationGroupData","prevLane","prevY1","prevY2","lane","yCenter","cursorHeight","halfCursorHeight","cursorX","cursorW","cursor","beginPath","strokeStyle","moveTo","lineTo","stroke","OverviewRuler","_ViewEventHandler","cssClassName","_zoneManager","OverviewZoneManager","setDOMWidth","setDOMHeight","setOuterHeight","setLineHeight","setPixelRatio","getDOMWidth","getDOMHeight","getCanvasWidth","getCanvasHeight","zones","setZones","getOuterHeight","colorZones","resolveColorZones","id2Color","getId2Color","_renderOneLane","currentColorId","currentFrom","currentTo","zone","zoneColorId","colorId","zoneFrom","zoneTo","to","ViewEventHandler","Rulers","_renderedRulers","_rulers","currentCount","desiredCount","rulerWidth","addCount","removeCount","pop","_ensureRulersCount","ruler","setBoxShadow","ScrollDecorationViewPart","_scrollTop","_width","_updateWidth","_shouldShow","_useShadows","newShouldShow","_updateShouldShow","HorizontalRangeWithStyle","startStyle","endStyle","LineVisibleRangesWithStyle","toStyledRange","item","toStyled","SelectionsOverlay","_previousFrameVisibleRangesWithStyle","_roundedSelection","slice","previousFrame","epsilon","previousFrameTop","previousFrameBottom","topLineNumber","bottomLineNumber","curLineRange","curLeft","curRight","prevLeft","prevRight","nextLeft","nextRight","_visibleRangesHaveGaps","_enrichVisibleRangesWithStyle","output2","hasMultipleSelections","visibleRangesHaveStyle","fullLineHeight","reducedLineHeight","firstLineNumber","lastLineNumber","innerCornerOutput","restOfSelectionOutput","_createSelectionPiece","SELECTION_CLASS_NAME","ROUNDED_PIECE_WIDTH","EDITOR_BACKGROUND_CLASS_NAME","SELECTION_TOP_RIGHT","SELECTION_BOTTOM_RIGHT","SELECTION_TOP_LEFT","SELECTION_BOTTOM_LEFT","thisFrameVisibleRangesWithStyle","visibleRangesWithStyle","_getVisibleRangesWithStyle","_actualRenderOneSelection","_ref","_ref2","editorSelectionForegroundColor","editorSelectionForeground","ViewCursorRenderData","paddingLeft","textContent","textContentClassName","ViewCursor","_cursorStyle","_lineCursorWidth","_position","_lastRenderedContent","pauseAnimation","transitionProperty","_this$_position","lineContent","_strings$getCharConta","_strings$getCharConta2","startOffset","endOffset","substring","_this$_getGraphemeAwa","_getGraphemeAwarePosition","_this$_getGraphemeAwa2","nextGrapheme","TextEditorCursorStyle","Line","LineThin","computeScreenAwareSize","_getTokenClassName","visibleRangeForCharacter","firstVisibleRangeForCharacter","Block","Underline","UnderlineThin","findTokenIndexAtOffset","getClassName","_prepareRender","setPaddingLeft","ViewCursors","_readOnly","_cursorBlinking","_cursorSmoothCaretAnimation","_isComposingInput","_primaryCursor","_secondaryCursors","_updateDomClassName","_startCursorBlinkAnimation","TimeoutTimer","_cursorFlatBlinkInterval","IntervalTimer","_blinkingEnabled","_editorHasFocus","_updateBlinking","secondaryPositions","reason","onCursorPositionChanged","addCnt","newCursor","insertBefore","nextSibling","removeCnt","splice","positions","_onCursorPositionChanged","blinkingStyle","_getCursorBlinking","isHidden","isSolid","_hide","_show","cancelAndSet","BLINK_INTERVAL","setIfNotSet","_getClassName","BlockOutline","show","hide","renderDataLen","primaryRenderData","secondaryRenderData","caret","caretBackground","editorCursorBackground","opposite","invalidFunc","ViewZones","marginDomNode","_zones","whitespaces","getWhitespaces","oldWhitespaces","whitespace","hadAChange","changeWhitespace","whitespaceAccessor","props","_computeWhitespaceProps","delegate","isInHiddenArea","oldWhitespace","afterLineNumber","afterViewLineNumber","heightInPx","changeOneWhitespace","_safeCallOnComputedHeight","_recomputeWhitespacesProps","afterColumn","_heightInPixels","minWidthInPx","_minWidthInPixels","zoneAfterModelPosition","zoneBeforeModelPosition","validAfterLineNumber","afterColumnAffinity","isVisible","callback","zonesHaveChanged","changeAccessor","addZone","_addZone","removeZone","_removeZone","layoutZone","_layoutZone","func","arg1","onUnexpectedError","safeInvoke1Arg","myZone","whitespaceId","insertWhitespace","_getZoneOrdinal","removeWhitespace","heightInLines","onComputedHeight","onDomNodeTop","visibleWhitespaces","visibleZones","hasVisibleZone","visibleWhitespace","newTop","newHeight","newDisplay","verticalOffset","_safeCallOnDomNodeTop","getScrolledTopFromAbsoluteTop","BlockDecorations","blocks","update","didChange","newContentWidth","blockClassName","block","blockIsAfterEnd","getVerticalOffsetAfterLineNumber","remove","WhitespaceOverlay","_options","WhitespaceOptions","_selection","newOptions","renderWhitespace","selectionsOnLine","maxColumn","LineRange","_applyRenderWhitespace","continuesWithWrappedLine","lastNonWhitespaceIndex","editorWhitespaces","USE_SVG","renderWithSVG","stopRenderingLineAfter","fauxIndentLength","onlyBoundary","onlyTrailing","middotWidth","wsmiddotWidth","renderSpaceCharCode","canUseHalfwidthRightwardsArrow","lineIsEmptyOrWhitespace","firstNonWhitespaceIndex","currentSelectionIndex","currentSelection","maxLeft","prevChCode","nextChCode","prevCharCode","_renderArrow","toFixed","p1","p2","p3","p4","p5","parts","p","experimentalWhitespaceRendering","View","commandDelegate","colorTheme","userInputEvents","overflowWidgetsDomNode","_renderAnimationFrame","viewController","ViewController","ViewContext","_viewParts","_textAreaHandler","TextAreaHandler","_createTextAreaHandlerHelper","_getEditorClassName","_overflowGuardContainer","_scrollbar","_viewLines","_viewZones","decorationsOverviewRuler","scrollDecoration","contentViewOverlays","ContentViewOverlays","addDynamicOverlay","marginViewOverlays","MarginViewOverlays","LineNumbersOverlay","margin","Margin","_contentWidgets","_viewCursors","_overlayWidgets","rulers","blockOutline","overviewRulerData","parent","textArea","textAreaCover","_pointerHandler","PointerHandler","_createPointerHandlerHelper","inputLatency","onRenderStart","_renderNow","linesContentDomNode","viewLinesDomNode","focusTextArea","focus","dispatchTextAreaEvent","dispatchEvent","getLastRenderData","lastViewCursorsRenderData","lastTextareaPosition","PointerHandlerLastRenderData","shouldSuppressMouseDownOnViewZone","viewZoneId","shouldSuppressMouseDownOnWidget","getPositionFromDOMInfo","_flushAccumulatedAndRenderNow","getLineWidth","focused","_scheduleRender","runAtThisOrScheduleAtNextAnimationFrame","_onRenderScheduled","bind","safeInvokeNoArg","_actualRender","viewPart","isInDOM","viewPartsToRender","_getViewPartsToRender","partialViewportData","getLinesViewportData","setViewport","centeredLineNumber","ViewportData","getWhitespaceViewportData","renderText","renderingContext","RenderingContext","scrollPosition","tokenizeViewport","modelLineNumber","modelColumn","clientX","clientY","mouseTarget","getTargetAtClientPoint","ViewUserInputEvents","convertViewToModelMouseTarget","changeViewZones","now","everything","forceShouldRender","writeScreenReaderContent","setAriaOptions","addWidget","layoutContentWidget","_e","_f","_g","_h","setWidgetPosition","secondaryPosition","positionAffinity","removeWidget","layoutOverlayWidget","newPreference","ttPolicy","trustedTypes","createPolicy","createHTML","DOMLineBreaksComputerFactory","wrappingIndent","wordBreak","requests","injectedTexts","addRequest","lineText","injectedText","previousLineBreakData","finalize","firstLineBreakColumn","injectedTextsPerLine","createEmptyLineBreakWithPossiblyInjectedText","requestIdx","LineInjectedText","applyInjectedText","injectionOptions","t","injectionOffsets","text","ModelLineProjectionData","overallWidth","additionalIndent","additionalIndentSize","additionalIndentLength","containerDomNode","sb","StringBuilder","firstNonWhitespaceIndices","wrappedTextIndentLengths","renderLineContents","allCharOffsets","allVisibleColumns","wrappedTextIndentLength","indentWidth","renderLineContent","substr","renderLine","html","build","trustedhtml","innerHTML","overflowWrap","createRange","lineDomNodes","children","breakOffsets","readLineBreaks","visibleColumns","breakOffsetsVisibleColumn","curInjectedTexts","createLineBreaks","initialVisibleColumn","wrappingIndentLength","hangingOffset","appendString","charOffset","charOffsets","nextCharCode","producedCharacters","space","appendCharCode","appendASCIICharCode","lineDomNode","spans","discoverBreaks","log","low","lowRects","high","highRects","mid","midRects","setStart","firstChild","setEnd","getClientRects","_readConfig","_lastCursorModelPosition","_activeLineNumber","lineNumbers","_renderLineNumbers","renderType","_renderCustomLineNumbers","renderFn","_renderFinalNewline","_lineNumbersLeft","lineNumbersLeft","_lineNumbersWidth","lineNumbersWidth","primaryViewPosition","viewLineNumber","diff","lineHeightClassName","renderLineNumber","_getLineRenderLineNumber","extraClassName","getLineLength","editorLineNumbersColor","editorLineNumbers","editorDimmedLineNumberColor","editorDimmedLineNumber","RangeUtil","_handyReadyRange","selectNodeContents","startElement","endElement","_createRange","_detachRange","FloatHorizontalRange","prev","clientRects","clientRectDeltaLeft","clientRectScale","_mergeAdjacentRanges","startChildIndex","endChildIndex","_createHorizontalRangesFromClientRects","_readClientRects","canUseFastRenderedViewLine","browser","isFirefox","isSafari","renderControlCharacters","useMonospaceOptimizations","isMonospace","fontLigatures","_isMaybeInvalid","_renderedViewLine","getViewLineRenderingData","actualInlineDecorations","LineDecoration","inlineDecorations","renderLineInput","RenderLineInput","isBasicASCII","containsRTL","startVisibleColumn","EditorFontLigatures","OFF","renderViewLine","renderedViewLine","containsForeignElements","FastRenderedViewLine","characterMapping","createRenderedLine","toSlowRenderedLine","VisibleRanges","horizontalRanges","_cachedWidth","keyColumnCount","_keyColumnPixelOffsetCache","Float32Array","_characterMapping","_charWidth","horizontalOffset","getHorizontalOffset","_getReadingTarget","expectedWidth","actualWidth","startPosition","_getColumnPixelOffset","endPosition","keyColumnOrdinal","keyColumn","keyColumnPixelOffset","_actualReadPixelOffset","keyColumnHorizontalOffset","myDomNode","domPosition","getDomPosition","readHorizontalRanges","partIndex","spanNodeTextContentLength","spanIndex","previousSibling","getColumn","DomPosition","RenderedViewLine","_isWhitespaceOnly","test","_containsForeignElements","_pixelOffsetCache","_readPixelOffset","_readVisibleRangesForRange","pixelOffset","_readRawVisibleRangesForRange","readingTarget","cachedPixelOffset","expectedResult","startDomPosition","endDomPosition","WebKitRenderedViewLine","_RenderedViewLine","endPixelOffset","lastRange","isWebKit","createWebKitRenderedLine","createNormalRenderedLine","OUTER_CLASS_NAME","_glyphMarginBackgroundDomNode"],"sourceRoot":""}