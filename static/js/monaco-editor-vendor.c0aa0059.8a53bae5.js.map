{"version":3,"file":"static/js/monaco-editor-vendor.c0aa0059.8a53bae5.js","mappings":"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","sources":["../node_modules/monaco-editor/esm/vs/editor/browser/config/domFontInfo.js","../node_modules/monaco-editor/esm/vs/editor/browser/config/editorConfiguration.js","../node_modules/monaco-editor/esm/vs/editor/browser/config/migrateOptions.js","../node_modules/monaco-editor/esm/vs/editor/browser/config/elementSizeObserver.js","../node_modules/monaco-editor/esm/vs/editor/browser/config/charWidthReader.js","../node_modules/monaco-editor/esm/vs/editor/browser/config/fontMeasurements.js","../node_modules/monaco-editor/esm/vs/editor/browser/config/tabFocus.js","../node_modules/monaco-editor/esm/vs/editor/browser/controller/mouseTarget.js","../node_modules/monaco-editor/esm/vs/editor/browser/controller/mouseHandler.js","../node_modules/monaco-editor/esm/vs/editor/browser/controller/pointerHandler.js","../node_modules/monaco-editor/esm/vs/editor/browser/controller/textAreaHandler.js","../node_modules/monaco-editor/esm/vs/editor/browser/controller/textAreaInput.js","../node_modules/monaco-editor/esm/vs/editor/browser/controller/textAreaState.js","../node_modules/monaco-editor/esm/vs/editor/browser/coreCommands.js","../node_modules/monaco-editor/esm/vs/editor/browser/editorBrowser.js","../node_modules/monaco-editor/esm/vs/editor/browser/editorDom.js","../node_modules/monaco-editor/esm/vs/editor/browser/editorExtensions.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/abstractCodeEditorService.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/bulkEditService.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/codeEditorService.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/editorWorkerService.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/markerDecorations.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/openerService.js","../node_modules/monaco-editor/esm/vs/editor/browser/services/webWorker.js","../node_modules/monaco-editor/esm/vs/editor/browser/stableEditorScroll.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as browser from '../../../base/browser/browser.js';\nimport { FastDomNode } from '../../../base/browser/fastDomNode.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../common/config/editorOptions.js';\nexport function applyFontInfo(domNode, fontInfo) {\n    if (domNode instanceof FastDomNode) {\n        domNode.setFontFamily(fontInfo.getMassagedFontFamily(browser.isSafari ? EDITOR_FONT_DEFAULTS.fontFamily : null));\n        domNode.setFontWeight(fontInfo.fontWeight);\n        domNode.setFontSize(fontInfo.fontSize);\n        domNode.setFontFeatureSettings(fontInfo.fontFeatureSettings);\n        domNode.setLineHeight(fontInfo.lineHeight);\n        domNode.setLetterSpacing(fontInfo.letterSpacing);\n    }\n    else {\n        domNode.style.fontFamily = fontInfo.getMassagedFontFamily(browser.isSafari ? EDITOR_FONT_DEFAULTS.fontFamily : null);\n        domNode.style.fontWeight = fontInfo.fontWeight;\n        domNode.style.fontSize = fontInfo.fontSize + 'px';\n        domNode.style.fontFeatureSettings = fontInfo.fontFeatureSettings;\n        domNode.style.lineHeight = fontInfo.lineHeight + 'px';\n        domNode.style.letterSpacing = fontInfo.letterSpacing + 'px';\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as browser from '../../../base/browser/browser.js';\nimport * as arrays from '../../../base/common/arrays.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport * as objects from '../../../base/common/objects.js';\nimport * as platform from '../../../base/common/platform.js';\nimport { ElementSizeObserver } from './elementSizeObserver.js';\nimport { FontMeasurements } from './fontMeasurements.js';\nimport { migrateOptions } from './migrateOptions.js';\nimport { TabFocus } from './tabFocus.js';\nimport { ComputeOptionsMemory, ConfigurationChangedEvent, editorOptionsRegistry } from '../../common/config/editorOptions.js';\nimport { EditorZoom } from '../../common/config/editorZoom.js';\nimport { BareFontInfo } from '../../common/config/fontInfo.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nlet EditorConfiguration = class EditorConfiguration extends Disposable {\n    constructor(isSimpleWidget, options, container, _accessibilityService) {\n        super();\n        this._accessibilityService = _accessibilityService;\n        this._onDidChange = this._register(new Emitter());\n        this.onDidChange = this._onDidChange.event;\n        this._onDidChangeFast = this._register(new Emitter());\n        this.onDidChangeFast = this._onDidChangeFast.event;\n        this._isDominatedByLongLines = false;\n        this._viewLineCount = 1;\n        this._lineNumbersDigitCount = 1;\n        this._reservedHeight = 0;\n        this._computeOptionsMemory = new ComputeOptionsMemory();\n        this.isSimpleWidget = isSimpleWidget;\n        this._containerObserver = this._register(new ElementSizeObserver(container, options.dimension));\n        this._rawOptions = deepCloneAndMigrateOptions(options);\n        this._validatedOptions = EditorOptionsUtil.validateOptions(this._rawOptions);\n        this.options = this._computeOptions();\n        if (this.options.get(10 /* automaticLayout */)) {\n            this._containerObserver.startObserving();\n        }\n        this._register(EditorZoom.onDidChangeZoomLevel(() => this._recomputeOptions()));\n        this._register(TabFocus.onDidChangeTabFocus(() => this._recomputeOptions()));\n        this._register(this._containerObserver.onDidChange(() => this._recomputeOptions()));\n        this._register(FontMeasurements.onDidChange(() => this._recomputeOptions()));\n        this._register(browser.PixelRatio.onDidChange(() => this._recomputeOptions()));\n        this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(() => this._recomputeOptions()));\n    }\n    _recomputeOptions() {\n        const newOptions = this._computeOptions();\n        const changeEvent = EditorOptionsUtil.checkEquals(this.options, newOptions);\n        if (changeEvent === null) {\n            // nothing changed!\n            return;\n        }\n        this.options = newOptions;\n        this._onDidChangeFast.fire(changeEvent);\n        this._onDidChange.fire(changeEvent);\n    }\n    _computeOptions() {\n        const partialEnv = this._readEnvConfiguration();\n        const bareFontInfo = BareFontInfo.createFromValidatedSettings(this._validatedOptions, partialEnv.pixelRatio, this.isSimpleWidget);\n        const fontInfo = this._readFontInfo(bareFontInfo);\n        const env = {\n            memory: this._computeOptionsMemory,\n            outerWidth: partialEnv.outerWidth,\n            outerHeight: partialEnv.outerHeight - this._reservedHeight,\n            fontInfo: fontInfo,\n            extraEditorClassName: partialEnv.extraEditorClassName,\n            isDominatedByLongLines: this._isDominatedByLongLines,\n            viewLineCount: this._viewLineCount,\n            lineNumbersDigitCount: this._lineNumbersDigitCount,\n            emptySelectionClipboard: partialEnv.emptySelectionClipboard,\n            pixelRatio: partialEnv.pixelRatio,\n            tabFocusMode: TabFocus.getTabFocusMode(),\n            accessibilitySupport: partialEnv.accessibilitySupport\n        };\n        return EditorOptionsUtil.computeOptions(this._validatedOptions, env);\n    }\n    _readEnvConfiguration() {\n        return {\n            extraEditorClassName: getExtraEditorClassName(),\n            outerWidth: this._containerObserver.getWidth(),\n            outerHeight: this._containerObserver.getHeight(),\n            emptySelectionClipboard: browser.isWebKit || browser.isFirefox,\n            pixelRatio: browser.PixelRatio.value,\n            accessibilitySupport: (this._accessibilityService.isScreenReaderOptimized()\n                ? 2 /* Enabled */\n                : this._accessibilityService.getAccessibilitySupport())\n        };\n    }\n    _readFontInfo(bareFontInfo) {\n        return FontMeasurements.readFontInfo(bareFontInfo);\n    }\n    getRawOptions() {\n        return this._rawOptions;\n    }\n    updateOptions(_newOptions) {\n        const newOptions = deepCloneAndMigrateOptions(_newOptions);\n        const didChange = EditorOptionsUtil.applyUpdate(this._rawOptions, newOptions);\n        if (!didChange) {\n            return;\n        }\n        this._validatedOptions = EditorOptionsUtil.validateOptions(this._rawOptions);\n        this._recomputeOptions();\n    }\n    observeContainer(dimension) {\n        this._containerObserver.observe(dimension);\n    }\n    setIsDominatedByLongLines(isDominatedByLongLines) {\n        if (this._isDominatedByLongLines === isDominatedByLongLines) {\n            return;\n        }\n        this._isDominatedByLongLines = isDominatedByLongLines;\n        this._recomputeOptions();\n    }\n    setModelLineCount(modelLineCount) {\n        const lineNumbersDigitCount = digitCount(modelLineCount);\n        if (this._lineNumbersDigitCount === lineNumbersDigitCount) {\n            return;\n        }\n        this._lineNumbersDigitCount = lineNumbersDigitCount;\n        this._recomputeOptions();\n    }\n    setViewLineCount(viewLineCount) {\n        if (this._viewLineCount === viewLineCount) {\n            return;\n        }\n        this._viewLineCount = viewLineCount;\n        this._recomputeOptions();\n    }\n    setReservedHeight(reservedHeight) {\n        if (this._reservedHeight === reservedHeight) {\n            return;\n        }\n        this._reservedHeight = reservedHeight;\n        this._recomputeOptions();\n    }\n};\nEditorConfiguration = __decorate([\n    __param(3, IAccessibilityService)\n], EditorConfiguration);\nexport { EditorConfiguration };\nfunction digitCount(n) {\n    let r = 0;\n    while (n) {\n        n = Math.floor(n / 10);\n        r++;\n    }\n    return r ? r : 1;\n}\nfunction getExtraEditorClassName() {\n    let extra = '';\n    if (!browser.isSafari && !browser.isWebkitWebView) {\n        // Use user-select: none in all browsers except Safari and native macOS WebView\n        extra += 'no-user-select ';\n    }\n    if (browser.isSafari) {\n        // See https://github.com/microsoft/vscode/issues/108822\n        extra += 'no-minimap-shadow ';\n    }\n    if (platform.isMacintosh) {\n        extra += 'mac ';\n    }\n    return extra;\n}\nclass ValidatedEditorOptions {\n    constructor() {\n        this._values = [];\n    }\n    _read(option) {\n        return this._values[option];\n    }\n    get(id) {\n        return this._values[id];\n    }\n    _write(option, value) {\n        this._values[option] = value;\n    }\n}\nexport class ComputedEditorOptions {\n    constructor() {\n        this._values = [];\n    }\n    _read(id) {\n        if (id >= this._values.length) {\n            throw new Error('Cannot read uninitialized value');\n        }\n        return this._values[id];\n    }\n    get(id) {\n        return this._read(id);\n    }\n    _write(id, value) {\n        this._values[id] = value;\n    }\n}\nclass EditorOptionsUtil {\n    static validateOptions(options) {\n        const result = new ValidatedEditorOptions();\n        for (const editorOption of editorOptionsRegistry) {\n            const value = (editorOption.name === '_never_' ? undefined : options[editorOption.name]);\n            result._write(editorOption.id, editorOption.validate(value));\n        }\n        return result;\n    }\n    static computeOptions(options, env) {\n        const result = new ComputedEditorOptions();\n        for (const editorOption of editorOptionsRegistry) {\n            result._write(editorOption.id, editorOption.compute(env, result, options._read(editorOption.id)));\n        }\n        return result;\n    }\n    static _deepEquals(a, b) {\n        if (typeof a !== 'object' || typeof b !== 'object' || !a || !b) {\n            return a === b;\n        }\n        if (Array.isArray(a) || Array.isArray(b)) {\n            return (Array.isArray(a) && Array.isArray(b) ? arrays.equals(a, b) : false);\n        }\n        if (Object.keys(a).length !== Object.keys(b).length) {\n            return false;\n        }\n        for (const key in a) {\n            if (!EditorOptionsUtil._deepEquals(a[key], b[key])) {\n                return false;\n            }\n        }\n        return true;\n    }\n    static checkEquals(a, b) {\n        const result = [];\n        let somethingChanged = false;\n        for (const editorOption of editorOptionsRegistry) {\n            const changed = !EditorOptionsUtil._deepEquals(a._read(editorOption.id), b._read(editorOption.id));\n            result[editorOption.id] = changed;\n            if (changed) {\n                somethingChanged = true;\n            }\n        }\n        return (somethingChanged ? new ConfigurationChangedEvent(result) : null);\n    }\n    /**\n     * Returns true if something changed.\n     * Modifies `options`.\n    */\n    static applyUpdate(options, update) {\n        let changed = false;\n        for (const editorOption of editorOptionsRegistry) {\n            if (update.hasOwnProperty(editorOption.name)) {\n                const result = editorOption.applyUpdate(options[editorOption.name], update[editorOption.name]);\n                options[editorOption.name] = result.newValue;\n                changed = changed || result.didChange;\n            }\n        }\n        return changed;\n    }\n}\nfunction deepCloneAndMigrateOptions(_options) {\n    const options = objects.deepClone(_options);\n    migrateOptions(options);\n    return options;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { forEach } from '../../../base/common/collections.js';\n/**\n * Compatibility with old options\n */\nexport function migrateOptions(options) {\n    const wordWrap = options.wordWrap;\n    if (wordWrap === true) {\n        options.wordWrap = 'on';\n    }\n    else if (wordWrap === false) {\n        options.wordWrap = 'off';\n    }\n    const lineNumbers = options.lineNumbers;\n    if (lineNumbers === true) {\n        options.lineNumbers = 'on';\n    }\n    else if (lineNumbers === false) {\n        options.lineNumbers = 'off';\n    }\n    const autoClosingBrackets = options.autoClosingBrackets;\n    if (autoClosingBrackets === false) {\n        options.autoClosingBrackets = 'never';\n        options.autoClosingQuotes = 'never';\n        options.autoSurround = 'never';\n    }\n    const cursorBlinking = options.cursorBlinking;\n    if (cursorBlinking === 'visible') {\n        options.cursorBlinking = 'solid';\n    }\n    const renderWhitespace = options.renderWhitespace;\n    if (renderWhitespace === true) {\n        options.renderWhitespace = 'boundary';\n    }\n    else if (renderWhitespace === false) {\n        options.renderWhitespace = 'none';\n    }\n    const renderLineHighlight = options.renderLineHighlight;\n    if (renderLineHighlight === true) {\n        options.renderLineHighlight = 'line';\n    }\n    else if (renderLineHighlight === false) {\n        options.renderLineHighlight = 'none';\n    }\n    const acceptSuggestionOnEnter = options.acceptSuggestionOnEnter;\n    if (acceptSuggestionOnEnter === true) {\n        options.acceptSuggestionOnEnter = 'on';\n    }\n    else if (acceptSuggestionOnEnter === false) {\n        options.acceptSuggestionOnEnter = 'off';\n    }\n    const tabCompletion = options.tabCompletion;\n    if (tabCompletion === false) {\n        options.tabCompletion = 'off';\n    }\n    else if (tabCompletion === true) {\n        options.tabCompletion = 'onlySnippets';\n    }\n    const suggest = options.suggest;\n    if (suggest && typeof suggest.filteredTypes === 'object' && suggest.filteredTypes) {\n        const mapping = {};\n        mapping['method'] = 'showMethods';\n        mapping['function'] = 'showFunctions';\n        mapping['constructor'] = 'showConstructors';\n        mapping['deprecated'] = 'showDeprecated';\n        mapping['field'] = 'showFields';\n        mapping['variable'] = 'showVariables';\n        mapping['class'] = 'showClasses';\n        mapping['struct'] = 'showStructs';\n        mapping['interface'] = 'showInterfaces';\n        mapping['module'] = 'showModules';\n        mapping['property'] = 'showProperties';\n        mapping['event'] = 'showEvents';\n        mapping['operator'] = 'showOperators';\n        mapping['unit'] = 'showUnits';\n        mapping['value'] = 'showValues';\n        mapping['constant'] = 'showConstants';\n        mapping['enum'] = 'showEnums';\n        mapping['enumMember'] = 'showEnumMembers';\n        mapping['keyword'] = 'showKeywords';\n        mapping['text'] = 'showWords';\n        mapping['color'] = 'showColors';\n        mapping['file'] = 'showFiles';\n        mapping['reference'] = 'showReferences';\n        mapping['folder'] = 'showFolders';\n        mapping['typeParameter'] = 'showTypeParameters';\n        mapping['snippet'] = 'showSnippets';\n        forEach(mapping, entry => {\n            const value = suggest.filteredTypes[entry.key];\n            if (value === false) {\n                suggest[entry.value] = value;\n            }\n        });\n        // delete (<any>suggest).filteredTypes;\n    }\n    const hover = options.hover;\n    if (hover === true) {\n        options.hover = {\n            enabled: true\n        };\n    }\n    else if (hover === false) {\n        options.hover = {\n            enabled: false\n        };\n    }\n    const parameterHints = options.parameterHints;\n    if (parameterHints === true) {\n        options.parameterHints = {\n            enabled: true\n        };\n    }\n    else if (parameterHints === false) {\n        options.parameterHints = {\n            enabled: false\n        };\n    }\n    const autoIndent = options.autoIndent;\n    if (autoIndent === true) {\n        options.autoIndent = 'full';\n    }\n    else if (autoIndent === false) {\n        options.autoIndent = 'advanced';\n    }\n    const matchBrackets = options.matchBrackets;\n    if (matchBrackets === true) {\n        options.matchBrackets = 'always';\n    }\n    else if (matchBrackets === false) {\n        options.matchBrackets = 'never';\n    }\n    const { renderIndentGuides, highlightActiveIndentGuide } = options;\n    if (!options.guides) {\n        options.guides = {};\n    }\n    if (renderIndentGuides !== undefined) {\n        options.guides.indentation = !!renderIndentGuides;\n    }\n    if (highlightActiveIndentGuide !== undefined) {\n        options.guides.highlightActiveIndentation = !!highlightActiveIndentGuide;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { Emitter } from '../../../base/common/event.js';\nexport class ElementSizeObserver extends Disposable {\n    constructor(referenceDomElement, dimension) {\n        super();\n        this._onDidChange = this._register(new Emitter());\n        this.onDidChange = this._onDidChange.event;\n        this._referenceDomElement = referenceDomElement;\n        this._width = -1;\n        this._height = -1;\n        this._resizeObserver = null;\n        this.measureReferenceDomElement(false, dimension);\n    }\n    dispose() {\n        this.stopObserving();\n        super.dispose();\n    }\n    getWidth() {\n        return this._width;\n    }\n    getHeight() {\n        return this._height;\n    }\n    startObserving() {\n        if (!this._resizeObserver && this._referenceDomElement) {\n            this._resizeObserver = new ResizeObserver((entries) => {\n                if (entries && entries[0] && entries[0].contentRect) {\n                    this.observe({ width: entries[0].contentRect.width, height: entries[0].contentRect.height });\n                }\n                else {\n                    this.observe();\n                }\n            });\n            this._resizeObserver.observe(this._referenceDomElement);\n        }\n    }\n    stopObserving() {\n        if (this._resizeObserver) {\n            this._resizeObserver.disconnect();\n            this._resizeObserver = null;\n        }\n    }\n    observe(dimension) {\n        this.measureReferenceDomElement(true, dimension);\n    }\n    measureReferenceDomElement(emitEvent, dimension) {\n        let observedWidth = 0;\n        let observedHeight = 0;\n        if (dimension) {\n            observedWidth = dimension.width;\n            observedHeight = dimension.height;\n        }\n        else if (this._referenceDomElement) {\n            observedWidth = this._referenceDomElement.clientWidth;\n            observedHeight = this._referenceDomElement.clientHeight;\n        }\n        observedWidth = Math.max(5, observedWidth);\n        observedHeight = Math.max(5, observedHeight);\n        if (this._width !== observedWidth || this._height !== observedHeight) {\n            this._width = observedWidth;\n            this._height = observedHeight;\n            if (emitEvent) {\n                this._onDidChange.fire();\n            }\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { applyFontInfo } from './domFontInfo.js';\nexport class CharWidthRequest {\n    constructor(chr, type) {\n        this.chr = chr;\n        this.type = type;\n        this.width = 0;\n    }\n    fulfill(width) {\n        this.width = width;\n    }\n}\nclass DomCharWidthReader {\n    constructor(bareFontInfo, requests) {\n        this._bareFontInfo = bareFontInfo;\n        this._requests = requests;\n        this._container = null;\n        this._testElements = null;\n    }\n    read() {\n        // Create a test container with all these test elements\n        this._createDomElements();\n        // Add the container to the DOM\n        document.body.appendChild(this._container);\n        // Read character widths\n        this._readFromDomElements();\n        // Remove the container from the DOM\n        document.body.removeChild(this._container);\n        this._container = null;\n        this._testElements = null;\n    }\n    _createDomElements() {\n        const container = document.createElement('div');\n        container.style.position = 'absolute';\n        container.style.top = '-50000px';\n        container.style.width = '50000px';\n        const regularDomNode = document.createElement('div');\n        applyFontInfo(regularDomNode, this._bareFontInfo);\n        container.appendChild(regularDomNode);\n        const boldDomNode = document.createElement('div');\n        applyFontInfo(boldDomNode, this._bareFontInfo);\n        boldDomNode.style.fontWeight = 'bold';\n        container.appendChild(boldDomNode);\n        const italicDomNode = document.createElement('div');\n        applyFontInfo(italicDomNode, this._bareFontInfo);\n        italicDomNode.style.fontStyle = 'italic';\n        container.appendChild(italicDomNode);\n        const testElements = [];\n        for (const request of this._requests) {\n            let parent;\n            if (request.type === 0 /* Regular */) {\n                parent = regularDomNode;\n            }\n            if (request.type === 2 /* Bold */) {\n                parent = boldDomNode;\n            }\n            if (request.type === 1 /* Italic */) {\n                parent = italicDomNode;\n            }\n            parent.appendChild(document.createElement('br'));\n            const testElement = document.createElement('span');\n            DomCharWidthReader._render(testElement, request);\n            parent.appendChild(testElement);\n            testElements.push(testElement);\n        }\n        this._container = container;\n        this._testElements = testElements;\n    }\n    static _render(testElement, request) {\n        if (request.chr === ' ') {\n            let htmlString = '\\u00a0';\n            // Repeat character 256 (2^8) times\n            for (let i = 0; i < 8; i++) {\n                htmlString += htmlString;\n            }\n            testElement.innerText = htmlString;\n        }\n        else {\n            let testString = request.chr;\n            // Repeat character 256 (2^8) times\n            for (let i = 0; i < 8; i++) {\n                testString += testString;\n            }\n            testElement.textContent = testString;\n        }\n    }\n    _readFromDomElements() {\n        for (let i = 0, len = this._requests.length; i < len; i++) {\n            const request = this._requests[i];\n            const testElement = this._testElements[i];\n            request.fulfill(testElement.offsetWidth / 256);\n        }\n    }\n}\nexport function readCharWidths(bareFontInfo, requests) {\n    const reader = new DomCharWidthReader(bareFontInfo, requests);\n    reader.read();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as browser from '../../../base/browser/browser.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { CharWidthRequest, readCharWidths } from './charWidthReader.js';\nimport { EditorFontLigatures } from '../../common/config/editorOptions.js';\nimport { FontInfo } from '../../common/config/fontInfo.js';\nclass FontMeasurementsImpl extends Disposable {\n    constructor() {\n        super();\n        this._onDidChange = this._register(new Emitter());\n        this.onDidChange = this._onDidChange.event;\n        this._cache = new FontMeasurementsCache();\n        this._evictUntrustedReadingsTimeout = -1;\n    }\n    dispose() {\n        if (this._evictUntrustedReadingsTimeout !== -1) {\n            window.clearTimeout(this._evictUntrustedReadingsTimeout);\n            this._evictUntrustedReadingsTimeout = -1;\n        }\n        super.dispose();\n    }\n    /**\n     * Clear all cached font information and trigger a change event.\n     */\n    clearAllFontInfos() {\n        this._cache = new FontMeasurementsCache();\n        this._onDidChange.fire();\n    }\n    _writeToCache(item, value) {\n        this._cache.put(item, value);\n        if (!value.isTrusted && this._evictUntrustedReadingsTimeout === -1) {\n            // Try reading again after some time\n            this._evictUntrustedReadingsTimeout = window.setTimeout(() => {\n                this._evictUntrustedReadingsTimeout = -1;\n                this._evictUntrustedReadings();\n            }, 5000);\n        }\n    }\n    _evictUntrustedReadings() {\n        const values = this._cache.getValues();\n        let somethingRemoved = false;\n        for (const item of values) {\n            if (!item.isTrusted) {\n                somethingRemoved = true;\n                this._cache.remove(item);\n            }\n        }\n        if (somethingRemoved) {\n            this._onDidChange.fire();\n        }\n    }\n    /**\n     * Read font information.\n     */\n    readFontInfo(bareFontInfo) {\n        if (!this._cache.has(bareFontInfo)) {\n            let readConfig = this._actualReadFontInfo(bareFontInfo);\n            if (readConfig.typicalHalfwidthCharacterWidth <= 2 || readConfig.typicalFullwidthCharacterWidth <= 2 || readConfig.spaceWidth <= 2 || readConfig.maxDigitWidth <= 2) {\n                // Hey, it's Bug 14341 ... we couldn't read\n                readConfig = new FontInfo({\n                    pixelRatio: browser.PixelRatio.value,\n                    fontFamily: readConfig.fontFamily,\n                    fontWeight: readConfig.fontWeight,\n                    fontSize: readConfig.fontSize,\n                    fontFeatureSettings: readConfig.fontFeatureSettings,\n                    lineHeight: readConfig.lineHeight,\n                    letterSpacing: readConfig.letterSpacing,\n                    isMonospace: readConfig.isMonospace,\n                    typicalHalfwidthCharacterWidth: Math.max(readConfig.typicalHalfwidthCharacterWidth, 5),\n                    typicalFullwidthCharacterWidth: Math.max(readConfig.typicalFullwidthCharacterWidth, 5),\n                    canUseHalfwidthRightwardsArrow: readConfig.canUseHalfwidthRightwardsArrow,\n                    spaceWidth: Math.max(readConfig.spaceWidth, 5),\n                    middotWidth: Math.max(readConfig.middotWidth, 5),\n                    wsmiddotWidth: Math.max(readConfig.wsmiddotWidth, 5),\n                    maxDigitWidth: Math.max(readConfig.maxDigitWidth, 5),\n                }, false);\n            }\n            this._writeToCache(bareFontInfo, readConfig);\n        }\n        return this._cache.get(bareFontInfo);\n    }\n    _createRequest(chr, type, all, monospace) {\n        const result = new CharWidthRequest(chr, type);\n        all.push(result);\n        if (monospace) {\n            monospace.push(result);\n        }\n        return result;\n    }\n    _actualReadFontInfo(bareFontInfo) {\n        const all = [];\n        const monospace = [];\n        const typicalHalfwidthCharacter = this._createRequest('n', 0 /* Regular */, all, monospace);\n        const typicalFullwidthCharacter = this._createRequest('\\uff4d', 0 /* Regular */, all, null);\n        const space = this._createRequest(' ', 0 /* Regular */, all, monospace);\n        const digit0 = this._createRequest('0', 0 /* Regular */, all, monospace);\n        const digit1 = this._createRequest('1', 0 /* Regular */, all, monospace);\n        const digit2 = this._createRequest('2', 0 /* Regular */, all, monospace);\n        const digit3 = this._createRequest('3', 0 /* Regular */, all, monospace);\n        const digit4 = this._createRequest('4', 0 /* Regular */, all, monospace);\n        const digit5 = this._createRequest('5', 0 /* Regular */, all, monospace);\n        const digit6 = this._createRequest('6', 0 /* Regular */, all, monospace);\n        const digit7 = this._createRequest('7', 0 /* Regular */, all, monospace);\n        const digit8 = this._createRequest('8', 0 /* Regular */, all, monospace);\n        const digit9 = this._createRequest('9', 0 /* Regular */, all, monospace);\n        // monospace test: used for whitespace rendering\n        const rightwardsArrow = this._createRequest('→', 0 /* Regular */, all, monospace);\n        const halfwidthRightwardsArrow = this._createRequest('￫', 0 /* Regular */, all, null);\n        // U+00B7 - MIDDLE DOT\n        const middot = this._createRequest('·', 0 /* Regular */, all, monospace);\n        // U+2E31 - WORD SEPARATOR MIDDLE DOT\n        const wsmiddotWidth = this._createRequest(String.fromCharCode(0x2E31), 0 /* Regular */, all, null);\n        // monospace test: some characters\n        const monospaceTestChars = '|/-_ilm%';\n        for (let i = 0, len = monospaceTestChars.length; i < len; i++) {\n            this._createRequest(monospaceTestChars.charAt(i), 0 /* Regular */, all, monospace);\n            this._createRequest(monospaceTestChars.charAt(i), 1 /* Italic */, all, monospace);\n            this._createRequest(monospaceTestChars.charAt(i), 2 /* Bold */, all, monospace);\n        }\n        readCharWidths(bareFontInfo, all);\n        const maxDigitWidth = Math.max(digit0.width, digit1.width, digit2.width, digit3.width, digit4.width, digit5.width, digit6.width, digit7.width, digit8.width, digit9.width);\n        let isMonospace = (bareFontInfo.fontFeatureSettings === EditorFontLigatures.OFF);\n        const referenceWidth = monospace[0].width;\n        for (let i = 1, len = monospace.length; isMonospace && i < len; i++) {\n            const diff = referenceWidth - monospace[i].width;\n            if (diff < -0.001 || diff > 0.001) {\n                isMonospace = false;\n                break;\n            }\n        }\n        let canUseHalfwidthRightwardsArrow = true;\n        if (isMonospace && halfwidthRightwardsArrow.width !== referenceWidth) {\n            // using a halfwidth rightwards arrow would break monospace...\n            canUseHalfwidthRightwardsArrow = false;\n        }\n        if (halfwidthRightwardsArrow.width > rightwardsArrow.width) {\n            // using a halfwidth rightwards arrow would paint a larger arrow than a regular rightwards arrow\n            canUseHalfwidthRightwardsArrow = false;\n        }\n        return new FontInfo({\n            pixelRatio: browser.PixelRatio.value,\n            fontFamily: bareFontInfo.fontFamily,\n            fontWeight: bareFontInfo.fontWeight,\n            fontSize: bareFontInfo.fontSize,\n            fontFeatureSettings: bareFontInfo.fontFeatureSettings,\n            lineHeight: bareFontInfo.lineHeight,\n            letterSpacing: bareFontInfo.letterSpacing,\n            isMonospace: isMonospace,\n            typicalHalfwidthCharacterWidth: typicalHalfwidthCharacter.width,\n            typicalFullwidthCharacterWidth: typicalFullwidthCharacter.width,\n            canUseHalfwidthRightwardsArrow: canUseHalfwidthRightwardsArrow,\n            spaceWidth: space.width,\n            middotWidth: middot.width,\n            wsmiddotWidth: wsmiddotWidth.width,\n            maxDigitWidth: maxDigitWidth\n        }, true);\n    }\n}\nclass FontMeasurementsCache {\n    constructor() {\n        this._keys = Object.create(null);\n        this._values = Object.create(null);\n    }\n    has(item) {\n        const itemId = item.getId();\n        return !!this._values[itemId];\n    }\n    get(item) {\n        const itemId = item.getId();\n        return this._values[itemId];\n    }\n    put(item, value) {\n        const itemId = item.getId();\n        this._keys[itemId] = item;\n        this._values[itemId] = value;\n    }\n    remove(item) {\n        const itemId = item.getId();\n        delete this._keys[itemId];\n        delete this._values[itemId];\n    }\n    getValues() {\n        return Object.keys(this._keys).map(id => this._values[id]);\n    }\n}\nexport const FontMeasurements = new FontMeasurementsImpl();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../base/common/event.js';\nclass TabFocusImpl {\n    constructor() {\n        this._tabFocus = false;\n        this._onDidChangeTabFocus = new Emitter();\n        this.onDidChangeTabFocus = this._onDidChangeTabFocus.event;\n    }\n    getTabFocusMode() {\n        return this._tabFocus;\n    }\n    setTabFocusMode(tabFocusMode) {\n        if (this._tabFocus === tabFocusMode) {\n            return;\n        }\n        this._tabFocus = tabFocusMode;\n        this._onDidChangeTabFocus.fire(this._tabFocus);\n    }\n}\n/**\n * Control what pressing Tab does.\n * If it is false, pressing Tab or Shift-Tab will be handled by the editor.\n * If it is true, pressing Tab or Shift-Tab will move the browser focus.\n * Defaults to false.\n */\nexport const TabFocus = new TabFocusImpl();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { PageCoordinates } from '../editorDom.js';\nimport { PartFingerprints } from '../view/viewPart.js';\nimport { ViewLine } from '../viewParts/lines/viewLine.js';\nimport { Position } from '../../common/core/position.js';\nimport { Range as EditorRange } from '../../common/core/range.js';\nimport { CursorColumns } from '../../common/core/cursorColumns.js';\nimport * as dom from '../../../base/browser/dom.js';\nimport { AtomicTabMoveOperations } from '../../common/cursor/cursorAtomicMoveOperations.js';\nclass UnknownHitTestResult {\n    constructor(hitTarget = null) {\n        this.hitTarget = hitTarget;\n        this.type = 0 /* Unknown */;\n    }\n}\nclass ContentHitTestResult {\n    constructor(position, spanNode, injectedText) {\n        this.position = position;\n        this.spanNode = spanNode;\n        this.injectedText = injectedText;\n        this.type = 1 /* Content */;\n    }\n}\nvar HitTestResult;\n(function (HitTestResult) {\n    function createFromDOMInfo(ctx, spanNode, offset) {\n        const position = ctx.getPositionFromDOMInfo(spanNode, offset);\n        if (position) {\n            return new ContentHitTestResult(position, spanNode, null);\n        }\n        return new UnknownHitTestResult(spanNode);\n    }\n    HitTestResult.createFromDOMInfo = createFromDOMInfo;\n})(HitTestResult || (HitTestResult = {}));\nexport class PointerHandlerLastRenderData {\n    constructor(lastViewCursorsRenderData, lastTextareaPosition) {\n        this.lastViewCursorsRenderData = lastViewCursorsRenderData;\n        this.lastTextareaPosition = lastTextareaPosition;\n    }\n}\nexport class MouseTarget {\n    static _deduceRage(position, range = null) {\n        if (!range && position) {\n            return new EditorRange(position.lineNumber, position.column, position.lineNumber, position.column);\n        }\n        return range !== null && range !== void 0 ? range : null;\n    }\n    static createUnknown(element, mouseColumn, position) {\n        return { type: 0 /* UNKNOWN */, element, mouseColumn, position, range: this._deduceRage(position) };\n    }\n    static createTextarea(element, mouseColumn) {\n        return { type: 1 /* TEXTAREA */, element, mouseColumn, position: null, range: null };\n    }\n    static createMargin(type, element, mouseColumn, position, range, detail) {\n        return { type, element, mouseColumn, position, range, detail };\n    }\n    static createViewZone(type, element, mouseColumn, position, detail) {\n        return { type, element, mouseColumn, position, range: this._deduceRage(position), detail };\n    }\n    static createContentText(element, mouseColumn, position, range, detail) {\n        return { type: 6 /* CONTENT_TEXT */, element, mouseColumn, position, range: this._deduceRage(position, range), detail };\n    }\n    static createContentEmpty(element, mouseColumn, position, detail) {\n        return { type: 7 /* CONTENT_EMPTY */, element, mouseColumn, position, range: this._deduceRage(position), detail };\n    }\n    static createContentWidget(element, mouseColumn, detail) {\n        return { type: 9 /* CONTENT_WIDGET */, element, mouseColumn, position: null, range: null, detail };\n    }\n    static createScrollbar(element, mouseColumn, position) {\n        return { type: 11 /* SCROLLBAR */, element, mouseColumn, position, range: this._deduceRage(position) };\n    }\n    static createOverlayWidget(element, mouseColumn, detail) {\n        return { type: 12 /* OVERLAY_WIDGET */, element, mouseColumn, position: null, range: null, detail };\n    }\n    static createOutsideEditor(mouseColumn, position) {\n        return { type: 13 /* OUTSIDE_EDITOR */, element: null, mouseColumn, position, range: this._deduceRage(position) };\n    }\n    static _typeToString(type) {\n        if (type === 1 /* TEXTAREA */) {\n            return 'TEXTAREA';\n        }\n        if (type === 2 /* GUTTER_GLYPH_MARGIN */) {\n            return 'GUTTER_GLYPH_MARGIN';\n        }\n        if (type === 3 /* GUTTER_LINE_NUMBERS */) {\n            return 'GUTTER_LINE_NUMBERS';\n        }\n        if (type === 4 /* GUTTER_LINE_DECORATIONS */) {\n            return 'GUTTER_LINE_DECORATIONS';\n        }\n        if (type === 5 /* GUTTER_VIEW_ZONE */) {\n            return 'GUTTER_VIEW_ZONE';\n        }\n        if (type === 6 /* CONTENT_TEXT */) {\n            return 'CONTENT_TEXT';\n        }\n        if (type === 7 /* CONTENT_EMPTY */) {\n            return 'CONTENT_EMPTY';\n        }\n        if (type === 8 /* CONTENT_VIEW_ZONE */) {\n            return 'CONTENT_VIEW_ZONE';\n        }\n        if (type === 9 /* CONTENT_WIDGET */) {\n            return 'CONTENT_WIDGET';\n        }\n        if (type === 10 /* OVERVIEW_RULER */) {\n            return 'OVERVIEW_RULER';\n        }\n        if (type === 11 /* SCROLLBAR */) {\n            return 'SCROLLBAR';\n        }\n        if (type === 12 /* OVERLAY_WIDGET */) {\n            return 'OVERLAY_WIDGET';\n        }\n        return 'UNKNOWN';\n    }\n    static toString(target) {\n        return this._typeToString(target.type) + ': ' + target.position + ' - ' + target.range + ' - ' + JSON.stringify(target.detail);\n    }\n}\nclass ElementPath {\n    static isTextArea(path) {\n        return (path.length === 2\n            && path[0] === 3 /* OverflowGuard */\n            && path[1] === 6 /* TextArea */);\n    }\n    static isChildOfViewLines(path) {\n        return (path.length >= 4\n            && path[0] === 3 /* OverflowGuard */\n            && path[3] === 7 /* ViewLines */);\n    }\n    static isStrictChildOfViewLines(path) {\n        return (path.length > 4\n            && path[0] === 3 /* OverflowGuard */\n            && path[3] === 7 /* ViewLines */);\n    }\n    static isChildOfScrollableElement(path) {\n        return (path.length >= 2\n            && path[0] === 3 /* OverflowGuard */\n            && path[1] === 5 /* ScrollableElement */);\n    }\n    static isChildOfMinimap(path) {\n        return (path.length >= 2\n            && path[0] === 3 /* OverflowGuard */\n            && path[1] === 8 /* Minimap */);\n    }\n    static isChildOfContentWidgets(path) {\n        return (path.length >= 4\n            && path[0] === 3 /* OverflowGuard */\n            && path[3] === 1 /* ContentWidgets */);\n    }\n    static isChildOfOverflowingContentWidgets(path) {\n        return (path.length >= 1\n            && path[0] === 2 /* OverflowingContentWidgets */);\n    }\n    static isChildOfOverlayWidgets(path) {\n        return (path.length >= 2\n            && path[0] === 3 /* OverflowGuard */\n            && path[1] === 4 /* OverlayWidgets */);\n    }\n}\nexport class HitTestContext {\n    constructor(context, viewHelper, lastRenderData) {\n        this.viewModel = context.viewModel;\n        const options = context.configuration.options;\n        this.layoutInfo = options.get(131 /* layoutInfo */);\n        this.viewDomNode = viewHelper.viewDomNode;\n        this.lineHeight = options.get(59 /* lineHeight */);\n        this.stickyTabStops = options.get(104 /* stickyTabStops */);\n        this.typicalHalfwidthCharacterWidth = options.get(44 /* fontInfo */).typicalHalfwidthCharacterWidth;\n        this.lastRenderData = lastRenderData;\n        this._context = context;\n        this._viewHelper = viewHelper;\n    }\n    getZoneAtCoord(mouseVerticalOffset) {\n        return HitTestContext.getZoneAtCoord(this._context, mouseVerticalOffset);\n    }\n    static getZoneAtCoord(context, mouseVerticalOffset) {\n        // The target is either a view zone or the empty space after the last view-line\n        const viewZoneWhitespace = context.viewLayout.getWhitespaceAtVerticalOffset(mouseVerticalOffset);\n        if (viewZoneWhitespace) {\n            const viewZoneMiddle = viewZoneWhitespace.verticalOffset + viewZoneWhitespace.height / 2;\n            const lineCount = context.viewModel.getLineCount();\n            let positionBefore = null;\n            let position;\n            let positionAfter = null;\n            if (viewZoneWhitespace.afterLineNumber !== lineCount) {\n                // There are more lines after this view zone\n                positionAfter = new Position(viewZoneWhitespace.afterLineNumber + 1, 1);\n            }\n            if (viewZoneWhitespace.afterLineNumber > 0) {\n                // There are more lines above this view zone\n                positionBefore = new Position(viewZoneWhitespace.afterLineNumber, context.viewModel.getLineMaxColumn(viewZoneWhitespace.afterLineNumber));\n            }\n            if (positionAfter === null) {\n                position = positionBefore;\n            }\n            else if (positionBefore === null) {\n                position = positionAfter;\n            }\n            else if (mouseVerticalOffset < viewZoneMiddle) {\n                position = positionBefore;\n            }\n            else {\n                position = positionAfter;\n            }\n            return {\n                viewZoneId: viewZoneWhitespace.id,\n                afterLineNumber: viewZoneWhitespace.afterLineNumber,\n                positionBefore: positionBefore,\n                positionAfter: positionAfter,\n                position: position\n            };\n        }\n        return null;\n    }\n    getFullLineRangeAtCoord(mouseVerticalOffset) {\n        if (this._context.viewLayout.isAfterLines(mouseVerticalOffset)) {\n            // Below the last line\n            const lineNumber = this._context.viewModel.getLineCount();\n            const maxLineColumn = this._context.viewModel.getLineMaxColumn(lineNumber);\n            return {\n                range: new EditorRange(lineNumber, maxLineColumn, lineNumber, maxLineColumn),\n                isAfterLines: true\n            };\n        }\n        const lineNumber = this._context.viewLayout.getLineNumberAtVerticalOffset(mouseVerticalOffset);\n        const maxLineColumn = this._context.viewModel.getLineMaxColumn(lineNumber);\n        return {\n            range: new EditorRange(lineNumber, 1, lineNumber, maxLineColumn),\n            isAfterLines: false\n        };\n    }\n    getLineNumberAtVerticalOffset(mouseVerticalOffset) {\n        return this._context.viewLayout.getLineNumberAtVerticalOffset(mouseVerticalOffset);\n    }\n    isAfterLines(mouseVerticalOffset) {\n        return this._context.viewLayout.isAfterLines(mouseVerticalOffset);\n    }\n    isInTopPadding(mouseVerticalOffset) {\n        return this._context.viewLayout.isInTopPadding(mouseVerticalOffset);\n    }\n    isInBottomPadding(mouseVerticalOffset) {\n        return this._context.viewLayout.isInBottomPadding(mouseVerticalOffset);\n    }\n    getVerticalOffsetForLineNumber(lineNumber) {\n        return this._context.viewLayout.getVerticalOffsetForLineNumber(lineNumber);\n    }\n    findAttribute(element, attr) {\n        return HitTestContext._findAttribute(element, attr, this._viewHelper.viewDomNode);\n    }\n    static _findAttribute(element, attr, stopAt) {\n        while (element && element !== document.body) {\n            if (element.hasAttribute && element.hasAttribute(attr)) {\n                return element.getAttribute(attr);\n            }\n            if (element === stopAt) {\n                return null;\n            }\n            element = element.parentNode;\n        }\n        return null;\n    }\n    getLineWidth(lineNumber) {\n        return this._viewHelper.getLineWidth(lineNumber);\n    }\n    visibleRangeForPosition(lineNumber, column) {\n        return this._viewHelper.visibleRangeForPosition(lineNumber, column);\n    }\n    getPositionFromDOMInfo(spanNode, offset) {\n        return this._viewHelper.getPositionFromDOMInfo(spanNode, offset);\n    }\n    getCurrentScrollTop() {\n        return this._context.viewLayout.getCurrentScrollTop();\n    }\n    getCurrentScrollLeft() {\n        return this._context.viewLayout.getCurrentScrollLeft();\n    }\n}\nclass BareHitTestRequest {\n    constructor(ctx, editorPos, pos, relativePos) {\n        this.editorPos = editorPos;\n        this.pos = pos;\n        this.relativePos = relativePos;\n        this.mouseVerticalOffset = Math.max(0, ctx.getCurrentScrollTop() + this.relativePos.y);\n        this.mouseContentHorizontalOffset = ctx.getCurrentScrollLeft() + this.relativePos.x - ctx.layoutInfo.contentLeft;\n        this.isInMarginArea = (this.relativePos.x < ctx.layoutInfo.contentLeft && this.relativePos.x >= ctx.layoutInfo.glyphMarginLeft);\n        this.isInContentArea = !this.isInMarginArea;\n        this.mouseColumn = Math.max(0, MouseTargetFactory._getMouseColumn(this.mouseContentHorizontalOffset, ctx.typicalHalfwidthCharacterWidth));\n    }\n}\nclass HitTestRequest extends BareHitTestRequest {\n    constructor(ctx, editorPos, pos, relativePos, target) {\n        super(ctx, editorPos, pos, relativePos);\n        this._ctx = ctx;\n        if (target) {\n            this.target = target;\n            this.targetPath = PartFingerprints.collect(target, ctx.viewDomNode);\n        }\n        else {\n            this.target = null;\n            this.targetPath = new Uint8Array(0);\n        }\n    }\n    toString() {\n        return `pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}\\n\\ttarget: ${this.target ? this.target.outerHTML : null}`;\n    }\n    _getMouseColumn(position = null) {\n        if (position && position.column < this._ctx.viewModel.getLineMaxColumn(position.lineNumber)) {\n            // Most likely, the line contains foreign decorations...\n            return CursorColumns.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(position.lineNumber), position.column, this._ctx.viewModel.model.getOptions().tabSize) + 1;\n        }\n        return this.mouseColumn;\n    }\n    fulfillUnknown(position = null) {\n        return MouseTarget.createUnknown(this.target, this._getMouseColumn(position), position);\n    }\n    fulfillTextarea() {\n        return MouseTarget.createTextarea(this.target, this._getMouseColumn());\n    }\n    fulfillMargin(type, position, range, detail) {\n        return MouseTarget.createMargin(type, this.target, this._getMouseColumn(position), position, range, detail);\n    }\n    fulfillViewZone(type, position, detail) {\n        return MouseTarget.createViewZone(type, this.target, this._getMouseColumn(position), position, detail);\n    }\n    fulfillContentText(position, range, detail) {\n        return MouseTarget.createContentText(this.target, this._getMouseColumn(position), position, range, detail);\n    }\n    fulfillContentEmpty(position, detail) {\n        return MouseTarget.createContentEmpty(this.target, this._getMouseColumn(position), position, detail);\n    }\n    fulfillContentWidget(detail) {\n        return MouseTarget.createContentWidget(this.target, this._getMouseColumn(), detail);\n    }\n    fulfillScrollbar(position) {\n        return MouseTarget.createScrollbar(this.target, this._getMouseColumn(position), position);\n    }\n    fulfillOverlayWidget(detail) {\n        return MouseTarget.createOverlayWidget(this.target, this._getMouseColumn(), detail);\n    }\n    withTarget(target) {\n        return new HitTestRequest(this._ctx, this.editorPos, this.pos, this.relativePos, target);\n    }\n}\nconst EMPTY_CONTENT_AFTER_LINES = { isAfterLines: true };\nfunction createEmptyContentDataInLines(horizontalDistanceToText) {\n    return {\n        isAfterLines: false,\n        horizontalDistanceToText: horizontalDistanceToText\n    };\n}\nexport class MouseTargetFactory {\n    constructor(context, viewHelper) {\n        this._context = context;\n        this._viewHelper = viewHelper;\n    }\n    mouseTargetIsWidget(e) {\n        const t = e.target;\n        const path = PartFingerprints.collect(t, this._viewHelper.viewDomNode);\n        // Is it a content widget?\n        if (ElementPath.isChildOfContentWidgets(path) || ElementPath.isChildOfOverflowingContentWidgets(path)) {\n            return true;\n        }\n        // Is it an overlay widget?\n        if (ElementPath.isChildOfOverlayWidgets(path)) {\n            return true;\n        }\n        return false;\n    }\n    createMouseTarget(lastRenderData, editorPos, pos, relativePos, target) {\n        const ctx = new HitTestContext(this._context, this._viewHelper, lastRenderData);\n        const request = new HitTestRequest(ctx, editorPos, pos, relativePos, target);\n        try {\n            const r = MouseTargetFactory._createMouseTarget(ctx, request, false);\n            // console.log(MouseTarget.toString(r));\n            return r;\n        }\n        catch (err) {\n            // console.log(err);\n            return request.fulfillUnknown();\n        }\n    }\n    static _createMouseTarget(ctx, request, domHitTestExecuted) {\n        // console.log(`${domHitTestExecuted ? '=>' : ''}CAME IN REQUEST: ${request}`);\n        // First ensure the request has a target\n        if (request.target === null) {\n            if (domHitTestExecuted) {\n                // Still no target... and we have already executed hit test...\n                return request.fulfillUnknown();\n            }\n            const hitTestResult = MouseTargetFactory._doHitTest(ctx, request);\n            if (hitTestResult.type === 1 /* Content */) {\n                return MouseTargetFactory.createMouseTargetFromHitTestPosition(ctx, request, hitTestResult.spanNode, hitTestResult.position, hitTestResult.injectedText);\n            }\n            return this._createMouseTarget(ctx, request.withTarget(hitTestResult.hitTarget), true);\n        }\n        // we know for a fact that request.target is not null\n        const resolvedRequest = request;\n        let result = null;\n        result = result || MouseTargetFactory._hitTestContentWidget(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestOverlayWidget(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestMinimap(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestScrollbarSlider(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestViewZone(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestMargin(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestViewCursor(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestTextArea(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestViewLines(ctx, resolvedRequest, domHitTestExecuted);\n        result = result || MouseTargetFactory._hitTestScrollbar(ctx, resolvedRequest);\n        return (result || request.fulfillUnknown());\n    }\n    static _hitTestContentWidget(ctx, request) {\n        // Is it a content widget?\n        if (ElementPath.isChildOfContentWidgets(request.targetPath) || ElementPath.isChildOfOverflowingContentWidgets(request.targetPath)) {\n            const widgetId = ctx.findAttribute(request.target, 'widgetId');\n            if (widgetId) {\n                return request.fulfillContentWidget(widgetId);\n            }\n            else {\n                return request.fulfillUnknown();\n            }\n        }\n        return null;\n    }\n    static _hitTestOverlayWidget(ctx, request) {\n        // Is it an overlay widget?\n        if (ElementPath.isChildOfOverlayWidgets(request.targetPath)) {\n            const widgetId = ctx.findAttribute(request.target, 'widgetId');\n            if (widgetId) {\n                return request.fulfillOverlayWidget(widgetId);\n            }\n            else {\n                return request.fulfillUnknown();\n            }\n        }\n        return null;\n    }\n    static _hitTestViewCursor(ctx, request) {\n        if (request.target) {\n            // Check if we've hit a painted cursor\n            const lastViewCursorsRenderData = ctx.lastRenderData.lastViewCursorsRenderData;\n            for (const d of lastViewCursorsRenderData) {\n                if (request.target === d.domNode) {\n                    return request.fulfillContentText(d.position, null, { mightBeForeignElement: false, injectedText: null });\n                }\n            }\n        }\n        if (request.isInContentArea) {\n            // Edge has a bug when hit-testing the exact position of a cursor,\n            // instead of returning the correct dom node, it returns the\n            // first or last rendered view line dom node, therefore help it out\n            // and first check if we are on top of a cursor\n            const lastViewCursorsRenderData = ctx.lastRenderData.lastViewCursorsRenderData;\n            const mouseContentHorizontalOffset = request.mouseContentHorizontalOffset;\n            const mouseVerticalOffset = request.mouseVerticalOffset;\n            for (const d of lastViewCursorsRenderData) {\n                if (mouseContentHorizontalOffset < d.contentLeft) {\n                    // mouse position is to the left of the cursor\n                    continue;\n                }\n                if (mouseContentHorizontalOffset > d.contentLeft + d.width) {\n                    // mouse position is to the right of the cursor\n                    continue;\n                }\n                const cursorVerticalOffset = ctx.getVerticalOffsetForLineNumber(d.position.lineNumber);\n                if (cursorVerticalOffset <= mouseVerticalOffset\n                    && mouseVerticalOffset <= cursorVerticalOffset + d.height) {\n                    return request.fulfillContentText(d.position, null, { mightBeForeignElement: false, injectedText: null });\n                }\n            }\n        }\n        return null;\n    }\n    static _hitTestViewZone(ctx, request) {\n        const viewZoneData = ctx.getZoneAtCoord(request.mouseVerticalOffset);\n        if (viewZoneData) {\n            const mouseTargetType = (request.isInContentArea ? 8 /* CONTENT_VIEW_ZONE */ : 5 /* GUTTER_VIEW_ZONE */);\n            return request.fulfillViewZone(mouseTargetType, viewZoneData.position, viewZoneData);\n        }\n        return null;\n    }\n    static _hitTestTextArea(ctx, request) {\n        // Is it the textarea?\n        if (ElementPath.isTextArea(request.targetPath)) {\n            if (ctx.lastRenderData.lastTextareaPosition) {\n                return request.fulfillContentText(ctx.lastRenderData.lastTextareaPosition, null, { mightBeForeignElement: false, injectedText: null });\n            }\n            return request.fulfillTextarea();\n        }\n        return null;\n    }\n    static _hitTestMargin(ctx, request) {\n        if (request.isInMarginArea) {\n            const res = ctx.getFullLineRangeAtCoord(request.mouseVerticalOffset);\n            const pos = res.range.getStartPosition();\n            let offset = Math.abs(request.relativePos.x);\n            const detail = {\n                isAfterLines: res.isAfterLines,\n                glyphMarginLeft: ctx.layoutInfo.glyphMarginLeft,\n                glyphMarginWidth: ctx.layoutInfo.glyphMarginWidth,\n                lineNumbersWidth: ctx.layoutInfo.lineNumbersWidth,\n                offsetX: offset\n            };\n            offset -= ctx.layoutInfo.glyphMarginLeft;\n            if (offset <= ctx.layoutInfo.glyphMarginWidth) {\n                // On the glyph margin\n                return request.fulfillMargin(2 /* GUTTER_GLYPH_MARGIN */, pos, res.range, detail);\n            }\n            offset -= ctx.layoutInfo.glyphMarginWidth;\n            if (offset <= ctx.layoutInfo.lineNumbersWidth) {\n                // On the line numbers\n                return request.fulfillMargin(3 /* GUTTER_LINE_NUMBERS */, pos, res.range, detail);\n            }\n            offset -= ctx.layoutInfo.lineNumbersWidth;\n            // On the line decorations\n            return request.fulfillMargin(4 /* GUTTER_LINE_DECORATIONS */, pos, res.range, detail);\n        }\n        return null;\n    }\n    static _hitTestViewLines(ctx, request, domHitTestExecuted) {\n        if (!ElementPath.isChildOfViewLines(request.targetPath)) {\n            return null;\n        }\n        if (ctx.isInTopPadding(request.mouseVerticalOffset)) {\n            return request.fulfillContentEmpty(new Position(1, 1), EMPTY_CONTENT_AFTER_LINES);\n        }\n        // Check if it is below any lines and any view zones\n        if (ctx.isAfterLines(request.mouseVerticalOffset) || ctx.isInBottomPadding(request.mouseVerticalOffset)) {\n            // This most likely indicates it happened after the last view-line\n            const lineCount = ctx.viewModel.getLineCount();\n            const maxLineColumn = ctx.viewModel.getLineMaxColumn(lineCount);\n            return request.fulfillContentEmpty(new Position(lineCount, maxLineColumn), EMPTY_CONTENT_AFTER_LINES);\n        }\n        if (domHitTestExecuted) {\n            // Check if we are hitting a view-line (can happen in the case of inline decorations on empty lines)\n            // See https://github.com/microsoft/vscode/issues/46942\n            if (ElementPath.isStrictChildOfViewLines(request.targetPath)) {\n                const lineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\n                if (ctx.viewModel.getLineLength(lineNumber) === 0) {\n                    const lineWidth = ctx.getLineWidth(lineNumber);\n                    const detail = createEmptyContentDataInLines(request.mouseContentHorizontalOffset - lineWidth);\n                    return request.fulfillContentEmpty(new Position(lineNumber, 1), detail);\n                }\n                const lineWidth = ctx.getLineWidth(lineNumber);\n                if (request.mouseContentHorizontalOffset >= lineWidth) {\n                    const detail = createEmptyContentDataInLines(request.mouseContentHorizontalOffset - lineWidth);\n                    const pos = new Position(lineNumber, ctx.viewModel.getLineMaxColumn(lineNumber));\n                    return request.fulfillContentEmpty(pos, detail);\n                }\n            }\n            // We have already executed hit test...\n            return request.fulfillUnknown();\n        }\n        const hitTestResult = MouseTargetFactory._doHitTest(ctx, request);\n        if (hitTestResult.type === 1 /* Content */) {\n            return MouseTargetFactory.createMouseTargetFromHitTestPosition(ctx, request, hitTestResult.spanNode, hitTestResult.position, hitTestResult.injectedText);\n        }\n        return this._createMouseTarget(ctx, request.withTarget(hitTestResult.hitTarget), true);\n    }\n    static _hitTestMinimap(ctx, request) {\n        if (ElementPath.isChildOfMinimap(request.targetPath)) {\n            const possibleLineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\n            const maxColumn = ctx.viewModel.getLineMaxColumn(possibleLineNumber);\n            return request.fulfillScrollbar(new Position(possibleLineNumber, maxColumn));\n        }\n        return null;\n    }\n    static _hitTestScrollbarSlider(ctx, request) {\n        if (ElementPath.isChildOfScrollableElement(request.targetPath)) {\n            if (request.target && request.target.nodeType === 1) {\n                const className = request.target.className;\n                if (className && /\\b(slider|scrollbar)\\b/.test(className)) {\n                    const possibleLineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\n                    const maxColumn = ctx.viewModel.getLineMaxColumn(possibleLineNumber);\n                    return request.fulfillScrollbar(new Position(possibleLineNumber, maxColumn));\n                }\n            }\n        }\n        return null;\n    }\n    static _hitTestScrollbar(ctx, request) {\n        // Is it the overview ruler?\n        // Is it a child of the scrollable element?\n        if (ElementPath.isChildOfScrollableElement(request.targetPath)) {\n            const possibleLineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\n            const maxColumn = ctx.viewModel.getLineMaxColumn(possibleLineNumber);\n            return request.fulfillScrollbar(new Position(possibleLineNumber, maxColumn));\n        }\n        return null;\n    }\n    getMouseColumn(relativePos) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(131 /* layoutInfo */);\n        const mouseContentHorizontalOffset = this._context.viewLayout.getCurrentScrollLeft() + relativePos.x - layoutInfo.contentLeft;\n        return MouseTargetFactory._getMouseColumn(mouseContentHorizontalOffset, options.get(44 /* fontInfo */).typicalHalfwidthCharacterWidth);\n    }\n    static _getMouseColumn(mouseContentHorizontalOffset, typicalHalfwidthCharacterWidth) {\n        if (mouseContentHorizontalOffset < 0) {\n            return 1;\n        }\n        const chars = Math.round(mouseContentHorizontalOffset / typicalHalfwidthCharacterWidth);\n        return (chars + 1);\n    }\n    static createMouseTargetFromHitTestPosition(ctx, request, spanNode, pos, injectedText) {\n        const lineNumber = pos.lineNumber;\n        const column = pos.column;\n        const lineWidth = ctx.getLineWidth(lineNumber);\n        if (request.mouseContentHorizontalOffset > lineWidth) {\n            const detail = createEmptyContentDataInLines(request.mouseContentHorizontalOffset - lineWidth);\n            return request.fulfillContentEmpty(pos, detail);\n        }\n        const visibleRange = ctx.visibleRangeForPosition(lineNumber, column);\n        if (!visibleRange) {\n            return request.fulfillUnknown(pos);\n        }\n        const columnHorizontalOffset = visibleRange.left;\n        if (request.mouseContentHorizontalOffset === columnHorizontalOffset) {\n            return request.fulfillContentText(pos, null, { mightBeForeignElement: !!injectedText, injectedText });\n        }\n        const points = [];\n        points.push({ offset: visibleRange.left, column: column });\n        if (column > 1) {\n            const visibleRange = ctx.visibleRangeForPosition(lineNumber, column - 1);\n            if (visibleRange) {\n                points.push({ offset: visibleRange.left, column: column - 1 });\n            }\n        }\n        const lineMaxColumn = ctx.viewModel.getLineMaxColumn(lineNumber);\n        if (column < lineMaxColumn) {\n            const visibleRange = ctx.visibleRangeForPosition(lineNumber, column + 1);\n            if (visibleRange) {\n                points.push({ offset: visibleRange.left, column: column + 1 });\n            }\n        }\n        points.sort((a, b) => a.offset - b.offset);\n        const mouseCoordinates = request.pos.toClientCoordinates();\n        const spanNodeClientRect = spanNode.getBoundingClientRect();\n        const mouseIsOverSpanNode = (spanNodeClientRect.left <= mouseCoordinates.clientX && mouseCoordinates.clientX <= spanNodeClientRect.right);\n        for (let i = 1; i < points.length; i++) {\n            const prev = points[i - 1];\n            const curr = points[i];\n            if (prev.offset <= request.mouseContentHorizontalOffset && request.mouseContentHorizontalOffset <= curr.offset) {\n                const rng = new EditorRange(lineNumber, prev.column, lineNumber, curr.column);\n                return request.fulfillContentText(pos, rng, { mightBeForeignElement: !mouseIsOverSpanNode || !!injectedText, injectedText });\n            }\n        }\n        return request.fulfillContentText(pos, null, { mightBeForeignElement: !mouseIsOverSpanNode || !!injectedText, injectedText });\n    }\n    /**\n     * Most probably WebKit browsers and Edge\n     */\n    static _doHitTestWithCaretRangeFromPoint(ctx, request) {\n        // In Chrome, especially on Linux it is possible to click between lines,\n        // so try to adjust the `hity` below so that it lands in the center of a line\n        const lineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\n        const lineVerticalOffset = ctx.getVerticalOffsetForLineNumber(lineNumber);\n        const lineCenteredVerticalOffset = lineVerticalOffset + Math.floor(ctx.lineHeight / 2);\n        let adjustedPageY = request.pos.y + (lineCenteredVerticalOffset - request.mouseVerticalOffset);\n        if (adjustedPageY <= request.editorPos.y) {\n            adjustedPageY = request.editorPos.y + 1;\n        }\n        if (adjustedPageY >= request.editorPos.y + request.editorPos.height) {\n            adjustedPageY = request.editorPos.y + request.editorPos.height - 1;\n        }\n        const adjustedPage = new PageCoordinates(request.pos.x, adjustedPageY);\n        const r = this._actualDoHitTestWithCaretRangeFromPoint(ctx, adjustedPage.toClientCoordinates());\n        if (r.type === 1 /* Content */) {\n            return r;\n        }\n        // Also try to hit test without the adjustment (for the edge cases that we are near the top or bottom)\n        return this._actualDoHitTestWithCaretRangeFromPoint(ctx, request.pos.toClientCoordinates());\n    }\n    static _actualDoHitTestWithCaretRangeFromPoint(ctx, coords) {\n        const shadowRoot = dom.getShadowRoot(ctx.viewDomNode);\n        let range;\n        if (shadowRoot) {\n            if (typeof shadowRoot.caretRangeFromPoint === 'undefined') {\n                range = shadowCaretRangeFromPoint(shadowRoot, coords.clientX, coords.clientY);\n            }\n            else {\n                range = shadowRoot.caretRangeFromPoint(coords.clientX, coords.clientY);\n            }\n        }\n        else {\n            range = document.caretRangeFromPoint(coords.clientX, coords.clientY);\n        }\n        if (!range || !range.startContainer) {\n            return new UnknownHitTestResult();\n        }\n        // Chrome always hits a TEXT_NODE, while Edge sometimes hits a token span\n        const startContainer = range.startContainer;\n        if (startContainer.nodeType === startContainer.TEXT_NODE) {\n            // startContainer is expected to be the token text\n            const parent1 = startContainer.parentNode; // expected to be the token span\n            const parent2 = parent1 ? parent1.parentNode : null; // expected to be the view line container span\n            const parent3 = parent2 ? parent2.parentNode : null; // expected to be the view line div\n            const parent3ClassName = parent3 && parent3.nodeType === parent3.ELEMENT_NODE ? parent3.className : null;\n            if (parent3ClassName === ViewLine.CLASS_NAME) {\n                return HitTestResult.createFromDOMInfo(ctx, parent1, range.startOffset);\n            }\n            else {\n                return new UnknownHitTestResult(startContainer.parentNode);\n            }\n        }\n        else if (startContainer.nodeType === startContainer.ELEMENT_NODE) {\n            // startContainer is expected to be the token span\n            const parent1 = startContainer.parentNode; // expected to be the view line container span\n            const parent2 = parent1 ? parent1.parentNode : null; // expected to be the view line div\n            const parent2ClassName = parent2 && parent2.nodeType === parent2.ELEMENT_NODE ? parent2.className : null;\n            if (parent2ClassName === ViewLine.CLASS_NAME) {\n                return HitTestResult.createFromDOMInfo(ctx, startContainer, startContainer.textContent.length);\n            }\n            else {\n                return new UnknownHitTestResult(startContainer);\n            }\n        }\n        return new UnknownHitTestResult();\n    }\n    /**\n     * Most probably Gecko\n     */\n    static _doHitTestWithCaretPositionFromPoint(ctx, coords) {\n        const hitResult = document.caretPositionFromPoint(coords.clientX, coords.clientY);\n        if (hitResult.offsetNode.nodeType === hitResult.offsetNode.TEXT_NODE) {\n            // offsetNode is expected to be the token text\n            const parent1 = hitResult.offsetNode.parentNode; // expected to be the token span\n            const parent2 = parent1 ? parent1.parentNode : null; // expected to be the view line container span\n            const parent3 = parent2 ? parent2.parentNode : null; // expected to be the view line div\n            const parent3ClassName = parent3 && parent3.nodeType === parent3.ELEMENT_NODE ? parent3.className : null;\n            if (parent3ClassName === ViewLine.CLASS_NAME) {\n                return HitTestResult.createFromDOMInfo(ctx, hitResult.offsetNode.parentNode, hitResult.offset);\n            }\n            else {\n                return new UnknownHitTestResult(hitResult.offsetNode.parentNode);\n            }\n        }\n        // For inline decorations, Gecko sometimes returns the `<span>` of the line and the offset is the `<span>` with the inline decoration\n        // Some other times, it returns the `<span>` with the inline decoration\n        if (hitResult.offsetNode.nodeType === hitResult.offsetNode.ELEMENT_NODE) {\n            const parent1 = hitResult.offsetNode.parentNode;\n            const parent1ClassName = parent1 && parent1.nodeType === parent1.ELEMENT_NODE ? parent1.className : null;\n            const parent2 = parent1 ? parent1.parentNode : null;\n            const parent2ClassName = parent2 && parent2.nodeType === parent2.ELEMENT_NODE ? parent2.className : null;\n            if (parent1ClassName === ViewLine.CLASS_NAME) {\n                // it returned the `<span>` of the line and the offset is the `<span>` with the inline decoration\n                const tokenSpan = hitResult.offsetNode.childNodes[Math.min(hitResult.offset, hitResult.offsetNode.childNodes.length - 1)];\n                if (tokenSpan) {\n                    return HitTestResult.createFromDOMInfo(ctx, tokenSpan, 0);\n                }\n            }\n            else if (parent2ClassName === ViewLine.CLASS_NAME) {\n                // it returned the `<span>` with the inline decoration\n                return HitTestResult.createFromDOMInfo(ctx, hitResult.offsetNode, 0);\n            }\n        }\n        return new UnknownHitTestResult(hitResult.offsetNode);\n    }\n    static _snapToSoftTabBoundary(position, viewModel) {\n        const lineContent = viewModel.getLineContent(position.lineNumber);\n        const { tabSize } = viewModel.model.getOptions();\n        const newPosition = AtomicTabMoveOperations.atomicPosition(lineContent, position.column - 1, tabSize, 2 /* Nearest */);\n        if (newPosition !== -1) {\n            return new Position(position.lineNumber, newPosition + 1);\n        }\n        return position;\n    }\n    static _doHitTest(ctx, request) {\n        let result = new UnknownHitTestResult();\n        if (typeof document.caretRangeFromPoint === 'function') {\n            result = this._doHitTestWithCaretRangeFromPoint(ctx, request);\n        }\n        else if (document.caretPositionFromPoint) {\n            result = this._doHitTestWithCaretPositionFromPoint(ctx, request.pos.toClientCoordinates());\n        }\n        if (result.type === 1 /* Content */) {\n            const injectedText = ctx.viewModel.getInjectedTextAt(result.position);\n            const normalizedPosition = ctx.viewModel.normalizePosition(result.position, 2 /* None */);\n            if (injectedText || !normalizedPosition.equals(result.position)) {\n                result = new ContentHitTestResult(normalizedPosition, result.spanNode, injectedText);\n            }\n        }\n        // Snap to the nearest soft tab boundary if atomic soft tabs are enabled.\n        if (result.type === 1 /* Content */ && ctx.stickyTabStops) {\n            result = new ContentHitTestResult(this._snapToSoftTabBoundary(result.position, ctx.viewModel), result.spanNode, result.injectedText);\n        }\n        return result;\n    }\n}\nexport function shadowCaretRangeFromPoint(shadowRoot, x, y) {\n    const range = document.createRange();\n    // Get the element under the point\n    let el = shadowRoot.elementFromPoint(x, y);\n    if (el !== null) {\n        // Get the last child of the element until its firstChild is a text node\n        // This assumes that the pointer is on the right of the line, out of the tokens\n        // and that we want to get the offset of the last token of the line\n        while (el && el.firstChild && el.firstChild.nodeType !== el.firstChild.TEXT_NODE && el.lastChild && el.lastChild.firstChild) {\n            el = el.lastChild;\n        }\n        // Grab its rect\n        const rect = el.getBoundingClientRect();\n        // And its font\n        const font = window.getComputedStyle(el, null).getPropertyValue('font');\n        // And also its txt content\n        const text = el.innerText;\n        // Position the pixel cursor at the left of the element\n        let pixelCursor = rect.left;\n        let offset = 0;\n        let step;\n        // If the point is on the right of the box put the cursor after the last character\n        if (x > rect.left + rect.width) {\n            offset = text.length;\n        }\n        else {\n            const charWidthReader = CharWidthReader.getInstance();\n            // Goes through all the characters of the innerText, and checks if the x of the point\n            // belongs to the character.\n            for (let i = 0; i < text.length + 1; i++) {\n                // The step is half the width of the character\n                step = charWidthReader.getCharWidth(text.charAt(i), font) / 2;\n                // Move to the center of the character\n                pixelCursor += step;\n                // If the x of the point is smaller that the position of the cursor, the point is over that character\n                if (x < pixelCursor) {\n                    offset = i;\n                    break;\n                }\n                // Move between the current character and the next\n                pixelCursor += step;\n            }\n        }\n        // Creates a range with the text node of the element and set the offset found\n        range.setStart(el.firstChild, offset);\n        range.setEnd(el.firstChild, offset);\n    }\n    return range;\n}\nclass CharWidthReader {\n    constructor() {\n        this._cache = {};\n        this._canvas = document.createElement('canvas');\n    }\n    static getInstance() {\n        if (!CharWidthReader._INSTANCE) {\n            CharWidthReader._INSTANCE = new CharWidthReader();\n        }\n        return CharWidthReader._INSTANCE;\n    }\n    getCharWidth(char, font) {\n        const cacheKey = char + font;\n        if (this._cache[cacheKey]) {\n            return this._cache[cacheKey];\n        }\n        const context = this._canvas.getContext('2d');\n        context.font = font;\n        const metrics = context.measureText(char);\n        const width = metrics.width;\n        this._cache[cacheKey] = width;\n        return width;\n    }\n}\nCharWidthReader._INSTANCE = null;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../base/browser/dom.js';\nimport { StandardWheelEvent } from '../../../base/browser/mouseEvent.js';\nimport { TimeoutTimer } from '../../../base/common/async.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport * as platform from '../../../base/common/platform.js';\nimport { HitTestContext, MouseTarget, MouseTargetFactory } from './mouseTarget.js';\nimport { ClientCoordinates, EditorMouseEventFactory, GlobalEditorMouseMoveMonitor, createEditorPagePosition, createCoordinatesRelativeToEditor } from '../editorDom.js';\nimport { EditorZoom } from '../../common/config/editorZoom.js';\nimport { Position } from '../../common/core/position.js';\nimport { Selection } from '../../common/core/selection.js';\nimport { ViewEventHandler } from '../../common/viewEventHandler.js';\n/**\n * Merges mouse events when mouse move events are throttled\n */\nexport function createMouseMoveEventMerger(mouseTargetFactory) {\n    return function (lastEvent, currentEvent) {\n        let targetIsWidget = false;\n        if (mouseTargetFactory) {\n            targetIsWidget = mouseTargetFactory.mouseTargetIsWidget(currentEvent);\n        }\n        if (!targetIsWidget) {\n            currentEvent.preventDefault();\n        }\n        return currentEvent;\n    };\n}\nexport class MouseHandler extends ViewEventHandler {\n    constructor(context, viewController, viewHelper) {\n        super();\n        this._context = context;\n        this.viewController = viewController;\n        this.viewHelper = viewHelper;\n        this.mouseTargetFactory = new MouseTargetFactory(this._context, viewHelper);\n        this._mouseDownOperation = this._register(new MouseDownOperation(this._context, this.viewController, this.viewHelper, (e, testEventTarget) => this._createMouseTarget(e, testEventTarget), (e) => this._getMouseColumn(e)));\n        this.lastMouseLeaveTime = -1;\n        this._height = this._context.configuration.options.get(131 /* layoutInfo */).height;\n        const mouseEvents = new EditorMouseEventFactory(this.viewHelper.viewDomNode);\n        this._register(mouseEvents.onContextMenu(this.viewHelper.viewDomNode, (e) => this._onContextMenu(e, true)));\n        this._register(mouseEvents.onMouseMoveThrottled(this.viewHelper.viewDomNode, (e) => this._onMouseMove(e), createMouseMoveEventMerger(this.mouseTargetFactory), MouseHandler.MOUSE_MOVE_MINIMUM_TIME));\n        this._register(mouseEvents.onMouseUp(this.viewHelper.viewDomNode, (e) => this._onMouseUp(e)));\n        this._register(mouseEvents.onMouseLeave(this.viewHelper.viewDomNode, (e) => this._onMouseLeave(e)));\n        this._register(mouseEvents.onMouseDown(this.viewHelper.viewDomNode, (e) => this._onMouseDown(e)));\n        const onMouseWheel = (browserEvent) => {\n            this.viewController.emitMouseWheel(browserEvent);\n            if (!this._context.configuration.options.get(68 /* mouseWheelZoom */)) {\n                return;\n            }\n            const e = new StandardWheelEvent(browserEvent);\n            const doMouseWheelZoom = (platform.isMacintosh\n                // on macOS we support cmd + two fingers scroll (`metaKey` set)\n                // and also the two fingers pinch gesture (`ctrKey` set)\n                ? ((browserEvent.metaKey || browserEvent.ctrlKey) && !browserEvent.shiftKey && !browserEvent.altKey)\n                : (browserEvent.ctrlKey && !browserEvent.metaKey && !browserEvent.shiftKey && !browserEvent.altKey));\n            if (doMouseWheelZoom) {\n                const zoomLevel = EditorZoom.getZoomLevel();\n                const delta = e.deltaY > 0 ? 1 : -1;\n                EditorZoom.setZoomLevel(zoomLevel + delta);\n                e.preventDefault();\n                e.stopPropagation();\n            }\n        };\n        this._register(dom.addDisposableListener(this.viewHelper.viewDomNode, dom.EventType.MOUSE_WHEEL, onMouseWheel, { capture: true, passive: false }));\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        if (e.hasChanged(131 /* layoutInfo */)) {\n            // layout change\n            const height = this._context.configuration.options.get(131 /* layoutInfo */).height;\n            if (this._height !== height) {\n                this._height = height;\n                this._mouseDownOperation.onHeightChanged();\n            }\n        }\n        return false;\n    }\n    onCursorStateChanged(e) {\n        this._mouseDownOperation.onCursorStateChanged(e);\n        return false;\n    }\n    onFocusChanged(e) {\n        return false;\n    }\n    onScrollChanged(e) {\n        this._mouseDownOperation.onScrollChanged();\n        return false;\n    }\n    // --- end event handlers\n    getTargetAtClientPoint(clientX, clientY) {\n        const clientPos = new ClientCoordinates(clientX, clientY);\n        const pos = clientPos.toPageCoordinates();\n        const editorPos = createEditorPagePosition(this.viewHelper.viewDomNode);\n        if (pos.y < editorPos.y || pos.y > editorPos.y + editorPos.height || pos.x < editorPos.x || pos.x > editorPos.x + editorPos.width) {\n            return null;\n        }\n        const relativePos = createCoordinatesRelativeToEditor(this.viewHelper.viewDomNode, editorPos, pos);\n        return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(), editorPos, pos, relativePos, null);\n    }\n    _createMouseTarget(e, testEventTarget) {\n        let target = e.target;\n        if (!this.viewHelper.viewDomNode.contains(target)) {\n            const shadowRoot = dom.getShadowRoot(this.viewHelper.viewDomNode);\n            if (shadowRoot) {\n                target = shadowRoot.elementsFromPoint(e.posx, e.posy).find((el) => this.viewHelper.viewDomNode.contains(el));\n            }\n        }\n        return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(), e.editorPos, e.pos, e.relativePos, testEventTarget ? target : null);\n    }\n    _getMouseColumn(e) {\n        return this.mouseTargetFactory.getMouseColumn(e.relativePos);\n    }\n    _onContextMenu(e, testEventTarget) {\n        this.viewController.emitContextMenu({\n            event: e,\n            target: this._createMouseTarget(e, testEventTarget)\n        });\n    }\n    _onMouseMove(e) {\n        if (this._mouseDownOperation.isActive()) {\n            // In selection/drag operation\n            return;\n        }\n        const actualMouseMoveTime = e.timestamp;\n        if (actualMouseMoveTime < this.lastMouseLeaveTime) {\n            // Due to throttling, this event occurred before the mouse left the editor, therefore ignore it.\n            return;\n        }\n        this.viewController.emitMouseMove({\n            event: e,\n            target: this._createMouseTarget(e, true)\n        });\n    }\n    _onMouseLeave(e) {\n        this.lastMouseLeaveTime = (new Date()).getTime();\n        this.viewController.emitMouseLeave({\n            event: e,\n            target: null\n        });\n    }\n    _onMouseUp(e) {\n        this.viewController.emitMouseUp({\n            event: e,\n            target: this._createMouseTarget(e, true)\n        });\n    }\n    _onMouseDown(e) {\n        const t = this._createMouseTarget(e, true);\n        const targetIsContent = (t.type === 6 /* CONTENT_TEXT */ || t.type === 7 /* CONTENT_EMPTY */);\n        const targetIsGutter = (t.type === 2 /* GUTTER_GLYPH_MARGIN */ || t.type === 3 /* GUTTER_LINE_NUMBERS */ || t.type === 4 /* GUTTER_LINE_DECORATIONS */);\n        const targetIsLineNumbers = (t.type === 3 /* GUTTER_LINE_NUMBERS */);\n        const selectOnLineNumbers = this._context.configuration.options.get(98 /* selectOnLineNumbers */);\n        const targetIsViewZone = (t.type === 8 /* CONTENT_VIEW_ZONE */ || t.type === 5 /* GUTTER_VIEW_ZONE */);\n        const targetIsWidget = (t.type === 9 /* CONTENT_WIDGET */);\n        let shouldHandle = e.leftButton || e.middleButton;\n        if (platform.isMacintosh && e.leftButton && e.ctrlKey) {\n            shouldHandle = false;\n        }\n        const focus = () => {\n            e.preventDefault();\n            this.viewHelper.focusTextArea();\n        };\n        if (shouldHandle && (targetIsContent || (targetIsLineNumbers && selectOnLineNumbers))) {\n            focus();\n            this._mouseDownOperation.start(t.type, e);\n        }\n        else if (targetIsGutter) {\n            // Do not steal focus\n            e.preventDefault();\n        }\n        else if (targetIsViewZone) {\n            const viewZoneData = t.detail;\n            if (this.viewHelper.shouldSuppressMouseDownOnViewZone(viewZoneData.viewZoneId)) {\n                focus();\n                this._mouseDownOperation.start(t.type, e);\n                e.preventDefault();\n            }\n        }\n        else if (targetIsWidget && this.viewHelper.shouldSuppressMouseDownOnWidget(t.detail)) {\n            focus();\n            e.preventDefault();\n        }\n        this.viewController.emitMouseDown({\n            event: e,\n            target: t\n        });\n    }\n}\nMouseHandler.MOUSE_MOVE_MINIMUM_TIME = 100; // ms\nclass MouseDownOperation extends Disposable {\n    constructor(context, viewController, viewHelper, createMouseTarget, getMouseColumn) {\n        super();\n        this._context = context;\n        this._viewController = viewController;\n        this._viewHelper = viewHelper;\n        this._createMouseTarget = createMouseTarget;\n        this._getMouseColumn = getMouseColumn;\n        this._mouseMoveMonitor = this._register(new GlobalEditorMouseMoveMonitor(this._viewHelper.viewDomNode));\n        this._onScrollTimeout = this._register(new TimeoutTimer());\n        this._mouseState = new MouseDownState();\n        this._currentSelection = new Selection(1, 1, 1, 1);\n        this._isActive = false;\n        this._lastMouseEvent = null;\n    }\n    dispose() {\n        super.dispose();\n    }\n    isActive() {\n        return this._isActive;\n    }\n    _onMouseDownThenMove(e) {\n        this._lastMouseEvent = e;\n        this._mouseState.setModifiers(e);\n        const position = this._findMousePosition(e, true);\n        if (!position) {\n            // Ignoring because position is unknown\n            return;\n        }\n        if (this._mouseState.isDragAndDrop) {\n            this._viewController.emitMouseDrag({\n                event: e,\n                target: position\n            });\n        }\n        else {\n            this._dispatchMouse(position, true);\n        }\n    }\n    start(targetType, e) {\n        this._lastMouseEvent = e;\n        this._mouseState.setStartedOnLineNumbers(targetType === 3 /* GUTTER_LINE_NUMBERS */);\n        this._mouseState.setStartButtons(e);\n        this._mouseState.setModifiers(e);\n        const position = this._findMousePosition(e, true);\n        if (!position || !position.position) {\n            // Ignoring because position is unknown\n            return;\n        }\n        this._mouseState.trySetCount(e.detail, position.position);\n        // Overwrite the detail of the MouseEvent, as it will be sent out in an event and contributions might rely on it.\n        e.detail = this._mouseState.count;\n        const options = this._context.configuration.options;\n        if (!options.get(81 /* readOnly */)\n            && options.get(31 /* dragAndDrop */)\n            && !options.get(18 /* columnSelection */)\n            && !this._mouseState.altKey // we don't support multiple mouse\n            && e.detail < 2 // only single click on a selection can work\n            && !this._isActive // the mouse is not down yet\n            && !this._currentSelection.isEmpty() // we don't drag single cursor\n            && (position.type === 6 /* CONTENT_TEXT */) // single click on text\n            && position.position && this._currentSelection.containsPosition(position.position) // single click on a selection\n        ) {\n            this._mouseState.isDragAndDrop = true;\n            this._isActive = true;\n            this._mouseMoveMonitor.startMonitoring(e.target, e.buttons, createMouseMoveEventMerger(null), (e) => this._onMouseDownThenMove(e), (browserEvent) => {\n                const position = this._findMousePosition(this._lastMouseEvent, true);\n                if (browserEvent && browserEvent instanceof KeyboardEvent) {\n                    // cancel\n                    this._viewController.emitMouseDropCanceled();\n                }\n                else {\n                    this._viewController.emitMouseDrop({\n                        event: this._lastMouseEvent,\n                        target: (position ? this._createMouseTarget(this._lastMouseEvent, true) : null) // Ignoring because position is unknown, e.g., Content View Zone\n                    });\n                }\n                this._stop();\n            });\n            return;\n        }\n        this._mouseState.isDragAndDrop = false;\n        this._dispatchMouse(position, e.shiftKey);\n        if (!this._isActive) {\n            this._isActive = true;\n            this._mouseMoveMonitor.startMonitoring(e.target, e.buttons, createMouseMoveEventMerger(null), (e) => this._onMouseDownThenMove(e), () => this._stop());\n        }\n    }\n    _stop() {\n        this._isActive = false;\n        this._onScrollTimeout.cancel();\n    }\n    onHeightChanged() {\n        this._mouseMoveMonitor.stopMonitoring();\n    }\n    onScrollChanged() {\n        if (!this._isActive) {\n            return;\n        }\n        this._onScrollTimeout.setIfNotSet(() => {\n            if (!this._lastMouseEvent) {\n                return;\n            }\n            const position = this._findMousePosition(this._lastMouseEvent, false);\n            if (!position) {\n                // Ignoring because position is unknown\n                return;\n            }\n            if (this._mouseState.isDragAndDrop) {\n                // Ignoring because users are dragging the text\n                return;\n            }\n            this._dispatchMouse(position, true);\n        }, 10);\n    }\n    onCursorStateChanged(e) {\n        this._currentSelection = e.selections[0];\n    }\n    _getPositionOutsideEditor(e) {\n        const editorContent = e.editorPos;\n        const model = this._context.viewModel;\n        const viewLayout = this._context.viewLayout;\n        const mouseColumn = this._getMouseColumn(e);\n        if (e.posy < editorContent.y) {\n            const verticalOffset = Math.max(viewLayout.getCurrentScrollTop() - (editorContent.y - e.posy), 0);\n            const viewZoneData = HitTestContext.getZoneAtCoord(this._context, verticalOffset);\n            if (viewZoneData) {\n                const newPosition = this._helpPositionJumpOverViewZone(viewZoneData);\n                if (newPosition) {\n                    return MouseTarget.createOutsideEditor(mouseColumn, newPosition);\n                }\n            }\n            const aboveLineNumber = viewLayout.getLineNumberAtVerticalOffset(verticalOffset);\n            return MouseTarget.createOutsideEditor(mouseColumn, new Position(aboveLineNumber, 1));\n        }\n        if (e.posy > editorContent.y + editorContent.height) {\n            const verticalOffset = viewLayout.getCurrentScrollTop() + e.relativePos.y;\n            const viewZoneData = HitTestContext.getZoneAtCoord(this._context, verticalOffset);\n            if (viewZoneData) {\n                const newPosition = this._helpPositionJumpOverViewZone(viewZoneData);\n                if (newPosition) {\n                    return MouseTarget.createOutsideEditor(mouseColumn, newPosition);\n                }\n            }\n            const belowLineNumber = viewLayout.getLineNumberAtVerticalOffset(verticalOffset);\n            return MouseTarget.createOutsideEditor(mouseColumn, new Position(belowLineNumber, model.getLineMaxColumn(belowLineNumber)));\n        }\n        const possibleLineNumber = viewLayout.getLineNumberAtVerticalOffset(viewLayout.getCurrentScrollTop() + e.relativePos.y);\n        if (e.posx < editorContent.x) {\n            return MouseTarget.createOutsideEditor(mouseColumn, new Position(possibleLineNumber, 1));\n        }\n        if (e.posx > editorContent.x + editorContent.width) {\n            return MouseTarget.createOutsideEditor(mouseColumn, new Position(possibleLineNumber, model.getLineMaxColumn(possibleLineNumber)));\n        }\n        return null;\n    }\n    _findMousePosition(e, testEventTarget) {\n        const positionOutsideEditor = this._getPositionOutsideEditor(e);\n        if (positionOutsideEditor) {\n            return positionOutsideEditor;\n        }\n        const t = this._createMouseTarget(e, testEventTarget);\n        const hintedPosition = t.position;\n        if (!hintedPosition) {\n            return null;\n        }\n        if (t.type === 8 /* CONTENT_VIEW_ZONE */ || t.type === 5 /* GUTTER_VIEW_ZONE */) {\n            const newPosition = this._helpPositionJumpOverViewZone(t.detail);\n            if (newPosition) {\n                return MouseTarget.createViewZone(t.type, t.element, t.mouseColumn, newPosition, t.detail);\n            }\n        }\n        return t;\n    }\n    _helpPositionJumpOverViewZone(viewZoneData) {\n        // Force position on view zones to go above or below depending on where selection started from\n        const selectionStart = new Position(this._currentSelection.selectionStartLineNumber, this._currentSelection.selectionStartColumn);\n        const positionBefore = viewZoneData.positionBefore;\n        const positionAfter = viewZoneData.positionAfter;\n        if (positionBefore && positionAfter) {\n            if (positionBefore.isBefore(selectionStart)) {\n                return positionBefore;\n            }\n            else {\n                return positionAfter;\n            }\n        }\n        return null;\n    }\n    _dispatchMouse(position, inSelectionMode) {\n        if (!position.position) {\n            return;\n        }\n        this._viewController.dispatchMouse({\n            position: position.position,\n            mouseColumn: position.mouseColumn,\n            startedOnLineNumbers: this._mouseState.startedOnLineNumbers,\n            inSelectionMode: inSelectionMode,\n            mouseDownCount: this._mouseState.count,\n            altKey: this._mouseState.altKey,\n            ctrlKey: this._mouseState.ctrlKey,\n            metaKey: this._mouseState.metaKey,\n            shiftKey: this._mouseState.shiftKey,\n            leftButton: this._mouseState.leftButton,\n            middleButton: this._mouseState.middleButton,\n            onInjectedText: position.type === 6 /* CONTENT_TEXT */ && position.detail.injectedText !== null\n        });\n    }\n}\nclass MouseDownState {\n    constructor() {\n        this._altKey = false;\n        this._ctrlKey = false;\n        this._metaKey = false;\n        this._shiftKey = false;\n        this._leftButton = false;\n        this._middleButton = false;\n        this._startedOnLineNumbers = false;\n        this._lastMouseDownPosition = null;\n        this._lastMouseDownPositionEqualCount = 0;\n        this._lastMouseDownCount = 0;\n        this._lastSetMouseDownCountTime = 0;\n        this.isDragAndDrop = false;\n    }\n    get altKey() { return this._altKey; }\n    get ctrlKey() { return this._ctrlKey; }\n    get metaKey() { return this._metaKey; }\n    get shiftKey() { return this._shiftKey; }\n    get leftButton() { return this._leftButton; }\n    get middleButton() { return this._middleButton; }\n    get startedOnLineNumbers() { return this._startedOnLineNumbers; }\n    get count() {\n        return this._lastMouseDownCount;\n    }\n    setModifiers(source) {\n        this._altKey = source.altKey;\n        this._ctrlKey = source.ctrlKey;\n        this._metaKey = source.metaKey;\n        this._shiftKey = source.shiftKey;\n    }\n    setStartButtons(source) {\n        this._leftButton = source.leftButton;\n        this._middleButton = source.middleButton;\n    }\n    setStartedOnLineNumbers(startedOnLineNumbers) {\n        this._startedOnLineNumbers = startedOnLineNumbers;\n    }\n    trySetCount(setMouseDownCount, newMouseDownPosition) {\n        // a. Invalidate multiple clicking if too much time has passed (will be hit by IE because the detail field of mouse events contains garbage in IE10)\n        const currentTime = (new Date()).getTime();\n        if (currentTime - this._lastSetMouseDownCountTime > MouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME) {\n            setMouseDownCount = 1;\n        }\n        this._lastSetMouseDownCountTime = currentTime;\n        // b. Ensure that we don't jump from single click to triple click in one go (will be hit by IE because the detail field of mouse events contains garbage in IE10)\n        if (setMouseDownCount > this._lastMouseDownCount + 1) {\n            setMouseDownCount = this._lastMouseDownCount + 1;\n        }\n        // c. Invalidate multiple clicking if the logical position is different\n        if (this._lastMouseDownPosition && this._lastMouseDownPosition.equals(newMouseDownPosition)) {\n            this._lastMouseDownPositionEqualCount++;\n        }\n        else {\n            this._lastMouseDownPositionEqualCount = 1;\n        }\n        this._lastMouseDownPosition = newMouseDownPosition;\n        // Finally set the lastMouseDownCount\n        this._lastMouseDownCount = Math.min(setMouseDownCount, this._lastMouseDownPositionEqualCount);\n    }\n}\nMouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME = 400; // ms\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../base/browser/dom.js';\nimport * as platform from '../../../base/common/platform.js';\nimport { EventType, Gesture } from '../../../base/browser/touch.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { MouseHandler, createMouseMoveEventMerger } from './mouseHandler.js';\nimport { EditorMouseEvent, EditorPointerEventFactory } from '../editorDom.js';\nimport { BrowserFeatures } from '../../../base/browser/canIUse.js';\nimport { TextAreaSyntethicEvents } from './textAreaInput.js';\n/**\n * Currently only tested on iOS 13/ iPadOS.\n */\nexport class PointerEventHandler extends MouseHandler {\n    constructor(context, viewController, viewHelper) {\n        super(context, viewController, viewHelper);\n        this._register(Gesture.addTarget(this.viewHelper.linesContentDomNode));\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, EventType.Tap, (e) => this.onTap(e)));\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, EventType.Change, (e) => this.onChange(e)));\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, EventType.Contextmenu, (e) => this._onContextMenu(new EditorMouseEvent(e, this.viewHelper.viewDomNode), false)));\n        this._lastPointerType = 'mouse';\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, 'pointerdown', (e) => {\n            const pointerType = e.pointerType;\n            if (pointerType === 'mouse') {\n                this._lastPointerType = 'mouse';\n                return;\n            }\n            else if (pointerType === 'touch') {\n                this._lastPointerType = 'touch';\n            }\n            else {\n                this._lastPointerType = 'pen';\n            }\n        }));\n        // PonterEvents\n        const pointerEvents = new EditorPointerEventFactory(this.viewHelper.viewDomNode);\n        this._register(pointerEvents.onPointerMoveThrottled(this.viewHelper.viewDomNode, (e) => this._onMouseMove(e), createMouseMoveEventMerger(this.mouseTargetFactory), MouseHandler.MOUSE_MOVE_MINIMUM_TIME));\n        this._register(pointerEvents.onPointerUp(this.viewHelper.viewDomNode, (e) => this._onMouseUp(e)));\n        this._register(pointerEvents.onPointerLeave(this.viewHelper.viewDomNode, (e) => this._onMouseLeave(e)));\n        this._register(pointerEvents.onPointerDown(this.viewHelper.viewDomNode, (e) => this._onMouseDown(e)));\n    }\n    onTap(event) {\n        if (!event.initialTarget || !this.viewHelper.linesContentDomNode.contains(event.initialTarget)) {\n            return;\n        }\n        event.preventDefault();\n        this.viewHelper.focusTextArea();\n        const target = this._createMouseTarget(new EditorMouseEvent(event, this.viewHelper.viewDomNode), false);\n        if (target.position) {\n            // this.viewController.moveTo(target.position);\n            this.viewController.dispatchMouse({\n                position: target.position,\n                mouseColumn: target.position.column,\n                startedOnLineNumbers: false,\n                mouseDownCount: event.tapCount,\n                inSelectionMode: false,\n                altKey: false,\n                ctrlKey: false,\n                metaKey: false,\n                shiftKey: false,\n                leftButton: false,\n                middleButton: false,\n                onInjectedText: target.type === 6 /* CONTENT_TEXT */ && target.detail.injectedText !== null\n            });\n        }\n    }\n    onChange(e) {\n        if (this._lastPointerType === 'touch') {\n            this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX, -e.translationY);\n        }\n    }\n    _onMouseDown(e) {\n        if (e.browserEvent.pointerType === 'touch') {\n            return;\n        }\n        super._onMouseDown(e);\n    }\n}\nclass TouchHandler extends MouseHandler {\n    constructor(context, viewController, viewHelper) {\n        super(context, viewController, viewHelper);\n        this._register(Gesture.addTarget(this.viewHelper.linesContentDomNode));\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, EventType.Tap, (e) => this.onTap(e)));\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, EventType.Change, (e) => this.onChange(e)));\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, EventType.Contextmenu, (e) => this._onContextMenu(new EditorMouseEvent(e, this.viewHelper.viewDomNode), false)));\n    }\n    onTap(event) {\n        event.preventDefault();\n        this.viewHelper.focusTextArea();\n        const target = this._createMouseTarget(new EditorMouseEvent(event, this.viewHelper.viewDomNode), false);\n        if (target.position) {\n            // Send the tap event also to the <textarea> (for input purposes)\n            const event = document.createEvent('CustomEvent');\n            event.initEvent(TextAreaSyntethicEvents.Tap, false, true);\n            this.viewHelper.dispatchTextAreaEvent(event);\n            this.viewController.moveTo(target.position);\n        }\n    }\n    onChange(e) {\n        this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX, -e.translationY);\n    }\n}\nexport class PointerHandler extends Disposable {\n    constructor(context, viewController, viewHelper) {\n        super();\n        if ((platform.isIOS && BrowserFeatures.pointerEvents)) {\n            this.handler = this._register(new PointerEventHandler(context, viewController, viewHelper));\n        }\n        else if (window.TouchEvent) {\n            this.handler = this._register(new TouchHandler(context, viewController, viewHelper));\n        }\n        else {\n            this.handler = this._register(new MouseHandler(context, viewController, viewHelper));\n        }\n    }\n    getTargetAtClientPoint(clientX, clientY) {\n        return this.handler.getTargetAtClientPoint(clientX, clientY);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './textAreaHandler.css';\nimport * as nls from '../../../nls.js';\nimport * as browser from '../../../base/browser/browser.js';\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\nimport * as platform from '../../../base/common/platform.js';\nimport * as strings from '../../../base/common/strings.js';\nimport { applyFontInfo } from '../config/domFontInfo.js';\nimport { CopyOptions, TextAreaInput, TextAreaWrapper } from './textAreaInput.js';\nimport { PagedScreenReaderStrategy, TextAreaState, _debugComposition } from './textAreaState.js';\nimport { PartFingerprints, ViewPart } from '../view/viewPart.js';\nimport { LineNumbersOverlay } from '../viewParts/lineNumbers/lineNumbers.js';\nimport { Margin } from '../viewParts/margin/margin.js';\nimport { EditorOptions } from '../../common/config/editorOptions.js';\nimport { getMapForWordSeparators } from '../../common/core/wordCharacterClassifier.js';\nimport { Position } from '../../common/core/position.js';\nimport { Range } from '../../common/core/range.js';\nimport { Selection } from '../../common/core/selection.js';\nimport { MOUSE_CURSOR_TEXT_CSS_CLASS_NAME } from '../../../base/browser/ui/mouseCursor/mouseCursor.js';\nimport { TokenizationRegistry } from '../../common/languages.js';\nimport { Color } from '../../../base/common/color.js';\nclass VisibleTextAreaData {\n    constructor(_context, modelLineNumber, distanceToModelLineStart, widthOfHiddenLineTextBefore, distanceToModelLineEnd) {\n        this._context = _context;\n        this.modelLineNumber = modelLineNumber;\n        this.distanceToModelLineStart = distanceToModelLineStart;\n        this.widthOfHiddenLineTextBefore = widthOfHiddenLineTextBefore;\n        this.distanceToModelLineEnd = distanceToModelLineEnd;\n        this._visibleTextAreaBrand = undefined;\n        this.startPosition = null;\n        this.endPosition = null;\n        this.visibleTextareaStart = null;\n        this.visibleTextareaEnd = null;\n        /**\n         * When doing composition, the currently composed text might be split up into\n         * multiple tokens, then merged again into a single token, etc. Here we attempt\n         * to keep the presentation of the <textarea> stable by using the previous used\n         * style if multiple tokens come into play. This avoids flickering.\n         */\n        this._previousPresentation = null;\n    }\n    prepareRender(visibleRangeProvider) {\n        const startModelPosition = new Position(this.modelLineNumber, this.distanceToModelLineStart + 1);\n        const endModelPosition = new Position(this.modelLineNumber, this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber) - this.distanceToModelLineEnd);\n        this.startPosition = this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(startModelPosition);\n        this.endPosition = this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(endModelPosition);\n        if (this.startPosition.lineNumber === this.endPosition.lineNumber) {\n            this.visibleTextareaStart = visibleRangeProvider.visibleRangeForPosition(this.startPosition);\n            this.visibleTextareaEnd = visibleRangeProvider.visibleRangeForPosition(this.endPosition);\n        }\n        else {\n            // TODO: what if the view positions are not on the same line?\n            this.visibleTextareaStart = null;\n            this.visibleTextareaEnd = null;\n        }\n    }\n    definePresentation(tokenPresentation) {\n        if (!this._previousPresentation) {\n            // To avoid flickering, once set, always reuse a presentation throughout the entire IME session\n            if (tokenPresentation) {\n                this._previousPresentation = tokenPresentation;\n            }\n            else {\n                this._previousPresentation = {\n                    foreground: 1 /* DefaultForeground */,\n                    italic: false,\n                    bold: false,\n                    underline: false,\n                    strikethrough: false,\n                };\n            }\n        }\n        return this._previousPresentation;\n    }\n}\nconst canUseZeroSizeTextarea = (browser.isFirefox);\nexport class TextAreaHandler extends ViewPart {\n    constructor(context, viewController, visibleRangeProvider) {\n        super(context);\n        // --- end view API\n        this._primaryCursorPosition = new Position(1, 1);\n        this._primaryCursorVisibleRange = null;\n        this._viewController = viewController;\n        this._visibleRangeProvider = visibleRangeProvider;\n        this._scrollLeft = 0;\n        this._scrollTop = 0;\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(131 /* layoutInfo */);\n        this._setAccessibilityOptions(options);\n        this._contentLeft = layoutInfo.contentLeft;\n        this._contentWidth = layoutInfo.contentWidth;\n        this._contentHeight = layoutInfo.height;\n        this._fontInfo = options.get(44 /* fontInfo */);\n        this._lineHeight = options.get(59 /* lineHeight */);\n        this._emptySelectionClipboard = options.get(32 /* emptySelectionClipboard */);\n        this._copyWithSyntaxHighlighting = options.get(21 /* copyWithSyntaxHighlighting */);\n        this._visibleTextArea = null;\n        this._selections = [new Selection(1, 1, 1, 1)];\n        this._modelSelections = [new Selection(1, 1, 1, 1)];\n        this._lastRenderPosition = null;\n        // Text Area (The focus will always be in the textarea when the cursor is blinking)\n        this.textArea = createFastDomNode(document.createElement('textarea'));\n        PartFingerprints.write(this.textArea, 6 /* TextArea */);\n        this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`);\n        this.textArea.setAttribute('wrap', 'off');\n        this.textArea.setAttribute('autocorrect', 'off');\n        this.textArea.setAttribute('autocapitalize', 'off');\n        this.textArea.setAttribute('autocomplete', 'off');\n        this.textArea.setAttribute('spellcheck', 'false');\n        this.textArea.setAttribute('aria-label', this._getAriaLabel(options));\n        this.textArea.setAttribute('tabindex', String(options.get(112 /* tabIndex */)));\n        this.textArea.setAttribute('role', 'textbox');\n        this.textArea.setAttribute('aria-roledescription', nls.localize('editor', \"editor\"));\n        this.textArea.setAttribute('aria-multiline', 'true');\n        this.textArea.setAttribute('aria-haspopup', 'false');\n        this.textArea.setAttribute('aria-autocomplete', 'both');\n        if (options.get(30 /* domReadOnly */) && options.get(81 /* readOnly */)) {\n            this.textArea.setAttribute('readonly', 'true');\n        }\n        this.textAreaCover = createFastDomNode(document.createElement('div'));\n        this.textAreaCover.setPosition('absolute');\n        const simpleModel = {\n            getLineCount: () => {\n                return this._context.viewModel.getLineCount();\n            },\n            getLineMaxColumn: (lineNumber) => {\n                return this._context.viewModel.getLineMaxColumn(lineNumber);\n            },\n            getValueInRange: (range, eol) => {\n                return this._context.viewModel.getValueInRange(range, eol);\n            }\n        };\n        const textAreaInputHost = {\n            getDataToCopy: () => {\n                const rawTextToCopy = this._context.viewModel.getPlainTextToCopy(this._modelSelections, this._emptySelectionClipboard, platform.isWindows);\n                const newLineCharacter = this._context.viewModel.model.getEOL();\n                const isFromEmptySelection = (this._emptySelectionClipboard && this._modelSelections.length === 1 && this._modelSelections[0].isEmpty());\n                const multicursorText = (Array.isArray(rawTextToCopy) ? rawTextToCopy : null);\n                const text = (Array.isArray(rawTextToCopy) ? rawTextToCopy.join(newLineCharacter) : rawTextToCopy);\n                let html = undefined;\n                let mode = null;\n                if (CopyOptions.forceCopyWithSyntaxHighlighting || (this._copyWithSyntaxHighlighting && text.length < 65536)) {\n                    const richText = this._context.viewModel.getRichTextToCopy(this._modelSelections, this._emptySelectionClipboard);\n                    if (richText) {\n                        html = richText.html;\n                        mode = richText.mode;\n                    }\n                }\n                return {\n                    isFromEmptySelection,\n                    multicursorText,\n                    text,\n                    html,\n                    mode\n                };\n            },\n            getScreenReaderContent: (currentState) => {\n                if (this._accessibilitySupport === 1 /* Disabled */) {\n                    // We know for a fact that a screen reader is not attached\n                    // On OSX, we write the character before the cursor to allow for \"long-press\" composition\n                    // Also on OSX, we write the word before the cursor to allow for the Accessibility Keyboard to give good hints\n                    if (platform.isMacintosh) {\n                        const selection = this._selections[0];\n                        if (selection.isEmpty()) {\n                            const position = selection.getStartPosition();\n                            let textBefore = this._getWordBeforePosition(position);\n                            if (textBefore.length === 0) {\n                                textBefore = this._getCharacterBeforePosition(position);\n                            }\n                            if (textBefore.length > 0) {\n                                return new TextAreaState(textBefore, textBefore.length, textBefore.length, position, position);\n                            }\n                        }\n                    }\n                    return TextAreaState.EMPTY;\n                }\n                if (browser.isAndroid) {\n                    // when tapping in the editor on a word, Android enters composition mode.\n                    // in the `compositionstart` event we cannot clear the textarea, because\n                    // it then forgets to ever send a `compositionend`.\n                    // we therefore only write the current word in the textarea\n                    const selection = this._selections[0];\n                    if (selection.isEmpty()) {\n                        const position = selection.getStartPosition();\n                        const [wordAtPosition, positionOffsetInWord] = this._getAndroidWordAtPosition(position);\n                        if (wordAtPosition.length > 0) {\n                            return new TextAreaState(wordAtPosition, positionOffsetInWord, positionOffsetInWord, position, position);\n                        }\n                    }\n                    return TextAreaState.EMPTY;\n                }\n                return PagedScreenReaderStrategy.fromEditorSelection(currentState, simpleModel, this._selections[0], this._accessibilityPageSize, this._accessibilitySupport === 0 /* Unknown */);\n            },\n            deduceModelPosition: (viewAnchorPosition, deltaOffset, lineFeedCnt) => {\n                return this._context.viewModel.deduceModelPositionRelativeToViewPosition(viewAnchorPosition, deltaOffset, lineFeedCnt);\n            }\n        };\n        const textAreaWrapper = this._register(new TextAreaWrapper(this.textArea.domNode));\n        this._textAreaInput = this._register(new TextAreaInput(textAreaInputHost, textAreaWrapper, platform.OS, browser));\n        this._register(this._textAreaInput.onKeyDown((e) => {\n            this._viewController.emitKeyDown(e);\n        }));\n        this._register(this._textAreaInput.onKeyUp((e) => {\n            this._viewController.emitKeyUp(e);\n        }));\n        this._register(this._textAreaInput.onPaste((e) => {\n            let pasteOnNewLine = false;\n            let multicursorText = null;\n            let mode = null;\n            if (e.metadata) {\n                pasteOnNewLine = (this._emptySelectionClipboard && !!e.metadata.isFromEmptySelection);\n                multicursorText = (typeof e.metadata.multicursorText !== 'undefined' ? e.metadata.multicursorText : null);\n                mode = e.metadata.mode;\n            }\n            this._viewController.paste(e.text, pasteOnNewLine, multicursorText, mode);\n        }));\n        this._register(this._textAreaInput.onCut(() => {\n            this._viewController.cut();\n        }));\n        this._register(this._textAreaInput.onType((e) => {\n            if (e.replacePrevCharCnt || e.replaceNextCharCnt || e.positionDelta) {\n                // must be handled through the new command\n                if (_debugComposition) {\n                    console.log(` => compositionType: <<${e.text}>>, ${e.replacePrevCharCnt}, ${e.replaceNextCharCnt}, ${e.positionDelta}`);\n                }\n                this._viewController.compositionType(e.text, e.replacePrevCharCnt, e.replaceNextCharCnt, e.positionDelta);\n            }\n            else {\n                if (_debugComposition) {\n                    console.log(` => type: <<${e.text}>>`);\n                }\n                this._viewController.type(e.text);\n            }\n        }));\n        this._register(this._textAreaInput.onSelectionChangeRequest((modelSelection) => {\n            this._viewController.setSelection(modelSelection);\n        }));\n        this._register(this._textAreaInput.onCompositionStart((e) => {\n            // The textarea might contain some content when composition starts.\n            //\n            // When we make the textarea visible, it always has a height of 1 line,\n            // so we don't need to worry too much about content on lines above or below\n            // the selection.\n            //\n            // However, the text on the current line needs to be made visible because\n            // some IME methods allow to move to other glyphs on the current line\n            // (by pressing arrow keys).\n            //\n            // (1) The textarea might contain only some parts of the current line,\n            // like the word before the selection. Also, the content inside the textarea\n            // can grow or shrink as composition occurs. We therefore anchor the textarea\n            // in terms of distance to a certain line start and line end.\n            //\n            // (2) Also, we should not make \\t characters visible, because their rendering\n            // inside the <textarea> will not align nicely with our rendering. We therefore\n            // will hide (if necessary) some of the leading text on the current line.\n            const ta = this.textArea.domNode;\n            const modelSelection = this._modelSelections[0];\n            const { distanceToModelLineStart, widthOfHiddenTextBefore } = (() => {\n                // Find the text that is on the current line before the selection\n                const textBeforeSelection = ta.value.substring(0, Math.min(ta.selectionStart, ta.selectionEnd));\n                const lineFeedOffset1 = textBeforeSelection.lastIndexOf('\\n');\n                const lineTextBeforeSelection = textBeforeSelection.substring(lineFeedOffset1 + 1);\n                // We now search to see if we should hide some part of it (if it contains \\t)\n                const tabOffset1 = lineTextBeforeSelection.lastIndexOf('\\t');\n                const desiredVisibleBeforeCharCount = lineTextBeforeSelection.length - tabOffset1 - 1;\n                const startModelPosition = modelSelection.getStartPosition();\n                const visibleBeforeCharCount = Math.min(startModelPosition.column - 1, desiredVisibleBeforeCharCount);\n                const distanceToModelLineStart = startModelPosition.column - 1 - visibleBeforeCharCount;\n                const hiddenLineTextBefore = lineTextBeforeSelection.substring(0, lineTextBeforeSelection.length - visibleBeforeCharCount);\n                const widthOfHiddenTextBefore = measureText(hiddenLineTextBefore, this._fontInfo);\n                return { distanceToModelLineStart, widthOfHiddenTextBefore };\n            })();\n            const { distanceToModelLineEnd } = (() => {\n                // Find the text that is on the current line after the selection\n                const textAfterSelection = ta.value.substring(Math.max(ta.selectionStart, ta.selectionEnd));\n                const lineFeedOffset2 = textAfterSelection.indexOf('\\n');\n                const lineTextAfterSelection = lineFeedOffset2 === -1 ? textAfterSelection : textAfterSelection.substring(0, lineFeedOffset2);\n                const tabOffset2 = lineTextAfterSelection.indexOf('\\t');\n                const desiredVisibleAfterCharCount = (tabOffset2 === -1 ? lineTextAfterSelection.length : lineTextAfterSelection.length - tabOffset2 - 1);\n                const endModelPosition = modelSelection.getEndPosition();\n                const visibleAfterCharCount = Math.min(this._context.viewModel.model.getLineMaxColumn(endModelPosition.lineNumber) - endModelPosition.column, desiredVisibleAfterCharCount);\n                const distanceToModelLineEnd = this._context.viewModel.model.getLineMaxColumn(endModelPosition.lineNumber) - endModelPosition.column - visibleAfterCharCount;\n                return { distanceToModelLineEnd };\n            })();\n            // Scroll to reveal the location in the editor where composition occurs\n            this._context.viewModel.revealRange('keyboard', true, Range.fromPositions(this._selections[0].getStartPosition()), 0 /* Simple */, 1 /* Immediate */);\n            this._visibleTextArea = new VisibleTextAreaData(this._context, modelSelection.startLineNumber, distanceToModelLineStart, widthOfHiddenTextBefore, distanceToModelLineEnd);\n            this._visibleTextArea.prepareRender(this._visibleRangeProvider);\n            this._render();\n            // Show the textarea\n            this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME} ime-input`);\n            this._viewController.compositionStart();\n            this._context.viewModel.onCompositionStart();\n        }));\n        this._register(this._textAreaInput.onCompositionUpdate((e) => {\n            if (!this._visibleTextArea) {\n                return;\n            }\n            this._visibleTextArea.prepareRender(this._visibleRangeProvider);\n            this._render();\n        }));\n        this._register(this._textAreaInput.onCompositionEnd(() => {\n            this._visibleTextArea = null;\n            this._render();\n            this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`);\n            this._viewController.compositionEnd();\n            this._context.viewModel.onCompositionEnd();\n        }));\n        this._register(this._textAreaInput.onFocus(() => {\n            this._context.viewModel.setHasFocus(true);\n        }));\n        this._register(this._textAreaInput.onBlur(() => {\n            this._context.viewModel.setHasFocus(false);\n        }));\n    }\n    dispose() {\n        super.dispose();\n    }\n    _getAndroidWordAtPosition(position) {\n        const ANDROID_WORD_SEPARATORS = '`~!@#$%^&*()-=+[{]}\\\\|;:\",.<>/?';\n        const lineContent = this._context.viewModel.getLineContent(position.lineNumber);\n        const wordSeparators = getMapForWordSeparators(ANDROID_WORD_SEPARATORS);\n        let goingLeft = true;\n        let startColumn = position.column;\n        let goingRight = true;\n        let endColumn = position.column;\n        let distance = 0;\n        while (distance < 50 && (goingLeft || goingRight)) {\n            if (goingLeft && startColumn <= 1) {\n                goingLeft = false;\n            }\n            if (goingLeft) {\n                const charCode = lineContent.charCodeAt(startColumn - 2);\n                const charClass = wordSeparators.get(charCode);\n                if (charClass !== 0 /* Regular */) {\n                    goingLeft = false;\n                }\n                else {\n                    startColumn--;\n                }\n            }\n            if (goingRight && endColumn > lineContent.length) {\n                goingRight = false;\n            }\n            if (goingRight) {\n                const charCode = lineContent.charCodeAt(endColumn - 1);\n                const charClass = wordSeparators.get(charCode);\n                if (charClass !== 0 /* Regular */) {\n                    goingRight = false;\n                }\n                else {\n                    endColumn++;\n                }\n            }\n            distance++;\n        }\n        return [lineContent.substring(startColumn - 1, endColumn - 1), position.column - startColumn];\n    }\n    _getWordBeforePosition(position) {\n        const lineContent = this._context.viewModel.getLineContent(position.lineNumber);\n        const wordSeparators = getMapForWordSeparators(this._context.configuration.options.get(117 /* wordSeparators */));\n        let column = position.column;\n        let distance = 0;\n        while (column > 1) {\n            const charCode = lineContent.charCodeAt(column - 2);\n            const charClass = wordSeparators.get(charCode);\n            if (charClass !== 0 /* Regular */ || distance > 50) {\n                return lineContent.substring(column - 1, position.column - 1);\n            }\n            distance++;\n            column--;\n        }\n        return lineContent.substring(0, position.column - 1);\n    }\n    _getCharacterBeforePosition(position) {\n        if (position.column > 1) {\n            const lineContent = this._context.viewModel.getLineContent(position.lineNumber);\n            const charBefore = lineContent.charAt(position.column - 2);\n            if (!strings.isHighSurrogate(charBefore.charCodeAt(0))) {\n                return charBefore;\n            }\n        }\n        return '';\n    }\n    _getAriaLabel(options) {\n        const accessibilitySupport = options.get(2 /* accessibilitySupport */);\n        if (accessibilitySupport === 1 /* Disabled */) {\n            return nls.localize('accessibilityOffAriaLabel', \"The editor is not accessible at this time. Press {0} for options.\", platform.isLinux ? 'Shift+Alt+F1' : 'Alt+F1');\n        }\n        return options.get(4 /* ariaLabel */);\n    }\n    _setAccessibilityOptions(options) {\n        this._accessibilitySupport = options.get(2 /* accessibilitySupport */);\n        const accessibilityPageSize = options.get(3 /* accessibilityPageSize */);\n        if (this._accessibilitySupport === 2 /* Enabled */ && accessibilityPageSize === EditorOptions.accessibilityPageSize.defaultValue) {\n            // If a screen reader is attached and the default value is not set we shuold automatically increase the page size to 500 for a better experience\n            this._accessibilityPageSize = 500;\n        }\n        else {\n            this._accessibilityPageSize = accessibilityPageSize;\n        }\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(131 /* layoutInfo */);\n        this._setAccessibilityOptions(options);\n        this._contentLeft = layoutInfo.contentLeft;\n        this._contentWidth = layoutInfo.contentWidth;\n        this._contentHeight = layoutInfo.height;\n        this._fontInfo = options.get(44 /* fontInfo */);\n        this._lineHeight = options.get(59 /* lineHeight */);\n        this._emptySelectionClipboard = options.get(32 /* emptySelectionClipboard */);\n        this._copyWithSyntaxHighlighting = options.get(21 /* copyWithSyntaxHighlighting */);\n        this.textArea.setAttribute('aria-label', this._getAriaLabel(options));\n        this.textArea.setAttribute('tabindex', String(options.get(112 /* tabIndex */)));\n        if (e.hasChanged(30 /* domReadOnly */) || e.hasChanged(81 /* readOnly */)) {\n            if (options.get(30 /* domReadOnly */) && options.get(81 /* readOnly */)) {\n                this.textArea.setAttribute('readonly', 'true');\n            }\n            else {\n                this.textArea.removeAttribute('readonly');\n            }\n        }\n        if (e.hasChanged(2 /* accessibilitySupport */)) {\n            this._textAreaInput.writeScreenReaderContent('strategy changed');\n        }\n        return true;\n    }\n    onCursorStateChanged(e) {\n        this._selections = e.selections.slice(0);\n        this._modelSelections = e.modelSelections.slice(0);\n        this._textAreaInput.writeScreenReaderContent('selection changed');\n        return true;\n    }\n    onDecorationsChanged(e) {\n        // true for inline decorations that can end up relayouting text\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        this._scrollLeft = e.scrollLeft;\n        this._scrollTop = e.scrollTop;\n        return true;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    // --- begin view API\n    isFocused() {\n        return this._textAreaInput.isFocused();\n    }\n    focusTextArea() {\n        this._textAreaInput.focusTextArea();\n    }\n    getLastRenderData() {\n        return this._lastRenderPosition;\n    }\n    setAriaOptions(options) {\n        if (options.activeDescendant) {\n            this.textArea.setAttribute('aria-haspopup', 'true');\n            this.textArea.setAttribute('aria-autocomplete', 'list');\n            this.textArea.setAttribute('aria-activedescendant', options.activeDescendant);\n        }\n        else {\n            this.textArea.setAttribute('aria-haspopup', 'false');\n            this.textArea.setAttribute('aria-autocomplete', 'both');\n            this.textArea.removeAttribute('aria-activedescendant');\n        }\n        if (options.role) {\n            this.textArea.setAttribute('role', options.role);\n        }\n    }\n    prepareRender(ctx) {\n        this._primaryCursorPosition = new Position(this._selections[0].positionLineNumber, this._selections[0].positionColumn);\n        this._primaryCursorVisibleRange = ctx.visibleRangeForPosition(this._primaryCursorPosition);\n        if (this._visibleTextArea) {\n            this._visibleTextArea.prepareRender(ctx);\n        }\n    }\n    render(ctx) {\n        this._textAreaInput.writeScreenReaderContent('render');\n        this._render();\n    }\n    _render() {\n        if (this._visibleTextArea) {\n            // The text area is visible for composition reasons\n            const visibleStart = this._visibleTextArea.visibleTextareaStart;\n            const visibleEnd = this._visibleTextArea.visibleTextareaEnd;\n            const startPosition = this._visibleTextArea.startPosition;\n            const endPosition = this._visibleTextArea.endPosition;\n            if (startPosition && endPosition && visibleStart && visibleEnd && visibleEnd.left >= this._scrollLeft && visibleStart.left <= this._scrollLeft + this._contentWidth) {\n                const top = (this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber) - this._scrollTop);\n                const lineCount = this._newlinecount(this.textArea.domNode.value.substr(0, this.textArea.domNode.selectionStart));\n                let scrollLeft = this._visibleTextArea.widthOfHiddenLineTextBefore;\n                let left = (this._contentLeft + visibleStart.left - this._scrollLeft);\n                // See https://github.com/microsoft/vscode/issues/141725#issuecomment-1050670841\n                // Here we are adding +1 to avoid flickering that might be caused by having a width that is too small.\n                // This could be caused by rounding errors that might only show up with certain font families.\n                // In other words, a pixel might be lost when doing something like\n                //      `Math.round(end) - Math.round(start)`\n                // vs\n                //      `Math.round(end - start)`\n                let width = visibleEnd.left - visibleStart.left + 1;\n                if (left < this._contentLeft) {\n                    // the textarea would be rendered on top of the margin,\n                    // so reduce its width. We use the same technique as\n                    // for hiding text before\n                    const delta = (this._contentLeft - left);\n                    left += delta;\n                    scrollLeft += delta;\n                    width -= delta;\n                }\n                if (width > this._contentWidth) {\n                    // the textarea would be wider than the content width,\n                    // so reduce its width.\n                    width = this._contentWidth;\n                }\n                // Try to render the textarea with the color/font style to match the text under it\n                const viewLineData = this._context.viewModel.getViewLineData(startPosition.lineNumber);\n                const startTokenIndex = viewLineData.tokens.findTokenIndexAtOffset(startPosition.column - 1);\n                const endTokenIndex = viewLineData.tokens.findTokenIndexAtOffset(endPosition.column - 1);\n                const textareaSpansSingleToken = (startTokenIndex === endTokenIndex);\n                const presentation = this._visibleTextArea.definePresentation((textareaSpansSingleToken ? viewLineData.tokens.getPresentation(startTokenIndex) : null));\n                this.textArea.domNode.scrollTop = lineCount * this._lineHeight;\n                this.textArea.domNode.scrollLeft = scrollLeft;\n                this._doRender({\n                    lastRenderPosition: null,\n                    top: top,\n                    left: left,\n                    width: width,\n                    height: this._lineHeight,\n                    useCover: false,\n                    color: (TokenizationRegistry.getColorMap() || [])[presentation.foreground],\n                    italic: presentation.italic,\n                    bold: presentation.bold,\n                    underline: presentation.underline,\n                    strikethrough: presentation.strikethrough\n                });\n            }\n            return;\n        }\n        if (!this._primaryCursorVisibleRange) {\n            // The primary cursor is outside the viewport => place textarea to the top left\n            this._renderAtTopLeft();\n            return;\n        }\n        const left = this._contentLeft + this._primaryCursorVisibleRange.left - this._scrollLeft;\n        if (left < this._contentLeft || left > this._contentLeft + this._contentWidth) {\n            // cursor is outside the viewport\n            this._renderAtTopLeft();\n            return;\n        }\n        const top = this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber) - this._scrollTop;\n        if (top < 0 || top > this._contentHeight) {\n            // cursor is outside the viewport\n            this._renderAtTopLeft();\n            return;\n        }\n        // The primary cursor is in the viewport (at least vertically) => place textarea on the cursor\n        if (platform.isMacintosh) {\n            // For the popup emoji input, we will make the text area as high as the line height\n            // We will also make the fontSize and lineHeight the correct dimensions to help with the placement of these pickers\n            this._doRender({\n                lastRenderPosition: this._primaryCursorPosition,\n                top: top,\n                left: left,\n                width: (canUseZeroSizeTextarea ? 0 : 1),\n                height: this._lineHeight,\n                useCover: false\n            });\n            // In case the textarea contains a word, we're going to try to align the textarea's cursor\n            // with our cursor by scrolling the textarea as much as possible\n            this.textArea.domNode.scrollLeft = this._primaryCursorVisibleRange.left;\n            const lineCount = this._newlinecount(this.textArea.domNode.value.substr(0, this.textArea.domNode.selectionStart));\n            this.textArea.domNode.scrollTop = lineCount * this._lineHeight;\n            return;\n        }\n        this._doRender({\n            lastRenderPosition: this._primaryCursorPosition,\n            top: top,\n            left: left,\n            width: (canUseZeroSizeTextarea ? 0 : 1),\n            height: (canUseZeroSizeTextarea ? 0 : 1),\n            useCover: false\n        });\n    }\n    _newlinecount(text) {\n        let result = 0;\n        let startIndex = -1;\n        do {\n            startIndex = text.indexOf('\\n', startIndex + 1);\n            if (startIndex === -1) {\n                break;\n            }\n            result++;\n        } while (true);\n        return result;\n    }\n    _renderAtTopLeft() {\n        // (in WebKit the textarea is 1px by 1px because it cannot handle input to a 0x0 textarea)\n        // specifically, when doing Korean IME, setting the textarea to 0x0 breaks IME badly.\n        this._doRender({\n            lastRenderPosition: null,\n            top: 0,\n            left: 0,\n            width: (canUseZeroSizeTextarea ? 0 : 1),\n            height: (canUseZeroSizeTextarea ? 0 : 1),\n            useCover: true\n        });\n    }\n    _doRender(renderData) {\n        this._lastRenderPosition = renderData.lastRenderPosition;\n        const ta = this.textArea;\n        const tac = this.textAreaCover;\n        applyFontInfo(ta, this._fontInfo);\n        ta.setTop(renderData.top);\n        ta.setLeft(renderData.left);\n        ta.setWidth(renderData.width);\n        ta.setHeight(renderData.height);\n        ta.setColor(renderData.color ? Color.Format.CSS.formatHex(renderData.color) : '');\n        ta.setFontStyle(renderData.italic ? 'italic' : '');\n        if (renderData.bold) {\n            // fontWeight is also set by `applyFontInfo`, so only overwrite it if necessary\n            ta.setFontWeight('bold');\n        }\n        ta.setTextDecoration(`${renderData.underline ? ' underline' : ''}${renderData.strikethrough ? ' line-through' : ''}`);\n        tac.setTop(renderData.useCover ? renderData.top : 0);\n        tac.setLeft(renderData.useCover ? renderData.left : 0);\n        tac.setWidth(renderData.useCover ? renderData.width : 0);\n        tac.setHeight(renderData.useCover ? renderData.height : 0);\n        const options = this._context.configuration.options;\n        if (options.get(50 /* glyphMargin */)) {\n            tac.setClassName('monaco-editor-background textAreaCover ' + Margin.OUTER_CLASS_NAME);\n        }\n        else {\n            if (options.get(60 /* lineNumbers */).renderType !== 0 /* Off */) {\n                tac.setClassName('monaco-editor-background textAreaCover ' + LineNumbersOverlay.CLASS_NAME);\n            }\n            else {\n                tac.setClassName('monaco-editor-background textAreaCover');\n            }\n        }\n    }\n}\nfunction measureText(text, fontInfo) {\n    if (text.length === 0) {\n        return 0;\n    }\n    const container = document.createElement('div');\n    container.style.position = 'absolute';\n    container.style.top = '-50000px';\n    container.style.width = '50000px';\n    const regularDomNode = document.createElement('span');\n    applyFontInfo(regularDomNode, fontInfo);\n    regularDomNode.style.whiteSpace = 'pre'; // just like the textarea\n    regularDomNode.append(text);\n    container.appendChild(regularDomNode);\n    document.body.appendChild(container);\n    const res = regularDomNode.offsetWidth;\n    document.body.removeChild(container);\n    return res;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as browser from '../../../base/browser/browser.js';\nimport * as dom from '../../../base/browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../base/browser/keyboardEvent.js';\nimport { RunOnceScheduler } from '../../../base/common/async.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { Mimes } from '../../../base/common/mime.js';\nimport * as strings from '../../../base/common/strings.js';\nimport { TextAreaState, _debugComposition } from './textAreaState.js';\nimport { Selection } from '../../common/core/selection.js';\nexport var TextAreaSyntethicEvents;\n(function (TextAreaSyntethicEvents) {\n    TextAreaSyntethicEvents.Tap = '-monaco-textarea-synthetic-tap';\n})(TextAreaSyntethicEvents || (TextAreaSyntethicEvents = {}));\nexport const CopyOptions = {\n    forceCopyWithSyntaxHighlighting: false\n};\n/**\n * Every time we write to the clipboard, we record a bit of extra metadata here.\n * Every time we read from the cipboard, if the text matches our last written text,\n * we can fetch the previous metadata.\n */\nexport class InMemoryClipboardMetadataManager {\n    constructor() {\n        this._lastState = null;\n    }\n    set(lastCopiedValue, data) {\n        this._lastState = { lastCopiedValue, data };\n    }\n    get(pastedText) {\n        if (this._lastState && this._lastState.lastCopiedValue === pastedText) {\n            // match!\n            return this._lastState.data;\n        }\n        this._lastState = null;\n        return null;\n    }\n}\nInMemoryClipboardMetadataManager.INSTANCE = new InMemoryClipboardMetadataManager();\nclass CompositionContext {\n    constructor() {\n        this._lastTypeTextLength = 0;\n    }\n    handleCompositionUpdate(text) {\n        text = text || '';\n        const typeInput = {\n            text: text,\n            replacePrevCharCnt: this._lastTypeTextLength,\n            replaceNextCharCnt: 0,\n            positionDelta: 0\n        };\n        this._lastTypeTextLength = text.length;\n        return typeInput;\n    }\n}\n/**\n * Writes screen reader content to the textarea and is able to analyze its input events to generate:\n *  - onCut\n *  - onPaste\n *  - onType\n *\n * Composition events are generated for presentation purposes (composition input is reflected in onType).\n */\nexport class TextAreaInput extends Disposable {\n    constructor(_host, _textArea, _OS, _browser) {\n        super();\n        this._host = _host;\n        this._textArea = _textArea;\n        this._OS = _OS;\n        this._browser = _browser;\n        this._onFocus = this._register(new Emitter());\n        this.onFocus = this._onFocus.event;\n        this._onBlur = this._register(new Emitter());\n        this.onBlur = this._onBlur.event;\n        this._onKeyDown = this._register(new Emitter());\n        this.onKeyDown = this._onKeyDown.event;\n        this._onKeyUp = this._register(new Emitter());\n        this.onKeyUp = this._onKeyUp.event;\n        this._onCut = this._register(new Emitter());\n        this.onCut = this._onCut.event;\n        this._onPaste = this._register(new Emitter());\n        this.onPaste = this._onPaste.event;\n        this._onType = this._register(new Emitter());\n        this.onType = this._onType.event;\n        this._onCompositionStart = this._register(new Emitter());\n        this.onCompositionStart = this._onCompositionStart.event;\n        this._onCompositionUpdate = this._register(new Emitter());\n        this.onCompositionUpdate = this._onCompositionUpdate.event;\n        this._onCompositionEnd = this._register(new Emitter());\n        this.onCompositionEnd = this._onCompositionEnd.event;\n        this._onSelectionChangeRequest = this._register(new Emitter());\n        this.onSelectionChangeRequest = this._onSelectionChangeRequest.event;\n        this._asyncTriggerCut = this._register(new RunOnceScheduler(() => this._onCut.fire(), 0));\n        this._asyncFocusGainWriteScreenReaderContent = this._register(new RunOnceScheduler(() => this.writeScreenReaderContent('asyncFocusGain'), 0));\n        this._textAreaState = TextAreaState.EMPTY;\n        this._selectionChangeListener = null;\n        this.writeScreenReaderContent('ctor');\n        this._hasFocus = false;\n        this._currentComposition = null;\n        let lastKeyDown = null;\n        this._register(this._textArea.onKeyDown((_e) => {\n            const e = new StandardKeyboardEvent(_e);\n            if (e.keyCode === 109 /* KEY_IN_COMPOSITION */\n                || (this._currentComposition && e.keyCode === 1 /* Backspace */)) {\n                // Stop propagation for keyDown events if the IME is processing key input\n                e.stopPropagation();\n            }\n            if (e.equals(9 /* Escape */)) {\n                // Prevent default always for `Esc`, otherwise it will generate a keypress\n                // See https://msdn.microsoft.com/en-us/library/ie/ms536939(v=vs.85).aspx\n                e.preventDefault();\n            }\n            lastKeyDown = e;\n            this._onKeyDown.fire(e);\n        }));\n        this._register(this._textArea.onKeyUp((_e) => {\n            const e = new StandardKeyboardEvent(_e);\n            this._onKeyUp.fire(e);\n        }));\n        this._register(this._textArea.onCompositionStart((e) => {\n            if (_debugComposition) {\n                console.log(`[compositionstart]`, e);\n            }\n            const currentComposition = new CompositionContext();\n            if (this._currentComposition) {\n                // simply reset the composition context\n                this._currentComposition = currentComposition;\n                return;\n            }\n            this._currentComposition = currentComposition;\n            if (this._OS === 2 /* Macintosh */\n                && lastKeyDown\n                && lastKeyDown.equals(109 /* KEY_IN_COMPOSITION */)\n                && this._textAreaState.selectionStart === this._textAreaState.selectionEnd\n                && this._textAreaState.selectionStart > 0\n                && this._textAreaState.value.substr(this._textAreaState.selectionStart - 1, 1) === e.data\n                && (lastKeyDown.code === 'ArrowRight' || lastKeyDown.code === 'ArrowLeft')) {\n                // Handling long press case on Chromium/Safari macOS + arrow key => pretend the character was selected\n                if (_debugComposition) {\n                    console.log(`[compositionstart] Handling long press case on macOS + arrow key`, e);\n                }\n                // Pretend the previous character was composed (in order to get it removed by subsequent compositionupdate events)\n                currentComposition.handleCompositionUpdate('x');\n                this._onCompositionStart.fire({ data: e.data });\n                return;\n            }\n            if (this._browser.isAndroid) {\n                // when tapping on the editor, Android enters composition mode to edit the current word\n                // so we cannot clear the textarea on Android and we must pretend the current word was selected\n                this._onCompositionStart.fire({ data: e.data });\n                return;\n            }\n            this._onCompositionStart.fire({ data: e.data });\n        }));\n        this._register(this._textArea.onCompositionUpdate((e) => {\n            if (_debugComposition) {\n                console.log(`[compositionupdate]`, e);\n            }\n            const currentComposition = this._currentComposition;\n            if (!currentComposition) {\n                // should not be possible to receive a 'compositionupdate' without a 'compositionstart'\n                return;\n            }\n            if (this._browser.isAndroid) {\n                // On Android, the data sent with the composition update event is unusable.\n                // For example, if the cursor is in the middle of a word like Mic|osoft\n                // and Microsoft is chosen from the keyboard's suggestions, the e.data will contain \"Microsoft\".\n                // This is not really usable because it doesn't tell us where the edit began and where it ended.\n                const newState = TextAreaState.readFromTextArea(this._textArea);\n                const typeInput = TextAreaState.deduceAndroidCompositionInput(this._textAreaState, newState);\n                this._textAreaState = newState;\n                this._onType.fire(typeInput);\n                this._onCompositionUpdate.fire(e);\n                return;\n            }\n            const typeInput = currentComposition.handleCompositionUpdate(e.data);\n            this._textAreaState = TextAreaState.readFromTextArea(this._textArea);\n            this._onType.fire(typeInput);\n            this._onCompositionUpdate.fire(e);\n        }));\n        this._register(this._textArea.onCompositionEnd((e) => {\n            if (_debugComposition) {\n                console.log(`[compositionend]`, e);\n            }\n            const currentComposition = this._currentComposition;\n            if (!currentComposition) {\n                // https://github.com/microsoft/monaco-editor/issues/1663\n                // On iOS 13.2, Chinese system IME randomly trigger an additional compositionend event with empty data\n                return;\n            }\n            this._currentComposition = null;\n            if (this._browser.isAndroid) {\n                // On Android, the data sent with the composition update event is unusable.\n                // For example, if the cursor is in the middle of a word like Mic|osoft\n                // and Microsoft is chosen from the keyboard's suggestions, the e.data will contain \"Microsoft\".\n                // This is not really usable because it doesn't tell us where the edit began and where it ended.\n                const newState = TextAreaState.readFromTextArea(this._textArea);\n                const typeInput = TextAreaState.deduceAndroidCompositionInput(this._textAreaState, newState);\n                this._textAreaState = newState;\n                this._onType.fire(typeInput);\n                this._onCompositionEnd.fire();\n                return;\n            }\n            const typeInput = currentComposition.handleCompositionUpdate(e.data);\n            this._textAreaState = TextAreaState.readFromTextArea(this._textArea);\n            this._onType.fire(typeInput);\n            this._onCompositionEnd.fire();\n        }));\n        this._register(this._textArea.onInput((e) => {\n            if (_debugComposition) {\n                console.log(`[input]`, e);\n            }\n            // Pretend here we touched the text area, as the `input` event will most likely\n            // result in a `selectionchange` event which we want to ignore\n            this._textArea.setIgnoreSelectionChangeTime('received input event');\n            if (this._currentComposition) {\n                return;\n            }\n            const newState = TextAreaState.readFromTextArea(this._textArea);\n            const typeInput = TextAreaState.deduceInput(this._textAreaState, newState, /*couldBeEmojiInput*/ this._OS === 2 /* Macintosh */);\n            if (typeInput.replacePrevCharCnt === 0 && typeInput.text.length === 1 && strings.isHighSurrogate(typeInput.text.charCodeAt(0))) {\n                // Ignore invalid input but keep it around for next time\n                return;\n            }\n            this._textAreaState = newState;\n            if (typeInput.text !== ''\n                || typeInput.replacePrevCharCnt !== 0\n                || typeInput.replaceNextCharCnt !== 0\n                || typeInput.positionDelta !== 0) {\n                this._onType.fire(typeInput);\n            }\n        }));\n        // --- Clipboard operations\n        this._register(this._textArea.onCut((e) => {\n            // Pretend here we touched the text area, as the `cut` event will most likely\n            // result in a `selectionchange` event which we want to ignore\n            this._textArea.setIgnoreSelectionChangeTime('received cut event');\n            this._ensureClipboardGetsEditorSelection(e);\n            this._asyncTriggerCut.schedule();\n        }));\n        this._register(this._textArea.onCopy((e) => {\n            this._ensureClipboardGetsEditorSelection(e);\n        }));\n        this._register(this._textArea.onPaste((e) => {\n            // Pretend here we touched the text area, as the `paste` event will most likely\n            // result in a `selectionchange` event which we want to ignore\n            this._textArea.setIgnoreSelectionChangeTime('received paste event');\n            e.preventDefault();\n            if (!e.clipboardData) {\n                return;\n            }\n            let [text, metadata] = ClipboardEventUtils.getTextData(e.clipboardData);\n            if (!text) {\n                return;\n            }\n            // try the in-memory store\n            metadata = metadata || InMemoryClipboardMetadataManager.INSTANCE.get(text);\n            this._onPaste.fire({\n                text: text,\n                metadata: metadata\n            });\n        }));\n        this._register(this._textArea.onFocus(() => {\n            const hadFocus = this._hasFocus;\n            this._setHasFocus(true);\n            if (this._browser.isSafari && !hadFocus && this._hasFocus) {\n                // When \"tabbing into\" the textarea, immediately after dispatching the 'focus' event,\n                // Safari will always move the selection at offset 0 in the textarea\n                this._asyncFocusGainWriteScreenReaderContent.schedule();\n            }\n        }));\n        this._register(this._textArea.onBlur(() => {\n            if (this._currentComposition) {\n                // See https://github.com/microsoft/vscode/issues/112621\n                // where compositionend is not triggered when the editor\n                // is taken off-dom during a composition\n                // Clear the flag to be able to write to the textarea\n                this._currentComposition = null;\n                // Clear the textarea to avoid an unwanted cursor type\n                this.writeScreenReaderContent('blurWithoutCompositionEnd');\n                // Fire artificial composition end\n                this._onCompositionEnd.fire();\n            }\n            this._setHasFocus(false);\n        }));\n        this._register(this._textArea.onSyntheticTap(() => {\n            if (this._browser.isAndroid && this._currentComposition) {\n                // on Android, tapping does not cancel the current composition, so the\n                // textarea is stuck showing the old composition\n                // Clear the flag to be able to write to the textarea\n                this._currentComposition = null;\n                // Clear the textarea to avoid an unwanted cursor type\n                this.writeScreenReaderContent('tapWithoutCompositionEnd');\n                // Fire artificial composition end\n                this._onCompositionEnd.fire();\n            }\n        }));\n    }\n    _installSelectionChangeListener() {\n        // See https://github.com/microsoft/vscode/issues/27216 and https://github.com/microsoft/vscode/issues/98256\n        // When using a Braille display, it is possible for users to reposition the\n        // system caret. This is reflected in Chrome as a `selectionchange` event.\n        //\n        // The `selectionchange` event appears to be emitted under numerous other circumstances,\n        // so it is quite a challenge to distinguish a `selectionchange` coming in from a user\n        // using a Braille display from all the other cases.\n        //\n        // The problems with the `selectionchange` event are:\n        //  * the event is emitted when the textarea is focused programmatically -- textarea.focus()\n        //  * the event is emitted when the selection is changed in the textarea programmatically -- textarea.setSelectionRange(...)\n        //  * the event is emitted when the value of the textarea is changed programmatically -- textarea.value = '...'\n        //  * the event is emitted when tabbing into the textarea\n        //  * the event is emitted asynchronously (sometimes with a delay as high as a few tens of ms)\n        //  * the event sometimes comes in bursts for a single logical textarea operation\n        // `selectionchange` events often come multiple times for a single logical change\n        // so throttle multiple `selectionchange` events that burst in a short period of time.\n        let previousSelectionChangeEventTime = 0;\n        return dom.addDisposableListener(document, 'selectionchange', (e) => {\n            if (!this._hasFocus) {\n                return;\n            }\n            if (this._currentComposition) {\n                return;\n            }\n            if (!this._browser.isChrome) {\n                // Support only for Chrome until testing happens on other browsers\n                return;\n            }\n            const now = Date.now();\n            const delta1 = now - previousSelectionChangeEventTime;\n            previousSelectionChangeEventTime = now;\n            if (delta1 < 5) {\n                // received another `selectionchange` event within 5ms of the previous `selectionchange` event\n                // => ignore it\n                return;\n            }\n            const delta2 = now - this._textArea.getIgnoreSelectionChangeTime();\n            this._textArea.resetSelectionChangeTime();\n            if (delta2 < 100) {\n                // received a `selectionchange` event within 100ms since we touched the textarea\n                // => ignore it, since we caused it\n                return;\n            }\n            if (!this._textAreaState.selectionStartPosition || !this._textAreaState.selectionEndPosition) {\n                // Cannot correlate a position in the textarea with a position in the editor...\n                return;\n            }\n            const newValue = this._textArea.getValue();\n            if (this._textAreaState.value !== newValue) {\n                // Cannot correlate a position in the textarea with a position in the editor...\n                return;\n            }\n            const newSelectionStart = this._textArea.getSelectionStart();\n            const newSelectionEnd = this._textArea.getSelectionEnd();\n            if (this._textAreaState.selectionStart === newSelectionStart && this._textAreaState.selectionEnd === newSelectionEnd) {\n                // Nothing to do...\n                return;\n            }\n            const _newSelectionStartPosition = this._textAreaState.deduceEditorPosition(newSelectionStart);\n            const newSelectionStartPosition = this._host.deduceModelPosition(_newSelectionStartPosition[0], _newSelectionStartPosition[1], _newSelectionStartPosition[2]);\n            const _newSelectionEndPosition = this._textAreaState.deduceEditorPosition(newSelectionEnd);\n            const newSelectionEndPosition = this._host.deduceModelPosition(_newSelectionEndPosition[0], _newSelectionEndPosition[1], _newSelectionEndPosition[2]);\n            const newSelection = new Selection(newSelectionStartPosition.lineNumber, newSelectionStartPosition.column, newSelectionEndPosition.lineNumber, newSelectionEndPosition.column);\n            this._onSelectionChangeRequest.fire(newSelection);\n        });\n    }\n    dispose() {\n        super.dispose();\n        if (this._selectionChangeListener) {\n            this._selectionChangeListener.dispose();\n            this._selectionChangeListener = null;\n        }\n    }\n    focusTextArea() {\n        // Setting this._hasFocus and writing the screen reader content\n        // will result in a focus() and setSelectionRange() in the textarea\n        this._setHasFocus(true);\n        // If the editor is off DOM, focus cannot be really set, so let's double check that we have managed to set the focus\n        this.refreshFocusState();\n    }\n    isFocused() {\n        return this._hasFocus;\n    }\n    refreshFocusState() {\n        this._setHasFocus(this._textArea.hasFocus());\n    }\n    _setHasFocus(newHasFocus) {\n        if (this._hasFocus === newHasFocus) {\n            // no change\n            return;\n        }\n        this._hasFocus = newHasFocus;\n        if (this._selectionChangeListener) {\n            this._selectionChangeListener.dispose();\n            this._selectionChangeListener = null;\n        }\n        if (this._hasFocus) {\n            this._selectionChangeListener = this._installSelectionChangeListener();\n        }\n        if (this._hasFocus) {\n            this.writeScreenReaderContent('focusgain');\n        }\n        if (this._hasFocus) {\n            this._onFocus.fire();\n        }\n        else {\n            this._onBlur.fire();\n        }\n    }\n    _setAndWriteTextAreaState(reason, textAreaState) {\n        if (!this._hasFocus) {\n            textAreaState = textAreaState.collapseSelection();\n        }\n        textAreaState.writeToTextArea(reason, this._textArea, this._hasFocus);\n        this._textAreaState = textAreaState;\n    }\n    writeScreenReaderContent(reason) {\n        if (this._currentComposition) {\n            // Do not write to the text area when doing composition\n            return;\n        }\n        this._setAndWriteTextAreaState(reason, this._host.getScreenReaderContent(this._textAreaState));\n    }\n    _ensureClipboardGetsEditorSelection(e) {\n        const dataToCopy = this._host.getDataToCopy();\n        const storedMetadata = {\n            version: 1,\n            isFromEmptySelection: dataToCopy.isFromEmptySelection,\n            multicursorText: dataToCopy.multicursorText,\n            mode: dataToCopy.mode\n        };\n        InMemoryClipboardMetadataManager.INSTANCE.set(\n        // When writing \"LINE\\r\\n\" to the clipboard and then pasting,\n        // Firefox pastes \"LINE\\n\", so let's work around this quirk\n        (this._browser.isFirefox ? dataToCopy.text.replace(/\\r\\n/g, '\\n') : dataToCopy.text), storedMetadata);\n        e.preventDefault();\n        if (e.clipboardData) {\n            ClipboardEventUtils.setTextData(e.clipboardData, dataToCopy.text, dataToCopy.html, storedMetadata);\n        }\n    }\n}\nclass ClipboardEventUtils {\n    static getTextData(clipboardData) {\n        const text = clipboardData.getData(Mimes.text);\n        let metadata = null;\n        const rawmetadata = clipboardData.getData('vscode-editor-data');\n        if (typeof rawmetadata === 'string') {\n            try {\n                metadata = JSON.parse(rawmetadata);\n                if (metadata.version !== 1) {\n                    metadata = null;\n                }\n            }\n            catch (err) {\n                // no problem!\n            }\n        }\n        return [text, metadata];\n    }\n    static setTextData(clipboardData, text, html, metadata) {\n        clipboardData.setData(Mimes.text, text);\n        if (typeof html === 'string') {\n            clipboardData.setData('text/html', html);\n        }\n        clipboardData.setData('vscode-editor-data', JSON.stringify(metadata));\n    }\n}\nexport class TextAreaWrapper extends Disposable {\n    constructor(_actual) {\n        super();\n        this._actual = _actual;\n        this.onKeyDown = this._register(dom.createEventEmitter(this._actual, 'keydown')).event;\n        this.onKeyUp = this._register(dom.createEventEmitter(this._actual, 'keyup')).event;\n        this.onCompositionStart = this._register(dom.createEventEmitter(this._actual, 'compositionstart')).event;\n        this.onCompositionUpdate = this._register(dom.createEventEmitter(this._actual, 'compositionupdate')).event;\n        this.onCompositionEnd = this._register(dom.createEventEmitter(this._actual, 'compositionend')).event;\n        this.onInput = this._register(dom.createEventEmitter(this._actual, 'input')).event;\n        this.onCut = this._register(dom.createEventEmitter(this._actual, 'cut')).event;\n        this.onCopy = this._register(dom.createEventEmitter(this._actual, 'copy')).event;\n        this.onPaste = this._register(dom.createEventEmitter(this._actual, 'paste')).event;\n        this.onFocus = this._register(dom.createEventEmitter(this._actual, 'focus')).event;\n        this.onBlur = this._register(dom.createEventEmitter(this._actual, 'blur')).event;\n        this._onSyntheticTap = this._register(new Emitter());\n        this.onSyntheticTap = this._onSyntheticTap.event;\n        this._ignoreSelectionChangeTime = 0;\n        this._register(dom.addDisposableListener(this._actual, TextAreaSyntethicEvents.Tap, () => this._onSyntheticTap.fire()));\n    }\n    hasFocus() {\n        const shadowRoot = dom.getShadowRoot(this._actual);\n        if (shadowRoot) {\n            return shadowRoot.activeElement === this._actual;\n        }\n        else if (dom.isInDOM(this._actual)) {\n            return document.activeElement === this._actual;\n        }\n        else {\n            return false;\n        }\n    }\n    setIgnoreSelectionChangeTime(reason) {\n        this._ignoreSelectionChangeTime = Date.now();\n    }\n    getIgnoreSelectionChangeTime() {\n        return this._ignoreSelectionChangeTime;\n    }\n    resetSelectionChangeTime() {\n        this._ignoreSelectionChangeTime = 0;\n    }\n    getValue() {\n        // console.log('current value: ' + this._textArea.value);\n        return this._actual.value;\n    }\n    setValue(reason, value) {\n        const textArea = this._actual;\n        if (textArea.value === value) {\n            // No change\n            return;\n        }\n        // console.log('reason: ' + reason + ', current value: ' + textArea.value + ' => new value: ' + value);\n        this.setIgnoreSelectionChangeTime('setValue');\n        textArea.value = value;\n    }\n    getSelectionStart() {\n        return this._actual.selectionDirection === 'backward' ? this._actual.selectionEnd : this._actual.selectionStart;\n    }\n    getSelectionEnd() {\n        return this._actual.selectionDirection === 'backward' ? this._actual.selectionStart : this._actual.selectionEnd;\n    }\n    setSelectionRange(reason, selectionStart, selectionEnd) {\n        const textArea = this._actual;\n        let activeElement = null;\n        const shadowRoot = dom.getShadowRoot(textArea);\n        if (shadowRoot) {\n            activeElement = shadowRoot.activeElement;\n        }\n        else {\n            activeElement = document.activeElement;\n        }\n        const currentIsFocused = (activeElement === textArea);\n        const currentSelectionStart = textArea.selectionStart;\n        const currentSelectionEnd = textArea.selectionEnd;\n        if (currentIsFocused && currentSelectionStart === selectionStart && currentSelectionEnd === selectionEnd) {\n            // No change\n            // Firefox iframe bug https://github.com/microsoft/monaco-editor/issues/643#issuecomment-367871377\n            if (browser.isFirefox && window.parent !== window) {\n                textArea.focus();\n            }\n            return;\n        }\n        // console.log('reason: ' + reason + ', setSelectionRange: ' + selectionStart + ' -> ' + selectionEnd);\n        if (currentIsFocused) {\n            // No need to focus, only need to change the selection range\n            this.setIgnoreSelectionChangeTime('setSelectionRange');\n            textArea.setSelectionRange(selectionStart, selectionEnd);\n            if (browser.isFirefox && window.parent !== window) {\n                textArea.focus();\n            }\n            return;\n        }\n        // If the focus is outside the textarea, browsers will try really hard to reveal the textarea.\n        // Here, we try to undo the browser's desperate reveal.\n        try {\n            const scrollState = dom.saveParentsScrollTop(textArea);\n            this.setIgnoreSelectionChangeTime('setSelectionRange');\n            textArea.focus();\n            textArea.setSelectionRange(selectionStart, selectionEnd);\n            dom.restoreParentsScrollTop(textArea, scrollState);\n        }\n        catch (e) {\n            // Sometimes IE throws when setting selection (e.g. textarea is off-DOM)\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from '../../../base/common/strings.js';\nimport { Position } from '../../common/core/position.js';\nimport { Range } from '../../common/core/range.js';\nexport const _debugComposition = false;\nexport class TextAreaState {\n    constructor(value, selectionStart, selectionEnd, selectionStartPosition, selectionEndPosition) {\n        this.value = value;\n        this.selectionStart = selectionStart;\n        this.selectionEnd = selectionEnd;\n        this.selectionStartPosition = selectionStartPosition;\n        this.selectionEndPosition = selectionEndPosition;\n    }\n    toString() {\n        return `[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`;\n    }\n    static readFromTextArea(textArea) {\n        return new TextAreaState(textArea.getValue(), textArea.getSelectionStart(), textArea.getSelectionEnd(), null, null);\n    }\n    collapseSelection() {\n        return new TextAreaState(this.value, this.value.length, this.value.length, null, null);\n    }\n    writeToTextArea(reason, textArea, select) {\n        if (_debugComposition) {\n            console.log(`writeToTextArea ${reason}: ${this.toString()}`);\n        }\n        textArea.setValue(reason, this.value);\n        if (select) {\n            textArea.setSelectionRange(reason, this.selectionStart, this.selectionEnd);\n        }\n    }\n    deduceEditorPosition(offset) {\n        if (offset <= this.selectionStart) {\n            const str = this.value.substring(offset, this.selectionStart);\n            return this._finishDeduceEditorPosition(this.selectionStartPosition, str, -1);\n        }\n        if (offset >= this.selectionEnd) {\n            const str = this.value.substring(this.selectionEnd, offset);\n            return this._finishDeduceEditorPosition(this.selectionEndPosition, str, 1);\n        }\n        const str1 = this.value.substring(this.selectionStart, offset);\n        if (str1.indexOf(String.fromCharCode(8230)) === -1) {\n            return this._finishDeduceEditorPosition(this.selectionStartPosition, str1, 1);\n        }\n        const str2 = this.value.substring(offset, this.selectionEnd);\n        return this._finishDeduceEditorPosition(this.selectionEndPosition, str2, -1);\n    }\n    _finishDeduceEditorPosition(anchor, deltaText, signum) {\n        let lineFeedCnt = 0;\n        let lastLineFeedIndex = -1;\n        while ((lastLineFeedIndex = deltaText.indexOf('\\n', lastLineFeedIndex + 1)) !== -1) {\n            lineFeedCnt++;\n        }\n        return [anchor, signum * deltaText.length, lineFeedCnt];\n    }\n    static deduceInput(previousState, currentState, couldBeEmojiInput) {\n        if (!previousState) {\n            // This is the EMPTY state\n            return {\n                text: '',\n                replacePrevCharCnt: 0,\n                replaceNextCharCnt: 0,\n                positionDelta: 0\n            };\n        }\n        if (_debugComposition) {\n            console.log('------------------------deduceInput');\n            console.log(`PREVIOUS STATE: ${previousState.toString()}`);\n            console.log(`CURRENT STATE: ${currentState.toString()}`);\n        }\n        const prefixLength = Math.min(strings.commonPrefixLength(previousState.value, currentState.value), previousState.selectionStart, currentState.selectionStart);\n        const suffixLength = Math.min(strings.commonSuffixLength(previousState.value, currentState.value), previousState.value.length - previousState.selectionEnd, currentState.value.length - currentState.selectionEnd);\n        const previousValue = previousState.value.substring(prefixLength, previousState.value.length - suffixLength);\n        const currentValue = currentState.value.substring(prefixLength, currentState.value.length - suffixLength);\n        const previousSelectionStart = previousState.selectionStart - prefixLength;\n        const previousSelectionEnd = previousState.selectionEnd - prefixLength;\n        const currentSelectionStart = currentState.selectionStart - prefixLength;\n        const currentSelectionEnd = currentState.selectionEnd - prefixLength;\n        if (_debugComposition) {\n            console.log(`AFTER DIFFING PREVIOUS STATE: <${previousValue}>, selectionStart: ${previousSelectionStart}, selectionEnd: ${previousSelectionEnd}`);\n            console.log(`AFTER DIFFING CURRENT STATE: <${currentValue}>, selectionStart: ${currentSelectionStart}, selectionEnd: ${currentSelectionEnd}`);\n        }\n        if (currentSelectionStart === currentSelectionEnd) {\n            // no current selection\n            const replacePreviousCharacters = (previousState.selectionStart - prefixLength);\n            if (_debugComposition) {\n                console.log(`REMOVE PREVIOUS: ${replacePreviousCharacters} chars`);\n            }\n            return {\n                text: currentValue,\n                replacePrevCharCnt: replacePreviousCharacters,\n                replaceNextCharCnt: 0,\n                positionDelta: 0\n            };\n        }\n        // there is a current selection => composition case\n        const replacePreviousCharacters = previousSelectionEnd - previousSelectionStart;\n        return {\n            text: currentValue,\n            replacePrevCharCnt: replacePreviousCharacters,\n            replaceNextCharCnt: 0,\n            positionDelta: 0\n        };\n    }\n    static deduceAndroidCompositionInput(previousState, currentState) {\n        if (!previousState) {\n            // This is the EMPTY state\n            return {\n                text: '',\n                replacePrevCharCnt: 0,\n                replaceNextCharCnt: 0,\n                positionDelta: 0\n            };\n        }\n        if (_debugComposition) {\n            console.log('------------------------deduceAndroidCompositionInput');\n            console.log(`PREVIOUS STATE: ${previousState.toString()}`);\n            console.log(`CURRENT STATE: ${currentState.toString()}`);\n        }\n        if (previousState.value === currentState.value) {\n            return {\n                text: '',\n                replacePrevCharCnt: 0,\n                replaceNextCharCnt: 0,\n                positionDelta: currentState.selectionEnd - previousState.selectionEnd\n            };\n        }\n        const prefixLength = Math.min(strings.commonPrefixLength(previousState.value, currentState.value), previousState.selectionEnd);\n        const suffixLength = Math.min(strings.commonSuffixLength(previousState.value, currentState.value), previousState.value.length - previousState.selectionEnd);\n        const previousValue = previousState.value.substring(prefixLength, previousState.value.length - suffixLength);\n        const currentValue = currentState.value.substring(prefixLength, currentState.value.length - suffixLength);\n        const previousSelectionStart = previousState.selectionStart - prefixLength;\n        const previousSelectionEnd = previousState.selectionEnd - prefixLength;\n        const currentSelectionStart = currentState.selectionStart - prefixLength;\n        const currentSelectionEnd = currentState.selectionEnd - prefixLength;\n        if (_debugComposition) {\n            console.log(`AFTER DIFFING PREVIOUS STATE: <${previousValue}>, selectionStart: ${previousSelectionStart}, selectionEnd: ${previousSelectionEnd}`);\n            console.log(`AFTER DIFFING CURRENT STATE: <${currentValue}>, selectionStart: ${currentSelectionStart}, selectionEnd: ${currentSelectionEnd}`);\n        }\n        return {\n            text: currentValue,\n            replacePrevCharCnt: previousSelectionEnd,\n            replaceNextCharCnt: previousValue.length - previousSelectionEnd,\n            positionDelta: currentSelectionEnd - currentValue.length\n        };\n    }\n}\nTextAreaState.EMPTY = new TextAreaState('', 0, 0, null, null);\nexport class PagedScreenReaderStrategy {\n    static _getPageOfLine(lineNumber, linesPerPage) {\n        return Math.floor((lineNumber - 1) / linesPerPage);\n    }\n    static _getRangeForPage(page, linesPerPage) {\n        const offset = page * linesPerPage;\n        const startLineNumber = offset + 1;\n        const endLineNumber = offset + linesPerPage;\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n    }\n    static fromEditorSelection(previousState, model, selection, linesPerPage, trimLongText) {\n        const selectionStartPage = PagedScreenReaderStrategy._getPageOfLine(selection.startLineNumber, linesPerPage);\n        const selectionStartPageRange = PagedScreenReaderStrategy._getRangeForPage(selectionStartPage, linesPerPage);\n        const selectionEndPage = PagedScreenReaderStrategy._getPageOfLine(selection.endLineNumber, linesPerPage);\n        const selectionEndPageRange = PagedScreenReaderStrategy._getRangeForPage(selectionEndPage, linesPerPage);\n        const pretextRange = selectionStartPageRange.intersectRanges(new Range(1, 1, selection.startLineNumber, selection.startColumn));\n        let pretext = model.getValueInRange(pretextRange, 1 /* LF */);\n        const lastLine = model.getLineCount();\n        const lastLineMaxColumn = model.getLineMaxColumn(lastLine);\n        const posttextRange = selectionEndPageRange.intersectRanges(new Range(selection.endLineNumber, selection.endColumn, lastLine, lastLineMaxColumn));\n        let posttext = model.getValueInRange(posttextRange, 1 /* LF */);\n        let text;\n        if (selectionStartPage === selectionEndPage || selectionStartPage + 1 === selectionEndPage) {\n            // take full selection\n            text = model.getValueInRange(selection, 1 /* LF */);\n        }\n        else {\n            const selectionRange1 = selectionStartPageRange.intersectRanges(selection);\n            const selectionRange2 = selectionEndPageRange.intersectRanges(selection);\n            text = (model.getValueInRange(selectionRange1, 1 /* LF */)\n                + String.fromCharCode(8230)\n                + model.getValueInRange(selectionRange2, 1 /* LF */));\n        }\n        // Chromium handles very poorly text even of a few thousand chars\n        // Cut text to avoid stalling the entire UI\n        if (trimLongText) {\n            const LIMIT_CHARS = 500;\n            if (pretext.length > LIMIT_CHARS) {\n                pretext = pretext.substring(pretext.length - LIMIT_CHARS, pretext.length);\n            }\n            if (posttext.length > LIMIT_CHARS) {\n                posttext = posttext.substring(0, LIMIT_CHARS);\n            }\n            if (text.length > 2 * LIMIT_CHARS) {\n                text = text.substring(0, LIMIT_CHARS) + String.fromCharCode(8230) + text.substring(text.length - LIMIT_CHARS, text.length);\n            }\n        }\n        return new TextAreaState(pretext + text + posttext, pretext.length, pretext.length + text.length, new Position(selection.startLineNumber, selection.startColumn), new Position(selection.endLineNumber, selection.endColumn));\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as nls from '../../nls.js';\nimport { isFirefox } from '../../base/browser/browser.js';\nimport * as types from '../../base/common/types.js';\nimport { status } from '../../base/browser/ui/aria/aria.js';\nimport { Command, EditorCommand, registerEditorCommand, UndoCommand, RedoCommand, SelectAllCommand } from './editorExtensions.js';\nimport { ICodeEditorService } from './services/codeEditorService.js';\nimport { ColumnSelection } from '../common/cursor/cursorColumnSelection.js';\nimport { CursorState } from '../common/cursorCommon.js';\nimport { DeleteOperations } from '../common/cursor/cursorDeleteOperations.js';\nimport { CursorMove as CursorMove_, CursorMoveCommands } from '../common/cursor/cursorMoveCommands.js';\nimport { TypeOperations } from '../common/cursor/cursorTypeOperations.js';\nimport { Position } from '../common/core/position.js';\nimport { Range } from '../common/core/range.js';\nimport { EditorContextKeys } from '../common/editorContextKeys.js';\nimport { ContextKeyExpr } from '../../platform/contextkey/common/contextkey.js';\nimport { KeybindingsRegistry } from '../../platform/keybinding/common/keybindingsRegistry.js';\nconst CORE_WEIGHT = 0 /* EditorCore */;\nexport class CoreEditorCommand extends EditorCommand {\n    runEditorCommand(accessor, editor, args) {\n        const viewModel = editor._getViewModel();\n        if (!viewModel) {\n            // the editor has no view => has no cursors\n            return;\n        }\n        this.runCoreEditorCommand(viewModel, args || {});\n    }\n}\nexport var EditorScroll_;\n(function (EditorScroll_) {\n    const isEditorScrollArgs = function (arg) {\n        if (!types.isObject(arg)) {\n            return false;\n        }\n        const scrollArg = arg;\n        if (!types.isString(scrollArg.to)) {\n            return false;\n        }\n        if (!types.isUndefined(scrollArg.by) && !types.isString(scrollArg.by)) {\n            return false;\n        }\n        if (!types.isUndefined(scrollArg.value) && !types.isNumber(scrollArg.value)) {\n            return false;\n        }\n        if (!types.isUndefined(scrollArg.revealCursor) && !types.isBoolean(scrollArg.revealCursor)) {\n            return false;\n        }\n        return true;\n    };\n    EditorScroll_.description = {\n        description: 'Scroll editor in the given direction',\n        args: [\n            {\n                name: 'Editor scroll argument object',\n                description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory direction value.\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t\t'up', 'down'\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t\t'line', 'wrappedLine', 'page', 'halfPage'\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n\t\t\t\t`,\n                constraint: isEditorScrollArgs,\n                schema: {\n                    'type': 'object',\n                    'required': ['to'],\n                    'properties': {\n                        'to': {\n                            'type': 'string',\n                            'enum': ['up', 'down']\n                        },\n                        'by': {\n                            'type': 'string',\n                            'enum': ['line', 'wrappedLine', 'page', 'halfPage']\n                        },\n                        'value': {\n                            'type': 'number',\n                            'default': 1\n                        },\n                        'revealCursor': {\n                            'type': 'boolean',\n                        }\n                    }\n                }\n            }\n        ]\n    };\n    /**\n     * Directions in the view for editor scroll command.\n     */\n    EditorScroll_.RawDirection = {\n        Up: 'up',\n        Down: 'down',\n    };\n    /**\n     * Units for editor scroll 'by' argument\n     */\n    EditorScroll_.RawUnit = {\n        Line: 'line',\n        WrappedLine: 'wrappedLine',\n        Page: 'page',\n        HalfPage: 'halfPage'\n    };\n    function parse(args) {\n        let direction;\n        switch (args.to) {\n            case EditorScroll_.RawDirection.Up:\n                direction = 1 /* Up */;\n                break;\n            case EditorScroll_.RawDirection.Down:\n                direction = 2 /* Down */;\n                break;\n            default:\n                // Illegal arguments\n                return null;\n        }\n        let unit;\n        switch (args.by) {\n            case EditorScroll_.RawUnit.Line:\n                unit = 1 /* Line */;\n                break;\n            case EditorScroll_.RawUnit.WrappedLine:\n                unit = 2 /* WrappedLine */;\n                break;\n            case EditorScroll_.RawUnit.Page:\n                unit = 3 /* Page */;\n                break;\n            case EditorScroll_.RawUnit.HalfPage:\n                unit = 4 /* HalfPage */;\n                break;\n            default:\n                unit = 2 /* WrappedLine */;\n        }\n        const value = Math.floor(args.value || 1);\n        const revealCursor = !!args.revealCursor;\n        return {\n            direction: direction,\n            unit: unit,\n            value: value,\n            revealCursor: revealCursor,\n            select: (!!args.select)\n        };\n    }\n    EditorScroll_.parse = parse;\n})(EditorScroll_ || (EditorScroll_ = {}));\nexport var RevealLine_;\n(function (RevealLine_) {\n    const isRevealLineArgs = function (arg) {\n        if (!types.isObject(arg)) {\n            return false;\n        }\n        const reveaLineArg = arg;\n        if (!types.isNumber(reveaLineArg.lineNumber) && !types.isString(reveaLineArg.lineNumber)) {\n            return false;\n        }\n        if (!types.isUndefined(reveaLineArg.at) && !types.isString(reveaLineArg.at)) {\n            return false;\n        }\n        return true;\n    };\n    RevealLine_.description = {\n        description: 'Reveal the given line at the given logical position',\n        args: [\n            {\n                name: 'Reveal line argument object',\n                description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'lineNumber': A mandatory line number value.\n\t\t\t\t\t* 'at': Logical position at which line has to be revealed.\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t\t'top', 'center', 'bottom'\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t`,\n                constraint: isRevealLineArgs,\n                schema: {\n                    'type': 'object',\n                    'required': ['lineNumber'],\n                    'properties': {\n                        'lineNumber': {\n                            'type': ['number', 'string'],\n                        },\n                        'at': {\n                            'type': 'string',\n                            'enum': ['top', 'center', 'bottom']\n                        }\n                    }\n                }\n            }\n        ]\n    };\n    /**\n     * Values for reveal line 'at' argument\n     */\n    RevealLine_.RawAtArgument = {\n        Top: 'top',\n        Center: 'center',\n        Bottom: 'bottom'\n    };\n})(RevealLine_ || (RevealLine_ = {}));\nclass EditorOrNativeTextInputCommand {\n    constructor(target) {\n        // 1. handle case when focus is in editor.\n        target.addImplementation(10000, 'code-editor', (accessor, args) => {\n            // Only if editor text focus (i.e. not if editor has widget focus).\n            const focusedEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n            if (focusedEditor && focusedEditor.hasTextFocus()) {\n                return this._runEditorCommand(accessor, focusedEditor, args);\n            }\n            return false;\n        });\n        // 2. handle case when focus is in some other `input` / `textarea`.\n        target.addImplementation(1000, 'generic-dom-input-textarea', (accessor, args) => {\n            // Only if focused on an element that allows for entering text\n            const activeElement = document.activeElement;\n            if (activeElement && ['input', 'textarea'].indexOf(activeElement.tagName.toLowerCase()) >= 0) {\n                this.runDOMCommand();\n                return true;\n            }\n            return false;\n        });\n        // 3. (default) handle case when focus is somewhere else.\n        target.addImplementation(0, 'generic-dom', (accessor, args) => {\n            // Redirecting to active editor\n            const activeEditor = accessor.get(ICodeEditorService).getActiveCodeEditor();\n            if (activeEditor) {\n                activeEditor.focus();\n                return this._runEditorCommand(accessor, activeEditor, args);\n            }\n            return false;\n        });\n    }\n    _runEditorCommand(accessor, editor, args) {\n        const result = this.runEditorCommand(accessor, editor, args);\n        if (result) {\n            return result;\n        }\n        return true;\n    }\n}\nexport var CoreNavigationCommands;\n(function (CoreNavigationCommands) {\n    class BaseMoveToCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._minimalReveal = opts.minimalReveal;\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            const cursorStateChanged = viewModel.setCursorStates(args.source, 3 /* Explicit */, [\n                CursorMoveCommands.moveTo(viewModel, viewModel.getPrimaryCursorState(), this._inSelectionMode, args.position, args.viewPosition)\n            ]);\n            if (cursorStateChanged) {\n                viewModel.revealPrimaryCursor(args.source, true, this._minimalReveal);\n            }\n        }\n    }\n    CoreNavigationCommands.MoveTo = registerEditorCommand(new BaseMoveToCommand({\n        id: '_moveTo',\n        minimalReveal: true,\n        inSelectionMode: false,\n        precondition: undefined\n    }));\n    CoreNavigationCommands.MoveToSelect = registerEditorCommand(new BaseMoveToCommand({\n        id: '_moveToSelect',\n        minimalReveal: false,\n        inSelectionMode: true,\n        precondition: undefined\n    }));\n    class ColumnSelectCommand extends CoreEditorCommand {\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            const result = this._getColumnSelectResult(viewModel, viewModel.getPrimaryCursorState(), viewModel.getCursorColumnSelectData(), args);\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, result.viewStates.map((viewState) => CursorState.fromViewState(viewState)));\n            viewModel.setCursorColumnSelectData({\n                isReal: true,\n                fromViewLineNumber: result.fromLineNumber,\n                fromViewVisualColumn: result.fromVisualColumn,\n                toViewLineNumber: result.toLineNumber,\n                toViewVisualColumn: result.toVisualColumn\n            });\n            if (result.reversed) {\n                viewModel.revealTopMostCursor(args.source);\n            }\n            else {\n                viewModel.revealBottomMostCursor(args.source);\n            }\n        }\n    }\n    CoreNavigationCommands.ColumnSelect = registerEditorCommand(new class extends ColumnSelectCommand {\n        constructor() {\n            super({\n                id: 'columnSelect',\n                precondition: undefined\n            });\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            // validate `args`\n            const validatedPosition = viewModel.model.validatePosition(args.position);\n            const validatedViewPosition = viewModel.coordinatesConverter.validateViewPosition(new Position(args.viewPosition.lineNumber, args.viewPosition.column), validatedPosition);\n            const fromViewLineNumber = args.doColumnSelect ? prevColumnSelectData.fromViewLineNumber : validatedViewPosition.lineNumber;\n            const fromViewVisualColumn = args.doColumnSelect ? prevColumnSelectData.fromViewVisualColumn : args.mouseColumn - 1;\n            return ColumnSelection.columnSelect(viewModel.cursorConfig, viewModel, fromViewLineNumber, fromViewVisualColumn, validatedViewPosition.lineNumber, args.mouseColumn - 1);\n        }\n    });\n    CoreNavigationCommands.CursorColumnSelectLeft = registerEditorCommand(new class extends ColumnSelectCommand {\n        constructor() {\n            super({\n                id: 'cursorColumnSelectLeft',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 512 /* Alt */ | 15 /* LeftArrow */,\n                    linux: { primary: 0 }\n                }\n            });\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            return ColumnSelection.columnSelectLeft(viewModel.cursorConfig, viewModel, prevColumnSelectData);\n        }\n    });\n    CoreNavigationCommands.CursorColumnSelectRight = registerEditorCommand(new class extends ColumnSelectCommand {\n        constructor() {\n            super({\n                id: 'cursorColumnSelectRight',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 512 /* Alt */ | 17 /* RightArrow */,\n                    linux: { primary: 0 }\n                }\n            });\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            return ColumnSelection.columnSelectRight(viewModel.cursorConfig, viewModel, prevColumnSelectData);\n        }\n    });\n    class ColumnSelectUpCommand extends ColumnSelectCommand {\n        constructor(opts) {\n            super(opts);\n            this._isPaged = opts.isPaged;\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            return ColumnSelection.columnSelectUp(viewModel.cursorConfig, viewModel, prevColumnSelectData, this._isPaged);\n        }\n    }\n    CoreNavigationCommands.CursorColumnSelectUp = registerEditorCommand(new ColumnSelectUpCommand({\n        isPaged: false,\n        id: 'cursorColumnSelectUp',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 512 /* Alt */ | 16 /* UpArrow */,\n            linux: { primary: 0 }\n        }\n    }));\n    CoreNavigationCommands.CursorColumnSelectPageUp = registerEditorCommand(new ColumnSelectUpCommand({\n        isPaged: true,\n        id: 'cursorColumnSelectPageUp',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 512 /* Alt */ | 11 /* PageUp */,\n            linux: { primary: 0 }\n        }\n    }));\n    class ColumnSelectDownCommand extends ColumnSelectCommand {\n        constructor(opts) {\n            super(opts);\n            this._isPaged = opts.isPaged;\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            return ColumnSelection.columnSelectDown(viewModel.cursorConfig, viewModel, prevColumnSelectData, this._isPaged);\n        }\n    }\n    CoreNavigationCommands.CursorColumnSelectDown = registerEditorCommand(new ColumnSelectDownCommand({\n        isPaged: false,\n        id: 'cursorColumnSelectDown',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 512 /* Alt */ | 18 /* DownArrow */,\n            linux: { primary: 0 }\n        }\n    }));\n    CoreNavigationCommands.CursorColumnSelectPageDown = registerEditorCommand(new ColumnSelectDownCommand({\n        isPaged: true,\n        id: 'cursorColumnSelectPageDown',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 512 /* Alt */ | 12 /* PageDown */,\n            linux: { primary: 0 }\n        }\n    }));\n    class CursorMoveImpl extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'cursorMove',\n                precondition: undefined,\n                description: CursorMove_.description\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const parsed = CursorMove_.parse(args);\n            if (!parsed) {\n                // illegal arguments\n                return;\n            }\n            this._runCursorMove(viewModel, args.source, parsed);\n        }\n        _runCursorMove(viewModel, source, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(source, 3 /* Explicit */, CursorMoveImpl._move(viewModel, viewModel.getCursorStates(), args));\n            viewModel.revealPrimaryCursor(source, true);\n        }\n        static _move(viewModel, cursors, args) {\n            const inSelectionMode = args.select;\n            const value = args.value;\n            switch (args.direction) {\n                case 0 /* Left */:\n                case 1 /* Right */:\n                case 2 /* Up */:\n                case 3 /* Down */:\n                case 4 /* PrevBlankLine */:\n                case 5 /* NextBlankLine */:\n                case 6 /* WrappedLineStart */:\n                case 7 /* WrappedLineFirstNonWhitespaceCharacter */:\n                case 8 /* WrappedLineColumnCenter */:\n                case 9 /* WrappedLineEnd */:\n                case 10 /* WrappedLineLastNonWhitespaceCharacter */:\n                    return CursorMoveCommands.simpleMove(viewModel, cursors, args.direction, inSelectionMode, value, args.unit);\n                case 11 /* ViewPortTop */:\n                case 13 /* ViewPortBottom */:\n                case 12 /* ViewPortCenter */:\n                case 14 /* ViewPortIfOutside */:\n                    return CursorMoveCommands.viewportMove(viewModel, cursors, args.direction, inSelectionMode, value);\n                default:\n                    return null;\n            }\n        }\n    }\n    CoreNavigationCommands.CursorMoveImpl = CursorMoveImpl;\n    CoreNavigationCommands.CursorMove = registerEditorCommand(new CursorMoveImpl());\n    class CursorMoveBasedCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._staticArgs = opts.args;\n        }\n        runCoreEditorCommand(viewModel, dynamicArgs) {\n            let args = this._staticArgs;\n            if (this._staticArgs.value === -1 /* PAGE_SIZE_MARKER */) {\n                // -1 is a marker for page size\n                args = {\n                    direction: this._staticArgs.direction,\n                    unit: this._staticArgs.unit,\n                    select: this._staticArgs.select,\n                    value: dynamicArgs.pageSize || viewModel.cursorConfig.pageSize\n                };\n            }\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(dynamicArgs.source, 3 /* Explicit */, CursorMoveCommands.simpleMove(viewModel, viewModel.getCursorStates(), args.direction, args.select, args.value, args.unit));\n            viewModel.revealPrimaryCursor(dynamicArgs.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorLeft = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 0 /* Left */,\n            unit: 0 /* None */,\n            select: false,\n            value: 1\n        },\n        id: 'cursorLeft',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 15 /* LeftArrow */,\n            mac: { primary: 15 /* LeftArrow */, secondary: [256 /* WinCtrl */ | 32 /* KeyB */] }\n        }\n    }));\n    CoreNavigationCommands.CursorLeftSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 0 /* Left */,\n            unit: 0 /* None */,\n            select: true,\n            value: 1\n        },\n        id: 'cursorLeftSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* Shift */ | 15 /* LeftArrow */\n        }\n    }));\n    CoreNavigationCommands.CursorRight = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 1 /* Right */,\n            unit: 0 /* None */,\n            select: false,\n            value: 1\n        },\n        id: 'cursorRight',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 17 /* RightArrow */,\n            mac: { primary: 17 /* RightArrow */, secondary: [256 /* WinCtrl */ | 36 /* KeyF */] }\n        }\n    }));\n    CoreNavigationCommands.CursorRightSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 1 /* Right */,\n            unit: 0 /* None */,\n            select: true,\n            value: 1\n        },\n        id: 'cursorRightSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* Shift */ | 17 /* RightArrow */\n        }\n    }));\n    CoreNavigationCommands.CursorUp = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 2 /* Up */,\n            unit: 2 /* WrappedLine */,\n            select: false,\n            value: 1\n        },\n        id: 'cursorUp',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 16 /* UpArrow */,\n            mac: { primary: 16 /* UpArrow */, secondary: [256 /* WinCtrl */ | 46 /* KeyP */] }\n        }\n    }));\n    CoreNavigationCommands.CursorUpSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 2 /* Up */,\n            unit: 2 /* WrappedLine */,\n            select: true,\n            value: 1\n        },\n        id: 'cursorUpSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* Shift */ | 16 /* UpArrow */,\n            secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 16 /* UpArrow */],\n            mac: { primary: 1024 /* Shift */ | 16 /* UpArrow */ },\n            linux: { primary: 1024 /* Shift */ | 16 /* UpArrow */ }\n        }\n    }));\n    CoreNavigationCommands.CursorPageUp = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 2 /* Up */,\n            unit: 2 /* WrappedLine */,\n            select: false,\n            value: -1 /* PAGE_SIZE_MARKER */\n        },\n        id: 'cursorPageUp',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 11 /* PageUp */\n        }\n    }));\n    CoreNavigationCommands.CursorPageUpSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 2 /* Up */,\n            unit: 2 /* WrappedLine */,\n            select: true,\n            value: -1 /* PAGE_SIZE_MARKER */\n        },\n        id: 'cursorPageUpSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* Shift */ | 11 /* PageUp */\n        }\n    }));\n    CoreNavigationCommands.CursorDown = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 3 /* Down */,\n            unit: 2 /* WrappedLine */,\n            select: false,\n            value: 1\n        },\n        id: 'cursorDown',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 18 /* DownArrow */,\n            mac: { primary: 18 /* DownArrow */, secondary: [256 /* WinCtrl */ | 44 /* KeyN */] }\n        }\n    }));\n    CoreNavigationCommands.CursorDownSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 3 /* Down */,\n            unit: 2 /* WrappedLine */,\n            select: true,\n            value: 1\n        },\n        id: 'cursorDownSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* Shift */ | 18 /* DownArrow */,\n            secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 18 /* DownArrow */],\n            mac: { primary: 1024 /* Shift */ | 18 /* DownArrow */ },\n            linux: { primary: 1024 /* Shift */ | 18 /* DownArrow */ }\n        }\n    }));\n    CoreNavigationCommands.CursorPageDown = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 3 /* Down */,\n            unit: 2 /* WrappedLine */,\n            select: false,\n            value: -1 /* PAGE_SIZE_MARKER */\n        },\n        id: 'cursorPageDown',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 12 /* PageDown */\n        }\n    }));\n    CoreNavigationCommands.CursorPageDownSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 3 /* Down */,\n            unit: 2 /* WrappedLine */,\n            select: true,\n            value: -1 /* PAGE_SIZE_MARKER */\n        },\n        id: 'cursorPageDownSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* Shift */ | 12 /* PageDown */\n        }\n    }));\n    CoreNavigationCommands.CreateCursor = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'createCursor',\n                precondition: undefined\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            let newState;\n            if (args.wholeLine) {\n                newState = CursorMoveCommands.line(viewModel, viewModel.getPrimaryCursorState(), false, args.position, args.viewPosition);\n            }\n            else {\n                newState = CursorMoveCommands.moveTo(viewModel, viewModel.getPrimaryCursorState(), false, args.position, args.viewPosition);\n            }\n            const states = viewModel.getCursorStates();\n            // Check if we should remove a cursor (sort of like a toggle)\n            if (states.length > 1) {\n                const newModelPosition = (newState.modelState ? newState.modelState.position : null);\n                const newViewPosition = (newState.viewState ? newState.viewState.position : null);\n                for (let i = 0, len = states.length; i < len; i++) {\n                    const state = states[i];\n                    if (newModelPosition && !state.modelState.selection.containsPosition(newModelPosition)) {\n                        continue;\n                    }\n                    if (newViewPosition && !state.viewState.selection.containsPosition(newViewPosition)) {\n                        continue;\n                    }\n                    // => Remove the cursor\n                    states.splice(i, 1);\n                    viewModel.model.pushStackElement();\n                    viewModel.setCursorStates(args.source, 3 /* Explicit */, states);\n                    return;\n                }\n            }\n            // => Add the new cursor\n            states.push(newState);\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, states);\n        }\n    });\n    CoreNavigationCommands.LastCursorMoveToSelect = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: '_lastCursorMoveToSelect',\n                precondition: undefined\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const lastAddedCursorIndex = viewModel.getLastAddedCursorIndex();\n            const states = viewModel.getCursorStates();\n            const newStates = states.slice(0);\n            newStates[lastAddedCursorIndex] = CursorMoveCommands.moveTo(viewModel, states[lastAddedCursorIndex], true, args.position, args.viewPosition);\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, newStates);\n        }\n    });\n    class HomeCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, CursorMoveCommands.moveToBeginningOfLine(viewModel, viewModel.getCursorStates(), this._inSelectionMode));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorHome = registerEditorCommand(new HomeCommand({\n        inSelectionMode: false,\n        id: 'cursorHome',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 14 /* Home */,\n            mac: { primary: 14 /* Home */, secondary: [2048 /* CtrlCmd */ | 15 /* LeftArrow */] }\n        }\n    }));\n    CoreNavigationCommands.CursorHomeSelect = registerEditorCommand(new HomeCommand({\n        inSelectionMode: true,\n        id: 'cursorHomeSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* Shift */ | 14 /* Home */,\n            mac: { primary: 1024 /* Shift */ | 14 /* Home */, secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 15 /* LeftArrow */] }\n        }\n    }));\n    class LineStartCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, this._exec(viewModel.getCursorStates()));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n        _exec(cursors) {\n            const result = [];\n            for (let i = 0, len = cursors.length; i < len; i++) {\n                const cursor = cursors[i];\n                const lineNumber = cursor.modelState.position.lineNumber;\n                result[i] = CursorState.fromModelState(cursor.modelState.move(this._inSelectionMode, lineNumber, 1, 0));\n            }\n            return result;\n        }\n    }\n    CoreNavigationCommands.CursorLineStart = registerEditorCommand(new LineStartCommand({\n        inSelectionMode: false,\n        id: 'cursorLineStart',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 0,\n            mac: { primary: 256 /* WinCtrl */ | 31 /* KeyA */ }\n        }\n    }));\n    CoreNavigationCommands.CursorLineStartSelect = registerEditorCommand(new LineStartCommand({\n        inSelectionMode: true,\n        id: 'cursorLineStartSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 0,\n            mac: { primary: 256 /* WinCtrl */ | 1024 /* Shift */ | 31 /* KeyA */ }\n        }\n    }));\n    class EndCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, CursorMoveCommands.moveToEndOfLine(viewModel, viewModel.getCursorStates(), this._inSelectionMode, args.sticky || false));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorEnd = registerEditorCommand(new EndCommand({\n        inSelectionMode: false,\n        id: 'cursorEnd',\n        precondition: undefined,\n        kbOpts: {\n            args: { sticky: false },\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 13 /* End */,\n            mac: { primary: 13 /* End */, secondary: [2048 /* CtrlCmd */ | 17 /* RightArrow */] }\n        },\n        description: {\n            description: `Go to End`,\n            args: [{\n                    name: 'args',\n                    schema: {\n                        type: 'object',\n                        properties: {\n                            'sticky': {\n                                description: nls.localize('stickydesc', \"Stick to the end even when going to longer lines\"),\n                                type: 'boolean',\n                                default: false\n                            }\n                        }\n                    }\n                }]\n        }\n    }));\n    CoreNavigationCommands.CursorEndSelect = registerEditorCommand(new EndCommand({\n        inSelectionMode: true,\n        id: 'cursorEndSelect',\n        precondition: undefined,\n        kbOpts: {\n            args: { sticky: false },\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* Shift */ | 13 /* End */,\n            mac: { primary: 1024 /* Shift */ | 13 /* End */, secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 17 /* RightArrow */] }\n        },\n        description: {\n            description: `Select to End`,\n            args: [{\n                    name: 'args',\n                    schema: {\n                        type: 'object',\n                        properties: {\n                            'sticky': {\n                                description: nls.localize('stickydesc', \"Stick to the end even when going to longer lines\"),\n                                type: 'boolean',\n                                default: false\n                            }\n                        }\n                    }\n                }]\n        }\n    }));\n    class LineEndCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, this._exec(viewModel, viewModel.getCursorStates()));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n        _exec(viewModel, cursors) {\n            const result = [];\n            for (let i = 0, len = cursors.length; i < len; i++) {\n                const cursor = cursors[i];\n                const lineNumber = cursor.modelState.position.lineNumber;\n                const maxColumn = viewModel.model.getLineMaxColumn(lineNumber);\n                result[i] = CursorState.fromModelState(cursor.modelState.move(this._inSelectionMode, lineNumber, maxColumn, 0));\n            }\n            return result;\n        }\n    }\n    CoreNavigationCommands.CursorLineEnd = registerEditorCommand(new LineEndCommand({\n        inSelectionMode: false,\n        id: 'cursorLineEnd',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 0,\n            mac: { primary: 256 /* WinCtrl */ | 35 /* KeyE */ }\n        }\n    }));\n    CoreNavigationCommands.CursorLineEndSelect = registerEditorCommand(new LineEndCommand({\n        inSelectionMode: true,\n        id: 'cursorLineEndSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 0,\n            mac: { primary: 256 /* WinCtrl */ | 1024 /* Shift */ | 35 /* KeyE */ }\n        }\n    }));\n    class TopCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, CursorMoveCommands.moveToBeginningOfBuffer(viewModel, viewModel.getCursorStates(), this._inSelectionMode));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorTop = registerEditorCommand(new TopCommand({\n        inSelectionMode: false,\n        id: 'cursorTop',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* CtrlCmd */ | 14 /* Home */,\n            mac: { primary: 2048 /* CtrlCmd */ | 16 /* UpArrow */ }\n        }\n    }));\n    CoreNavigationCommands.CursorTopSelect = registerEditorCommand(new TopCommand({\n        inSelectionMode: true,\n        id: 'cursorTopSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 14 /* Home */,\n            mac: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 16 /* UpArrow */ }\n        }\n    }));\n    class BottomCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, CursorMoveCommands.moveToEndOfBuffer(viewModel, viewModel.getCursorStates(), this._inSelectionMode));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorBottom = registerEditorCommand(new BottomCommand({\n        inSelectionMode: false,\n        id: 'cursorBottom',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* CtrlCmd */ | 13 /* End */,\n            mac: { primary: 2048 /* CtrlCmd */ | 18 /* DownArrow */ }\n        }\n    }));\n    CoreNavigationCommands.CursorBottomSelect = registerEditorCommand(new BottomCommand({\n        inSelectionMode: true,\n        id: 'cursorBottomSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 13 /* End */,\n            mac: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 18 /* DownArrow */ }\n        }\n    }));\n    class EditorScrollImpl extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'editorScroll',\n                precondition: undefined,\n                description: EditorScroll_.description\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const parsed = EditorScroll_.parse(args);\n            if (!parsed) {\n                // illegal arguments\n                return;\n            }\n            this._runEditorScroll(viewModel, args.source, parsed);\n        }\n        _runEditorScroll(viewModel, source, args) {\n            const desiredScrollTop = this._computeDesiredScrollTop(viewModel, args);\n            if (args.revealCursor) {\n                // must ensure cursor is in new visible range\n                const desiredVisibleViewRange = viewModel.getCompletelyVisibleViewRangeAtScrollTop(desiredScrollTop);\n                viewModel.setCursorStates(source, 3 /* Explicit */, [\n                    CursorMoveCommands.findPositionInViewportIfOutside(viewModel, viewModel.getPrimaryCursorState(), desiredVisibleViewRange, args.select)\n                ]);\n            }\n            viewModel.viewLayout.setScrollPosition({ scrollTop: desiredScrollTop }, 0 /* Smooth */);\n        }\n        _computeDesiredScrollTop(viewModel, args) {\n            if (args.unit === 1 /* Line */) {\n                // scrolling by model lines\n                const visibleViewRange = viewModel.getCompletelyVisibleViewRange();\n                const visibleModelRange = viewModel.coordinatesConverter.convertViewRangeToModelRange(visibleViewRange);\n                let desiredTopModelLineNumber;\n                if (args.direction === 1 /* Up */) {\n                    // must go x model lines up\n                    desiredTopModelLineNumber = Math.max(1, visibleModelRange.startLineNumber - args.value);\n                }\n                else {\n                    // must go x model lines down\n                    desiredTopModelLineNumber = Math.min(viewModel.model.getLineCount(), visibleModelRange.startLineNumber + args.value);\n                }\n                const viewPosition = viewModel.coordinatesConverter.convertModelPositionToViewPosition(new Position(desiredTopModelLineNumber, 1));\n                return viewModel.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);\n            }\n            let noOfLines;\n            if (args.unit === 3 /* Page */) {\n                noOfLines = viewModel.cursorConfig.pageSize * args.value;\n            }\n            else if (args.unit === 4 /* HalfPage */) {\n                noOfLines = Math.round(viewModel.cursorConfig.pageSize / 2) * args.value;\n            }\n            else {\n                noOfLines = args.value;\n            }\n            const deltaLines = (args.direction === 1 /* Up */ ? -1 : 1) * noOfLines;\n            return viewModel.viewLayout.getCurrentScrollTop() + deltaLines * viewModel.cursorConfig.lineHeight;\n        }\n    }\n    CoreNavigationCommands.EditorScrollImpl = EditorScrollImpl;\n    CoreNavigationCommands.EditorScroll = registerEditorCommand(new EditorScrollImpl());\n    CoreNavigationCommands.ScrollLineUp = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollLineUp',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* CtrlCmd */ | 16 /* UpArrow */,\n                    mac: { primary: 256 /* WinCtrl */ | 11 /* PageUp */ }\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel, args.source, {\n                direction: 1 /* Up */,\n                unit: 2 /* WrappedLine */,\n                value: 1,\n                revealCursor: false,\n                select: false\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollPageUp = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollPageUp',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* CtrlCmd */ | 11 /* PageUp */,\n                    win: { primary: 512 /* Alt */ | 11 /* PageUp */ },\n                    linux: { primary: 512 /* Alt */ | 11 /* PageUp */ }\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel, args.source, {\n                direction: 1 /* Up */,\n                unit: 3 /* Page */,\n                value: 1,\n                revealCursor: false,\n                select: false\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollLineDown = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollLineDown',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* CtrlCmd */ | 18 /* DownArrow */,\n                    mac: { primary: 256 /* WinCtrl */ | 12 /* PageDown */ }\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel, args.source, {\n                direction: 2 /* Down */,\n                unit: 2 /* WrappedLine */,\n                value: 1,\n                revealCursor: false,\n                select: false\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollPageDown = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollPageDown',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* CtrlCmd */ | 12 /* PageDown */,\n                    win: { primary: 512 /* Alt */ | 12 /* PageDown */ },\n                    linux: { primary: 512 /* Alt */ | 12 /* PageDown */ }\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll._runEditorScroll(viewModel, args.source, {\n                direction: 2 /* Down */,\n                unit: 3 /* Page */,\n                value: 1,\n                revealCursor: false,\n                select: false\n            });\n        }\n    });\n    class WordCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, [\n                CursorMoveCommands.word(viewModel, viewModel.getPrimaryCursorState(), this._inSelectionMode, args.position)\n            ]);\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.WordSelect = registerEditorCommand(new WordCommand({\n        inSelectionMode: false,\n        id: '_wordSelect',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.WordSelectDrag = registerEditorCommand(new WordCommand({\n        inSelectionMode: true,\n        id: '_wordSelectDrag',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.LastCursorWordSelect = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'lastCursorWordSelect',\n                precondition: undefined\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const lastAddedCursorIndex = viewModel.getLastAddedCursorIndex();\n            const states = viewModel.getCursorStates();\n            const newStates = states.slice(0);\n            const lastAddedState = states[lastAddedCursorIndex];\n            newStates[lastAddedCursorIndex] = CursorMoveCommands.word(viewModel, lastAddedState, lastAddedState.modelState.hasSelection(), args.position);\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, newStates);\n        }\n    });\n    class LineCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, [\n                CursorMoveCommands.line(viewModel, viewModel.getPrimaryCursorState(), this._inSelectionMode, args.position, args.viewPosition)\n            ]);\n            viewModel.revealPrimaryCursor(args.source, false);\n        }\n    }\n    CoreNavigationCommands.LineSelect = registerEditorCommand(new LineCommand({\n        inSelectionMode: false,\n        id: '_lineSelect',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.LineSelectDrag = registerEditorCommand(new LineCommand({\n        inSelectionMode: true,\n        id: '_lineSelectDrag',\n        precondition: undefined\n    }));\n    class LastCursorLineCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const lastAddedCursorIndex = viewModel.getLastAddedCursorIndex();\n            const states = viewModel.getCursorStates();\n            const newStates = states.slice(0);\n            newStates[lastAddedCursorIndex] = CursorMoveCommands.line(viewModel, states[lastAddedCursorIndex], this._inSelectionMode, args.position, args.viewPosition);\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, newStates);\n        }\n    }\n    CoreNavigationCommands.LastCursorLineSelect = registerEditorCommand(new LastCursorLineCommand({\n        inSelectionMode: false,\n        id: 'lastCursorLineSelect',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.LastCursorLineSelectDrag = registerEditorCommand(new LastCursorLineCommand({\n        inSelectionMode: true,\n        id: 'lastCursorLineSelectDrag',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.CancelSelection = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'cancelSelection',\n                precondition: EditorContextKeys.hasNonEmptySelection,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 9 /* Escape */,\n                    secondary: [1024 /* Shift */ | 9 /* Escape */]\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, [\n                CursorMoveCommands.cancelSelection(viewModel, viewModel.getPrimaryCursorState())\n            ]);\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    });\n    CoreNavigationCommands.RemoveSecondaryCursors = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'removeSecondaryCursors',\n                precondition: EditorContextKeys.hasMultipleSelections,\n                kbOpts: {\n                    weight: CORE_WEIGHT + 1,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 9 /* Escape */,\n                    secondary: [1024 /* Shift */ | 9 /* Escape */]\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, [\n                viewModel.getPrimaryCursorState()\n            ]);\n            viewModel.revealPrimaryCursor(args.source, true);\n            status(nls.localize('removedCursor', \"Removed secondary cursors\"));\n        }\n    });\n    CoreNavigationCommands.RevealLine = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'revealLine',\n                precondition: undefined,\n                description: RevealLine_.description\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const revealLineArg = args;\n            const lineNumberArg = revealLineArg.lineNumber || 0;\n            let lineNumber = typeof lineNumberArg === 'number' ? (lineNumberArg + 1) : (parseInt(lineNumberArg) + 1);\n            if (lineNumber < 1) {\n                lineNumber = 1;\n            }\n            const lineCount = viewModel.model.getLineCount();\n            if (lineNumber > lineCount) {\n                lineNumber = lineCount;\n            }\n            const range = new Range(lineNumber, 1, lineNumber, viewModel.model.getLineMaxColumn(lineNumber));\n            let revealAt = 0 /* Simple */;\n            if (revealLineArg.at) {\n                switch (revealLineArg.at) {\n                    case RevealLine_.RawAtArgument.Top:\n                        revealAt = 3 /* Top */;\n                        break;\n                    case RevealLine_.RawAtArgument.Center:\n                        revealAt = 1 /* Center */;\n                        break;\n                    case RevealLine_.RawAtArgument.Bottom:\n                        revealAt = 4 /* Bottom */;\n                        break;\n                    default:\n                        break;\n                }\n            }\n            const viewRange = viewModel.coordinatesConverter.convertModelRangeToViewRange(range);\n            viewModel.revealRange(args.source, false, viewRange, revealAt, 0 /* Smooth */);\n        }\n    });\n    CoreNavigationCommands.SelectAll = new class extends EditorOrNativeTextInputCommand {\n        constructor() {\n            super(SelectAllCommand);\n        }\n        runDOMCommand() {\n            if (isFirefox) {\n                document.activeElement.focus();\n                document.activeElement.select();\n            }\n            document.execCommand('selectAll');\n        }\n        runEditorCommand(accessor, editor, args) {\n            const viewModel = editor._getViewModel();\n            if (!viewModel) {\n                // the editor has no view => has no cursors\n                return;\n            }\n            this.runCoreEditorCommand(viewModel, args);\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates('keyboard', 3 /* Explicit */, [\n                CursorMoveCommands.selectAll(viewModel, viewModel.getPrimaryCursorState())\n            ]);\n        }\n    }();\n    CoreNavigationCommands.SetSelection = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'setSelection',\n                precondition: undefined\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* Explicit */, [\n                CursorState.fromModelSelection(args.selection)\n            ]);\n        }\n    });\n})(CoreNavigationCommands || (CoreNavigationCommands = {}));\nconst columnSelectionCondition = ContextKeyExpr.and(EditorContextKeys.textInputFocus, EditorContextKeys.columnSelection);\nfunction registerColumnSelection(id, keybinding) {\n    KeybindingsRegistry.registerKeybindingRule({\n        id: id,\n        primary: keybinding,\n        when: columnSelectionCondition,\n        weight: CORE_WEIGHT + 1\n    });\n}\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectLeft.id, 1024 /* Shift */ | 15 /* LeftArrow */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectRight.id, 1024 /* Shift */ | 17 /* RightArrow */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectUp.id, 1024 /* Shift */ | 16 /* UpArrow */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectPageUp.id, 1024 /* Shift */ | 11 /* PageUp */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectDown.id, 1024 /* Shift */ | 18 /* DownArrow */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectPageDown.id, 1024 /* Shift */ | 12 /* PageDown */);\nfunction registerCommand(command) {\n    command.register();\n    return command;\n}\nexport var CoreEditingCommands;\n(function (CoreEditingCommands) {\n    class CoreEditingCommand extends EditorCommand {\n        runEditorCommand(accessor, editor, args) {\n            const viewModel = editor._getViewModel();\n            if (!viewModel) {\n                // the editor has no view => has no cursors\n                return;\n            }\n            this.runCoreEditingCommand(editor, viewModel, args || {});\n        }\n    }\n    CoreEditingCommands.CoreEditingCommand = CoreEditingCommand;\n    CoreEditingCommands.LineBreakInsert = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'lineBreakInsert',\n                precondition: EditorContextKeys.writable,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 0,\n                    mac: { primary: 256 /* WinCtrl */ | 45 /* KeyO */ }\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            editor.pushUndoStop();\n            editor.executeCommands(this.id, TypeOperations.lineBreakInsert(viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection)));\n        }\n    });\n    CoreEditingCommands.Outdent = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'outdent',\n                precondition: EditorContextKeys.writable,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.tabDoesNotMoveFocus),\n                    primary: 1024 /* Shift */ | 2 /* Tab */\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            editor.pushUndoStop();\n            editor.executeCommands(this.id, TypeOperations.outdent(viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection)));\n            editor.pushUndoStop();\n        }\n    });\n    CoreEditingCommands.Tab = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'tab',\n                precondition: EditorContextKeys.writable,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.tabDoesNotMoveFocus),\n                    primary: 2 /* Tab */\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            editor.pushUndoStop();\n            editor.executeCommands(this.id, TypeOperations.tab(viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection)));\n            editor.pushUndoStop();\n        }\n    });\n    CoreEditingCommands.DeleteLeft = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'deleteLeft',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 1 /* Backspace */,\n                    secondary: [1024 /* Shift */ | 1 /* Backspace */],\n                    mac: { primary: 1 /* Backspace */, secondary: [1024 /* Shift */ | 1 /* Backspace */, 256 /* WinCtrl */ | 38 /* KeyH */, 256 /* WinCtrl */ | 1 /* Backspace */] }\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            const [shouldPushStackElementBefore, commands] = DeleteOperations.deleteLeft(viewModel.getPrevEditOperationType(), viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection), viewModel.getCursorAutoClosedCharacters());\n            if (shouldPushStackElementBefore) {\n                editor.pushUndoStop();\n            }\n            editor.executeCommands(this.id, commands);\n            viewModel.setPrevEditOperationType(2 /* DeletingLeft */);\n        }\n    });\n    CoreEditingCommands.DeleteRight = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'deleteRight',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 20 /* Delete */,\n                    mac: { primary: 20 /* Delete */, secondary: [256 /* WinCtrl */ | 34 /* KeyD */, 256 /* WinCtrl */ | 20 /* Delete */] }\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            const [shouldPushStackElementBefore, commands] = DeleteOperations.deleteRight(viewModel.getPrevEditOperationType(), viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection));\n            if (shouldPushStackElementBefore) {\n                editor.pushUndoStop();\n            }\n            editor.executeCommands(this.id, commands);\n            viewModel.setPrevEditOperationType(3 /* DeletingRight */);\n        }\n    });\n    CoreEditingCommands.Undo = new class extends EditorOrNativeTextInputCommand {\n        constructor() {\n            super(UndoCommand);\n        }\n        runDOMCommand() {\n            document.execCommand('undo');\n        }\n        runEditorCommand(accessor, editor, args) {\n            if (!editor.hasModel() || editor.getOption(81 /* readOnly */) === true) {\n                return;\n            }\n            return editor.getModel().undo();\n        }\n    }();\n    CoreEditingCommands.Redo = new class extends EditorOrNativeTextInputCommand {\n        constructor() {\n            super(RedoCommand);\n        }\n        runDOMCommand() {\n            document.execCommand('redo');\n        }\n        runEditorCommand(accessor, editor, args) {\n            if (!editor.hasModel() || editor.getOption(81 /* readOnly */) === true) {\n                return;\n            }\n            return editor.getModel().redo();\n        }\n    }();\n})(CoreEditingCommands || (CoreEditingCommands = {}));\n/**\n * A command that will invoke a command on the focused editor.\n */\nclass EditorHandlerCommand extends Command {\n    constructor(id, handlerId, description) {\n        super({\n            id: id,\n            precondition: undefined,\n            description: description\n        });\n        this._handlerId = handlerId;\n    }\n    runCommand(accessor, args) {\n        const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n        if (!editor) {\n            return;\n        }\n        editor.trigger('keyboard', this._handlerId, args);\n    }\n}\nfunction registerOverwritableCommand(handlerId, description) {\n    registerCommand(new EditorHandlerCommand('default:' + handlerId, handlerId));\n    registerCommand(new EditorHandlerCommand(handlerId, handlerId, description));\n}\nregisterOverwritableCommand(\"type\" /* Type */, {\n    description: `Type`,\n    args: [{\n            name: 'args',\n            schema: {\n                'type': 'object',\n                'required': ['text'],\n                'properties': {\n                    'text': {\n                        'type': 'string'\n                    }\n                },\n            }\n        }]\n});\nregisterOverwritableCommand(\"replacePreviousChar\" /* ReplacePreviousChar */);\nregisterOverwritableCommand(\"compositionType\" /* CompositionType */);\nregisterOverwritableCommand(\"compositionStart\" /* CompositionStart */);\nregisterOverwritableCommand(\"compositionEnd\" /* CompositionEnd */);\nregisterOverwritableCommand(\"paste\" /* Paste */);\nregisterOverwritableCommand(\"cut\" /* Cut */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as editorCommon from '../common/editorCommon.js';\n/**\n *@internal\n */\nexport function isCodeEditor(thing) {\n    if (thing && typeof thing.getEditorType === 'function') {\n        return thing.getEditorType() === editorCommon.EditorType.ICodeEditor;\n    }\n    else {\n        return false;\n    }\n}\n/**\n *@internal\n */\nexport function isDiffEditor(thing) {\n    if (thing && typeof thing.getEditorType === 'function') {\n        return thing.getEditorType() === editorCommon.EditorType.IDiffEditor;\n    }\n    else {\n        return false;\n    }\n}\n/**\n *@internal\n */\nexport function getCodeEditor(thing) {\n    if (isCodeEditor(thing)) {\n        return thing;\n    }\n    if (isDiffEditor(thing)) {\n        return thing.getModifiedEditor();\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../base/browser/dom.js';\nimport { GlobalMouseMoveMonitor } from '../../base/browser/globalMouseMoveMonitor.js';\nimport { StandardMouseEvent } from '../../base/browser/mouseEvent.js';\nimport { RunOnceScheduler } from '../../base/common/async.js';\nimport { Disposable } from '../../base/common/lifecycle.js';\nimport { asCssVariableName } from '../../platform/theme/common/colorRegistry.js';\n/**\n * Coordinates relative to the whole document (e.g. mouse event's pageX and pageY)\n */\nexport class PageCoordinates {\n    constructor(x, y) {\n        this.x = x;\n        this.y = y;\n        this._pageCoordinatesBrand = undefined;\n    }\n    toClientCoordinates() {\n        return new ClientCoordinates(this.x - dom.StandardWindow.scrollX, this.y - dom.StandardWindow.scrollY);\n    }\n}\n/**\n * Coordinates within the application's client area (i.e. origin is document's scroll position).\n *\n * For example, clicking in the top-left corner of the client area will\n * always result in a mouse event with a client.x value of 0, regardless\n * of whether the page is scrolled horizontally.\n */\nexport class ClientCoordinates {\n    constructor(clientX, clientY) {\n        this.clientX = clientX;\n        this.clientY = clientY;\n        this._clientCoordinatesBrand = undefined;\n    }\n    toPageCoordinates() {\n        return new PageCoordinates(this.clientX + dom.StandardWindow.scrollX, this.clientY + dom.StandardWindow.scrollY);\n    }\n}\n/**\n * The position of the editor in the page.\n */\nexport class EditorPagePosition {\n    constructor(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n        this._editorPagePositionBrand = undefined;\n    }\n}\n/**\n * Coordinates relative to the the (top;left) of the editor that can be used safely with other internal editor metrics.\n * **NOTE**: This position is obtained by taking page coordinates and transforming them relative to the\n * editor's (top;left) position in a way in which scale transformations are taken into account.\n * **NOTE**: These coordinates could be negative if the mouse position is outside the editor.\n */\nexport class CoordinatesRelativeToEditor {\n    constructor(x, y) {\n        this.x = x;\n        this.y = y;\n        this._positionRelativeToEditorBrand = undefined;\n    }\n}\nexport function createEditorPagePosition(editorViewDomNode) {\n    const editorPos = dom.getDomNodePagePosition(editorViewDomNode);\n    return new EditorPagePosition(editorPos.left, editorPos.top, editorPos.width, editorPos.height);\n}\nexport function createCoordinatesRelativeToEditor(editorViewDomNode, editorPagePosition, pos) {\n    // The editor's page position is read from the DOM using getBoundingClientRect().\n    //\n    // getBoundingClientRect() returns the actual dimensions, while offsetWidth and offsetHeight\n    // reflect the unscaled size. We can use this difference to detect a transform:scale()\n    // and we will apply the transformation in inverse to get mouse coordinates that make sense inside the editor.\n    //\n    // This could be expanded to cover rotation as well maybe by walking the DOM up from `editorViewDomNode`\n    // and computing the effective transformation matrix using getComputedStyle(element).transform.\n    //\n    const scaleX = editorPagePosition.width / editorViewDomNode.offsetWidth;\n    const scaleY = editorPagePosition.height / editorViewDomNode.offsetHeight;\n    // Adjust mouse offsets if editor appears to be scaled via transforms\n    const relativeX = (pos.x - editorPagePosition.x) / scaleX;\n    const relativeY = (pos.y - editorPagePosition.y) / scaleY;\n    return new CoordinatesRelativeToEditor(relativeX, relativeY);\n}\nexport class EditorMouseEvent extends StandardMouseEvent {\n    constructor(e, editorViewDomNode) {\n        super(e);\n        this._editorMouseEventBrand = undefined;\n        this.pos = new PageCoordinates(this.posx, this.posy);\n        this.editorPos = createEditorPagePosition(editorViewDomNode);\n        this.relativePos = createCoordinatesRelativeToEditor(editorViewDomNode, this.editorPos, this.pos);\n    }\n}\nexport class EditorMouseEventFactory {\n    constructor(editorViewDomNode) {\n        this._editorViewDomNode = editorViewDomNode;\n    }\n    _create(e) {\n        return new EditorMouseEvent(e, this._editorViewDomNode);\n    }\n    onContextMenu(target, callback) {\n        return dom.addDisposableListener(target, 'contextmenu', (e) => {\n            callback(this._create(e));\n        });\n    }\n    onMouseUp(target, callback) {\n        return dom.addDisposableListener(target, 'mouseup', (e) => {\n            callback(this._create(e));\n        });\n    }\n    onMouseDown(target, callback) {\n        return dom.addDisposableListener(target, 'mousedown', (e) => {\n            callback(this._create(e));\n        });\n    }\n    onMouseLeave(target, callback) {\n        return dom.addDisposableNonBubblingMouseOutListener(target, (e) => {\n            callback(this._create(e));\n        });\n    }\n    onMouseMoveThrottled(target, callback, merger, minimumTimeMs) {\n        const myMerger = (lastEvent, currentEvent) => {\n            return merger(lastEvent, this._create(currentEvent));\n        };\n        return dom.addDisposableThrottledListener(target, 'mousemove', callback, myMerger, minimumTimeMs);\n    }\n}\nexport class EditorPointerEventFactory {\n    constructor(editorViewDomNode) {\n        this._editorViewDomNode = editorViewDomNode;\n    }\n    _create(e) {\n        return new EditorMouseEvent(e, this._editorViewDomNode);\n    }\n    onPointerUp(target, callback) {\n        return dom.addDisposableListener(target, 'pointerup', (e) => {\n            callback(this._create(e));\n        });\n    }\n    onPointerDown(target, callback) {\n        return dom.addDisposableListener(target, 'pointerdown', (e) => {\n            callback(this._create(e));\n        });\n    }\n    onPointerLeave(target, callback) {\n        return dom.addDisposableNonBubblingPointerOutListener(target, (e) => {\n            callback(this._create(e));\n        });\n    }\n    onPointerMoveThrottled(target, callback, merger, minimumTimeMs) {\n        const myMerger = (lastEvent, currentEvent) => {\n            return merger(lastEvent, this._create(currentEvent));\n        };\n        return dom.addDisposableThrottledListener(target, 'pointermove', callback, myMerger, minimumTimeMs);\n    }\n}\nexport class GlobalEditorMouseMoveMonitor extends Disposable {\n    constructor(editorViewDomNode) {\n        super();\n        this._editorViewDomNode = editorViewDomNode;\n        this._globalMouseMoveMonitor = this._register(new GlobalMouseMoveMonitor());\n        this._keydownListener = null;\n    }\n    startMonitoring(initialElement, initialButtons, merger, mouseMoveCallback, onStopCallback) {\n        // Add a <<capture>> keydown event listener that will cancel the monitoring\n        // if something other than a modifier key is pressed\n        this._keydownListener = dom.addStandardDisposableListener(document, 'keydown', (e) => {\n            const kb = e.toKeybinding();\n            if (kb.isModifierKey()) {\n                // Allow modifier keys\n                return;\n            }\n            this._globalMouseMoveMonitor.stopMonitoring(true, e.browserEvent);\n        }, true);\n        const myMerger = (lastEvent, currentEvent) => {\n            return merger(lastEvent, new EditorMouseEvent(currentEvent, this._editorViewDomNode));\n        };\n        this._globalMouseMoveMonitor.startMonitoring(initialElement, initialButtons, myMerger, mouseMoveCallback, (e) => {\n            this._keydownListener.dispose();\n            onStopCallback(e);\n        });\n    }\n    stopMonitoring() {\n        this._globalMouseMoveMonitor.stopMonitoring(true);\n    }\n}\n/**\n * A helper to create dynamic css rules, bound to a class name.\n * Rules are reused.\n * Reference counting and delayed garbage collection ensure that no rules leak.\n*/\nexport class DynamicCssRules {\n    constructor(_editor) {\n        this._editor = _editor;\n        this._instanceId = ++DynamicCssRules._idPool;\n        this._counter = 0;\n        this._rules = new Map();\n        // We delay garbage collection so that hanging rules can be reused.\n        this._garbageCollectionScheduler = new RunOnceScheduler(() => this.garbageCollect(), 1000);\n    }\n    createClassNameRef(options) {\n        const rule = this.getOrCreateRule(options);\n        rule.increaseRefCount();\n        return {\n            className: rule.className,\n            dispose: () => {\n                rule.decreaseRefCount();\n                this._garbageCollectionScheduler.schedule();\n            }\n        };\n    }\n    getOrCreateRule(properties) {\n        const key = this.computeUniqueKey(properties);\n        let existingRule = this._rules.get(key);\n        if (!existingRule) {\n            const counter = this._counter++;\n            existingRule = new RefCountedCssRule(key, `dyn-rule-${this._instanceId}-${counter}`, dom.isInShadowDOM(this._editor.getContainerDomNode())\n                ? this._editor.getContainerDomNode()\n                : undefined, properties);\n            this._rules.set(key, existingRule);\n        }\n        return existingRule;\n    }\n    computeUniqueKey(properties) {\n        return JSON.stringify(properties);\n    }\n    garbageCollect() {\n        for (const rule of this._rules.values()) {\n            if (!rule.hasReferences()) {\n                this._rules.delete(rule.key);\n                rule.dispose();\n            }\n        }\n    }\n}\nDynamicCssRules._idPool = 0;\nclass RefCountedCssRule {\n    constructor(key, className, _containerElement, properties) {\n        this.key = key;\n        this.className = className;\n        this.properties = properties;\n        this._referenceCount = 0;\n        this._styleElement = dom.createStyleSheet(_containerElement);\n        this._styleElement.textContent = this.getCssText(this.className, this.properties);\n    }\n    getCssText(className, properties) {\n        let str = `.${className} {`;\n        for (const prop in properties) {\n            const value = properties[prop];\n            let cssValue;\n            if (typeof value === 'object') {\n                cssValue = `var(${asCssVariableName(value.id)})`;\n            }\n            else {\n                cssValue = value;\n            }\n            const cssPropName = camelToDashes(prop);\n            str += `\\n\\t${cssPropName}: ${cssValue};`;\n        }\n        str += `\\n}`;\n        return str;\n    }\n    dispose() {\n        this._styleElement.remove();\n    }\n    increaseRefCount() {\n        this._referenceCount++;\n    }\n    decreaseRefCount() {\n        this._referenceCount--;\n    }\n    hasReferences() {\n        return this._referenceCount > 0;\n    }\n}\nfunction camelToDashes(str) {\n    return str.replace(/(^[A-Z])/, ([first]) => first.toLowerCase())\n        .replace(/([A-Z])/g, ([letter]) => `-${letter.toLowerCase()}`);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as nls from '../../nls.js';\nimport { URI } from '../../base/common/uri.js';\nimport { ICodeEditorService } from './services/codeEditorService.js';\nimport { Position } from '../common/core/position.js';\nimport { IModelService } from '../common/services/model.js';\nimport { ITextModelService } from '../common/services/resolverService.js';\nimport { MenuId, MenuRegistry } from '../../platform/actions/common/actions.js';\nimport { CommandsRegistry } from '../../platform/commands/common/commands.js';\nimport { ContextKeyExpr, IContextKeyService } from '../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../platform/instantiation/common/instantiation.js';\nimport { KeybindingsRegistry } from '../../platform/keybinding/common/keybindingsRegistry.js';\nimport { Registry } from '../../platform/registry/common/platform.js';\nimport { ITelemetryService } from '../../platform/telemetry/common/telemetry.js';\nimport { withNullAsUndefined, assertType } from '../../base/common/types.js';\nimport { ILogService } from '../../platform/log/common/log.js';\nexport class Command {\n    constructor(opts) {\n        this.id = opts.id;\n        this.precondition = opts.precondition;\n        this._kbOpts = opts.kbOpts;\n        this._menuOpts = opts.menuOpts;\n        this._description = opts.description;\n    }\n    register() {\n        if (Array.isArray(this._menuOpts)) {\n            this._menuOpts.forEach(this._registerMenuItem, this);\n        }\n        else if (this._menuOpts) {\n            this._registerMenuItem(this._menuOpts);\n        }\n        if (this._kbOpts) {\n            const kbOptsArr = Array.isArray(this._kbOpts) ? this._kbOpts : [this._kbOpts];\n            for (const kbOpts of kbOptsArr) {\n                let kbWhen = kbOpts.kbExpr;\n                if (this.precondition) {\n                    if (kbWhen) {\n                        kbWhen = ContextKeyExpr.and(kbWhen, this.precondition);\n                    }\n                    else {\n                        kbWhen = this.precondition;\n                    }\n                }\n                const desc = {\n                    id: this.id,\n                    weight: kbOpts.weight,\n                    args: kbOpts.args,\n                    when: kbWhen,\n                    primary: kbOpts.primary,\n                    secondary: kbOpts.secondary,\n                    win: kbOpts.win,\n                    linux: kbOpts.linux,\n                    mac: kbOpts.mac,\n                };\n                KeybindingsRegistry.registerKeybindingRule(desc);\n            }\n        }\n        CommandsRegistry.registerCommand({\n            id: this.id,\n            handler: (accessor, args) => this.runCommand(accessor, args),\n            description: this._description\n        });\n    }\n    _registerMenuItem(item) {\n        MenuRegistry.appendMenuItem(item.menuId, {\n            group: item.group,\n            command: {\n                id: this.id,\n                title: item.title,\n                icon: item.icon,\n                precondition: this.precondition\n            },\n            when: item.when,\n            order: item.order\n        });\n    }\n}\nexport class MultiCommand extends Command {\n    constructor() {\n        super(...arguments);\n        this._implementations = [];\n    }\n    /**\n     * A higher priority gets to be looked at first\n     */\n    addImplementation(priority, name, implementation) {\n        this._implementations.push({ priority, name, implementation });\n        this._implementations.sort((a, b) => b.priority - a.priority);\n        return {\n            dispose: () => {\n                for (let i = 0; i < this._implementations.length; i++) {\n                    if (this._implementations[i].implementation === implementation) {\n                        this._implementations.splice(i, 1);\n                        return;\n                    }\n                }\n            }\n        };\n    }\n    runCommand(accessor, args) {\n        const logService = accessor.get(ILogService);\n        logService.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);\n        for (const impl of this._implementations) {\n            const result = impl.implementation(accessor, args);\n            if (result) {\n                logService.trace(`Command '${this.id}' was handled by '${impl.name}'.`);\n                if (typeof result === 'boolean') {\n                    return;\n                }\n                return result;\n            }\n        }\n        logService.trace(`The Command '${this.id}' was not handled by any implementation.`);\n    }\n}\n//#endregion\n/**\n * A command that delegates to another command's implementation.\n *\n * This lets different commands be registered but share the same implementation\n */\nexport class ProxyCommand extends Command {\n    constructor(command, opts) {\n        super(opts);\n        this.command = command;\n    }\n    runCommand(accessor, args) {\n        return this.command.runCommand(accessor, args);\n    }\n}\nexport class EditorCommand extends Command {\n    /**\n     * Create a command class that is bound to a certain editor contribution.\n     */\n    static bindToContribution(controllerGetter) {\n        return class EditorControllerCommandImpl extends EditorCommand {\n            constructor(opts) {\n                super(opts);\n                this._callback = opts.handler;\n            }\n            runEditorCommand(accessor, editor, args) {\n                const controller = controllerGetter(editor);\n                if (controller) {\n                    this._callback(controller, args);\n                }\n            }\n        };\n    }\n    runCommand(accessor, args) {\n        const codeEditorService = accessor.get(ICodeEditorService);\n        // Find the editor with text focus or active\n        const editor = codeEditorService.getFocusedCodeEditor() || codeEditorService.getActiveCodeEditor();\n        if (!editor) {\n            // well, at least we tried...\n            return;\n        }\n        return editor.invokeWithinContext((editorAccessor) => {\n            const kbService = editorAccessor.get(IContextKeyService);\n            if (!kbService.contextMatchesRules(withNullAsUndefined(this.precondition))) {\n                // precondition does not hold\n                return;\n            }\n            return this.runEditorCommand(editorAccessor, editor, args);\n        });\n    }\n}\nexport class EditorAction extends EditorCommand {\n    constructor(opts) {\n        super(EditorAction.convertOptions(opts));\n        this.label = opts.label;\n        this.alias = opts.alias;\n    }\n    static convertOptions(opts) {\n        let menuOpts;\n        if (Array.isArray(opts.menuOpts)) {\n            menuOpts = opts.menuOpts;\n        }\n        else if (opts.menuOpts) {\n            menuOpts = [opts.menuOpts];\n        }\n        else {\n            menuOpts = [];\n        }\n        function withDefaults(item) {\n            if (!item.menuId) {\n                item.menuId = MenuId.EditorContext;\n            }\n            if (!item.title) {\n                item.title = opts.label;\n            }\n            item.when = ContextKeyExpr.and(opts.precondition, item.when);\n            return item;\n        }\n        if (Array.isArray(opts.contextMenuOpts)) {\n            menuOpts.push(...opts.contextMenuOpts.map(withDefaults));\n        }\n        else if (opts.contextMenuOpts) {\n            menuOpts.push(withDefaults(opts.contextMenuOpts));\n        }\n        opts.menuOpts = menuOpts;\n        return opts;\n    }\n    runEditorCommand(accessor, editor, args) {\n        this.reportTelemetry(accessor, editor);\n        return this.run(accessor, editor, args || {});\n    }\n    reportTelemetry(accessor, editor) {\n        accessor.get(ITelemetryService).publicLog2('editorActionInvoked', { name: this.label, id: this.id });\n    }\n}\nexport class MultiEditorAction extends EditorAction {\n    constructor() {\n        super(...arguments);\n        this._implementations = [];\n    }\n    /**\n     * A higher priority gets to be looked at first\n     */\n    addImplementation(priority, implementation) {\n        this._implementations.push([priority, implementation]);\n        this._implementations.sort((a, b) => b[0] - a[0]);\n        return {\n            dispose: () => {\n                for (let i = 0; i < this._implementations.length; i++) {\n                    if (this._implementations[i][1] === implementation) {\n                        this._implementations.splice(i, 1);\n                        return;\n                    }\n                }\n            }\n        };\n    }\n    run(accessor, editor, args) {\n        for (const impl of this._implementations) {\n            const result = impl[1](accessor, editor, args);\n            if (result) {\n                if (typeof result === 'boolean') {\n                    return;\n                }\n                return result;\n            }\n        }\n    }\n}\n//#endregion\n// --- Registration of commands and actions\nexport function registerModelAndPositionCommand(id, handler) {\n    CommandsRegistry.registerCommand(id, function (accessor, ...args) {\n        const instaService = accessor.get(IInstantiationService);\n        const [resource, position] = args;\n        assertType(URI.isUri(resource));\n        assertType(Position.isIPosition(position));\n        const model = accessor.get(IModelService).getModel(resource);\n        if (model) {\n            const editorPosition = Position.lift(position);\n            return instaService.invokeFunction(handler, model, editorPosition, ...args.slice(2));\n        }\n        return accessor.get(ITextModelService).createModelReference(resource).then(reference => {\n            return new Promise((resolve, reject) => {\n                try {\n                    const result = instaService.invokeFunction(handler, reference.object.textEditorModel, Position.lift(position), args.slice(2));\n                    resolve(result);\n                }\n                catch (err) {\n                    reject(err);\n                }\n            }).finally(() => {\n                reference.dispose();\n            });\n        });\n    });\n}\nexport function registerEditorCommand(editorCommand) {\n    EditorContributionRegistry.INSTANCE.registerEditorCommand(editorCommand);\n    return editorCommand;\n}\nexport function registerEditorAction(ctor) {\n    const action = new ctor();\n    EditorContributionRegistry.INSTANCE.registerEditorAction(action);\n    return action;\n}\nexport function registerMultiEditorAction(action) {\n    EditorContributionRegistry.INSTANCE.registerEditorAction(action);\n    return action;\n}\nexport function registerInstantiatedEditorAction(editorAction) {\n    EditorContributionRegistry.INSTANCE.registerEditorAction(editorAction);\n}\nexport function registerEditorContribution(id, ctor) {\n    EditorContributionRegistry.INSTANCE.registerEditorContribution(id, ctor);\n}\nexport var EditorExtensionsRegistry;\n(function (EditorExtensionsRegistry) {\n    function getEditorCommand(commandId) {\n        return EditorContributionRegistry.INSTANCE.getEditorCommand(commandId);\n    }\n    EditorExtensionsRegistry.getEditorCommand = getEditorCommand;\n    function getEditorActions() {\n        return EditorContributionRegistry.INSTANCE.getEditorActions();\n    }\n    EditorExtensionsRegistry.getEditorActions = getEditorActions;\n    function getEditorContributions() {\n        return EditorContributionRegistry.INSTANCE.getEditorContributions();\n    }\n    EditorExtensionsRegistry.getEditorContributions = getEditorContributions;\n    function getSomeEditorContributions(ids) {\n        return EditorContributionRegistry.INSTANCE.getEditorContributions().filter(c => ids.indexOf(c.id) >= 0);\n    }\n    EditorExtensionsRegistry.getSomeEditorContributions = getSomeEditorContributions;\n    function getDiffEditorContributions() {\n        return EditorContributionRegistry.INSTANCE.getDiffEditorContributions();\n    }\n    EditorExtensionsRegistry.getDiffEditorContributions = getDiffEditorContributions;\n})(EditorExtensionsRegistry || (EditorExtensionsRegistry = {}));\n// Editor extension points\nconst Extensions = {\n    EditorCommonContributions: 'editor.contributions'\n};\nclass EditorContributionRegistry {\n    constructor() {\n        this.editorContributions = [];\n        this.diffEditorContributions = [];\n        this.editorActions = [];\n        this.editorCommands = Object.create(null);\n    }\n    registerEditorContribution(id, ctor) {\n        this.editorContributions.push({ id, ctor: ctor });\n    }\n    getEditorContributions() {\n        return this.editorContributions.slice(0);\n    }\n    getDiffEditorContributions() {\n        return this.diffEditorContributions.slice(0);\n    }\n    registerEditorAction(action) {\n        action.register();\n        this.editorActions.push(action);\n    }\n    getEditorActions() {\n        return this.editorActions.slice(0);\n    }\n    registerEditorCommand(editorCommand) {\n        editorCommand.register();\n        this.editorCommands[editorCommand.id] = editorCommand;\n    }\n    getEditorCommand(commandId) {\n        return (this.editorCommands[commandId] || null);\n    }\n}\nEditorContributionRegistry.INSTANCE = new EditorContributionRegistry();\nRegistry.add(Extensions.EditorCommonContributions, EditorContributionRegistry.INSTANCE);\nfunction registerCommand(command) {\n    command.register();\n    return command;\n}\nexport const UndoCommand = registerCommand(new MultiCommand({\n    id: 'undo',\n    precondition: undefined,\n    kbOpts: {\n        weight: 0 /* EditorCore */,\n        primary: 2048 /* CtrlCmd */ | 56 /* KeyZ */\n    },\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '1_do',\n            title: nls.localize({ key: 'miUndo', comment: ['&& denotes a mnemonic'] }, \"&&Undo\"),\n            order: 1\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('undo', \"Undo\"),\n            order: 1\n        }]\n}));\nregisterCommand(new ProxyCommand(UndoCommand, { id: 'default:undo', precondition: undefined }));\nexport const RedoCommand = registerCommand(new MultiCommand({\n    id: 'redo',\n    precondition: undefined,\n    kbOpts: {\n        weight: 0 /* EditorCore */,\n        primary: 2048 /* CtrlCmd */ | 55 /* KeyY */,\n        secondary: [2048 /* CtrlCmd */ | 1024 /* Shift */ | 56 /* KeyZ */],\n        mac: { primary: 2048 /* CtrlCmd */ | 1024 /* Shift */ | 56 /* KeyZ */ }\n    },\n    menuOpts: [{\n            menuId: MenuId.MenubarEditMenu,\n            group: '1_do',\n            title: nls.localize({ key: 'miRedo', comment: ['&& denotes a mnemonic'] }, \"&&Redo\"),\n            order: 2\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('redo', \"Redo\"),\n            order: 1\n        }]\n}));\nregisterCommand(new ProxyCommand(RedoCommand, { id: 'default:redo', precondition: undefined }));\nexport const SelectAllCommand = registerCommand(new MultiCommand({\n    id: 'editor.action.selectAll',\n    precondition: undefined,\n    kbOpts: {\n        weight: 0 /* EditorCore */,\n        kbExpr: null,\n        primary: 2048 /* CtrlCmd */ | 31 /* KeyA */\n    },\n    menuOpts: [{\n            menuId: MenuId.MenubarSelectionMenu,\n            group: '1_basic',\n            title: nls.localize({ key: 'miSelectAll', comment: ['&& denotes a mnemonic'] }, \"&&Select All\"),\n            order: 1\n        }, {\n            menuId: MenuId.CommandPalette,\n            group: '',\n            title: nls.localize('selectAll', \"Select All\"),\n            order: 1\n        }]\n}));\n","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\nlet AbstractCodeEditorService = class AbstractCodeEditorService extends Disposable {\n    constructor(_themeService) {\n        super();\n        this._themeService = _themeService;\n        this._onCodeEditorAdd = this._register(new Emitter());\n        this.onCodeEditorAdd = this._onCodeEditorAdd.event;\n        this._onCodeEditorRemove = this._register(new Emitter());\n        this.onCodeEditorRemove = this._onCodeEditorRemove.event;\n        this._onDiffEditorAdd = this._register(new Emitter());\n        this.onDiffEditorAdd = this._onDiffEditorAdd.event;\n        this._onDiffEditorRemove = this._register(new Emitter());\n        this.onDiffEditorRemove = this._onDiffEditorRemove.event;\n        this._decorationOptionProviders = new Map();\n        this._modelProperties = new Map();\n        this._codeEditors = Object.create(null);\n        this._diffEditors = Object.create(null);\n        this._globalStyleSheet = null;\n    }\n    addCodeEditor(editor) {\n        this._codeEditors[editor.getId()] = editor;\n        this._onCodeEditorAdd.fire(editor);\n    }\n    removeCodeEditor(editor) {\n        if (delete this._codeEditors[editor.getId()]) {\n            this._onCodeEditorRemove.fire(editor);\n        }\n    }\n    listCodeEditors() {\n        return Object.keys(this._codeEditors).map(id => this._codeEditors[id]);\n    }\n    addDiffEditor(editor) {\n        this._diffEditors[editor.getId()] = editor;\n        this._onDiffEditorAdd.fire(editor);\n    }\n    removeDiffEditor(editor) {\n        if (delete this._diffEditors[editor.getId()]) {\n            this._onDiffEditorRemove.fire(editor);\n        }\n    }\n    listDiffEditors() {\n        return Object.keys(this._diffEditors).map(id => this._diffEditors[id]);\n    }\n    getFocusedCodeEditor() {\n        let editorWithWidgetFocus = null;\n        const editors = this.listCodeEditors();\n        for (const editor of editors) {\n            if (editor.hasTextFocus()) {\n                // bingo!\n                return editor;\n            }\n            if (editor.hasWidgetFocus()) {\n                editorWithWidgetFocus = editor;\n            }\n        }\n        return editorWithWidgetFocus;\n    }\n    removeDecorationType(key) {\n        const provider = this._decorationOptionProviders.get(key);\n        if (provider) {\n            provider.refCount--;\n            if (provider.refCount <= 0) {\n                this._decorationOptionProviders.delete(key);\n                provider.dispose();\n                this.listCodeEditors().forEach((ed) => ed.removeDecorations(key));\n            }\n        }\n    }\n    setModelProperty(resource, key, value) {\n        const key1 = resource.toString();\n        let dest;\n        if (this._modelProperties.has(key1)) {\n            dest = this._modelProperties.get(key1);\n        }\n        else {\n            dest = new Map();\n            this._modelProperties.set(key1, dest);\n        }\n        dest.set(key, value);\n    }\n    getModelProperty(resource, key) {\n        const key1 = resource.toString();\n        if (this._modelProperties.has(key1)) {\n            const innerMap = this._modelProperties.get(key1);\n            return innerMap.get(key);\n        }\n        return undefined;\n    }\n};\nAbstractCodeEditorService = __decorate([\n    __param(0, IThemeService)\n], AbstractCodeEditorService);\nexport { AbstractCodeEditorService };\nexport class GlobalStyleSheet {\n    constructor(styleSheet) {\n        this._styleSheet = styleSheet;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { isObject } from '../../../base/common/types.js';\nexport const IBulkEditService = createDecorator('IWorkspaceEditService');\nfunction isWorkspaceFileEdit(thing) {\n    return isObject(thing) && (Boolean(thing.newUri) || Boolean(thing.oldUri));\n}\nfunction isWorkspaceTextEdit(thing) {\n    return isObject(thing) && URI.isUri(thing.resource) && isObject(thing.edit);\n}\nexport class ResourceEdit {\n    constructor(metadata) {\n        this.metadata = metadata;\n    }\n    static convert(edit) {\n        return edit.edits.map(edit => {\n            if (isWorkspaceTextEdit(edit)) {\n                return new ResourceTextEdit(edit.resource, edit.edit, edit.modelVersionId, edit.metadata);\n            }\n            if (isWorkspaceFileEdit(edit)) {\n                return new ResourceFileEdit(edit.oldUri, edit.newUri, edit.options, edit.metadata);\n            }\n            throw new Error('Unsupported edit');\n        });\n    }\n}\nexport class ResourceTextEdit extends ResourceEdit {\n    constructor(resource, textEdit, versionId, metadata) {\n        super(metadata);\n        this.resource = resource;\n        this.textEdit = textEdit;\n        this.versionId = versionId;\n    }\n}\nexport class ResourceFileEdit extends ResourceEdit {\n    constructor(oldResource, newResource, options, metadata) {\n        super(metadata);\n        this.oldResource = oldResource;\n        this.newResource = newResource;\n        this.options = options;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createDecorator } from '../../../platform/instantiation/common/instantiation.js';\nexport const ICodeEditorService = createDecorator('codeEditorService');\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { IntervalTimer, timeout } from '../../../base/common/async.js';\nimport { Disposable, dispose, toDisposable, DisposableStore } from '../../../base/common/lifecycle.js';\nimport { SimpleWorkerClient, logOnceWebWorkerWarning } from '../../../base/common/worker/simpleWorker.js';\nimport { DefaultWorkerFactory } from '../../../base/browser/defaultWorkerFactory.js';\nimport { Range } from '../../common/core/range.js';\nimport { ILanguageConfigurationService } from '../../common/languages/languageConfigurationRegistry.js';\nimport { EditorSimpleWorker } from '../../common/services/editorSimpleWorker.js';\nimport { IModelService } from '../../common/services/model.js';\nimport { ITextResourceConfigurationService } from '../../common/services/textResourceConfiguration.js';\nimport { regExpFlags } from '../../../base/common/strings.js';\nimport { isNonEmptyArray } from '../../../base/common/arrays.js';\nimport { ILogService } from '../../../platform/log/common/log.js';\nimport { StopWatch } from '../../../base/common/stopwatch.js';\nimport { canceled } from '../../../base/common/errors.js';\nimport { ILanguageFeaturesService } from '../../common/services/languageFeatures.js';\n/**\n * Stop syncing a model to the worker if it was not needed for 1 min.\n */\nconst STOP_SYNC_MODEL_DELTA_TIME_MS = 60 * 1000;\n/**\n * Stop the worker if it was not needed for 5 min.\n */\nconst STOP_WORKER_DELTA_TIME_MS = 5 * 60 * 1000;\nfunction canSyncModel(modelService, resource) {\n    const model = modelService.getModel(resource);\n    if (!model) {\n        return false;\n    }\n    if (model.isTooLargeForSyncing()) {\n        return false;\n    }\n    return true;\n}\nlet EditorWorkerService = class EditorWorkerService extends Disposable {\n    constructor(modelService, configurationService, logService, languageConfigurationService, languageFeaturesService) {\n        super();\n        this._modelService = modelService;\n        this._workerManager = this._register(new WorkerManager(this._modelService, languageConfigurationService));\n        this._logService = logService;\n        // register default link-provider and default completions-provider\n        this._register(languageFeaturesService.linkProvider.register({ language: '*', hasAccessToAllModels: true }, {\n            provideLinks: (model, token) => {\n                if (!canSyncModel(this._modelService, model.uri)) {\n                    return Promise.resolve({ links: [] }); // File too large\n                }\n                return this._workerManager.withWorker().then(client => client.computeLinks(model.uri)).then(links => {\n                    return links && { links };\n                });\n            }\n        }));\n        this._register(languageFeaturesService.completionProvider.register('*', new WordBasedCompletionItemProvider(this._workerManager, configurationService, this._modelService, languageConfigurationService)));\n    }\n    dispose() {\n        super.dispose();\n    }\n    canComputeUnicodeHighlights(uri) {\n        return canSyncModel(this._modelService, uri);\n    }\n    computedUnicodeHighlights(uri, options, range) {\n        return this._workerManager.withWorker().then(client => client.computedUnicodeHighlights(uri, options, range));\n    }\n    computeDiff(original, modified, ignoreTrimWhitespace, maxComputationTime) {\n        return this._workerManager.withWorker().then(client => client.computeDiff(original, modified, ignoreTrimWhitespace, maxComputationTime));\n    }\n    computeMoreMinimalEdits(resource, edits) {\n        if (isNonEmptyArray(edits)) {\n            if (!canSyncModel(this._modelService, resource)) {\n                return Promise.resolve(edits); // File too large\n            }\n            const sw = StopWatch.create(true);\n            const result = this._workerManager.withWorker().then(client => client.computeMoreMinimalEdits(resource, edits));\n            result.finally(() => this._logService.trace('FORMAT#computeMoreMinimalEdits', resource.toString(true), sw.elapsed()));\n            return Promise.race([result, timeout(1000).then(() => edits)]);\n        }\n        else {\n            return Promise.resolve(undefined);\n        }\n    }\n    canNavigateValueSet(resource) {\n        return (canSyncModel(this._modelService, resource));\n    }\n    navigateValueSet(resource, range, up) {\n        return this._workerManager.withWorker().then(client => client.navigateValueSet(resource, range, up));\n    }\n    canComputeWordRanges(resource) {\n        return canSyncModel(this._modelService, resource);\n    }\n    computeWordRanges(resource, range) {\n        return this._workerManager.withWorker().then(client => client.computeWordRanges(resource, range));\n    }\n};\nEditorWorkerService = __decorate([\n    __param(0, IModelService),\n    __param(1, ITextResourceConfigurationService),\n    __param(2, ILogService),\n    __param(3, ILanguageConfigurationService),\n    __param(4, ILanguageFeaturesService)\n], EditorWorkerService);\nexport { EditorWorkerService };\nclass WordBasedCompletionItemProvider {\n    constructor(workerManager, configurationService, modelService, languageConfigurationService) {\n        this.languageConfigurationService = languageConfigurationService;\n        this._debugDisplayName = 'wordbasedCompletions';\n        this._workerManager = workerManager;\n        this._configurationService = configurationService;\n        this._modelService = modelService;\n    }\n    provideCompletionItems(model, position) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const config = this._configurationService.getValue(model.uri, position, 'editor');\n            if (!config.wordBasedSuggestions) {\n                return undefined;\n            }\n            const models = [];\n            if (config.wordBasedSuggestionsMode === 'currentDocument') {\n                // only current file and only if not too large\n                if (canSyncModel(this._modelService, model.uri)) {\n                    models.push(model.uri);\n                }\n            }\n            else {\n                // either all files or files of same language\n                for (const candidate of this._modelService.getModels()) {\n                    if (!canSyncModel(this._modelService, candidate.uri)) {\n                        continue;\n                    }\n                    if (candidate === model) {\n                        models.unshift(candidate.uri);\n                    }\n                    else if (config.wordBasedSuggestionsMode === 'allDocuments' || candidate.getLanguageId() === model.getLanguageId()) {\n                        models.push(candidate.uri);\n                    }\n                }\n            }\n            if (models.length === 0) {\n                return undefined; // File too large, no other files\n            }\n            const wordDefRegExp = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n            const word = model.getWordAtPosition(position);\n            const replace = !word ? Range.fromPositions(position) : new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n            const insert = replace.setEndPosition(position.lineNumber, position.column);\n            const client = yield this._workerManager.withWorker();\n            const data = yield client.textualSuggest(models, word === null || word === void 0 ? void 0 : word.word, wordDefRegExp);\n            if (!data) {\n                return undefined;\n            }\n            return {\n                duration: data.duration,\n                suggestions: data.words.map((word) => {\n                    return {\n                        kind: 18 /* Text */,\n                        label: word,\n                        insertText: word,\n                        range: { insert, replace }\n                    };\n                }),\n            };\n        });\n    }\n}\nclass WorkerManager extends Disposable {\n    constructor(modelService, languageConfigurationService) {\n        super();\n        this.languageConfigurationService = languageConfigurationService;\n        this._modelService = modelService;\n        this._editorWorkerClient = null;\n        this._lastWorkerUsedTime = (new Date()).getTime();\n        const stopWorkerInterval = this._register(new IntervalTimer());\n        stopWorkerInterval.cancelAndSet(() => this._checkStopIdleWorker(), Math.round(STOP_WORKER_DELTA_TIME_MS / 2));\n        this._register(this._modelService.onModelRemoved(_ => this._checkStopEmptyWorker()));\n    }\n    dispose() {\n        if (this._editorWorkerClient) {\n            this._editorWorkerClient.dispose();\n            this._editorWorkerClient = null;\n        }\n        super.dispose();\n    }\n    /**\n     * Check if the model service has no more models and stop the worker if that is the case.\n     */\n    _checkStopEmptyWorker() {\n        if (!this._editorWorkerClient) {\n            return;\n        }\n        const models = this._modelService.getModels();\n        if (models.length === 0) {\n            // There are no more models => nothing possible for me to do\n            this._editorWorkerClient.dispose();\n            this._editorWorkerClient = null;\n        }\n    }\n    /**\n     * Check if the worker has been idle for a while and then stop it.\n     */\n    _checkStopIdleWorker() {\n        if (!this._editorWorkerClient) {\n            return;\n        }\n        const timeSinceLastWorkerUsedTime = (new Date()).getTime() - this._lastWorkerUsedTime;\n        if (timeSinceLastWorkerUsedTime > STOP_WORKER_DELTA_TIME_MS) {\n            this._editorWorkerClient.dispose();\n            this._editorWorkerClient = null;\n        }\n    }\n    withWorker() {\n        this._lastWorkerUsedTime = (new Date()).getTime();\n        if (!this._editorWorkerClient) {\n            this._editorWorkerClient = new EditorWorkerClient(this._modelService, false, 'editorWorkerService', this.languageConfigurationService);\n        }\n        return Promise.resolve(this._editorWorkerClient);\n    }\n}\nclass EditorModelManager extends Disposable {\n    constructor(proxy, modelService, keepIdleModels) {\n        super();\n        this._syncedModels = Object.create(null);\n        this._syncedModelsLastUsedTime = Object.create(null);\n        this._proxy = proxy;\n        this._modelService = modelService;\n        if (!keepIdleModels) {\n            const timer = new IntervalTimer();\n            timer.cancelAndSet(() => this._checkStopModelSync(), Math.round(STOP_SYNC_MODEL_DELTA_TIME_MS / 2));\n            this._register(timer);\n        }\n    }\n    dispose() {\n        for (let modelUrl in this._syncedModels) {\n            dispose(this._syncedModels[modelUrl]);\n        }\n        this._syncedModels = Object.create(null);\n        this._syncedModelsLastUsedTime = Object.create(null);\n        super.dispose();\n    }\n    ensureSyncedResources(resources, forceLargeModels) {\n        for (const resource of resources) {\n            const resourceStr = resource.toString();\n            if (!this._syncedModels[resourceStr]) {\n                this._beginModelSync(resource, forceLargeModels);\n            }\n            if (this._syncedModels[resourceStr]) {\n                this._syncedModelsLastUsedTime[resourceStr] = (new Date()).getTime();\n            }\n        }\n    }\n    _checkStopModelSync() {\n        const currentTime = (new Date()).getTime();\n        const toRemove = [];\n        for (let modelUrl in this._syncedModelsLastUsedTime) {\n            const elapsedTime = currentTime - this._syncedModelsLastUsedTime[modelUrl];\n            if (elapsedTime > STOP_SYNC_MODEL_DELTA_TIME_MS) {\n                toRemove.push(modelUrl);\n            }\n        }\n        for (const e of toRemove) {\n            this._stopModelSync(e);\n        }\n    }\n    _beginModelSync(resource, forceLargeModels) {\n        const model = this._modelService.getModel(resource);\n        if (!model) {\n            return;\n        }\n        if (!forceLargeModels && model.isTooLargeForSyncing()) {\n            return;\n        }\n        const modelUrl = resource.toString();\n        this._proxy.acceptNewModel({\n            url: model.uri.toString(),\n            lines: model.getLinesContent(),\n            EOL: model.getEOL(),\n            versionId: model.getVersionId()\n        });\n        const toDispose = new DisposableStore();\n        toDispose.add(model.onDidChangeContent((e) => {\n            this._proxy.acceptModelChanged(modelUrl.toString(), e);\n        }));\n        toDispose.add(model.onWillDispose(() => {\n            this._stopModelSync(modelUrl);\n        }));\n        toDispose.add(toDisposable(() => {\n            this._proxy.acceptRemovedModel(modelUrl);\n        }));\n        this._syncedModels[modelUrl] = toDispose;\n    }\n    _stopModelSync(modelUrl) {\n        const toDispose = this._syncedModels[modelUrl];\n        delete this._syncedModels[modelUrl];\n        delete this._syncedModelsLastUsedTime[modelUrl];\n        dispose(toDispose);\n    }\n}\nclass SynchronousWorkerClient {\n    constructor(instance) {\n        this._instance = instance;\n        this._proxyObj = Promise.resolve(this._instance);\n    }\n    dispose() {\n        this._instance.dispose();\n    }\n    getProxyObject() {\n        return this._proxyObj;\n    }\n}\nexport class EditorWorkerHost {\n    constructor(workerClient) {\n        this._workerClient = workerClient;\n    }\n    // foreign host request\n    fhr(method, args) {\n        return this._workerClient.fhr(method, args);\n    }\n}\nexport class EditorWorkerClient extends Disposable {\n    constructor(modelService, keepIdleModels, label, languageConfigurationService) {\n        super();\n        this.languageConfigurationService = languageConfigurationService;\n        this._disposed = false;\n        this._modelService = modelService;\n        this._keepIdleModels = keepIdleModels;\n        this._workerFactory = new DefaultWorkerFactory(label);\n        this._worker = null;\n        this._modelManager = null;\n    }\n    // foreign host request\n    fhr(method, args) {\n        throw new Error(`Not implemented!`);\n    }\n    _getOrCreateWorker() {\n        if (!this._worker) {\n            try {\n                this._worker = this._register(new SimpleWorkerClient(this._workerFactory, 'vs/editor/common/services/editorSimpleWorker', new EditorWorkerHost(this)));\n            }\n            catch (err) {\n                logOnceWebWorkerWarning(err);\n                this._worker = new SynchronousWorkerClient(new EditorSimpleWorker(new EditorWorkerHost(this), null));\n            }\n        }\n        return this._worker;\n    }\n    _getProxy() {\n        return this._getOrCreateWorker().getProxyObject().then(undefined, (err) => {\n            logOnceWebWorkerWarning(err);\n            this._worker = new SynchronousWorkerClient(new EditorSimpleWorker(new EditorWorkerHost(this), null));\n            return this._getOrCreateWorker().getProxyObject();\n        });\n    }\n    _getOrCreateModelManager(proxy) {\n        if (!this._modelManager) {\n            this._modelManager = this._register(new EditorModelManager(proxy, this._modelService, this._keepIdleModels));\n        }\n        return this._modelManager;\n    }\n    _withSyncedResources(resources, forceLargeModels = false) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._disposed) {\n                return Promise.reject(canceled());\n            }\n            return this._getProxy().then((proxy) => {\n                this._getOrCreateModelManager(proxy).ensureSyncedResources(resources, forceLargeModels);\n                return proxy;\n            });\n        });\n    }\n    computedUnicodeHighlights(uri, options, range) {\n        return this._withSyncedResources([uri]).then(proxy => {\n            return proxy.computeUnicodeHighlights(uri.toString(), options, range);\n        });\n    }\n    computeDiff(original, modified, ignoreTrimWhitespace, maxComputationTime) {\n        return this._withSyncedResources([original, modified], /* forceLargeModels */ true).then(proxy => {\n            return proxy.computeDiff(original.toString(), modified.toString(), ignoreTrimWhitespace, maxComputationTime);\n        });\n    }\n    computeMoreMinimalEdits(resource, edits) {\n        return this._withSyncedResources([resource]).then(proxy => {\n            return proxy.computeMoreMinimalEdits(resource.toString(), edits);\n        });\n    }\n    computeLinks(resource) {\n        return this._withSyncedResources([resource]).then(proxy => {\n            return proxy.computeLinks(resource.toString());\n        });\n    }\n    textualSuggest(resources, leadingWord, wordDefRegExp) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const proxy = yield this._withSyncedResources(resources);\n            const wordDef = wordDefRegExp.source;\n            const wordDefFlags = regExpFlags(wordDefRegExp);\n            return proxy.textualSuggest(resources.map(r => r.toString()), leadingWord, wordDef, wordDefFlags);\n        });\n    }\n    computeWordRanges(resource, range) {\n        return this._withSyncedResources([resource]).then(proxy => {\n            const model = this._modelService.getModel(resource);\n            if (!model) {\n                return Promise.resolve(null);\n            }\n            const wordDefRegExp = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n            const wordDef = wordDefRegExp.source;\n            const wordDefFlags = regExpFlags(wordDefRegExp);\n            return proxy.computeWordRanges(resource.toString(), range, wordDef, wordDefFlags);\n        });\n    }\n    navigateValueSet(resource, range, up) {\n        return this._withSyncedResources([resource]).then(proxy => {\n            const model = this._modelService.getModel(resource);\n            if (!model) {\n                return null;\n            }\n            const wordDefRegExp = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n            const wordDef = wordDefRegExp.source;\n            const wordDefFlags = regExpFlags(wordDefRegExp);\n            return proxy.navigateValueSet(resource.toString(), range, up, wordDef, wordDefFlags);\n        });\n    }\n    dispose() {\n        super.dispose();\n        this._disposed = true;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { IMarkerDecorationsService } from '../../common/services/markerDecorations.js';\nimport { registerEditorContribution } from '../editorExtensions.js';\nlet MarkerDecorationsContribution = class MarkerDecorationsContribution {\n    constructor(_editor, _markerDecorationsService) {\n        // Doesn't do anything, just requires `IMarkerDecorationsService` to make sure it gets instantiated\n    }\n    dispose() {\n    }\n};\nMarkerDecorationsContribution.ID = 'editor.contrib.markerDecorations';\nMarkerDecorationsContribution = __decorate([\n    __param(1, IMarkerDecorationsService)\n], MarkerDecorationsContribution);\nexport { MarkerDecorationsContribution };\nregisterEditorContribution(MarkerDecorationsContribution.ID, MarkerDecorationsContribution);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../base/browser/dom.js';\nimport { CancellationToken } from '../../../base/common/cancellation.js';\nimport { LinkedList } from '../../../base/common/linkedList.js';\nimport { ResourceMap } from '../../../base/common/map.js';\nimport { parse } from '../../../base/common/marshalling.js';\nimport { Schemas } from '../../../base/common/network.js';\nimport { normalizePath } from '../../../base/common/resources.js';\nimport { URI } from '../../../base/common/uri.js';\nimport { ICodeEditorService } from './codeEditorService.js';\nimport { ICommandService } from '../../../platform/commands/common/commands.js';\nimport { EditorOpenSource } from '../../../platform/editor/common/editor.js';\nimport { extractSelection, matchesScheme, matchesSomeScheme } from '../../../platform/opener/common/opener.js';\nlet CommandOpener = class CommandOpener {\n    constructor(_commandService) {\n        this._commandService = _commandService;\n    }\n    open(target, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!matchesScheme(target, Schemas.command)) {\n                return false;\n            }\n            if (!(options === null || options === void 0 ? void 0 : options.allowCommands)) {\n                // silently ignore commands when command-links are disabled, also\n                // surpress other openers by returning TRUE\n                return true;\n            }\n            // run command or bail out if command isn't known\n            if (typeof target === 'string') {\n                target = URI.parse(target);\n            }\n            // execute as command\n            let args = [];\n            try {\n                args = parse(decodeURIComponent(target.query));\n            }\n            catch (_a) {\n                // ignore and retry\n                try {\n                    args = parse(target.query);\n                }\n                catch (_b) {\n                    // ignore error\n                }\n            }\n            if (!Array.isArray(args)) {\n                args = [args];\n            }\n            yield this._commandService.executeCommand(target.path, ...args);\n            return true;\n        });\n    }\n};\nCommandOpener = __decorate([\n    __param(0, ICommandService)\n], CommandOpener);\nlet EditorOpener = class EditorOpener {\n    constructor(_editorService) {\n        this._editorService = _editorService;\n    }\n    open(target, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (typeof target === 'string') {\n                target = URI.parse(target);\n            }\n            const { selection, uri } = extractSelection(target);\n            target = uri;\n            if (target.scheme === Schemas.file) {\n                target = normalizePath(target); // workaround for non-normalized paths (https://github.com/microsoft/vscode/issues/12954)\n            }\n            yield this._editorService.openCodeEditor({\n                resource: target,\n                options: Object.assign({ selection, source: (options === null || options === void 0 ? void 0 : options.fromUserGesture) ? EditorOpenSource.USER : EditorOpenSource.API }, options === null || options === void 0 ? void 0 : options.editorOptions)\n            }, this._editorService.getFocusedCodeEditor(), options === null || options === void 0 ? void 0 : options.openToSide);\n            return true;\n        });\n    }\n};\nEditorOpener = __decorate([\n    __param(0, ICodeEditorService)\n], EditorOpener);\nlet OpenerService = class OpenerService {\n    constructor(editorService, commandService) {\n        this._openers = new LinkedList();\n        this._validators = new LinkedList();\n        this._resolvers = new LinkedList();\n        this._resolvedUriTargets = new ResourceMap(uri => uri.with({ path: null, fragment: null, query: null }).toString());\n        this._externalOpeners = new LinkedList();\n        // Default external opener is going through window.open()\n        this._defaultExternalOpener = {\n            openExternal: (href) => __awaiter(this, void 0, void 0, function* () {\n                // ensure to open HTTP/HTTPS links into new windows\n                // to not trigger a navigation. Any other link is\n                // safe to be set as HREF to prevent a blank window\n                // from opening.\n                if (matchesSomeScheme(href, Schemas.http, Schemas.https)) {\n                    dom.windowOpenNoOpener(href);\n                }\n                else {\n                    window.location.href = href;\n                }\n                return true;\n            })\n        };\n        // Default opener: any external, maito, http(s), command, and catch-all-editors\n        this._openers.push({\n            open: (target, options) => __awaiter(this, void 0, void 0, function* () {\n                if ((options === null || options === void 0 ? void 0 : options.openExternal) || matchesSomeScheme(target, Schemas.mailto, Schemas.http, Schemas.https, Schemas.vsls)) {\n                    // open externally\n                    yield this._doOpenExternal(target, options);\n                    return true;\n                }\n                return false;\n            })\n        });\n        this._openers.push(new CommandOpener(commandService));\n        this._openers.push(new EditorOpener(editorService));\n    }\n    registerOpener(opener) {\n        const remove = this._openers.unshift(opener);\n        return { dispose: remove };\n    }\n    registerValidator(validator) {\n        const remove = this._validators.push(validator);\n        return { dispose: remove };\n    }\n    registerExternalUriResolver(resolver) {\n        const remove = this._resolvers.push(resolver);\n        return { dispose: remove };\n    }\n    setDefaultExternalOpener(externalOpener) {\n        this._defaultExternalOpener = externalOpener;\n    }\n    registerExternalOpener(opener) {\n        const remove = this._externalOpeners.push(opener);\n        return { dispose: remove };\n    }\n    open(target, options) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            // check with contributed validators\n            const targetURI = typeof target === 'string' ? URI.parse(target) : target;\n            // validate against the original URI that this URI resolves to, if one exists\n            const validationTarget = (_a = this._resolvedUriTargets.get(targetURI)) !== null && _a !== void 0 ? _a : target;\n            for (const validator of this._validators) {\n                if (!(yield validator.shouldOpen(validationTarget))) {\n                    return false;\n                }\n            }\n            // check with contributed openers\n            for (const opener of this._openers) {\n                const handled = yield opener.open(target, options);\n                if (handled) {\n                    return true;\n                }\n            }\n            return false;\n        });\n    }\n    resolveExternalUri(resource, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (const resolver of this._resolvers) {\n                try {\n                    const result = yield resolver.resolveExternalUri(resource, options);\n                    if (result) {\n                        if (!this._resolvedUriTargets.has(result.resolved)) {\n                            this._resolvedUriTargets.set(result.resolved, resource);\n                        }\n                        return result;\n                    }\n                }\n                catch (_a) {\n                    // noop\n                }\n            }\n            throw new Error('Could not resolve external URI: ' + resource.toString());\n        });\n    }\n    _doOpenExternal(resource, options) {\n        return __awaiter(this, void 0, void 0, function* () {\n            //todo@jrieken IExternalUriResolver should support `uri: URI | string`\n            const uri = typeof resource === 'string' ? URI.parse(resource) : resource;\n            let externalUri;\n            try {\n                externalUri = (yield this.resolveExternalUri(uri, options)).resolved;\n            }\n            catch (_a) {\n                externalUri = uri;\n            }\n            let href;\n            if (typeof resource === 'string' && uri.toString() === externalUri.toString()) {\n                // open the url-string AS IS\n                href = resource;\n            }\n            else {\n                // open URI using the toString(noEncode)+encodeURI-trick\n                href = encodeURI(externalUri.toString(true));\n            }\n            if (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) {\n                const preferredOpenerId = typeof (options === null || options === void 0 ? void 0 : options.allowContributedOpeners) === 'string' ? options === null || options === void 0 ? void 0 : options.allowContributedOpeners : undefined;\n                for (const opener of this._externalOpeners) {\n                    const didOpen = yield opener.openExternal(href, {\n                        sourceUri: uri,\n                        preferredOpenerId,\n                    }, CancellationToken.None);\n                    if (didOpen) {\n                        return true;\n                    }\n                }\n            }\n            return this._defaultExternalOpener.openExternal(href, { sourceUri: uri }, CancellationToken.None);\n        });\n    }\n    dispose() {\n        this._validators.clear();\n    }\n};\nOpenerService = __decorate([\n    __param(0, ICodeEditorService),\n    __param(1, ICommandService)\n], OpenerService);\nexport { OpenerService };\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorWorkerClient } from './editorWorkerService.js';\nimport * as types from '../../../base/common/types.js';\n/**\n * Create a new web worker that has model syncing capabilities built in.\n * Specify an AMD module to load that will `create` an object that will be proxied.\n */\nexport function createWebWorker(modelService, languageConfigurationService, opts) {\n    return new MonacoWebWorkerImpl(modelService, languageConfigurationService, opts);\n}\nclass MonacoWebWorkerImpl extends EditorWorkerClient {\n    constructor(modelService, languageConfigurationService, opts) {\n        super(modelService, opts.keepIdleModels || false, opts.label, languageConfigurationService);\n        this._foreignModuleId = opts.moduleId;\n        this._foreignModuleCreateData = opts.createData || null;\n        this._foreignModuleHost = opts.host || null;\n        this._foreignProxy = null;\n    }\n    // foreign host request\n    fhr(method, args) {\n        if (!this._foreignModuleHost || typeof this._foreignModuleHost[method] !== 'function') {\n            return Promise.reject(new Error('Missing method ' + method + ' or missing main thread foreign host.'));\n        }\n        try {\n            return Promise.resolve(this._foreignModuleHost[method].apply(this._foreignModuleHost, args));\n        }\n        catch (e) {\n            return Promise.reject(e);\n        }\n    }\n    _getForeignProxy() {\n        if (!this._foreignProxy) {\n            this._foreignProxy = this._getProxy().then((proxy) => {\n                const foreignHostMethods = this._foreignModuleHost ? types.getAllMethodNames(this._foreignModuleHost) : [];\n                return proxy.loadForeignModule(this._foreignModuleId, this._foreignModuleCreateData, foreignHostMethods).then((foreignMethods) => {\n                    this._foreignModuleCreateData = null;\n                    const proxyMethodRequest = (method, args) => {\n                        return proxy.fmr(method, args);\n                    };\n                    const createProxyMethod = (method, proxyMethodRequest) => {\n                        return function () {\n                            const args = Array.prototype.slice.call(arguments, 0);\n                            return proxyMethodRequest(method, args);\n                        };\n                    };\n                    const foreignProxy = {};\n                    for (const foreignMethod of foreignMethods) {\n                        foreignProxy[foreignMethod] = createProxyMethod(foreignMethod, proxyMethodRequest);\n                    }\n                    return foreignProxy;\n                });\n            });\n        }\n        return this._foreignProxy;\n    }\n    getProxy() {\n        return this._getForeignProxy();\n    }\n    withSyncedResources(resources) {\n        return this._withSyncedResources(resources).then(_ => this.getProxy());\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class StableEditorScrollState {\n    constructor(_visiblePosition, _visiblePositionScrollDelta, _cursorPosition) {\n        this._visiblePosition = _visiblePosition;\n        this._visiblePositionScrollDelta = _visiblePositionScrollDelta;\n        this._cursorPosition = _cursorPosition;\n    }\n    static capture(editor) {\n        let visiblePosition = null;\n        let visiblePositionScrollDelta = 0;\n        if (editor.getScrollTop() !== 0) {\n            const visibleRanges = editor.getVisibleRanges();\n            if (visibleRanges.length > 0) {\n                visiblePosition = visibleRanges[0].getStartPosition();\n                const visiblePositionScrollTop = editor.getTopForPosition(visiblePosition.lineNumber, visiblePosition.column);\n                visiblePositionScrollDelta = editor.getScrollTop() - visiblePositionScrollTop;\n            }\n        }\n        return new StableEditorScrollState(visiblePosition, visiblePositionScrollDelta, editor.getPosition());\n    }\n    restore(editor) {\n        if (this._visiblePosition) {\n            const visiblePositionScrollTop = editor.getTopForPosition(this._visiblePosition.lineNumber, this._visiblePosition.column);\n            editor.setScrollTop(visiblePositionScrollTop + this._visiblePositionScrollDelta);\n        }\n    }\n    restoreRelativeVerticalPositionOfCursor(editor) {\n        const currentCursorPosition = editor.getPosition();\n        if (!this._cursorPosition || !currentCursorPosition) {\n            return;\n        }\n        const offset = editor.getTopForLineNumber(currentCursorPosition.lineNumber) - editor.getTopForLineNumber(this._cursorPosition.lineNumber);\n        editor.setScrollTop(editor.getScrollTop() + offset);\n    }\n}\n"],"names":["applyFontInfo","domNode","fontInfo","FastDomNode","setFontFamily","getMassagedFontFamily","browser","EDITOR_FONT_DEFAULTS","setFontWeight","fontWeight","setFontSize","fontSize","setFontFeatureSettings","fontFeatureSettings","setLineHeight","lineHeight","setLetterSpacing","letterSpacing","style","fontFamily","__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","EditorConfiguration","isSimpleWidget","options","container","_accessibilityService","_onDidChange","_register","Emitter","onDidChange","event","_onDidChangeFast","onDidChangeFast","_isDominatedByLongLines","_viewLineCount","_lineNumbersDigitCount","_reservedHeight","_computeOptionsMemory","ComputeOptionsMemory","_containerObserver","ElementSizeObserver","dimension","_rawOptions","deepCloneAndMigrateOptions","_validatedOptions","EditorOptionsUtil","validateOptions","_computeOptions","get","startObserving","EditorZoom","_recomputeOptions","TabFocus","FontMeasurements","PixelRatio","onDidChangeScreenReaderOptimized","newOptions","this","changeEvent","checkEquals","fire","partialEnv","_readEnvConfiguration","bareFontInfo","BareFontInfo","pixelRatio","_readFontInfo","env","memory","outerWidth","outerHeight","extraEditorClassName","isDominatedByLongLines","viewLineCount","lineNumbersDigitCount","emptySelectionClipboard","tabFocusMode","accessibilitySupport","computeOptions","getExtraEditorClassName","getWidth","getHeight","isWebKit","isFirefox","value","isScreenReaderOptimized","getAccessibilitySupport","_newOptions","applyUpdate","observe","modelLineCount","n","Math","floor","digitCount","reservedHeight","Disposable","extra","isSafari","isWebkitWebView","platform","IAccessibilityService","ValidatedEditorOptions","_values","option","id","ComputedEditorOptions","Error","_read","result","editorOptionsRegistry","editorOption","name","undefined","_write","validate","compute","a","b","Array","isArray","arrays","keys","_deepEquals","somethingChanged","changed","ConfigurationChangedEvent","update","hasOwnProperty","newValue","didChange","_options","objects","wordWrap","lineNumbers","autoClosingBrackets","autoClosingQuotes","autoSurround","cursorBlinking","renderWhitespace","renderLineHighlight","acceptSuggestionOnEnter","tabCompletion","suggest","filteredTypes","mapping","forEach","entry","hover","enabled","parameterHints","autoIndent","matchBrackets","renderIndentGuides","highlightActiveIndentGuide","guides","indentation","highlightActiveIndentation","migrateOptions","referenceDomElement","_referenceDomElement","_width","_height","_resizeObserver","measureReferenceDomElement","stopObserving","ResizeObserver","entries","contentRect","width","height","disconnect","emitEvent","observedWidth","observedHeight","clientWidth","clientHeight","max","CharWidthRequest","chr","type","DomCharWidthReader","requests","_bareFontInfo","_requests","_container","_testElements","_createDomElements","document","body","appendChild","_readFromDomElements","removeChild","createElement","position","top","regularDomNode","boldDomNode","italicDomNode","fontStyle","testElements","request","parent","testElement","_render","push","len","fulfill","offsetWidth","htmlString","innerText","testString","textContent","FontMeasurementsImpl","_cache","FontMeasurementsCache","_evictUntrustedReadingsTimeout","window","clearTimeout","item","put","isTrusted","setTimeout","_evictUntrustedReadings","values","getValues","somethingRemoved","remove","has","readConfig","_actualReadFontInfo","typicalHalfwidthCharacterWidth","typicalFullwidthCharacterWidth","spaceWidth","maxDigitWidth","FontInfo","isMonospace","canUseHalfwidthRightwardsArrow","middotWidth","wsmiddotWidth","_writeToCache","all","monospace","typicalHalfwidthCharacter","_createRequest","typicalFullwidthCharacter","space","digit0","digit1","digit2","digit3","digit4","digit5","digit6","digit7","digit8","digit9","rightwardsArrow","halfwidthRightwardsArrow","middot","String","fromCharCode","monospaceTestChars","charAt","read","readCharWidths","EditorFontLigatures","referenceWidth","diff","_keys","create","itemId","getId","map","TabFocusImpl","_tabFocus","_onDidChangeTabFocus","onDidChangeTabFocus","HitTestResult","UnknownHitTestResult","hitTarget","ContentHitTestResult","spanNode","injectedText","createFromDOMInfo","ctx","offset","getPositionFromDOMInfo","PointerHandlerLastRenderData","lastViewCursorsRenderData","lastTextareaPosition","MouseTarget","range","EditorRange","lineNumber","column","element","mouseColumn","_deduceRage","detail","_typeToString","JSON","stringify","ElementPath","path","HitTestContext","context","viewHelper","lastRenderData","viewModel","configuration","layoutInfo","viewDomNode","stickyTabStops","_context","_viewHelper","mouseVerticalOffset","getZoneAtCoord","viewLayout","isAfterLines","getLineCount","maxLineColumn","getLineMaxColumn","getLineNumberAtVerticalOffset","isInTopPadding","isInBottomPadding","getVerticalOffsetForLineNumber","attr","_findAttribute","getLineWidth","visibleRangeForPosition","getCurrentScrollTop","getCurrentScrollLeft","viewZoneWhitespace","getWhitespaceAtVerticalOffset","viewZoneMiddle","verticalOffset","lineCount","positionBefore","positionAfter","afterLineNumber","Position","viewZoneId","stopAt","hasAttribute","getAttribute","parentNode","HitTestRequest","editorPos","pos","relativePos","_ctx","targetPath","PartFingerprints","Uint8Array","x","y","mouseContentHorizontalOffset","outerHTML","CursorColumns","getLineContent","model","getOptions","tabSize","createUnknown","_getMouseColumn","createTextarea","createMargin","createViewZone","createContentText","createContentEmpty","createContentWidget","createScrollbar","createOverlayWidget","BareHitTestRequest","contentLeft","isInMarginArea","glyphMarginLeft","isInContentArea","MouseTargetFactory","EMPTY_CONTENT_AFTER_LINES","createEmptyContentDataInLines","horizontalDistanceToText","e","t","isChildOfContentWidgets","isChildOfOverflowingContentWidgets","isChildOfOverlayWidgets","_createMouseTarget","err","fulfillUnknown","domHitTestExecuted","hitTestResult","_doHitTest","createMouseTargetFromHitTestPosition","withTarget","resolvedRequest","_hitTestContentWidget","_hitTestOverlayWidget","_hitTestMinimap","_hitTestScrollbarSlider","_hitTestViewZone","_hitTestMargin","_hitTestViewCursor","_hitTestTextArea","_hitTestViewLines","_hitTestScrollbar","widgetId","findAttribute","fulfillContentWidget","fulfillOverlayWidget","fulfillContentText","mightBeForeignElement","cursorVerticalOffset","viewZoneData","mouseTargetType","fulfillViewZone","isTextArea","fulfillTextarea","res","getFullLineRangeAtCoord","getStartPosition","abs","glyphMarginWidth","lineNumbersWidth","offsetX","fulfillMargin","isChildOfViewLines","fulfillContentEmpty","isStrictChildOfViewLines","getLineLength","lineWidth","isChildOfMinimap","possibleLineNumber","maxColumn","fulfillScrollbar","isChildOfScrollableElement","nodeType","className","test","round","visibleRange","columnHorizontalOffset","left","points","sort","mouseCoordinates","toClientCoordinates","spanNodeClientRect","getBoundingClientRect","mouseIsOverSpanNode","clientX","right","prev","curr","rng","lineCenteredVerticalOffset","adjustedPageY","adjustedPage","PageCoordinates","_actualDoHitTestWithCaretRangeFromPoint","coords","shadowRoot","dom","caretRangeFromPoint","createRange","el","elementFromPoint","firstChild","TEXT_NODE","lastChild","step","rect","font","getComputedStyle","getPropertyValue","text","pixelCursor","charWidthReader","CharWidthReader","getInstance","getCharWidth","setStart","setEnd","shadowCaretRangeFromPoint","clientY","startContainer","parent1","parent2","parent3","ELEMENT_NODE","ViewLine","startOffset","hitResult","caretPositionFromPoint","offsetNode","parent1ClassName","parent2ClassName","tokenSpan","childNodes","min","lineContent","newPosition","AtomicTabMoveOperations","_doHitTestWithCaretRangeFromPoint","_doHitTestWithCaretPositionFromPoint","getInjectedTextAt","normalizedPosition","normalizePosition","equals","_snapToSoftTabBoundary","_canvas","char","cacheKey","getContext","measureText","_INSTANCE","createMouseMoveEventMerger","mouseTargetFactory","lastEvent","currentEvent","targetIsWidget","mouseTargetIsWidget","preventDefault","MouseHandler","viewController","_mouseDownOperation","MouseDownOperation","testEventTarget","lastMouseLeaveTime","mouseEvents","EditorMouseEventFactory","onContextMenu","_onContextMenu","onMouseMoveThrottled","_onMouseMove","MOUSE_MOVE_MINIMUM_TIME","onMouseUp","_onMouseUp","onMouseLeave","_onMouseLeave","onMouseDown","_onMouseDown","addDisposableListener","EventType","MOUSE_WHEEL","browserEvent","emitMouseWheel","StandardWheelEvent","metaKey","ctrlKey","shiftKey","altKey","zoomLevel","delta","deltaY","stopPropagation","capture","passive","addEventHandler","removeEventHandler","hasChanged","onHeightChanged","onCursorStateChanged","onScrollChanged","ClientCoordinates","toPageCoordinates","createEditorPagePosition","createCoordinatesRelativeToEditor","createMouseTarget","getLastRenderData","contains","getShadowRoot","elementsFromPoint","posx","posy","find","getMouseColumn","emitContextMenu","isActive","timestamp","emitMouseMove","Date","getTime","emitMouseLeave","emitMouseUp","targetIsContent","targetIsGutter","targetIsLineNumbers","selectOnLineNumbers","targetIsViewZone","shouldHandle","leftButton","middleButton","focus","focusTextArea","start","shouldSuppressMouseDownOnViewZone","shouldSuppressMouseDownOnWidget","emitMouseDown","ViewEventHandler","_viewController","_mouseMoveMonitor","GlobalEditorMouseMoveMonitor","_onScrollTimeout","TimeoutTimer","_mouseState","MouseDownState","_currentSelection","Selection","_isActive","_lastMouseEvent","setModifiers","_findMousePosition","isDragAndDrop","emitMouseDrag","_dispatchMouse","targetType","setStartedOnLineNumbers","setStartButtons","trySetCount","count","isEmpty","containsPosition","startMonitoring","buttons","_onMouseDownThenMove","KeyboardEvent","emitMouseDropCanceled","emitMouseDrop","_stop","cancel","stopMonitoring","setIfNotSet","selections","editorContent","_helpPositionJumpOverViewZone","aboveLineNumber","belowLineNumber","positionOutsideEditor","_getPositionOutsideEditor","selectionStart","selectionStartLineNumber","selectionStartColumn","isBefore","inSelectionMode","dispatchMouse","startedOnLineNumbers","mouseDownCount","onInjectedText","_altKey","_ctrlKey","_metaKey","_shiftKey","_leftButton","_middleButton","_startedOnLineNumbers","_lastMouseDownPosition","_lastMouseDownPositionEqualCount","_lastMouseDownCount","_lastSetMouseDownCountTime","source","setMouseDownCount","newMouseDownPosition","currentTime","CLEAR_MOUSE_DOWN_COUNT_TIME","PointerEventHandler","Gesture","linesContentDomNode","onTap","onChange","EditorMouseEvent","_lastPointerType","pointerType","pointerEvents","EditorPointerEventFactory","onPointerMoveThrottled","onPointerUp","onPointerLeave","onPointerDown","initialTarget","tapCount","deltaScrollNow","translationX","translationY","TouchHandler","createEvent","initEvent","TextAreaSyntethicEvents","dispatchTextAreaEvent","moveTo","PointerHandler","BrowserFeatures","handler","TouchEvent","getTargetAtClientPoint","VisibleTextAreaData","modelLineNumber","distanceToModelLineStart","widthOfHiddenLineTextBefore","distanceToModelLineEnd","_visibleTextAreaBrand","startPosition","endPosition","visibleTextareaStart","visibleTextareaEnd","_previousPresentation","visibleRangeProvider","startModelPosition","endModelPosition","coordinatesConverter","convertModelPositionToViewPosition","tokenPresentation","foreground","italic","bold","underline","strikethrough","canUseZeroSizeTextarea","TextAreaHandler","_primaryCursorPosition","_primaryCursorVisibleRange","_visibleRangeProvider","_scrollLeft","_scrollTop","_setAccessibilityOptions","_contentLeft","_contentWidth","contentWidth","_contentHeight","_fontInfo","_lineHeight","_emptySelectionClipboard","_copyWithSyntaxHighlighting","_visibleTextArea","_selections","_modelSelections","_lastRenderPosition","textArea","createFastDomNode","setClassName","MOUSE_CURSOR_TEXT_CSS_CLASS_NAME","setAttribute","_getAriaLabel","nls","textAreaCover","setPosition","simpleModel","getValueInRange","eol","textAreaInputHost","getDataToCopy","rawTextToCopy","getPlainTextToCopy","newLineCharacter","getEOL","isFromEmptySelection","multicursorText","join","html","mode","CopyOptions","richText","getRichTextToCopy","getScreenReaderContent","currentState","_accessibilitySupport","selection","textBefore","_getWordBeforePosition","_getCharacterBeforePosition","TextAreaState","isAndroid","_getAndroidWordAtPosition","wordAtPosition","positionOffsetInWord","PagedScreenReaderStrategy","_accessibilityPageSize","deduceModelPosition","viewAnchorPosition","deltaOffset","lineFeedCnt","deduceModelPositionRelativeToViewPosition","textAreaWrapper","TextAreaWrapper","_textAreaInput","TextAreaInput","OS","onKeyDown","emitKeyDown","onKeyUp","emitKeyUp","onPaste","pasteOnNewLine","metadata","paste","onCut","cut","onType","replacePrevCharCnt","replaceNextCharCnt","positionDelta","_debugComposition","console","log","compositionType","onSelectionChangeRequest","modelSelection","setSelection","onCompositionStart","ta","textBeforeSelection","substring","selectionEnd","lineFeedOffset1","lastIndexOf","lineTextBeforeSelection","tabOffset1","desiredVisibleBeforeCharCount","visibleBeforeCharCount","widthOfHiddenTextBefore","whiteSpace","append","textAfterSelection","lineFeedOffset2","indexOf","lineTextAfterSelection","tabOffset2","desiredVisibleAfterCharCount","getEndPosition","visibleAfterCharCount","revealRange","Range","startLineNumber","prepareRender","compositionStart","onCompositionUpdate","onCompositionEnd","compositionEnd","onFocus","setHasFocus","onBlur","wordSeparators","getMapForWordSeparators","goingLeft","startColumn","goingRight","endColumn","distance","charCode","charCodeAt","charBefore","strings","accessibilityPageSize","EditorOptions","removeAttribute","writeScreenReaderContent","slice","modelSelections","scrollLeft","scrollTop","isFocused","activeDescendant","role","positionLineNumber","positionColumn","visibleStart","visibleEnd","_newlinecount","substr","viewLineData","getViewLineData","startTokenIndex","tokens","findTokenIndexAtOffset","textareaSpansSingleToken","presentation","definePresentation","getPresentation","_doRender","lastRenderPosition","useCover","color","TokenizationRegistry","_renderAtTopLeft","startIndex","renderData","tac","setTop","setLeft","setWidth","setHeight","setColor","Color","setFontStyle","setTextDecoration","Margin","renderType","LineNumbersOverlay","ViewPart","Tap","forceCopyWithSyntaxHighlighting","InMemoryClipboardMetadataManager","_lastState","lastCopiedValue","data","pastedText","INSTANCE","CompositionContext","_lastTypeTextLength","typeInput","_host","_textArea","_OS","_browser","_onFocus","_onBlur","_onKeyDown","_onKeyUp","_onCut","_onPaste","_onType","_onCompositionStart","_onCompositionUpdate","_onCompositionEnd","_onSelectionChangeRequest","_asyncTriggerCut","RunOnceScheduler","_asyncFocusGainWriteScreenReaderContent","_textAreaState","_selectionChangeListener","_hasFocus","_currentComposition","lastKeyDown","_e","StandardKeyboardEvent","keyCode","currentComposition","code","handleCompositionUpdate","newState","onInput","setIgnoreSelectionChangeTime","_ensureClipboardGetsEditorSelection","schedule","onCopy","clipboardData","ClipboardEventUtils","getTextData","hadFocus","_setHasFocus","onSyntheticTap","previousSelectionChangeEventTime","isChrome","now","delta1","delta2","getIgnoreSelectionChangeTime","resetSelectionChangeTime","selectionStartPosition","selectionEndPosition","getValue","newSelectionStart","getSelectionStart","newSelectionEnd","getSelectionEnd","_newSelectionStartPosition","deduceEditorPosition","newSelectionStartPosition","_newSelectionEndPosition","newSelectionEndPosition","newSelection","dispose","refreshFocusState","hasFocus","newHasFocus","_installSelectionChangeListener","reason","textAreaState","collapseSelection","writeToTextArea","_setAndWriteTextAreaState","dataToCopy","storedMetadata","version","set","replace","setTextData","getData","Mimes","rawmetadata","parse","setData","_actual","_onSyntheticTap","_ignoreSelectionChangeTime","activeElement","selectionDirection","currentIsFocused","currentSelectionStart","currentSelectionEnd","setSelectionRange","scrollState","select","toString","setValue","str","_finishDeduceEditorPosition","str1","str2","anchor","deltaText","signum","lastLineFeedIndex","previousState","couldBeEmojiInput","prefixLength","suffixLength","previousValue","currentValue","previousSelectionStart","previousSelectionEnd","replacePreviousCharacters","EMPTY","linesPerPage","page","endLineNumber","trimLongText","selectionStartPage","_getPageOfLine","selectionStartPageRange","_getRangeForPage","selectionEndPage","selectionEndPageRange","pretextRange","intersectRanges","pretext","lastLine","lastLineMaxColumn","posttextRange","posttext","selectionRange1","selectionRange2","LIMIT_CHARS","EditorScroll_","RevealLine_","CoreEditorCommand","accessor","editor","args","_getViewModel","runCoreEditorCommand","EditorCommand","description","constraint","arg","types","scrollArg","to","by","revealCursor","schema","RawDirection","Up","Down","RawUnit","Line","WrappedLine","Page","HalfPage","direction","unit","reveaLineArg","at","RawAtArgument","Top","Center","Bottom","CoreNavigationCommands","EditorOrNativeTextInputCommand","addImplementation","focusedEditor","ICodeEditorService","getFocusedCodeEditor","hasTextFocus","_runEditorCommand","tagName","toLowerCase","runDOMCommand","activeEditor","getActiveCodeEditor","runEditorCommand","BaseMoveToCommand","opts","_minimalReveal","minimalReveal","_inSelectionMode","pushStackElement","setCursorStates","CursorMoveCommands","getPrimaryCursorState","viewPosition","revealPrimaryCursor","MoveTo","registerEditorCommand","precondition","MoveToSelect","ColumnSelectCommand","_getColumnSelectResult","getCursorColumnSelectData","viewStates","viewState","CursorState","setCursorColumnSelectData","isReal","fromViewLineNumber","fromLineNumber","fromViewVisualColumn","fromVisualColumn","toViewLineNumber","toLineNumber","toViewVisualColumn","toVisualColumn","reversed","revealTopMostCursor","revealBottomMostCursor","ColumnSelect","primary","prevColumnSelectData","validatedPosition","validatePosition","validatedViewPosition","validateViewPosition","doColumnSelect","ColumnSelection","cursorConfig","CursorColumnSelectLeft","kbOpts","weight","kbExpr","EditorContextKeys","linux","CursorColumnSelectRight","ColumnSelectUpCommand","_isPaged","isPaged","CursorColumnSelectUp","CursorColumnSelectPageUp","ColumnSelectDownCommand","CursorColumnSelectDown","CursorColumnSelectPageDown","CursorMoveImpl","CursorMove_","parsed","_runCursorMove","_move","getCursorStates","cursors","CursorMove","CursorMoveBasedCommand","_staticArgs","dynamicArgs","pageSize","CursorLeft","mac","secondary","CursorLeftSelect","CursorRight","CursorRightSelect","CursorUp","CursorUpSelect","CursorPageUp","CursorPageUpSelect","CursorDown","CursorDownSelect","CursorPageDown","CursorPageDownSelect","CreateCursor","wholeLine","states","newModelPosition","modelState","newViewPosition","state","splice","LastCursorMoveToSelect","lastAddedCursorIndex","getLastAddedCursorIndex","newStates","HomeCommand","CursorHome","CursorHomeSelect","LineStartCommand","_exec","cursor","move","CursorLineStart","CursorLineStartSelect","EndCommand","sticky","CursorEnd","properties","default","CursorEndSelect","LineEndCommand","CursorLineEnd","CursorLineEndSelect","TopCommand","CursorTop","CursorTopSelect","BottomCommand","CursorBottom","CursorBottomSelect","EditorScrollImpl","_runEditorScroll","desiredScrollTop","_computeDesiredScrollTop","desiredVisibleViewRange","getCompletelyVisibleViewRangeAtScrollTop","setScrollPosition","desiredTopModelLineNumber","visibleViewRange","getCompletelyVisibleViewRange","visibleModelRange","convertViewRangeToModelRange","noOfLines","deltaLines","EditorScroll","ScrollLineUp","ScrollPageUp","win","ScrollLineDown","ScrollPageDown","WordCommand","WordSelect","WordSelectDrag","LastCursorWordSelect","lastAddedState","hasSelection","LineCommand","LineSelect","LineSelectDrag","LastCursorLineCommand","LastCursorLineSelect","LastCursorLineSelectDrag","CancelSelection","RemoveSecondaryCursors","CORE_WEIGHT","status","RevealLine","revealLineArg","lineNumberArg","parseInt","revealAt","viewRange","convertModelRangeToViewRange","SelectAll","SelectAllCommand","execCommand","SetSelection","CoreEditingCommands","columnSelectionCondition","ContextKeyExpr","registerColumnSelection","keybinding","KeybindingsRegistry","when","registerCommand","command","register","CoreEditingCommand","runCoreEditingCommand","LineBreakInsert","pushUndoStop","executeCommands","TypeOperations","s","Outdent","Tab","DeleteLeft","DeleteOperations","getPrevEditOperationType","getCursorAutoClosedCharacters","shouldPushStackElementBefore","commands","setPrevEditOperationType","DeleteRight","Undo","UndoCommand","hasModel","getOption","getModel","undo","Redo","RedoCommand","redo","EditorHandlerCommand","handlerId","_handlerId","trigger","Command","registerOverwritableCommand","isCodeEditor","thing","getEditorType","editorCommon","isDiffEditor","getCodeEditor","getModifiedEditor","_pageCoordinatesBrand","_clientCoordinatesBrand","EditorPagePosition","_editorPagePositionBrand","CoordinatesRelativeToEditor","_positionRelativeToEditorBrand","editorViewDomNode","editorPagePosition","scaleX","scaleY","offsetHeight","relativeX","relativeY","_editorMouseEventBrand","StandardMouseEvent","_editorViewDomNode","callback","_create","merger","minimumTimeMs","_globalMouseMoveMonitor","GlobalMouseMoveMonitor","_keydownListener","initialElement","initialButtons","mouseMoveCallback","onStopCallback","toKeybinding","isModifierKey","DynamicCssRules","_editor","_instanceId","_idPool","_counter","_rules","Map","_garbageCollectionScheduler","garbageCollect","rule","getOrCreateRule","increaseRefCount","decreaseRefCount","computeUniqueKey","existingRule","counter","RefCountedCssRule","getContainerDomNode","hasReferences","delete","_containerElement","_referenceCount","_styleElement","getCssText","prop","cssValue","asCssVariableName","cssPropName","camelToDashes","letter","EditorExtensionsRegistry","_kbOpts","_menuOpts","menuOpts","_description","_registerMenuItem","kbOptsArr","kbWhen","CommandsRegistry","runCommand","MenuRegistry","menuId","group","title","icon","order","MultiCommand","_implementations","priority","implementation","logService","ILogService","trace","impl","ProxyCommand","codeEditorService","invokeWithinContext","editorAccessor","IContextKeyService","contextMatchesRules","withNullAsUndefined","controllerGetter","_callback","controller","EditorAction","convertOptions","label","alias","reportTelemetry","run","ITelemetryService","publicLog2","withDefaults","MenuId","contextMenuOpts","MultiEditorAction","registerModelAndPositionCommand","instaService","IInstantiationService","resource","assertType","URI","IModelService","editorPosition","invokeFunction","ITextModelService","createModelReference","then","reference","Promise","resolve","reject","object","textEditorModel","finally","editorCommand","EditorContributionRegistry","registerEditorAction","ctor","action","registerMultiEditorAction","registerInstantiatedEditorAction","editorAction","registerEditorContribution","getEditorCommand","commandId","getEditorActions","getEditorContributions","getSomeEditorContributions","ids","filter","getDiffEditorContributions","editorContributions","diffEditorContributions","editorActions","editorCommands","Registry","comment","AbstractCodeEditorService","_themeService","_onCodeEditorAdd","onCodeEditorAdd","_onCodeEditorRemove","onCodeEditorRemove","_onDiffEditorAdd","onDiffEditorAdd","_onDiffEditorRemove","onDiffEditorRemove","_decorationOptionProviders","_modelProperties","_codeEditors","_diffEditors","_globalStyleSheet","editorWithWidgetFocus","editors","listCodeEditors","hasWidgetFocus","provider","refCount","ed","removeDecorations","dest","key1","IThemeService","IBulkEditService","createDecorator","ResourceEdit","edit","edits","isObject","ResourceTextEdit","modelVersionId","Boolean","newUri","oldUri","isWorkspaceFileEdit","ResourceFileEdit","textEdit","versionId","oldResource","newResource","__awaiter","thisArg","_arguments","P","generator","fulfilled","next","rejected","done","apply","STOP_WORKER_DELTA_TIME_MS","canSyncModel","modelService","isTooLargeForSyncing","EditorWorkerService","configurationService","languageConfigurationService","languageFeaturesService","_modelService","_workerManager","WorkerManager","_logService","linkProvider","language","hasAccessToAllModels","provideLinks","token","uri","withWorker","client","computeLinks","links","completionProvider","WordBasedCompletionItemProvider","computedUnicodeHighlights","original","modified","ignoreTrimWhitespace","maxComputationTime","computeDiff","isNonEmptyArray","sw","StopWatch","computeMoreMinimalEdits","elapsed","race","timeout","up","navigateValueSet","computeWordRanges","ITextResourceConfigurationService","ILanguageConfigurationService","ILanguageFeaturesService","workerManager","_debugDisplayName","_configurationService","config","wordBasedSuggestions","models","wordBasedSuggestionsMode","getModels","candidate","unshift","getLanguageId","f","wordDefRegExp","getLanguageConfiguration","getWordDefinition","word","getWordAtPosition","insert","setEndPosition","textualSuggest","duration","suggestions","words","kind","insertText","_editorWorkerClient","_lastWorkerUsedTime","IntervalTimer","cancelAndSet","_checkStopIdleWorker","onModelRemoved","_","_checkStopEmptyWorker","EditorWorkerClient","EditorModelManager","proxy","keepIdleModels","_syncedModels","_syncedModelsLastUsedTime","_proxy","timer","_checkStopModelSync","STOP_SYNC_MODEL_DELTA_TIME_MS","modelUrl","resources","forceLargeModels","resourceStr","_beginModelSync","toRemove","_stopModelSync","acceptNewModel","url","lines","getLinesContent","EOL","getVersionId","toDispose","DisposableStore","add","onDidChangeContent","acceptModelChanged","onWillDispose","toDisposable","acceptRemovedModel","SynchronousWorkerClient","instance","_instance","_proxyObj","EditorWorkerHost","workerClient","_workerClient","method","fhr","_disposed","_keepIdleModels","_workerFactory","DefaultWorkerFactory","_worker","_modelManager","SimpleWorkerClient","logOnceWebWorkerWarning","EditorSimpleWorker","_getOrCreateWorker","getProxyObject","canceled","_getProxy","_getOrCreateModelManager","ensureSyncedResources","_withSyncedResources","computeUnicodeHighlights","leadingWord","wordDef","wordDefFlags","regExpFlags","MarkerDecorationsContribution","_markerDecorationsService","ID","IMarkerDecorationsService","CommandOpener","_commandService","matchesScheme","Schemas","allowCommands","decodeURIComponent","query","_a","_b","executeCommand","ICommandService","EditorOpener","_editorService","extractSelection","scheme","normalizePath","openCodeEditor","assign","fromUserGesture","EditorOpenSource","editorOptions","openToSide","OpenerService","editorService","commandService","_openers","LinkedList","_validators","_resolvers","_resolvedUriTargets","ResourceMap","with","fragment","_externalOpeners","_defaultExternalOpener","openExternal","href","matchesSomeScheme","location","open","_doOpenExternal","opener","validator","resolver","externalOpener","targetURI","validationTarget","shouldOpen","resolveExternalUri","resolved","externalUri","encodeURI","allowContributedOpeners","preferredOpenerId","sourceUri","CancellationToken","clear","createWebWorker","MonacoWebWorkerImpl","_foreignModuleId","moduleId","_foreignModuleCreateData","createData","_foreignModuleHost","host","_foreignProxy","foreignHostMethods","loadForeignModule","foreignMethods","proxyMethodRequest","fmr","createProxyMethod","prototype","call","foreignProxy","foreignMethod","_getForeignProxy","getProxy","StableEditorScrollState","_visiblePosition","_visiblePositionScrollDelta","_cursorPosition","visiblePositionScrollTop","getTopForPosition","setScrollTop","currentCursorPosition","getPosition","getTopForLineNumber","getScrollTop","visiblePosition","visiblePositionScrollDelta","visibleRanges","getVisibleRanges"],"sourceRoot":""}