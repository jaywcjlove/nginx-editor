{"version":3,"file":"static/js/monaco-editor-vendor.96a37e40.a97f5db3.js","mappings":"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","sources":["../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/contentWidgets/contentWidgets.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/currentLineHighlight/currentLineHighlight.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/decorations/decorations.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/editorScrollbar/editorScrollbar.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/indentGuides/indentGuides.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/domReadingContext.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLines.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/glyphMargin/glyphMargin.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/linesDecorations/linesDecorations.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/marginDecorations/marginDecorations.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapCharSheet.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapCharRenderer.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapPreBaked.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimapCharRendererFactory.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/minimap/minimap.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overlayWidgets/overlayWidgets.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overviewRuler/decorationsOverviewRuler.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/overviewRuler/overviewRuler.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/rulers/rulers.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/scrollDecoration/scrollDecoration.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/selections/selections.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewCursors/viewCursor.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewCursors/viewCursors.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/viewZones/viewZones.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/blockDecorations/blockDecorations.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/whitespace/whitespace.js","../node_modules/monaco-editor/esm/vs/editor/browser/view.js","../node_modules/monaco-editor/esm/vs/editor/browser/view/domLineBreaksComputer.js","../node_modules/monaco-editor/esm/vs/editor/browser/view/dynamicViewOverlay.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lineNumbers/lineNumbers.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/rangeUtil.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/lines/viewLine.js","../node_modules/monaco-editor/esm/vs/editor/browser/viewParts/margin/margin.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\nexport class ViewContentWidgets extends ViewPart {\n    constructor(context, viewDomNode) {\n        super(context);\n        this._viewDomNode = viewDomNode;\n        this._widgets = {};\n        this.domNode = createFastDomNode(document.createElement('div'));\n        PartFingerprints.write(this.domNode, 1 /* PartFingerprint.ContentWidgets */);\n        this.domNode.setClassName('contentWidgets');\n        this.domNode.setPosition('absolute');\n        this.domNode.setTop(0);\n        this.overflowingContentWidgetsDomNode = createFastDomNode(document.createElement('div'));\n        PartFingerprints.write(this.overflowingContentWidgetsDomNode, 2 /* PartFingerprint.OverflowingContentWidgets */);\n        this.overflowingContentWidgetsDomNode.setClassName('overflowingContentWidgets');\n    }\n    dispose() {\n        super.dispose();\n        this._widgets = {};\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const keys = Object.keys(this._widgets);\n        for (const widgetId of keys) {\n            this._widgets[widgetId].onConfigurationChanged(e);\n        }\n        return true;\n    }\n    onDecorationsChanged(e) {\n        // true for inline decorations that can end up relayouting text\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLineMappingChanged(e) {\n        this._updateAnchorsViewPositions();\n        return true;\n    }\n    onLinesChanged(e) {\n        this._updateAnchorsViewPositions();\n        return true;\n    }\n    onLinesDeleted(e) {\n        this._updateAnchorsViewPositions();\n        return true;\n    }\n    onLinesInserted(e) {\n        this._updateAnchorsViewPositions();\n        return true;\n    }\n    onScrollChanged(e) {\n        return true;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // ---- end view event handlers\n    _updateAnchorsViewPositions() {\n        const keys = Object.keys(this._widgets);\n        for (const widgetId of keys) {\n            this._widgets[widgetId].updateAnchorViewPosition();\n        }\n    }\n    addWidget(_widget) {\n        const myWidget = new Widget(this._context, this._viewDomNode, _widget);\n        this._widgets[myWidget.id] = myWidget;\n        if (myWidget.allowEditorOverflow) {\n            this.overflowingContentWidgetsDomNode.appendChild(myWidget.domNode);\n        }\n        else {\n            this.domNode.appendChild(myWidget.domNode);\n        }\n        this.setShouldRender();\n    }\n    setWidgetPosition(widget, primaryAnchor, secondaryAnchor, preference, affinity) {\n        const myWidget = this._widgets[widget.getId()];\n        myWidget.setPosition(primaryAnchor, secondaryAnchor, preference, affinity);\n        this.setShouldRender();\n    }\n    removeWidget(widget) {\n        const widgetId = widget.getId();\n        if (this._widgets.hasOwnProperty(widgetId)) {\n            const myWidget = this._widgets[widgetId];\n            delete this._widgets[widgetId];\n            const domNode = myWidget.domNode.domNode;\n            domNode.parentNode.removeChild(domNode);\n            domNode.removeAttribute('monaco-visible-content-widget');\n            this.setShouldRender();\n        }\n    }\n    shouldSuppressMouseDownOnWidget(widgetId) {\n        if (this._widgets.hasOwnProperty(widgetId)) {\n            return this._widgets[widgetId].suppressMouseDown;\n        }\n        return false;\n    }\n    onBeforeRender(viewportData) {\n        const keys = Object.keys(this._widgets);\n        for (const widgetId of keys) {\n            this._widgets[widgetId].onBeforeRender(viewportData);\n        }\n    }\n    prepareRender(ctx) {\n        const keys = Object.keys(this._widgets);\n        for (const widgetId of keys) {\n            this._widgets[widgetId].prepareRender(ctx);\n        }\n    }\n    render(ctx) {\n        const keys = Object.keys(this._widgets);\n        for (const widgetId of keys) {\n            this._widgets[widgetId].render(ctx);\n        }\n    }\n}\nclass Widget {\n    constructor(context, viewDomNode, actual) {\n        this._primaryAnchor = new PositionPair(null, null);\n        this._secondaryAnchor = new PositionPair(null, null);\n        this._context = context;\n        this._viewDomNode = viewDomNode;\n        this._actual = actual;\n        this.domNode = createFastDomNode(this._actual.getDomNode());\n        this.id = this._actual.getId();\n        this.allowEditorOverflow = this._actual.allowEditorOverflow || false;\n        this.suppressMouseDown = this._actual.suppressMouseDown || false;\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._fixedOverflowWidgets = options.get(41 /* EditorOption.fixedOverflowWidgets */);\n        this._contentWidth = layoutInfo.contentWidth;\n        this._contentLeft = layoutInfo.contentLeft;\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._affinity = null;\n        this._preference = [];\n        this._cachedDomNodeOffsetWidth = -1;\n        this._cachedDomNodeOffsetHeight = -1;\n        this._maxWidth = this._getMaxWidth();\n        this._isVisible = false;\n        this._renderData = null;\n        this.domNode.setPosition((this._fixedOverflowWidgets && this.allowEditorOverflow) ? 'fixed' : 'absolute');\n        this.domNode.setDisplay('none');\n        this.domNode.setVisibility('hidden');\n        this.domNode.setAttribute('widgetId', this.id);\n        this.domNode.setMaxWidth(this._maxWidth);\n    }\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        if (e.hasChanged(142 /* EditorOption.layoutInfo */)) {\n            const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n            this._contentLeft = layoutInfo.contentLeft;\n            this._contentWidth = layoutInfo.contentWidth;\n            this._maxWidth = this._getMaxWidth();\n        }\n    }\n    updateAnchorViewPosition() {\n        this._setPosition(this._affinity, this._primaryAnchor.modelPosition, this._secondaryAnchor.modelPosition);\n    }\n    _setPosition(affinity, primaryAnchor, secondaryAnchor) {\n        this._affinity = affinity;\n        this._primaryAnchor = getValidPositionPair(primaryAnchor, this._context.viewModel, this._affinity);\n        this._secondaryAnchor = getValidPositionPair(secondaryAnchor, this._context.viewModel, this._affinity);\n        function getValidPositionPair(position, viewModel, affinity) {\n            if (!position) {\n                return new PositionPair(null, null);\n            }\n            // Do not trust that widgets give a valid position\n            const validModelPosition = viewModel.model.validatePosition(position);\n            if (viewModel.coordinatesConverter.modelPositionIsVisible(validModelPosition)) {\n                const viewPosition = viewModel.coordinatesConverter.convertModelPositionToViewPosition(validModelPosition, affinity !== null && affinity !== void 0 ? affinity : undefined);\n                return new PositionPair(position, viewPosition);\n            }\n            return new PositionPair(position, null);\n        }\n    }\n    _getMaxWidth() {\n        return (this.allowEditorOverflow\n            ? window.innerWidth || document.documentElement.offsetWidth || document.body.offsetWidth\n            : this._contentWidth);\n    }\n    setPosition(primaryAnchor, secondaryAnchor, preference, affinity) {\n        this._setPosition(affinity, primaryAnchor, secondaryAnchor);\n        this._preference = preference;\n        if (this._primaryAnchor.viewPosition && this._preference && this._preference.length > 0) {\n            // this content widget would like to be visible if possible\n            // we change it from `display:none` to `display:block` even if it\n            // might be outside the viewport such that we can measure its size\n            // in `prepareRender`\n            this.domNode.setDisplay('block');\n        }\n        else {\n            this.domNode.setDisplay('none');\n        }\n        this._cachedDomNodeOffsetWidth = -1;\n        this._cachedDomNodeOffsetHeight = -1;\n    }\n    _layoutBoxInViewport(anchor, width, height, ctx) {\n        // Our visible box is split horizontally by the current line => 2 boxes\n        // a) the box above the line\n        const aboveLineTop = anchor.top;\n        const heightAvailableAboveLine = aboveLineTop;\n        // b) the box under the line\n        const underLineTop = anchor.top + anchor.height;\n        const heightAvailableUnderLine = ctx.viewportHeight - underLineTop;\n        const aboveTop = aboveLineTop - height;\n        const fitsAbove = (heightAvailableAboveLine >= height);\n        const belowTop = underLineTop;\n        const fitsBelow = (heightAvailableUnderLine >= height);\n        // And its left\n        let left = anchor.left;\n        if (left + width > ctx.scrollLeft + ctx.viewportWidth) {\n            left = ctx.scrollLeft + ctx.viewportWidth - width;\n        }\n        if (left < ctx.scrollLeft) {\n            left = ctx.scrollLeft;\n        }\n        return { fitsAbove, aboveTop, fitsBelow, belowTop, left };\n    }\n    _layoutHorizontalSegmentInPage(windowSize, domNodePosition, left, width) {\n        // Leave some clearance to the left/right\n        const LEFT_PADDING = 15;\n        const RIGHT_PADDING = 15;\n        // Initially, the limits are defined as the dom node limits\n        const MIN_LIMIT = Math.max(LEFT_PADDING, domNodePosition.left - width);\n        const MAX_LIMIT = Math.min(domNodePosition.left + domNodePosition.width + width, windowSize.width - RIGHT_PADDING);\n        let absoluteLeft = domNodePosition.left + left - window.scrollX;\n        if (absoluteLeft + width > MAX_LIMIT) {\n            const delta = absoluteLeft - (MAX_LIMIT - width);\n            absoluteLeft -= delta;\n            left -= delta;\n        }\n        if (absoluteLeft < MIN_LIMIT) {\n            const delta = absoluteLeft - MIN_LIMIT;\n            absoluteLeft -= delta;\n            left -= delta;\n        }\n        return [left, absoluteLeft];\n    }\n    _layoutBoxInPage(anchor, width, height, ctx) {\n        const aboveTop = anchor.top - height;\n        const belowTop = anchor.top + anchor.height;\n        const domNodePosition = dom.getDomNodePagePosition(this._viewDomNode.domNode);\n        const absoluteAboveTop = domNodePosition.top + aboveTop - window.scrollY;\n        const absoluteBelowTop = domNodePosition.top + belowTop - window.scrollY;\n        const windowSize = dom.getClientArea(document.body);\n        const [left, absoluteAboveLeft] = this._layoutHorizontalSegmentInPage(windowSize, domNodePosition, anchor.left - ctx.scrollLeft + this._contentLeft, width);\n        // Leave some clearance to the top/bottom\n        const TOP_PADDING = 22;\n        const BOTTOM_PADDING = 22;\n        const fitsAbove = (absoluteAboveTop >= TOP_PADDING);\n        const fitsBelow = (absoluteBelowTop + height <= windowSize.height - BOTTOM_PADDING);\n        if (this._fixedOverflowWidgets) {\n            return {\n                fitsAbove,\n                aboveTop: Math.max(absoluteAboveTop, TOP_PADDING),\n                fitsBelow,\n                belowTop: absoluteBelowTop,\n                left: absoluteAboveLeft\n            };\n        }\n        return { fitsAbove, aboveTop, fitsBelow, belowTop, left };\n    }\n    _prepareRenderWidgetAtExactPositionOverflowing(topLeft) {\n        return new Coordinate(topLeft.top, topLeft.left + this._contentLeft);\n    }\n    /**\n     * Compute the coordinates above and below the primary and secondary anchors.\n     * The content widget *must* touch the primary anchor.\n     * The content widget should touch if possible the secondary anchor.\n     */\n    _getAnchorsCoordinates(ctx) {\n        var _a, _b;\n        const primary = getCoordinates(this._primaryAnchor.viewPosition, this._affinity, this._lineHeight);\n        const secondaryViewPosition = (((_a = this._secondaryAnchor.viewPosition) === null || _a === void 0 ? void 0 : _a.lineNumber) === ((_b = this._primaryAnchor.viewPosition) === null || _b === void 0 ? void 0 : _b.lineNumber) ? this._secondaryAnchor.viewPosition : null);\n        const secondary = getCoordinates(secondaryViewPosition, this._affinity, this._lineHeight);\n        return { primary, secondary };\n        function getCoordinates(position, affinity, lineHeight) {\n            if (!position) {\n                return null;\n            }\n            const horizontalPosition = ctx.visibleRangeForPosition(position);\n            if (!horizontalPosition) {\n                return null;\n            }\n            // Left-align widgets that should appear :before content\n            const left = (position.column === 1 && affinity === 3 /* PositionAffinity.LeftOfInjectedText */ ? 0 : horizontalPosition.left);\n            const top = ctx.getVerticalOffsetForLineNumber(position.lineNumber) - ctx.scrollTop;\n            return new AnchorCoordinate(top, left, lineHeight);\n        }\n    }\n    _reduceAnchorCoordinates(primary, secondary, width) {\n        if (!secondary) {\n            return primary;\n        }\n        const fontInfo = this._context.configuration.options.get(49 /* EditorOption.fontInfo */);\n        let left = secondary.left;\n        if (left < primary.left) {\n            left = Math.max(left, primary.left - width + fontInfo.typicalFullwidthCharacterWidth);\n        }\n        else {\n            left = Math.min(left, primary.left + width - fontInfo.typicalFullwidthCharacterWidth);\n        }\n        return new AnchorCoordinate(primary.top, left, primary.height);\n    }\n    _prepareRenderWidget(ctx) {\n        if (!this._preference || this._preference.length === 0) {\n            return null;\n        }\n        const { primary, secondary } = this._getAnchorsCoordinates(ctx);\n        if (!primary) {\n            return null;\n        }\n        if (this._cachedDomNodeOffsetWidth === -1 || this._cachedDomNodeOffsetHeight === -1) {\n            let preferredDimensions = null;\n            if (typeof this._actual.beforeRender === 'function') {\n                preferredDimensions = safeInvoke(this._actual.beforeRender, this._actual);\n            }\n            if (preferredDimensions) {\n                this._cachedDomNodeOffsetWidth = preferredDimensions.width;\n                this._cachedDomNodeOffsetHeight = preferredDimensions.height;\n            }\n            else {\n                const domNode = this.domNode.domNode;\n                const clientRect = domNode.getBoundingClientRect();\n                this._cachedDomNodeOffsetWidth = Math.round(clientRect.width);\n                this._cachedDomNodeOffsetHeight = Math.round(clientRect.height);\n            }\n        }\n        const anchor = this._reduceAnchorCoordinates(primary, secondary, this._cachedDomNodeOffsetWidth);\n        let placement;\n        if (this.allowEditorOverflow) {\n            placement = this._layoutBoxInPage(anchor, this._cachedDomNodeOffsetWidth, this._cachedDomNodeOffsetHeight, ctx);\n        }\n        else {\n            placement = this._layoutBoxInViewport(anchor, this._cachedDomNodeOffsetWidth, this._cachedDomNodeOffsetHeight, ctx);\n        }\n        // Do two passes, first for perfect fit, second picks first option\n        for (let pass = 1; pass <= 2; pass++) {\n            for (const pref of this._preference) {\n                // placement\n                if (pref === 1 /* ContentWidgetPositionPreference.ABOVE */) {\n                    if (!placement) {\n                        // Widget outside of viewport\n                        return null;\n                    }\n                    if (pass === 2 || placement.fitsAbove) {\n                        return { coordinate: new Coordinate(placement.aboveTop, placement.left), position: 1 /* ContentWidgetPositionPreference.ABOVE */ };\n                    }\n                }\n                else if (pref === 2 /* ContentWidgetPositionPreference.BELOW */) {\n                    if (!placement) {\n                        // Widget outside of viewport\n                        return null;\n                    }\n                    if (pass === 2 || placement.fitsBelow) {\n                        return { coordinate: new Coordinate(placement.belowTop, placement.left), position: 2 /* ContentWidgetPositionPreference.BELOW */ };\n                    }\n                }\n                else {\n                    if (this.allowEditorOverflow) {\n                        return { coordinate: this._prepareRenderWidgetAtExactPositionOverflowing(new Coordinate(anchor.top, anchor.left)), position: 0 /* ContentWidgetPositionPreference.EXACT */ };\n                    }\n                    else {\n                        return { coordinate: new Coordinate(anchor.top, anchor.left), position: 0 /* ContentWidgetPositionPreference.EXACT */ };\n                    }\n                }\n            }\n        }\n        return null;\n    }\n    /**\n     * On this first pass, we ensure that the content widget (if it is in the viewport) has the max width set correctly.\n     */\n    onBeforeRender(viewportData) {\n        if (!this._primaryAnchor.viewPosition || !this._preference) {\n            return;\n        }\n        if (this._primaryAnchor.viewPosition.lineNumber < viewportData.startLineNumber || this._primaryAnchor.viewPosition.lineNumber > viewportData.endLineNumber) {\n            // Outside of viewport\n            return;\n        }\n        this.domNode.setMaxWidth(this._maxWidth);\n    }\n    prepareRender(ctx) {\n        this._renderData = this._prepareRenderWidget(ctx);\n    }\n    render(ctx) {\n        if (!this._renderData) {\n            // This widget should be invisible\n            if (this._isVisible) {\n                this.domNode.removeAttribute('monaco-visible-content-widget');\n                this._isVisible = false;\n                this.domNode.setVisibility('hidden');\n            }\n            if (typeof this._actual.afterRender === 'function') {\n                safeInvoke(this._actual.afterRender, this._actual, null);\n            }\n            return;\n        }\n        // This widget should be visible\n        if (this.allowEditorOverflow) {\n            this.domNode.setTop(this._renderData.coordinate.top);\n            this.domNode.setLeft(this._renderData.coordinate.left);\n        }\n        else {\n            this.domNode.setTop(this._renderData.coordinate.top + ctx.scrollTop - ctx.bigNumbersDelta);\n            this.domNode.setLeft(this._renderData.coordinate.left);\n        }\n        if (!this._isVisible) {\n            this.domNode.setVisibility('inherit');\n            this.domNode.setAttribute('monaco-visible-content-widget', 'true');\n            this._isVisible = true;\n        }\n        if (typeof this._actual.afterRender === 'function') {\n            safeInvoke(this._actual.afterRender, this._actual, this._renderData.position);\n        }\n    }\n}\nclass PositionPair {\n    constructor(modelPosition, viewPosition) {\n        this.modelPosition = modelPosition;\n        this.viewPosition = viewPosition;\n    }\n}\nclass Coordinate {\n    constructor(top, left) {\n        this.top = top;\n        this.left = left;\n        this._coordinateBrand = undefined;\n    }\n}\nclass AnchorCoordinate {\n    constructor(top, left, height) {\n        this.top = top;\n        this.left = left;\n        this.height = height;\n        this._anchorCoordinateBrand = undefined;\n    }\n}\nfunction safeInvoke(fn, thisArg, ...args) {\n    try {\n        return fn.call(thisArg, ...args);\n    }\n    catch (_a) {\n        // ignore\n        return null;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './currentLineHighlight.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport { editorLineHighlight, editorLineHighlightBorder } from '../../../common/core/editorColorRegistry.js';\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nexport class AbstractLineHighlightOverlay extends DynamicViewOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._renderLineHighlight = options.get(94 /* EditorOption.renderLineHighlight */);\n        this._renderLineHighlightOnlyWhenFocus = options.get(95 /* EditorOption.renderLineHighlightOnlyWhenFocus */);\n        this._contentLeft = layoutInfo.contentLeft;\n        this._contentWidth = layoutInfo.contentWidth;\n        this._selectionIsEmpty = true;\n        this._focused = false;\n        this._cursorLineNumbers = [1];\n        this._selections = [new Selection(1, 1, 1, 1)];\n        this._renderData = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        super.dispose();\n    }\n    _readFromSelections() {\n        let hasChanged = false;\n        const cursorsLineNumbers = this._selections.map(s => s.positionLineNumber);\n        cursorsLineNumbers.sort((a, b) => a - b);\n        if (!arrays.equals(this._cursorLineNumbers, cursorsLineNumbers)) {\n            this._cursorLineNumbers = cursorsLineNumbers;\n            hasChanged = true;\n        }\n        const selectionIsEmpty = this._selections.every(s => s.isEmpty());\n        if (this._selectionIsEmpty !== selectionIsEmpty) {\n            this._selectionIsEmpty = selectionIsEmpty;\n            hasChanged = true;\n        }\n        return hasChanged;\n    }\n    // --- begin event handlers\n    onThemeChanged(e) {\n        return this._readFromSelections();\n    }\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._renderLineHighlight = options.get(94 /* EditorOption.renderLineHighlight */);\n        this._renderLineHighlightOnlyWhenFocus = options.get(95 /* EditorOption.renderLineHighlightOnlyWhenFocus */);\n        this._contentLeft = layoutInfo.contentLeft;\n        this._contentWidth = layoutInfo.contentWidth;\n        return true;\n    }\n    onCursorStateChanged(e) {\n        this._selections = e.selections;\n        return this._readFromSelections();\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollWidthChanged || e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    onFocusChanged(e) {\n        if (!this._renderLineHighlightOnlyWhenFocus) {\n            return false;\n        }\n        this._focused = e.isFocused;\n        return true;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        if (!this._shouldRenderThis()) {\n            this._renderData = null;\n            return;\n        }\n        const renderedLine = this._renderOne(ctx);\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const len = this._cursorLineNumbers.length;\n        let index = 0;\n        const renderData = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            while (index < len && this._cursorLineNumbers[index] < lineNumber) {\n                index++;\n            }\n            if (index < len && this._cursorLineNumbers[index] === lineNumber) {\n                renderData[lineIndex] = renderedLine;\n            }\n            else {\n                renderData[lineIndex] = '';\n            }\n        }\n        this._renderData = renderData;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderData) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex >= this._renderData.length) {\n            return '';\n        }\n        return this._renderData[lineIndex];\n    }\n    _shouldRenderInMargin() {\n        return ((this._renderLineHighlight === 'gutter' || this._renderLineHighlight === 'all')\n            && (!this._renderLineHighlightOnlyWhenFocus || this._focused));\n    }\n    _shouldRenderInContent() {\n        return ((this._renderLineHighlight === 'line' || this._renderLineHighlight === 'all')\n            && this._selectionIsEmpty\n            && (!this._renderLineHighlightOnlyWhenFocus || this._focused));\n    }\n}\nexport class CurrentLineHighlightOverlay extends AbstractLineHighlightOverlay {\n    _renderOne(ctx) {\n        const className = 'current-line' + (this._shouldRenderOther() ? ' current-line-both' : '');\n        return `<div class=\"${className}\" style=\"width:${Math.max(ctx.scrollWidth, this._contentWidth)}px; height:${this._lineHeight}px;\"></div>`;\n    }\n    _shouldRenderThis() {\n        return this._shouldRenderInContent();\n    }\n    _shouldRenderOther() {\n        return this._shouldRenderInMargin();\n    }\n}\nexport class CurrentLineMarginHighlightOverlay extends AbstractLineHighlightOverlay {\n    _renderOne(ctx) {\n        const className = 'current-line' + (this._shouldRenderInMargin() ? ' current-line-margin' : '') + (this._shouldRenderOther() ? ' current-line-margin-both' : '');\n        return `<div class=\"${className}\" style=\"width:${this._contentLeft}px; height:${this._lineHeight}px;\"></div>`;\n    }\n    _shouldRenderThis() {\n        return true;\n    }\n    _shouldRenderOther() {\n        return this._shouldRenderInContent();\n    }\n}\nregisterThemingParticipant((theme, collector) => {\n    const lineHighlight = theme.getColor(editorLineHighlight);\n    if (lineHighlight) {\n        collector.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${lineHighlight}; }`);\n        collector.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${lineHighlight}; border: none; }`);\n    }\n    if (!lineHighlight || lineHighlight.isTransparent() || theme.defines(editorLineHighlightBorder)) {\n        const lineHighlightBorder = theme.getColor(editorLineHighlightBorder);\n        if (lineHighlightBorder) {\n            collector.addRule(`.monaco-editor .view-overlays .current-line { border: 2px solid ${lineHighlightBorder}; }`);\n            collector.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { border: 2px solid ${lineHighlightBorder}; }`);\n            if (isHighContrast(theme.type)) {\n                collector.addRule(`.monaco-editor .view-overlays .current-line { border-width: 1px; }`);\n                collector.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { border-width: 1px; }`);\n            }\n        }\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './decorations.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport { HorizontalRange } from '../../view/renderingContext.js';\nimport { Range } from '../../../common/core/range.js';\nexport class DecorationsOverlay extends DynamicViewOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        const options = this._context.configuration.options;\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = options.get(49 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = options.get(49 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n        return true;\n    }\n    onDecorationsChanged(e) {\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged || e.scrollWidthChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        const _decorations = ctx.getDecorationsInViewport();\n        // Keep only decorations with `className`\n        let decorations = [];\n        let decorationsLen = 0;\n        for (let i = 0, len = _decorations.length; i < len; i++) {\n            const d = _decorations[i];\n            if (d.options.className) {\n                decorations[decorationsLen++] = d;\n            }\n        }\n        // Sort decorations for consistent render output\n        decorations = decorations.sort((a, b) => {\n            if (a.options.zIndex < b.options.zIndex) {\n                return -1;\n            }\n            if (a.options.zIndex > b.options.zIndex) {\n                return 1;\n            }\n            const aClassName = a.options.className;\n            const bClassName = b.options.className;\n            if (aClassName < bClassName) {\n                return -1;\n            }\n            if (aClassName > bClassName) {\n                return 1;\n            }\n            return Range.compareRangesUsingStarts(a.range, b.range);\n        });\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            output[lineIndex] = '';\n        }\n        // Render first whole line decorations and then regular decorations\n        this._renderWholeLineDecorations(ctx, decorations, output);\n        this._renderNormalDecorations(ctx, decorations, output);\n        this._renderResult = output;\n    }\n    _renderWholeLineDecorations(ctx, decorations, output) {\n        const lineHeight = String(this._lineHeight);\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        for (let i = 0, lenI = decorations.length; i < lenI; i++) {\n            const d = decorations[i];\n            if (!d.options.isWholeLine) {\n                continue;\n            }\n            const decorationOutput = ('<div class=\"cdr '\n                + d.options.className\n                + '\" style=\"left:0;width:100%;height:'\n                + lineHeight\n                + 'px;\"></div>');\n            const startLineNumber = Math.max(d.range.startLineNumber, visibleStartLineNumber);\n            const endLineNumber = Math.min(d.range.endLineNumber, visibleEndLineNumber);\n            for (let j = startLineNumber; j <= endLineNumber; j++) {\n                const lineIndex = j - visibleStartLineNumber;\n                output[lineIndex] += decorationOutput;\n            }\n        }\n    }\n    _renderNormalDecorations(ctx, decorations, output) {\n        var _a;\n        const lineHeight = String(this._lineHeight);\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        let prevClassName = null;\n        let prevShowIfCollapsed = false;\n        let prevRange = null;\n        let prevShouldFillLineOnLineBreak = false;\n        for (let i = 0, lenI = decorations.length; i < lenI; i++) {\n            const d = decorations[i];\n            if (d.options.isWholeLine) {\n                continue;\n            }\n            const className = d.options.className;\n            const showIfCollapsed = Boolean(d.options.showIfCollapsed);\n            let range = d.range;\n            if (showIfCollapsed && range.endColumn === 1 && range.endLineNumber !== range.startLineNumber) {\n                range = new Range(range.startLineNumber, range.startColumn, range.endLineNumber - 1, this._context.viewModel.getLineMaxColumn(range.endLineNumber - 1));\n            }\n            if (prevClassName === className && prevShowIfCollapsed === showIfCollapsed && Range.areIntersectingOrTouching(prevRange, range)) {\n                // merge into previous decoration\n                prevRange = Range.plusRange(prevRange, range);\n                continue;\n            }\n            // flush previous decoration\n            if (prevClassName !== null) {\n                this._renderNormalDecoration(ctx, prevRange, prevClassName, prevShouldFillLineOnLineBreak, prevShowIfCollapsed, lineHeight, visibleStartLineNumber, output);\n            }\n            prevClassName = className;\n            prevShowIfCollapsed = showIfCollapsed;\n            prevRange = range;\n            prevShouldFillLineOnLineBreak = (_a = d.options.shouldFillLineOnLineBreak) !== null && _a !== void 0 ? _a : false;\n        }\n        if (prevClassName !== null) {\n            this._renderNormalDecoration(ctx, prevRange, prevClassName, prevShouldFillLineOnLineBreak, prevShowIfCollapsed, lineHeight, visibleStartLineNumber, output);\n        }\n    }\n    _renderNormalDecoration(ctx, range, className, shouldFillLineOnLineBreak, showIfCollapsed, lineHeight, visibleStartLineNumber, output) {\n        const linesVisibleRanges = ctx.linesVisibleRangesForRange(range, /*TODO@Alex*/ className === 'findMatch');\n        if (!linesVisibleRanges) {\n            return;\n        }\n        for (let j = 0, lenJ = linesVisibleRanges.length; j < lenJ; j++) {\n            const lineVisibleRanges = linesVisibleRanges[j];\n            if (lineVisibleRanges.outsideRenderedLine) {\n                continue;\n            }\n            const lineIndex = lineVisibleRanges.lineNumber - visibleStartLineNumber;\n            if (showIfCollapsed && lineVisibleRanges.ranges.length === 1) {\n                const singleVisibleRange = lineVisibleRanges.ranges[0];\n                if (singleVisibleRange.width < this._typicalHalfwidthCharacterWidth) {\n                    // collapsed/very small range case => make the decoration visible by expanding its width\n                    // expand its size on both sides (both to the left and to the right, keeping it centered)\n                    const center = Math.round(singleVisibleRange.left + singleVisibleRange.width / 2);\n                    const left = Math.max(0, Math.round(center - this._typicalHalfwidthCharacterWidth / 2));\n                    lineVisibleRanges.ranges[0] = new HorizontalRange(left, this._typicalHalfwidthCharacterWidth);\n                }\n            }\n            for (let k = 0, lenK = lineVisibleRanges.ranges.length; k < lenK; k++) {\n                const expandToLeft = shouldFillLineOnLineBreak && lineVisibleRanges.continuesOnNextLine && lenK === 1;\n                const visibleRange = lineVisibleRanges.ranges[k];\n                const decorationOutput = ('<div class=\"cdr '\n                    + className\n                    + '\" style=\"left:'\n                    + String(visibleRange.left)\n                    + (expandToLeft ?\n                        'px;width:100%;height:' :\n                        ('px;width:' + String(visibleRange.width) + 'px;height:'))\n                    + lineHeight\n                    + 'px;\"></div>');\n                output[lineIndex] += decorationOutput;\n            }\n        }\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\n            return '';\n        }\n        return this._renderResult[lineIndex];\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { SmoothScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\nimport { getThemeTypeSelector } from '../../../../platform/theme/common/themeService.js';\nexport class EditorScrollbar extends ViewPart {\n    constructor(context, linesContent, viewDomNode, overflowGuardDomNode) {\n        super(context);\n        const options = this._context.configuration.options;\n        const scrollbar = options.get(101 /* EditorOption.scrollbar */);\n        const mouseWheelScrollSensitivity = options.get(73 /* EditorOption.mouseWheelScrollSensitivity */);\n        const fastScrollSensitivity = options.get(39 /* EditorOption.fastScrollSensitivity */);\n        const scrollPredominantAxis = options.get(104 /* EditorOption.scrollPredominantAxis */);\n        const scrollbarOptions = {\n            listenOnDomNode: viewDomNode.domNode,\n            className: 'editor-scrollable' + ' ' + getThemeTypeSelector(context.theme.type),\n            useShadows: false,\n            lazyRender: true,\n            vertical: scrollbar.vertical,\n            horizontal: scrollbar.horizontal,\n            verticalHasArrows: scrollbar.verticalHasArrows,\n            horizontalHasArrows: scrollbar.horizontalHasArrows,\n            verticalScrollbarSize: scrollbar.verticalScrollbarSize,\n            verticalSliderSize: scrollbar.verticalSliderSize,\n            horizontalScrollbarSize: scrollbar.horizontalScrollbarSize,\n            horizontalSliderSize: scrollbar.horizontalSliderSize,\n            handleMouseWheel: scrollbar.handleMouseWheel,\n            alwaysConsumeMouseWheel: scrollbar.alwaysConsumeMouseWheel,\n            arrowSize: scrollbar.arrowSize,\n            mouseWheelScrollSensitivity: mouseWheelScrollSensitivity,\n            fastScrollSensitivity: fastScrollSensitivity,\n            scrollPredominantAxis: scrollPredominantAxis,\n            scrollByPage: scrollbar.scrollByPage,\n        };\n        this.scrollbar = this._register(new SmoothScrollableElement(linesContent.domNode, scrollbarOptions, this._context.viewLayout.getScrollable()));\n        PartFingerprints.write(this.scrollbar.getDomNode(), 5 /* PartFingerprint.ScrollableElement */);\n        this.scrollbarDomNode = createFastDomNode(this.scrollbar.getDomNode());\n        this.scrollbarDomNode.setPosition('absolute');\n        this._setLayout();\n        // When having a zone widget that calls .focus() on one of its dom elements,\n        // the browser will try desperately to reveal that dom node, unexpectedly\n        // changing the .scrollTop of this.linesContent\n        const onBrowserDesperateReveal = (domNode, lookAtScrollTop, lookAtScrollLeft) => {\n            const newScrollPosition = {};\n            if (lookAtScrollTop) {\n                const deltaTop = domNode.scrollTop;\n                if (deltaTop) {\n                    newScrollPosition.scrollTop = this._context.viewLayout.getCurrentScrollTop() + deltaTop;\n                    domNode.scrollTop = 0;\n                }\n            }\n            if (lookAtScrollLeft) {\n                const deltaLeft = domNode.scrollLeft;\n                if (deltaLeft) {\n                    newScrollPosition.scrollLeft = this._context.viewLayout.getCurrentScrollLeft() + deltaLeft;\n                    domNode.scrollLeft = 0;\n                }\n            }\n            this._context.viewModel.viewLayout.setScrollPosition(newScrollPosition, 1 /* ScrollType.Immediate */);\n        };\n        // I've seen this happen both on the view dom node & on the lines content dom node.\n        this._register(dom.addDisposableListener(viewDomNode.domNode, 'scroll', (e) => onBrowserDesperateReveal(viewDomNode.domNode, true, true)));\n        this._register(dom.addDisposableListener(linesContent.domNode, 'scroll', (e) => onBrowserDesperateReveal(linesContent.domNode, true, false)));\n        this._register(dom.addDisposableListener(overflowGuardDomNode.domNode, 'scroll', (e) => onBrowserDesperateReveal(overflowGuardDomNode.domNode, true, false)));\n        this._register(dom.addDisposableListener(this.scrollbarDomNode.domNode, 'scroll', (e) => onBrowserDesperateReveal(this.scrollbarDomNode.domNode, true, false)));\n    }\n    dispose() {\n        super.dispose();\n    }\n    _setLayout() {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this.scrollbarDomNode.setLeft(layoutInfo.contentLeft);\n        const minimap = options.get(71 /* EditorOption.minimap */);\n        const side = minimap.side;\n        if (side === 'right') {\n            this.scrollbarDomNode.setWidth(layoutInfo.contentWidth + layoutInfo.minimap.minimapWidth);\n        }\n        else {\n            this.scrollbarDomNode.setWidth(layoutInfo.contentWidth);\n        }\n        this.scrollbarDomNode.setHeight(layoutInfo.height);\n    }\n    getOverviewRulerLayoutInfo() {\n        return this.scrollbar.getOverviewRulerLayoutInfo();\n    }\n    getDomNode() {\n        return this.scrollbarDomNode;\n    }\n    delegateVerticalScrollbarPointerDown(browserEvent) {\n        this.scrollbar.delegateVerticalScrollbarPointerDown(browserEvent);\n    }\n    delegateScrollFromMouseWheelEvent(browserEvent) {\n        this.scrollbar.delegateScrollFromMouseWheelEvent(browserEvent);\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        if (e.hasChanged(101 /* EditorOption.scrollbar */)\n            || e.hasChanged(73 /* EditorOption.mouseWheelScrollSensitivity */)\n            || e.hasChanged(39 /* EditorOption.fastScrollSensitivity */)) {\n            const options = this._context.configuration.options;\n            const scrollbar = options.get(101 /* EditorOption.scrollbar */);\n            const mouseWheelScrollSensitivity = options.get(73 /* EditorOption.mouseWheelScrollSensitivity */);\n            const fastScrollSensitivity = options.get(39 /* EditorOption.fastScrollSensitivity */);\n            const scrollPredominantAxis = options.get(104 /* EditorOption.scrollPredominantAxis */);\n            const newOpts = {\n                vertical: scrollbar.vertical,\n                horizontal: scrollbar.horizontal,\n                verticalScrollbarSize: scrollbar.verticalScrollbarSize,\n                horizontalScrollbarSize: scrollbar.horizontalScrollbarSize,\n                scrollByPage: scrollbar.scrollByPage,\n                handleMouseWheel: scrollbar.handleMouseWheel,\n                mouseWheelScrollSensitivity: mouseWheelScrollSensitivity,\n                fastScrollSensitivity: fastScrollSensitivity,\n                scrollPredominantAxis: scrollPredominantAxis\n            };\n            this.scrollbar.updateOptions(newOpts);\n        }\n        if (e.hasChanged(142 /* EditorOption.layoutInfo */)) {\n            this._setLayout();\n        }\n        return true;\n    }\n    onScrollChanged(e) {\n        return true;\n    }\n    onThemeChanged(e) {\n        this.scrollbar.updateClassName('editor-scrollable' + ' ' + getThemeTypeSelector(this._context.theme.type));\n        return true;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        // Nothing to do\n    }\n    render(ctx) {\n        this.scrollbar.renderNow();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './indentGuides.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport { editorBracketHighlightingForeground1, editorBracketHighlightingForeground2, editorBracketHighlightingForeground3, editorBracketHighlightingForeground4, editorBracketHighlightingForeground5, editorBracketHighlightingForeground6, editorBracketPairGuideActiveBackground1, editorBracketPairGuideActiveBackground2, editorBracketPairGuideActiveBackground3, editorBracketPairGuideActiveBackground4, editorBracketPairGuideActiveBackground5, editorBracketPairGuideActiveBackground6, editorBracketPairGuideBackground1, editorBracketPairGuideBackground2, editorBracketPairGuideBackground3, editorBracketPairGuideBackground4, editorBracketPairGuideBackground5, editorBracketPairGuideBackground6, editorIndentGuide1, editorIndentGuide2, editorIndentGuide3, editorIndentGuide4, editorIndentGuide5, editorIndentGuide6, editorActiveIndentGuide1, editorActiveIndentGuide2, editorActiveIndentGuide3, editorActiveIndentGuide4, editorActiveIndentGuide5, editorActiveIndentGuide6 } from '../../../common/core/editorColorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { ArrayQueue } from '../../../../base/common/arrays.js';\nimport { isDefined } from '../../../../base/common/types.js';\nimport { BracketPairGuidesClassNames } from '../../../common/model/guidesTextModelPart.js';\nimport { IndentGuide, HorizontalGuidesState } from '../../../common/textModelGuides.js';\nexport class IndentGuidesOverlay extends DynamicViewOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        this._primaryPosition = null;\n        const options = this._context.configuration.options;\n        const wrappingInfo = options.get(143 /* EditorOption.wrappingInfo */);\n        const fontInfo = options.get(49 /* EditorOption.fontInfo */);\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._spaceWidth = fontInfo.spaceWidth;\n        this._maxIndentLeft = wrappingInfo.wrappingColumn === -1 ? -1 : (wrappingInfo.wrappingColumn * fontInfo.typicalHalfwidthCharacterWidth);\n        this._bracketPairGuideOptions = options.get(15 /* EditorOption.guides */);\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const wrappingInfo = options.get(143 /* EditorOption.wrappingInfo */);\n        const fontInfo = options.get(49 /* EditorOption.fontInfo */);\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._spaceWidth = fontInfo.spaceWidth;\n        this._maxIndentLeft = wrappingInfo.wrappingColumn === -1 ? -1 : (wrappingInfo.wrappingColumn * fontInfo.typicalHalfwidthCharacterWidth);\n        this._bracketPairGuideOptions = options.get(15 /* EditorOption.guides */);\n        return true;\n    }\n    onCursorStateChanged(e) {\n        var _a;\n        const selection = e.selections[0];\n        const newPosition = selection.getPosition();\n        if (!((_a = this._primaryPosition) === null || _a === void 0 ? void 0 : _a.equals(newPosition))) {\n            this._primaryPosition = newPosition;\n            return true;\n        }\n        return false;\n    }\n    onDecorationsChanged(e) {\n        // true for inline decorations\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged; // || e.scrollWidthChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    onLanguageConfigurationChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        var _a, _b, _c, _d;\n        if (!this._bracketPairGuideOptions.indentation && this._bracketPairGuideOptions.bracketPairs === false) {\n            this._renderResult = null;\n            return;\n        }\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const scrollWidth = ctx.scrollWidth;\n        const lineHeight = this._lineHeight;\n        const activeCursorPosition = this._primaryPosition;\n        const indents = this.getGuidesByLine(visibleStartLineNumber, Math.min(visibleEndLineNumber + 1, this._context.viewModel.getLineCount()), activeCursorPosition);\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            const indent = indents[lineIndex];\n            let result = '';\n            const leftOffset = (_b = (_a = ctx.visibleRangeForPosition(new Position(lineNumber, 1))) === null || _a === void 0 ? void 0 : _a.left) !== null && _b !== void 0 ? _b : 0;\n            for (const guide of indent) {\n                const left = guide.column === -1\n                    ? leftOffset + (guide.visibleColumn - 1) * this._spaceWidth\n                    : ctx.visibleRangeForPosition(new Position(lineNumber, guide.column)).left;\n                if (left > scrollWidth || (this._maxIndentLeft > 0 && left > this._maxIndentLeft)) {\n                    break;\n                }\n                const className = guide.horizontalLine ? (guide.horizontalLine.top ? 'horizontal-top' : 'horizontal-bottom') : 'vertical';\n                const width = guide.horizontalLine\n                    ? ((_d = (_c = ctx.visibleRangeForPosition(new Position(lineNumber, guide.horizontalLine.endColumn))) === null || _c === void 0 ? void 0 : _c.left) !== null && _d !== void 0 ? _d : (left + this._spaceWidth)) - left\n                    : this._spaceWidth;\n                result += `<div class=\"core-guide ${guide.className} ${className}\" style=\"left:${left}px;height:${lineHeight}px;width:${width}px\"></div>`;\n            }\n            output[lineIndex] = result;\n        }\n        this._renderResult = output;\n    }\n    getGuidesByLine(visibleStartLineNumber, visibleEndLineNumber, activeCursorPosition) {\n        const bracketGuides = this._bracketPairGuideOptions.bracketPairs !== false\n            ? this._context.viewModel.getBracketGuidesInRangeByLine(visibleStartLineNumber, visibleEndLineNumber, activeCursorPosition, {\n                highlightActive: this._bracketPairGuideOptions.highlightActiveBracketPair,\n                horizontalGuides: this._bracketPairGuideOptions.bracketPairsHorizontal === true\n                    ? HorizontalGuidesState.Enabled\n                    : this._bracketPairGuideOptions.bracketPairsHorizontal === 'active'\n                        ? HorizontalGuidesState.EnabledForActive\n                        : HorizontalGuidesState.Disabled,\n                includeInactive: this._bracketPairGuideOptions.bracketPairs === true,\n            })\n            : null;\n        const indentGuides = this._bracketPairGuideOptions.indentation\n            ? this._context.viewModel.getLinesIndentGuides(visibleStartLineNumber, visibleEndLineNumber)\n            : null;\n        let activeIndentStartLineNumber = 0;\n        let activeIndentEndLineNumber = 0;\n        let activeIndentLevel = 0;\n        if (this._bracketPairGuideOptions.highlightActiveIndentation !== false && activeCursorPosition) {\n            const activeIndentInfo = this._context.viewModel.getActiveIndentGuide(activeCursorPosition.lineNumber, visibleStartLineNumber, visibleEndLineNumber);\n            activeIndentStartLineNumber = activeIndentInfo.startLineNumber;\n            activeIndentEndLineNumber = activeIndentInfo.endLineNumber;\n            activeIndentLevel = activeIndentInfo.indent;\n        }\n        const { indentSize } = this._context.viewModel.model.getOptions();\n        const result = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineGuides = new Array();\n            result.push(lineGuides);\n            const bracketGuidesInLine = bracketGuides ? bracketGuides[lineNumber - visibleStartLineNumber] : [];\n            const bracketGuidesInLineQueue = new ArrayQueue(bracketGuidesInLine);\n            const indentGuidesInLine = indentGuides ? indentGuides[lineNumber - visibleStartLineNumber] : 0;\n            for (let indentLvl = 1; indentLvl <= indentGuidesInLine; indentLvl++) {\n                const indentGuide = (indentLvl - 1) * indentSize + 1;\n                const isActive = \n                // Disable active indent guide if there are bracket guides.\n                (this._bracketPairGuideOptions.highlightActiveIndentation === 'always' || bracketGuidesInLine.length === 0) &&\n                    activeIndentStartLineNumber <= lineNumber &&\n                    lineNumber <= activeIndentEndLineNumber &&\n                    indentLvl === activeIndentLevel;\n                lineGuides.push(...bracketGuidesInLineQueue.takeWhile(g => g.visibleColumn < indentGuide) || []);\n                const peeked = bracketGuidesInLineQueue.peek();\n                if (!peeked || peeked.visibleColumn !== indentGuide || peeked.horizontalLine) {\n                    lineGuides.push(new IndentGuide(indentGuide, -1, `core-guide-indent lvl-${(indentLvl - 1) % 30}` + (isActive ? ' indent-active' : ''), null, -1, -1));\n                }\n            }\n            lineGuides.push(...bracketGuidesInLineQueue.takeWhile(g => true) || []);\n        }\n        return result;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\n            return '';\n        }\n        return this._renderResult[lineIndex];\n    }\n}\nfunction transparentToUndefined(color) {\n    if (color && color.isTransparent()) {\n        return undefined;\n    }\n    return color;\n}\nregisterThemingParticipant((theme, collector) => {\n    const colors = [\n        { bracketColor: editorBracketHighlightingForeground1, guideColor: editorBracketPairGuideBackground1, guideColorActive: editorBracketPairGuideActiveBackground1 },\n        { bracketColor: editorBracketHighlightingForeground2, guideColor: editorBracketPairGuideBackground2, guideColorActive: editorBracketPairGuideActiveBackground2 },\n        { bracketColor: editorBracketHighlightingForeground3, guideColor: editorBracketPairGuideBackground3, guideColorActive: editorBracketPairGuideActiveBackground3 },\n        { bracketColor: editorBracketHighlightingForeground4, guideColor: editorBracketPairGuideBackground4, guideColorActive: editorBracketPairGuideActiveBackground4 },\n        { bracketColor: editorBracketHighlightingForeground5, guideColor: editorBracketPairGuideBackground5, guideColorActive: editorBracketPairGuideActiveBackground5 },\n        { bracketColor: editorBracketHighlightingForeground6, guideColor: editorBracketPairGuideBackground6, guideColorActive: editorBracketPairGuideActiveBackground6 }\n    ];\n    const colorProvider = new BracketPairGuidesClassNames();\n    const indentColors = [\n        { indentColor: editorIndentGuide1, indentColorActive: editorActiveIndentGuide1 },\n        { indentColor: editorIndentGuide2, indentColorActive: editorActiveIndentGuide2 },\n        { indentColor: editorIndentGuide3, indentColorActive: editorActiveIndentGuide3 },\n        { indentColor: editorIndentGuide4, indentColorActive: editorActiveIndentGuide4 },\n        { indentColor: editorIndentGuide5, indentColorActive: editorActiveIndentGuide5 },\n        { indentColor: editorIndentGuide6, indentColorActive: editorActiveIndentGuide6 },\n    ];\n    const colorValues = colors\n        .map(c => {\n        var _a, _b;\n        const bracketColor = theme.getColor(c.bracketColor);\n        const guideColor = theme.getColor(c.guideColor);\n        const guideColorActive = theme.getColor(c.guideColorActive);\n        const effectiveGuideColor = transparentToUndefined((_a = transparentToUndefined(guideColor)) !== null && _a !== void 0 ? _a : bracketColor === null || bracketColor === void 0 ? void 0 : bracketColor.transparent(0.3));\n        const effectiveGuideColorActive = transparentToUndefined((_b = transparentToUndefined(guideColorActive)) !== null && _b !== void 0 ? _b : bracketColor);\n        if (!effectiveGuideColor || !effectiveGuideColorActive) {\n            return undefined;\n        }\n        return {\n            guideColor: effectiveGuideColor,\n            guideColorActive: effectiveGuideColorActive,\n        };\n    })\n        .filter(isDefined);\n    const indentColorValues = indentColors\n        .map(c => {\n        const indentColor = theme.getColor(c.indentColor);\n        const indentColorActive = theme.getColor(c.indentColorActive);\n        const effectiveIndentColor = transparentToUndefined(indentColor);\n        const effectiveIndentColorActive = transparentToUndefined(indentColorActive);\n        if (!effectiveIndentColor || !effectiveIndentColorActive) {\n            return undefined;\n        }\n        return {\n            indentColor: effectiveIndentColor,\n            indentColorActive: effectiveIndentColorActive,\n        };\n    })\n        .filter(isDefined);\n    if (colorValues.length > 0) {\n        for (let level = 0; level < 30; level++) {\n            const colors = colorValues[level % colorValues.length];\n            collector.addRule(`.monaco-editor .${colorProvider.getInlineClassNameOfLevel(level).replace(/ /g, '.')} { --guide-color: ${colors.guideColor}; --guide-color-active: ${colors.guideColorActive}; }`);\n        }\n        collector.addRule(`.monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }`);\n        collector.addRule(`.monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }`);\n        collector.addRule(`.monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }`);\n        collector.addRule(`.monaco-editor .vertical.${colorProvider.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`);\n        collector.addRule(`.monaco-editor .horizontal-top.${colorProvider.activeClassName} { border-top: 1px solid var(--guide-color-active); }`);\n        collector.addRule(`.monaco-editor .horizontal-bottom.${colorProvider.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`);\n    }\n    if (indentColorValues.length > 0) {\n        for (let level = 0; level < 30; level++) {\n            const colors = indentColorValues[level % indentColorValues.length];\n            collector.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${level} { --indent-color: ${colors.indentColor}; --indent-color-active: ${colors.indentColorActive}; }`);\n        }\n        collector.addRule(`.monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }`);\n        collector.addRule(`.monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class DomReadingContext {\n    get didDomLayout() {\n        return this._didDomLayout;\n    }\n    readClientRect() {\n        if (!this._clientRectRead) {\n            this._clientRectRead = true;\n            const rect = this._domNode.getBoundingClientRect();\n            this.markDidDomLayout();\n            this._clientRectDeltaLeft = rect.left;\n            this._clientRectScale = rect.width / this._domNode.offsetWidth;\n        }\n    }\n    get clientRectDeltaLeft() {\n        if (!this._clientRectRead) {\n            this.readClientRect();\n        }\n        return this._clientRectDeltaLeft;\n    }\n    get clientRectScale() {\n        if (!this._clientRectRead) {\n            this.readClientRect();\n        }\n        return this._clientRectScale;\n    }\n    constructor(_domNode, endNode) {\n        this._domNode = _domNode;\n        this.endNode = endNode;\n        this._didDomLayout = false;\n        this._clientRectDeltaLeft = 0;\n        this._clientRectScale = 1;\n        this._clientRectRead = false;\n    }\n    markDidDomLayout() {\n        this._didDomLayout = true;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { MOUSE_CURSOR_TEXT_CSS_CLASS_NAME } from '../../../../base/browser/ui/mouseCursor/mouseCursor.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport './viewLines.css';\nimport { applyFontInfo } from '../../config/domFontInfo.js';\nimport { HorizontalPosition, HorizontalRange, LineVisibleRanges } from '../../view/renderingContext.js';\nimport { VisibleLinesCollection } from '../../view/viewLayer.js';\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\nimport { DomReadingContext } from './domReadingContext.js';\nimport { ViewLine, ViewLineOptions } from './viewLine.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nclass LastRenderedData {\n    constructor() {\n        this._currentVisibleRange = new Range(1, 1, 1, 1);\n    }\n    getCurrentVisibleRange() {\n        return this._currentVisibleRange;\n    }\n    setCurrentVisibleRange(currentVisibleRange) {\n        this._currentVisibleRange = currentVisibleRange;\n    }\n}\nclass HorizontalRevealRangeRequest {\n    constructor(minimalReveal, lineNumber, startColumn, endColumn, startScrollTop, stopScrollTop, scrollType) {\n        this.minimalReveal = minimalReveal;\n        this.lineNumber = lineNumber;\n        this.startColumn = startColumn;\n        this.endColumn = endColumn;\n        this.startScrollTop = startScrollTop;\n        this.stopScrollTop = stopScrollTop;\n        this.scrollType = scrollType;\n        this.type = 'range';\n        this.minLineNumber = lineNumber;\n        this.maxLineNumber = lineNumber;\n    }\n}\nclass HorizontalRevealSelectionsRequest {\n    constructor(minimalReveal, selections, startScrollTop, stopScrollTop, scrollType) {\n        this.minimalReveal = minimalReveal;\n        this.selections = selections;\n        this.startScrollTop = startScrollTop;\n        this.stopScrollTop = stopScrollTop;\n        this.scrollType = scrollType;\n        this.type = 'selections';\n        let minLineNumber = selections[0].startLineNumber;\n        let maxLineNumber = selections[0].endLineNumber;\n        for (let i = 1, len = selections.length; i < len; i++) {\n            const selection = selections[i];\n            minLineNumber = Math.min(minLineNumber, selection.startLineNumber);\n            maxLineNumber = Math.max(maxLineNumber, selection.endLineNumber);\n        }\n        this.minLineNumber = minLineNumber;\n        this.maxLineNumber = maxLineNumber;\n    }\n}\nexport class ViewLines extends ViewPart {\n    constructor(context, linesContent) {\n        super(context);\n        this._linesContent = linesContent;\n        this._textRangeRestingSpot = document.createElement('div');\n        this._visibleLines = new VisibleLinesCollection(this);\n        this.domNode = this._visibleLines.domNode;\n        const conf = this._context.configuration;\n        const options = this._context.configuration.options;\n        const fontInfo = options.get(49 /* EditorOption.fontInfo */);\n        const wrappingInfo = options.get(143 /* EditorOption.wrappingInfo */);\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n        this._isViewportWrapping = wrappingInfo.isViewportWrapping;\n        this._revealHorizontalRightPadding = options.get(98 /* EditorOption.revealHorizontalRightPadding */);\n        this._cursorSurroundingLines = options.get(28 /* EditorOption.cursorSurroundingLines */);\n        this._cursorSurroundingLinesStyle = options.get(29 /* EditorOption.cursorSurroundingLinesStyle */);\n        this._canUseLayerHinting = !options.get(31 /* EditorOption.disableLayerHinting */);\n        this._viewLineOptions = new ViewLineOptions(conf, this._context.theme.type);\n        PartFingerprints.write(this.domNode, 7 /* PartFingerprint.ViewLines */);\n        this.domNode.setClassName(`view-lines ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`);\n        applyFontInfo(this.domNode, fontInfo);\n        // --- width & height\n        this._maxLineWidth = 0;\n        this._asyncUpdateLineWidths = new RunOnceScheduler(() => {\n            this._updateLineWidthsSlow();\n        }, 200);\n        this._asyncCheckMonospaceFontAssumptions = new RunOnceScheduler(() => {\n            this._checkMonospaceFontAssumptions();\n        }, 2000);\n        this._lastRenderedData = new LastRenderedData();\n        this._horizontalRevealRequest = null;\n        // sticky scroll widget\n        this._stickyScrollEnabled = options.get(113 /* EditorOption.stickyScroll */).enabled;\n        this._maxNumberStickyLines = options.get(113 /* EditorOption.stickyScroll */).maxLineCount;\n    }\n    dispose() {\n        this._asyncUpdateLineWidths.dispose();\n        this._asyncCheckMonospaceFontAssumptions.dispose();\n        super.dispose();\n    }\n    getDomNode() {\n        return this.domNode;\n    }\n    // ---- begin IVisibleLinesHost\n    createVisibleLine() {\n        return new ViewLine(this._viewLineOptions);\n    }\n    // ---- end IVisibleLinesHost\n    // ---- begin view event handlers\n    onConfigurationChanged(e) {\n        this._visibleLines.onConfigurationChanged(e);\n        if (e.hasChanged(143 /* EditorOption.wrappingInfo */)) {\n            this._maxLineWidth = 0;\n        }\n        const options = this._context.configuration.options;\n        const fontInfo = options.get(49 /* EditorOption.fontInfo */);\n        const wrappingInfo = options.get(143 /* EditorOption.wrappingInfo */);\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n        this._isViewportWrapping = wrappingInfo.isViewportWrapping;\n        this._revealHorizontalRightPadding = options.get(98 /* EditorOption.revealHorizontalRightPadding */);\n        this._cursorSurroundingLines = options.get(28 /* EditorOption.cursorSurroundingLines */);\n        this._cursorSurroundingLinesStyle = options.get(29 /* EditorOption.cursorSurroundingLinesStyle */);\n        this._canUseLayerHinting = !options.get(31 /* EditorOption.disableLayerHinting */);\n        // sticky scroll\n        this._stickyScrollEnabled = options.get(113 /* EditorOption.stickyScroll */).enabled;\n        this._maxNumberStickyLines = options.get(113 /* EditorOption.stickyScroll */).maxLineCount;\n        applyFontInfo(this.domNode, fontInfo);\n        this._onOptionsMaybeChanged();\n        if (e.hasChanged(142 /* EditorOption.layoutInfo */)) {\n            this._maxLineWidth = 0;\n        }\n        return true;\n    }\n    _onOptionsMaybeChanged() {\n        const conf = this._context.configuration;\n        const newViewLineOptions = new ViewLineOptions(conf, this._context.theme.type);\n        if (!this._viewLineOptions.equals(newViewLineOptions)) {\n            this._viewLineOptions = newViewLineOptions;\n            const startLineNumber = this._visibleLines.getStartLineNumber();\n            const endLineNumber = this._visibleLines.getEndLineNumber();\n            for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n                const line = this._visibleLines.getVisibleLine(lineNumber);\n                line.onOptionsChanged(this._viewLineOptions);\n            }\n            return true;\n        }\n        return false;\n    }\n    onCursorStateChanged(e) {\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        let r = false;\n        for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n            r = this._visibleLines.getVisibleLine(lineNumber).onSelectionChanged() || r;\n        }\n        return r;\n    }\n    onDecorationsChanged(e) {\n        if (true /*e.inlineDecorationsChanged*/) {\n            const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n            const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n            for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n                this._visibleLines.getVisibleLine(lineNumber).onDecorationsChanged();\n            }\n        }\n        return true;\n    }\n    onFlushed(e) {\n        const shouldRender = this._visibleLines.onFlushed(e);\n        this._maxLineWidth = 0;\n        return shouldRender;\n    }\n    onLinesChanged(e) {\n        return this._visibleLines.onLinesChanged(e);\n    }\n    onLinesDeleted(e) {\n        return this._visibleLines.onLinesDeleted(e);\n    }\n    onLinesInserted(e) {\n        return this._visibleLines.onLinesInserted(e);\n    }\n    onRevealRangeRequest(e) {\n        // Using the future viewport here in order to handle multiple\n        // incoming reveal range requests that might all desire to be animated\n        const desiredScrollTop = this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(), e.source, e.minimalReveal, e.range, e.selections, e.verticalType);\n        if (desiredScrollTop === -1) {\n            // marker to abort the reveal range request\n            return false;\n        }\n        // validate the new desired scroll top\n        let newScrollPosition = this._context.viewLayout.validateScrollPosition({ scrollTop: desiredScrollTop });\n        if (e.revealHorizontal) {\n            if (e.range && e.range.startLineNumber !== e.range.endLineNumber) {\n                // Two or more lines? => scroll to base (That's how you see most of the two lines)\n                newScrollPosition = {\n                    scrollTop: newScrollPosition.scrollTop,\n                    scrollLeft: 0\n                };\n            }\n            else if (e.range) {\n                // We don't necessarily know the horizontal offset of this range since the line might not be in the view...\n                this._horizontalRevealRequest = new HorizontalRevealRangeRequest(e.minimalReveal, e.range.startLineNumber, e.range.startColumn, e.range.endColumn, this._context.viewLayout.getCurrentScrollTop(), newScrollPosition.scrollTop, e.scrollType);\n            }\n            else if (e.selections && e.selections.length > 0) {\n                this._horizontalRevealRequest = new HorizontalRevealSelectionsRequest(e.minimalReveal, e.selections, this._context.viewLayout.getCurrentScrollTop(), newScrollPosition.scrollTop, e.scrollType);\n            }\n        }\n        else {\n            this._horizontalRevealRequest = null;\n        }\n        const scrollTopDelta = Math.abs(this._context.viewLayout.getCurrentScrollTop() - newScrollPosition.scrollTop);\n        const scrollType = (scrollTopDelta <= this._lineHeight ? 1 /* ScrollType.Immediate */ : e.scrollType);\n        this._context.viewModel.viewLayout.setScrollPosition(newScrollPosition, scrollType);\n        return true;\n    }\n    onScrollChanged(e) {\n        if (this._horizontalRevealRequest && e.scrollLeftChanged) {\n            // cancel any outstanding horizontal reveal request if someone else scrolls horizontally.\n            this._horizontalRevealRequest = null;\n        }\n        if (this._horizontalRevealRequest && e.scrollTopChanged) {\n            const min = Math.min(this._horizontalRevealRequest.startScrollTop, this._horizontalRevealRequest.stopScrollTop);\n            const max = Math.max(this._horizontalRevealRequest.startScrollTop, this._horizontalRevealRequest.stopScrollTop);\n            if (e.scrollTop < min || e.scrollTop > max) {\n                // cancel any outstanding horizontal reveal request if someone else scrolls vertically.\n                this._horizontalRevealRequest = null;\n            }\n        }\n        this.domNode.setWidth(e.scrollWidth);\n        return this._visibleLines.onScrollChanged(e) || true;\n    }\n    onTokensChanged(e) {\n        return this._visibleLines.onTokensChanged(e);\n    }\n    onZonesChanged(e) {\n        this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth);\n        return this._visibleLines.onZonesChanged(e);\n    }\n    onThemeChanged(e) {\n        return this._onOptionsMaybeChanged();\n    }\n    // ---- end view event handlers\n    // ----------- HELPERS FOR OTHERS\n    getPositionFromDOMInfo(spanNode, offset) {\n        const viewLineDomNode = this._getViewLineDomNode(spanNode);\n        if (viewLineDomNode === null) {\n            // Couldn't find view line node\n            return null;\n        }\n        const lineNumber = this._getLineNumberFor(viewLineDomNode);\n        if (lineNumber === -1) {\n            // Couldn't find view line node\n            return null;\n        }\n        if (lineNumber < 1 || lineNumber > this._context.viewModel.getLineCount()) {\n            // lineNumber is outside range\n            return null;\n        }\n        if (this._context.viewModel.getLineMaxColumn(lineNumber) === 1) {\n            // Line is empty\n            return new Position(lineNumber, 1);\n        }\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\n            // Couldn't find line\n            return null;\n        }\n        let column = this._visibleLines.getVisibleLine(lineNumber).getColumnOfNodeOffset(lineNumber, spanNode, offset);\n        const minColumn = this._context.viewModel.getLineMinColumn(lineNumber);\n        if (column < minColumn) {\n            column = minColumn;\n        }\n        return new Position(lineNumber, column);\n    }\n    _getViewLineDomNode(node) {\n        while (node && node.nodeType === 1) {\n            if (node.className === ViewLine.CLASS_NAME) {\n                return node;\n            }\n            node = node.parentElement;\n        }\n        return null;\n    }\n    /**\n     * @returns the line number of this view line dom node.\n     */\n    _getLineNumberFor(domNode) {\n        const startLineNumber = this._visibleLines.getStartLineNumber();\n        const endLineNumber = this._visibleLines.getEndLineNumber();\n        for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n            const line = this._visibleLines.getVisibleLine(lineNumber);\n            if (domNode === line.getDomNode()) {\n                return lineNumber;\n            }\n        }\n        return -1;\n    }\n    getLineWidth(lineNumber) {\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\n            // Couldn't find line\n            return -1;\n        }\n        const context = new DomReadingContext(this.domNode.domNode, this._textRangeRestingSpot);\n        const result = this._visibleLines.getVisibleLine(lineNumber).getWidth(context);\n        this._updateLineWidthsSlowIfDomDidLayout(context);\n        return result;\n    }\n    linesVisibleRangesForRange(_range, includeNewLines) {\n        if (this.shouldRender()) {\n            // Cannot read from the DOM because it is dirty\n            // i.e. the model & the dom are out of sync, so I'd be reading something stale\n            return null;\n        }\n        const originalEndLineNumber = _range.endLineNumber;\n        const range = Range.intersectRanges(_range, this._lastRenderedData.getCurrentVisibleRange());\n        if (!range) {\n            return null;\n        }\n        const visibleRanges = [];\n        let visibleRangesLen = 0;\n        const domReadingContext = new DomReadingContext(this.domNode.domNode, this._textRangeRestingSpot);\n        let nextLineModelLineNumber = 0;\n        if (includeNewLines) {\n            nextLineModelLineNumber = this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position(range.startLineNumber, 1)).lineNumber;\n        }\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        for (let lineNumber = range.startLineNumber; lineNumber <= range.endLineNumber; lineNumber++) {\n            if (lineNumber < rendStartLineNumber || lineNumber > rendEndLineNumber) {\n                continue;\n            }\n            const startColumn = lineNumber === range.startLineNumber ? range.startColumn : 1;\n            const continuesInNextLine = lineNumber !== range.endLineNumber;\n            const endColumn = continuesInNextLine ? this._context.viewModel.getLineMaxColumn(lineNumber) : range.endColumn;\n            const visibleRangesForLine = this._visibleLines.getVisibleLine(lineNumber).getVisibleRangesForRange(lineNumber, startColumn, endColumn, domReadingContext);\n            if (!visibleRangesForLine) {\n                continue;\n            }\n            if (includeNewLines && lineNumber < originalEndLineNumber) {\n                const currentLineModelLineNumber = nextLineModelLineNumber;\n                nextLineModelLineNumber = this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position(lineNumber + 1, 1)).lineNumber;\n                if (currentLineModelLineNumber !== nextLineModelLineNumber) {\n                    visibleRangesForLine.ranges[visibleRangesForLine.ranges.length - 1].width += this._typicalHalfwidthCharacterWidth;\n                }\n            }\n            visibleRanges[visibleRangesLen++] = new LineVisibleRanges(visibleRangesForLine.outsideRenderedLine, lineNumber, HorizontalRange.from(visibleRangesForLine.ranges), continuesInNextLine);\n        }\n        this._updateLineWidthsSlowIfDomDidLayout(domReadingContext);\n        if (visibleRangesLen === 0) {\n            return null;\n        }\n        return visibleRanges;\n    }\n    _visibleRangesForLineRange(lineNumber, startColumn, endColumn) {\n        if (this.shouldRender()) {\n            // Cannot read from the DOM because it is dirty\n            // i.e. the model & the dom are out of sync, so I'd be reading something stale\n            return null;\n        }\n        if (lineNumber < this._visibleLines.getStartLineNumber() || lineNumber > this._visibleLines.getEndLineNumber()) {\n            return null;\n        }\n        const domReadingContext = new DomReadingContext(this.domNode.domNode, this._textRangeRestingSpot);\n        const result = this._visibleLines.getVisibleLine(lineNumber).getVisibleRangesForRange(lineNumber, startColumn, endColumn, domReadingContext);\n        this._updateLineWidthsSlowIfDomDidLayout(domReadingContext);\n        return result;\n    }\n    visibleRangeForPosition(position) {\n        const visibleRanges = this._visibleRangesForLineRange(position.lineNumber, position.column, position.column);\n        if (!visibleRanges) {\n            return null;\n        }\n        return new HorizontalPosition(visibleRanges.outsideRenderedLine, visibleRanges.ranges[0].left);\n    }\n    /**\n     * Updates the max line width if it is fast to compute.\n     * Returns true if all lines were taken into account.\n     * Returns false if some lines need to be reevaluated (in a slow fashion).\n     */\n    _updateLineWidthsFast() {\n        return this._updateLineWidths(true);\n    }\n    _updateLineWidthsSlow() {\n        this._updateLineWidths(false);\n    }\n    /**\n     * Update the line widths using DOM layout information after someone else\n     * has caused a synchronous layout.\n     */\n    _updateLineWidthsSlowIfDomDidLayout(domReadingContext) {\n        if (!domReadingContext.didDomLayout) {\n            // only proceed if we just did a layout\n            return;\n        }\n        if (this._asyncUpdateLineWidths.isScheduled()) {\n            // reading widths is not scheduled => widths are up-to-date\n            return;\n        }\n        this._asyncUpdateLineWidths.cancel();\n        this._updateLineWidthsSlow();\n    }\n    _updateLineWidths(fast) {\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        let localMaxLineWidth = 1;\n        let allWidthsComputed = true;\n        for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n            const visibleLine = this._visibleLines.getVisibleLine(lineNumber);\n            if (fast && !visibleLine.getWidthIsFast()) {\n                // Cannot compute width in a fast way for this line\n                allWidthsComputed = false;\n                continue;\n            }\n            localMaxLineWidth = Math.max(localMaxLineWidth, visibleLine.getWidth(null));\n        }\n        if (allWidthsComputed && rendStartLineNumber === 1 && rendEndLineNumber === this._context.viewModel.getLineCount()) {\n            // we know the max line width for all the lines\n            this._maxLineWidth = 0;\n        }\n        this._ensureMaxLineWidth(localMaxLineWidth);\n        return allWidthsComputed;\n    }\n    _checkMonospaceFontAssumptions() {\n        // Problems with monospace assumptions are more apparent for longer lines,\n        // as small rounding errors start to sum up, so we will select the longest\n        // line for a closer inspection\n        let longestLineNumber = -1;\n        let longestWidth = -1;\n        const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n        const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n        for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n            const visibleLine = this._visibleLines.getVisibleLine(lineNumber);\n            if (visibleLine.needsMonospaceFontCheck()) {\n                const lineWidth = visibleLine.getWidth(null);\n                if (lineWidth > longestWidth) {\n                    longestWidth = lineWidth;\n                    longestLineNumber = lineNumber;\n                }\n            }\n        }\n        if (longestLineNumber === -1) {\n            return;\n        }\n        if (!this._visibleLines.getVisibleLine(longestLineNumber).monospaceAssumptionsAreValid()) {\n            for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n                const visibleLine = this._visibleLines.getVisibleLine(lineNumber);\n                visibleLine.onMonospaceAssumptionsInvalidated();\n            }\n        }\n    }\n    prepareRender() {\n        throw new Error('Not supported');\n    }\n    render() {\n        throw new Error('Not supported');\n    }\n    renderText(viewportData) {\n        // (1) render lines - ensures lines are in the DOM\n        this._visibleLines.renderLines(viewportData);\n        this._lastRenderedData.setCurrentVisibleRange(viewportData.visibleRange);\n        this.domNode.setWidth(this._context.viewLayout.getScrollWidth());\n        this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(), 1000000));\n        // (2) compute horizontal scroll position:\n        //  - this must happen after the lines are in the DOM since it might need a line that rendered just now\n        //  - it might change `scrollWidth` and `scrollLeft`\n        if (this._horizontalRevealRequest) {\n            const horizontalRevealRequest = this._horizontalRevealRequest;\n            // Check that we have the line that contains the horizontal range in the viewport\n            if (viewportData.startLineNumber <= horizontalRevealRequest.minLineNumber && horizontalRevealRequest.maxLineNumber <= viewportData.endLineNumber) {\n                this._horizontalRevealRequest = null;\n                // allow `visibleRangesForRange2` to work\n                this.onDidRender();\n                // compute new scroll position\n                const newScrollLeft = this._computeScrollLeftToReveal(horizontalRevealRequest);\n                if (newScrollLeft) {\n                    if (!this._isViewportWrapping) {\n                        // ensure `scrollWidth` is large enough\n                        this._ensureMaxLineWidth(newScrollLeft.maxHorizontalOffset);\n                    }\n                    // set `scrollLeft`\n                    this._context.viewModel.viewLayout.setScrollPosition({\n                        scrollLeft: newScrollLeft.scrollLeft\n                    }, horizontalRevealRequest.scrollType);\n                }\n            }\n        }\n        // Update max line width (not so important, it is just so the horizontal scrollbar doesn't get too small)\n        if (!this._updateLineWidthsFast()) {\n            // Computing the width of some lines would be slow => delay it\n            this._asyncUpdateLineWidths.schedule();\n        }\n        else {\n            this._asyncUpdateLineWidths.cancel();\n        }\n        if (platform.isLinux && !this._asyncCheckMonospaceFontAssumptions.isScheduled()) {\n            const rendStartLineNumber = this._visibleLines.getStartLineNumber();\n            const rendEndLineNumber = this._visibleLines.getEndLineNumber();\n            for (let lineNumber = rendStartLineNumber; lineNumber <= rendEndLineNumber; lineNumber++) {\n                const visibleLine = this._visibleLines.getVisibleLine(lineNumber);\n                if (visibleLine.needsMonospaceFontCheck()) {\n                    this._asyncCheckMonospaceFontAssumptions.schedule();\n                    break;\n                }\n            }\n        }\n        // (3) handle scrolling\n        this._linesContent.setLayerHinting(this._canUseLayerHinting);\n        this._linesContent.setContain('strict');\n        const adjustedScrollTop = this._context.viewLayout.getCurrentScrollTop() - viewportData.bigNumbersDelta;\n        this._linesContent.setTop(-adjustedScrollTop);\n        this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft());\n    }\n    // --- width\n    _ensureMaxLineWidth(lineWidth) {\n        const iLineWidth = Math.ceil(lineWidth);\n        if (this._maxLineWidth < iLineWidth) {\n            this._maxLineWidth = iLineWidth;\n            this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth);\n        }\n    }\n    _computeScrollTopToRevealRange(viewport, source, minimalReveal, range, selections, verticalType) {\n        const viewportStartY = viewport.top;\n        const viewportHeight = viewport.height;\n        const viewportEndY = viewportStartY + viewportHeight;\n        let boxIsSingleRange;\n        let boxStartY;\n        let boxEndY;\n        if (selections && selections.length > 0) {\n            let minLineNumber = selections[0].startLineNumber;\n            let maxLineNumber = selections[0].endLineNumber;\n            for (let i = 1, len = selections.length; i < len; i++) {\n                const selection = selections[i];\n                minLineNumber = Math.min(minLineNumber, selection.startLineNumber);\n                maxLineNumber = Math.max(maxLineNumber, selection.endLineNumber);\n            }\n            boxIsSingleRange = false;\n            boxStartY = this._context.viewLayout.getVerticalOffsetForLineNumber(minLineNumber);\n            boxEndY = this._context.viewLayout.getVerticalOffsetForLineNumber(maxLineNumber) + this._lineHeight;\n        }\n        else if (range) {\n            boxIsSingleRange = true;\n            boxStartY = this._context.viewLayout.getVerticalOffsetForLineNumber(range.startLineNumber);\n            boxEndY = this._context.viewLayout.getVerticalOffsetForLineNumber(range.endLineNumber) + this._lineHeight;\n        }\n        else {\n            return -1;\n        }\n        const shouldIgnoreScrollOff = (source === 'mouse' || minimalReveal) && this._cursorSurroundingLinesStyle === 'default';\n        let paddingTop = 0;\n        let paddingBottom = 0;\n        if (!shouldIgnoreScrollOff) {\n            const context = Math.min((viewportHeight / this._lineHeight) / 2, this._cursorSurroundingLines);\n            if (this._stickyScrollEnabled) {\n                paddingTop = Math.max(context, this._maxNumberStickyLines) * this._lineHeight;\n            }\n            else {\n                paddingTop = context * this._lineHeight;\n            }\n            paddingBottom = Math.max(0, (context - 1)) * this._lineHeight;\n        }\n        else {\n            if (!minimalReveal) {\n                // Reveal one more line above (this case is hit when dragging)\n                paddingTop = this._lineHeight;\n            }\n        }\n        if (!minimalReveal) {\n            if (verticalType === 0 /* viewEvents.VerticalRevealType.Simple */ || verticalType === 4 /* viewEvents.VerticalRevealType.Bottom */) {\n                // Reveal one line more when the last line would be covered by the scrollbar - arrow down case or revealing a line explicitly at bottom\n                paddingBottom += this._lineHeight;\n            }\n        }\n        boxStartY -= paddingTop;\n        boxEndY += paddingBottom;\n        let newScrollTop;\n        if (boxEndY - boxStartY > viewportHeight) {\n            // the box is larger than the viewport ... scroll to its top\n            if (!boxIsSingleRange) {\n                // do not reveal multiple cursors if there are more than fit the viewport\n                return -1;\n            }\n            newScrollTop = boxStartY;\n        }\n        else if (verticalType === 5 /* viewEvents.VerticalRevealType.NearTop */ || verticalType === 6 /* viewEvents.VerticalRevealType.NearTopIfOutsideViewport */) {\n            if (verticalType === 6 /* viewEvents.VerticalRevealType.NearTopIfOutsideViewport */ && viewportStartY <= boxStartY && boxEndY <= viewportEndY) {\n                // Box is already in the viewport... do nothing\n                newScrollTop = viewportStartY;\n            }\n            else {\n                // We want a gap that is 20% of the viewport, but with a minimum of 5 lines\n                const desiredGapAbove = Math.max(5 * this._lineHeight, viewportHeight * 0.2);\n                // Try to scroll just above the box with the desired gap\n                const desiredScrollTop = boxStartY - desiredGapAbove;\n                // But ensure that the box is not pushed out of viewport\n                const minScrollTop = boxEndY - viewportHeight;\n                newScrollTop = Math.max(minScrollTop, desiredScrollTop);\n            }\n        }\n        else if (verticalType === 1 /* viewEvents.VerticalRevealType.Center */ || verticalType === 2 /* viewEvents.VerticalRevealType.CenterIfOutsideViewport */) {\n            if (verticalType === 2 /* viewEvents.VerticalRevealType.CenterIfOutsideViewport */ && viewportStartY <= boxStartY && boxEndY <= viewportEndY) {\n                // Box is already in the viewport... do nothing\n                newScrollTop = viewportStartY;\n            }\n            else {\n                // Box is outside the viewport... center it\n                const boxMiddleY = (boxStartY + boxEndY) / 2;\n                newScrollTop = Math.max(0, boxMiddleY - viewportHeight / 2);\n            }\n        }\n        else {\n            newScrollTop = this._computeMinimumScrolling(viewportStartY, viewportEndY, boxStartY, boxEndY, verticalType === 3 /* viewEvents.VerticalRevealType.Top */, verticalType === 4 /* viewEvents.VerticalRevealType.Bottom */);\n        }\n        return newScrollTop;\n    }\n    _computeScrollLeftToReveal(horizontalRevealRequest) {\n        const viewport = this._context.viewLayout.getCurrentViewport();\n        const layoutInfo = this._context.configuration.options.get(142 /* EditorOption.layoutInfo */);\n        const viewportStartX = viewport.left;\n        const viewportEndX = viewportStartX + viewport.width - layoutInfo.verticalScrollbarWidth;\n        let boxStartX = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n        let boxEndX = 0;\n        if (horizontalRevealRequest.type === 'range') {\n            const visibleRanges = this._visibleRangesForLineRange(horizontalRevealRequest.lineNumber, horizontalRevealRequest.startColumn, horizontalRevealRequest.endColumn);\n            if (!visibleRanges) {\n                return null;\n            }\n            for (const visibleRange of visibleRanges.ranges) {\n                boxStartX = Math.min(boxStartX, Math.round(visibleRange.left));\n                boxEndX = Math.max(boxEndX, Math.round(visibleRange.left + visibleRange.width));\n            }\n        }\n        else {\n            for (const selection of horizontalRevealRequest.selections) {\n                if (selection.startLineNumber !== selection.endLineNumber) {\n                    return null;\n                }\n                const visibleRanges = this._visibleRangesForLineRange(selection.startLineNumber, selection.startColumn, selection.endColumn);\n                if (!visibleRanges) {\n                    return null;\n                }\n                for (const visibleRange of visibleRanges.ranges) {\n                    boxStartX = Math.min(boxStartX, Math.round(visibleRange.left));\n                    boxEndX = Math.max(boxEndX, Math.round(visibleRange.left + visibleRange.width));\n                }\n            }\n        }\n        if (!horizontalRevealRequest.minimalReveal) {\n            boxStartX = Math.max(0, boxStartX - ViewLines.HORIZONTAL_EXTRA_PX);\n            boxEndX += this._revealHorizontalRightPadding;\n        }\n        if (horizontalRevealRequest.type === 'selections' && boxEndX - boxStartX > viewport.width) {\n            return null;\n        }\n        const newScrollLeft = this._computeMinimumScrolling(viewportStartX, viewportEndX, boxStartX, boxEndX);\n        return {\n            scrollLeft: newScrollLeft,\n            maxHorizontalOffset: boxEndX\n        };\n    }\n    _computeMinimumScrolling(viewportStart, viewportEnd, boxStart, boxEnd, revealAtStart, revealAtEnd) {\n        viewportStart = viewportStart | 0;\n        viewportEnd = viewportEnd | 0;\n        boxStart = boxStart | 0;\n        boxEnd = boxEnd | 0;\n        revealAtStart = !!revealAtStart;\n        revealAtEnd = !!revealAtEnd;\n        const viewportLength = viewportEnd - viewportStart;\n        const boxLength = boxEnd - boxStart;\n        if (boxLength < viewportLength) {\n            // The box would fit in the viewport\n            if (revealAtStart) {\n                return boxStart;\n            }\n            if (revealAtEnd) {\n                return Math.max(0, boxEnd - viewportLength);\n            }\n            if (boxStart < viewportStart) {\n                // The box is above the viewport\n                return boxStart;\n            }\n            else if (boxEnd > viewportEnd) {\n                // The box is below the viewport\n                return Math.max(0, boxEnd - viewportLength);\n            }\n        }\n        else {\n            // The box would not fit in the viewport\n            // Reveal the beginning of the box\n            return boxStart;\n        }\n        return viewportStart;\n    }\n}\n/**\n * Adds this amount of pixels to the right of lines (no-one wants to type near the edge of the viewport)\n */\nViewLines.HORIZONTAL_EXTRA_PX = 30;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { ArrayQueue } from '../../../../base/common/arrays.js';\nimport './glyphMargin.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport { ViewPart } from '../../view/viewPart.js';\nimport { Range } from '../../../common/core/range.js';\n/**\n * Represents a decoration that should be shown along the lines from `startLineNumber` to `endLineNumber`.\n * This can end up producing multiple `LineDecorationToRender`.\n */\nexport class DecorationToRender {\n    constructor(startLineNumber, endLineNumber, className, zIndex) {\n        this._decorationToRenderBrand = undefined;\n        this.startLineNumber = +startLineNumber;\n        this.endLineNumber = +endLineNumber;\n        this.className = String(className);\n        this.zIndex = zIndex !== null && zIndex !== void 0 ? zIndex : 0;\n    }\n}\n/**\n * A decoration that should be shown along a line.\n */\nexport class LineDecorationToRender {\n    constructor(className, zIndex) {\n        this.className = className;\n        this.zIndex = zIndex;\n    }\n}\n/**\n * Decorations to render on a visible line.\n */\nexport class VisibleLineDecorationsToRender {\n    constructor() {\n        this.decorations = [];\n    }\n    add(decoration) {\n        this.decorations.push(decoration);\n    }\n    getDecorations() {\n        return this.decorations;\n    }\n}\nexport class DedupOverlay extends DynamicViewOverlay {\n    /**\n     * Returns an array with an element for each visible line number.\n     */\n    _render(visibleStartLineNumber, visibleEndLineNumber, decorations) {\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            output[lineIndex] = new VisibleLineDecorationsToRender();\n        }\n        if (decorations.length === 0) {\n            return output;\n        }\n        // Sort decorations by className, then by startLineNumber and then by endLineNumber\n        decorations.sort((a, b) => {\n            if (a.className === b.className) {\n                if (a.startLineNumber === b.startLineNumber) {\n                    return a.endLineNumber - b.endLineNumber;\n                }\n                return a.startLineNumber - b.startLineNumber;\n            }\n            return (a.className < b.className ? -1 : 1);\n        });\n        let prevClassName = null;\n        let prevEndLineIndex = 0;\n        for (let i = 0, len = decorations.length; i < len; i++) {\n            const d = decorations[i];\n            const className = d.className;\n            const zIndex = d.zIndex;\n            let startLineIndex = Math.max(d.startLineNumber, visibleStartLineNumber) - visibleStartLineNumber;\n            const endLineIndex = Math.min(d.endLineNumber, visibleEndLineNumber) - visibleStartLineNumber;\n            if (prevClassName === className) {\n                // Here we avoid rendering the same className multiple times on the same line\n                startLineIndex = Math.max(prevEndLineIndex + 1, startLineIndex);\n                prevEndLineIndex = Math.max(prevEndLineIndex, endLineIndex);\n            }\n            else {\n                prevClassName = className;\n                prevEndLineIndex = endLineIndex;\n            }\n            for (let i = startLineIndex; i <= prevEndLineIndex; i++) {\n                output[i].add(new LineDecorationToRender(className, zIndex));\n            }\n        }\n        return output;\n    }\n}\nexport class GlyphMarginWidgets extends ViewPart {\n    constructor(context) {\n        super(context);\n        this._widgets = {};\n        this._context = context;\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this.domNode = createFastDomNode(document.createElement('div'));\n        this.domNode.setClassName('glyph-margin-widgets');\n        this.domNode.setPosition('absolute');\n        this.domNode.setTop(0);\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._glyphMargin = options.get(56 /* EditorOption.glyphMargin */);\n        this._glyphMarginLeft = layoutInfo.glyphMarginLeft;\n        this._glyphMarginWidth = layoutInfo.glyphMarginWidth;\n        this._glyphMarginDecorationLaneCount = layoutInfo.glyphMarginDecorationLaneCount;\n        this._managedDomNodes = [];\n        this._decorationGlyphsToRender = [];\n    }\n    dispose() {\n        this._managedDomNodes = [];\n        this._decorationGlyphsToRender = [];\n        this._widgets = {};\n        super.dispose();\n    }\n    getWidgets() {\n        return Object.values(this._widgets);\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._glyphMargin = options.get(56 /* EditorOption.glyphMargin */);\n        this._glyphMarginLeft = layoutInfo.glyphMarginLeft;\n        this._glyphMarginWidth = layoutInfo.glyphMarginWidth;\n        this._glyphMarginDecorationLaneCount = layoutInfo.glyphMarginDecorationLaneCount;\n        return true;\n    }\n    onDecorationsChanged(e) {\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    // --- begin widget management\n    addWidget(widget) {\n        const domNode = createFastDomNode(widget.getDomNode());\n        this._widgets[widget.getId()] = {\n            widget: widget,\n            preference: widget.getPosition(),\n            domNode: domNode,\n            renderInfo: null\n        };\n        domNode.setPosition('absolute');\n        domNode.setDisplay('none');\n        domNode.setAttribute('widgetId', widget.getId());\n        this.domNode.appendChild(domNode);\n        this.setShouldRender();\n    }\n    setWidgetPosition(widget, preference) {\n        const myWidget = this._widgets[widget.getId()];\n        if (myWidget.preference.lane === preference.lane\n            && myWidget.preference.zIndex === preference.zIndex\n            && Range.equalsRange(myWidget.preference.range, preference.range)) {\n            return false;\n        }\n        myWidget.preference = preference;\n        this.setShouldRender();\n        return true;\n    }\n    removeWidget(widget) {\n        var _a;\n        const widgetId = widget.getId();\n        if (this._widgets[widgetId]) {\n            const widgetData = this._widgets[widgetId];\n            const domNode = widgetData.domNode.domNode;\n            delete this._widgets[widgetId];\n            (_a = domNode.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(domNode);\n            this.setShouldRender();\n        }\n    }\n    // --- end widget management\n    _collectDecorationBasedGlyphRenderRequest(ctx, requests) {\n        var _a, _b, _c;\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const decorations = ctx.getDecorationsInViewport();\n        for (const d of decorations) {\n            const glyphMarginClassName = d.options.glyphMarginClassName;\n            if (!glyphMarginClassName) {\n                continue;\n            }\n            const startLineNumber = Math.max(d.range.startLineNumber, visibleStartLineNumber);\n            const endLineNumber = Math.min(d.range.endLineNumber, visibleEndLineNumber);\n            const lane = Math.min((_b = (_a = d.options.glyphMargin) === null || _a === void 0 ? void 0 : _a.position) !== null && _b !== void 0 ? _b : 1, this._glyphMarginDecorationLaneCount);\n            const zIndex = (_c = d.options.zIndex) !== null && _c !== void 0 ? _c : 0;\n            for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n                requests.push(new DecorationBasedGlyphRenderRequest(lineNumber, lane, zIndex, glyphMarginClassName));\n            }\n        }\n    }\n    _collectWidgetBasedGlyphRenderRequest(ctx, requests) {\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        for (const widget of Object.values(this._widgets)) {\n            const range = widget.preference.range;\n            if (range.endLineNumber < visibleStartLineNumber || range.startLineNumber > visibleEndLineNumber) {\n                // The widget is not in the viewport\n                continue;\n            }\n            // The widget is in the viewport, find a good line for it\n            const widgetLineNumber = Math.max(range.startLineNumber, visibleStartLineNumber);\n            const lane = Math.min(widget.preference.lane, this._glyphMarginDecorationLaneCount);\n            requests.push(new WidgetBasedGlyphRenderRequest(widgetLineNumber, lane, widget.preference.zIndex, widget));\n        }\n    }\n    _collectSortedGlyphRenderRequests(ctx) {\n        const requests = [];\n        this._collectDecorationBasedGlyphRenderRequest(ctx, requests);\n        this._collectWidgetBasedGlyphRenderRequest(ctx, requests);\n        // sort requests by lineNumber ASC, lane  ASC, zIndex DESC, type DESC (widgets first), className ASC\n        // don't change this sort unless you understand `prepareRender` below.\n        requests.sort((a, b) => {\n            if (a.lineNumber === b.lineNumber) {\n                if (a.lane === b.lane) {\n                    if (a.zIndex === b.zIndex) {\n                        if (b.type === a.type) {\n                            if (a.type === 0 /* GlyphRenderRequestType.Decoration */ && b.type === 0 /* GlyphRenderRequestType.Decoration */) {\n                                return (a.className < b.className ? -1 : 1);\n                            }\n                            return 0;\n                        }\n                        return b.type - a.type;\n                    }\n                    return b.zIndex - a.zIndex;\n                }\n                return a.lane - b.lane;\n            }\n            return a.lineNumber - b.lineNumber;\n        });\n        return requests;\n    }\n    /**\n     * Will store render information in each widget's renderInfo and in `_decorationGlyphsToRender`.\n     */\n    prepareRender(ctx) {\n        if (!this._glyphMargin) {\n            this._decorationGlyphsToRender = [];\n            return;\n        }\n        for (const widget of Object.values(this._widgets)) {\n            widget.renderInfo = null;\n        }\n        const requests = new ArrayQueue(this._collectSortedGlyphRenderRequests(ctx));\n        const decorationGlyphsToRender = [];\n        while (requests.length > 0) {\n            const first = requests.peek();\n            if (!first) {\n                // not possible\n                break;\n            }\n            // Requests are sorted by lineNumber and lane, so we read all requests for this particular location\n            const requestsAtLocation = requests.takeWhile((el) => el.lineNumber === first.lineNumber && el.lane === first.lane);\n            if (!requestsAtLocation || requestsAtLocation.length === 0) {\n                // not possible\n                break;\n            }\n            const winner = requestsAtLocation[0];\n            if (winner.type === 0 /* GlyphRenderRequestType.Decoration */) {\n                // combine all decorations with the same z-index\n                const classNames = [];\n                // requests are sorted by zIndex, type, and className so we can dedup className by looking at the previous one\n                for (const request of requestsAtLocation) {\n                    if (request.zIndex !== winner.zIndex || request.type !== winner.type) {\n                        break;\n                    }\n                    if (classNames.length === 0 || classNames[classNames.length - 1] !== request.className) {\n                        classNames.push(request.className);\n                    }\n                }\n                decorationGlyphsToRender.push(winner.accept(classNames.join(' '))); // TODO@joyceerhl Implement overflow for remaining decorations\n            }\n            else {\n                // widgets cannot be combined\n                winner.widget.renderInfo = {\n                    lineNumber: winner.lineNumber,\n                    lane: winner.lane,\n                };\n            }\n        }\n        this._decorationGlyphsToRender = decorationGlyphsToRender;\n    }\n    render(ctx) {\n        if (!this._glyphMargin) {\n            for (const widget of Object.values(this._widgets)) {\n                widget.domNode.setDisplay('none');\n            }\n            while (this._managedDomNodes.length > 0) {\n                const domNode = this._managedDomNodes.pop();\n                domNode === null || domNode === void 0 ? void 0 : domNode.domNode.remove();\n            }\n            return;\n        }\n        const width = (Math.round(this._glyphMarginWidth / this._glyphMarginDecorationLaneCount));\n        // Render widgets\n        for (const widget of Object.values(this._widgets)) {\n            if (!widget.renderInfo) {\n                // this widget is not visible\n                widget.domNode.setDisplay('none');\n            }\n            else {\n                const top = ctx.viewportData.relativeVerticalOffset[widget.renderInfo.lineNumber - ctx.viewportData.startLineNumber];\n                const left = this._glyphMarginLeft + (widget.renderInfo.lane - 1) * this._lineHeight;\n                widget.domNode.setDisplay('block');\n                widget.domNode.setTop(top);\n                widget.domNode.setLeft(left);\n                widget.domNode.setWidth(width);\n                widget.domNode.setHeight(this._lineHeight);\n            }\n        }\n        // Render decorations, reusing previous dom nodes as possible\n        for (let i = 0; i < this._decorationGlyphsToRender.length; i++) {\n            const dec = this._decorationGlyphsToRender[i];\n            const top = ctx.viewportData.relativeVerticalOffset[dec.lineNumber - ctx.viewportData.startLineNumber];\n            const left = this._glyphMarginLeft + (dec.lane - 1) * this._lineHeight;\n            let domNode;\n            if (i < this._managedDomNodes.length) {\n                domNode = this._managedDomNodes[i];\n            }\n            else {\n                domNode = createFastDomNode(document.createElement('div'));\n                this._managedDomNodes.push(domNode);\n                this.domNode.appendChild(domNode);\n            }\n            domNode.setClassName(`cgmr codicon ` + dec.combinedClassName);\n            domNode.setPosition(`absolute`);\n            domNode.setTop(top);\n            domNode.setLeft(left);\n            domNode.setWidth(width);\n            domNode.setHeight(this._lineHeight);\n        }\n        // remove extra dom nodes\n        while (this._managedDomNodes.length > this._decorationGlyphsToRender.length) {\n            const domNode = this._managedDomNodes.pop();\n            domNode === null || domNode === void 0 ? void 0 : domNode.domNode.remove();\n        }\n    }\n}\n/**\n * A request to render a decoration in the glyph margin at a certain location.\n */\nclass DecorationBasedGlyphRenderRequest {\n    constructor(lineNumber, lane, zIndex, className) {\n        this.lineNumber = lineNumber;\n        this.lane = lane;\n        this.zIndex = zIndex;\n        this.className = className;\n        this.type = 0 /* GlyphRenderRequestType.Decoration */;\n    }\n    accept(combinedClassName) {\n        return new DecorationBasedGlyph(this.lineNumber, this.lane, combinedClassName);\n    }\n}\n/**\n * A request to render a widget in the glyph margin at a certain location.\n */\nclass WidgetBasedGlyphRenderRequest {\n    constructor(lineNumber, lane, zIndex, widget) {\n        this.lineNumber = lineNumber;\n        this.lane = lane;\n        this.zIndex = zIndex;\n        this.widget = widget;\n        this.type = 1 /* GlyphRenderRequestType.Widget */;\n    }\n}\nclass DecorationBasedGlyph {\n    constructor(lineNumber, lane, combinedClassName) {\n        this.lineNumber = lineNumber;\n        this.lane = lane;\n        this.combinedClassName = combinedClassName;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './linesDecorations.css';\nimport { DecorationToRender, DedupOverlay } from '../glyphMargin/glyphMargin.js';\nexport class LinesDecorationsOverlay extends DedupOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._decorationsLeft = layoutInfo.decorationsLeft;\n        this._decorationsWidth = layoutInfo.decorationsWidth;\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._decorationsLeft = layoutInfo.decorationsLeft;\n        this._decorationsWidth = layoutInfo.decorationsWidth;\n        return true;\n    }\n    onDecorationsChanged(e) {\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    _getDecorations(ctx) {\n        const decorations = ctx.getDecorationsInViewport();\n        const r = [];\n        let rLen = 0;\n        for (let i = 0, len = decorations.length; i < len; i++) {\n            const d = decorations[i];\n            const linesDecorationsClassName = d.options.linesDecorationsClassName;\n            const zIndex = d.options.zIndex;\n            if (linesDecorationsClassName) {\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.endLineNumber, linesDecorationsClassName, zIndex);\n            }\n            const firstLineDecorationClassName = d.options.firstLineDecorationClassName;\n            if (firstLineDecorationClassName) {\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.startLineNumber, firstLineDecorationClassName, zIndex);\n            }\n        }\n        return r;\n    }\n    prepareRender(ctx) {\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const toRender = this._render(visibleStartLineNumber, visibleEndLineNumber, this._getDecorations(ctx));\n        const left = this._decorationsLeft.toString();\n        const width = this._decorationsWidth.toString();\n        const common = '\" style=\"left:' + left + 'px;width:' + width + 'px;\"></div>';\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            const decorations = toRender[lineIndex].getDecorations();\n            let lineOutput = '';\n            for (const decoration of decorations) {\n                lineOutput += '<div class=\"cldr ' + decoration.className + common;\n            }\n            output[lineIndex] = lineOutput;\n        }\n        this._renderResult = output;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        return this._renderResult[lineNumber - startLineNumber];\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './marginDecorations.css';\nimport { DecorationToRender, DedupOverlay } from '../glyphMargin/glyphMargin.js';\nexport class MarginViewLineDecorationsOverlay extends DedupOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        return true;\n    }\n    onDecorationsChanged(e) {\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    _getDecorations(ctx) {\n        const decorations = ctx.getDecorationsInViewport();\n        const r = [];\n        let rLen = 0;\n        for (let i = 0, len = decorations.length; i < len; i++) {\n            const d = decorations[i];\n            const marginClassName = d.options.marginClassName;\n            const zIndex = d.options.zIndex;\n            if (marginClassName) {\n                r[rLen++] = new DecorationToRender(d.range.startLineNumber, d.range.endLineNumber, marginClassName, zIndex);\n            }\n        }\n        return r;\n    }\n    prepareRender(ctx) {\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const toRender = this._render(visibleStartLineNumber, visibleEndLineNumber, this._getDecorations(ctx));\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            const decorations = toRender[lineIndex].getDecorations();\n            let lineOutput = '';\n            for (const decoration of decorations) {\n                lineOutput += '<div class=\"cmdr ' + decoration.className + '\" style=\"\"></div>';\n            }\n            output[lineIndex] = lineOutput;\n        }\n        this._renderResult = output;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        return this._renderResult[lineNumber - startLineNumber];\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const allCharCodes = (() => {\n    const v = [];\n    for (let i = 32 /* Constants.START_CH_CODE */; i <= 126 /* Constants.END_CH_CODE */; i++) {\n        v.push(i);\n    }\n    v.push(65533 /* Constants.UNKNOWN_CODE */);\n    return v;\n})();\nexport const getCharIndex = (chCode, fontScale) => {\n    chCode -= 32 /* Constants.START_CH_CODE */;\n    if (chCode < 0 || chCode > 96 /* Constants.CHAR_COUNT */) {\n        if (fontScale <= 2) {\n            // for smaller scales, we can get away with using any ASCII character...\n            return (chCode + 96 /* Constants.CHAR_COUNT */) % 96 /* Constants.CHAR_COUNT */;\n        }\n        return 96 /* Constants.CHAR_COUNT */ - 1; // unknown symbol\n    }\n    return chCode;\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { getCharIndex } from './minimapCharSheet.js';\nimport { toUint8 } from '../../../../base/common/uint.js';\nexport class MinimapCharRenderer {\n    constructor(charData, scale) {\n        this.scale = scale;\n        this._minimapCharRendererBrand = undefined;\n        this.charDataNormal = MinimapCharRenderer.soften(charData, 12 / 15);\n        this.charDataLight = MinimapCharRenderer.soften(charData, 50 / 60);\n    }\n    static soften(input, ratio) {\n        const result = new Uint8ClampedArray(input.length);\n        for (let i = 0, len = input.length; i < len; i++) {\n            result[i] = toUint8(input[i] * ratio);\n        }\n        return result;\n    }\n    renderChar(target, dx, dy, chCode, color, foregroundAlpha, backgroundColor, backgroundAlpha, fontScale, useLighterFont, force1pxHeight) {\n        const charWidth = 1 /* Constants.BASE_CHAR_WIDTH */ * this.scale;\n        const charHeight = 2 /* Constants.BASE_CHAR_HEIGHT */ * this.scale;\n        const renderHeight = (force1pxHeight ? 1 : charHeight);\n        if (dx + charWidth > target.width || dy + renderHeight > target.height) {\n            console.warn('bad render request outside image data');\n            return;\n        }\n        const charData = useLighterFont ? this.charDataLight : this.charDataNormal;\n        const charIndex = getCharIndex(chCode, fontScale);\n        const destWidth = target.width * 4 /* Constants.RGBA_CHANNELS_CNT */;\n        const backgroundR = backgroundColor.r;\n        const backgroundG = backgroundColor.g;\n        const backgroundB = backgroundColor.b;\n        const deltaR = color.r - backgroundR;\n        const deltaG = color.g - backgroundG;\n        const deltaB = color.b - backgroundB;\n        const destAlpha = Math.max(foregroundAlpha, backgroundAlpha);\n        const dest = target.data;\n        let sourceOffset = charIndex * charWidth * charHeight;\n        let row = dy * destWidth + dx * 4 /* Constants.RGBA_CHANNELS_CNT */;\n        for (let y = 0; y < renderHeight; y++) {\n            let column = row;\n            for (let x = 0; x < charWidth; x++) {\n                const c = (charData[sourceOffset++] / 255) * (foregroundAlpha / 255);\n                dest[column++] = backgroundR + deltaR * c;\n                dest[column++] = backgroundG + deltaG * c;\n                dest[column++] = backgroundB + deltaB * c;\n                dest[column++] = destAlpha;\n            }\n            row += destWidth;\n        }\n    }\n    blockRenderChar(target, dx, dy, color, foregroundAlpha, backgroundColor, backgroundAlpha, force1pxHeight) {\n        const charWidth = 1 /* Constants.BASE_CHAR_WIDTH */ * this.scale;\n        const charHeight = 2 /* Constants.BASE_CHAR_HEIGHT */ * this.scale;\n        const renderHeight = (force1pxHeight ? 1 : charHeight);\n        if (dx + charWidth > target.width || dy + renderHeight > target.height) {\n            console.warn('bad render request outside image data');\n            return;\n        }\n        const destWidth = target.width * 4 /* Constants.RGBA_CHANNELS_CNT */;\n        const c = 0.5 * (foregroundAlpha / 255);\n        const backgroundR = backgroundColor.r;\n        const backgroundG = backgroundColor.g;\n        const backgroundB = backgroundColor.b;\n        const deltaR = color.r - backgroundR;\n        const deltaG = color.g - backgroundG;\n        const deltaB = color.b - backgroundB;\n        const colorR = backgroundR + deltaR * c;\n        const colorG = backgroundG + deltaG * c;\n        const colorB = backgroundB + deltaB * c;\n        const destAlpha = Math.max(foregroundAlpha, backgroundAlpha);\n        const dest = target.data;\n        let row = dy * destWidth + dx * 4 /* Constants.RGBA_CHANNELS_CNT */;\n        for (let y = 0; y < renderHeight; y++) {\n            let column = row;\n            for (let x = 0; x < charWidth; x++) {\n                dest[column++] = colorR;\n                dest[column++] = colorG;\n                dest[column++] = colorB;\n                dest[column++] = destAlpha;\n            }\n            row += destWidth;\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { once } from '../../../../base/common/functional.js';\nconst charTable = {\n    '0': 0,\n    '1': 1,\n    '2': 2,\n    '3': 3,\n    '4': 4,\n    '5': 5,\n    '6': 6,\n    '7': 7,\n    '8': 8,\n    '9': 9,\n    A: 10,\n    B: 11,\n    C: 12,\n    D: 13,\n    E: 14,\n    F: 15\n};\nconst decodeData = (str) => {\n    const output = new Uint8ClampedArray(str.length / 2);\n    for (let i = 0; i < str.length; i += 2) {\n        output[i >> 1] = (charTable[str[i]] << 4) | (charTable[str[i + 1]] & 0xF);\n    }\n    return output;\n};\n/*\nconst encodeData = (data: Uint8ClampedArray, length: string) => {\n    const chars = '0123456789ABCDEF';\n    let output = '';\n    for (let i = 0; i < data.length; i++) {\n        output += chars[data[i] >> 4] + chars[data[i] & 0xf];\n    }\n    return output;\n};\n*/\n/**\n * Map of minimap scales to prebaked sample data at those scales. We don't\n * sample much larger data, because then font family becomes visible, which\n * is use-configurable.\n */\nexport const prebakedMiniMaps = {\n    1: once(() => decodeData('0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792')),\n    2: once(() => decodeData('000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126'))\n};\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { MinimapCharRenderer } from './minimapCharRenderer.js';\nimport { allCharCodes } from './minimapCharSheet.js';\nimport { prebakedMiniMaps } from './minimapPreBaked.js';\nimport { toUint8 } from '../../../../base/common/uint.js';\n/**\n * Creates character renderers. It takes a 'scale' that determines how large\n * characters should be drawn. Using this, it draws data into a canvas and\n * then downsamples the characters as necessary for the current display.\n * This makes rendering more efficient, rather than drawing a full (tiny)\n * font, or downsampling in real-time.\n */\nexport class MinimapCharRendererFactory {\n    /**\n     * Creates a new character renderer factory with the given scale.\n     */\n    static create(scale, fontFamily) {\n        // renderers are immutable. By default we'll 'create' a new minimap\n        // character renderer whenever we switch editors, no need to do extra work.\n        if (this.lastCreated && scale === this.lastCreated.scale && fontFamily === this.lastFontFamily) {\n            return this.lastCreated;\n        }\n        let factory;\n        if (prebakedMiniMaps[scale]) {\n            factory = new MinimapCharRenderer(prebakedMiniMaps[scale](), scale);\n        }\n        else {\n            factory = MinimapCharRendererFactory.createFromSampleData(MinimapCharRendererFactory.createSampleData(fontFamily).data, scale);\n        }\n        this.lastFontFamily = fontFamily;\n        this.lastCreated = factory;\n        return factory;\n    }\n    /**\n     * Creates the font sample data, writing to a canvas.\n     */\n    static createSampleData(fontFamily) {\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        canvas.style.height = `${16 /* Constants.SAMPLED_CHAR_HEIGHT */}px`;\n        canvas.height = 16 /* Constants.SAMPLED_CHAR_HEIGHT */;\n        canvas.width = 96 /* Constants.CHAR_COUNT */ * 10 /* Constants.SAMPLED_CHAR_WIDTH */;\n        canvas.style.width = 96 /* Constants.CHAR_COUNT */ * 10 /* Constants.SAMPLED_CHAR_WIDTH */ + 'px';\n        ctx.fillStyle = '#ffffff';\n        ctx.font = `bold ${16 /* Constants.SAMPLED_CHAR_HEIGHT */}px ${fontFamily}`;\n        ctx.textBaseline = 'middle';\n        let x = 0;\n        for (const code of allCharCodes) {\n            ctx.fillText(String.fromCharCode(code), x, 16 /* Constants.SAMPLED_CHAR_HEIGHT */ / 2);\n            x += 10 /* Constants.SAMPLED_CHAR_WIDTH */;\n        }\n        return ctx.getImageData(0, 0, 96 /* Constants.CHAR_COUNT */ * 10 /* Constants.SAMPLED_CHAR_WIDTH */, 16 /* Constants.SAMPLED_CHAR_HEIGHT */);\n    }\n    /**\n     * Creates a character renderer from the canvas sample data.\n     */\n    static createFromSampleData(source, scale) {\n        const expectedLength = 16 /* Constants.SAMPLED_CHAR_HEIGHT */ * 10 /* Constants.SAMPLED_CHAR_WIDTH */ * 4 /* Constants.RGBA_CHANNELS_CNT */ * 96 /* Constants.CHAR_COUNT */;\n        if (source.length !== expectedLength) {\n            throw new Error('Unexpected source in MinimapCharRenderer');\n        }\n        const charData = MinimapCharRendererFactory._downsample(source, scale);\n        return new MinimapCharRenderer(charData, scale);\n    }\n    static _downsampleChar(source, sourceOffset, dest, destOffset, scale) {\n        const width = 1 /* Constants.BASE_CHAR_WIDTH */ * scale;\n        const height = 2 /* Constants.BASE_CHAR_HEIGHT */ * scale;\n        let targetIndex = destOffset;\n        let brightest = 0;\n        // This is essentially an ad-hoc rescaling algorithm. Standard approaches\n        // like bicubic interpolation are awesome for scaling between image sizes,\n        // but don't work so well when scaling to very small pixel values, we end\n        // up with blurry, indistinct forms.\n        //\n        // The approach taken here is simply mapping each source pixel to the target\n        // pixels, and taking the weighted values for all pixels in each, and then\n        // averaging them out. Finally we apply an intensity boost in _downsample,\n        // since when scaling to the smallest pixel sizes there's more black space\n        // which causes characters to be much less distinct.\n        for (let y = 0; y < height; y++) {\n            // 1. For this destination pixel, get the source pixels we're sampling\n            // from (x1, y1) to the next pixel (x2, y2)\n            const sourceY1 = (y / height) * 16 /* Constants.SAMPLED_CHAR_HEIGHT */;\n            const sourceY2 = ((y + 1) / height) * 16 /* Constants.SAMPLED_CHAR_HEIGHT */;\n            for (let x = 0; x < width; x++) {\n                const sourceX1 = (x / width) * 10 /* Constants.SAMPLED_CHAR_WIDTH */;\n                const sourceX2 = ((x + 1) / width) * 10 /* Constants.SAMPLED_CHAR_WIDTH */;\n                // 2. Sample all of them, summing them up and weighting them. Similar\n                // to bilinear interpolation.\n                let value = 0;\n                let samples = 0;\n                for (let sy = sourceY1; sy < sourceY2; sy++) {\n                    const sourceRow = sourceOffset + Math.floor(sy) * 3840 /* Constants.RGBA_SAMPLED_ROW_WIDTH */;\n                    const yBalance = 1 - (sy - Math.floor(sy));\n                    for (let sx = sourceX1; sx < sourceX2; sx++) {\n                        const xBalance = 1 - (sx - Math.floor(sx));\n                        const sourceIndex = sourceRow + Math.floor(sx) * 4 /* Constants.RGBA_CHANNELS_CNT */;\n                        const weight = xBalance * yBalance;\n                        samples += weight;\n                        value += ((source[sourceIndex] * source[sourceIndex + 3]) / 255) * weight;\n                    }\n                }\n                const final = value / samples;\n                brightest = Math.max(brightest, final);\n                dest[targetIndex++] = toUint8(final);\n            }\n        }\n        return brightest;\n    }\n    static _downsample(data, scale) {\n        const pixelsPerCharacter = 2 /* Constants.BASE_CHAR_HEIGHT */ * scale * 1 /* Constants.BASE_CHAR_WIDTH */ * scale;\n        const resultLen = pixelsPerCharacter * 96 /* Constants.CHAR_COUNT */;\n        const result = new Uint8ClampedArray(resultLen);\n        let resultOffset = 0;\n        let sourceOffset = 0;\n        let brightest = 0;\n        for (let charIndex = 0; charIndex < 96 /* Constants.CHAR_COUNT */; charIndex++) {\n            brightest = Math.max(brightest, this._downsampleChar(data, sourceOffset, result, resultOffset, scale));\n            resultOffset += pixelsPerCharacter;\n            sourceOffset += 10 /* Constants.SAMPLED_CHAR_WIDTH */ * 4 /* Constants.RGBA_CHANNELS_CNT */;\n        }\n        if (brightest > 0) {\n            const adjust = 255 / brightest;\n            for (let i = 0; i < resultLen; i++) {\n                result[i] *= adjust;\n            }\n        }\n        return result;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './minimap.css';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { GlobalPointerMoveMonitor } from '../../../../base/browser/globalPointerMoveMonitor.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { RenderedLinesCollection } from '../../view/viewLayer.js';\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\nimport { MINIMAP_GUTTER_WIDTH, EditorLayoutInfoComputer } from '../../../common/config/editorOptions.js';\nimport { Range } from '../../../common/core/range.js';\nimport { RGBA8 } from '../../../common/core/rgba.js';\nimport { MinimapTokensColorTracker } from '../../../common/viewModel/minimapTokensColorTracker.js';\nimport { ViewModelDecoration } from '../../../common/viewModel.js';\nimport { minimapSelection, minimapBackground, minimapForegroundOpacity } from '../../../../platform/theme/common/colorRegistry.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { EventType, Gesture } from '../../../../base/browser/touch.js';\nimport { MinimapCharRendererFactory } from './minimapCharRendererFactory.js';\nimport { MinimapPosition } from '../../../common/model.js';\nimport { once } from '../../../../base/common/functional.js';\n/**\n * The orthogonal distance to the slider at which dragging \"resets\". This implements \"snapping\"\n */\nconst POINTER_DRAG_RESET_DISTANCE = 140;\nconst GUTTER_DECORATION_WIDTH = 2;\nclass MinimapOptions {\n    constructor(configuration, theme, tokensColorTracker) {\n        const options = configuration.options;\n        const pixelRatio = options.get(140 /* EditorOption.pixelRatio */);\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        const minimapLayout = layoutInfo.minimap;\n        const fontInfo = options.get(49 /* EditorOption.fontInfo */);\n        const minimapOpts = options.get(71 /* EditorOption.minimap */);\n        this.renderMinimap = minimapLayout.renderMinimap;\n        this.size = minimapOpts.size;\n        this.minimapHeightIsEditorHeight = minimapLayout.minimapHeightIsEditorHeight;\n        this.scrollBeyondLastLine = options.get(103 /* EditorOption.scrollBeyondLastLine */);\n        this.paddingTop = options.get(82 /* EditorOption.padding */).top;\n        this.paddingBottom = options.get(82 /* EditorOption.padding */).bottom;\n        this.showSlider = minimapOpts.showSlider;\n        this.autohide = minimapOpts.autohide;\n        this.pixelRatio = pixelRatio;\n        this.typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n        this.lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this.minimapLeft = minimapLayout.minimapLeft;\n        this.minimapWidth = minimapLayout.minimapWidth;\n        this.minimapHeight = layoutInfo.height;\n        this.canvasInnerWidth = minimapLayout.minimapCanvasInnerWidth;\n        this.canvasInnerHeight = minimapLayout.minimapCanvasInnerHeight;\n        this.canvasOuterWidth = minimapLayout.minimapCanvasOuterWidth;\n        this.canvasOuterHeight = minimapLayout.minimapCanvasOuterHeight;\n        this.isSampling = minimapLayout.minimapIsSampling;\n        this.editorHeight = layoutInfo.height;\n        this.fontScale = minimapLayout.minimapScale;\n        this.minimapLineHeight = minimapLayout.minimapLineHeight;\n        this.minimapCharWidth = 1 /* Constants.BASE_CHAR_WIDTH */ * this.fontScale;\n        this.charRenderer = once(() => MinimapCharRendererFactory.create(this.fontScale, fontInfo.fontFamily));\n        this.defaultBackgroundColor = tokensColorTracker.getColor(2 /* ColorId.DefaultBackground */);\n        this.backgroundColor = MinimapOptions._getMinimapBackground(theme, this.defaultBackgroundColor);\n        this.foregroundAlpha = MinimapOptions._getMinimapForegroundOpacity(theme);\n    }\n    static _getMinimapBackground(theme, defaultBackgroundColor) {\n        const themeColor = theme.getColor(minimapBackground);\n        if (themeColor) {\n            return new RGBA8(themeColor.rgba.r, themeColor.rgba.g, themeColor.rgba.b, Math.round(255 * themeColor.rgba.a));\n        }\n        return defaultBackgroundColor;\n    }\n    static _getMinimapForegroundOpacity(theme) {\n        const themeColor = theme.getColor(minimapForegroundOpacity);\n        if (themeColor) {\n            return RGBA8._clamp(Math.round(255 * themeColor.rgba.a));\n        }\n        return 255;\n    }\n    equals(other) {\n        return (this.renderMinimap === other.renderMinimap\n            && this.size === other.size\n            && this.minimapHeightIsEditorHeight === other.minimapHeightIsEditorHeight\n            && this.scrollBeyondLastLine === other.scrollBeyondLastLine\n            && this.paddingTop === other.paddingTop\n            && this.paddingBottom === other.paddingBottom\n            && this.showSlider === other.showSlider\n            && this.autohide === other.autohide\n            && this.pixelRatio === other.pixelRatio\n            && this.typicalHalfwidthCharacterWidth === other.typicalHalfwidthCharacterWidth\n            && this.lineHeight === other.lineHeight\n            && this.minimapLeft === other.minimapLeft\n            && this.minimapWidth === other.minimapWidth\n            && this.minimapHeight === other.minimapHeight\n            && this.canvasInnerWidth === other.canvasInnerWidth\n            && this.canvasInnerHeight === other.canvasInnerHeight\n            && this.canvasOuterWidth === other.canvasOuterWidth\n            && this.canvasOuterHeight === other.canvasOuterHeight\n            && this.isSampling === other.isSampling\n            && this.editorHeight === other.editorHeight\n            && this.fontScale === other.fontScale\n            && this.minimapLineHeight === other.minimapLineHeight\n            && this.minimapCharWidth === other.minimapCharWidth\n            && this.defaultBackgroundColor && this.defaultBackgroundColor.equals(other.defaultBackgroundColor)\n            && this.backgroundColor && this.backgroundColor.equals(other.backgroundColor)\n            && this.foregroundAlpha === other.foregroundAlpha);\n    }\n}\nclass MinimapLayout {\n    constructor(\n    /**\n     * The given editor scrollTop (input).\n     */\n    scrollTop, \n    /**\n     * The given editor scrollHeight (input).\n     */\n    scrollHeight, sliderNeeded, _computedSliderRatio, \n    /**\n     * slider dom node top (in CSS px)\n     */\n    sliderTop, \n    /**\n     * slider dom node height (in CSS px)\n     */\n    sliderHeight, \n    /**\n     * empty lines to reserve at the top of the minimap.\n     */\n    topPaddingLineCount, \n    /**\n     * minimap render start line number.\n     */\n    startLineNumber, \n    /**\n     * minimap render end line number.\n     */\n    endLineNumber) {\n        this.scrollTop = scrollTop;\n        this.scrollHeight = scrollHeight;\n        this.sliderNeeded = sliderNeeded;\n        this._computedSliderRatio = _computedSliderRatio;\n        this.sliderTop = sliderTop;\n        this.sliderHeight = sliderHeight;\n        this.topPaddingLineCount = topPaddingLineCount;\n        this.startLineNumber = startLineNumber;\n        this.endLineNumber = endLineNumber;\n    }\n    /**\n     * Compute a desired `scrollPosition` such that the slider moves by `delta`.\n     */\n    getDesiredScrollTopFromDelta(delta) {\n        return Math.round(this.scrollTop + delta / this._computedSliderRatio);\n    }\n    getDesiredScrollTopFromTouchLocation(pageY) {\n        return Math.round((pageY - this.sliderHeight / 2) / this._computedSliderRatio);\n    }\n    /**\n     * Intersect a line range with `this.startLineNumber` and `this.endLineNumber`.\n     */\n    intersectWithViewport(range) {\n        const startLineNumber = Math.max(this.startLineNumber, range.startLineNumber);\n        const endLineNumber = Math.min(this.endLineNumber, range.endLineNumber);\n        if (startLineNumber > endLineNumber) {\n            // entirely outside minimap's viewport\n            return null;\n        }\n        return [startLineNumber, endLineNumber];\n    }\n    /**\n     * Get the inner minimap y coordinate for a line number.\n     */\n    getYForLineNumber(lineNumber, minimapLineHeight) {\n        return +(lineNumber - this.startLineNumber + this.topPaddingLineCount) * minimapLineHeight;\n    }\n    static create(options, viewportStartLineNumber, viewportEndLineNumber, viewportStartLineNumberVerticalOffset, viewportHeight, viewportContainsWhitespaceGaps, lineCount, realLineCount, scrollTop, scrollHeight, previousLayout) {\n        const pixelRatio = options.pixelRatio;\n        const minimapLineHeight = options.minimapLineHeight;\n        const minimapLinesFitting = Math.floor(options.canvasInnerHeight / minimapLineHeight);\n        const lineHeight = options.lineHeight;\n        if (options.minimapHeightIsEditorHeight) {\n            let logicalScrollHeight = (realLineCount * options.lineHeight\n                + options.paddingTop\n                + options.paddingBottom);\n            if (options.scrollBeyondLastLine) {\n                logicalScrollHeight += Math.max(0, viewportHeight - options.lineHeight - options.paddingBottom);\n            }\n            const sliderHeight = Math.max(1, Math.floor(viewportHeight * viewportHeight / logicalScrollHeight));\n            const maxMinimapSliderTop = Math.max(0, options.minimapHeight - sliderHeight);\n            // The slider can move from 0 to `maxMinimapSliderTop`\n            // in the same way `scrollTop` can move from 0 to `scrollHeight` - `viewportHeight`.\n            const computedSliderRatio = (maxMinimapSliderTop) / (scrollHeight - viewportHeight);\n            const sliderTop = (scrollTop * computedSliderRatio);\n            const sliderNeeded = (maxMinimapSliderTop > 0);\n            const maxLinesFitting = Math.floor(options.canvasInnerHeight / options.minimapLineHeight);\n            const topPaddingLineCount = Math.floor(options.paddingTop / options.lineHeight);\n            return new MinimapLayout(scrollTop, scrollHeight, sliderNeeded, computedSliderRatio, sliderTop, sliderHeight, topPaddingLineCount, 1, Math.min(lineCount, maxLinesFitting));\n        }\n        // The visible line count in a viewport can change due to a number of reasons:\n        //  a) with the same viewport width, different scroll positions can result in partial lines being visible:\n        //    e.g. for a line height of 20, and a viewport height of 600\n        //          * scrollTop = 0  => visible lines are [1, 30]\n        //          * scrollTop = 10 => visible lines are [1, 31] (with lines 1 and 31 partially visible)\n        //          * scrollTop = 20 => visible lines are [2, 31]\n        //  b) whitespace gaps might make their way in the viewport (which results in a decrease in the visible line count)\n        //  c) we could be in the scroll beyond last line case (which also results in a decrease in the visible line count, down to possibly only one line being visible)\n        // We must first establish a desirable slider height.\n        let sliderHeight;\n        if (viewportContainsWhitespaceGaps && viewportEndLineNumber !== lineCount) {\n            // case b) from above: there are whitespace gaps in the viewport.\n            // In this case, the height of the slider directly reflects the visible line count.\n            const viewportLineCount = viewportEndLineNumber - viewportStartLineNumber + 1;\n            sliderHeight = Math.floor(viewportLineCount * minimapLineHeight / pixelRatio);\n        }\n        else {\n            // The slider has a stable height\n            const expectedViewportLineCount = viewportHeight / lineHeight;\n            sliderHeight = Math.floor(expectedViewportLineCount * minimapLineHeight / pixelRatio);\n        }\n        const extraLinesAtTheTop = Math.floor(options.paddingTop / lineHeight);\n        let extraLinesAtTheBottom = Math.floor(options.paddingBottom / lineHeight);\n        if (options.scrollBeyondLastLine) {\n            const expectedViewportLineCount = viewportHeight / lineHeight;\n            extraLinesAtTheBottom = Math.max(extraLinesAtTheBottom, expectedViewportLineCount - 1);\n        }\n        let maxMinimapSliderTop;\n        if (extraLinesAtTheBottom > 0) {\n            const expectedViewportLineCount = viewportHeight / lineHeight;\n            // The minimap slider, when dragged all the way down, will contain the last line at its top\n            maxMinimapSliderTop = (extraLinesAtTheTop + lineCount + extraLinesAtTheBottom - expectedViewportLineCount - 1) * minimapLineHeight / pixelRatio;\n        }\n        else {\n            // The minimap slider, when dragged all the way down, will contain the last line at its bottom\n            maxMinimapSliderTop = Math.max(0, (extraLinesAtTheTop + lineCount) * minimapLineHeight / pixelRatio - sliderHeight);\n        }\n        maxMinimapSliderTop = Math.min(options.minimapHeight - sliderHeight, maxMinimapSliderTop);\n        // The slider can move from 0 to `maxMinimapSliderTop`\n        // in the same way `scrollTop` can move from 0 to `scrollHeight` - `viewportHeight`.\n        const computedSliderRatio = (maxMinimapSliderTop) / (scrollHeight - viewportHeight);\n        const sliderTop = (scrollTop * computedSliderRatio);\n        if (minimapLinesFitting >= extraLinesAtTheTop + lineCount + extraLinesAtTheBottom) {\n            // All lines fit in the minimap\n            const sliderNeeded = (maxMinimapSliderTop > 0);\n            return new MinimapLayout(scrollTop, scrollHeight, sliderNeeded, computedSliderRatio, sliderTop, sliderHeight, extraLinesAtTheTop, 1, lineCount);\n        }\n        else {\n            let consideringStartLineNumber;\n            if (viewportStartLineNumber > 1) {\n                consideringStartLineNumber = viewportStartLineNumber + extraLinesAtTheTop;\n            }\n            else {\n                consideringStartLineNumber = Math.max(1, scrollTop / lineHeight);\n            }\n            let topPaddingLineCount;\n            let startLineNumber = Math.max(1, Math.floor(consideringStartLineNumber - sliderTop * pixelRatio / minimapLineHeight));\n            if (startLineNumber < extraLinesAtTheTop) {\n                topPaddingLineCount = extraLinesAtTheTop - startLineNumber + 1;\n                startLineNumber = 1;\n            }\n            else {\n                topPaddingLineCount = 0;\n                startLineNumber = Math.max(1, startLineNumber - extraLinesAtTheTop);\n            }\n            // Avoid flickering caused by a partial viewport start line\n            // by being consistent w.r.t. the previous layout decision\n            if (previousLayout && previousLayout.scrollHeight === scrollHeight) {\n                if (previousLayout.scrollTop > scrollTop) {\n                    // Scrolling up => never increase `startLineNumber`\n                    startLineNumber = Math.min(startLineNumber, previousLayout.startLineNumber);\n                    topPaddingLineCount = Math.max(topPaddingLineCount, previousLayout.topPaddingLineCount);\n                }\n                if (previousLayout.scrollTop < scrollTop) {\n                    // Scrolling down => never decrease `startLineNumber`\n                    startLineNumber = Math.max(startLineNumber, previousLayout.startLineNumber);\n                    topPaddingLineCount = Math.min(topPaddingLineCount, previousLayout.topPaddingLineCount);\n                }\n            }\n            const endLineNumber = Math.min(lineCount, startLineNumber - topPaddingLineCount + minimapLinesFitting - 1);\n            const partialLine = (scrollTop - viewportStartLineNumberVerticalOffset) / lineHeight;\n            let sliderTopAligned;\n            if (scrollTop >= options.paddingTop) {\n                sliderTopAligned = (viewportStartLineNumber - startLineNumber + topPaddingLineCount + partialLine) * minimapLineHeight / pixelRatio;\n            }\n            else {\n                sliderTopAligned = (scrollTop / options.paddingTop) * (topPaddingLineCount + partialLine) * minimapLineHeight / pixelRatio;\n            }\n            return new MinimapLayout(scrollTop, scrollHeight, true, computedSliderRatio, sliderTopAligned, sliderHeight, topPaddingLineCount, startLineNumber, endLineNumber);\n        }\n    }\n}\nclass MinimapLine {\n    constructor(dy) {\n        this.dy = dy;\n    }\n    onContentChanged() {\n        this.dy = -1;\n    }\n    onTokensChanged() {\n        this.dy = -1;\n    }\n}\nMinimapLine.INVALID = new MinimapLine(-1);\nclass RenderData {\n    constructor(renderedLayout, imageData, lines) {\n        this.renderedLayout = renderedLayout;\n        this._imageData = imageData;\n        this._renderedLines = new RenderedLinesCollection(() => MinimapLine.INVALID);\n        this._renderedLines._set(renderedLayout.startLineNumber, lines);\n    }\n    /**\n     * Check if the current RenderData matches accurately the new desired layout and no painting is needed.\n     */\n    linesEquals(layout) {\n        if (!this.scrollEquals(layout)) {\n            return false;\n        }\n        const tmp = this._renderedLines._get();\n        const lines = tmp.lines;\n        for (let i = 0, len = lines.length; i < len; i++) {\n            if (lines[i].dy === -1) {\n                // This line is invalid\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Check if the current RenderData matches the new layout's scroll position\n     */\n    scrollEquals(layout) {\n        return this.renderedLayout.startLineNumber === layout.startLineNumber\n            && this.renderedLayout.endLineNumber === layout.endLineNumber;\n    }\n    _get() {\n        const tmp = this._renderedLines._get();\n        return {\n            imageData: this._imageData,\n            rendLineNumberStart: tmp.rendLineNumberStart,\n            lines: tmp.lines\n        };\n    }\n    onLinesChanged(changeFromLineNumber, changeCount) {\n        return this._renderedLines.onLinesChanged(changeFromLineNumber, changeCount);\n    }\n    onLinesDeleted(deleteFromLineNumber, deleteToLineNumber) {\n        this._renderedLines.onLinesDeleted(deleteFromLineNumber, deleteToLineNumber);\n    }\n    onLinesInserted(insertFromLineNumber, insertToLineNumber) {\n        this._renderedLines.onLinesInserted(insertFromLineNumber, insertToLineNumber);\n    }\n    onTokensChanged(ranges) {\n        return this._renderedLines.onTokensChanged(ranges);\n    }\n}\n/**\n * Some sort of double buffering.\n *\n * Keeps two buffers around that will be rotated for painting.\n * Always gives a buffer that is filled with the background color.\n */\nclass MinimapBuffers {\n    constructor(ctx, WIDTH, HEIGHT, background) {\n        this._backgroundFillData = MinimapBuffers._createBackgroundFillData(WIDTH, HEIGHT, background);\n        this._buffers = [\n            ctx.createImageData(WIDTH, HEIGHT),\n            ctx.createImageData(WIDTH, HEIGHT)\n        ];\n        this._lastUsedBuffer = 0;\n    }\n    getBuffer() {\n        // rotate buffers\n        this._lastUsedBuffer = 1 - this._lastUsedBuffer;\n        const result = this._buffers[this._lastUsedBuffer];\n        // fill with background color\n        result.data.set(this._backgroundFillData);\n        return result;\n    }\n    static _createBackgroundFillData(WIDTH, HEIGHT, background) {\n        const backgroundR = background.r;\n        const backgroundG = background.g;\n        const backgroundB = background.b;\n        const backgroundA = background.a;\n        const result = new Uint8ClampedArray(WIDTH * HEIGHT * 4);\n        let offset = 0;\n        for (let i = 0; i < HEIGHT; i++) {\n            for (let j = 0; j < WIDTH; j++) {\n                result[offset] = backgroundR;\n                result[offset + 1] = backgroundG;\n                result[offset + 2] = backgroundB;\n                result[offset + 3] = backgroundA;\n                offset += 4;\n            }\n        }\n        return result;\n    }\n}\nclass MinimapSamplingState {\n    static compute(options, viewLineCount, oldSamplingState) {\n        if (options.renderMinimap === 0 /* RenderMinimap.None */ || !options.isSampling) {\n            return [null, []];\n        }\n        // ratio is intentionally not part of the layout to avoid the layout changing all the time\n        // so we need to recompute it again...\n        const { minimapLineCount } = EditorLayoutInfoComputer.computeContainedMinimapLineCount({\n            viewLineCount: viewLineCount,\n            scrollBeyondLastLine: options.scrollBeyondLastLine,\n            paddingTop: options.paddingTop,\n            paddingBottom: options.paddingBottom,\n            height: options.editorHeight,\n            lineHeight: options.lineHeight,\n            pixelRatio: options.pixelRatio\n        });\n        const ratio = viewLineCount / minimapLineCount;\n        const halfRatio = ratio / 2;\n        if (!oldSamplingState || oldSamplingState.minimapLines.length === 0) {\n            const result = [];\n            result[0] = 1;\n            if (minimapLineCount > 1) {\n                for (let i = 0, lastIndex = minimapLineCount - 1; i < lastIndex; i++) {\n                    result[i] = Math.round(i * ratio + halfRatio);\n                }\n                result[minimapLineCount - 1] = viewLineCount;\n            }\n            return [new MinimapSamplingState(ratio, result), []];\n        }\n        const oldMinimapLines = oldSamplingState.minimapLines;\n        const oldLength = oldMinimapLines.length;\n        const result = [];\n        let oldIndex = 0;\n        let oldDeltaLineCount = 0;\n        let minViewLineNumber = 1;\n        const MAX_EVENT_COUNT = 10; // generate at most 10 events, if there are more than 10 changes, just flush all previous data\n        let events = [];\n        let lastEvent = null;\n        for (let i = 0; i < minimapLineCount; i++) {\n            const fromViewLineNumber = Math.max(minViewLineNumber, Math.round(i * ratio));\n            const toViewLineNumber = Math.max(fromViewLineNumber, Math.round((i + 1) * ratio));\n            while (oldIndex < oldLength && oldMinimapLines[oldIndex] < fromViewLineNumber) {\n                if (events.length < MAX_EVENT_COUNT) {\n                    const oldMinimapLineNumber = oldIndex + 1 + oldDeltaLineCount;\n                    if (lastEvent && lastEvent.type === 'deleted' && lastEvent._oldIndex === oldIndex - 1) {\n                        lastEvent.deleteToLineNumber++;\n                    }\n                    else {\n                        lastEvent = { type: 'deleted', _oldIndex: oldIndex, deleteFromLineNumber: oldMinimapLineNumber, deleteToLineNumber: oldMinimapLineNumber };\n                        events.push(lastEvent);\n                    }\n                    oldDeltaLineCount--;\n                }\n                oldIndex++;\n            }\n            let selectedViewLineNumber;\n            if (oldIndex < oldLength && oldMinimapLines[oldIndex] <= toViewLineNumber) {\n                // reuse the old sampled line\n                selectedViewLineNumber = oldMinimapLines[oldIndex];\n                oldIndex++;\n            }\n            else {\n                if (i === 0) {\n                    selectedViewLineNumber = 1;\n                }\n                else if (i + 1 === minimapLineCount) {\n                    selectedViewLineNumber = viewLineCount;\n                }\n                else {\n                    selectedViewLineNumber = Math.round(i * ratio + halfRatio);\n                }\n                if (events.length < MAX_EVENT_COUNT) {\n                    const oldMinimapLineNumber = oldIndex + 1 + oldDeltaLineCount;\n                    if (lastEvent && lastEvent.type === 'inserted' && lastEvent._i === i - 1) {\n                        lastEvent.insertToLineNumber++;\n                    }\n                    else {\n                        lastEvent = { type: 'inserted', _i: i, insertFromLineNumber: oldMinimapLineNumber, insertToLineNumber: oldMinimapLineNumber };\n                        events.push(lastEvent);\n                    }\n                    oldDeltaLineCount++;\n                }\n            }\n            result[i] = selectedViewLineNumber;\n            minViewLineNumber = selectedViewLineNumber;\n        }\n        if (events.length < MAX_EVENT_COUNT) {\n            while (oldIndex < oldLength) {\n                const oldMinimapLineNumber = oldIndex + 1 + oldDeltaLineCount;\n                if (lastEvent && lastEvent.type === 'deleted' && lastEvent._oldIndex === oldIndex - 1) {\n                    lastEvent.deleteToLineNumber++;\n                }\n                else {\n                    lastEvent = { type: 'deleted', _oldIndex: oldIndex, deleteFromLineNumber: oldMinimapLineNumber, deleteToLineNumber: oldMinimapLineNumber };\n                    events.push(lastEvent);\n                }\n                oldDeltaLineCount--;\n                oldIndex++;\n            }\n        }\n        else {\n            // too many events, just give up\n            events = [{ type: 'flush' }];\n        }\n        return [new MinimapSamplingState(ratio, result), events];\n    }\n    constructor(samplingRatio, minimapLines) {\n        this.samplingRatio = samplingRatio;\n        this.minimapLines = minimapLines;\n    }\n    modelLineToMinimapLine(lineNumber) {\n        return Math.min(this.minimapLines.length, Math.max(1, Math.round(lineNumber / this.samplingRatio)));\n    }\n    /**\n     * Will return null if the model line ranges are not intersecting with a sampled model line.\n     */\n    modelLineRangeToMinimapLineRange(fromLineNumber, toLineNumber) {\n        let fromLineIndex = this.modelLineToMinimapLine(fromLineNumber) - 1;\n        while (fromLineIndex > 0 && this.minimapLines[fromLineIndex - 1] >= fromLineNumber) {\n            fromLineIndex--;\n        }\n        let toLineIndex = this.modelLineToMinimapLine(toLineNumber) - 1;\n        while (toLineIndex + 1 < this.minimapLines.length && this.minimapLines[toLineIndex + 1] <= toLineNumber) {\n            toLineIndex++;\n        }\n        if (fromLineIndex === toLineIndex) {\n            const sampledLineNumber = this.minimapLines[fromLineIndex];\n            if (sampledLineNumber < fromLineNumber || sampledLineNumber > toLineNumber) {\n                // This line is not part of the sampled lines ==> nothing to do\n                return null;\n            }\n        }\n        return [fromLineIndex + 1, toLineIndex + 1];\n    }\n    /**\n     * Will always return a range, even if it is not intersecting with a sampled model line.\n     */\n    decorationLineRangeToMinimapLineRange(startLineNumber, endLineNumber) {\n        let minimapLineStart = this.modelLineToMinimapLine(startLineNumber);\n        let minimapLineEnd = this.modelLineToMinimapLine(endLineNumber);\n        if (startLineNumber !== endLineNumber && minimapLineEnd === minimapLineStart) {\n            if (minimapLineEnd === this.minimapLines.length) {\n                if (minimapLineStart > 1) {\n                    minimapLineStart--;\n                }\n            }\n            else {\n                minimapLineEnd++;\n            }\n        }\n        return [minimapLineStart, minimapLineEnd];\n    }\n    onLinesDeleted(e) {\n        // have the mapping be sticky\n        const deletedLineCount = e.toLineNumber - e.fromLineNumber + 1;\n        let changeStartIndex = this.minimapLines.length;\n        let changeEndIndex = 0;\n        for (let i = this.minimapLines.length - 1; i >= 0; i--) {\n            if (this.minimapLines[i] < e.fromLineNumber) {\n                break;\n            }\n            if (this.minimapLines[i] <= e.toLineNumber) {\n                // this line got deleted => move to previous available\n                this.minimapLines[i] = Math.max(1, e.fromLineNumber - 1);\n                changeStartIndex = Math.min(changeStartIndex, i);\n                changeEndIndex = Math.max(changeEndIndex, i);\n            }\n            else {\n                this.minimapLines[i] -= deletedLineCount;\n            }\n        }\n        return [changeStartIndex, changeEndIndex];\n    }\n    onLinesInserted(e) {\n        // have the mapping be sticky\n        const insertedLineCount = e.toLineNumber - e.fromLineNumber + 1;\n        for (let i = this.minimapLines.length - 1; i >= 0; i--) {\n            if (this.minimapLines[i] < e.fromLineNumber) {\n                break;\n            }\n            this.minimapLines[i] += insertedLineCount;\n        }\n    }\n}\nexport class Minimap extends ViewPart {\n    constructor(context) {\n        super(context);\n        this.tokensColorTracker = MinimapTokensColorTracker.getInstance();\n        this._selections = [];\n        this._minimapSelections = null;\n        this.options = new MinimapOptions(this._context.configuration, this._context.theme, this.tokensColorTracker);\n        const [samplingState,] = MinimapSamplingState.compute(this.options, this._context.viewModel.getLineCount(), null);\n        this._samplingState = samplingState;\n        this._shouldCheckSampling = false;\n        this._actual = new InnerMinimap(context.theme, this);\n    }\n    dispose() {\n        this._actual.dispose();\n        super.dispose();\n    }\n    getDomNode() {\n        return this._actual.getDomNode();\n    }\n    _onOptionsMaybeChanged() {\n        const opts = new MinimapOptions(this._context.configuration, this._context.theme, this.tokensColorTracker);\n        if (this.options.equals(opts)) {\n            return false;\n        }\n        this.options = opts;\n        this._recreateLineSampling();\n        this._actual.onDidChangeOptions();\n        return true;\n    }\n    // ---- begin view event handlers\n    onConfigurationChanged(e) {\n        return this._onOptionsMaybeChanged();\n    }\n    onCursorStateChanged(e) {\n        this._selections = e.selections;\n        this._minimapSelections = null;\n        return this._actual.onSelectionChanged();\n    }\n    onDecorationsChanged(e) {\n        if (e.affectsMinimap) {\n            return this._actual.onDecorationsChanged();\n        }\n        return false;\n    }\n    onFlushed(e) {\n        if (this._samplingState) {\n            this._shouldCheckSampling = true;\n        }\n        return this._actual.onFlushed();\n    }\n    onLinesChanged(e) {\n        if (this._samplingState) {\n            const minimapLineRange = this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber, e.fromLineNumber + e.count - 1);\n            if (minimapLineRange) {\n                return this._actual.onLinesChanged(minimapLineRange[0], minimapLineRange[1] - minimapLineRange[0] + 1);\n            }\n            else {\n                return false;\n            }\n        }\n        else {\n            return this._actual.onLinesChanged(e.fromLineNumber, e.count);\n        }\n    }\n    onLinesDeleted(e) {\n        if (this._samplingState) {\n            const [changeStartIndex, changeEndIndex] = this._samplingState.onLinesDeleted(e);\n            if (changeStartIndex <= changeEndIndex) {\n                this._actual.onLinesChanged(changeStartIndex + 1, changeEndIndex - changeStartIndex + 1);\n            }\n            this._shouldCheckSampling = true;\n            return true;\n        }\n        else {\n            return this._actual.onLinesDeleted(e.fromLineNumber, e.toLineNumber);\n        }\n    }\n    onLinesInserted(e) {\n        if (this._samplingState) {\n            this._samplingState.onLinesInserted(e);\n            this._shouldCheckSampling = true;\n            return true;\n        }\n        else {\n            return this._actual.onLinesInserted(e.fromLineNumber, e.toLineNumber);\n        }\n    }\n    onScrollChanged(e) {\n        return this._actual.onScrollChanged();\n    }\n    onThemeChanged(e) {\n        this._actual.onThemeChanged();\n        this._onOptionsMaybeChanged();\n        return true;\n    }\n    onTokensChanged(e) {\n        if (this._samplingState) {\n            const ranges = [];\n            for (const range of e.ranges) {\n                const minimapLineRange = this._samplingState.modelLineRangeToMinimapLineRange(range.fromLineNumber, range.toLineNumber);\n                if (minimapLineRange) {\n                    ranges.push({ fromLineNumber: minimapLineRange[0], toLineNumber: minimapLineRange[1] });\n                }\n            }\n            if (ranges.length) {\n                return this._actual.onTokensChanged(ranges);\n            }\n            else {\n                return false;\n            }\n        }\n        else {\n            return this._actual.onTokensChanged(e.ranges);\n        }\n    }\n    onTokensColorsChanged(e) {\n        this._onOptionsMaybeChanged();\n        return this._actual.onTokensColorsChanged();\n    }\n    onZonesChanged(e) {\n        return this._actual.onZonesChanged();\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        if (this._shouldCheckSampling) {\n            this._shouldCheckSampling = false;\n            this._recreateLineSampling();\n        }\n    }\n    render(ctx) {\n        let viewportStartLineNumber = ctx.visibleRange.startLineNumber;\n        let viewportEndLineNumber = ctx.visibleRange.endLineNumber;\n        if (this._samplingState) {\n            viewportStartLineNumber = this._samplingState.modelLineToMinimapLine(viewportStartLineNumber);\n            viewportEndLineNumber = this._samplingState.modelLineToMinimapLine(viewportEndLineNumber);\n        }\n        const minimapCtx = {\n            viewportContainsWhitespaceGaps: (ctx.viewportData.whitespaceViewportData.length > 0),\n            scrollWidth: ctx.scrollWidth,\n            scrollHeight: ctx.scrollHeight,\n            viewportStartLineNumber: viewportStartLineNumber,\n            viewportEndLineNumber: viewportEndLineNumber,\n            viewportStartLineNumberVerticalOffset: ctx.getVerticalOffsetForLineNumber(viewportStartLineNumber),\n            scrollTop: ctx.scrollTop,\n            scrollLeft: ctx.scrollLeft,\n            viewportWidth: ctx.viewportWidth,\n            viewportHeight: ctx.viewportHeight,\n        };\n        this._actual.render(minimapCtx);\n    }\n    //#region IMinimapModel\n    _recreateLineSampling() {\n        this._minimapSelections = null;\n        const wasSampling = Boolean(this._samplingState);\n        const [samplingState, events] = MinimapSamplingState.compute(this.options, this._context.viewModel.getLineCount(), this._samplingState);\n        this._samplingState = samplingState;\n        if (wasSampling && this._samplingState) {\n            // was sampling, is sampling\n            for (const event of events) {\n                switch (event.type) {\n                    case 'deleted':\n                        this._actual.onLinesDeleted(event.deleteFromLineNumber, event.deleteToLineNumber);\n                        break;\n                    case 'inserted':\n                        this._actual.onLinesInserted(event.insertFromLineNumber, event.insertToLineNumber);\n                        break;\n                    case 'flush':\n                        this._actual.onFlushed();\n                        break;\n                }\n            }\n        }\n    }\n    getLineCount() {\n        if (this._samplingState) {\n            return this._samplingState.minimapLines.length;\n        }\n        return this._context.viewModel.getLineCount();\n    }\n    getRealLineCount() {\n        return this._context.viewModel.getLineCount();\n    }\n    getLineContent(lineNumber) {\n        if (this._samplingState) {\n            return this._context.viewModel.getLineContent(this._samplingState.minimapLines[lineNumber - 1]);\n        }\n        return this._context.viewModel.getLineContent(lineNumber);\n    }\n    getLineMaxColumn(lineNumber) {\n        if (this._samplingState) {\n            return this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[lineNumber - 1]);\n        }\n        return this._context.viewModel.getLineMaxColumn(lineNumber);\n    }\n    getMinimapLinesRenderingData(startLineNumber, endLineNumber, needed) {\n        if (this._samplingState) {\n            const result = [];\n            for (let lineIndex = 0, lineCount = endLineNumber - startLineNumber + 1; lineIndex < lineCount; lineIndex++) {\n                if (needed[lineIndex]) {\n                    result[lineIndex] = this._context.viewModel.getViewLineData(this._samplingState.minimapLines[startLineNumber + lineIndex - 1]);\n                }\n                else {\n                    result[lineIndex] = null;\n                }\n            }\n            return result;\n        }\n        return this._context.viewModel.getMinimapLinesRenderingData(startLineNumber, endLineNumber, needed).data;\n    }\n    getSelections() {\n        if (this._minimapSelections === null) {\n            if (this._samplingState) {\n                this._minimapSelections = [];\n                for (const selection of this._selections) {\n                    const [minimapLineStart, minimapLineEnd] = this._samplingState.decorationLineRangeToMinimapLineRange(selection.startLineNumber, selection.endLineNumber);\n                    this._minimapSelections.push(new Selection(minimapLineStart, selection.startColumn, minimapLineEnd, selection.endColumn));\n                }\n            }\n            else {\n                this._minimapSelections = this._selections;\n            }\n        }\n        return this._minimapSelections;\n    }\n    getMinimapDecorationsInViewport(startLineNumber, endLineNumber) {\n        let visibleRange;\n        if (this._samplingState) {\n            const modelStartLineNumber = this._samplingState.minimapLines[startLineNumber - 1];\n            const modelEndLineNumber = this._samplingState.minimapLines[endLineNumber - 1];\n            visibleRange = new Range(modelStartLineNumber, 1, modelEndLineNumber, this._context.viewModel.getLineMaxColumn(modelEndLineNumber));\n        }\n        else {\n            visibleRange = new Range(startLineNumber, 1, endLineNumber, this._context.viewModel.getLineMaxColumn(endLineNumber));\n        }\n        const decorations = this._context.viewModel.getMinimapDecorationsInRange(visibleRange);\n        if (this._samplingState) {\n            const result = [];\n            for (const decoration of decorations) {\n                if (!decoration.options.minimap) {\n                    continue;\n                }\n                const range = decoration.range;\n                const minimapStartLineNumber = this._samplingState.modelLineToMinimapLine(range.startLineNumber);\n                const minimapEndLineNumber = this._samplingState.modelLineToMinimapLine(range.endLineNumber);\n                result.push(new ViewModelDecoration(new Range(minimapStartLineNumber, range.startColumn, minimapEndLineNumber, range.endColumn), decoration.options));\n            }\n            return result;\n        }\n        return decorations;\n    }\n    getOptions() {\n        return this._context.viewModel.model.getOptions();\n    }\n    revealLineNumber(lineNumber) {\n        if (this._samplingState) {\n            lineNumber = this._samplingState.minimapLines[lineNumber - 1];\n        }\n        this._context.viewModel.revealRange('mouse', false, new Range(lineNumber, 1, lineNumber, 1), 1 /* viewEvents.VerticalRevealType.Center */, 0 /* ScrollType.Smooth */);\n    }\n    setScrollTop(scrollTop) {\n        this._context.viewModel.viewLayout.setScrollPosition({\n            scrollTop: scrollTop\n        }, 1 /* ScrollType.Immediate */);\n    }\n}\nclass InnerMinimap extends Disposable {\n    constructor(theme, model) {\n        super();\n        this._renderDecorations = false;\n        this._gestureInProgress = false;\n        this._theme = theme;\n        this._model = model;\n        this._lastRenderData = null;\n        this._buffers = null;\n        this._selectionColor = this._theme.getColor(minimapSelection);\n        this._domNode = createFastDomNode(document.createElement('div'));\n        PartFingerprints.write(this._domNode, 8 /* PartFingerprint.Minimap */);\n        this._domNode.setClassName(this._getMinimapDomNodeClassName());\n        this._domNode.setPosition('absolute');\n        this._domNode.setAttribute('role', 'presentation');\n        this._domNode.setAttribute('aria-hidden', 'true');\n        this._shadow = createFastDomNode(document.createElement('div'));\n        this._shadow.setClassName('minimap-shadow-hidden');\n        this._domNode.appendChild(this._shadow);\n        this._canvas = createFastDomNode(document.createElement('canvas'));\n        this._canvas.setPosition('absolute');\n        this._canvas.setLeft(0);\n        this._domNode.appendChild(this._canvas);\n        this._decorationsCanvas = createFastDomNode(document.createElement('canvas'));\n        this._decorationsCanvas.setPosition('absolute');\n        this._decorationsCanvas.setClassName('minimap-decorations-layer');\n        this._decorationsCanvas.setLeft(0);\n        this._domNode.appendChild(this._decorationsCanvas);\n        this._slider = createFastDomNode(document.createElement('div'));\n        this._slider.setPosition('absolute');\n        this._slider.setClassName('minimap-slider');\n        this._slider.setLayerHinting(true);\n        this._slider.setContain('strict');\n        this._domNode.appendChild(this._slider);\n        this._sliderHorizontal = createFastDomNode(document.createElement('div'));\n        this._sliderHorizontal.setPosition('absolute');\n        this._sliderHorizontal.setClassName('minimap-slider-horizontal');\n        this._slider.appendChild(this._sliderHorizontal);\n        this._applyLayout();\n        this._pointerDownListener = dom.addStandardDisposableListener(this._domNode.domNode, dom.EventType.POINTER_DOWN, (e) => {\n            e.preventDefault();\n            const renderMinimap = this._model.options.renderMinimap;\n            if (renderMinimap === 0 /* RenderMinimap.None */) {\n                return;\n            }\n            if (!this._lastRenderData) {\n                return;\n            }\n            if (this._model.options.size !== 'proportional') {\n                if (e.button === 0 && this._lastRenderData) {\n                    // pretend the click occurred in the center of the slider\n                    const position = dom.getDomNodePagePosition(this._slider.domNode);\n                    const initialPosY = position.top + position.height / 2;\n                    this._startSliderDragging(e, initialPosY, this._lastRenderData.renderedLayout);\n                }\n                return;\n            }\n            const minimapLineHeight = this._model.options.minimapLineHeight;\n            const internalOffsetY = (this._model.options.canvasInnerHeight / this._model.options.canvasOuterHeight) * e.offsetY;\n            const lineIndex = Math.floor(internalOffsetY / minimapLineHeight);\n            let lineNumber = lineIndex + this._lastRenderData.renderedLayout.startLineNumber - this._lastRenderData.renderedLayout.topPaddingLineCount;\n            lineNumber = Math.min(lineNumber, this._model.getLineCount());\n            this._model.revealLineNumber(lineNumber);\n        });\n        this._sliderPointerMoveMonitor = new GlobalPointerMoveMonitor();\n        this._sliderPointerDownListener = dom.addStandardDisposableListener(this._slider.domNode, dom.EventType.POINTER_DOWN, (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            if (e.button === 0 && this._lastRenderData) {\n                this._startSliderDragging(e, e.pageY, this._lastRenderData.renderedLayout);\n            }\n        });\n        this._gestureDisposable = Gesture.addTarget(this._domNode.domNode);\n        this._sliderTouchStartListener = dom.addDisposableListener(this._domNode.domNode, EventType.Start, (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            if (this._lastRenderData) {\n                this._slider.toggleClassName('active', true);\n                this._gestureInProgress = true;\n                this.scrollDueToTouchEvent(e);\n            }\n        }, { passive: false });\n        this._sliderTouchMoveListener = dom.addDisposableListener(this._domNode.domNode, EventType.Change, (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            if (this._lastRenderData && this._gestureInProgress) {\n                this.scrollDueToTouchEvent(e);\n            }\n        }, { passive: false });\n        this._sliderTouchEndListener = dom.addStandardDisposableListener(this._domNode.domNode, EventType.End, (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            this._gestureInProgress = false;\n            this._slider.toggleClassName('active', false);\n        });\n    }\n    _startSliderDragging(e, initialPosY, initialSliderState) {\n        if (!e.target || !(e.target instanceof Element)) {\n            return;\n        }\n        const initialPosX = e.pageX;\n        this._slider.toggleClassName('active', true);\n        const handlePointerMove = (posy, posx) => {\n            const minimapPosition = dom.getDomNodePagePosition(this._domNode.domNode);\n            const pointerOrthogonalDelta = Math.min(Math.abs(posx - initialPosX), Math.abs(posx - minimapPosition.left), Math.abs(posx - minimapPosition.left - minimapPosition.width));\n            if (platform.isWindows && pointerOrthogonalDelta > POINTER_DRAG_RESET_DISTANCE) {\n                // The pointer has wondered away from the scrollbar => reset dragging\n                this._model.setScrollTop(initialSliderState.scrollTop);\n                return;\n            }\n            const pointerDelta = posy - initialPosY;\n            this._model.setScrollTop(initialSliderState.getDesiredScrollTopFromDelta(pointerDelta));\n        };\n        if (e.pageY !== initialPosY) {\n            handlePointerMove(e.pageY, initialPosX);\n        }\n        this._sliderPointerMoveMonitor.startMonitoring(e.target, e.pointerId, e.buttons, pointerMoveData => handlePointerMove(pointerMoveData.pageY, pointerMoveData.pageX), () => {\n            this._slider.toggleClassName('active', false);\n        });\n    }\n    scrollDueToTouchEvent(touch) {\n        const startY = this._domNode.domNode.getBoundingClientRect().top;\n        const scrollTop = this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(touch.pageY - startY);\n        this._model.setScrollTop(scrollTop);\n    }\n    dispose() {\n        this._pointerDownListener.dispose();\n        this._sliderPointerMoveMonitor.dispose();\n        this._sliderPointerDownListener.dispose();\n        this._gestureDisposable.dispose();\n        this._sliderTouchStartListener.dispose();\n        this._sliderTouchMoveListener.dispose();\n        this._sliderTouchEndListener.dispose();\n        super.dispose();\n    }\n    _getMinimapDomNodeClassName() {\n        const class_ = ['minimap'];\n        if (this._model.options.showSlider === 'always') {\n            class_.push('slider-always');\n        }\n        else {\n            class_.push('slider-mouseover');\n        }\n        if (this._model.options.autohide) {\n            class_.push('autohide');\n        }\n        return class_.join(' ');\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    _applyLayout() {\n        this._domNode.setLeft(this._model.options.minimapLeft);\n        this._domNode.setWidth(this._model.options.minimapWidth);\n        this._domNode.setHeight(this._model.options.minimapHeight);\n        this._shadow.setHeight(this._model.options.minimapHeight);\n        this._canvas.setWidth(this._model.options.canvasOuterWidth);\n        this._canvas.setHeight(this._model.options.canvasOuterHeight);\n        this._canvas.domNode.width = this._model.options.canvasInnerWidth;\n        this._canvas.domNode.height = this._model.options.canvasInnerHeight;\n        this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth);\n        this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight);\n        this._decorationsCanvas.domNode.width = this._model.options.canvasInnerWidth;\n        this._decorationsCanvas.domNode.height = this._model.options.canvasInnerHeight;\n        this._slider.setWidth(this._model.options.minimapWidth);\n    }\n    _getBuffer() {\n        if (!this._buffers) {\n            if (this._model.options.canvasInnerWidth > 0 && this._model.options.canvasInnerHeight > 0) {\n                this._buffers = new MinimapBuffers(this._canvas.domNode.getContext('2d'), this._model.options.canvasInnerWidth, this._model.options.canvasInnerHeight, this._model.options.backgroundColor);\n            }\n        }\n        return this._buffers ? this._buffers.getBuffer() : null;\n    }\n    // ---- begin view event handlers\n    onDidChangeOptions() {\n        this._lastRenderData = null;\n        this._buffers = null;\n        this._applyLayout();\n        this._domNode.setClassName(this._getMinimapDomNodeClassName());\n    }\n    onSelectionChanged() {\n        this._renderDecorations = true;\n        return true;\n    }\n    onDecorationsChanged() {\n        this._renderDecorations = true;\n        return true;\n    }\n    onFlushed() {\n        this._lastRenderData = null;\n        return true;\n    }\n    onLinesChanged(changeFromLineNumber, changeCount) {\n        if (this._lastRenderData) {\n            return this._lastRenderData.onLinesChanged(changeFromLineNumber, changeCount);\n        }\n        return false;\n    }\n    onLinesDeleted(deleteFromLineNumber, deleteToLineNumber) {\n        var _a;\n        (_a = this._lastRenderData) === null || _a === void 0 ? void 0 : _a.onLinesDeleted(deleteFromLineNumber, deleteToLineNumber);\n        return true;\n    }\n    onLinesInserted(insertFromLineNumber, insertToLineNumber) {\n        var _a;\n        (_a = this._lastRenderData) === null || _a === void 0 ? void 0 : _a.onLinesInserted(insertFromLineNumber, insertToLineNumber);\n        return true;\n    }\n    onScrollChanged() {\n        this._renderDecorations = true;\n        return true;\n    }\n    onThemeChanged() {\n        this._selectionColor = this._theme.getColor(minimapSelection);\n        this._renderDecorations = true;\n        return true;\n    }\n    onTokensChanged(ranges) {\n        if (this._lastRenderData) {\n            return this._lastRenderData.onTokensChanged(ranges);\n        }\n        return false;\n    }\n    onTokensColorsChanged() {\n        this._lastRenderData = null;\n        this._buffers = null;\n        return true;\n    }\n    onZonesChanged() {\n        this._lastRenderData = null;\n        return true;\n    }\n    // --- end event handlers\n    render(renderingCtx) {\n        const renderMinimap = this._model.options.renderMinimap;\n        if (renderMinimap === 0 /* RenderMinimap.None */) {\n            this._shadow.setClassName('minimap-shadow-hidden');\n            this._sliderHorizontal.setWidth(0);\n            this._sliderHorizontal.setHeight(0);\n            return;\n        }\n        if (renderingCtx.scrollLeft + renderingCtx.viewportWidth >= renderingCtx.scrollWidth) {\n            this._shadow.setClassName('minimap-shadow-hidden');\n        }\n        else {\n            this._shadow.setClassName('minimap-shadow-visible');\n        }\n        const layout = MinimapLayout.create(this._model.options, renderingCtx.viewportStartLineNumber, renderingCtx.viewportEndLineNumber, renderingCtx.viewportStartLineNumberVerticalOffset, renderingCtx.viewportHeight, renderingCtx.viewportContainsWhitespaceGaps, this._model.getLineCount(), this._model.getRealLineCount(), renderingCtx.scrollTop, renderingCtx.scrollHeight, this._lastRenderData ? this._lastRenderData.renderedLayout : null);\n        this._slider.setDisplay(layout.sliderNeeded ? 'block' : 'none');\n        this._slider.setTop(layout.sliderTop);\n        this._slider.setHeight(layout.sliderHeight);\n        // Compute horizontal slider coordinates\n        this._sliderHorizontal.setLeft(0);\n        this._sliderHorizontal.setWidth(this._model.options.minimapWidth);\n        this._sliderHorizontal.setTop(0);\n        this._sliderHorizontal.setHeight(layout.sliderHeight);\n        this.renderDecorations(layout);\n        this._lastRenderData = this.renderLines(layout);\n    }\n    renderDecorations(layout) {\n        if (this._renderDecorations) {\n            this._renderDecorations = false;\n            const selections = this._model.getSelections();\n            selections.sort(Range.compareRangesUsingStarts);\n            const decorations = this._model.getMinimapDecorationsInViewport(layout.startLineNumber, layout.endLineNumber);\n            decorations.sort((a, b) => (a.options.zIndex || 0) - (b.options.zIndex || 0));\n            const { canvasInnerWidth, canvasInnerHeight } = this._model.options;\n            const minimapLineHeight = this._model.options.minimapLineHeight;\n            const minimapCharWidth = this._model.options.minimapCharWidth;\n            const tabSize = this._model.getOptions().tabSize;\n            const canvasContext = this._decorationsCanvas.domNode.getContext('2d');\n            canvasContext.clearRect(0, 0, canvasInnerWidth, canvasInnerHeight);\n            // We first need to render line highlights and then render decorations on top of those.\n            // But we need to pick a single color for each line, and use that as a line highlight.\n            // This needs to be the color of the decoration with the highest `zIndex`, but priority\n            // is given to the selection.\n            const highlightedLines = new ContiguousLineMap(layout.startLineNumber, layout.endLineNumber, false);\n            this._renderSelectionLineHighlights(canvasContext, selections, highlightedLines, layout, minimapLineHeight);\n            this._renderDecorationsLineHighlights(canvasContext, decorations, highlightedLines, layout, minimapLineHeight);\n            const lineOffsetMap = new ContiguousLineMap(layout.startLineNumber, layout.endLineNumber, null);\n            this._renderSelectionsHighlights(canvasContext, selections, lineOffsetMap, layout, minimapLineHeight, tabSize, minimapCharWidth, canvasInnerWidth);\n            this._renderDecorationsHighlights(canvasContext, decorations, lineOffsetMap, layout, minimapLineHeight, tabSize, minimapCharWidth, canvasInnerWidth);\n        }\n    }\n    _renderSelectionLineHighlights(canvasContext, selections, highlightedLines, layout, minimapLineHeight) {\n        if (!this._selectionColor || this._selectionColor.isTransparent()) {\n            return;\n        }\n        canvasContext.fillStyle = this._selectionColor.transparent(0.5).toString();\n        let y1 = 0;\n        let y2 = 0;\n        for (const selection of selections) {\n            const intersection = layout.intersectWithViewport(selection);\n            if (!intersection) {\n                // entirely outside minimap's viewport\n                continue;\n            }\n            const [startLineNumber, endLineNumber] = intersection;\n            for (let line = startLineNumber; line <= endLineNumber; line++) {\n                highlightedLines.set(line, true);\n            }\n            const yy1 = layout.getYForLineNumber(startLineNumber, minimapLineHeight);\n            const yy2 = layout.getYForLineNumber(endLineNumber, minimapLineHeight);\n            if (y2 >= yy1) {\n                // merge into previous\n                y2 = yy2;\n            }\n            else {\n                if (y2 > y1) {\n                    // flush\n                    canvasContext.fillRect(MINIMAP_GUTTER_WIDTH, y1, canvasContext.canvas.width, y2 - y1);\n                }\n                y1 = yy1;\n                y2 = yy2;\n            }\n        }\n        if (y2 > y1) {\n            // flush\n            canvasContext.fillRect(MINIMAP_GUTTER_WIDTH, y1, canvasContext.canvas.width, y2 - y1);\n        }\n    }\n    _renderDecorationsLineHighlights(canvasContext, decorations, highlightedLines, layout, minimapLineHeight) {\n        const highlightColors = new Map();\n        // Loop backwards to hit first decorations with higher `zIndex`\n        for (let i = decorations.length - 1; i >= 0; i--) {\n            const decoration = decorations[i];\n            const minimapOptions = decoration.options.minimap;\n            if (!minimapOptions || minimapOptions.position !== MinimapPosition.Inline) {\n                continue;\n            }\n            const intersection = layout.intersectWithViewport(decoration.range);\n            if (!intersection) {\n                // entirely outside minimap's viewport\n                continue;\n            }\n            const [startLineNumber, endLineNumber] = intersection;\n            const decorationColor = minimapOptions.getColor(this._theme.value);\n            if (!decorationColor || decorationColor.isTransparent()) {\n                continue;\n            }\n            let highlightColor = highlightColors.get(decorationColor.toString());\n            if (!highlightColor) {\n                highlightColor = decorationColor.transparent(0.5).toString();\n                highlightColors.set(decorationColor.toString(), highlightColor);\n            }\n            canvasContext.fillStyle = highlightColor;\n            for (let line = startLineNumber; line <= endLineNumber; line++) {\n                if (highlightedLines.has(line)) {\n                    continue;\n                }\n                highlightedLines.set(line, true);\n                const y = layout.getYForLineNumber(startLineNumber, minimapLineHeight);\n                canvasContext.fillRect(MINIMAP_GUTTER_WIDTH, y, canvasContext.canvas.width, minimapLineHeight);\n            }\n        }\n    }\n    _renderSelectionsHighlights(canvasContext, selections, lineOffsetMap, layout, lineHeight, tabSize, characterWidth, canvasInnerWidth) {\n        if (!this._selectionColor || this._selectionColor.isTransparent()) {\n            return;\n        }\n        for (const selection of selections) {\n            const intersection = layout.intersectWithViewport(selection);\n            if (!intersection) {\n                // entirely outside minimap's viewport\n                continue;\n            }\n            const [startLineNumber, endLineNumber] = intersection;\n            for (let line = startLineNumber; line <= endLineNumber; line++) {\n                this.renderDecorationOnLine(canvasContext, lineOffsetMap, selection, this._selectionColor, layout, line, lineHeight, lineHeight, tabSize, characterWidth, canvasInnerWidth);\n            }\n        }\n    }\n    _renderDecorationsHighlights(canvasContext, decorations, lineOffsetMap, layout, minimapLineHeight, tabSize, characterWidth, canvasInnerWidth) {\n        // Loop forwards to hit first decorations with lower `zIndex`\n        for (const decoration of decorations) {\n            const minimapOptions = decoration.options.minimap;\n            if (!minimapOptions) {\n                continue;\n            }\n            const intersection = layout.intersectWithViewport(decoration.range);\n            if (!intersection) {\n                // entirely outside minimap's viewport\n                continue;\n            }\n            const [startLineNumber, endLineNumber] = intersection;\n            const decorationColor = minimapOptions.getColor(this._theme.value);\n            if (!decorationColor || decorationColor.isTransparent()) {\n                continue;\n            }\n            for (let line = startLineNumber; line <= endLineNumber; line++) {\n                switch (minimapOptions.position) {\n                    case MinimapPosition.Inline:\n                        this.renderDecorationOnLine(canvasContext, lineOffsetMap, decoration.range, decorationColor, layout, line, minimapLineHeight, minimapLineHeight, tabSize, characterWidth, canvasInnerWidth);\n                        continue;\n                    case MinimapPosition.Gutter: {\n                        const y = layout.getYForLineNumber(line, minimapLineHeight);\n                        const x = 2;\n                        this.renderDecoration(canvasContext, decorationColor, x, y, GUTTER_DECORATION_WIDTH, minimapLineHeight);\n                        continue;\n                    }\n                }\n            }\n        }\n    }\n    renderDecorationOnLine(canvasContext, lineOffsetMap, decorationRange, decorationColor, layout, lineNumber, height, minimapLineHeight, tabSize, charWidth, canvasInnerWidth) {\n        const y = layout.getYForLineNumber(lineNumber, minimapLineHeight);\n        // Skip rendering the line if it's vertically outside our viewport\n        if (y + height < 0 || y > this._model.options.canvasInnerHeight) {\n            return;\n        }\n        const { startLineNumber, endLineNumber } = decorationRange;\n        const startColumn = (startLineNumber === lineNumber ? decorationRange.startColumn : 1);\n        const endColumn = (endLineNumber === lineNumber ? decorationRange.endColumn : this._model.getLineMaxColumn(lineNumber));\n        const x1 = this.getXOffsetForPosition(lineOffsetMap, lineNumber, startColumn, tabSize, charWidth, canvasInnerWidth);\n        const x2 = this.getXOffsetForPosition(lineOffsetMap, lineNumber, endColumn, tabSize, charWidth, canvasInnerWidth);\n        this.renderDecoration(canvasContext, decorationColor, x1, y, x2 - x1, height);\n    }\n    getXOffsetForPosition(lineOffsetMap, lineNumber, column, tabSize, charWidth, canvasInnerWidth) {\n        if (column === 1) {\n            return MINIMAP_GUTTER_WIDTH;\n        }\n        const minimumXOffset = (column - 1) * charWidth;\n        if (minimumXOffset >= canvasInnerWidth) {\n            // there is no need to look at actual characters,\n            // as this column is certainly after the minimap width\n            return canvasInnerWidth;\n        }\n        // Cache line offset data so that it is only read once per line\n        let lineIndexToXOffset = lineOffsetMap.get(lineNumber);\n        if (!lineIndexToXOffset) {\n            const lineData = this._model.getLineContent(lineNumber);\n            lineIndexToXOffset = [MINIMAP_GUTTER_WIDTH];\n            let prevx = MINIMAP_GUTTER_WIDTH;\n            for (let i = 1; i < lineData.length + 1; i++) {\n                const charCode = lineData.charCodeAt(i - 1);\n                const dx = charCode === 9 /* CharCode.Tab */\n                    ? tabSize * charWidth\n                    : strings.isFullWidthCharacter(charCode)\n                        ? 2 * charWidth\n                        : charWidth;\n                const x = prevx + dx;\n                if (x >= canvasInnerWidth) {\n                    // no need to keep on going, as we've hit the canvas width\n                    lineIndexToXOffset[i] = canvasInnerWidth;\n                    break;\n                }\n                lineIndexToXOffset[i] = x;\n                prevx = x;\n            }\n            lineOffsetMap.set(lineNumber, lineIndexToXOffset);\n        }\n        if (column - 1 < lineIndexToXOffset.length) {\n            return lineIndexToXOffset[column - 1];\n        }\n        // goes over the canvas width\n        return canvasInnerWidth;\n    }\n    renderDecoration(canvasContext, decorationColor, x, y, width, height) {\n        canvasContext.fillStyle = decorationColor && decorationColor.toString() || '';\n        canvasContext.fillRect(x, y, width, height);\n    }\n    renderLines(layout) {\n        const startLineNumber = layout.startLineNumber;\n        const endLineNumber = layout.endLineNumber;\n        const minimapLineHeight = this._model.options.minimapLineHeight;\n        // Check if nothing changed w.r.t. lines from last frame\n        if (this._lastRenderData && this._lastRenderData.linesEquals(layout)) {\n            const _lastData = this._lastRenderData._get();\n            // Nice!! Nothing changed from last frame\n            return new RenderData(layout, _lastData.imageData, _lastData.lines);\n        }\n        // Oh well!! We need to repaint some lines...\n        const imageData = this._getBuffer();\n        if (!imageData) {\n            // 0 width or 0 height canvas, nothing to do\n            return null;\n        }\n        // Render untouched lines by using last rendered data.\n        const [_dirtyY1, _dirtyY2, needed] = InnerMinimap._renderUntouchedLines(imageData, layout.topPaddingLineCount, startLineNumber, endLineNumber, minimapLineHeight, this._lastRenderData);\n        // Fetch rendering info from view model for rest of lines that need rendering.\n        const lineInfo = this._model.getMinimapLinesRenderingData(startLineNumber, endLineNumber, needed);\n        const tabSize = this._model.getOptions().tabSize;\n        const defaultBackground = this._model.options.defaultBackgroundColor;\n        const background = this._model.options.backgroundColor;\n        const foregroundAlpha = this._model.options.foregroundAlpha;\n        const tokensColorTracker = this._model.tokensColorTracker;\n        const useLighterFont = tokensColorTracker.backgroundIsLight();\n        const renderMinimap = this._model.options.renderMinimap;\n        const charRenderer = this._model.options.charRenderer();\n        const fontScale = this._model.options.fontScale;\n        const minimapCharWidth = this._model.options.minimapCharWidth;\n        const baseCharHeight = (renderMinimap === 1 /* RenderMinimap.Text */ ? 2 /* Constants.BASE_CHAR_HEIGHT */ : 2 /* Constants.BASE_CHAR_HEIGHT */ + 1);\n        const renderMinimapLineHeight = baseCharHeight * fontScale;\n        const innerLinePadding = (minimapLineHeight > renderMinimapLineHeight ? Math.floor((minimapLineHeight - renderMinimapLineHeight) / 2) : 0);\n        // Render the rest of lines\n        const backgroundA = background.a / 255;\n        const renderBackground = new RGBA8(Math.round((background.r - defaultBackground.r) * backgroundA + defaultBackground.r), Math.round((background.g - defaultBackground.g) * backgroundA + defaultBackground.g), Math.round((background.b - defaultBackground.b) * backgroundA + defaultBackground.b), 255);\n        let dy = layout.topPaddingLineCount * minimapLineHeight;\n        const renderedLines = [];\n        for (let lineIndex = 0, lineCount = endLineNumber - startLineNumber + 1; lineIndex < lineCount; lineIndex++) {\n            if (needed[lineIndex]) {\n                InnerMinimap._renderLine(imageData, renderBackground, background.a, useLighterFont, renderMinimap, minimapCharWidth, tokensColorTracker, foregroundAlpha, charRenderer, dy, innerLinePadding, tabSize, lineInfo[lineIndex], fontScale, minimapLineHeight);\n            }\n            renderedLines[lineIndex] = new MinimapLine(dy);\n            dy += minimapLineHeight;\n        }\n        const dirtyY1 = (_dirtyY1 === -1 ? 0 : _dirtyY1);\n        const dirtyY2 = (_dirtyY2 === -1 ? imageData.height : _dirtyY2);\n        const dirtyHeight = dirtyY2 - dirtyY1;\n        // Finally, paint to the canvas\n        const ctx = this._canvas.domNode.getContext('2d');\n        ctx.putImageData(imageData, 0, 0, 0, dirtyY1, imageData.width, dirtyHeight);\n        // Save rendered data for reuse on next frame if possible\n        return new RenderData(layout, imageData, renderedLines);\n    }\n    static _renderUntouchedLines(target, topPaddingLineCount, startLineNumber, endLineNumber, minimapLineHeight, lastRenderData) {\n        const needed = [];\n        if (!lastRenderData) {\n            for (let i = 0, len = endLineNumber - startLineNumber + 1; i < len; i++) {\n                needed[i] = true;\n            }\n            return [-1, -1, needed];\n        }\n        const _lastData = lastRenderData._get();\n        const lastTargetData = _lastData.imageData.data;\n        const lastStartLineNumber = _lastData.rendLineNumberStart;\n        const lastLines = _lastData.lines;\n        const lastLinesLength = lastLines.length;\n        const WIDTH = target.width;\n        const targetData = target.data;\n        const maxDestPixel = (endLineNumber - startLineNumber + 1) * minimapLineHeight * WIDTH * 4;\n        let dirtyPixel1 = -1; // the pixel offset up to which all the data is equal to the prev frame\n        let dirtyPixel2 = -1; // the pixel offset after which all the data is equal to the prev frame\n        let copySourceStart = -1;\n        let copySourceEnd = -1;\n        let copyDestStart = -1;\n        let copyDestEnd = -1;\n        let dest_dy = topPaddingLineCount * minimapLineHeight;\n        for (let lineNumber = startLineNumber; lineNumber <= endLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - startLineNumber;\n            const lastLineIndex = lineNumber - lastStartLineNumber;\n            const source_dy = (lastLineIndex >= 0 && lastLineIndex < lastLinesLength ? lastLines[lastLineIndex].dy : -1);\n            if (source_dy === -1) {\n                needed[lineIndex] = true;\n                dest_dy += minimapLineHeight;\n                continue;\n            }\n            const sourceStart = source_dy * WIDTH * 4;\n            const sourceEnd = (source_dy + minimapLineHeight) * WIDTH * 4;\n            const destStart = dest_dy * WIDTH * 4;\n            const destEnd = (dest_dy + minimapLineHeight) * WIDTH * 4;\n            if (copySourceEnd === sourceStart && copyDestEnd === destStart) {\n                // contiguous zone => extend copy request\n                copySourceEnd = sourceEnd;\n                copyDestEnd = destEnd;\n            }\n            else {\n                if (copySourceStart !== -1) {\n                    // flush existing copy request\n                    targetData.set(lastTargetData.subarray(copySourceStart, copySourceEnd), copyDestStart);\n                    if (dirtyPixel1 === -1 && copySourceStart === 0 && copySourceStart === copyDestStart) {\n                        dirtyPixel1 = copySourceEnd;\n                    }\n                    if (dirtyPixel2 === -1 && copySourceEnd === maxDestPixel && copySourceStart === copyDestStart) {\n                        dirtyPixel2 = copySourceStart;\n                    }\n                }\n                copySourceStart = sourceStart;\n                copySourceEnd = sourceEnd;\n                copyDestStart = destStart;\n                copyDestEnd = destEnd;\n            }\n            needed[lineIndex] = false;\n            dest_dy += minimapLineHeight;\n        }\n        if (copySourceStart !== -1) {\n            // flush existing copy request\n            targetData.set(lastTargetData.subarray(copySourceStart, copySourceEnd), copyDestStart);\n            if (dirtyPixel1 === -1 && copySourceStart === 0 && copySourceStart === copyDestStart) {\n                dirtyPixel1 = copySourceEnd;\n            }\n            if (dirtyPixel2 === -1 && copySourceEnd === maxDestPixel && copySourceStart === copyDestStart) {\n                dirtyPixel2 = copySourceStart;\n            }\n        }\n        const dirtyY1 = (dirtyPixel1 === -1 ? -1 : dirtyPixel1 / (WIDTH * 4));\n        const dirtyY2 = (dirtyPixel2 === -1 ? -1 : dirtyPixel2 / (WIDTH * 4));\n        return [dirtyY1, dirtyY2, needed];\n    }\n    static _renderLine(target, backgroundColor, backgroundAlpha, useLighterFont, renderMinimap, charWidth, colorTracker, foregroundAlpha, minimapCharRenderer, dy, innerLinePadding, tabSize, lineData, fontScale, minimapLineHeight) {\n        const content = lineData.content;\n        const tokens = lineData.tokens;\n        const maxDx = target.width - charWidth;\n        const force1pxHeight = (minimapLineHeight === 1);\n        let dx = MINIMAP_GUTTER_WIDTH;\n        let charIndex = 0;\n        let tabsCharDelta = 0;\n        for (let tokenIndex = 0, tokensLen = tokens.getCount(); tokenIndex < tokensLen; tokenIndex++) {\n            const tokenEndIndex = tokens.getEndOffset(tokenIndex);\n            const tokenColorId = tokens.getForeground(tokenIndex);\n            const tokenColor = colorTracker.getColor(tokenColorId);\n            for (; charIndex < tokenEndIndex; charIndex++) {\n                if (dx > maxDx) {\n                    // hit edge of minimap\n                    return;\n                }\n                const charCode = content.charCodeAt(charIndex);\n                if (charCode === 9 /* CharCode.Tab */) {\n                    const insertSpacesCount = tabSize - (charIndex + tabsCharDelta) % tabSize;\n                    tabsCharDelta += insertSpacesCount - 1;\n                    // No need to render anything since tab is invisible\n                    dx += insertSpacesCount * charWidth;\n                }\n                else if (charCode === 32 /* CharCode.Space */) {\n                    // No need to render anything since space is invisible\n                    dx += charWidth;\n                }\n                else {\n                    // Render twice for a full width character\n                    const count = strings.isFullWidthCharacter(charCode) ? 2 : 1;\n                    for (let i = 0; i < count; i++) {\n                        if (renderMinimap === 2 /* RenderMinimap.Blocks */) {\n                            minimapCharRenderer.blockRenderChar(target, dx, dy + innerLinePadding, tokenColor, foregroundAlpha, backgroundColor, backgroundAlpha, force1pxHeight);\n                        }\n                        else { // RenderMinimap.Text\n                            minimapCharRenderer.renderChar(target, dx, dy + innerLinePadding, charCode, tokenColor, foregroundAlpha, backgroundColor, backgroundAlpha, fontScale, useLighterFont, force1pxHeight);\n                        }\n                        dx += charWidth;\n                        if (dx > maxDx) {\n                            // hit edge of minimap\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\nclass ContiguousLineMap {\n    constructor(startLineNumber, endLineNumber, defaultValue) {\n        this._startLineNumber = startLineNumber;\n        this._endLineNumber = endLineNumber;\n        this._defaultValue = defaultValue;\n        this._values = [];\n        for (let i = 0, count = this._endLineNumber - this._startLineNumber + 1; i < count; i++) {\n            this._values[i] = defaultValue;\n        }\n    }\n    has(lineNumber) {\n        return (this.get(lineNumber) !== this._defaultValue);\n    }\n    set(lineNumber, value) {\n        if (lineNumber < this._startLineNumber || lineNumber > this._endLineNumber) {\n            return;\n        }\n        this._values[lineNumber - this._startLineNumber] = value;\n    }\n    get(lineNumber) {\n        if (lineNumber < this._startLineNumber || lineNumber > this._endLineNumber) {\n            return this._defaultValue;\n        }\n        return this._values[lineNumber - this._startLineNumber];\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './overlayWidgets.css';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { PartFingerprints, ViewPart } from '../../view/viewPart.js';\nexport class ViewOverlayWidgets extends ViewPart {\n    constructor(context) {\n        super(context);\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._widgets = {};\n        this._verticalScrollbarWidth = layoutInfo.verticalScrollbarWidth;\n        this._minimapWidth = layoutInfo.minimap.minimapWidth;\n        this._horizontalScrollbarHeight = layoutInfo.horizontalScrollbarHeight;\n        this._editorHeight = layoutInfo.height;\n        this._editorWidth = layoutInfo.width;\n        this._domNode = createFastDomNode(document.createElement('div'));\n        PartFingerprints.write(this._domNode, 4 /* PartFingerprint.OverlayWidgets */);\n        this._domNode.setClassName('overlayWidgets');\n    }\n    dispose() {\n        super.dispose();\n        this._widgets = {};\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    // ---- begin view event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._verticalScrollbarWidth = layoutInfo.verticalScrollbarWidth;\n        this._minimapWidth = layoutInfo.minimap.minimapWidth;\n        this._horizontalScrollbarHeight = layoutInfo.horizontalScrollbarHeight;\n        this._editorHeight = layoutInfo.height;\n        this._editorWidth = layoutInfo.width;\n        return true;\n    }\n    // ---- end view event handlers\n    addWidget(widget) {\n        const domNode = createFastDomNode(widget.getDomNode());\n        this._widgets[widget.getId()] = {\n            widget: widget,\n            preference: null,\n            domNode: domNode\n        };\n        // This is sync because a widget wants to be in the dom\n        domNode.setPosition('absolute');\n        domNode.setAttribute('widgetId', widget.getId());\n        this._domNode.appendChild(domNode);\n        this.setShouldRender();\n    }\n    setWidgetPosition(widget, preference) {\n        const widgetData = this._widgets[widget.getId()];\n        if (widgetData.preference === preference) {\n            return false;\n        }\n        widgetData.preference = preference;\n        this.setShouldRender();\n        return true;\n    }\n    removeWidget(widget) {\n        const widgetId = widget.getId();\n        if (this._widgets.hasOwnProperty(widgetId)) {\n            const widgetData = this._widgets[widgetId];\n            const domNode = widgetData.domNode.domNode;\n            delete this._widgets[widgetId];\n            domNode.parentNode.removeChild(domNode);\n            this.setShouldRender();\n        }\n    }\n    _renderWidget(widgetData) {\n        const domNode = widgetData.domNode;\n        if (widgetData.preference === null) {\n            domNode.setTop('');\n            return;\n        }\n        if (widgetData.preference === 0 /* OverlayWidgetPositionPreference.TOP_RIGHT_CORNER */) {\n            domNode.setTop(0);\n            domNode.setRight((2 * this._verticalScrollbarWidth) + this._minimapWidth);\n        }\n        else if (widgetData.preference === 1 /* OverlayWidgetPositionPreference.BOTTOM_RIGHT_CORNER */) {\n            const widgetHeight = domNode.domNode.clientHeight;\n            domNode.setTop((this._editorHeight - widgetHeight - 2 * this._horizontalScrollbarHeight));\n            domNode.setRight((2 * this._verticalScrollbarWidth) + this._minimapWidth);\n        }\n        else if (widgetData.preference === 2 /* OverlayWidgetPositionPreference.TOP_CENTER */) {\n            domNode.setTop(0);\n            domNode.domNode.style.right = '50%';\n        }\n    }\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    render(ctx) {\n        this._domNode.setWidth(this._editorWidth);\n        const keys = Object.keys(this._widgets);\n        for (let i = 0, len = keys.length; i < len; i++) {\n            const widgetId = keys[i];\n            this._renderWidget(this._widgets[widgetId]);\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { ViewPart } from '../../view/viewPart.js';\nimport { Position } from '../../../common/core/position.js';\nimport { TokenizationRegistry } from '../../../common/languages.js';\nimport { editorCursorForeground, editorOverviewRulerBorder, editorOverviewRulerBackground } from '../../../common/core/editorColorRegistry.js';\nimport { OverviewRulerDecorationsGroup } from '../../../common/viewModel.js';\nclass Settings {\n    constructor(config, theme) {\n        const options = config.options;\n        this.lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this.pixelRatio = options.get(140 /* EditorOption.pixelRatio */);\n        this.overviewRulerLanes = options.get(81 /* EditorOption.overviewRulerLanes */);\n        this.renderBorder = options.get(80 /* EditorOption.overviewRulerBorder */);\n        const borderColor = theme.getColor(editorOverviewRulerBorder);\n        this.borderColor = borderColor ? borderColor.toString() : null;\n        this.hideCursor = options.get(58 /* EditorOption.hideCursorInOverviewRuler */);\n        const cursorColor = theme.getColor(editorCursorForeground);\n        this.cursorColor = cursorColor ? cursorColor.transparent(0.7).toString() : null;\n        this.themeType = theme.type;\n        const minimapOpts = options.get(71 /* EditorOption.minimap */);\n        const minimapEnabled = minimapOpts.enabled;\n        const minimapSide = minimapOpts.side;\n        const themeColor = theme.getColor(editorOverviewRulerBackground);\n        const defaultBackground = TokenizationRegistry.getDefaultBackground();\n        if (themeColor) {\n            this.backgroundColor = themeColor;\n        }\n        else if (minimapEnabled && minimapSide === 'right') {\n            this.backgroundColor = defaultBackground;\n        }\n        else {\n            this.backgroundColor = null;\n        }\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        const position = layoutInfo.overviewRuler;\n        this.top = position.top;\n        this.right = position.right;\n        this.domWidth = position.width;\n        this.domHeight = position.height;\n        if (this.overviewRulerLanes === 0) {\n            // overview ruler is off\n            this.canvasWidth = 0;\n            this.canvasHeight = 0;\n        }\n        else {\n            this.canvasWidth = (this.domWidth * this.pixelRatio) | 0;\n            this.canvasHeight = (this.domHeight * this.pixelRatio) | 0;\n        }\n        const [x, w] = this._initLanes(1, this.canvasWidth, this.overviewRulerLanes);\n        this.x = x;\n        this.w = w;\n    }\n    _initLanes(canvasLeftOffset, canvasWidth, laneCount) {\n        const remainingWidth = canvasWidth - canvasLeftOffset;\n        if (laneCount >= 3) {\n            const leftWidth = Math.floor(remainingWidth / 3);\n            const rightWidth = Math.floor(remainingWidth / 3);\n            const centerWidth = remainingWidth - leftWidth - rightWidth;\n            const leftOffset = canvasLeftOffset;\n            const centerOffset = leftOffset + leftWidth;\n            const rightOffset = leftOffset + leftWidth + centerWidth;\n            return [\n                [\n                    0,\n                    leftOffset,\n                    centerOffset,\n                    leftOffset,\n                    rightOffset,\n                    leftOffset,\n                    centerOffset,\n                    leftOffset, // Left | Center | Right\n                ], [\n                    0,\n                    leftWidth,\n                    centerWidth,\n                    leftWidth + centerWidth,\n                    rightWidth,\n                    leftWidth + centerWidth + rightWidth,\n                    centerWidth + rightWidth,\n                    leftWidth + centerWidth + rightWidth, // Left | Center | Right\n                ]\n            ];\n        }\n        else if (laneCount === 2) {\n            const leftWidth = Math.floor(remainingWidth / 2);\n            const rightWidth = remainingWidth - leftWidth;\n            const leftOffset = canvasLeftOffset;\n            const rightOffset = leftOffset + leftWidth;\n            return [\n                [\n                    0,\n                    leftOffset,\n                    leftOffset,\n                    leftOffset,\n                    rightOffset,\n                    leftOffset,\n                    leftOffset,\n                    leftOffset, // Left | Center | Right\n                ], [\n                    0,\n                    leftWidth,\n                    leftWidth,\n                    leftWidth,\n                    rightWidth,\n                    leftWidth + rightWidth,\n                    leftWidth + rightWidth,\n                    leftWidth + rightWidth, // Left | Center | Right\n                ]\n            ];\n        }\n        else {\n            const offset = canvasLeftOffset;\n            const width = remainingWidth;\n            return [\n                [\n                    0,\n                    offset,\n                    offset,\n                    offset,\n                    offset,\n                    offset,\n                    offset,\n                    offset, // Left | Center | Right\n                ], [\n                    0,\n                    width,\n                    width,\n                    width,\n                    width,\n                    width,\n                    width,\n                    width, // Left | Center | Right\n                ]\n            ];\n        }\n    }\n    equals(other) {\n        return (this.lineHeight === other.lineHeight\n            && this.pixelRatio === other.pixelRatio\n            && this.overviewRulerLanes === other.overviewRulerLanes\n            && this.renderBorder === other.renderBorder\n            && this.borderColor === other.borderColor\n            && this.hideCursor === other.hideCursor\n            && this.cursorColor === other.cursorColor\n            && this.themeType === other.themeType\n            && Color.equals(this.backgroundColor, other.backgroundColor)\n            && this.top === other.top\n            && this.right === other.right\n            && this.domWidth === other.domWidth\n            && this.domHeight === other.domHeight\n            && this.canvasWidth === other.canvasWidth\n            && this.canvasHeight === other.canvasHeight);\n    }\n}\nexport class DecorationsOverviewRuler extends ViewPart {\n    constructor(context) {\n        super(context);\n        this._domNode = createFastDomNode(document.createElement('canvas'));\n        this._domNode.setClassName('decorationsOverviewRuler');\n        this._domNode.setPosition('absolute');\n        this._domNode.setLayerHinting(true);\n        this._domNode.setContain('strict');\n        this._domNode.setAttribute('aria-hidden', 'true');\n        this._updateSettings(false);\n        this._tokensColorTrackerListener = TokenizationRegistry.onDidChange((e) => {\n            if (e.changedColorMap) {\n                this._updateSettings(true);\n            }\n        });\n        this._cursorPositions = [];\n    }\n    dispose() {\n        super.dispose();\n        this._tokensColorTrackerListener.dispose();\n    }\n    _updateSettings(renderNow) {\n        const newSettings = new Settings(this._context.configuration, this._context.theme);\n        if (this._settings && this._settings.equals(newSettings)) {\n            // nothing to do\n            return false;\n        }\n        this._settings = newSettings;\n        this._domNode.setTop(this._settings.top);\n        this._domNode.setRight(this._settings.right);\n        this._domNode.setWidth(this._settings.domWidth);\n        this._domNode.setHeight(this._settings.domHeight);\n        this._domNode.domNode.width = this._settings.canvasWidth;\n        this._domNode.domNode.height = this._settings.canvasHeight;\n        if (renderNow) {\n            this._render();\n        }\n        return true;\n    }\n    // ---- begin view event handlers\n    onConfigurationChanged(e) {\n        return this._updateSettings(false);\n    }\n    onCursorStateChanged(e) {\n        this._cursorPositions = [];\n        for (let i = 0, len = e.selections.length; i < len; i++) {\n            this._cursorPositions[i] = e.selections[i].getPosition();\n        }\n        this._cursorPositions.sort(Position.compare);\n        return true;\n    }\n    onDecorationsChanged(e) {\n        if (e.affectsOverviewRuler) {\n            return true;\n        }\n        return false;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollHeightChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    onThemeChanged(e) {\n        return this._updateSettings(false);\n    }\n    // ---- end view event handlers\n    getDomNode() {\n        return this._domNode.domNode;\n    }\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    render(editorCtx) {\n        this._render();\n    }\n    _render() {\n        const backgroundColor = this._settings.backgroundColor;\n        if (this._settings.overviewRulerLanes === 0) {\n            // overview ruler is off\n            this._domNode.setBackgroundColor(backgroundColor ? Color.Format.CSS.formatHexA(backgroundColor) : '');\n            this._domNode.setDisplay('none');\n            return;\n        }\n        this._domNode.setDisplay('block');\n        const canvasWidth = this._settings.canvasWidth;\n        const canvasHeight = this._settings.canvasHeight;\n        const lineHeight = this._settings.lineHeight;\n        const viewLayout = this._context.viewLayout;\n        const outerHeight = this._context.viewLayout.getScrollHeight();\n        const heightRatio = canvasHeight / outerHeight;\n        const decorations = this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);\n        const minDecorationHeight = (6 /* Constants.MIN_DECORATION_HEIGHT */ * this._settings.pixelRatio) | 0;\n        const halfMinDecorationHeight = (minDecorationHeight / 2) | 0;\n        const canvasCtx = this._domNode.domNode.getContext('2d');\n        if (backgroundColor) {\n            if (backgroundColor.isOpaque()) {\n                // We have a background color which is opaque, we can just paint the entire surface with it\n                canvasCtx.fillStyle = Color.Format.CSS.formatHexA(backgroundColor);\n                canvasCtx.fillRect(0, 0, canvasWidth, canvasHeight);\n            }\n            else {\n                // We have a background color which is transparent, we need to first clear the surface and\n                // then fill it\n                canvasCtx.clearRect(0, 0, canvasWidth, canvasHeight);\n                canvasCtx.fillStyle = Color.Format.CSS.formatHexA(backgroundColor);\n                canvasCtx.fillRect(0, 0, canvasWidth, canvasHeight);\n            }\n        }\n        else {\n            // We don't have a background color\n            canvasCtx.clearRect(0, 0, canvasWidth, canvasHeight);\n        }\n        const x = this._settings.x;\n        const w = this._settings.w;\n        decorations.sort(OverviewRulerDecorationsGroup.cmp);\n        for (const decorationGroup of decorations) {\n            const color = decorationGroup.color;\n            const decorationGroupData = decorationGroup.data;\n            canvasCtx.fillStyle = color;\n            let prevLane = 0;\n            let prevY1 = 0;\n            let prevY2 = 0;\n            for (let i = 0, len = decorationGroupData.length / 3; i < len; i++) {\n                const lane = decorationGroupData[3 * i];\n                const startLineNumber = decorationGroupData[3 * i + 1];\n                const endLineNumber = decorationGroupData[3 * i + 2];\n                let y1 = (viewLayout.getVerticalOffsetForLineNumber(startLineNumber) * heightRatio) | 0;\n                let y2 = ((viewLayout.getVerticalOffsetForLineNumber(endLineNumber) + lineHeight) * heightRatio) | 0;\n                const height = y2 - y1;\n                if (height < minDecorationHeight) {\n                    let yCenter = ((y1 + y2) / 2) | 0;\n                    if (yCenter < halfMinDecorationHeight) {\n                        yCenter = halfMinDecorationHeight;\n                    }\n                    else if (yCenter + halfMinDecorationHeight > canvasHeight) {\n                        yCenter = canvasHeight - halfMinDecorationHeight;\n                    }\n                    y1 = yCenter - halfMinDecorationHeight;\n                    y2 = yCenter + halfMinDecorationHeight;\n                }\n                if (y1 > prevY2 + 1 || lane !== prevLane) {\n                    // flush prev\n                    if (i !== 0) {\n                        canvasCtx.fillRect(x[prevLane], prevY1, w[prevLane], prevY2 - prevY1);\n                    }\n                    prevLane = lane;\n                    prevY1 = y1;\n                    prevY2 = y2;\n                }\n                else {\n                    // merge into prev\n                    if (y2 > prevY2) {\n                        prevY2 = y2;\n                    }\n                }\n            }\n            canvasCtx.fillRect(x[prevLane], prevY1, w[prevLane], prevY2 - prevY1);\n        }\n        // Draw cursors\n        if (!this._settings.hideCursor && this._settings.cursorColor) {\n            const cursorHeight = (2 * this._settings.pixelRatio) | 0;\n            const halfCursorHeight = (cursorHeight / 2) | 0;\n            const cursorX = this._settings.x[7 /* OverviewRulerLane.Full */];\n            const cursorW = this._settings.w[7 /* OverviewRulerLane.Full */];\n            canvasCtx.fillStyle = this._settings.cursorColor;\n            let prevY1 = -100;\n            let prevY2 = -100;\n            for (let i = 0, len = this._cursorPositions.length; i < len; i++) {\n                const cursor = this._cursorPositions[i];\n                let yCenter = (viewLayout.getVerticalOffsetForLineNumber(cursor.lineNumber) * heightRatio) | 0;\n                if (yCenter < halfCursorHeight) {\n                    yCenter = halfCursorHeight;\n                }\n                else if (yCenter + halfCursorHeight > canvasHeight) {\n                    yCenter = canvasHeight - halfCursorHeight;\n                }\n                const y1 = yCenter - halfCursorHeight;\n                const y2 = y1 + cursorHeight;\n                if (y1 > prevY2 + 1) {\n                    // flush prev\n                    if (i !== 0) {\n                        canvasCtx.fillRect(cursorX, prevY1, cursorW, prevY2 - prevY1);\n                    }\n                    prevY1 = y1;\n                    prevY2 = y2;\n                }\n                else {\n                    // merge into prev\n                    if (y2 > prevY2) {\n                        prevY2 = y2;\n                    }\n                }\n            }\n            canvasCtx.fillRect(cursorX, prevY1, cursorW, prevY2 - prevY1);\n        }\n        if (this._settings.renderBorder && this._settings.borderColor && this._settings.overviewRulerLanes > 0) {\n            canvasCtx.beginPath();\n            canvasCtx.lineWidth = 1;\n            canvasCtx.strokeStyle = this._settings.borderColor;\n            canvasCtx.moveTo(0, 0);\n            canvasCtx.lineTo(0, canvasHeight);\n            canvasCtx.stroke();\n            canvasCtx.moveTo(0, 0);\n            canvasCtx.lineTo(canvasWidth, 0);\n            canvasCtx.stroke();\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { OverviewZoneManager } from '../../../common/viewModel/overviewZoneManager.js';\nimport { ViewEventHandler } from '../../../common/viewEventHandler.js';\nexport class OverviewRuler extends ViewEventHandler {\n    constructor(context, cssClassName) {\n        super();\n        this._context = context;\n        const options = this._context.configuration.options;\n        this._domNode = createFastDomNode(document.createElement('canvas'));\n        this._domNode.setClassName(cssClassName);\n        this._domNode.setPosition('absolute');\n        this._domNode.setLayerHinting(true);\n        this._domNode.setContain('strict');\n        this._zoneManager = new OverviewZoneManager((lineNumber) => this._context.viewLayout.getVerticalOffsetForLineNumber(lineNumber));\n        this._zoneManager.setDOMWidth(0);\n        this._zoneManager.setDOMHeight(0);\n        this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight());\n        this._zoneManager.setLineHeight(options.get(65 /* EditorOption.lineHeight */));\n        this._zoneManager.setPixelRatio(options.get(140 /* EditorOption.pixelRatio */));\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        super.dispose();\n    }\n    // ---- begin view event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        if (e.hasChanged(65 /* EditorOption.lineHeight */)) {\n            this._zoneManager.setLineHeight(options.get(65 /* EditorOption.lineHeight */));\n            this._render();\n        }\n        if (e.hasChanged(140 /* EditorOption.pixelRatio */)) {\n            this._zoneManager.setPixelRatio(options.get(140 /* EditorOption.pixelRatio */));\n            this._domNode.setWidth(this._zoneManager.getDOMWidth());\n            this._domNode.setHeight(this._zoneManager.getDOMHeight());\n            this._domNode.domNode.width = this._zoneManager.getCanvasWidth();\n            this._domNode.domNode.height = this._zoneManager.getCanvasHeight();\n            this._render();\n        }\n        return true;\n    }\n    onFlushed(e) {\n        this._render();\n        return true;\n    }\n    onScrollChanged(e) {\n        if (e.scrollHeightChanged) {\n            this._zoneManager.setOuterHeight(e.scrollHeight);\n            this._render();\n        }\n        return true;\n    }\n    onZonesChanged(e) {\n        this._render();\n        return true;\n    }\n    // ---- end view event handlers\n    getDomNode() {\n        return this._domNode.domNode;\n    }\n    setLayout(position) {\n        this._domNode.setTop(position.top);\n        this._domNode.setRight(position.right);\n        let hasChanged = false;\n        hasChanged = this._zoneManager.setDOMWidth(position.width) || hasChanged;\n        hasChanged = this._zoneManager.setDOMHeight(position.height) || hasChanged;\n        if (hasChanged) {\n            this._domNode.setWidth(this._zoneManager.getDOMWidth());\n            this._domNode.setHeight(this._zoneManager.getDOMHeight());\n            this._domNode.domNode.width = this._zoneManager.getCanvasWidth();\n            this._domNode.domNode.height = this._zoneManager.getCanvasHeight();\n            this._render();\n        }\n    }\n    setZones(zones) {\n        this._zoneManager.setZones(zones);\n        this._render();\n    }\n    _render() {\n        if (this._zoneManager.getOuterHeight() === 0) {\n            return false;\n        }\n        const width = this._zoneManager.getCanvasWidth();\n        const height = this._zoneManager.getCanvasHeight();\n        const colorZones = this._zoneManager.resolveColorZones();\n        const id2Color = this._zoneManager.getId2Color();\n        const ctx = this._domNode.domNode.getContext('2d');\n        ctx.clearRect(0, 0, width, height);\n        if (colorZones.length > 0) {\n            this._renderOneLane(ctx, colorZones, id2Color, width);\n        }\n        return true;\n    }\n    _renderOneLane(ctx, colorZones, id2Color, width) {\n        let currentColorId = 0;\n        let currentFrom = 0;\n        let currentTo = 0;\n        for (const zone of colorZones) {\n            const zoneColorId = zone.colorId;\n            const zoneFrom = zone.from;\n            const zoneTo = zone.to;\n            if (zoneColorId !== currentColorId) {\n                ctx.fillRect(0, currentFrom, width, currentTo - currentFrom);\n                currentColorId = zoneColorId;\n                ctx.fillStyle = id2Color[currentColorId];\n                currentFrom = zoneFrom;\n                currentTo = zoneTo;\n            }\n            else {\n                if (currentTo >= zoneFrom) {\n                    currentTo = Math.max(currentTo, zoneTo);\n                }\n                else {\n                    ctx.fillRect(0, currentFrom, width, currentTo - currentFrom);\n                    currentFrom = zoneFrom;\n                    currentTo = zoneTo;\n                }\n            }\n        }\n        ctx.fillRect(0, currentFrom, width, currentTo - currentFrom);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './rulers.css';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { ViewPart } from '../../view/viewPart.js';\nexport class Rulers extends ViewPart {\n    constructor(context) {\n        super(context);\n        this.domNode = createFastDomNode(document.createElement('div'));\n        this.domNode.setAttribute('role', 'presentation');\n        this.domNode.setAttribute('aria-hidden', 'true');\n        this.domNode.setClassName('view-rulers');\n        this._renderedRulers = [];\n        const options = this._context.configuration.options;\n        this._rulers = options.get(100 /* EditorOption.rulers */);\n        this._typicalHalfwidthCharacterWidth = options.get(49 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n    }\n    dispose() {\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        this._rulers = options.get(100 /* EditorOption.rulers */);\n        this._typicalHalfwidthCharacterWidth = options.get(49 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollHeightChanged;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    _ensureRulersCount() {\n        const currentCount = this._renderedRulers.length;\n        const desiredCount = this._rulers.length;\n        if (currentCount === desiredCount) {\n            // Nothing to do\n            return;\n        }\n        if (currentCount < desiredCount) {\n            const { tabSize } = this._context.viewModel.model.getOptions();\n            const rulerWidth = tabSize;\n            let addCount = desiredCount - currentCount;\n            while (addCount > 0) {\n                const node = createFastDomNode(document.createElement('div'));\n                node.setClassName('view-ruler');\n                node.setWidth(rulerWidth);\n                this.domNode.appendChild(node);\n                this._renderedRulers.push(node);\n                addCount--;\n            }\n            return;\n        }\n        let removeCount = currentCount - desiredCount;\n        while (removeCount > 0) {\n            const node = this._renderedRulers.pop();\n            this.domNode.removeChild(node);\n            removeCount--;\n        }\n    }\n    render(ctx) {\n        this._ensureRulersCount();\n        for (let i = 0, len = this._rulers.length; i < len; i++) {\n            const node = this._renderedRulers[i];\n            const ruler = this._rulers[i];\n            node.setBoxShadow(ruler.color ? `1px 0 0 0 ${ruler.color} inset` : ``);\n            node.setHeight(Math.min(ctx.scrollHeight, 1000000));\n            node.setLeft(ruler.column * this._typicalHalfwidthCharacterWidth);\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './scrollDecoration.css';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { ViewPart } from '../../view/viewPart.js';\nexport class ScrollDecorationViewPart extends ViewPart {\n    constructor(context) {\n        super(context);\n        this._scrollTop = 0;\n        this._width = 0;\n        this._updateWidth();\n        this._shouldShow = false;\n        const options = this._context.configuration.options;\n        const scrollbar = options.get(101 /* EditorOption.scrollbar */);\n        this._useShadows = scrollbar.useShadows;\n        this._domNode = createFastDomNode(document.createElement('div'));\n        this._domNode.setAttribute('role', 'presentation');\n        this._domNode.setAttribute('aria-hidden', 'true');\n    }\n    dispose() {\n        super.dispose();\n    }\n    _updateShouldShow() {\n        const newShouldShow = (this._useShadows && this._scrollTop > 0);\n        if (this._shouldShow !== newShouldShow) {\n            this._shouldShow = newShouldShow;\n            return true;\n        }\n        return false;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    _updateWidth() {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        if (layoutInfo.minimap.renderMinimap === 0 || (layoutInfo.minimap.minimapWidth > 0 && layoutInfo.minimap.minimapLeft === 0)) {\n            this._width = layoutInfo.width;\n        }\n        else {\n            this._width = layoutInfo.width - layoutInfo.verticalScrollbarWidth;\n        }\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const scrollbar = options.get(101 /* EditorOption.scrollbar */);\n        this._useShadows = scrollbar.useShadows;\n        this._updateWidth();\n        this._updateShouldShow();\n        return true;\n    }\n    onScrollChanged(e) {\n        this._scrollTop = e.scrollTop;\n        return this._updateShouldShow();\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    render(ctx) {\n        this._domNode.setWidth(this._width);\n        this._domNode.setClassName(this._shouldShow ? 'scroll-decoration' : '');\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './selections.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport { editorSelectionForeground } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nclass HorizontalRangeWithStyle {\n    constructor(other) {\n        this.left = other.left;\n        this.width = other.width;\n        this.startStyle = null;\n        this.endStyle = null;\n    }\n}\nclass LineVisibleRangesWithStyle {\n    constructor(lineNumber, ranges) {\n        this.lineNumber = lineNumber;\n        this.ranges = ranges;\n    }\n}\nfunction toStyledRange(item) {\n    return new HorizontalRangeWithStyle(item);\n}\nfunction toStyled(item) {\n    return new LineVisibleRangesWithStyle(item.lineNumber, item.ranges.map(toStyledRange));\n}\nexport class SelectionsOverlay extends DynamicViewOverlay {\n    constructor(context) {\n        super();\n        this._previousFrameVisibleRangesWithStyle = [];\n        this._context = context;\n        const options = this._context.configuration.options;\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._roundedSelection = options.get(99 /* EditorOption.roundedSelection */);\n        this._typicalHalfwidthCharacterWidth = options.get(49 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n        this._selections = [];\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._roundedSelection = options.get(99 /* EditorOption.roundedSelection */);\n        this._typicalHalfwidthCharacterWidth = options.get(49 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n        return true;\n    }\n    onCursorStateChanged(e) {\n        this._selections = e.selections.slice(0);\n        return true;\n    }\n    onDecorationsChanged(e) {\n        // true for inline decorations that can end up relayouting text\n        return true; //e.inlineDecorationsChanged;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    _visibleRangesHaveGaps(linesVisibleRanges) {\n        for (let i = 0, len = linesVisibleRanges.length; i < len; i++) {\n            const lineVisibleRanges = linesVisibleRanges[i];\n            if (lineVisibleRanges.ranges.length > 1) {\n                // There are two ranges on the same line\n                return true;\n            }\n        }\n        return false;\n    }\n    _enrichVisibleRangesWithStyle(viewport, linesVisibleRanges, previousFrame) {\n        const epsilon = this._typicalHalfwidthCharacterWidth / 4;\n        let previousFrameTop = null;\n        let previousFrameBottom = null;\n        if (previousFrame && previousFrame.length > 0 && linesVisibleRanges.length > 0) {\n            const topLineNumber = linesVisibleRanges[0].lineNumber;\n            if (topLineNumber === viewport.startLineNumber) {\n                for (let i = 0; !previousFrameTop && i < previousFrame.length; i++) {\n                    if (previousFrame[i].lineNumber === topLineNumber) {\n                        previousFrameTop = previousFrame[i].ranges[0];\n                    }\n                }\n            }\n            const bottomLineNumber = linesVisibleRanges[linesVisibleRanges.length - 1].lineNumber;\n            if (bottomLineNumber === viewport.endLineNumber) {\n                for (let i = previousFrame.length - 1; !previousFrameBottom && i >= 0; i--) {\n                    if (previousFrame[i].lineNumber === bottomLineNumber) {\n                        previousFrameBottom = previousFrame[i].ranges[0];\n                    }\n                }\n            }\n            if (previousFrameTop && !previousFrameTop.startStyle) {\n                previousFrameTop = null;\n            }\n            if (previousFrameBottom && !previousFrameBottom.startStyle) {\n                previousFrameBottom = null;\n            }\n        }\n        for (let i = 0, len = linesVisibleRanges.length; i < len; i++) {\n            // We know for a fact that there is precisely one range on each line\n            const curLineRange = linesVisibleRanges[i].ranges[0];\n            const curLeft = curLineRange.left;\n            const curRight = curLineRange.left + curLineRange.width;\n            const startStyle = {\n                top: 0 /* CornerStyle.EXTERN */,\n                bottom: 0 /* CornerStyle.EXTERN */\n            };\n            const endStyle = {\n                top: 0 /* CornerStyle.EXTERN */,\n                bottom: 0 /* CornerStyle.EXTERN */\n            };\n            if (i > 0) {\n                // Look above\n                const prevLeft = linesVisibleRanges[i - 1].ranges[0].left;\n                const prevRight = linesVisibleRanges[i - 1].ranges[0].left + linesVisibleRanges[i - 1].ranges[0].width;\n                if (abs(curLeft - prevLeft) < epsilon) {\n                    startStyle.top = 2 /* CornerStyle.FLAT */;\n                }\n                else if (curLeft > prevLeft) {\n                    startStyle.top = 1 /* CornerStyle.INTERN */;\n                }\n                if (abs(curRight - prevRight) < epsilon) {\n                    endStyle.top = 2 /* CornerStyle.FLAT */;\n                }\n                else if (prevLeft < curRight && curRight < prevRight) {\n                    endStyle.top = 1 /* CornerStyle.INTERN */;\n                }\n            }\n            else if (previousFrameTop) {\n                // Accept some hiccups near the viewport edges to save on repaints\n                startStyle.top = previousFrameTop.startStyle.top;\n                endStyle.top = previousFrameTop.endStyle.top;\n            }\n            if (i + 1 < len) {\n                // Look below\n                const nextLeft = linesVisibleRanges[i + 1].ranges[0].left;\n                const nextRight = linesVisibleRanges[i + 1].ranges[0].left + linesVisibleRanges[i + 1].ranges[0].width;\n                if (abs(curLeft - nextLeft) < epsilon) {\n                    startStyle.bottom = 2 /* CornerStyle.FLAT */;\n                }\n                else if (nextLeft < curLeft && curLeft < nextRight) {\n                    startStyle.bottom = 1 /* CornerStyle.INTERN */;\n                }\n                if (abs(curRight - nextRight) < epsilon) {\n                    endStyle.bottom = 2 /* CornerStyle.FLAT */;\n                }\n                else if (curRight < nextRight) {\n                    endStyle.bottom = 1 /* CornerStyle.INTERN */;\n                }\n            }\n            else if (previousFrameBottom) {\n                // Accept some hiccups near the viewport edges to save on repaints\n                startStyle.bottom = previousFrameBottom.startStyle.bottom;\n                endStyle.bottom = previousFrameBottom.endStyle.bottom;\n            }\n            curLineRange.startStyle = startStyle;\n            curLineRange.endStyle = endStyle;\n        }\n    }\n    _getVisibleRangesWithStyle(selection, ctx, previousFrame) {\n        const _linesVisibleRanges = ctx.linesVisibleRangesForRange(selection, true) || [];\n        const linesVisibleRanges = _linesVisibleRanges.map(toStyled);\n        const visibleRangesHaveGaps = this._visibleRangesHaveGaps(linesVisibleRanges);\n        if (!visibleRangesHaveGaps && this._roundedSelection) {\n            this._enrichVisibleRangesWithStyle(ctx.visibleRange, linesVisibleRanges, previousFrame);\n        }\n        // The visible ranges are sorted TOP-BOTTOM and LEFT-RIGHT\n        return linesVisibleRanges;\n    }\n    _createSelectionPiece(top, height, className, left, width) {\n        return ('<div class=\"cslr '\n            + className\n            + '\" style=\"top:'\n            + top.toString()\n            + 'px;left:'\n            + left.toString()\n            + 'px;width:'\n            + width.toString()\n            + 'px;height:'\n            + height\n            + 'px;\"></div>');\n    }\n    _actualRenderOneSelection(output2, visibleStartLineNumber, hasMultipleSelections, visibleRanges) {\n        if (visibleRanges.length === 0) {\n            return;\n        }\n        const visibleRangesHaveStyle = !!visibleRanges[0].ranges[0].startStyle;\n        const fullLineHeight = (this._lineHeight).toString();\n        const reducedLineHeight = (this._lineHeight - 1).toString();\n        const firstLineNumber = visibleRanges[0].lineNumber;\n        const lastLineNumber = visibleRanges[visibleRanges.length - 1].lineNumber;\n        for (let i = 0, len = visibleRanges.length; i < len; i++) {\n            const lineVisibleRanges = visibleRanges[i];\n            const lineNumber = lineVisibleRanges.lineNumber;\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            const lineHeight = hasMultipleSelections ? (lineNumber === lastLineNumber || lineNumber === firstLineNumber ? reducedLineHeight : fullLineHeight) : fullLineHeight;\n            const top = hasMultipleSelections ? (lineNumber === firstLineNumber ? 1 : 0) : 0;\n            let innerCornerOutput = '';\n            let restOfSelectionOutput = '';\n            for (let j = 0, lenJ = lineVisibleRanges.ranges.length; j < lenJ; j++) {\n                const visibleRange = lineVisibleRanges.ranges[j];\n                if (visibleRangesHaveStyle) {\n                    const startStyle = visibleRange.startStyle;\n                    const endStyle = visibleRange.endStyle;\n                    if (startStyle.top === 1 /* CornerStyle.INTERN */ || startStyle.bottom === 1 /* CornerStyle.INTERN */) {\n                        // Reverse rounded corner to the left\n                        // First comes the selection (blue layer)\n                        innerCornerOutput += this._createSelectionPiece(top, lineHeight, SelectionsOverlay.SELECTION_CLASS_NAME, visibleRange.left - SelectionsOverlay.ROUNDED_PIECE_WIDTH, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\n                        // Second comes the background (white layer) with inverse border radius\n                        let className = SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;\n                        if (startStyle.top === 1 /* CornerStyle.INTERN */) {\n                            className += ' ' + SelectionsOverlay.SELECTION_TOP_RIGHT;\n                        }\n                        if (startStyle.bottom === 1 /* CornerStyle.INTERN */) {\n                            className += ' ' + SelectionsOverlay.SELECTION_BOTTOM_RIGHT;\n                        }\n                        innerCornerOutput += this._createSelectionPiece(top, lineHeight, className, visibleRange.left - SelectionsOverlay.ROUNDED_PIECE_WIDTH, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\n                    }\n                    if (endStyle.top === 1 /* CornerStyle.INTERN */ || endStyle.bottom === 1 /* CornerStyle.INTERN */) {\n                        // Reverse rounded corner to the right\n                        // First comes the selection (blue layer)\n                        innerCornerOutput += this._createSelectionPiece(top, lineHeight, SelectionsOverlay.SELECTION_CLASS_NAME, visibleRange.left + visibleRange.width, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\n                        // Second comes the background (white layer) with inverse border radius\n                        let className = SelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME;\n                        if (endStyle.top === 1 /* CornerStyle.INTERN */) {\n                            className += ' ' + SelectionsOverlay.SELECTION_TOP_LEFT;\n                        }\n                        if (endStyle.bottom === 1 /* CornerStyle.INTERN */) {\n                            className += ' ' + SelectionsOverlay.SELECTION_BOTTOM_LEFT;\n                        }\n                        innerCornerOutput += this._createSelectionPiece(top, lineHeight, className, visibleRange.left + visibleRange.width, SelectionsOverlay.ROUNDED_PIECE_WIDTH);\n                    }\n                }\n                let className = SelectionsOverlay.SELECTION_CLASS_NAME;\n                if (visibleRangesHaveStyle) {\n                    const startStyle = visibleRange.startStyle;\n                    const endStyle = visibleRange.endStyle;\n                    if (startStyle.top === 0 /* CornerStyle.EXTERN */) {\n                        className += ' ' + SelectionsOverlay.SELECTION_TOP_LEFT;\n                    }\n                    if (startStyle.bottom === 0 /* CornerStyle.EXTERN */) {\n                        className += ' ' + SelectionsOverlay.SELECTION_BOTTOM_LEFT;\n                    }\n                    if (endStyle.top === 0 /* CornerStyle.EXTERN */) {\n                        className += ' ' + SelectionsOverlay.SELECTION_TOP_RIGHT;\n                    }\n                    if (endStyle.bottom === 0 /* CornerStyle.EXTERN */) {\n                        className += ' ' + SelectionsOverlay.SELECTION_BOTTOM_RIGHT;\n                    }\n                }\n                restOfSelectionOutput += this._createSelectionPiece(top, lineHeight, className, visibleRange.left, visibleRange.width);\n            }\n            output2[lineIndex][0] += innerCornerOutput;\n            output2[lineIndex][1] += restOfSelectionOutput;\n        }\n    }\n    prepareRender(ctx) {\n        // Build HTML for inner corners separate from HTML for the rest of selections,\n        // as the inner corner HTML can interfere with that of other selections.\n        // In final render, make sure to place the inner corner HTML before the rest of selection HTML. See issue #77777.\n        const output = [];\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            output[lineIndex] = ['', ''];\n        }\n        const thisFrameVisibleRangesWithStyle = [];\n        for (let i = 0, len = this._selections.length; i < len; i++) {\n            const selection = this._selections[i];\n            if (selection.isEmpty()) {\n                thisFrameVisibleRangesWithStyle[i] = null;\n                continue;\n            }\n            const visibleRangesWithStyle = this._getVisibleRangesWithStyle(selection, ctx, this._previousFrameVisibleRangesWithStyle[i]);\n            thisFrameVisibleRangesWithStyle[i] = visibleRangesWithStyle;\n            this._actualRenderOneSelection(output, visibleStartLineNumber, this._selections.length > 1, visibleRangesWithStyle);\n        }\n        this._previousFrameVisibleRangesWithStyle = thisFrameVisibleRangesWithStyle;\n        this._renderResult = output.map(([internalCorners, restOfSelection]) => internalCorners + restOfSelection);\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\n            return '';\n        }\n        return this._renderResult[lineIndex];\n    }\n}\nSelectionsOverlay.SELECTION_CLASS_NAME = 'selected-text';\nSelectionsOverlay.SELECTION_TOP_LEFT = 'top-left-radius';\nSelectionsOverlay.SELECTION_BOTTOM_LEFT = 'bottom-left-radius';\nSelectionsOverlay.SELECTION_TOP_RIGHT = 'top-right-radius';\nSelectionsOverlay.SELECTION_BOTTOM_RIGHT = 'bottom-right-radius';\nSelectionsOverlay.EDITOR_BACKGROUND_CLASS_NAME = 'monaco-editor-background';\nSelectionsOverlay.ROUNDED_PIECE_WIDTH = 10;\nregisterThemingParticipant((theme, collector) => {\n    const editorSelectionForegroundColor = theme.getColor(editorSelectionForeground);\n    if (editorSelectionForegroundColor && !editorSelectionForegroundColor.isTransparent()) {\n        collector.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${editorSelectionForegroundColor}; }`);\n    }\n});\nfunction abs(n) {\n    return n < 0 ? -n : n;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { applyFontInfo } from '../../config/domFontInfo.js';\nimport { TextEditorCursorStyle } from '../../../common/config/editorOptions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { MOUSE_CURSOR_TEXT_CSS_CLASS_NAME } from '../../../../base/browser/ui/mouseCursor/mouseCursor.js';\nclass ViewCursorRenderData {\n    constructor(top, left, paddingLeft, width, height, textContent, textContentClassName) {\n        this.top = top;\n        this.left = left;\n        this.paddingLeft = paddingLeft;\n        this.width = width;\n        this.height = height;\n        this.textContent = textContent;\n        this.textContentClassName = textContentClassName;\n    }\n}\nexport class ViewCursor {\n    constructor(context) {\n        this._context = context;\n        const options = this._context.configuration.options;\n        const fontInfo = options.get(49 /* EditorOption.fontInfo */);\n        this._cursorStyle = options.get(27 /* EditorOption.cursorStyle */);\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n        this._lineCursorWidth = Math.min(options.get(30 /* EditorOption.cursorWidth */), this._typicalHalfwidthCharacterWidth);\n        this._isVisible = true;\n        // Create the dom node\n        this._domNode = createFastDomNode(document.createElement('div'));\n        this._domNode.setClassName(`cursor ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`);\n        this._domNode.setHeight(this._lineHeight);\n        this._domNode.setTop(0);\n        this._domNode.setLeft(0);\n        applyFontInfo(this._domNode, fontInfo);\n        this._domNode.setDisplay('none');\n        this._position = new Position(1, 1);\n        this._lastRenderedContent = '';\n        this._renderData = null;\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    getPosition() {\n        return this._position;\n    }\n    show() {\n        if (!this._isVisible) {\n            this._domNode.setVisibility('inherit');\n            this._isVisible = true;\n        }\n    }\n    hide() {\n        if (this._isVisible) {\n            this._domNode.setVisibility('hidden');\n            this._isVisible = false;\n        }\n    }\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const fontInfo = options.get(49 /* EditorOption.fontInfo */);\n        this._cursorStyle = options.get(27 /* EditorOption.cursorStyle */);\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._typicalHalfwidthCharacterWidth = fontInfo.typicalHalfwidthCharacterWidth;\n        this._lineCursorWidth = Math.min(options.get(30 /* EditorOption.cursorWidth */), this._typicalHalfwidthCharacterWidth);\n        applyFontInfo(this._domNode, fontInfo);\n        return true;\n    }\n    onCursorPositionChanged(position, pauseAnimation) {\n        if (pauseAnimation) {\n            this._domNode.domNode.style.transitionProperty = 'none';\n        }\n        else {\n            this._domNode.domNode.style.transitionProperty = '';\n        }\n        this._position = position;\n        return true;\n    }\n    /**\n     * If `this._position` is inside a grapheme, returns the position where the grapheme starts.\n     * Also returns the next grapheme.\n     */\n    _getGraphemeAwarePosition() {\n        const { lineNumber, column } = this._position;\n        const lineContent = this._context.viewModel.getLineContent(lineNumber);\n        const [startOffset, endOffset] = strings.getCharContainingOffset(lineContent, column - 1);\n        return [new Position(lineNumber, startOffset + 1), lineContent.substring(startOffset, endOffset)];\n    }\n    _prepareRender(ctx) {\n        let textContent = '';\n        let textContentClassName = '';\n        const [position, nextGrapheme] = this._getGraphemeAwarePosition();\n        if (this._cursorStyle === TextEditorCursorStyle.Line || this._cursorStyle === TextEditorCursorStyle.LineThin) {\n            const visibleRange = ctx.visibleRangeForPosition(position);\n            if (!visibleRange || visibleRange.outsideRenderedLine) {\n                // Outside viewport\n                return null;\n            }\n            let width;\n            if (this._cursorStyle === TextEditorCursorStyle.Line) {\n                width = dom.computeScreenAwareSize(this._lineCursorWidth > 0 ? this._lineCursorWidth : 2);\n                if (width > 2) {\n                    textContent = nextGrapheme;\n                    textContentClassName = this._getTokenClassName(position);\n                }\n            }\n            else {\n                width = dom.computeScreenAwareSize(1);\n            }\n            let left = visibleRange.left;\n            let paddingLeft = 0;\n            if (width >= 2 && left >= 1) {\n                // shift the cursor a bit between the characters\n                paddingLeft = 1;\n                left -= paddingLeft;\n            }\n            const top = ctx.getVerticalOffsetForLineNumber(position.lineNumber) - ctx.bigNumbersDelta;\n            return new ViewCursorRenderData(top, left, paddingLeft, width, this._lineHeight, textContent, textContentClassName);\n        }\n        const visibleRangeForCharacter = ctx.linesVisibleRangesForRange(new Range(position.lineNumber, position.column, position.lineNumber, position.column + nextGrapheme.length), false);\n        if (!visibleRangeForCharacter || visibleRangeForCharacter.length === 0) {\n            // Outside viewport\n            return null;\n        }\n        const firstVisibleRangeForCharacter = visibleRangeForCharacter[0];\n        if (firstVisibleRangeForCharacter.outsideRenderedLine || firstVisibleRangeForCharacter.ranges.length === 0) {\n            // Outside viewport\n            return null;\n        }\n        const range = firstVisibleRangeForCharacter.ranges[0];\n        const width = (nextGrapheme === '\\t'\n            ? this._typicalHalfwidthCharacterWidth\n            : (range.width < 1\n                ? this._typicalHalfwidthCharacterWidth\n                : range.width));\n        if (this._cursorStyle === TextEditorCursorStyle.Block) {\n            textContent = nextGrapheme;\n            textContentClassName = this._getTokenClassName(position);\n        }\n        let top = ctx.getVerticalOffsetForLineNumber(position.lineNumber) - ctx.bigNumbersDelta;\n        let height = this._lineHeight;\n        // Underline might interfere with clicking\n        if (this._cursorStyle === TextEditorCursorStyle.Underline || this._cursorStyle === TextEditorCursorStyle.UnderlineThin) {\n            top += this._lineHeight - 2;\n            height = 2;\n        }\n        return new ViewCursorRenderData(top, range.left, 0, width, height, textContent, textContentClassName);\n    }\n    _getTokenClassName(position) {\n        const lineData = this._context.viewModel.getViewLineData(position.lineNumber);\n        const tokenIndex = lineData.tokens.findTokenIndexAtOffset(position.column - 1);\n        return lineData.tokens.getClassName(tokenIndex);\n    }\n    prepareRender(ctx) {\n        this._renderData = this._prepareRender(ctx);\n    }\n    render(ctx) {\n        if (!this._renderData) {\n            this._domNode.setDisplay('none');\n            return null;\n        }\n        if (this._lastRenderedContent !== this._renderData.textContent) {\n            this._lastRenderedContent = this._renderData.textContent;\n            this._domNode.domNode.textContent = this._lastRenderedContent;\n        }\n        this._domNode.setClassName(`cursor ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME} ${this._renderData.textContentClassName}`);\n        this._domNode.setDisplay('block');\n        this._domNode.setTop(this._renderData.top);\n        this._domNode.setLeft(this._renderData.left);\n        this._domNode.setPaddingLeft(this._renderData.paddingLeft);\n        this._domNode.setWidth(this._renderData.width);\n        this._domNode.setLineHeight(this._renderData.height);\n        this._domNode.setHeight(this._renderData.height);\n        return {\n            domNode: this._domNode.domNode,\n            position: this._position,\n            contentLeft: this._renderData.left,\n            height: this._renderData.height,\n            width: 2\n        };\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './viewCursors.css';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { IntervalTimer, TimeoutTimer } from '../../../../base/common/async.js';\nimport { ViewPart } from '../../view/viewPart.js';\nimport { ViewCursor } from './viewCursor.js';\nimport { TextEditorCursorStyle } from '../../../common/config/editorOptions.js';\nimport { editorCursorBackground, editorCursorForeground } from '../../../common/core/editorColorRegistry.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nexport class ViewCursors extends ViewPart {\n    constructor(context) {\n        super(context);\n        const options = this._context.configuration.options;\n        this._readOnly = options.get(89 /* EditorOption.readOnly */);\n        this._cursorBlinking = options.get(25 /* EditorOption.cursorBlinking */);\n        this._cursorStyle = options.get(27 /* EditorOption.cursorStyle */);\n        this._cursorSmoothCaretAnimation = options.get(26 /* EditorOption.cursorSmoothCaretAnimation */);\n        this._selectionIsEmpty = true;\n        this._isComposingInput = false;\n        this._isVisible = false;\n        this._primaryCursor = new ViewCursor(this._context);\n        this._secondaryCursors = [];\n        this._renderData = [];\n        this._domNode = createFastDomNode(document.createElement('div'));\n        this._domNode.setAttribute('role', 'presentation');\n        this._domNode.setAttribute('aria-hidden', 'true');\n        this._updateDomClassName();\n        this._domNode.appendChild(this._primaryCursor.getDomNode());\n        this._startCursorBlinkAnimation = new TimeoutTimer();\n        this._cursorFlatBlinkInterval = new IntervalTimer();\n        this._blinkingEnabled = false;\n        this._editorHasFocus = false;\n        this._updateBlinking();\n    }\n    dispose() {\n        super.dispose();\n        this._startCursorBlinkAnimation.dispose();\n        this._cursorFlatBlinkInterval.dispose();\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    // --- begin event handlers\n    onCompositionStart(e) {\n        this._isComposingInput = true;\n        this._updateBlinking();\n        return true;\n    }\n    onCompositionEnd(e) {\n        this._isComposingInput = false;\n        this._updateBlinking();\n        return true;\n    }\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        this._readOnly = options.get(89 /* EditorOption.readOnly */);\n        this._cursorBlinking = options.get(25 /* EditorOption.cursorBlinking */);\n        this._cursorStyle = options.get(27 /* EditorOption.cursorStyle */);\n        this._cursorSmoothCaretAnimation = options.get(26 /* EditorOption.cursorSmoothCaretAnimation */);\n        this._updateBlinking();\n        this._updateDomClassName();\n        this._primaryCursor.onConfigurationChanged(e);\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n            this._secondaryCursors[i].onConfigurationChanged(e);\n        }\n        return true;\n    }\n    _onCursorPositionChanged(position, secondaryPositions, reason) {\n        const pauseAnimation = (this._secondaryCursors.length !== secondaryPositions.length\n            || (this._cursorSmoothCaretAnimation === 'explicit' && reason !== 3 /* CursorChangeReason.Explicit */));\n        this._primaryCursor.onCursorPositionChanged(position, pauseAnimation);\n        this._updateBlinking();\n        if (this._secondaryCursors.length < secondaryPositions.length) {\n            // Create new cursors\n            const addCnt = secondaryPositions.length - this._secondaryCursors.length;\n            for (let i = 0; i < addCnt; i++) {\n                const newCursor = new ViewCursor(this._context);\n                this._domNode.domNode.insertBefore(newCursor.getDomNode().domNode, this._primaryCursor.getDomNode().domNode.nextSibling);\n                this._secondaryCursors.push(newCursor);\n            }\n        }\n        else if (this._secondaryCursors.length > secondaryPositions.length) {\n            // Remove some cursors\n            const removeCnt = this._secondaryCursors.length - secondaryPositions.length;\n            for (let i = 0; i < removeCnt; i++) {\n                this._domNode.removeChild(this._secondaryCursors[0].getDomNode());\n                this._secondaryCursors.splice(0, 1);\n            }\n        }\n        for (let i = 0; i < secondaryPositions.length; i++) {\n            this._secondaryCursors[i].onCursorPositionChanged(secondaryPositions[i], pauseAnimation);\n        }\n    }\n    onCursorStateChanged(e) {\n        const positions = [];\n        for (let i = 0, len = e.selections.length; i < len; i++) {\n            positions[i] = e.selections[i].getPosition();\n        }\n        this._onCursorPositionChanged(positions[0], positions.slice(1), e.reason);\n        const selectionIsEmpty = e.selections[0].isEmpty();\n        if (this._selectionIsEmpty !== selectionIsEmpty) {\n            this._selectionIsEmpty = selectionIsEmpty;\n            this._updateDomClassName();\n        }\n        return true;\n    }\n    onDecorationsChanged(e) {\n        // true for inline decorations that can end up relayouting text\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onFocusChanged(e) {\n        this._editorHasFocus = e.isFocused;\n        this._updateBlinking();\n        return false;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return true;\n    }\n    onTokensChanged(e) {\n        const shouldRender = (position) => {\n            for (let i = 0, len = e.ranges.length; i < len; i++) {\n                if (e.ranges[i].fromLineNumber <= position.lineNumber && position.lineNumber <= e.ranges[i].toLineNumber) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        if (shouldRender(this._primaryCursor.getPosition())) {\n            return true;\n        }\n        for (const secondaryCursor of this._secondaryCursors) {\n            if (shouldRender(secondaryCursor.getPosition())) {\n                return true;\n            }\n        }\n        return false;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    // ---- blinking logic\n    _getCursorBlinking() {\n        if (this._isComposingInput) {\n            // avoid double cursors\n            return 0 /* TextEditorCursorBlinkingStyle.Hidden */;\n        }\n        if (!this._editorHasFocus) {\n            return 0 /* TextEditorCursorBlinkingStyle.Hidden */;\n        }\n        if (this._readOnly) {\n            return 5 /* TextEditorCursorBlinkingStyle.Solid */;\n        }\n        return this._cursorBlinking;\n    }\n    _updateBlinking() {\n        this._startCursorBlinkAnimation.cancel();\n        this._cursorFlatBlinkInterval.cancel();\n        const blinkingStyle = this._getCursorBlinking();\n        // hidden and solid are special as they involve no animations\n        const isHidden = (blinkingStyle === 0 /* TextEditorCursorBlinkingStyle.Hidden */);\n        const isSolid = (blinkingStyle === 5 /* TextEditorCursorBlinkingStyle.Solid */);\n        if (isHidden) {\n            this._hide();\n        }\n        else {\n            this._show();\n        }\n        this._blinkingEnabled = false;\n        this._updateDomClassName();\n        if (!isHidden && !isSolid) {\n            if (blinkingStyle === 1 /* TextEditorCursorBlinkingStyle.Blink */) {\n                // flat blinking is handled by JavaScript to save battery life due to Chromium step timing issue https://bugs.chromium.org/p/chromium/issues/detail?id=361587\n                this._cursorFlatBlinkInterval.cancelAndSet(() => {\n                    if (this._isVisible) {\n                        this._hide();\n                    }\n                    else {\n                        this._show();\n                    }\n                }, ViewCursors.BLINK_INTERVAL);\n            }\n            else {\n                this._startCursorBlinkAnimation.setIfNotSet(() => {\n                    this._blinkingEnabled = true;\n                    this._updateDomClassName();\n                }, ViewCursors.BLINK_INTERVAL);\n            }\n        }\n    }\n    // --- end blinking logic\n    _updateDomClassName() {\n        this._domNode.setClassName(this._getClassName());\n    }\n    _getClassName() {\n        let result = 'cursors-layer';\n        if (!this._selectionIsEmpty) {\n            result += ' has-selection';\n        }\n        switch (this._cursorStyle) {\n            case TextEditorCursorStyle.Line:\n                result += ' cursor-line-style';\n                break;\n            case TextEditorCursorStyle.Block:\n                result += ' cursor-block-style';\n                break;\n            case TextEditorCursorStyle.Underline:\n                result += ' cursor-underline-style';\n                break;\n            case TextEditorCursorStyle.LineThin:\n                result += ' cursor-line-thin-style';\n                break;\n            case TextEditorCursorStyle.BlockOutline:\n                result += ' cursor-block-outline-style';\n                break;\n            case TextEditorCursorStyle.UnderlineThin:\n                result += ' cursor-underline-thin-style';\n                break;\n            default:\n                result += ' cursor-line-style';\n        }\n        if (this._blinkingEnabled) {\n            switch (this._getCursorBlinking()) {\n                case 1 /* TextEditorCursorBlinkingStyle.Blink */:\n                    result += ' cursor-blink';\n                    break;\n                case 2 /* TextEditorCursorBlinkingStyle.Smooth */:\n                    result += ' cursor-smooth';\n                    break;\n                case 3 /* TextEditorCursorBlinkingStyle.Phase */:\n                    result += ' cursor-phase';\n                    break;\n                case 4 /* TextEditorCursorBlinkingStyle.Expand */:\n                    result += ' cursor-expand';\n                    break;\n                case 5 /* TextEditorCursorBlinkingStyle.Solid */:\n                    result += ' cursor-solid';\n                    break;\n                default:\n                    result += ' cursor-solid';\n            }\n        }\n        else {\n            result += ' cursor-solid';\n        }\n        if (this._cursorSmoothCaretAnimation === 'on' || this._cursorSmoothCaretAnimation === 'explicit') {\n            result += ' cursor-smooth-caret-animation';\n        }\n        return result;\n    }\n    _show() {\n        this._primaryCursor.show();\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n            this._secondaryCursors[i].show();\n        }\n        this._isVisible = true;\n    }\n    _hide() {\n        this._primaryCursor.hide();\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n            this._secondaryCursors[i].hide();\n        }\n        this._isVisible = false;\n    }\n    // ---- IViewPart implementation\n    prepareRender(ctx) {\n        this._primaryCursor.prepareRender(ctx);\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n            this._secondaryCursors[i].prepareRender(ctx);\n        }\n    }\n    render(ctx) {\n        const renderData = [];\n        let renderDataLen = 0;\n        const primaryRenderData = this._primaryCursor.render(ctx);\n        if (primaryRenderData) {\n            renderData[renderDataLen++] = primaryRenderData;\n        }\n        for (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n            const secondaryRenderData = this._secondaryCursors[i].render(ctx);\n            if (secondaryRenderData) {\n                renderData[renderDataLen++] = secondaryRenderData;\n            }\n        }\n        this._renderData = renderData;\n    }\n    getLastRenderData() {\n        return this._renderData;\n    }\n}\nViewCursors.BLINK_INTERVAL = 500;\nregisterThemingParticipant((theme, collector) => {\n    const caret = theme.getColor(editorCursorForeground);\n    if (caret) {\n        let caretBackground = theme.getColor(editorCursorBackground);\n        if (!caretBackground) {\n            caretBackground = caret.opposite();\n        }\n        collector.addRule(`.monaco-editor .cursors-layer .cursor { background-color: ${caret}; border-color: ${caret}; color: ${caretBackground}; }`);\n        if (isHighContrast(theme.type)) {\n            collector.addRule(`.monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid ${caretBackground}; border-right: 1px solid ${caretBackground}; }`);\n        }\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { ViewPart } from '../../view/viewPart.js';\nimport { Position } from '../../../common/core/position.js';\nconst invalidFunc = () => { throw new Error(`Invalid change accessor`); };\nexport class ViewZones extends ViewPart {\n    constructor(context) {\n        super(context);\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._contentWidth = layoutInfo.contentWidth;\n        this._contentLeft = layoutInfo.contentLeft;\n        this.domNode = createFastDomNode(document.createElement('div'));\n        this.domNode.setClassName('view-zones');\n        this.domNode.setPosition('absolute');\n        this.domNode.setAttribute('role', 'presentation');\n        this.domNode.setAttribute('aria-hidden', 'true');\n        this.marginDomNode = createFastDomNode(document.createElement('div'));\n        this.marginDomNode.setClassName('margin-view-zones');\n        this.marginDomNode.setPosition('absolute');\n        this.marginDomNode.setAttribute('role', 'presentation');\n        this.marginDomNode.setAttribute('aria-hidden', 'true');\n        this._zones = {};\n    }\n    dispose() {\n        super.dispose();\n        this._zones = {};\n    }\n    // ---- begin view event handlers\n    _recomputeWhitespacesProps() {\n        const whitespaces = this._context.viewLayout.getWhitespaces();\n        const oldWhitespaces = new Map();\n        for (const whitespace of whitespaces) {\n            oldWhitespaces.set(whitespace.id, whitespace);\n        }\n        let hadAChange = false;\n        this._context.viewModel.changeWhitespace((whitespaceAccessor) => {\n            const keys = Object.keys(this._zones);\n            for (let i = 0, len = keys.length; i < len; i++) {\n                const id = keys[i];\n                const zone = this._zones[id];\n                const props = this._computeWhitespaceProps(zone.delegate);\n                zone.isInHiddenArea = props.isInHiddenArea;\n                const oldWhitespace = oldWhitespaces.get(id);\n                if (oldWhitespace && (oldWhitespace.afterLineNumber !== props.afterViewLineNumber || oldWhitespace.height !== props.heightInPx)) {\n                    whitespaceAccessor.changeOneWhitespace(id, props.afterViewLineNumber, props.heightInPx);\n                    this._safeCallOnComputedHeight(zone.delegate, props.heightInPx);\n                    hadAChange = true;\n                }\n            }\n        });\n        return hadAChange;\n    }\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this._contentWidth = layoutInfo.contentWidth;\n        this._contentLeft = layoutInfo.contentLeft;\n        if (e.hasChanged(65 /* EditorOption.lineHeight */)) {\n            this._recomputeWhitespacesProps();\n        }\n        return true;\n    }\n    onLineMappingChanged(e) {\n        return this._recomputeWhitespacesProps();\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged || e.scrollWidthChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    // ---- end view event handlers\n    _getZoneOrdinal(zone) {\n        var _a, _b;\n        return (_b = (_a = zone.ordinal) !== null && _a !== void 0 ? _a : zone.afterColumn) !== null && _b !== void 0 ? _b : 10000;\n    }\n    _computeWhitespaceProps(zone) {\n        if (zone.afterLineNumber === 0) {\n            return {\n                isInHiddenArea: false,\n                afterViewLineNumber: 0,\n                heightInPx: this._heightInPixels(zone),\n                minWidthInPx: this._minWidthInPixels(zone)\n            };\n        }\n        let zoneAfterModelPosition;\n        if (typeof zone.afterColumn !== 'undefined') {\n            zoneAfterModelPosition = this._context.viewModel.model.validatePosition({\n                lineNumber: zone.afterLineNumber,\n                column: zone.afterColumn\n            });\n        }\n        else {\n            const validAfterLineNumber = this._context.viewModel.model.validatePosition({\n                lineNumber: zone.afterLineNumber,\n                column: 1\n            }).lineNumber;\n            zoneAfterModelPosition = new Position(validAfterLineNumber, this._context.viewModel.model.getLineMaxColumn(validAfterLineNumber));\n        }\n        let zoneBeforeModelPosition;\n        if (zoneAfterModelPosition.column === this._context.viewModel.model.getLineMaxColumn(zoneAfterModelPosition.lineNumber)) {\n            zoneBeforeModelPosition = this._context.viewModel.model.validatePosition({\n                lineNumber: zoneAfterModelPosition.lineNumber + 1,\n                column: 1\n            });\n        }\n        else {\n            zoneBeforeModelPosition = this._context.viewModel.model.validatePosition({\n                lineNumber: zoneAfterModelPosition.lineNumber,\n                column: zoneAfterModelPosition.column + 1\n            });\n        }\n        const viewPosition = this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(zoneAfterModelPosition, zone.afterColumnAffinity, true);\n        const isVisible = zone.showInHiddenAreas || this._context.viewModel.coordinatesConverter.modelPositionIsVisible(zoneBeforeModelPosition);\n        return {\n            isInHiddenArea: !isVisible,\n            afterViewLineNumber: viewPosition.lineNumber,\n            heightInPx: (isVisible ? this._heightInPixels(zone) : 0),\n            minWidthInPx: this._minWidthInPixels(zone)\n        };\n    }\n    changeViewZones(callback) {\n        let zonesHaveChanged = false;\n        this._context.viewModel.changeWhitespace((whitespaceAccessor) => {\n            const changeAccessor = {\n                addZone: (zone) => {\n                    zonesHaveChanged = true;\n                    return this._addZone(whitespaceAccessor, zone);\n                },\n                removeZone: (id) => {\n                    if (!id) {\n                        return;\n                    }\n                    zonesHaveChanged = this._removeZone(whitespaceAccessor, id) || zonesHaveChanged;\n                },\n                layoutZone: (id) => {\n                    if (!id) {\n                        return;\n                    }\n                    zonesHaveChanged = this._layoutZone(whitespaceAccessor, id) || zonesHaveChanged;\n                }\n            };\n            safeInvoke1Arg(callback, changeAccessor);\n            // Invalidate changeAccessor\n            changeAccessor.addZone = invalidFunc;\n            changeAccessor.removeZone = invalidFunc;\n            changeAccessor.layoutZone = invalidFunc;\n        });\n        return zonesHaveChanged;\n    }\n    _addZone(whitespaceAccessor, zone) {\n        const props = this._computeWhitespaceProps(zone);\n        const whitespaceId = whitespaceAccessor.insertWhitespace(props.afterViewLineNumber, this._getZoneOrdinal(zone), props.heightInPx, props.minWidthInPx);\n        const myZone = {\n            whitespaceId: whitespaceId,\n            delegate: zone,\n            isInHiddenArea: props.isInHiddenArea,\n            isVisible: false,\n            domNode: createFastDomNode(zone.domNode),\n            marginDomNode: zone.marginDomNode ? createFastDomNode(zone.marginDomNode) : null\n        };\n        this._safeCallOnComputedHeight(myZone.delegate, props.heightInPx);\n        myZone.domNode.setPosition('absolute');\n        myZone.domNode.domNode.style.width = '100%';\n        myZone.domNode.setDisplay('none');\n        myZone.domNode.setAttribute('monaco-view-zone', myZone.whitespaceId);\n        this.domNode.appendChild(myZone.domNode);\n        if (myZone.marginDomNode) {\n            myZone.marginDomNode.setPosition('absolute');\n            myZone.marginDomNode.domNode.style.width = '100%';\n            myZone.marginDomNode.setDisplay('none');\n            myZone.marginDomNode.setAttribute('monaco-view-zone', myZone.whitespaceId);\n            this.marginDomNode.appendChild(myZone.marginDomNode);\n        }\n        this._zones[myZone.whitespaceId] = myZone;\n        this.setShouldRender();\n        return myZone.whitespaceId;\n    }\n    _removeZone(whitespaceAccessor, id) {\n        if (this._zones.hasOwnProperty(id)) {\n            const zone = this._zones[id];\n            delete this._zones[id];\n            whitespaceAccessor.removeWhitespace(zone.whitespaceId);\n            zone.domNode.removeAttribute('monaco-visible-view-zone');\n            zone.domNode.removeAttribute('monaco-view-zone');\n            zone.domNode.domNode.parentNode.removeChild(zone.domNode.domNode);\n            if (zone.marginDomNode) {\n                zone.marginDomNode.removeAttribute('monaco-visible-view-zone');\n                zone.marginDomNode.removeAttribute('monaco-view-zone');\n                zone.marginDomNode.domNode.parentNode.removeChild(zone.marginDomNode.domNode);\n            }\n            this.setShouldRender();\n            return true;\n        }\n        return false;\n    }\n    _layoutZone(whitespaceAccessor, id) {\n        if (this._zones.hasOwnProperty(id)) {\n            const zone = this._zones[id];\n            const props = this._computeWhitespaceProps(zone.delegate);\n            zone.isInHiddenArea = props.isInHiddenArea;\n            // const newOrdinal = this._getZoneOrdinal(zone.delegate);\n            whitespaceAccessor.changeOneWhitespace(zone.whitespaceId, props.afterViewLineNumber, props.heightInPx);\n            // TODO@Alex: change `newOrdinal` too\n            this._safeCallOnComputedHeight(zone.delegate, props.heightInPx);\n            this.setShouldRender();\n            return true;\n        }\n        return false;\n    }\n    shouldSuppressMouseDownOnViewZone(id) {\n        if (this._zones.hasOwnProperty(id)) {\n            const zone = this._zones[id];\n            return Boolean(zone.delegate.suppressMouseDown);\n        }\n        return false;\n    }\n    _heightInPixels(zone) {\n        if (typeof zone.heightInPx === 'number') {\n            return zone.heightInPx;\n        }\n        if (typeof zone.heightInLines === 'number') {\n            return this._lineHeight * zone.heightInLines;\n        }\n        return this._lineHeight;\n    }\n    _minWidthInPixels(zone) {\n        if (typeof zone.minWidthInPx === 'number') {\n            return zone.minWidthInPx;\n        }\n        return 0;\n    }\n    _safeCallOnComputedHeight(zone, height) {\n        if (typeof zone.onComputedHeight === 'function') {\n            try {\n                zone.onComputedHeight(height);\n            }\n            catch (e) {\n                onUnexpectedError(e);\n            }\n        }\n    }\n    _safeCallOnDomNodeTop(zone, top) {\n        if (typeof zone.onDomNodeTop === 'function') {\n            try {\n                zone.onDomNodeTop(top);\n            }\n            catch (e) {\n                onUnexpectedError(e);\n            }\n        }\n    }\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    render(ctx) {\n        const visibleWhitespaces = ctx.viewportData.whitespaceViewportData;\n        const visibleZones = {};\n        let hasVisibleZone = false;\n        for (const visibleWhitespace of visibleWhitespaces) {\n            if (this._zones[visibleWhitespace.id].isInHiddenArea) {\n                continue;\n            }\n            visibleZones[visibleWhitespace.id] = visibleWhitespace;\n            hasVisibleZone = true;\n        }\n        const keys = Object.keys(this._zones);\n        for (let i = 0, len = keys.length; i < len; i++) {\n            const id = keys[i];\n            const zone = this._zones[id];\n            let newTop = 0;\n            let newHeight = 0;\n            let newDisplay = 'none';\n            if (visibleZones.hasOwnProperty(id)) {\n                newTop = visibleZones[id].verticalOffset - ctx.bigNumbersDelta;\n                newHeight = visibleZones[id].height;\n                newDisplay = 'block';\n                // zone is visible\n                if (!zone.isVisible) {\n                    zone.domNode.setAttribute('monaco-visible-view-zone', 'true');\n                    zone.isVisible = true;\n                }\n                this._safeCallOnDomNodeTop(zone.delegate, ctx.getScrolledTopFromAbsoluteTop(visibleZones[id].verticalOffset));\n            }\n            else {\n                if (zone.isVisible) {\n                    zone.domNode.removeAttribute('monaco-visible-view-zone');\n                    zone.isVisible = false;\n                }\n                this._safeCallOnDomNodeTop(zone.delegate, ctx.getScrolledTopFromAbsoluteTop(-1000000));\n            }\n            zone.domNode.setTop(newTop);\n            zone.domNode.setHeight(newHeight);\n            zone.domNode.setDisplay(newDisplay);\n            if (zone.marginDomNode) {\n                zone.marginDomNode.setTop(newTop);\n                zone.marginDomNode.setHeight(newHeight);\n                zone.marginDomNode.setDisplay(newDisplay);\n            }\n        }\n        if (hasVisibleZone) {\n            this.domNode.setWidth(Math.max(ctx.scrollWidth, this._contentWidth));\n            this.marginDomNode.setWidth(this._contentLeft);\n        }\n    }\n}\nfunction safeInvoke1Arg(func, arg1) {\n    try {\n        return func(arg1);\n    }\n    catch (e) {\n        onUnexpectedError(e);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport './blockDecorations.css';\nimport { ViewPart } from '../../view/viewPart.js';\nexport class BlockDecorations extends ViewPart {\n    constructor(context) {\n        super(context);\n        this.blocks = [];\n        this.contentWidth = -1;\n        this.contentLeft = 0;\n        this.domNode = createFastDomNode(document.createElement('div'));\n        this.domNode.setAttribute('role', 'presentation');\n        this.domNode.setAttribute('aria-hidden', 'true');\n        this.domNode.setClassName('blockDecorations-container');\n        this.update();\n    }\n    update() {\n        let didChange = false;\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        const newContentWidth = layoutInfo.contentWidth - layoutInfo.verticalScrollbarWidth;\n        if (this.contentWidth !== newContentWidth) {\n            this.contentWidth = newContentWidth;\n            didChange = true;\n        }\n        const newContentLeft = layoutInfo.contentLeft;\n        if (this.contentLeft !== newContentLeft) {\n            this.contentLeft = newContentLeft;\n            didChange = true;\n        }\n        return didChange;\n    }\n    dispose() {\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        return this.update();\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged || e.scrollLeftChanged;\n    }\n    onDecorationsChanged(e) {\n        return true;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    render(ctx) {\n        var _a;\n        let count = 0;\n        const decorations = ctx.getDecorationsInViewport();\n        for (const decoration of decorations) {\n            if (!decoration.options.blockClassName) {\n                continue;\n            }\n            let block = this.blocks[count];\n            if (!block) {\n                block = this.blocks[count] = createFastDomNode(document.createElement('div'));\n                this.domNode.appendChild(block);\n            }\n            let top;\n            let bottom;\n            if (decoration.options.blockIsAfterEnd) {\n                // range must be empty\n                top = ctx.getVerticalOffsetAfterLineNumber(decoration.range.endLineNumber, false);\n                bottom = ctx.getVerticalOffsetAfterLineNumber(decoration.range.endLineNumber, true);\n            }\n            else {\n                top = ctx.getVerticalOffsetForLineNumber(decoration.range.startLineNumber, true);\n                bottom = decoration.range.isEmpty() && !decoration.options.blockDoesNotCollapse\n                    ? ctx.getVerticalOffsetForLineNumber(decoration.range.startLineNumber, false)\n                    : ctx.getVerticalOffsetAfterLineNumber(decoration.range.endLineNumber, true);\n            }\n            const [paddingTop, paddingRight, paddingBottom, paddingLeft] = (_a = decoration.options.blockPadding) !== null && _a !== void 0 ? _a : [0, 0, 0, 0];\n            block.setClassName('blockDecorations-block ' + decoration.options.blockClassName);\n            block.setLeft(this.contentLeft - paddingLeft);\n            block.setWidth(this.contentWidth + paddingLeft + paddingRight);\n            block.setTop(top - ctx.scrollTop - paddingTop);\n            block.setHeight(bottom - top + paddingTop + paddingBottom);\n            count++;\n        }\n        for (let i = count; i < this.blocks.length; i++) {\n            this.blocks[i].domNode.remove();\n        }\n        this.blocks.length = count;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './whitespace.css';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { LineRange } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { Position } from '../../../common/core/position.js';\nimport { editorWhitespaces } from '../../../common/core/editorColorRegistry.js';\nexport class WhitespaceOverlay extends DynamicViewOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        this._options = new WhitespaceOptions(this._context.configuration);\n        this._selection = [];\n        this._renderResult = null;\n        this._context.addEventHandler(this);\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const newOptions = new WhitespaceOptions(this._context.configuration);\n        if (this._options.equals(newOptions)) {\n            return e.hasChanged(142 /* EditorOption.layoutInfo */);\n        }\n        this._options = newOptions;\n        return true;\n    }\n    onCursorStateChanged(e) {\n        this._selection = e.selections;\n        if (this._options.renderWhitespace === 'selection') {\n            return true;\n        }\n        return false;\n    }\n    onDecorationsChanged(e) {\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        if (this._options.renderWhitespace === 'none') {\n            this._renderResult = null;\n            return;\n        }\n        const startLineNumber = ctx.visibleRange.startLineNumber;\n        const endLineNumber = ctx.visibleRange.endLineNumber;\n        const lineCount = endLineNumber - startLineNumber + 1;\n        const needed = new Array(lineCount);\n        for (let i = 0; i < lineCount; i++) {\n            needed[i] = true;\n        }\n        const viewportData = this._context.viewModel.getMinimapLinesRenderingData(ctx.viewportData.startLineNumber, ctx.viewportData.endLineNumber, needed);\n        this._renderResult = [];\n        for (let lineNumber = ctx.viewportData.startLineNumber; lineNumber <= ctx.viewportData.endLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - ctx.viewportData.startLineNumber;\n            const lineData = viewportData.data[lineIndex];\n            let selectionsOnLine = null;\n            if (this._options.renderWhitespace === 'selection') {\n                const selections = this._selection;\n                for (const selection of selections) {\n                    if (selection.endLineNumber < lineNumber || selection.startLineNumber > lineNumber) {\n                        // Selection does not intersect line\n                        continue;\n                    }\n                    const startColumn = (selection.startLineNumber === lineNumber ? selection.startColumn : lineData.minColumn);\n                    const endColumn = (selection.endLineNumber === lineNumber ? selection.endColumn : lineData.maxColumn);\n                    if (startColumn < endColumn) {\n                        if (!selectionsOnLine) {\n                            selectionsOnLine = [];\n                        }\n                        selectionsOnLine.push(new LineRange(startColumn - 1, endColumn - 1));\n                    }\n                }\n            }\n            this._renderResult[lineIndex] = this._applyRenderWhitespace(ctx, lineNumber, selectionsOnLine, lineData);\n        }\n    }\n    _applyRenderWhitespace(ctx, lineNumber, selections, lineData) {\n        if (this._options.renderWhitespace === 'selection' && !selections) {\n            return '';\n        }\n        if (this._options.renderWhitespace === 'trailing' && lineData.continuesWithWrappedLine) {\n            return '';\n        }\n        const color = this._context.theme.getColor(editorWhitespaces);\n        const USE_SVG = this._options.renderWithSVG;\n        const lineContent = lineData.content;\n        const len = (this._options.stopRenderingLineAfter === -1 ? lineContent.length : Math.min(this._options.stopRenderingLineAfter, lineContent.length));\n        const continuesWithWrappedLine = lineData.continuesWithWrappedLine;\n        const fauxIndentLength = lineData.minColumn - 1;\n        const onlyBoundary = (this._options.renderWhitespace === 'boundary');\n        const onlyTrailing = (this._options.renderWhitespace === 'trailing');\n        const lineHeight = this._options.lineHeight;\n        const middotWidth = this._options.middotWidth;\n        const wsmiddotWidth = this._options.wsmiddotWidth;\n        const spaceWidth = this._options.spaceWidth;\n        const wsmiddotDiff = Math.abs(wsmiddotWidth - spaceWidth);\n        const middotDiff = Math.abs(middotWidth - spaceWidth);\n        // U+2E31 - WORD SEPARATOR MIDDLE DOT\n        // U+00B7 - MIDDLE DOT\n        const renderSpaceCharCode = (wsmiddotDiff < middotDiff ? 0x2E31 : 0xB7);\n        const canUseHalfwidthRightwardsArrow = this._options.canUseHalfwidthRightwardsArrow;\n        let result = '';\n        let lineIsEmptyOrWhitespace = false;\n        let firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineContent);\n        let lastNonWhitespaceIndex;\n        if (firstNonWhitespaceIndex === -1) {\n            lineIsEmptyOrWhitespace = true;\n            firstNonWhitespaceIndex = len;\n            lastNonWhitespaceIndex = len;\n        }\n        else {\n            lastNonWhitespaceIndex = strings.lastNonWhitespaceIndex(lineContent);\n        }\n        let currentSelectionIndex = 0;\n        let currentSelection = selections && selections[currentSelectionIndex];\n        let maxLeft = 0;\n        for (let charIndex = fauxIndentLength; charIndex < len; charIndex++) {\n            const chCode = lineContent.charCodeAt(charIndex);\n            if (currentSelection && charIndex >= currentSelection.endOffset) {\n                currentSelectionIndex++;\n                currentSelection = selections && selections[currentSelectionIndex];\n            }\n            if (chCode !== 9 /* CharCode.Tab */ && chCode !== 32 /* CharCode.Space */) {\n                continue;\n            }\n            if (onlyTrailing && !lineIsEmptyOrWhitespace && charIndex <= lastNonWhitespaceIndex) {\n                // If rendering only trailing whitespace, check that the charIndex points to trailing whitespace.\n                continue;\n            }\n            if (onlyBoundary && charIndex >= firstNonWhitespaceIndex && charIndex <= lastNonWhitespaceIndex && chCode === 32 /* CharCode.Space */) {\n                // rendering only boundary whitespace\n                const prevChCode = (charIndex - 1 >= 0 ? lineContent.charCodeAt(charIndex - 1) : 0 /* CharCode.Null */);\n                const nextChCode = (charIndex + 1 < len ? lineContent.charCodeAt(charIndex + 1) : 0 /* CharCode.Null */);\n                if (prevChCode !== 32 /* CharCode.Space */ && nextChCode !== 32 /* CharCode.Space */) {\n                    continue;\n                }\n            }\n            if (onlyBoundary && continuesWithWrappedLine && charIndex === len - 1) {\n                const prevCharCode = (charIndex - 1 >= 0 ? lineContent.charCodeAt(charIndex - 1) : 0 /* CharCode.Null */);\n                const isSingleTrailingSpace = (chCode === 32 /* CharCode.Space */ && (prevCharCode !== 32 /* CharCode.Space */ && prevCharCode !== 9 /* CharCode.Tab */));\n                if (isSingleTrailingSpace) {\n                    continue;\n                }\n            }\n            if (selections && (!currentSelection || currentSelection.startOffset > charIndex || currentSelection.endOffset <= charIndex)) {\n                // If rendering whitespace on selection, check that the charIndex falls within a selection\n                continue;\n            }\n            const visibleRange = ctx.visibleRangeForPosition(new Position(lineNumber, charIndex + 1));\n            if (!visibleRange) {\n                continue;\n            }\n            if (USE_SVG) {\n                maxLeft = Math.max(maxLeft, visibleRange.left);\n                if (chCode === 9 /* CharCode.Tab */) {\n                    result += this._renderArrow(lineHeight, spaceWidth, visibleRange.left);\n                }\n                else {\n                    result += `<circle cx=\"${(visibleRange.left + spaceWidth / 2).toFixed(2)}\" cy=\"${(lineHeight / 2).toFixed(2)}\" r=\"${(spaceWidth / 7).toFixed(2)}\" />`;\n                }\n            }\n            else {\n                if (chCode === 9 /* CharCode.Tab */) {\n                    result += `<div class=\"mwh\" style=\"left:${visibleRange.left}px;height:${lineHeight}px;\">${canUseHalfwidthRightwardsArrow ? String.fromCharCode(0xFFEB) : String.fromCharCode(0x2192)}</div>`;\n                }\n                else {\n                    result += `<div class=\"mwh\" style=\"left:${visibleRange.left}px;height:${lineHeight}px;\">${String.fromCharCode(renderSpaceCharCode)}</div>`;\n                }\n            }\n        }\n        if (USE_SVG) {\n            maxLeft = Math.round(maxLeft + spaceWidth);\n            return (`<svg style=\"position:absolute;width:${maxLeft}px;height:${lineHeight}px\" viewBox=\"0 0 ${maxLeft} ${lineHeight}\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"${color}\">`\n                + result\n                + `</svg>`);\n        }\n        return result;\n    }\n    _renderArrow(lineHeight, spaceWidth, left) {\n        const strokeWidth = spaceWidth / 7;\n        const width = spaceWidth;\n        const dy = lineHeight / 2;\n        const dx = left;\n        const p1 = { x: 0, y: strokeWidth / 2 };\n        const p2 = { x: 100 / 125 * width, y: p1.y };\n        const p3 = { x: p2.x - 0.2 * p2.x, y: p2.y + 0.2 * p2.x };\n        const p4 = { x: p3.x + 0.1 * p2.x, y: p3.y + 0.1 * p2.x };\n        const p5 = { x: p4.x + 0.35 * p2.x, y: p4.y - 0.35 * p2.x };\n        const p6 = { x: p5.x, y: -p5.y };\n        const p7 = { x: p4.x, y: -p4.y };\n        const p8 = { x: p3.x, y: -p3.y };\n        const p9 = { x: p2.x, y: -p2.y };\n        const p10 = { x: p1.x, y: -p1.y };\n        const p = [p1, p2, p3, p4, p5, p6, p7, p8, p9, p10];\n        const parts = p.map((p) => `${(dx + p.x).toFixed(2)} ${(dy + p.y).toFixed(2)}`).join(' L ');\n        return `<path d=\"M ${parts}\" />`;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\n            return '';\n        }\n        return this._renderResult[lineIndex];\n    }\n}\nclass WhitespaceOptions {\n    constructor(config) {\n        const options = config.options;\n        const fontInfo = options.get(49 /* EditorOption.fontInfo */);\n        const experimentalWhitespaceRendering = options.get(37 /* EditorOption.experimentalWhitespaceRendering */);\n        if (experimentalWhitespaceRendering === 'off') {\n            // whitespace is rendered in the view line\n            this.renderWhitespace = 'none';\n            this.renderWithSVG = false;\n        }\n        else if (experimentalWhitespaceRendering === 'svg') {\n            this.renderWhitespace = options.get(97 /* EditorOption.renderWhitespace */);\n            this.renderWithSVG = true;\n        }\n        else {\n            this.renderWhitespace = options.get(97 /* EditorOption.renderWhitespace */);\n            this.renderWithSVG = false;\n        }\n        this.spaceWidth = fontInfo.spaceWidth;\n        this.middotWidth = fontInfo.middotWidth;\n        this.wsmiddotWidth = fontInfo.wsmiddotWidth;\n        this.canUseHalfwidthRightwardsArrow = fontInfo.canUseHalfwidthRightwardsArrow;\n        this.lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this.stopRenderingLineAfter = options.get(115 /* EditorOption.stopRenderingLineAfter */);\n    }\n    equals(other) {\n        return (this.renderWhitespace === other.renderWhitespace\n            && this.renderWithSVG === other.renderWithSVG\n            && this.spaceWidth === other.spaceWidth\n            && this.middotWidth === other.middotWidth\n            && this.wsmiddotWidth === other.wsmiddotWidth\n            && this.canUseHalfwidthRightwardsArrow === other.canUseHalfwidthRightwardsArrow\n            && this.lineHeight === other.lineHeight\n            && this.stopRenderingLineAfter === other.stopRenderingLineAfter);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../base/browser/dom.js';\nimport { Selection } from '../common/core/selection.js';\nimport { Range } from '../common/core/range.js';\nimport { createFastDomNode } from '../../base/browser/fastDomNode.js';\nimport { onUnexpectedError } from '../../base/common/errors.js';\nimport { PointerHandler } from './controller/pointerHandler.js';\nimport { TextAreaHandler } from './controller/textAreaHandler.js';\nimport { ViewController } from './view/viewController.js';\nimport { ViewUserInputEvents } from './view/viewUserInputEvents.js';\nimport { ContentViewOverlays, MarginViewOverlays } from './view/viewOverlays.js';\nimport { PartFingerprints } from './view/viewPart.js';\nimport { ViewContentWidgets } from './viewParts/contentWidgets/contentWidgets.js';\nimport { CurrentLineHighlightOverlay, CurrentLineMarginHighlightOverlay } from './viewParts/currentLineHighlight/currentLineHighlight.js';\nimport { DecorationsOverlay } from './viewParts/decorations/decorations.js';\nimport { EditorScrollbar } from './viewParts/editorScrollbar/editorScrollbar.js';\nimport { IndentGuidesOverlay } from './viewParts/indentGuides/indentGuides.js';\nimport { LineNumbersOverlay } from './viewParts/lineNumbers/lineNumbers.js';\nimport { ViewLines } from './viewParts/lines/viewLines.js';\nimport { LinesDecorationsOverlay } from './viewParts/linesDecorations/linesDecorations.js';\nimport { Margin } from './viewParts/margin/margin.js';\nimport { MarginViewLineDecorationsOverlay } from './viewParts/marginDecorations/marginDecorations.js';\nimport { Minimap } from './viewParts/minimap/minimap.js';\nimport { ViewOverlayWidgets } from './viewParts/overlayWidgets/overlayWidgets.js';\nimport { DecorationsOverviewRuler } from './viewParts/overviewRuler/decorationsOverviewRuler.js';\nimport { OverviewRuler } from './viewParts/overviewRuler/overviewRuler.js';\nimport { Rulers } from './viewParts/rulers/rulers.js';\nimport { ScrollDecorationViewPart } from './viewParts/scrollDecoration/scrollDecoration.js';\nimport { SelectionsOverlay } from './viewParts/selections/selections.js';\nimport { ViewCursors } from './viewParts/viewCursors/viewCursors.js';\nimport { ViewZones } from './viewParts/viewZones/viewZones.js';\nimport { Position } from '../common/core/position.js';\nimport { RenderingContext } from './view/renderingContext.js';\nimport { ViewContext } from '../common/viewModel/viewContext.js';\nimport { ViewportData } from '../common/viewLayout/viewLinesViewportData.js';\nimport { ViewEventHandler } from '../common/viewEventHandler.js';\nimport { getThemeTypeSelector } from '../../platform/theme/common/themeService.js';\nimport { PointerHandlerLastRenderData } from './controller/mouseTarget.js';\nimport { BlockDecorations } from './viewParts/blockDecorations/blockDecorations.js';\nimport { inputLatency } from '../../base/browser/performance.js';\nimport { WhitespaceOverlay } from './viewParts/whitespace/whitespace.js';\nimport { GlyphMarginWidgets } from './viewParts/glyphMargin/glyphMargin.js';\nimport { GlyphMarginLane } from '../common/model.js';\nimport { IInstantiationService } from '../../platform/instantiation/common/instantiation.js';\nlet View = class View extends ViewEventHandler {\n    constructor(commandDelegate, configuration, colorTheme, model, userInputEvents, overflowWidgetsDomNode, _instantiationService) {\n        super();\n        this._instantiationService = _instantiationService;\n        // Actual mutable state\n        this._shouldRecomputeGlyphMarginLanes = false;\n        this._selections = [new Selection(1, 1, 1, 1)];\n        this._renderAnimationFrame = null;\n        const viewController = new ViewController(configuration, model, userInputEvents, commandDelegate);\n        // The view context is passed on to most classes (basically to reduce param. counts in ctors)\n        this._context = new ViewContext(configuration, colorTheme, model);\n        // Ensure the view is the first event handler in order to update the layout\n        this._context.addEventHandler(this);\n        this._viewParts = [];\n        // Keyboard handler\n        this._textAreaHandler = this._instantiationService.createInstance(TextAreaHandler, this._context, viewController, this._createTextAreaHandlerHelper());\n        this._viewParts.push(this._textAreaHandler);\n        // These two dom nodes must be constructed up front, since references are needed in the layout provider (scrolling & co.)\n        this._linesContent = createFastDomNode(document.createElement('div'));\n        this._linesContent.setClassName('lines-content' + ' monaco-editor-background');\n        this._linesContent.setPosition('absolute');\n        this.domNode = createFastDomNode(document.createElement('div'));\n        this.domNode.setClassName(this._getEditorClassName());\n        // Set role 'code' for better screen reader support https://github.com/microsoft/vscode/issues/93438\n        this.domNode.setAttribute('role', 'code');\n        this._overflowGuardContainer = createFastDomNode(document.createElement('div'));\n        PartFingerprints.write(this._overflowGuardContainer, 3 /* PartFingerprint.OverflowGuard */);\n        this._overflowGuardContainer.setClassName('overflow-guard');\n        this._scrollbar = new EditorScrollbar(this._context, this._linesContent, this.domNode, this._overflowGuardContainer);\n        this._viewParts.push(this._scrollbar);\n        // View Lines\n        this._viewLines = new ViewLines(this._context, this._linesContent);\n        // View Zones\n        this._viewZones = new ViewZones(this._context);\n        this._viewParts.push(this._viewZones);\n        // Decorations overview ruler\n        const decorationsOverviewRuler = new DecorationsOverviewRuler(this._context);\n        this._viewParts.push(decorationsOverviewRuler);\n        const scrollDecoration = new ScrollDecorationViewPart(this._context);\n        this._viewParts.push(scrollDecoration);\n        const contentViewOverlays = new ContentViewOverlays(this._context);\n        this._viewParts.push(contentViewOverlays);\n        contentViewOverlays.addDynamicOverlay(new CurrentLineHighlightOverlay(this._context));\n        contentViewOverlays.addDynamicOverlay(new SelectionsOverlay(this._context));\n        contentViewOverlays.addDynamicOverlay(new IndentGuidesOverlay(this._context));\n        contentViewOverlays.addDynamicOverlay(new DecorationsOverlay(this._context));\n        contentViewOverlays.addDynamicOverlay(new WhitespaceOverlay(this._context));\n        const marginViewOverlays = new MarginViewOverlays(this._context);\n        this._viewParts.push(marginViewOverlays);\n        marginViewOverlays.addDynamicOverlay(new CurrentLineMarginHighlightOverlay(this._context));\n        marginViewOverlays.addDynamicOverlay(new MarginViewLineDecorationsOverlay(this._context));\n        marginViewOverlays.addDynamicOverlay(new LinesDecorationsOverlay(this._context));\n        marginViewOverlays.addDynamicOverlay(new LineNumbersOverlay(this._context));\n        // Glyph margin widgets\n        this._glyphMarginWidgets = new GlyphMarginWidgets(this._context);\n        this._viewParts.push(this._glyphMarginWidgets);\n        const margin = new Margin(this._context);\n        margin.getDomNode().appendChild(this._viewZones.marginDomNode);\n        margin.getDomNode().appendChild(marginViewOverlays.getDomNode());\n        margin.getDomNode().appendChild(this._glyphMarginWidgets.domNode);\n        this._viewParts.push(margin);\n        // Content widgets\n        this._contentWidgets = new ViewContentWidgets(this._context, this.domNode);\n        this._viewParts.push(this._contentWidgets);\n        this._viewCursors = new ViewCursors(this._context);\n        this._viewParts.push(this._viewCursors);\n        // Overlay widgets\n        this._overlayWidgets = new ViewOverlayWidgets(this._context);\n        this._viewParts.push(this._overlayWidgets);\n        const rulers = new Rulers(this._context);\n        this._viewParts.push(rulers);\n        const blockOutline = new BlockDecorations(this._context);\n        this._viewParts.push(blockOutline);\n        const minimap = new Minimap(this._context);\n        this._viewParts.push(minimap);\n        // -------------- Wire dom nodes up\n        if (decorationsOverviewRuler) {\n            const overviewRulerData = this._scrollbar.getOverviewRulerLayoutInfo();\n            overviewRulerData.parent.insertBefore(decorationsOverviewRuler.getDomNode(), overviewRulerData.insertBefore);\n        }\n        this._linesContent.appendChild(contentViewOverlays.getDomNode());\n        this._linesContent.appendChild(rulers.domNode);\n        this._linesContent.appendChild(this._viewZones.domNode);\n        this._linesContent.appendChild(this._viewLines.getDomNode());\n        this._linesContent.appendChild(this._contentWidgets.domNode);\n        this._linesContent.appendChild(this._viewCursors.getDomNode());\n        this._overflowGuardContainer.appendChild(margin.getDomNode());\n        this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode());\n        this._overflowGuardContainer.appendChild(scrollDecoration.getDomNode());\n        this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea);\n        this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover);\n        this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode());\n        this._overflowGuardContainer.appendChild(minimap.getDomNode());\n        this._overflowGuardContainer.appendChild(blockOutline.domNode);\n        this.domNode.appendChild(this._overflowGuardContainer);\n        if (overflowWidgetsDomNode) {\n            overflowWidgetsDomNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode);\n        }\n        else {\n            this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode);\n        }\n        this._applyLayout();\n        // Pointer handler\n        this._pointerHandler = this._register(new PointerHandler(this._context, viewController, this._createPointerHandlerHelper()));\n    }\n    _flushAccumulatedAndRenderNow() {\n        if (this._shouldRecomputeGlyphMarginLanes) {\n            this._shouldRecomputeGlyphMarginLanes = false;\n            this._context.configuration.setGlyphMarginDecorationLaneCount(this._computeGlyphMarginLaneCount());\n        }\n        inputLatency.onRenderStart();\n        this._renderNow();\n    }\n    _computeGlyphMarginLaneCount() {\n        const model = this._context.viewModel.model;\n        let glyphs = [];\n        // Add all margin decorations\n        glyphs = glyphs.concat(model.getAllMarginDecorations().map((decoration) => {\n            var _a, _b;\n            const lane = (_b = (_a = decoration.options.glyphMargin) === null || _a === void 0 ? void 0 : _a.position) !== null && _b !== void 0 ? _b : GlyphMarginLane.Left;\n            return { range: decoration.range, lane };\n        }));\n        // Add all glyph margin widgets\n        glyphs = glyphs.concat(this._glyphMarginWidgets.getWidgets().map((widget) => {\n            const range = model.validateRange(widget.preference.range);\n            return { range, lane: widget.preference.lane };\n        }));\n        // Sorted by their start position\n        glyphs.sort((a, b) => Range.compareRangesUsingStarts(a.range, b.range));\n        let leftDecRange = null;\n        let rightDecRange = null;\n        for (const decoration of glyphs) {\n            if (decoration.lane === GlyphMarginLane.Left && (!leftDecRange || Range.compareRangesUsingEnds(leftDecRange, decoration.range) < 0)) {\n                // assign only if the range of `decoration` ends after, which means it has a higher chance to overlap with the other lane\n                leftDecRange = decoration.range;\n            }\n            if (decoration.lane === GlyphMarginLane.Right && (!rightDecRange || Range.compareRangesUsingEnds(rightDecRange, decoration.range) < 0)) {\n                // assign only if the range of `decoration` ends after, which means it has a higher chance to overlap with the other lane\n                rightDecRange = decoration.range;\n            }\n            if (leftDecRange && rightDecRange) {\n                if (leftDecRange.endLineNumber < rightDecRange.startLineNumber) {\n                    // there's no chance for `leftDecRange` to ever intersect something going further\n                    leftDecRange = null;\n                    continue;\n                }\n                if (rightDecRange.endLineNumber < leftDecRange.startLineNumber) {\n                    // there's no chance for `rightDecRange` to ever intersect something going further\n                    rightDecRange = null;\n                    continue;\n                }\n                // leftDecRange and rightDecRange are intersecting or touching => we need two lanes\n                return 2;\n            }\n        }\n        return 1;\n    }\n    _createPointerHandlerHelper() {\n        return {\n            viewDomNode: this.domNode.domNode,\n            linesContentDomNode: this._linesContent.domNode,\n            viewLinesDomNode: this._viewLines.getDomNode().domNode,\n            focusTextArea: () => {\n                this.focus();\n            },\n            dispatchTextAreaEvent: (event) => {\n                this._textAreaHandler.textArea.domNode.dispatchEvent(event);\n            },\n            getLastRenderData: () => {\n                const lastViewCursorsRenderData = this._viewCursors.getLastRenderData() || [];\n                const lastTextareaPosition = this._textAreaHandler.getLastRenderData();\n                return new PointerHandlerLastRenderData(lastViewCursorsRenderData, lastTextareaPosition);\n            },\n            renderNow: () => {\n                this.render(true, false);\n            },\n            shouldSuppressMouseDownOnViewZone: (viewZoneId) => {\n                return this._viewZones.shouldSuppressMouseDownOnViewZone(viewZoneId);\n            },\n            shouldSuppressMouseDownOnWidget: (widgetId) => {\n                return this._contentWidgets.shouldSuppressMouseDownOnWidget(widgetId);\n            },\n            getPositionFromDOMInfo: (spanNode, offset) => {\n                this._flushAccumulatedAndRenderNow();\n                return this._viewLines.getPositionFromDOMInfo(spanNode, offset);\n            },\n            visibleRangeForPosition: (lineNumber, column) => {\n                this._flushAccumulatedAndRenderNow();\n                return this._viewLines.visibleRangeForPosition(new Position(lineNumber, column));\n            },\n            getLineWidth: (lineNumber) => {\n                this._flushAccumulatedAndRenderNow();\n                return this._viewLines.getLineWidth(lineNumber);\n            }\n        };\n    }\n    _createTextAreaHandlerHelper() {\n        return {\n            visibleRangeForPosition: (position) => {\n                this._flushAccumulatedAndRenderNow();\n                return this._viewLines.visibleRangeForPosition(position);\n            }\n        };\n    }\n    _applyLayout() {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this.domNode.setWidth(layoutInfo.width);\n        this.domNode.setHeight(layoutInfo.height);\n        this._overflowGuardContainer.setWidth(layoutInfo.width);\n        this._overflowGuardContainer.setHeight(layoutInfo.height);\n        this._linesContent.setWidth(1000000);\n        this._linesContent.setHeight(1000000);\n    }\n    _getEditorClassName() {\n        const focused = this._textAreaHandler.isFocused() ? ' focused' : '';\n        return this._context.configuration.options.get(139 /* EditorOption.editorClassName */) + ' ' + getThemeTypeSelector(this._context.theme.type) + focused;\n    }\n    // --- begin event handlers\n    handleEvents(events) {\n        super.handleEvents(events);\n        this._scheduleRender();\n    }\n    onConfigurationChanged(e) {\n        this.domNode.setClassName(this._getEditorClassName());\n        this._applyLayout();\n        return false;\n    }\n    onCursorStateChanged(e) {\n        this._selections = e.selections;\n        return false;\n    }\n    onDecorationsChanged(e) {\n        if (e.affectsGlyphMargin) {\n            this._shouldRecomputeGlyphMarginLanes = true;\n        }\n        return false;\n    }\n    onFocusChanged(e) {\n        this.domNode.setClassName(this._getEditorClassName());\n        return false;\n    }\n    onThemeChanged(e) {\n        this._context.theme.update(e.theme);\n        this.domNode.setClassName(this._getEditorClassName());\n        return false;\n    }\n    // --- end event handlers\n    dispose() {\n        if (this._renderAnimationFrame !== null) {\n            this._renderAnimationFrame.dispose();\n            this._renderAnimationFrame = null;\n        }\n        this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove();\n        this._context.removeEventHandler(this);\n        this._viewLines.dispose();\n        // Destroy view parts\n        for (const viewPart of this._viewParts) {\n            viewPart.dispose();\n        }\n        super.dispose();\n    }\n    _scheduleRender() {\n        if (this._renderAnimationFrame === null) {\n            this._renderAnimationFrame = dom.runAtThisOrScheduleAtNextAnimationFrame(this._onRenderScheduled.bind(this), 100);\n        }\n    }\n    _onRenderScheduled() {\n        this._renderAnimationFrame = null;\n        this._flushAccumulatedAndRenderNow();\n    }\n    _renderNow() {\n        safeInvokeNoArg(() => this._actualRender());\n    }\n    _getViewPartsToRender() {\n        const result = [];\n        let resultLen = 0;\n        for (const viewPart of this._viewParts) {\n            if (viewPart.shouldRender()) {\n                result[resultLen++] = viewPart;\n            }\n        }\n        return result;\n    }\n    _actualRender() {\n        if (!dom.isInDOM(this.domNode.domNode)) {\n            return;\n        }\n        let viewPartsToRender = this._getViewPartsToRender();\n        if (!this._viewLines.shouldRender() && viewPartsToRender.length === 0) {\n            // Nothing to render\n            return;\n        }\n        const partialViewportData = this._context.viewLayout.getLinesViewportData();\n        this._context.viewModel.setViewport(partialViewportData.startLineNumber, partialViewportData.endLineNumber, partialViewportData.centeredLineNumber);\n        const viewportData = new ViewportData(this._selections, partialViewportData, this._context.viewLayout.getWhitespaceViewportData(), this._context.viewModel);\n        if (this._contentWidgets.shouldRender()) {\n            // Give the content widgets a chance to set their max width before a possible synchronous layout\n            this._contentWidgets.onBeforeRender(viewportData);\n        }\n        if (this._viewLines.shouldRender()) {\n            this._viewLines.renderText(viewportData);\n            this._viewLines.onDidRender();\n            // Rendering of viewLines might cause scroll events to occur, so collect view parts to render again\n            viewPartsToRender = this._getViewPartsToRender();\n        }\n        const renderingContext = new RenderingContext(this._context.viewLayout, viewportData, this._viewLines);\n        // Render the rest of the parts\n        for (const viewPart of viewPartsToRender) {\n            viewPart.prepareRender(renderingContext);\n        }\n        for (const viewPart of viewPartsToRender) {\n            viewPart.render(renderingContext);\n            viewPart.onDidRender();\n        }\n    }\n    // --- BEGIN CodeEditor helpers\n    delegateVerticalScrollbarPointerDown(browserEvent) {\n        this._scrollbar.delegateVerticalScrollbarPointerDown(browserEvent);\n    }\n    delegateScrollFromMouseWheelEvent(browserEvent) {\n        this._scrollbar.delegateScrollFromMouseWheelEvent(browserEvent);\n    }\n    restoreState(scrollPosition) {\n        this._context.viewModel.viewLayout.setScrollPosition({\n            scrollTop: scrollPosition.scrollTop,\n            scrollLeft: scrollPosition.scrollLeft\n        }, 1 /* ScrollType.Immediate */);\n        this._context.viewModel.visibleLinesStabilized();\n    }\n    getOffsetForColumn(modelLineNumber, modelColumn) {\n        const modelPosition = this._context.viewModel.model.validatePosition({\n            lineNumber: modelLineNumber,\n            column: modelColumn\n        });\n        const viewPosition = this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(modelPosition);\n        this._flushAccumulatedAndRenderNow();\n        const visibleRange = this._viewLines.visibleRangeForPosition(new Position(viewPosition.lineNumber, viewPosition.column));\n        if (!visibleRange) {\n            return -1;\n        }\n        return visibleRange.left;\n    }\n    getTargetAtClientPoint(clientX, clientY) {\n        const mouseTarget = this._pointerHandler.getTargetAtClientPoint(clientX, clientY);\n        if (!mouseTarget) {\n            return null;\n        }\n        return ViewUserInputEvents.convertViewToModelMouseTarget(mouseTarget, this._context.viewModel.coordinatesConverter);\n    }\n    createOverviewRuler(cssClassName) {\n        return new OverviewRuler(this._context, cssClassName);\n    }\n    change(callback) {\n        this._viewZones.changeViewZones(callback);\n        this._scheduleRender();\n    }\n    render(now, everything) {\n        if (everything) {\n            // Force everything to render...\n            this._viewLines.forceShouldRender();\n            for (const viewPart of this._viewParts) {\n                viewPart.forceShouldRender();\n            }\n        }\n        if (now) {\n            this._flushAccumulatedAndRenderNow();\n        }\n        else {\n            this._scheduleRender();\n        }\n    }\n    writeScreenReaderContent(reason) {\n        this._textAreaHandler.writeScreenReaderContent(reason);\n    }\n    focus() {\n        this._textAreaHandler.focusTextArea();\n    }\n    isFocused() {\n        return this._textAreaHandler.isFocused();\n    }\n    setAriaOptions(options) {\n        this._textAreaHandler.setAriaOptions(options);\n    }\n    addContentWidget(widgetData) {\n        this._contentWidgets.addWidget(widgetData.widget);\n        this.layoutContentWidget(widgetData);\n        this._scheduleRender();\n    }\n    layoutContentWidget(widgetData) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        this._contentWidgets.setWidgetPosition(widgetData.widget, (_b = (_a = widgetData.position) === null || _a === void 0 ? void 0 : _a.position) !== null && _b !== void 0 ? _b : null, (_d = (_c = widgetData.position) === null || _c === void 0 ? void 0 : _c.secondaryPosition) !== null && _d !== void 0 ? _d : null, (_f = (_e = widgetData.position) === null || _e === void 0 ? void 0 : _e.preference) !== null && _f !== void 0 ? _f : null, (_h = (_g = widgetData.position) === null || _g === void 0 ? void 0 : _g.positionAffinity) !== null && _h !== void 0 ? _h : null);\n        this._scheduleRender();\n    }\n    removeContentWidget(widgetData) {\n        this._contentWidgets.removeWidget(widgetData.widget);\n        this._scheduleRender();\n    }\n    addOverlayWidget(widgetData) {\n        this._overlayWidgets.addWidget(widgetData.widget);\n        this.layoutOverlayWidget(widgetData);\n        this._scheduleRender();\n    }\n    layoutOverlayWidget(widgetData) {\n        const newPreference = widgetData.position ? widgetData.position.preference : null;\n        const shouldRender = this._overlayWidgets.setWidgetPosition(widgetData.widget, newPreference);\n        if (shouldRender) {\n            this._scheduleRender();\n        }\n    }\n    removeOverlayWidget(widgetData) {\n        this._overlayWidgets.removeWidget(widgetData.widget);\n        this._scheduleRender();\n    }\n    addGlyphMarginWidget(widgetData) {\n        this._glyphMarginWidgets.addWidget(widgetData.widget);\n        this._shouldRecomputeGlyphMarginLanes = true;\n        this._scheduleRender();\n    }\n    layoutGlyphMarginWidget(widgetData) {\n        const newPreference = widgetData.position;\n        const shouldRender = this._glyphMarginWidgets.setWidgetPosition(widgetData.widget, newPreference);\n        if (shouldRender) {\n            this._shouldRecomputeGlyphMarginLanes = true;\n            this._scheduleRender();\n        }\n    }\n    removeGlyphMarginWidget(widgetData) {\n        this._glyphMarginWidgets.removeWidget(widgetData.widget);\n        this._shouldRecomputeGlyphMarginLanes = true;\n        this._scheduleRender();\n    }\n};\nView = __decorate([\n    __param(6, IInstantiationService)\n], View);\nexport { View };\nfunction safeInvokeNoArg(func) {\n    try {\n        return func();\n    }\n    catch (e) {\n        onUnexpectedError(e);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { createTrustedTypesPolicy } from '../../../base/browser/trustedTypes.js';\nimport * as strings from '../../../base/common/strings.js';\nimport { applyFontInfo } from '../config/domFontInfo.js';\nimport { StringBuilder } from '../../common/core/stringBuilder.js';\nimport { ModelLineProjectionData } from '../../common/modelLineProjectionData.js';\nimport { LineInjectedText } from '../../common/textModelEvents.js';\nconst ttPolicy = createTrustedTypesPolicy('domLineBreaksComputer', { createHTML: value => value });\nexport class DOMLineBreaksComputerFactory {\n    static create() {\n        return new DOMLineBreaksComputerFactory();\n    }\n    constructor() {\n    }\n    createLineBreaksComputer(fontInfo, tabSize, wrappingColumn, wrappingIndent, wordBreak) {\n        const requests = [];\n        const injectedTexts = [];\n        return {\n            addRequest: (lineText, injectedText, previousLineBreakData) => {\n                requests.push(lineText);\n                injectedTexts.push(injectedText);\n            },\n            finalize: () => {\n                return createLineBreaks(requests, fontInfo, tabSize, wrappingColumn, wrappingIndent, wordBreak, injectedTexts);\n            }\n        };\n    }\n}\nfunction createLineBreaks(requests, fontInfo, tabSize, firstLineBreakColumn, wrappingIndent, wordBreak, injectedTextsPerLine) {\n    var _a;\n    function createEmptyLineBreakWithPossiblyInjectedText(requestIdx) {\n        const injectedTexts = injectedTextsPerLine[requestIdx];\n        if (injectedTexts) {\n            const lineText = LineInjectedText.applyInjectedText(requests[requestIdx], injectedTexts);\n            const injectionOptions = injectedTexts.map(t => t.options);\n            const injectionOffsets = injectedTexts.map(text => text.column - 1);\n            // creating a `LineBreakData` with an invalid `breakOffsetsVisibleColumn` is OK\n            // because `breakOffsetsVisibleColumn` will never be used because it contains injected text\n            return new ModelLineProjectionData(injectionOffsets, injectionOptions, [lineText.length], [], 0);\n        }\n        else {\n            return null;\n        }\n    }\n    if (firstLineBreakColumn === -1) {\n        const result = [];\n        for (let i = 0, len = requests.length; i < len; i++) {\n            result[i] = createEmptyLineBreakWithPossiblyInjectedText(i);\n        }\n        return result;\n    }\n    const overallWidth = Math.round(firstLineBreakColumn * fontInfo.typicalHalfwidthCharacterWidth);\n    const additionalIndent = (wrappingIndent === 3 /* WrappingIndent.DeepIndent */ ? 2 : wrappingIndent === 2 /* WrappingIndent.Indent */ ? 1 : 0);\n    const additionalIndentSize = Math.round(tabSize * additionalIndent);\n    const additionalIndentLength = Math.ceil(fontInfo.spaceWidth * additionalIndentSize);\n    const containerDomNode = document.createElement('div');\n    applyFontInfo(containerDomNode, fontInfo);\n    const sb = new StringBuilder(10000);\n    const firstNonWhitespaceIndices = [];\n    const wrappedTextIndentLengths = [];\n    const renderLineContents = [];\n    const allCharOffsets = [];\n    const allVisibleColumns = [];\n    for (let i = 0; i < requests.length; i++) {\n        const lineContent = LineInjectedText.applyInjectedText(requests[i], injectedTextsPerLine[i]);\n        let firstNonWhitespaceIndex = 0;\n        let wrappedTextIndentLength = 0;\n        let width = overallWidth;\n        if (wrappingIndent !== 0 /* WrappingIndent.None */) {\n            firstNonWhitespaceIndex = strings.firstNonWhitespaceIndex(lineContent);\n            if (firstNonWhitespaceIndex === -1) {\n                // all whitespace line\n                firstNonWhitespaceIndex = 0;\n            }\n            else {\n                // Track existing indent\n                for (let i = 0; i < firstNonWhitespaceIndex; i++) {\n                    const charWidth = (lineContent.charCodeAt(i) === 9 /* CharCode.Tab */\n                        ? (tabSize - (wrappedTextIndentLength % tabSize))\n                        : 1);\n                    wrappedTextIndentLength += charWidth;\n                }\n                const indentWidth = Math.ceil(fontInfo.spaceWidth * wrappedTextIndentLength);\n                // Force sticking to beginning of line if no character would fit except for the indentation\n                if (indentWidth + fontInfo.typicalFullwidthCharacterWidth > overallWidth) {\n                    firstNonWhitespaceIndex = 0;\n                    wrappedTextIndentLength = 0;\n                }\n                else {\n                    width = overallWidth - indentWidth;\n                }\n            }\n        }\n        const renderLineContent = lineContent.substr(firstNonWhitespaceIndex);\n        const tmp = renderLine(renderLineContent, wrappedTextIndentLength, tabSize, width, sb, additionalIndentLength);\n        firstNonWhitespaceIndices[i] = firstNonWhitespaceIndex;\n        wrappedTextIndentLengths[i] = wrappedTextIndentLength;\n        renderLineContents[i] = renderLineContent;\n        allCharOffsets[i] = tmp[0];\n        allVisibleColumns[i] = tmp[1];\n    }\n    const html = sb.build();\n    const trustedhtml = (_a = ttPolicy === null || ttPolicy === void 0 ? void 0 : ttPolicy.createHTML(html)) !== null && _a !== void 0 ? _a : html;\n    containerDomNode.innerHTML = trustedhtml;\n    containerDomNode.style.position = 'absolute';\n    containerDomNode.style.top = '10000';\n    if (wordBreak === 'keepAll') {\n        // word-break: keep-all; overflow-wrap: anywhere\n        containerDomNode.style.wordBreak = 'keep-all';\n        containerDomNode.style.overflowWrap = 'anywhere';\n    }\n    else {\n        // overflow-wrap: break-word\n        containerDomNode.style.wordBreak = 'inherit';\n        containerDomNode.style.overflowWrap = 'break-word';\n    }\n    document.body.appendChild(containerDomNode);\n    const range = document.createRange();\n    const lineDomNodes = Array.prototype.slice.call(containerDomNode.children, 0);\n    const result = [];\n    for (let i = 0; i < requests.length; i++) {\n        const lineDomNode = lineDomNodes[i];\n        const breakOffsets = readLineBreaks(range, lineDomNode, renderLineContents[i], allCharOffsets[i]);\n        if (breakOffsets === null) {\n            result[i] = createEmptyLineBreakWithPossiblyInjectedText(i);\n            continue;\n        }\n        const firstNonWhitespaceIndex = firstNonWhitespaceIndices[i];\n        const wrappedTextIndentLength = wrappedTextIndentLengths[i] + additionalIndentSize;\n        const visibleColumns = allVisibleColumns[i];\n        const breakOffsetsVisibleColumn = [];\n        for (let j = 0, len = breakOffsets.length; j < len; j++) {\n            breakOffsetsVisibleColumn[j] = visibleColumns[breakOffsets[j]];\n        }\n        if (firstNonWhitespaceIndex !== 0) {\n            // All break offsets are relative to the renderLineContent, make them absolute again\n            for (let j = 0, len = breakOffsets.length; j < len; j++) {\n                breakOffsets[j] += firstNonWhitespaceIndex;\n            }\n        }\n        let injectionOptions;\n        let injectionOffsets;\n        const curInjectedTexts = injectedTextsPerLine[i];\n        if (curInjectedTexts) {\n            injectionOptions = curInjectedTexts.map(t => t.options);\n            injectionOffsets = curInjectedTexts.map(text => text.column - 1);\n        }\n        else {\n            injectionOptions = null;\n            injectionOffsets = null;\n        }\n        result[i] = new ModelLineProjectionData(injectionOffsets, injectionOptions, breakOffsets, breakOffsetsVisibleColumn, wrappedTextIndentLength);\n    }\n    document.body.removeChild(containerDomNode);\n    return result;\n}\nfunction renderLine(lineContent, initialVisibleColumn, tabSize, width, sb, wrappingIndentLength) {\n    if (wrappingIndentLength !== 0) {\n        const hangingOffset = String(wrappingIndentLength);\n        sb.appendString('<div style=\"text-indent: -');\n        sb.appendString(hangingOffset);\n        sb.appendString('px; padding-left: ');\n        sb.appendString(hangingOffset);\n        sb.appendString('px; box-sizing: border-box; width:');\n    }\n    else {\n        sb.appendString('<div style=\"width:');\n    }\n    sb.appendString(String(width));\n    sb.appendString('px;\">');\n    // if (containsRTL) {\n    // \tsb.appendASCIIString('\" dir=\"ltr');\n    // }\n    const len = lineContent.length;\n    let visibleColumn = initialVisibleColumn;\n    let charOffset = 0;\n    const charOffsets = [];\n    const visibleColumns = [];\n    let nextCharCode = (0 < len ? lineContent.charCodeAt(0) : 0 /* CharCode.Null */);\n    sb.appendString('<span>');\n    for (let charIndex = 0; charIndex < len; charIndex++) {\n        if (charIndex !== 0 && charIndex % 16384 /* Constants.SPAN_MODULO_LIMIT */ === 0) {\n            sb.appendString('</span><span>');\n        }\n        charOffsets[charIndex] = charOffset;\n        visibleColumns[charIndex] = visibleColumn;\n        const charCode = nextCharCode;\n        nextCharCode = (charIndex + 1 < len ? lineContent.charCodeAt(charIndex + 1) : 0 /* CharCode.Null */);\n        let producedCharacters = 1;\n        let charWidth = 1;\n        switch (charCode) {\n            case 9 /* CharCode.Tab */:\n                producedCharacters = (tabSize - (visibleColumn % tabSize));\n                charWidth = producedCharacters;\n                for (let space = 1; space <= producedCharacters; space++) {\n                    if (space < producedCharacters) {\n                        sb.appendCharCode(0xA0); // &nbsp;\n                    }\n                    else {\n                        sb.appendASCIICharCode(32 /* CharCode.Space */);\n                    }\n                }\n                break;\n            case 32 /* CharCode.Space */:\n                if (nextCharCode === 32 /* CharCode.Space */) {\n                    sb.appendCharCode(0xA0); // &nbsp;\n                }\n                else {\n                    sb.appendASCIICharCode(32 /* CharCode.Space */);\n                }\n                break;\n            case 60 /* CharCode.LessThan */:\n                sb.appendString('&lt;');\n                break;\n            case 62 /* CharCode.GreaterThan */:\n                sb.appendString('&gt;');\n                break;\n            case 38 /* CharCode.Ampersand */:\n                sb.appendString('&amp;');\n                break;\n            case 0 /* CharCode.Null */:\n                sb.appendString('&#00;');\n                break;\n            case 65279 /* CharCode.UTF8_BOM */:\n            case 8232 /* CharCode.LINE_SEPARATOR */:\n            case 8233 /* CharCode.PARAGRAPH_SEPARATOR */:\n            case 133 /* CharCode.NEXT_LINE */:\n                sb.appendCharCode(0xFFFD);\n                break;\n            default:\n                if (strings.isFullWidthCharacter(charCode)) {\n                    charWidth++;\n                }\n                if (charCode < 32) {\n                    sb.appendCharCode(9216 + charCode);\n                }\n                else {\n                    sb.appendCharCode(charCode);\n                }\n        }\n        charOffset += producedCharacters;\n        visibleColumn += charWidth;\n    }\n    sb.appendString('</span>');\n    charOffsets[lineContent.length] = charOffset;\n    visibleColumns[lineContent.length] = visibleColumn;\n    sb.appendString('</div>');\n    return [charOffsets, visibleColumns];\n}\nfunction readLineBreaks(range, lineDomNode, lineContent, charOffsets) {\n    if (lineContent.length <= 1) {\n        return null;\n    }\n    const spans = Array.prototype.slice.call(lineDomNode.children, 0);\n    const breakOffsets = [];\n    try {\n        discoverBreaks(range, spans, charOffsets, 0, null, lineContent.length - 1, null, breakOffsets);\n    }\n    catch (err) {\n        console.log(err);\n        return null;\n    }\n    if (breakOffsets.length === 0) {\n        return null;\n    }\n    breakOffsets.push(lineContent.length);\n    return breakOffsets;\n}\nfunction discoverBreaks(range, spans, charOffsets, low, lowRects, high, highRects, result) {\n    if (low === high) {\n        return;\n    }\n    lowRects = lowRects || readClientRect(range, spans, charOffsets[low], charOffsets[low + 1]);\n    highRects = highRects || readClientRect(range, spans, charOffsets[high], charOffsets[high + 1]);\n    if (Math.abs(lowRects[0].top - highRects[0].top) <= 0.1) {\n        // same line\n        return;\n    }\n    // there is at least one line break between these two offsets\n    if (low + 1 === high) {\n        // the two characters are adjacent, so the line break must be exactly between them\n        result.push(high);\n        return;\n    }\n    const mid = low + ((high - low) / 2) | 0;\n    const midRects = readClientRect(range, spans, charOffsets[mid], charOffsets[mid + 1]);\n    discoverBreaks(range, spans, charOffsets, low, lowRects, mid, midRects, result);\n    discoverBreaks(range, spans, charOffsets, mid, midRects, high, highRects, result);\n}\nfunction readClientRect(range, spans, startOffset, endOffset) {\n    range.setStart(spans[(startOffset / 16384 /* Constants.SPAN_MODULO_LIMIT */) | 0].firstChild, startOffset % 16384 /* Constants.SPAN_MODULO_LIMIT */);\n    range.setEnd(spans[(endOffset / 16384 /* Constants.SPAN_MODULO_LIMIT */) | 0].firstChild, endOffset % 16384 /* Constants.SPAN_MODULO_LIMIT */);\n    return range.getClientRects();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { ViewEventHandler } from '../../common/viewEventHandler.js';\nexport class DynamicViewOverlay extends ViewEventHandler {\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './lineNumbers.css';\nimport * as platform from '../../../../base/common/platform.js';\nimport { DynamicViewOverlay } from '../../view/dynamicViewOverlay.js';\nimport { Position } from '../../../common/core/position.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { editorDimmedLineNumber, editorLineNumbers } from '../../../common/core/editorColorRegistry.js';\nexport class LineNumbersOverlay extends DynamicViewOverlay {\n    constructor(context) {\n        super();\n        this._context = context;\n        this._readConfig();\n        this._lastCursorModelPosition = new Position(1, 1);\n        this._renderResult = null;\n        this._activeLineNumber = 1;\n        this._context.addEventHandler(this);\n    }\n    _readConfig() {\n        const options = this._context.configuration.options;\n        this._lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        const lineNumbers = options.get(66 /* EditorOption.lineNumbers */);\n        this._renderLineNumbers = lineNumbers.renderType;\n        this._renderCustomLineNumbers = lineNumbers.renderFn;\n        this._renderFinalNewline = options.get(93 /* EditorOption.renderFinalNewline */);\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._lineNumbersLeft = layoutInfo.lineNumbersLeft;\n        this._lineNumbersWidth = layoutInfo.lineNumbersWidth;\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        this._renderResult = null;\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        this._readConfig();\n        return true;\n    }\n    onCursorStateChanged(e) {\n        const primaryViewPosition = e.selections[0].getPosition();\n        this._lastCursorModelPosition = this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(primaryViewPosition);\n        let shouldRender = false;\n        if (this._activeLineNumber !== primaryViewPosition.lineNumber) {\n            this._activeLineNumber = primaryViewPosition.lineNumber;\n            shouldRender = true;\n        }\n        if (this._renderLineNumbers === 2 /* RenderLineNumbersType.Relative */ || this._renderLineNumbers === 3 /* RenderLineNumbersType.Interval */) {\n            shouldRender = true;\n        }\n        return shouldRender;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        return e.scrollTopChanged;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    _getLineRenderLineNumber(viewLineNumber) {\n        const modelPosition = this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new Position(viewLineNumber, 1));\n        if (modelPosition.column !== 1) {\n            return '';\n        }\n        const modelLineNumber = modelPosition.lineNumber;\n        if (this._renderCustomLineNumbers) {\n            return this._renderCustomLineNumbers(modelLineNumber);\n        }\n        if (this._renderLineNumbers === 2 /* RenderLineNumbersType.Relative */) {\n            const diff = Math.abs(this._lastCursorModelPosition.lineNumber - modelLineNumber);\n            if (diff === 0) {\n                return '<span class=\"relative-current-line-number\">' + modelLineNumber + '</span>';\n            }\n            return String(diff);\n        }\n        if (this._renderLineNumbers === 3 /* RenderLineNumbersType.Interval */) {\n            if (this._lastCursorModelPosition.lineNumber === modelLineNumber) {\n                return String(modelLineNumber);\n            }\n            if (modelLineNumber % 10 === 0) {\n                return String(modelLineNumber);\n            }\n            return '';\n        }\n        return String(modelLineNumber);\n    }\n    prepareRender(ctx) {\n        if (this._renderLineNumbers === 0 /* RenderLineNumbersType.Off */) {\n            this._renderResult = null;\n            return;\n        }\n        const lineHeightClassName = (platform.isLinux ? (this._lineHeight % 2 === 0 ? ' lh-even' : ' lh-odd') : '');\n        const visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n        const visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n        const lineCount = this._context.viewModel.getLineCount();\n        const output = [];\n        for (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n            const lineIndex = lineNumber - visibleStartLineNumber;\n            const renderLineNumber = this._getLineRenderLineNumber(lineNumber);\n            if (!renderLineNumber) {\n                output[lineIndex] = '';\n                continue;\n            }\n            let extraClassName = '';\n            if (lineNumber === lineCount && this._context.viewModel.getLineLength(lineNumber) === 0) {\n                // this is the last line\n                if (this._renderFinalNewline === 'off') {\n                    output[lineIndex] = '';\n                    continue;\n                }\n                if (this._renderFinalNewline === 'dimmed') {\n                    extraClassName = ' dimmed-line-number';\n                }\n            }\n            if (lineNumber === this._activeLineNumber) {\n                extraClassName = ' active-line-number';\n            }\n            output[lineIndex] = (`<div class=\"${LineNumbersOverlay.CLASS_NAME}${lineHeightClassName}${extraClassName}\" style=\"left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;\">${renderLineNumber}</div>`);\n        }\n        this._renderResult = output;\n    }\n    render(startLineNumber, lineNumber) {\n        if (!this._renderResult) {\n            return '';\n        }\n        const lineIndex = lineNumber - startLineNumber;\n        if (lineIndex < 0 || lineIndex >= this._renderResult.length) {\n            return '';\n        }\n        return this._renderResult[lineIndex];\n    }\n}\nLineNumbersOverlay.CLASS_NAME = 'line-numbers';\nregisterThemingParticipant((theme, collector) => {\n    const editorLineNumbersColor = theme.getColor(editorLineNumbers);\n    const editorDimmedLineNumberColor = theme.getColor(editorDimmedLineNumber);\n    if (editorDimmedLineNumberColor) {\n        collector.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${editorDimmedLineNumberColor}; }`);\n    }\n    else if (editorLineNumbersColor) {\n        collector.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${editorLineNumbersColor.transparent(0.4)}; }`);\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { FloatHorizontalRange } from '../../view/renderingContext.js';\nexport class RangeUtil {\n    static _createRange() {\n        if (!this._handyReadyRange) {\n            this._handyReadyRange = document.createRange();\n        }\n        return this._handyReadyRange;\n    }\n    static _detachRange(range, endNode) {\n        // Move range out of the span node, IE doesn't like having many ranges in\n        // the same spot and will act badly for lines containing dashes ('-')\n        range.selectNodeContents(endNode);\n    }\n    static _readClientRects(startElement, startOffset, endElement, endOffset, endNode) {\n        const range = this._createRange();\n        try {\n            range.setStart(startElement, startOffset);\n            range.setEnd(endElement, endOffset);\n            return range.getClientRects();\n        }\n        catch (e) {\n            // This is life ...\n            return null;\n        }\n        finally {\n            this._detachRange(range, endNode);\n        }\n    }\n    static _mergeAdjacentRanges(ranges) {\n        if (ranges.length === 1) {\n            // There is nothing to merge\n            return ranges;\n        }\n        ranges.sort(FloatHorizontalRange.compare);\n        const result = [];\n        let resultLen = 0;\n        let prev = ranges[0];\n        for (let i = 1, len = ranges.length; i < len; i++) {\n            const range = ranges[i];\n            if (prev.left + prev.width + 0.9 /* account for browser's rounding errors*/ >= range.left) {\n                prev.width = Math.max(prev.width, range.left + range.width - prev.left);\n            }\n            else {\n                result[resultLen++] = prev;\n                prev = range;\n            }\n        }\n        result[resultLen++] = prev;\n        return result;\n    }\n    static _createHorizontalRangesFromClientRects(clientRects, clientRectDeltaLeft, clientRectScale) {\n        if (!clientRects || clientRects.length === 0) {\n            return null;\n        }\n        // We go through FloatHorizontalRange because it has been observed in bi-di text\n        // that the clientRects are not coming in sorted from the browser\n        const result = [];\n        for (let i = 0, len = clientRects.length; i < len; i++) {\n            const clientRect = clientRects[i];\n            result[i] = new FloatHorizontalRange(Math.max(0, (clientRect.left - clientRectDeltaLeft) / clientRectScale), clientRect.width / clientRectScale);\n        }\n        return this._mergeAdjacentRanges(result);\n    }\n    static readHorizontalRanges(domNode, startChildIndex, startOffset, endChildIndex, endOffset, context) {\n        // Panic check\n        const min = 0;\n        const max = domNode.children.length - 1;\n        if (min > max) {\n            return null;\n        }\n        startChildIndex = Math.min(max, Math.max(min, startChildIndex));\n        endChildIndex = Math.min(max, Math.max(min, endChildIndex));\n        if (startChildIndex === endChildIndex && startOffset === endOffset && startOffset === 0 && !domNode.children[startChildIndex].firstChild) {\n            // We must find the position at the beginning of a <span>\n            // To cover cases of empty <span>s, avoid using a range and use the <span>'s bounding box\n            const clientRects = domNode.children[startChildIndex].getClientRects();\n            context.markDidDomLayout();\n            return this._createHorizontalRangesFromClientRects(clientRects, context.clientRectDeltaLeft, context.clientRectScale);\n        }\n        // If crossing over to a span only to select offset 0, then use the previous span's maximum offset\n        // Chrome is buggy and doesn't handle 0 offsets well sometimes.\n        if (startChildIndex !== endChildIndex) {\n            if (endChildIndex > 0 && endOffset === 0) {\n                endChildIndex--;\n                endOffset = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n            }\n        }\n        let startElement = domNode.children[startChildIndex].firstChild;\n        let endElement = domNode.children[endChildIndex].firstChild;\n        if (!startElement || !endElement) {\n            // When having an empty <span> (without any text content), try to move to the previous <span>\n            if (!startElement && startOffset === 0 && startChildIndex > 0) {\n                startElement = domNode.children[startChildIndex - 1].firstChild;\n                startOffset = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n            }\n            if (!endElement && endOffset === 0 && endChildIndex > 0) {\n                endElement = domNode.children[endChildIndex - 1].firstChild;\n                endOffset = 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */;\n            }\n        }\n        if (!startElement || !endElement) {\n            return null;\n        }\n        startOffset = Math.min(startElement.textContent.length, Math.max(0, startOffset));\n        endOffset = Math.min(endElement.textContent.length, Math.max(0, endOffset));\n        const clientRects = this._readClientRects(startElement, startOffset, endElement, endOffset, context.endNode);\n        context.markDidDomLayout();\n        return this._createHorizontalRangesFromClientRects(clientRects, context.clientRectDeltaLeft, context.clientRectScale);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as browser from '../../../../base/browser/browser.js';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport * as platform from '../../../../base/common/platform.js';\nimport { RangeUtil } from './rangeUtil.js';\nimport { FloatHorizontalRange, VisibleRanges } from '../../view/renderingContext.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { RenderLineInput, renderViewLine, LineRange, DomPosition } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { isHighContrast } from '../../../../platform/theme/common/theme.js';\nimport { EditorFontLigatures } from '../../../common/config/editorOptions.js';\nconst canUseFastRenderedViewLine = (function () {\n    if (platform.isNative) {\n        // In VSCode we know very well when the zoom level changes\n        return true;\n    }\n    if (platform.isLinux || browser.isFirefox || browser.isSafari) {\n        // On Linux, it appears that zooming affects char widths (in pixels), which is unexpected.\n        // --\n        // Even though we read character widths correctly, having read them at a specific zoom level\n        // does not mean they are the same at the current zoom level.\n        // --\n        // This could be improved if we ever figure out how to get an event when browsers zoom,\n        // but until then we have to stick with reading client rects.\n        // --\n        // The same has been observed with Firefox on Windows7\n        // --\n        // The same has been oversved with Safari\n        return false;\n    }\n    return true;\n})();\nlet monospaceAssumptionsAreValid = true;\nexport class ViewLineOptions {\n    constructor(config, themeType) {\n        this.themeType = themeType;\n        const options = config.options;\n        const fontInfo = options.get(49 /* EditorOption.fontInfo */);\n        const experimentalWhitespaceRendering = options.get(37 /* EditorOption.experimentalWhitespaceRendering */);\n        if (experimentalWhitespaceRendering === 'off') {\n            this.renderWhitespace = options.get(97 /* EditorOption.renderWhitespace */);\n        }\n        else {\n            // whitespace is rendered in a different layer\n            this.renderWhitespace = 'none';\n        }\n        this.renderControlCharacters = options.get(92 /* EditorOption.renderControlCharacters */);\n        this.spaceWidth = fontInfo.spaceWidth;\n        this.middotWidth = fontInfo.middotWidth;\n        this.wsmiddotWidth = fontInfo.wsmiddotWidth;\n        this.useMonospaceOptimizations = (fontInfo.isMonospace\n            && !options.get(32 /* EditorOption.disableMonospaceOptimizations */));\n        this.canUseHalfwidthRightwardsArrow = fontInfo.canUseHalfwidthRightwardsArrow;\n        this.lineHeight = options.get(65 /* EditorOption.lineHeight */);\n        this.stopRenderingLineAfter = options.get(115 /* EditorOption.stopRenderingLineAfter */);\n        this.fontLigatures = options.get(50 /* EditorOption.fontLigatures */);\n    }\n    equals(other) {\n        return (this.themeType === other.themeType\n            && this.renderWhitespace === other.renderWhitespace\n            && this.renderControlCharacters === other.renderControlCharacters\n            && this.spaceWidth === other.spaceWidth\n            && this.middotWidth === other.middotWidth\n            && this.wsmiddotWidth === other.wsmiddotWidth\n            && this.useMonospaceOptimizations === other.useMonospaceOptimizations\n            && this.canUseHalfwidthRightwardsArrow === other.canUseHalfwidthRightwardsArrow\n            && this.lineHeight === other.lineHeight\n            && this.stopRenderingLineAfter === other.stopRenderingLineAfter\n            && this.fontLigatures === other.fontLigatures);\n    }\n}\nexport class ViewLine {\n    constructor(options) {\n        this._options = options;\n        this._isMaybeInvalid = true;\n        this._renderedViewLine = null;\n    }\n    // --- begin IVisibleLineData\n    getDomNode() {\n        if (this._renderedViewLine && this._renderedViewLine.domNode) {\n            return this._renderedViewLine.domNode.domNode;\n        }\n        return null;\n    }\n    setDomNode(domNode) {\n        if (this._renderedViewLine) {\n            this._renderedViewLine.domNode = createFastDomNode(domNode);\n        }\n        else {\n            throw new Error('I have no rendered view line to set the dom node to...');\n        }\n    }\n    onContentChanged() {\n        this._isMaybeInvalid = true;\n    }\n    onTokensChanged() {\n        this._isMaybeInvalid = true;\n    }\n    onDecorationsChanged() {\n        this._isMaybeInvalid = true;\n    }\n    onOptionsChanged(newOptions) {\n        this._isMaybeInvalid = true;\n        this._options = newOptions;\n    }\n    onSelectionChanged() {\n        if (isHighContrast(this._options.themeType) || this._options.renderWhitespace === 'selection') {\n            this._isMaybeInvalid = true;\n            return true;\n        }\n        return false;\n    }\n    renderLine(lineNumber, deltaTop, viewportData, sb) {\n        if (this._isMaybeInvalid === false) {\n            // it appears that nothing relevant has changed\n            return false;\n        }\n        this._isMaybeInvalid = false;\n        const lineData = viewportData.getViewLineRenderingData(lineNumber);\n        const options = this._options;\n        const actualInlineDecorations = LineDecoration.filter(lineData.inlineDecorations, lineNumber, lineData.minColumn, lineData.maxColumn);\n        // Only send selection information when needed for rendering whitespace\n        let selectionsOnLine = null;\n        if (isHighContrast(options.themeType) || this._options.renderWhitespace === 'selection') {\n            const selections = viewportData.selections;\n            for (const selection of selections) {\n                if (selection.endLineNumber < lineNumber || selection.startLineNumber > lineNumber) {\n                    // Selection does not intersect line\n                    continue;\n                }\n                const startColumn = (selection.startLineNumber === lineNumber ? selection.startColumn : lineData.minColumn);\n                const endColumn = (selection.endLineNumber === lineNumber ? selection.endColumn : lineData.maxColumn);\n                if (startColumn < endColumn) {\n                    if (isHighContrast(options.themeType)) {\n                        actualInlineDecorations.push(new LineDecoration(startColumn, endColumn, 'inline-selected-text', 0 /* InlineDecorationType.Regular */));\n                    }\n                    if (this._options.renderWhitespace === 'selection') {\n                        if (!selectionsOnLine) {\n                            selectionsOnLine = [];\n                        }\n                        selectionsOnLine.push(new LineRange(startColumn - 1, endColumn - 1));\n                    }\n                }\n            }\n        }\n        const renderLineInput = new RenderLineInput(options.useMonospaceOptimizations, options.canUseHalfwidthRightwardsArrow, lineData.content, lineData.continuesWithWrappedLine, lineData.isBasicASCII, lineData.containsRTL, lineData.minColumn - 1, lineData.tokens, actualInlineDecorations, lineData.tabSize, lineData.startVisibleColumn, options.spaceWidth, options.middotWidth, options.wsmiddotWidth, options.stopRenderingLineAfter, options.renderWhitespace, options.renderControlCharacters, options.fontLigatures !== EditorFontLigatures.OFF, selectionsOnLine);\n        if (this._renderedViewLine && this._renderedViewLine.input.equals(renderLineInput)) {\n            // no need to do anything, we have the same render input\n            return false;\n        }\n        sb.appendString('<div style=\"top:');\n        sb.appendString(String(deltaTop));\n        sb.appendString('px;height:');\n        sb.appendString(String(this._options.lineHeight));\n        sb.appendString('px;\" class=\"');\n        sb.appendString(ViewLine.CLASS_NAME);\n        sb.appendString('\">');\n        const output = renderViewLine(renderLineInput, sb);\n        sb.appendString('</div>');\n        let renderedViewLine = null;\n        if (monospaceAssumptionsAreValid && canUseFastRenderedViewLine && lineData.isBasicASCII && options.useMonospaceOptimizations && output.containsForeignElements === 0 /* ForeignElementType.None */) {\n            renderedViewLine = new FastRenderedViewLine(this._renderedViewLine ? this._renderedViewLine.domNode : null, renderLineInput, output.characterMapping);\n        }\n        if (!renderedViewLine) {\n            renderedViewLine = createRenderedLine(this._renderedViewLine ? this._renderedViewLine.domNode : null, renderLineInput, output.characterMapping, output.containsRTL, output.containsForeignElements);\n        }\n        this._renderedViewLine = renderedViewLine;\n        return true;\n    }\n    layoutLine(lineNumber, deltaTop) {\n        if (this._renderedViewLine && this._renderedViewLine.domNode) {\n            this._renderedViewLine.domNode.setTop(deltaTop);\n            this._renderedViewLine.domNode.setHeight(this._options.lineHeight);\n        }\n    }\n    // --- end IVisibleLineData\n    getWidth(context) {\n        if (!this._renderedViewLine) {\n            return 0;\n        }\n        return this._renderedViewLine.getWidth(context);\n    }\n    getWidthIsFast() {\n        if (!this._renderedViewLine) {\n            return true;\n        }\n        return this._renderedViewLine.getWidthIsFast();\n    }\n    needsMonospaceFontCheck() {\n        if (!this._renderedViewLine) {\n            return false;\n        }\n        return (this._renderedViewLine instanceof FastRenderedViewLine);\n    }\n    monospaceAssumptionsAreValid() {\n        if (!this._renderedViewLine) {\n            return monospaceAssumptionsAreValid;\n        }\n        if (this._renderedViewLine instanceof FastRenderedViewLine) {\n            return this._renderedViewLine.monospaceAssumptionsAreValid();\n        }\n        return monospaceAssumptionsAreValid;\n    }\n    onMonospaceAssumptionsInvalidated() {\n        if (this._renderedViewLine && this._renderedViewLine instanceof FastRenderedViewLine) {\n            this._renderedViewLine = this._renderedViewLine.toSlowRenderedLine();\n        }\n    }\n    getVisibleRangesForRange(lineNumber, startColumn, endColumn, context) {\n        if (!this._renderedViewLine) {\n            return null;\n        }\n        startColumn = Math.min(this._renderedViewLine.input.lineContent.length + 1, Math.max(1, startColumn));\n        endColumn = Math.min(this._renderedViewLine.input.lineContent.length + 1, Math.max(1, endColumn));\n        const stopRenderingLineAfter = this._renderedViewLine.input.stopRenderingLineAfter;\n        if (stopRenderingLineAfter !== -1 && startColumn > stopRenderingLineAfter + 1 && endColumn > stopRenderingLineAfter + 1) {\n            // This range is obviously not visible\n            return new VisibleRanges(true, [new FloatHorizontalRange(this.getWidth(context), 0)]);\n        }\n        if (stopRenderingLineAfter !== -1 && startColumn > stopRenderingLineAfter + 1) {\n            startColumn = stopRenderingLineAfter + 1;\n        }\n        if (stopRenderingLineAfter !== -1 && endColumn > stopRenderingLineAfter + 1) {\n            endColumn = stopRenderingLineAfter + 1;\n        }\n        const horizontalRanges = this._renderedViewLine.getVisibleRangesForRange(lineNumber, startColumn, endColumn, context);\n        if (horizontalRanges && horizontalRanges.length > 0) {\n            return new VisibleRanges(false, horizontalRanges);\n        }\n        return null;\n    }\n    getColumnOfNodeOffset(lineNumber, spanNode, offset) {\n        if (!this._renderedViewLine) {\n            return 1;\n        }\n        return this._renderedViewLine.getColumnOfNodeOffset(lineNumber, spanNode, offset);\n    }\n}\nViewLine.CLASS_NAME = 'view-line';\n/**\n * A rendered line which is guaranteed to contain only regular ASCII and is rendered with a monospace font.\n */\nclass FastRenderedViewLine {\n    constructor(domNode, renderLineInput, characterMapping) {\n        this._cachedWidth = -1;\n        this.domNode = domNode;\n        this.input = renderLineInput;\n        const keyColumnCount = Math.floor(renderLineInput.lineContent.length / 300 /* Constants.MaxMonospaceDistance */);\n        if (keyColumnCount > 0) {\n            this._keyColumnPixelOffsetCache = new Float32Array(keyColumnCount);\n            for (let i = 0; i < keyColumnCount; i++) {\n                this._keyColumnPixelOffsetCache[i] = -1;\n            }\n        }\n        else {\n            this._keyColumnPixelOffsetCache = null;\n        }\n        this._characterMapping = characterMapping;\n        this._charWidth = renderLineInput.spaceWidth;\n    }\n    getWidth(context) {\n        if (!this.domNode || this.input.lineContent.length < 300 /* Constants.MaxMonospaceDistance */) {\n            const horizontalOffset = this._characterMapping.getHorizontalOffset(this._characterMapping.length);\n            return Math.round(this._charWidth * horizontalOffset);\n        }\n        if (this._cachedWidth === -1) {\n            this._cachedWidth = this._getReadingTarget(this.domNode).offsetWidth;\n            context === null || context === void 0 ? void 0 : context.markDidDomLayout();\n        }\n        return this._cachedWidth;\n    }\n    getWidthIsFast() {\n        return (this.input.lineContent.length < 300 /* Constants.MaxMonospaceDistance */) || this._cachedWidth !== -1;\n    }\n    monospaceAssumptionsAreValid() {\n        if (!this.domNode) {\n            return monospaceAssumptionsAreValid;\n        }\n        if (this.input.lineContent.length < 300 /* Constants.MaxMonospaceDistance */) {\n            const expectedWidth = this.getWidth(null);\n            const actualWidth = this.domNode.domNode.firstChild.offsetWidth;\n            if (Math.abs(expectedWidth - actualWidth) >= 2) {\n                // more than 2px off\n                console.warn(`monospace assumptions have been violated, therefore disabling monospace optimizations!`);\n                monospaceAssumptionsAreValid = false;\n            }\n        }\n        return monospaceAssumptionsAreValid;\n    }\n    toSlowRenderedLine() {\n        return createRenderedLine(this.domNode, this.input, this._characterMapping, false, 0 /* ForeignElementType.None */);\n    }\n    getVisibleRangesForRange(lineNumber, startColumn, endColumn, context) {\n        const startPosition = this._getColumnPixelOffset(lineNumber, startColumn, context);\n        const endPosition = this._getColumnPixelOffset(lineNumber, endColumn, context);\n        return [new FloatHorizontalRange(startPosition, endPosition - startPosition)];\n    }\n    _getColumnPixelOffset(lineNumber, column, context) {\n        if (column <= 300 /* Constants.MaxMonospaceDistance */) {\n            const horizontalOffset = this._characterMapping.getHorizontalOffset(column);\n            return this._charWidth * horizontalOffset;\n        }\n        const keyColumnOrdinal = Math.floor((column - 1) / 300 /* Constants.MaxMonospaceDistance */) - 1;\n        const keyColumn = (keyColumnOrdinal + 1) * 300 /* Constants.MaxMonospaceDistance */ + 1;\n        let keyColumnPixelOffset = -1;\n        if (this._keyColumnPixelOffsetCache) {\n            keyColumnPixelOffset = this._keyColumnPixelOffsetCache[keyColumnOrdinal];\n            if (keyColumnPixelOffset === -1) {\n                keyColumnPixelOffset = this._actualReadPixelOffset(lineNumber, keyColumn, context);\n                this._keyColumnPixelOffsetCache[keyColumnOrdinal] = keyColumnPixelOffset;\n            }\n        }\n        if (keyColumnPixelOffset === -1) {\n            // Could not read actual key column pixel offset\n            const horizontalOffset = this._characterMapping.getHorizontalOffset(column);\n            return this._charWidth * horizontalOffset;\n        }\n        const keyColumnHorizontalOffset = this._characterMapping.getHorizontalOffset(keyColumn);\n        const horizontalOffset = this._characterMapping.getHorizontalOffset(column);\n        return keyColumnPixelOffset + this._charWidth * (horizontalOffset - keyColumnHorizontalOffset);\n    }\n    _getReadingTarget(myDomNode) {\n        return myDomNode.domNode.firstChild;\n    }\n    _actualReadPixelOffset(lineNumber, column, context) {\n        if (!this.domNode) {\n            return -1;\n        }\n        const domPosition = this._characterMapping.getDomPosition(column);\n        const r = RangeUtil.readHorizontalRanges(this._getReadingTarget(this.domNode), domPosition.partIndex, domPosition.charIndex, domPosition.partIndex, domPosition.charIndex, context);\n        if (!r || r.length === 0) {\n            return -1;\n        }\n        return r[0].left;\n    }\n    getColumnOfNodeOffset(lineNumber, spanNode, offset) {\n        const spanNodeTextContentLength = spanNode.textContent.length;\n        let spanIndex = -1;\n        while (spanNode) {\n            spanNode = spanNode.previousSibling;\n            spanIndex++;\n        }\n        return this._characterMapping.getColumn(new DomPosition(spanIndex, offset), spanNodeTextContentLength);\n    }\n}\n/**\n * Every time we render a line, we save what we have rendered in an instance of this class.\n */\nclass RenderedViewLine {\n    constructor(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements) {\n        this.domNode = domNode;\n        this.input = renderLineInput;\n        this._characterMapping = characterMapping;\n        this._isWhitespaceOnly = /^\\s*$/.test(renderLineInput.lineContent);\n        this._containsForeignElements = containsForeignElements;\n        this._cachedWidth = -1;\n        this._pixelOffsetCache = null;\n        if (!containsRTL || this._characterMapping.length === 0 /* the line is empty */) {\n            this._pixelOffsetCache = new Float32Array(Math.max(2, this._characterMapping.length + 1));\n            for (let column = 0, len = this._characterMapping.length; column <= len; column++) {\n                this._pixelOffsetCache[column] = -1;\n            }\n        }\n    }\n    // --- Reading from the DOM methods\n    _getReadingTarget(myDomNode) {\n        return myDomNode.domNode.firstChild;\n    }\n    /**\n     * Width of the line in pixels\n     */\n    getWidth(context) {\n        if (!this.domNode) {\n            return 0;\n        }\n        if (this._cachedWidth === -1) {\n            this._cachedWidth = this._getReadingTarget(this.domNode).offsetWidth;\n            context === null || context === void 0 ? void 0 : context.markDidDomLayout();\n        }\n        return this._cachedWidth;\n    }\n    getWidthIsFast() {\n        if (this._cachedWidth === -1) {\n            return false;\n        }\n        return true;\n    }\n    /**\n     * Visible ranges for a model range\n     */\n    getVisibleRangesForRange(lineNumber, startColumn, endColumn, context) {\n        if (!this.domNode) {\n            return null;\n        }\n        if (this._pixelOffsetCache !== null) {\n            // the text is LTR\n            const startOffset = this._readPixelOffset(this.domNode, lineNumber, startColumn, context);\n            if (startOffset === -1) {\n                return null;\n            }\n            const endOffset = this._readPixelOffset(this.domNode, lineNumber, endColumn, context);\n            if (endOffset === -1) {\n                return null;\n            }\n            return [new FloatHorizontalRange(startOffset, endOffset - startOffset)];\n        }\n        return this._readVisibleRangesForRange(this.domNode, lineNumber, startColumn, endColumn, context);\n    }\n    _readVisibleRangesForRange(domNode, lineNumber, startColumn, endColumn, context) {\n        if (startColumn === endColumn) {\n            const pixelOffset = this._readPixelOffset(domNode, lineNumber, startColumn, context);\n            if (pixelOffset === -1) {\n                return null;\n            }\n            else {\n                return [new FloatHorizontalRange(pixelOffset, 0)];\n            }\n        }\n        else {\n            return this._readRawVisibleRangesForRange(domNode, startColumn, endColumn, context);\n        }\n    }\n    _readPixelOffset(domNode, lineNumber, column, context) {\n        if (this._characterMapping.length === 0) {\n            // This line has no content\n            if (this._containsForeignElements === 0 /* ForeignElementType.None */) {\n                // We can assume the line is really empty\n                return 0;\n            }\n            if (this._containsForeignElements === 2 /* ForeignElementType.After */) {\n                // We have foreign elements after the (empty) line\n                return 0;\n            }\n            if (this._containsForeignElements === 1 /* ForeignElementType.Before */) {\n                // We have foreign elements before the (empty) line\n                return this.getWidth(context);\n            }\n            // We have foreign elements before & after the (empty) line\n            const readingTarget = this._getReadingTarget(domNode);\n            if (readingTarget.firstChild) {\n                context.markDidDomLayout();\n                return readingTarget.firstChild.offsetWidth;\n            }\n            else {\n                return 0;\n            }\n        }\n        if (this._pixelOffsetCache !== null) {\n            // the text is LTR\n            const cachedPixelOffset = this._pixelOffsetCache[column];\n            if (cachedPixelOffset !== -1) {\n                return cachedPixelOffset;\n            }\n            const result = this._actualReadPixelOffset(domNode, lineNumber, column, context);\n            this._pixelOffsetCache[column] = result;\n            return result;\n        }\n        return this._actualReadPixelOffset(domNode, lineNumber, column, context);\n    }\n    _actualReadPixelOffset(domNode, lineNumber, column, context) {\n        if (this._characterMapping.length === 0) {\n            // This line has no content\n            const r = RangeUtil.readHorizontalRanges(this._getReadingTarget(domNode), 0, 0, 0, 0, context);\n            if (!r || r.length === 0) {\n                return -1;\n            }\n            return r[0].left;\n        }\n        if (column === this._characterMapping.length && this._isWhitespaceOnly && this._containsForeignElements === 0 /* ForeignElementType.None */) {\n            // This branch helps in the case of whitespace only lines which have a width set\n            return this.getWidth(context);\n        }\n        const domPosition = this._characterMapping.getDomPosition(column);\n        const r = RangeUtil.readHorizontalRanges(this._getReadingTarget(domNode), domPosition.partIndex, domPosition.charIndex, domPosition.partIndex, domPosition.charIndex, context);\n        if (!r || r.length === 0) {\n            return -1;\n        }\n        const result = r[0].left;\n        if (this.input.isBasicASCII) {\n            const horizontalOffset = this._characterMapping.getHorizontalOffset(column);\n            const expectedResult = Math.round(this.input.spaceWidth * horizontalOffset);\n            if (Math.abs(expectedResult - result) <= 1) {\n                return expectedResult;\n            }\n        }\n        return result;\n    }\n    _readRawVisibleRangesForRange(domNode, startColumn, endColumn, context) {\n        if (startColumn === 1 && endColumn === this._characterMapping.length) {\n            // This branch helps IE with bidi text & gives a performance boost to other browsers when reading visible ranges for an entire line\n            return [new FloatHorizontalRange(0, this.getWidth(context))];\n        }\n        const startDomPosition = this._characterMapping.getDomPosition(startColumn);\n        const endDomPosition = this._characterMapping.getDomPosition(endColumn);\n        return RangeUtil.readHorizontalRanges(this._getReadingTarget(domNode), startDomPosition.partIndex, startDomPosition.charIndex, endDomPosition.partIndex, endDomPosition.charIndex, context);\n    }\n    /**\n     * Returns the column for the text found at a specific offset inside a rendered dom node\n     */\n    getColumnOfNodeOffset(lineNumber, spanNode, offset) {\n        const spanNodeTextContentLength = spanNode.textContent.length;\n        let spanIndex = -1;\n        while (spanNode) {\n            spanNode = spanNode.previousSibling;\n            spanIndex++;\n        }\n        return this._characterMapping.getColumn(new DomPosition(spanIndex, offset), spanNodeTextContentLength);\n    }\n}\nclass WebKitRenderedViewLine extends RenderedViewLine {\n    _readVisibleRangesForRange(domNode, lineNumber, startColumn, endColumn, context) {\n        const output = super._readVisibleRangesForRange(domNode, lineNumber, startColumn, endColumn, context);\n        if (!output || output.length === 0 || startColumn === endColumn || (startColumn === 1 && endColumn === this._characterMapping.length)) {\n            return output;\n        }\n        // WebKit is buggy and returns an expanded range (to contain words in some cases)\n        // The last client rect is enlarged (I think)\n        if (!this.input.containsRTL) {\n            // This is an attempt to patch things up\n            // Find position of last column\n            const endPixelOffset = this._readPixelOffset(domNode, lineNumber, endColumn, context);\n            if (endPixelOffset !== -1) {\n                const lastRange = output[output.length - 1];\n                if (lastRange.left < endPixelOffset) {\n                    // Trim down the width of the last visible range to not go after the last column's position\n                    lastRange.width = endPixelOffset - lastRange.left;\n                }\n            }\n        }\n        return output;\n    }\n}\nconst createRenderedLine = (function () {\n    if (browser.isWebKit) {\n        return createWebKitRenderedLine;\n    }\n    return createNormalRenderedLine;\n})();\nfunction createWebKitRenderedLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements) {\n    return new WebKitRenderedViewLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements);\n}\nfunction createNormalRenderedLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements) {\n    return new RenderedViewLine(domNode, renderLineInput, characterMapping, containsRTL, containsForeignElements);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport './margin.css';\nimport { createFastDomNode } from '../../../../base/browser/fastDomNode.js';\nimport { ViewPart } from '../../view/viewPart.js';\nexport class Margin extends ViewPart {\n    constructor(context) {\n        super(context);\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._canUseLayerHinting = !options.get(31 /* EditorOption.disableLayerHinting */);\n        this._contentLeft = layoutInfo.contentLeft;\n        this._glyphMarginLeft = layoutInfo.glyphMarginLeft;\n        this._glyphMarginWidth = layoutInfo.glyphMarginWidth;\n        this._domNode = createFastDomNode(document.createElement('div'));\n        this._domNode.setClassName(Margin.OUTER_CLASS_NAME);\n        this._domNode.setPosition('absolute');\n        this._domNode.setAttribute('role', 'presentation');\n        this._domNode.setAttribute('aria-hidden', 'true');\n        this._glyphMarginBackgroundDomNode = createFastDomNode(document.createElement('div'));\n        this._glyphMarginBackgroundDomNode.setClassName(Margin.CLASS_NAME);\n        this._domNode.appendChild(this._glyphMarginBackgroundDomNode);\n    }\n    dispose() {\n        super.dispose();\n    }\n    getDomNode() {\n        return this._domNode;\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(142 /* EditorOption.layoutInfo */);\n        this._canUseLayerHinting = !options.get(31 /* EditorOption.disableLayerHinting */);\n        this._contentLeft = layoutInfo.contentLeft;\n        this._glyphMarginLeft = layoutInfo.glyphMarginLeft;\n        this._glyphMarginWidth = layoutInfo.glyphMarginWidth;\n        return true;\n    }\n    onScrollChanged(e) {\n        return super.onScrollChanged(e) || e.scrollTopChanged;\n    }\n    // --- end event handlers\n    prepareRender(ctx) {\n        // Nothing to read\n    }\n    render(ctx) {\n        this._domNode.setLayerHinting(this._canUseLayerHinting);\n        this._domNode.setContain('strict');\n        const adjustedScrollTop = ctx.scrollTop - ctx.bigNumbersDelta;\n        this._domNode.setTop(-adjustedScrollTop);\n        const height = Math.min(ctx.scrollHeight, 1000000);\n        this._domNode.setHeight(height);\n        this._domNode.setWidth(this._contentLeft);\n        this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft);\n        this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth);\n        this._glyphMarginBackgroundDomNode.setHeight(height);\n    }\n}\nMargin.CLASS_NAME = 'glyph-margin';\nMargin.OUTER_CLASS_NAME = 'margin';\n"],"names":["ViewContentWidgets","_ViewPart","_inherits","_super","_createSuper","context","viewDomNode","_this","_classCallCheck","call","_viewDomNode","_widgets","domNode","createFastDomNode","document","createElement","PartFingerprints","write","setClassName","setPosition","setTop","overflowingContentWidgetsDomNode","_createClass","key","value","_get","_getPrototypeOf","prototype","this","e","_i","_keys","Object","keys","length","widgetId","onConfigurationChanged","_updateAnchorsViewPositions","_i2","_keys2","updateAnchorViewPosition","_widget","myWidget","Widget","_context","id","allowEditorOverflow","appendChild","setShouldRender","widget","primaryAnchor","secondaryAnchor","preference","affinity","getId","hasOwnProperty","parentNode","removeChild","removeAttribute","suppressMouseDown","viewportData","_i3","_keys3","onBeforeRender","ctx","_i4","_keys4","prepareRender","_i5","_keys5","render","ViewPart","actual","_primaryAnchor","PositionPair","_secondaryAnchor","_actual","getDomNode","options","configuration","layoutInfo","get","_fixedOverflowWidgets","_contentWidth","contentWidth","_contentLeft","contentLeft","_lineHeight","_affinity","_preference","_cachedDomNodeOffsetWidth","_cachedDomNodeOffsetHeight","_maxWidth","_getMaxWidth","_isVisible","_renderData","setDisplay","setVisibility","setAttribute","setMaxWidth","hasChanged","_setPosition","modelPosition","getValidPositionPair","position","viewModel","validModelPosition","model","validatePosition","coordinatesConverter","modelPositionIsVisible","viewPosition","convertModelPositionToViewPosition","undefined","window","innerWidth","documentElement","offsetWidth","body","anchor","width","height","aboveLineTop","top","heightAvailableAboveLine","underLineTop","aboveTop","fitsAbove","belowTop","fitsBelow","viewportHeight","left","scrollLeft","viewportWidth","windowSize","domNodePosition","MIN_LIMIT","Math","max","MAX_LIMIT","min","absoluteLeft","scrollX","delta","dom","getDomNodePagePosition","absoluteAboveTop","scrollY","absoluteBelowTop","getClientArea","_this$_layoutHorizont","_layoutHorizontalSegmentInPage","_this$_layoutHorizont2","_slicedToArray","absoluteAboveLeft","topLeft","Coordinate","_a","_b","primary","getCoordinates","secondary","lineNumber","lineHeight","horizontalPosition","visibleRangeForPosition","column","getVerticalOffsetForLineNumber","scrollTop","AnchorCoordinate","fontInfo","typicalFullwidthCharacterWidth","_this$_getAnchorsCoor","_getAnchorsCoordinates","preferredDimensions","beforeRender","safeInvoke","clientRect","getBoundingClientRect","round","placement","_reduceAnchorCoordinates","_layoutBoxInPage","_layoutBoxInViewport","pass","_step","_iterator","_createForOfIteratorHelper","s","n","done","pref","coordinate","_prepareRenderWidgetAtExactPositionOverflowing","err","f","startLineNumber","endLineNumber","_prepareRenderWidget","afterRender","setLeft","bigNumbersDelta","_coordinateBrand","_anchorCoordinateBrand","fn","thisArg","_len","arguments","args","Array","_key","apply","concat","AbstractLineHighlightOverlay","_DynamicViewOverlay","_renderLineHighlight","_renderLineHighlightOnlyWhenFocus","_selectionIsEmpty","_focused","_cursorLineNumbers","_selections","Selection","addEventHandler","_assertThisInitialized","removeEventHandler","cursorsLineNumbers","map","positionLineNumber","sort","a","b","arrays","selectionIsEmpty","every","isEmpty","_readFromSelections","selections","scrollWidthChanged","scrollTopChanged","isFocused","_shouldRenderThis","renderedLine","_renderOne","visibleStartLineNumber","visibleRange","visibleEndLineNumber","len","index","renderData","lineIndex","DynamicViewOverlay","CurrentLineHighlightOverlay","_AbstractLineHighligh","_super2","className","_shouldRenderOther","scrollWidth","_shouldRenderInContent","_shouldRenderInMargin","CurrentLineMarginHighlightOverlay","_AbstractLineHighligh2","_super3","registerThemingParticipant","theme","collector","lineHighlight","getColor","editorLineHighlight","addRule","isTransparent","defines","editorLineHighlightBorder","lineHighlightBorder","isHighContrast","type","DecorationsOverlay","_typicalHalfwidthCharacterWidth","typicalHalfwidthCharacterWidth","_renderResult","_decorations","getDecorationsInViewport","decorations","decorationsLen","i","d","zIndex","aClassName","bClassName","Range","compareRangesUsingStarts","range","output","_renderWholeLineDecorations","_renderNormalDecorations","String","lenI","isWholeLine","decorationOutput","j","prevClassName","prevShowIfCollapsed","prevRange","prevShouldFillLineOnLineBreak","showIfCollapsed","Boolean","endColumn","startColumn","getLineMaxColumn","areIntersectingOrTouching","plusRange","_renderNormalDecoration","shouldFillLineOnLineBreak","linesVisibleRanges","linesVisibleRangesForRange","lenJ","lineVisibleRanges","outsideRenderedLine","ranges","singleVisibleRange","center","HorizontalRange","k","lenK","expandToLeft","continuesOnNextLine","EditorScrollbar","linesContent","overflowGuardDomNode","scrollbar","mouseWheelScrollSensitivity","fastScrollSensitivity","scrollPredominantAxis","scrollbarOptions","listenOnDomNode","getThemeTypeSelector","useShadows","lazyRender","vertical","horizontal","verticalHasArrows","horizontalHasArrows","verticalScrollbarSize","verticalSliderSize","horizontalScrollbarSize","horizontalSliderSize","handleMouseWheel","alwaysConsumeMouseWheel","arrowSize","scrollByPage","_register","SmoothScrollableElement","viewLayout","getScrollable","scrollbarDomNode","_setLayout","onBrowserDesperateReveal","lookAtScrollTop","lookAtScrollLeft","newScrollPosition","deltaTop","getCurrentScrollTop","deltaLeft","getCurrentScrollLeft","setScrollPosition","addDisposableListener","side","setWidth","minimap","minimapWidth","setHeight","getOverviewRulerLayoutInfo","browserEvent","delegateVerticalScrollbarPointerDown","delegateScrollFromMouseWheelEvent","newOpts","updateOptions","updateClassName","renderNow","IndentGuidesOverlay","_primaryPosition","wrappingInfo","_spaceWidth","spaceWidth","_maxIndentLeft","wrappingColumn","_bracketPairGuideOptions","newPosition","getPosition","equals","_c","_d","indentation","bracketPairs","activeCursorPosition","indents","getGuidesByLine","getLineCount","indent","result","leftOffset","Position","guide","visibleColumn","horizontalLine","_this2","bracketGuides","getBracketGuidesInRangeByLine","highlightActive","highlightActiveBracketPair","horizontalGuides","bracketPairsHorizontal","HorizontalGuidesState","Enabled","EnabledForActive","Disabled","includeInactive","indentGuides","getLinesIndentGuides","activeIndentStartLineNumber","activeIndentEndLineNumber","activeIndentLevel","highlightActiveIndentation","activeIndentInfo","getActiveIndentGuide","indentSize","getOptions","lineGuides","push","bracketGuidesInLine","bracketGuidesInLineQueue","ArrayQueue","indentGuidesInLine","_loop","indentGuide","indentLvl","isActive","_toConsumableArray","takeWhile","g","peeked","peek","IndentGuide","transparentToUndefined","color","colors","bracketColor","editorBracketHighlightingForeground1","guideColor","editorBracketPairGuideBackground1","guideColorActive","editorBracketPairGuideActiveBackground1","editorBracketHighlightingForeground2","editorBracketPairGuideBackground2","editorBracketPairGuideActiveBackground2","editorBracketHighlightingForeground3","editorBracketPairGuideBackground3","editorBracketPairGuideActiveBackground3","editorBracketHighlightingForeground4","editorBracketPairGuideBackground4","editorBracketPairGuideActiveBackground4","editorBracketHighlightingForeground5","editorBracketPairGuideBackground5","editorBracketPairGuideActiveBackground5","editorBracketHighlightingForeground6","editorBracketPairGuideBackground6","editorBracketPairGuideActiveBackground6","colorProvider","BracketPairGuidesClassNames","indentColors","indentColor","editorIndentGuide1","indentColorActive","editorActiveIndentGuide1","editorIndentGuide2","editorActiveIndentGuide2","editorIndentGuide3","editorActiveIndentGuide3","editorIndentGuide4","editorActiveIndentGuide4","editorIndentGuide5","editorActiveIndentGuide5","editorIndentGuide6","editorActiveIndentGuide6","colorValues","c","effectiveGuideColor","transparent","effectiveGuideColorActive","filter","isDefined","indentColorValues","effectiveIndentColor","effectiveIndentColorActive","level","getInlineClassNameOfLevel","replace","activeClassName","DomReadingContext","_domNode","endNode","_didDomLayout","_clientRectDeltaLeft","_clientRectScale","_clientRectRead","rect","markDidDomLayout","readClientRect","LastRenderedData","_currentVisibleRange","currentVisibleRange","HorizontalRevealRangeRequest","minimalReveal","startScrollTop","stopScrollTop","scrollType","minLineNumber","maxLineNumber","HorizontalRevealSelectionsRequest","selection","ViewLines","_linesContent","_textRangeRestingSpot","_visibleLines","VisibleLinesCollection","conf","_isViewportWrapping","isViewportWrapping","_revealHorizontalRightPadding","_cursorSurroundingLines","_cursorSurroundingLinesStyle","_canUseLayerHinting","_viewLineOptions","ViewLineOptions","MOUSE_CURSOR_TEXT_CSS_CLASS_NAME","applyFontInfo","_maxLineWidth","_asyncUpdateLineWidths","RunOnceScheduler","_updateLineWidthsSlow","_asyncCheckMonospaceFontAssumptions","_checkMonospaceFontAssumptions","_lastRenderedData","_horizontalRevealRequest","_stickyScrollEnabled","enabled","_maxNumberStickyLines","maxLineCount","dispose","ViewLine","_onOptionsMaybeChanged","newViewLineOptions","getStartLineNumber","getEndLineNumber","getVisibleLine","onOptionsChanged","rendStartLineNumber","rendEndLineNumber","r","onSelectionChanged","onDecorationsChanged","shouldRender","onFlushed","onLinesChanged","onLinesDeleted","onLinesInserted","desiredScrollTop","_computeScrollTopToRevealRange","getFutureViewport","source","verticalType","validateScrollPosition","revealHorizontal","abs","scrollLeftChanged","onScrollChanged","onTokensChanged","setMaxLineWidth","onZonesChanged","spanNode","offset","viewLineDomNode","_getViewLineDomNode","_getLineNumberFor","getColumnOfNodeOffset","minColumn","getLineMinColumn","node","nodeType","CLASS_NAME","parentElement","getWidth","_updateLineWidthsSlowIfDomDidLayout","_range","includeNewLines","originalEndLineNumber","intersectRanges","getCurrentVisibleRange","visibleRanges","visibleRangesLen","domReadingContext","nextLineModelLineNumber","convertViewPositionToModelPosition","continuesInNextLine","visibleRangesForLine","getVisibleRangesForRange","LineVisibleRanges","from","_visibleRangesForLineRange","HorizontalPosition","_updateLineWidths","didDomLayout","isScheduled","cancel","fast","localMaxLineWidth","allWidthsComputed","visibleLine","getWidthIsFast","_ensureMaxLineWidth","longestLineNumber","longestWidth","needsMonospaceFontCheck","lineWidth","monospaceAssumptionsAreValid","onMonospaceAssumptionsInvalidated","Error","renderLines","setCurrentVisibleRange","getScrollWidth","getScrollHeight","horizontalRevealRequest","onDidRender","newScrollLeft","_computeScrollLeftToReveal","maxHorizontalOffset","_updateLineWidthsFast","schedule","platform","setLayerHinting","setContain","adjustedScrollTop","iLineWidth","ceil","viewport","boxIsSingleRange","boxStartY","boxEndY","viewportStartY","viewportEndY","newScrollTop","paddingTop","paddingBottom","minScrollTop","boxMiddleY","_computeMinimumScrolling","getCurrentViewport","viewportStartX","viewportEndX","verticalScrollbarWidth","boxStartX","boxEndX","_step2","_iterator2","_step3","_iterator3","HORIZONTAL_EXTRA_PX","viewportStart","viewportEnd","boxStart","boxEnd","revealAtStart","revealAtEnd","viewportLength","DecorationToRender","_decorationToRenderBrand","LineDecorationToRender","VisibleLineDecorationsToRender","decoration","DedupOverlay","prevEndLineIndex","startLineIndex","endLineIndex","add","GlyphMarginWidgets","_glyphMargin","_glyphMarginLeft","glyphMarginLeft","_glyphMarginWidth","glyphMarginWidth","_glyphMarginDecorationLaneCount","glyphMarginDecorationLaneCount","_managedDomNodes","_decorationGlyphsToRender","values","renderInfo","lane","equalsRange","requests","glyphMarginClassName","glyphMargin","DecorationBasedGlyphRenderRequest","_Object$values","widgetLineNumber","WidgetBasedGlyphRenderRequest","_collectDecorationBasedGlyphRenderRequest","_collectWidgetBasedGlyphRenderRequest","_Object$values2","_collectSortedGlyphRenderRequests","decorationGlyphsToRender","first","requestsAtLocation","el","winner","classNames","request","accept","join","_Object$values4","relativeVerticalOffset","dec","combinedClassName","pop","remove","_Object$values3","DecorationBasedGlyph","LinesDecorationsOverlay","_DedupOverlay","_decorationsLeft","decorationsLeft","_decorationsWidth","decorationsWidth","rLen","linesDecorationsClassName","firstLineDecorationClassName","toRender","_render","_getDecorations","common","toString","getDecorations","lineOutput","MarginViewLineDecorationsOverlay","marginClassName","allCharCodes","v","MinimapCharRenderer","charData","scale","_minimapCharRendererBrand","charDataNormal","soften","charDataLight","target","dx","dy","chCode","foregroundAlpha","backgroundColor","backgroundAlpha","fontScale","useLighterFont","force1pxHeight","charWidth","charHeight","renderHeight","console","warn","charIndex","getCharIndex","destWidth","backgroundR","backgroundG","backgroundB","deltaR","deltaG","deltaB","destAlpha","dest","data","sourceOffset","row","y","x","colorR","colorG","colorB","input","ratio","Uint8ClampedArray","toUint8","charTable","A","B","C","D","E","F","decodeData","str","prebakedMiniMaps","once","MinimapCharRendererFactory","fontFamily","lastCreated","lastFontFamily","factory","createFromSampleData","createSampleData","canvas","getContext","style","fillStyle","font","textBaseline","code","fillText","fromCharCode","getImageData","_downsample","destOffset","targetIndex","brightest","sourceY1","sourceY2","sourceX1","sourceX2","samples","sy","sourceRow","floor","yBalance","sx","xBalance","sourceIndex","weight","final","pixelsPerCharacter","resultLen","resultOffset","_downsampleChar","adjust","MinimapOptions","tokensColorTracker","pixelRatio","minimapLayout","minimapOpts","renderMinimap","size","minimapHeightIsEditorHeight","scrollBeyondLastLine","bottom","showSlider","autohide","minimapLeft","minimapHeight","canvasInnerWidth","minimapCanvasInnerWidth","canvasInnerHeight","minimapCanvasInnerHeight","canvasOuterWidth","minimapCanvasOuterWidth","canvasOuterHeight","minimapCanvasOuterHeight","isSampling","minimapIsSampling","editorHeight","minimapScale","minimapLineHeight","minimapCharWidth","charRenderer","create","defaultBackgroundColor","_getMinimapBackground","_getMinimapForegroundOpacity","other","themeColor","minimapBackground","RGBA8","rgba","minimapForegroundOpacity","_clamp","MinimapLayout","scrollHeight","sliderNeeded","_computedSliderRatio","sliderTop","sliderHeight","topPaddingLineCount","pageY","viewportStartLineNumber","viewportEndLineNumber","viewportStartLineNumberVerticalOffset","viewportContainsWhitespaceGaps","lineCount","realLineCount","previousLayout","minimapLinesFitting","logicalScrollHeight","maxMinimapSliderTop","computedSliderRatio","maxLinesFitting","viewportLineCount","expectedViewportLineCount","extraLinesAtTheTop","extraLinesAtTheBottom","consideringStartLineNumber","partialLine","MinimapLine","INVALID","RenderData","renderedLayout","imageData","lines","_imageData","_renderedLines","RenderedLinesCollection","_set","layout","scrollEquals","tmp","rendLineNumberStart","changeFromLineNumber","changeCount","deleteFromLineNumber","deleteToLineNumber","insertFromLineNumber","insertToLineNumber","MinimapBuffers","WIDTH","HEIGHT","background","_backgroundFillData","_createBackgroundFillData","_buffers","createImageData","_lastUsedBuffer","set","backgroundA","MinimapSamplingState","samplingRatio","minimapLines","fromLineNumber","toLineNumber","fromLineIndex","modelLineToMinimapLine","toLineIndex","sampledLineNumber","minimapLineStart","minimapLineEnd","deletedLineCount","changeStartIndex","changeEndIndex","insertedLineCount","viewLineCount","oldSamplingState","minimapLineCount","EditorLayoutInfoComputer","computeContainedMinimapLineCount","halfRatio","lastIndex","oldMinimapLines","oldLength","oldIndex","oldDeltaLineCount","minViewLineNumber","events","lastEvent","fromViewLineNumber","toViewLineNumber","oldMinimapLineNumber","_oldIndex","selectedViewLineNumber","Minimap","MinimapTokensColorTracker","getInstance","_minimapSelections","_MinimapSamplingState","compute","samplingState","_samplingState","_shouldCheckSampling","InnerMinimap","_get2","opts","_recreateLineSampling","onDidChangeOptions","affectsMinimap","minimapLineRange","modelLineRangeToMinimapLineRange","count","_this$_samplingState$","_this$_samplingState$2","onThemeChanged","onTokensColorsChanged","minimapCtx","whitespaceViewportData","wasSampling","_MinimapSamplingState3","_MinimapSamplingState4","event","getLineContent","needed","getViewLineData","getMinimapLinesRenderingData","_this$_samplingState$3","decorationLineRangeToMinimapLineRange","_this$_samplingState$4","modelStartLineNumber","modelEndLineNumber","getMinimapDecorationsInRange","_step4","_iterator4","minimapStartLineNumber","minimapEndLineNumber","ViewModelDecoration","revealRange","_Disposable","_this3","_renderDecorations","_gestureInProgress","_theme","_model","_lastRenderData","_selectionColor","minimapSelection","_getMinimapDomNodeClassName","_shadow","_canvas","_decorationsCanvas","_slider","_sliderHorizontal","_applyLayout","_pointerDownListener","addStandardDisposableListener","EventType","POINTER_DOWN","preventDefault","internalOffsetY","offsetY","revealLineNumber","button","initialPosY","_startSliderDragging","_sliderPointerMoveMonitor","GlobalPointerMoveMonitor","_sliderPointerDownListener","stopPropagation","_gestureDisposable","Gesture","addTarget","_sliderTouchStartListener","Start","toggleClassName","scrollDueToTouchEvent","passive","_sliderTouchMoveListener","Change","_sliderTouchEndListener","End","initialSliderState","_this4","Element","initialPosX","pageX","handlePointerMove","posy","posx","minimapPosition","pointerOrthogonalDelta","setScrollTop","pointerDelta","getDesiredScrollTopFromDelta","startMonitoring","pointerId","buttons","pointerMoveData","touch","startY","getDesiredScrollTopFromTouchLocation","class_","getBuffer","renderingCtx","getRealLineCount","renderDecorations","getSelections","getMinimapDecorationsInViewport","_this$_model$options","tabSize","canvasContext","clearRect","highlightedLines","ContiguousLineMap","_renderSelectionLineHighlights","_renderDecorationsLineHighlights","lineOffsetMap","_renderSelectionsHighlights","_renderDecorationsHighlights","_step5","y1","y2","_iterator5","intersection","intersectWithViewport","_intersection","line","yy1","getYForLineNumber","yy2","fillRect","MINIMAP_GUTTER_WIDTH","highlightColors","Map","minimapOptions","MinimapPosition","Inline","_intersection2","decorationColor","highlightColor","has","characterWidth","_step6","_iterator6","_intersection3","renderDecorationOnLine","_step7","_iterator7","_intersection4","Gutter","renderDecoration","decorationRange","x1","getXOffsetForPosition","x2","lineIndexToXOffset","lineData","prevx","charCode","charCodeAt","strings","linesEquals","_lastData","_getBuffer","_InnerMinimap$_render","_renderUntouchedLines","_InnerMinimap$_render2","_dirtyY1","_dirtyY2","lineInfo","defaultBackground","backgroundIsLight","renderMinimapLineHeight","innerLinePadding","renderBackground","renderedLines","_renderLine","dirtyY1","dirtyHeight","putImageData","lastRenderData","lastTargetData","lastStartLineNumber","lastLines","lastLinesLength","targetData","maxDestPixel","dirtyPixel1","dirtyPixel2","copySourceStart","copySourceEnd","copyDestStart","copyDestEnd","dest_dy","lastLineIndex","source_dy","sourceStart","sourceEnd","destStart","destEnd","subarray","colorTracker","minimapCharRenderer","content","tokens","maxDx","tabsCharDelta","tokenIndex","tokensLen","getCount","tokenEndIndex","getEndOffset","tokenColorId","getForeground","tokenColor","insertSpacesCount","blockRenderChar","renderChar","Disposable","defaultValue","_startLineNumber","_endLineNumber","_defaultValue","_values","ViewOverlayWidgets","_verticalScrollbarWidth","_minimapWidth","_horizontalScrollbarHeight","horizontalScrollbarHeight","_editorHeight","_editorWidth","widgetData","setRight","widgetHeight","clientHeight","right","_renderWidget","Settings","config","overviewRulerLanes","renderBorder","borderColor","editorOverviewRulerBorder","hideCursor","cursorColor","editorCursorForeground","themeType","minimapEnabled","minimapSide","editorOverviewRulerBackground","TokenizationRegistry","getDefaultBackground","overviewRuler","domWidth","domHeight","canvasWidth","canvasHeight","_this$_initLanes","_initLanes","_this$_initLanes2","w","canvasLeftOffset","laneCount","remainingWidth","leftWidth","rightWidth","centerWidth","centerOffset","Color","DecorationsOverviewRuler","_updateSettings","_tokensColorTrackerListener","onDidChange","changedColorMap","_cursorPositions","newSettings","_settings","compare","affectsOverviewRuler","scrollHeightChanged","editorCtx","setBackgroundColor","Format","CSS","formatHexA","heightRatio","getAllOverviewRulerDecorations","minDecorationHeight","halfMinDecorationHeight","canvasCtx","isOpaque","OverviewRulerDecorationsGroup","cmp","decorationGroup","decorationGroupData","prevLane","prevY1","prevY2","yCenter","cursorHeight","halfCursorHeight","cursorX","cursorW","cursor","beginPath","strokeStyle","moveTo","lineTo","stroke","OverviewRuler","_ViewEventHandler","cssClassName","_zoneManager","OverviewZoneManager","setDOMWidth","setDOMHeight","setOuterHeight","setLineHeight","setPixelRatio","getDOMWidth","getDOMHeight","getCanvasWidth","getCanvasHeight","zones","setZones","getOuterHeight","colorZones","resolveColorZones","id2Color","getId2Color","_renderOneLane","currentColorId","currentFrom","currentTo","zone","zoneColorId","colorId","zoneFrom","zoneTo","to","ViewEventHandler","Rulers","_renderedRulers","_rulers","currentCount","desiredCount","rulerWidth","addCount","removeCount","_ensureRulersCount","ruler","setBoxShadow","ScrollDecorationViewPart","_scrollTop","_width","_updateWidth","_shouldShow","_useShadows","newShouldShow","_updateShouldShow","HorizontalRangeWithStyle","startStyle","endStyle","LineVisibleRangesWithStyle","toStyledRange","item","toStyled","SelectionsOverlay","_previousFrameVisibleRangesWithStyle","_roundedSelection","slice","previousFrame","epsilon","previousFrameTop","previousFrameBottom","topLineNumber","bottomLineNumber","curLineRange","curLeft","curRight","prevLeft","prevRight","nextLeft","nextRight","_visibleRangesHaveGaps","_enrichVisibleRangesWithStyle","output2","hasMultipleSelections","visibleRangesHaveStyle","fullLineHeight","reducedLineHeight","firstLineNumber","lastLineNumber","innerCornerOutput","restOfSelectionOutput","_createSelectionPiece","SELECTION_CLASS_NAME","ROUNDED_PIECE_WIDTH","EDITOR_BACKGROUND_CLASS_NAME","SELECTION_TOP_RIGHT","SELECTION_BOTTOM_RIGHT","SELECTION_TOP_LEFT","SELECTION_BOTTOM_LEFT","thisFrameVisibleRangesWithStyle","visibleRangesWithStyle","_getVisibleRangesWithStyle","_actualRenderOneSelection","_ref","_ref2","editorSelectionForegroundColor","editorSelectionForeground","ViewCursorRenderData","paddingLeft","textContent","textContentClassName","ViewCursor","_cursorStyle","_lineCursorWidth","_position","_lastRenderedContent","pauseAnimation","transitionProperty","_this$_position","lineContent","_strings$getCharConta","_strings$getCharConta2","startOffset","endOffset","substring","_this$_getGraphemeAwa","_getGraphemeAwarePosition","_this$_getGraphemeAwa2","nextGrapheme","TextEditorCursorStyle","Line","LineThin","computeScreenAwareSize","_getTokenClassName","visibleRangeForCharacter","firstVisibleRangeForCharacter","Block","Underline","UnderlineThin","findTokenIndexAtOffset","getClassName","_prepareRender","setPaddingLeft","ViewCursors","_readOnly","_cursorBlinking","_cursorSmoothCaretAnimation","_isComposingInput","_primaryCursor","_secondaryCursors","_updateDomClassName","_startCursorBlinkAnimation","TimeoutTimer","_cursorFlatBlinkInterval","IntervalTimer","_blinkingEnabled","_editorHasFocus","_updateBlinking","secondaryPositions","reason","onCursorPositionChanged","addCnt","newCursor","insertBefore","nextSibling","removeCnt","splice","positions","_onCursorPositionChanged","blinkingStyle","_getCursorBlinking","isHidden","isSolid","_hide","_show","cancelAndSet","BLINK_INTERVAL","setIfNotSet","_getClassName","BlockOutline","show","hide","renderDataLen","primaryRenderData","secondaryRenderData","caret","caretBackground","editorCursorBackground","opposite","invalidFunc","ViewZones","marginDomNode","_zones","whitespaces","getWhitespaces","oldWhitespaces","whitespace","hadAChange","changeWhitespace","whitespaceAccessor","props","_computeWhitespaceProps","delegate","isInHiddenArea","oldWhitespace","afterLineNumber","afterViewLineNumber","heightInPx","changeOneWhitespace","_safeCallOnComputedHeight","_recomputeWhitespacesProps","ordinal","afterColumn","_heightInPixels","minWidthInPx","_minWidthInPixels","zoneAfterModelPosition","zoneBeforeModelPosition","validAfterLineNumber","afterColumnAffinity","isVisible","showInHiddenAreas","callback","zonesHaveChanged","changeAccessor","addZone","_addZone","removeZone","_removeZone","layoutZone","_layoutZone","func","arg1","onUnexpectedError","safeInvoke1Arg","myZone","whitespaceId","insertWhitespace","_getZoneOrdinal","removeWhitespace","heightInLines","onComputedHeight","onDomNodeTop","visibleWhitespaces","visibleZones","hasVisibleZone","visibleWhitespace","newTop","newHeight","newDisplay","verticalOffset","_safeCallOnDomNodeTop","getScrolledTopFromAbsoluteTop","BlockDecorations","blocks","update","didChange","newContentWidth","newContentLeft","blockClassName","block","blockIsAfterEnd","getVerticalOffsetAfterLineNumber","blockDoesNotCollapse","blockPadding","paddingRight","WhitespaceOverlay","_options","WhitespaceOptions","_selection","newOptions","renderWhitespace","selectionsOnLine","maxColumn","LineRange","_applyRenderWhitespace","continuesWithWrappedLine","lastNonWhitespaceIndex","editorWhitespaces","USE_SVG","renderWithSVG","stopRenderingLineAfter","fauxIndentLength","onlyBoundary","onlyTrailing","middotWidth","wsmiddotWidth","renderSpaceCharCode","canUseHalfwidthRightwardsArrow","lineIsEmptyOrWhitespace","firstNonWhitespaceIndex","currentSelectionIndex","currentSelection","maxLeft","prevChCode","nextChCode","prevCharCode","_renderArrow","toFixed","p1","p2","p3","p4","p5","parts","p","experimentalWhitespaceRendering","__decorate","decorators","desc","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","View","commandDelegate","colorTheme","userInputEvents","overflowWidgetsDomNode","_instantiationService","_shouldRecomputeGlyphMarginLanes","_renderAnimationFrame","viewController","ViewController","ViewContext","_viewParts","_textAreaHandler","createInstance","TextAreaHandler","_createTextAreaHandlerHelper","_getEditorClassName","_overflowGuardContainer","_scrollbar","_viewLines","_viewZones","decorationsOverviewRuler","scrollDecoration","contentViewOverlays","ContentViewOverlays","addDynamicOverlay","marginViewOverlays","MarginViewOverlays","LineNumbersOverlay","_glyphMarginWidgets","margin","Margin","_contentWidgets","_viewCursors","_overlayWidgets","rulers","blockOutline","overviewRulerData","parent","textArea","textAreaCover","_pointerHandler","PointerHandler","_createPointerHandlerHelper","setGlyphMarginDecorationLaneCount","_computeGlyphMarginLaneCount","inputLatency","onRenderStart","_renderNow","glyphs","getAllMarginDecorations","GlyphMarginLane","Left","getWidgets","validateRange","leftDecRange","rightDecRange","compareRangesUsingEnds","Right","linesContentDomNode","viewLinesDomNode","focusTextArea","focus","dispatchTextAreaEvent","dispatchEvent","getLastRenderData","lastViewCursorsRenderData","lastTextareaPosition","PointerHandlerLastRenderData","shouldSuppressMouseDownOnViewZone","viewZoneId","shouldSuppressMouseDownOnWidget","getPositionFromDOMInfo","_flushAccumulatedAndRenderNow","getLineWidth","focused","_scheduleRender","affectsGlyphMargin","runAtThisOrScheduleAtNextAnimationFrame","_onRenderScheduled","bind","safeInvokeNoArg","_actualRender","viewPart","isInDOM","viewPartsToRender","_getViewPartsToRender","partialViewportData","getLinesViewportData","setViewport","centeredLineNumber","ViewportData","getWhitespaceViewportData","renderText","renderingContext","RenderingContext","scrollPosition","visibleLinesStabilized","modelLineNumber","modelColumn","clientX","clientY","mouseTarget","getTargetAtClientPoint","ViewUserInputEvents","convertViewToModelMouseTarget","changeViewZones","now","everything","forceShouldRender","writeScreenReaderContent","setAriaOptions","addWidget","layoutContentWidget","_e","_f","_g","_h","setWidgetPosition","secondaryPosition","positionAffinity","removeWidget","layoutOverlayWidget","newPreference","IInstantiationService","ttPolicy","createTrustedTypesPolicy","createHTML","DOMLineBreaksComputerFactory","wrappingIndent","wordBreak","injectedTexts","addRequest","lineText","injectedText","previousLineBreakData","finalize","firstLineBreakColumn","injectedTextsPerLine","createEmptyLineBreakWithPossiblyInjectedText","requestIdx","LineInjectedText","applyInjectedText","injectionOptions","t","injectionOffsets","text","ModelLineProjectionData","overallWidth","additionalIndent","additionalIndentSize","additionalIndentLength","containerDomNode","sb","StringBuilder","firstNonWhitespaceIndices","wrappedTextIndentLengths","renderLineContents","allCharOffsets","allVisibleColumns","wrappedTextIndentLength","indentWidth","renderLineContent","substr","renderLine","html","build","trustedhtml","innerHTML","overflowWrap","createRange","lineDomNodes","children","breakOffsets","readLineBreaks","visibleColumns","breakOffsetsVisibleColumn","curInjectedTexts","createLineBreaks","initialVisibleColumn","wrappingIndentLength","hangingOffset","appendString","charOffset","charOffsets","nextCharCode","producedCharacters","space","appendCharCode","appendASCIICharCode","lineDomNode","spans","discoverBreaks","log","low","lowRects","high","highRects","mid","midRects","setStart","firstChild","setEnd","getClientRects","_readConfig","_lastCursorModelPosition","_activeLineNumber","lineNumbers","_renderLineNumbers","renderType","_renderCustomLineNumbers","renderFn","_renderFinalNewline","_lineNumbersLeft","lineNumbersLeft","_lineNumbersWidth","lineNumbersWidth","primaryViewPosition","viewLineNumber","diff","lineHeightClassName","renderLineNumber","_getLineRenderLineNumber","extraClassName","getLineLength","editorLineNumbersColor","editorLineNumbers","editorDimmedLineNumberColor","editorDimmedLineNumber","RangeUtil","_handyReadyRange","selectNodeContents","startElement","endElement","_createRange","_detachRange","FloatHorizontalRange","prev","clientRects","clientRectDeltaLeft","clientRectScale","_mergeAdjacentRanges","startChildIndex","endChildIndex","_createHorizontalRangesFromClientRects","_readClientRects","canUseFastRenderedViewLine","browser","renderControlCharacters","useMonospaceOptimizations","isMonospace","fontLigatures","_isMaybeInvalid","_renderedViewLine","getViewLineRenderingData","actualInlineDecorations","LineDecoration","inlineDecorations","renderLineInput","RenderLineInput","isBasicASCII","containsRTL","startVisibleColumn","EditorFontLigatures","OFF","renderViewLine","renderedViewLine","containsForeignElements","FastRenderedViewLine","characterMapping","createRenderedLine","toSlowRenderedLine","VisibleRanges","horizontalRanges","_cachedWidth","keyColumnCount","_keyColumnPixelOffsetCache","Float32Array","_characterMapping","_charWidth","horizontalOffset","getHorizontalOffset","_getReadingTarget","expectedWidth","actualWidth","startPosition","_getColumnPixelOffset","endPosition","keyColumnOrdinal","keyColumn","keyColumnPixelOffset","_actualReadPixelOffset","keyColumnHorizontalOffset","myDomNode","domPosition","getDomPosition","readHorizontalRanges","partIndex","spanNodeTextContentLength","spanIndex","previousSibling","getColumn","DomPosition","RenderedViewLine","_isWhitespaceOnly","test","_containsForeignElements","_pixelOffsetCache","_readPixelOffset","_readVisibleRangesForRange","pixelOffset","_readRawVisibleRangesForRange","readingTarget","cachedPixelOffset","expectedResult","startDomPosition","endDomPosition","WebKitRenderedViewLine","_RenderedViewLine","endPixelOffset","lastRange","createWebKitRenderedLine","createNormalRenderedLine","OUTER_CLASS_NAME","_glyphMarginBackgroundDomNode"],"sourceRoot":""}