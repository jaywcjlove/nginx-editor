{"version":3,"file":"static/js/monaco-editor-vendor.a24b52b1.af2b7393.js","mappings":"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","sources":["../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingModel.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/hiddenRangeModel.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingDecorations.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/folding.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/foldingRanges.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/indentRangeProvider.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/folding/browser/syntaxRangeProvider.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/fontZoom/browser/fontZoom.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/format.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formatActions.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/format/browser/formattingEdit.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/markerNavigationService.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoErrorWidget.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/gotoError/browser/gotoError.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/symbolNavigation.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToCommands.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/goToSymbol.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/clickLinkGesture.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/link/goToDefinitionAtPosition.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesTree.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesWidget.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/peek/referencesController.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/contrib/gotoSymbol/browser/referencesModel.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../base/common/event.js';\nimport { FoldingRegions } from './foldingRanges.js';\nimport { hash } from '../../../../base/common/hash.js';\nexport class FoldingModel {\n    get regions() { return this._regions; }\n    get textModel() { return this._textModel; }\n    constructor(textModel, decorationProvider) {\n        this._updateEventEmitter = new Emitter();\n        this.onDidChange = this._updateEventEmitter.event;\n        this._textModel = textModel;\n        this._decorationProvider = decorationProvider;\n        this._regions = new FoldingRegions(new Uint32Array(0), new Uint32Array(0));\n        this._editorDecorationIds = [];\n    }\n    toggleCollapseState(toggledRegions) {\n        if (!toggledRegions.length) {\n            return;\n        }\n        toggledRegions = toggledRegions.sort((r1, r2) => r1.regionIndex - r2.regionIndex);\n        const processed = {};\n        this._decorationProvider.changeDecorations(accessor => {\n            let k = 0; // index from [0 ... this.regions.length]\n            let dirtyRegionEndLine = -1; // end of the range where decorations need to be updated\n            let lastHiddenLine = -1; // the end of the last hidden lines\n            const updateDecorationsUntil = (index) => {\n                while (k < index) {\n                    const endLineNumber = this._regions.getEndLineNumber(k);\n                    const isCollapsed = this._regions.isCollapsed(k);\n                    if (endLineNumber <= dirtyRegionEndLine) {\n                        const isManual = this.regions.getSource(k) !== 0 /* FoldSource.provider */;\n                        accessor.changeDecorationOptions(this._editorDecorationIds[k], this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine, isManual));\n                    }\n                    if (isCollapsed && endLineNumber > lastHiddenLine) {\n                        lastHiddenLine = endLineNumber;\n                    }\n                    k++;\n                }\n            };\n            for (const region of toggledRegions) {\n                const index = region.regionIndex;\n                const editorDecorationId = this._editorDecorationIds[index];\n                if (editorDecorationId && !processed[editorDecorationId]) {\n                    processed[editorDecorationId] = true;\n                    updateDecorationsUntil(index); // update all decorations up to current index using the old dirtyRegionEndLine\n                    const newCollapseState = !this._regions.isCollapsed(index);\n                    this._regions.setCollapsed(index, newCollapseState);\n                    dirtyRegionEndLine = Math.max(dirtyRegionEndLine, this._regions.getEndLineNumber(index));\n                }\n            }\n            updateDecorationsUntil(this._regions.length);\n        });\n        this._updateEventEmitter.fire({ model: this, collapseStateChanged: toggledRegions });\n    }\n    removeManualRanges(ranges) {\n        const newFoldingRanges = new Array();\n        const intersects = (foldRange) => {\n            for (const range of ranges) {\n                if (!(range.startLineNumber > foldRange.endLineNumber || foldRange.startLineNumber > range.endLineNumber)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        for (let i = 0; i < this._regions.length; i++) {\n            const foldRange = this._regions.toFoldRange(i);\n            if (foldRange.source === 0 /* FoldSource.provider */ || !intersects(foldRange)) {\n                newFoldingRanges.push(foldRange);\n            }\n        }\n        this.updatePost(FoldingRegions.fromFoldRanges(newFoldingRanges));\n    }\n    update(newRegions, blockedLineNumers = []) {\n        const foldedOrManualRanges = this._currentFoldedOrManualRanges(blockedLineNumers);\n        const newRanges = FoldingRegions.sanitizeAndMerge(newRegions, foldedOrManualRanges, this._textModel.getLineCount());\n        this.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n    }\n    updatePost(newRegions) {\n        const newEditorDecorations = [];\n        let lastHiddenLine = -1;\n        for (let index = 0, limit = newRegions.length; index < limit; index++) {\n            const startLineNumber = newRegions.getStartLineNumber(index);\n            const endLineNumber = newRegions.getEndLineNumber(index);\n            const isCollapsed = newRegions.isCollapsed(index);\n            const isManual = newRegions.getSource(index) !== 0 /* FoldSource.provider */;\n            const decorationRange = {\n                startLineNumber: startLineNumber,\n                startColumn: this._textModel.getLineMaxColumn(startLineNumber),\n                endLineNumber: endLineNumber,\n                endColumn: this._textModel.getLineMaxColumn(endLineNumber) + 1\n            };\n            newEditorDecorations.push({ range: decorationRange, options: this._decorationProvider.getDecorationOption(isCollapsed, endLineNumber <= lastHiddenLine, isManual) });\n            if (isCollapsed && endLineNumber > lastHiddenLine) {\n                lastHiddenLine = endLineNumber;\n            }\n        }\n        this._decorationProvider.changeDecorations(accessor => this._editorDecorationIds = accessor.deltaDecorations(this._editorDecorationIds, newEditorDecorations));\n        this._regions = newRegions;\n        this._updateEventEmitter.fire({ model: this });\n    }\n    _currentFoldedOrManualRanges(blockedLineNumers = []) {\n        const isBlocked = (startLineNumber, endLineNumber) => {\n            for (const blockedLineNumber of blockedLineNumers) {\n                if (startLineNumber < blockedLineNumber && blockedLineNumber <= endLineNumber) { // first line is visible\n                    return true;\n                }\n            }\n            return false;\n        };\n        const foldedRanges = [];\n        for (let i = 0, limit = this._regions.length; i < limit; i++) {\n            let isCollapsed = this.regions.isCollapsed(i);\n            const source = this.regions.getSource(i);\n            if (isCollapsed || source !== 0 /* FoldSource.provider */) {\n                const foldRange = this._regions.toFoldRange(i);\n                const decRange = this._textModel.getDecorationRange(this._editorDecorationIds[i]);\n                if (decRange) {\n                    if (isCollapsed && isBlocked(decRange.startLineNumber, decRange.endLineNumber)) {\n                        isCollapsed = false; // uncollapse is the range is blocked\n                    }\n                    foldedRanges.push({\n                        startLineNumber: decRange.startLineNumber,\n                        endLineNumber: decRange.endLineNumber,\n                        type: foldRange.type,\n                        isCollapsed,\n                        source\n                    });\n                }\n            }\n        }\n        return foldedRanges;\n    }\n    /**\n     * Collapse state memento, for persistence only\n     */\n    getMemento() {\n        const foldedOrManualRanges = this._currentFoldedOrManualRanges();\n        const result = [];\n        const maxLineNumber = this._textModel.getLineCount();\n        for (let i = 0, limit = foldedOrManualRanges.length; i < limit; i++) {\n            const range = foldedOrManualRanges[i];\n            if (range.startLineNumber >= range.endLineNumber || range.startLineNumber < 1 || range.endLineNumber > maxLineNumber) {\n                continue;\n            }\n            const checksum = this._getLinesChecksum(range.startLineNumber + 1, range.endLineNumber);\n            result.push({\n                startLineNumber: range.startLineNumber,\n                endLineNumber: range.endLineNumber,\n                isCollapsed: range.isCollapsed,\n                source: range.source,\n                checksum: checksum\n            });\n        }\n        return (result.length > 0) ? result : undefined;\n    }\n    /**\n     * Apply persisted state, for persistence only\n     */\n    applyMemento(state) {\n        var _a, _b;\n        if (!Array.isArray(state)) {\n            return;\n        }\n        const rangesToRestore = [];\n        const maxLineNumber = this._textModel.getLineCount();\n        for (const range of state) {\n            if (range.startLineNumber >= range.endLineNumber || range.startLineNumber < 1 || range.endLineNumber > maxLineNumber) {\n                continue;\n            }\n            const checksum = this._getLinesChecksum(range.startLineNumber + 1, range.endLineNumber);\n            if (!range.checksum || checksum === range.checksum) {\n                rangesToRestore.push({\n                    startLineNumber: range.startLineNumber,\n                    endLineNumber: range.endLineNumber,\n                    type: undefined,\n                    isCollapsed: (_a = range.isCollapsed) !== null && _a !== void 0 ? _a : true,\n                    source: (_b = range.source) !== null && _b !== void 0 ? _b : 0 /* FoldSource.provider */\n                });\n            }\n        }\n        const newRanges = FoldingRegions.sanitizeAndMerge(this._regions, rangesToRestore, maxLineNumber);\n        this.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n    }\n    _getLinesChecksum(lineNumber1, lineNumber2) {\n        const h = hash(this._textModel.getLineContent(lineNumber1)\n            + this._textModel.getLineContent(lineNumber2));\n        return h % 1000000; // 6 digits is plenty\n    }\n    dispose() {\n        this._decorationProvider.removeDecorations(this._editorDecorationIds);\n    }\n    getAllRegionsAtLine(lineNumber, filter) {\n        const result = [];\n        if (this._regions) {\n            let index = this._regions.findRange(lineNumber);\n            let level = 1;\n            while (index >= 0) {\n                const current = this._regions.toRegion(index);\n                if (!filter || filter(current, level)) {\n                    result.push(current);\n                }\n                level++;\n                index = current.parentIndex;\n            }\n        }\n        return result;\n    }\n    getRegionAtLine(lineNumber) {\n        if (this._regions) {\n            const index = this._regions.findRange(lineNumber);\n            if (index >= 0) {\n                return this._regions.toRegion(index);\n            }\n        }\n        return null;\n    }\n    getRegionsInside(region, filter) {\n        const result = [];\n        const index = region ? region.regionIndex + 1 : 0;\n        const endLineNumber = region ? region.endLineNumber : Number.MAX_VALUE;\n        if (filter && filter.length === 2) {\n            const levelStack = [];\n            for (let i = index, len = this._regions.length; i < len; i++) {\n                const current = this._regions.toRegion(i);\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\n                    while (levelStack.length > 0 && !current.containedBy(levelStack[levelStack.length - 1])) {\n                        levelStack.pop();\n                    }\n                    levelStack.push(current);\n                    if (filter(current, levelStack.length)) {\n                        result.push(current);\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        else {\n            for (let i = index, len = this._regions.length; i < len; i++) {\n                const current = this._regions.toRegion(i);\n                if (this._regions.getStartLineNumber(i) < endLineNumber) {\n                    if (!filter || filter(current)) {\n                        result.push(current);\n                    }\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        return result;\n    }\n}\n/**\n * Collapse or expand the regions at the given locations\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\n */\nexport function toggleCollapseState(foldingModel, levels, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const region = foldingModel.getRegionAtLine(lineNumber);\n        if (region) {\n            const doCollapse = !region.isCollapsed;\n            toToggle.push(region);\n            if (levels > 1) {\n                const regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n                toToggle.push(...regionsInside);\n            }\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand the regions at the given locations including all children.\n * @param doCollapse Whether to collapse or expand\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand, or if not set, all regions in the model.\n */\nexport function setCollapseStateLevelsDown(foldingModel, doCollapse, levels = Number.MAX_VALUE, lineNumbers) {\n    const toToggle = [];\n    if (lineNumbers && lineNumbers.length > 0) {\n        for (const lineNumber of lineNumbers) {\n            const region = foldingModel.getRegionAtLine(lineNumber);\n            if (region) {\n                if (region.isCollapsed !== doCollapse) {\n                    toToggle.push(region);\n                }\n                if (levels > 1) {\n                    const regionsInside = foldingModel.getRegionsInside(region, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n                    toToggle.push(...regionsInside);\n                }\n            }\n        }\n    }\n    else {\n        const regionsInside = foldingModel.getRegionsInside(null, (r, level) => r.isCollapsed !== doCollapse && level < levels);\n        toToggle.push(...regionsInside);\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand the regions at the given locations including all parents.\n * @param doCollapse Whether to collapse or expand\n * @param levels The number of levels. Use 1 to only impact the regions at the location, use Number.MAX_VALUE for all levels.\n * @param lineNumbers the location of the regions to collapse or expand.\n */\nexport function setCollapseStateLevelsUp(foldingModel, doCollapse, levels, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, (region, level) => region.isCollapsed !== doCollapse && level <= levels);\n        toToggle.push(...regions);\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Collapse or expand a region at the given locations. If the inner most region is already collapsed/expanded, uses the first parent instead.\n * @param doCollapse Whether to collapse or expand\n * @param lineNumbers the location of the regions to collapse or expand.\n */\nexport function setCollapseStateUp(foldingModel, doCollapse, lineNumbers) {\n    const toToggle = [];\n    for (const lineNumber of lineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, (region) => region.isCollapsed !== doCollapse);\n        if (regions.length > 0) {\n            toToggle.push(regions[0]);\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds or unfolds all regions that have a given level, except if they contain one of the blocked lines.\n * @param foldLevel level. Level == 1 is the top level\n * @param doCollapse Whether to collapse or expand\n*/\nexport function setCollapseStateAtLevel(foldingModel, foldLevel, doCollapse, blockedLineNumbers) {\n    const filter = (region, level) => level === foldLevel && region.isCollapsed !== doCollapse && !blockedLineNumbers.some(line => region.containsLine(line));\n    const toToggle = foldingModel.getRegionsInside(null, filter);\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds or unfolds all regions, except if they contain or are contained by a region of one of the blocked lines.\n * @param doCollapse Whether to collapse or expand\n * @param blockedLineNumbers the location of regions to not collapse or expand\n */\nexport function setCollapseStateForRest(foldingModel, doCollapse, blockedLineNumbers) {\n    const filteredRegions = [];\n    for (const lineNumber of blockedLineNumbers) {\n        const regions = foldingModel.getAllRegionsAtLine(lineNumber, undefined);\n        if (regions.length > 0) {\n            filteredRegions.push(regions[0]);\n        }\n    }\n    const filter = (region) => filteredRegions.every((filteredRegion) => !filteredRegion.containedBy(region) && !region.containedBy(filteredRegion)) && region.isCollapsed !== doCollapse;\n    const toToggle = foldingModel.getRegionsInside(null, filter);\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds all regions for which the lines start with a given regex\n * @param foldingModel the folding model\n */\nexport function setCollapseStateForMatchingLines(foldingModel, regExp, doCollapse) {\n    const editorModel = foldingModel.textModel;\n    const regions = foldingModel.regions;\n    const toToggle = [];\n    for (let i = regions.length - 1; i >= 0; i--) {\n        if (doCollapse !== regions.isCollapsed(i)) {\n            const startLineNumber = regions.getStartLineNumber(i);\n            if (regExp.test(editorModel.getLineContent(startLineNumber))) {\n                toToggle.push(regions.toRegion(i));\n            }\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Folds all regions of the given type\n * @param foldingModel the folding model\n */\nexport function setCollapseStateForType(foldingModel, type, doCollapse) {\n    const regions = foldingModel.regions;\n    const toToggle = [];\n    for (let i = regions.length - 1; i >= 0; i--) {\n        if (doCollapse !== regions.isCollapsed(i) && type === regions.getType(i)) {\n            toToggle.push(regions.toRegion(i));\n        }\n    }\n    foldingModel.toggleCollapseState(toToggle);\n}\n/**\n * Get line to go to for parent fold of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Parent fold start line\n */\nexport function getParentFoldLine(lineNumber, foldingModel) {\n    let startLineNumber = null;\n    const foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    if (foldingRegion !== null) {\n        startLineNumber = foldingRegion.startLineNumber;\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to parent fold\n        if (lineNumber === startLineNumber) {\n            const parentFoldingIdx = foldingRegion.parentIndex;\n            if (parentFoldingIdx !== -1) {\n                startLineNumber = foldingModel.regions.getStartLineNumber(parentFoldingIdx);\n            }\n            else {\n                startLineNumber = null;\n            }\n        }\n    }\n    return startLineNumber;\n}\n/**\n * Get line to go to for previous fold at the same level of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Previous fold start line\n */\nexport function getPreviousFoldLine(lineNumber, foldingModel) {\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    // If on the folding range start line, go to previous sibling.\n    if (foldingRegion !== null && foldingRegion.startLineNumber === lineNumber) {\n        // If current line is not the start of the current fold, go to top line of current fold. If not, go to previous fold.\n        if (lineNumber !== foldingRegion.startLineNumber) {\n            return foldingRegion.startLineNumber;\n        }\n        else {\n            // Find min line number to stay within parent.\n            const expectedParentIndex = foldingRegion.parentIndex;\n            let minLineNumber = 0;\n            if (expectedParentIndex !== -1) {\n                minLineNumber = foldingModel.regions.getStartLineNumber(foldingRegion.parentIndex);\n            }\n            // Find fold at same level.\n            while (foldingRegion !== null) {\n                if (foldingRegion.regionIndex > 0) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\n                    // Keep at same level.\n                    if (foldingRegion.startLineNumber <= minLineNumber) {\n                        return null;\n                    }\n                    else if (foldingRegion.parentIndex === expectedParentIndex) {\n                        return foldingRegion.startLineNumber;\n                    }\n                }\n                else {\n                    return null;\n                }\n            }\n        }\n    }\n    else {\n        // Go to last fold that's before the current line.\n        if (foldingModel.regions.length > 0) {\n            foldingRegion = foldingModel.regions.toRegion(foldingModel.regions.length - 1);\n            while (foldingRegion !== null) {\n                // Found fold before current line.\n                if (foldingRegion.startLineNumber < lineNumber) {\n                    return foldingRegion.startLineNumber;\n                }\n                if (foldingRegion.regionIndex > 0) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex - 1);\n                }\n                else {\n                    foldingRegion = null;\n                }\n            }\n        }\n    }\n    return null;\n}\n/**\n * Get line to go to next fold at the same level of current line\n * @param lineNumber the current line number\n * @param foldingModel the folding model\n *\n * @return Next fold start line\n */\nexport function getNextFoldLine(lineNumber, foldingModel) {\n    let foldingRegion = foldingModel.getRegionAtLine(lineNumber);\n    // If on the folding range start line, go to next sibling.\n    if (foldingRegion !== null && foldingRegion.startLineNumber === lineNumber) {\n        // Find max line number to stay within parent.\n        const expectedParentIndex = foldingRegion.parentIndex;\n        let maxLineNumber = 0;\n        if (expectedParentIndex !== -1) {\n            maxLineNumber = foldingModel.regions.getEndLineNumber(foldingRegion.parentIndex);\n        }\n        else if (foldingModel.regions.length === 0) {\n            return null;\n        }\n        else {\n            maxLineNumber = foldingModel.regions.getEndLineNumber(foldingModel.regions.length - 1);\n        }\n        // Find fold at same level.\n        while (foldingRegion !== null) {\n            if (foldingRegion.regionIndex < foldingModel.regions.length) {\n                foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\n                // Keep at same level.\n                if (foldingRegion.startLineNumber >= maxLineNumber) {\n                    return null;\n                }\n                else if (foldingRegion.parentIndex === expectedParentIndex) {\n                    return foldingRegion.startLineNumber;\n                }\n            }\n            else {\n                return null;\n            }\n        }\n    }\n    else {\n        // Go to first fold that's after the current line.\n        if (foldingModel.regions.length > 0) {\n            foldingRegion = foldingModel.regions.toRegion(0);\n            while (foldingRegion !== null) {\n                // Found fold after current line.\n                if (foldingRegion.startLineNumber > lineNumber) {\n                    return foldingRegion.startLineNumber;\n                }\n                if (foldingRegion.regionIndex < foldingModel.regions.length) {\n                    foldingRegion = foldingModel.regions.toRegion(foldingRegion.regionIndex + 1);\n                }\n                else {\n                    foldingRegion = null;\n                }\n            }\n        }\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { findFirstInSorted } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { Range } from '../../../common/core/range.js';\nimport { countEOL } from '../../../common/core/eolCounter.js';\nexport class HiddenRangeModel {\n    get onDidChange() { return this._updateEventEmitter.event; }\n    get hiddenRanges() { return this._hiddenRanges; }\n    constructor(model) {\n        this._updateEventEmitter = new Emitter();\n        this._hasLineChanges = false;\n        this._foldingModel = model;\n        this._foldingModelListener = model.onDidChange(_ => this.updateHiddenRanges());\n        this._hiddenRanges = [];\n        if (model.regions.length) {\n            this.updateHiddenRanges();\n        }\n    }\n    notifyChangeModelContent(e) {\n        if (this._hiddenRanges.length && !this._hasLineChanges) {\n            this._hasLineChanges = e.changes.some(change => {\n                return change.range.endLineNumber !== change.range.startLineNumber || countEOL(change.text)[0] !== 0;\n            });\n        }\n    }\n    updateHiddenRanges() {\n        let updateHiddenAreas = false;\n        const newHiddenAreas = [];\n        let i = 0; // index into hidden\n        let k = 0;\n        let lastCollapsedStart = Number.MAX_VALUE;\n        let lastCollapsedEnd = -1;\n        const ranges = this._foldingModel.regions;\n        for (; i < ranges.length; i++) {\n            if (!ranges.isCollapsed(i)) {\n                continue;\n            }\n            const startLineNumber = ranges.getStartLineNumber(i) + 1; // the first line is not hidden\n            const endLineNumber = ranges.getEndLineNumber(i);\n            if (lastCollapsedStart <= startLineNumber && endLineNumber <= lastCollapsedEnd) {\n                // ignore ranges contained in collapsed regions\n                continue;\n            }\n            if (!updateHiddenAreas && k < this._hiddenRanges.length && this._hiddenRanges[k].startLineNumber === startLineNumber && this._hiddenRanges[k].endLineNumber === endLineNumber) {\n                // reuse the old ranges\n                newHiddenAreas.push(this._hiddenRanges[k]);\n                k++;\n            }\n            else {\n                updateHiddenAreas = true;\n                newHiddenAreas.push(new Range(startLineNumber, 1, endLineNumber, 1));\n            }\n            lastCollapsedStart = startLineNumber;\n            lastCollapsedEnd = endLineNumber;\n        }\n        if (this._hasLineChanges || updateHiddenAreas || k < this._hiddenRanges.length) {\n            this.applyHiddenRanges(newHiddenAreas);\n        }\n    }\n    applyHiddenRanges(newHiddenAreas) {\n        this._hiddenRanges = newHiddenAreas;\n        this._hasLineChanges = false;\n        this._updateEventEmitter.fire(newHiddenAreas);\n    }\n    hasRanges() {\n        return this._hiddenRanges.length > 0;\n    }\n    isHidden(line) {\n        return findRange(this._hiddenRanges, line) !== null;\n    }\n    adjustSelections(selections) {\n        let hasChanges = false;\n        const editorModel = this._foldingModel.textModel;\n        let lastRange = null;\n        const adjustLine = (line) => {\n            if (!lastRange || !isInside(line, lastRange)) {\n                lastRange = findRange(this._hiddenRanges, line);\n            }\n            if (lastRange) {\n                return lastRange.startLineNumber - 1;\n            }\n            return null;\n        };\n        for (let i = 0, len = selections.length; i < len; i++) {\n            let selection = selections[i];\n            const adjustedStartLine = adjustLine(selection.startLineNumber);\n            if (adjustedStartLine) {\n                selection = selection.setStartPosition(adjustedStartLine, editorModel.getLineMaxColumn(adjustedStartLine));\n                hasChanges = true;\n            }\n            const adjustedEndLine = adjustLine(selection.endLineNumber);\n            if (adjustedEndLine) {\n                selection = selection.setEndPosition(adjustedEndLine, editorModel.getLineMaxColumn(adjustedEndLine));\n                hasChanges = true;\n            }\n            selections[i] = selection;\n        }\n        return hasChanges;\n    }\n    dispose() {\n        if (this.hiddenRanges.length > 0) {\n            this._hiddenRanges = [];\n            this._updateEventEmitter.fire(this._hiddenRanges);\n        }\n        if (this._foldingModelListener) {\n            this._foldingModelListener.dispose();\n            this._foldingModelListener = null;\n        }\n    }\n}\nfunction isInside(line, range) {\n    return line >= range.startLineNumber && line <= range.endLineNumber;\n}\nfunction findRange(ranges, line) {\n    const i = findFirstInSorted(ranges, r => line < r.startLineNumber) - 1;\n    if (i >= 0 && ranges[i].endLineNumber >= line) {\n        return ranges[i];\n    }\n    return null;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { MinimapPosition } from '../../../common/model.js';\nimport { ModelDecorationOptions } from '../../../common/model/textModel.js';\nimport { localize } from '../../../../nls.js';\nimport { editorSelectionBackground, iconForeground, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { themeColorFromId } from '../../../../platform/theme/common/themeService.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nconst foldBackground = registerColor('editor.foldBackground', { light: transparent(editorSelectionBackground, 0.3), dark: transparent(editorSelectionBackground, 0.3), hcDark: null, hcLight: null }, localize('foldBackgroundBackground', \"Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations.\"), true);\nregisterColor('editorGutter.foldingControlForeground', { dark: iconForeground, light: iconForeground, hcDark: iconForeground, hcLight: iconForeground }, localize('editorGutter.foldingControlForeground', 'Color of the folding control in the editor gutter.'));\nexport const foldingExpandedIcon = registerIcon('folding-expanded', Codicon.chevronDown, localize('foldingExpandedIcon', 'Icon for expanded ranges in the editor glyph margin.'));\nexport const foldingCollapsedIcon = registerIcon('folding-collapsed', Codicon.chevronRight, localize('foldingCollapsedIcon', 'Icon for collapsed ranges in the editor glyph margin.'));\nexport const foldingManualCollapsedIcon = registerIcon('folding-manual-collapsed', foldingCollapsedIcon, localize('foldingManualCollapedIcon', 'Icon for manually collapsed ranges in the editor glyph margin.'));\nexport const foldingManualExpandedIcon = registerIcon('folding-manual-expanded', foldingExpandedIcon, localize('foldingManualExpandedIcon', 'Icon for manually expanded ranges in the editor glyph margin.'));\nconst foldedBackgroundMinimap = { color: themeColorFromId(foldBackground), position: MinimapPosition.Inline };\nexport class FoldingDecorationProvider {\n    constructor(editor) {\n        this.editor = editor;\n        this.showFoldingControls = 'mouseover';\n        this.showFoldingHighlights = true;\n    }\n    getDecorationOption(isCollapsed, isHidden, isManual) {\n        if (isHidden) { // is inside another collapsed region\n            return FoldingDecorationProvider.HIDDEN_RANGE_DECORATION;\n        }\n        if (this.showFoldingControls === 'never') {\n            if (isCollapsed) {\n                return this.showFoldingHighlights ? FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION : FoldingDecorationProvider.NO_CONTROLS_COLLAPSED_RANGE_DECORATION;\n            }\n            return FoldingDecorationProvider.NO_CONTROLS_EXPANDED_RANGE_DECORATION;\n        }\n        if (isCollapsed) {\n            return isManual ?\n                (this.showFoldingHighlights ? FoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION)\n                : (this.showFoldingHighlights ? FoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION : FoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION);\n        }\n        else if (this.showFoldingControls === 'mouseover') {\n            return isManual ? FoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION : FoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION;\n        }\n        else {\n            return isManual ? FoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION : FoldingDecorationProvider.EXPANDED_VISUAL_DECORATION;\n        }\n    }\n    changeDecorations(callback) {\n        return this.editor.changeDecorations(callback);\n    }\n    removeDecorations(decorationIds) {\n        this.editor.removeDecorations(decorationIds);\n    }\n}\nFoldingDecorationProvider.COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-collapsed-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon),\n});\nFoldingDecorationProvider.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-collapsed-highlighted-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    minimap: foldedBackgroundMinimap,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingCollapsedIcon)\n});\nFoldingDecorationProvider.MANUALLY_COLLAPSED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-collapsed-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualCollapsedIcon)\n});\nFoldingDecorationProvider.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-collapsed-highlighted-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    minimap: foldedBackgroundMinimap,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualCollapsedIcon)\n});\nFoldingDecorationProvider.NO_CONTROLS_COLLAPSED_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-no-controls-range-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    isWholeLine: true\n});\nFoldingDecorationProvider.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-no-controls-range-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    afterContentClassName: 'inline-folded',\n    className: 'folded-background',\n    minimap: foldedBackgroundMinimap,\n    isWholeLine: true\n});\nFoldingDecorationProvider.EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-expanded-visual-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingExpandedIcon)\n});\nFoldingDecorationProvider.EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-expanded-auto-hide-visual-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingExpandedIcon)\n});\nFoldingDecorationProvider.MANUALLY_EXPANDED_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-expanded-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: 'alwaysShowFoldIcons ' + ThemeIcon.asClassName(foldingManualExpandedIcon)\n});\nFoldingDecorationProvider.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-manually-expanded-auto-hide-visual-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true,\n    firstLineDecorationClassName: ThemeIcon.asClassName(foldingManualExpandedIcon)\n});\nFoldingDecorationProvider.NO_CONTROLS_EXPANDED_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-no-controls-range-decoration',\n    stickiness: 0 /* TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges */,\n    isWholeLine: true\n});\nFoldingDecorationProvider.HIDDEN_RANGE_DECORATION = ModelDecorationOptions.register({\n    description: 'folding-hidden-range-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise, Delayer, RunOnceScheduler } from '../../../../base/common/async.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { illegalArgument, onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { escapeRegExpCharacters } from '../../../../base/common/strings.js';\nimport * as types from '../../../../base/common/types.js';\nimport './folding.css';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution, registerInstantiatedEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { FoldingRangeKind } from '../../../common/languages.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { FoldingModel, getNextFoldLine, getParentFoldLine as getParentFoldLine, getPreviousFoldLine, setCollapseStateAtLevel, setCollapseStateForMatchingLines, setCollapseStateForRest, setCollapseStateForType, setCollapseStateLevelsDown, setCollapseStateLevelsUp, setCollapseStateUp, toggleCollapseState } from './foldingModel.js';\nimport { HiddenRangeModel } from './hiddenRangeModel.js';\nimport { IndentRangeProvider } from './indentRangeProvider.js';\nimport * as nls from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { FoldingDecorationProvider } from './foldingDecorations.js';\nimport { FoldingRegions } from './foldingRanges.js';\nimport { SyntaxRangeProvider } from './syntaxRangeProvider.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { IModelService } from '../../../common/services/model.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nconst CONTEXT_FOLDING_ENABLED = new RawContextKey('foldingEnabled', false);\nexport let FoldingController = class FoldingController extends Disposable {\n    static get(editor) {\n        return editor.getContribution(FoldingController.ID);\n    }\n    static getFoldingRangeProviders(languageFeaturesService, model) {\n        var _a, _b;\n        const foldingRangeProviders = languageFeaturesService.foldingRangeProvider.ordered(model);\n        return (_b = ((_a = FoldingController._foldingRangeSelector) === null || _a === void 0 ? void 0 : _a.call(FoldingController, foldingRangeProviders, model))) !== null && _b !== void 0 ? _b : foldingRangeProviders;\n    }\n    constructor(editor, contextKeyService, languageConfigurationService, notificationService, languageFeatureDebounceService, languageFeaturesService) {\n        super();\n        this.contextKeyService = contextKeyService;\n        this.languageConfigurationService = languageConfigurationService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.localToDispose = this._register(new DisposableStore());\n        this.editor = editor;\n        this._foldingLimitReporter = new RangesLimitReporter(editor);\n        const options = this.editor.getOptions();\n        this._isEnabled = options.get(41 /* EditorOption.folding */);\n        this._useFoldingProviders = options.get(42 /* EditorOption.foldingStrategy */) !== 'indentation';\n        this._unfoldOnClickAfterEndOfLine = options.get(46 /* EditorOption.unfoldOnClickAfterEndOfLine */);\n        this._restoringViewState = false;\n        this._currentModelHasFoldedImports = false;\n        this._foldingImportsByDefault = options.get(44 /* EditorOption.foldingImportsByDefault */);\n        this.updateDebounceInfo = languageFeatureDebounceService.for(languageFeaturesService.foldingRangeProvider, 'Folding', { min: 200 });\n        this.foldingModel = null;\n        this.hiddenRangeModel = null;\n        this.rangeProvider = null;\n        this.foldingRegionPromise = null;\n        this.foldingModelPromise = null;\n        this.updateScheduler = null;\n        this.cursorChangedScheduler = null;\n        this.mouseDownInfo = null;\n        this.foldingDecorationProvider = new FoldingDecorationProvider(editor);\n        this.foldingDecorationProvider.showFoldingControls = options.get(106 /* EditorOption.showFoldingControls */);\n        this.foldingDecorationProvider.showFoldingHighlights = options.get(43 /* EditorOption.foldingHighlight */);\n        this.foldingEnabled = CONTEXT_FOLDING_ENABLED.bindTo(this.contextKeyService);\n        this.foldingEnabled.set(this._isEnabled);\n        this._register(this.editor.onDidChangeModel(() => this.onModelChanged()));\n        this._register(this.editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(41 /* EditorOption.folding */)) {\n                this._isEnabled = this.editor.getOptions().get(41 /* EditorOption.folding */);\n                this.foldingEnabled.set(this._isEnabled);\n                this.onModelChanged();\n            }\n            if (e.hasChanged(45 /* EditorOption.foldingMaximumRegions */)) {\n                this.onModelChanged();\n            }\n            if (e.hasChanged(106 /* EditorOption.showFoldingControls */) || e.hasChanged(43 /* EditorOption.foldingHighlight */)) {\n                const options = this.editor.getOptions();\n                this.foldingDecorationProvider.showFoldingControls = options.get(106 /* EditorOption.showFoldingControls */);\n                this.foldingDecorationProvider.showFoldingHighlights = options.get(43 /* EditorOption.foldingHighlight */);\n                this.triggerFoldingModelChanged();\n            }\n            if (e.hasChanged(42 /* EditorOption.foldingStrategy */)) {\n                this._useFoldingProviders = this.editor.getOptions().get(42 /* EditorOption.foldingStrategy */) !== 'indentation';\n                this.onFoldingStrategyChanged();\n            }\n            if (e.hasChanged(46 /* EditorOption.unfoldOnClickAfterEndOfLine */)) {\n                this._unfoldOnClickAfterEndOfLine = this.editor.getOptions().get(46 /* EditorOption.unfoldOnClickAfterEndOfLine */);\n            }\n            if (e.hasChanged(44 /* EditorOption.foldingImportsByDefault */)) {\n                this._foldingImportsByDefault = this.editor.getOptions().get(44 /* EditorOption.foldingImportsByDefault */);\n            }\n        }));\n        this.onModelChanged();\n    }\n    /**\n     * Store view state.\n     */\n    saveViewState() {\n        const model = this.editor.getModel();\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization()) {\n            return {};\n        }\n        if (this.foldingModel) { // disposed ?\n            const collapsedRegions = this.foldingModel.getMemento();\n            const provider = this.rangeProvider ? this.rangeProvider.id : undefined;\n            return { collapsedRegions, lineCount: model.getLineCount(), provider, foldedImports: this._currentModelHasFoldedImports };\n        }\n        return undefined;\n    }\n    /**\n     * Restore view state.\n     */\n    restoreViewState(state) {\n        const model = this.editor.getModel();\n        if (!model || !this._isEnabled || model.isTooLargeForTokenization() || !this.hiddenRangeModel) {\n            return;\n        }\n        if (!state) {\n            return;\n        }\n        this._currentModelHasFoldedImports = !!state.foldedImports;\n        if (state.collapsedRegions && state.collapsedRegions.length > 0 && this.foldingModel) {\n            this._restoringViewState = true;\n            try {\n                this.foldingModel.applyMemento(state.collapsedRegions);\n            }\n            finally {\n                this._restoringViewState = false;\n            }\n        }\n    }\n    onModelChanged() {\n        this.localToDispose.clear();\n        const model = this.editor.getModel();\n        if (!this._isEnabled || !model || model.isTooLargeForTokenization()) {\n            // huge files get no view model, so they cannot support hidden areas\n            return;\n        }\n        this._currentModelHasFoldedImports = false;\n        this.foldingModel = new FoldingModel(model, this.foldingDecorationProvider);\n        this.localToDispose.add(this.foldingModel);\n        this.hiddenRangeModel = new HiddenRangeModel(this.foldingModel);\n        this.localToDispose.add(this.hiddenRangeModel);\n        this.localToDispose.add(this.hiddenRangeModel.onDidChange(hr => this.onHiddenRangesChanges(hr)));\n        this.updateScheduler = new Delayer(this.updateDebounceInfo.get(model));\n        this.cursorChangedScheduler = new RunOnceScheduler(() => this.revealCursor(), 200);\n        this.localToDispose.add(this.cursorChangedScheduler);\n        this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(() => this.onFoldingStrategyChanged()));\n        this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(() => this.onFoldingStrategyChanged())); // covers model language changes as well\n        this.localToDispose.add(this.editor.onDidChangeModelContent(e => this.onDidChangeModelContent(e)));\n        this.localToDispose.add(this.editor.onDidChangeCursorPosition(() => this.onCursorPositionChanged()));\n        this.localToDispose.add(this.editor.onMouseDown(e => this.onEditorMouseDown(e)));\n        this.localToDispose.add(this.editor.onMouseUp(e => this.onEditorMouseUp(e)));\n        this.localToDispose.add({\n            dispose: () => {\n                var _a, _b;\n                if (this.foldingRegionPromise) {\n                    this.foldingRegionPromise.cancel();\n                    this.foldingRegionPromise = null;\n                }\n                (_a = this.updateScheduler) === null || _a === void 0 ? void 0 : _a.cancel();\n                this.updateScheduler = null;\n                this.foldingModel = null;\n                this.foldingModelPromise = null;\n                this.hiddenRangeModel = null;\n                this.cursorChangedScheduler = null;\n                (_b = this.rangeProvider) === null || _b === void 0 ? void 0 : _b.dispose();\n                this.rangeProvider = null;\n            }\n        });\n        this.triggerFoldingModelChanged();\n    }\n    onFoldingStrategyChanged() {\n        var _a;\n        (_a = this.rangeProvider) === null || _a === void 0 ? void 0 : _a.dispose();\n        this.rangeProvider = null;\n        this.triggerFoldingModelChanged();\n    }\n    getRangeProvider(editorModel) {\n        if (this.rangeProvider) {\n            return this.rangeProvider;\n        }\n        const indentRangeProvider = new IndentRangeProvider(editorModel, this.languageConfigurationService, this._foldingLimitReporter);\n        this.rangeProvider = indentRangeProvider; // fallback\n        if (this._useFoldingProviders && this.foldingModel) {\n            const selectedProviders = FoldingController.getFoldingRangeProviders(this.languageFeaturesService, editorModel);\n            if (selectedProviders.length > 0) {\n                this.rangeProvider = new SyntaxRangeProvider(editorModel, selectedProviders, () => this.triggerFoldingModelChanged(), this._foldingLimitReporter, indentRangeProvider);\n            }\n        }\n        return this.rangeProvider;\n    }\n    getFoldingModel() {\n        return this.foldingModelPromise;\n    }\n    onDidChangeModelContent(e) {\n        var _a;\n        (_a = this.hiddenRangeModel) === null || _a === void 0 ? void 0 : _a.notifyChangeModelContent(e);\n        this.triggerFoldingModelChanged();\n    }\n    triggerFoldingModelChanged() {\n        if (this.updateScheduler) {\n            if (this.foldingRegionPromise) {\n                this.foldingRegionPromise.cancel();\n                this.foldingRegionPromise = null;\n            }\n            this.foldingModelPromise = this.updateScheduler.trigger(() => {\n                const foldingModel = this.foldingModel;\n                if (!foldingModel) { // null if editor has been disposed, or folding turned off\n                    return null;\n                }\n                const sw = new StopWatch(true);\n                const provider = this.getRangeProvider(foldingModel.textModel);\n                const foldingRegionPromise = this.foldingRegionPromise = createCancelablePromise(token => provider.compute(token));\n                return foldingRegionPromise.then(foldingRanges => {\n                    if (foldingRanges && foldingRegionPromise === this.foldingRegionPromise) { // new request or cancelled in the meantime?\n                        let scrollState;\n                        if (this._foldingImportsByDefault && !this._currentModelHasFoldedImports) {\n                            const hasChanges = foldingRanges.setCollapsedAllOfType(FoldingRangeKind.Imports.value, true);\n                            if (hasChanges) {\n                                scrollState = StableEditorScrollState.capture(this.editor);\n                                this._currentModelHasFoldedImports = hasChanges;\n                            }\n                        }\n                        // some cursors might have moved into hidden regions, make sure they are in expanded regions\n                        const selections = this.editor.getSelections();\n                        const selectionLineNumbers = selections ? selections.map(s => s.startLineNumber) : [];\n                        foldingModel.update(foldingRanges, selectionLineNumbers);\n                        scrollState === null || scrollState === void 0 ? void 0 : scrollState.restore(this.editor);\n                        // update debounce info\n                        const newValue = this.updateDebounceInfo.update(foldingModel.textModel, sw.elapsed());\n                        if (this.updateScheduler) {\n                            this.updateScheduler.defaultDelay = newValue;\n                        }\n                    }\n                    return foldingModel;\n                });\n            }).then(undefined, (err) => {\n                onUnexpectedError(err);\n                return null;\n            });\n        }\n    }\n    onHiddenRangesChanges(hiddenRanges) {\n        if (this.hiddenRangeModel && hiddenRanges.length && !this._restoringViewState) {\n            const selections = this.editor.getSelections();\n            if (selections) {\n                if (this.hiddenRangeModel.adjustSelections(selections)) {\n                    this.editor.setSelections(selections);\n                }\n            }\n        }\n        this.editor.setHiddenAreas(hiddenRanges, this);\n    }\n    onCursorPositionChanged() {\n        if (this.hiddenRangeModel && this.hiddenRangeModel.hasRanges()) {\n            this.cursorChangedScheduler.schedule();\n        }\n    }\n    revealCursor() {\n        const foldingModel = this.getFoldingModel();\n        if (!foldingModel) {\n            return;\n        }\n        foldingModel.then(foldingModel => {\n            if (foldingModel) {\n                const selections = this.editor.getSelections();\n                if (selections && selections.length > 0) {\n                    const toToggle = [];\n                    for (const selection of selections) {\n                        const lineNumber = selection.selectionStartLineNumber;\n                        if (this.hiddenRangeModel && this.hiddenRangeModel.isHidden(lineNumber)) {\n                            toToggle.push(...foldingModel.getAllRegionsAtLine(lineNumber, r => r.isCollapsed && lineNumber > r.startLineNumber));\n                        }\n                    }\n                    if (toToggle.length) {\n                        foldingModel.toggleCollapseState(toToggle);\n                        this.reveal(selections[0].getPosition());\n                    }\n                }\n            }\n        }).then(undefined, onUnexpectedError);\n    }\n    onEditorMouseDown(e) {\n        this.mouseDownInfo = null;\n        if (!this.hiddenRangeModel || !e.target || !e.target.range) {\n            return;\n        }\n        if (!e.event.leftButton && !e.event.middleButton) {\n            return;\n        }\n        const range = e.target.range;\n        let iconClicked = false;\n        switch (e.target.type) {\n            case 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */: {\n                const data = e.target.detail;\n                const offsetLeftInGutter = e.target.element.offsetLeft;\n                const gutterOffsetX = data.offsetX - offsetLeftInGutter;\n                // const gutterOffsetX = data.offsetX - data.glyphMarginWidth - data.lineNumbersWidth - data.glyphMarginLeft;\n                // TODO@joao TODO@alex TODO@martin this is such that we don't collide with dirty diff\n                if (gutterOffsetX < 5) { // the whitespace between the border and the real folding icon border is 5px\n                    return;\n                }\n                iconClicked = true;\n                break;\n            }\n            case 7 /* MouseTargetType.CONTENT_EMPTY */: {\n                if (this._unfoldOnClickAfterEndOfLine && this.hiddenRangeModel.hasRanges()) {\n                    const data = e.target.detail;\n                    if (!data.isAfterLines) {\n                        break;\n                    }\n                }\n                return;\n            }\n            case 6 /* MouseTargetType.CONTENT_TEXT */: {\n                if (this.hiddenRangeModel.hasRanges()) {\n                    const model = this.editor.getModel();\n                    if (model && range.startColumn === model.getLineMaxColumn(range.startLineNumber)) {\n                        break;\n                    }\n                }\n                return;\n            }\n            default:\n                return;\n        }\n        this.mouseDownInfo = { lineNumber: range.startLineNumber, iconClicked };\n    }\n    onEditorMouseUp(e) {\n        const foldingModel = this.foldingModel;\n        if (!foldingModel || !this.mouseDownInfo || !e.target) {\n            return;\n        }\n        const lineNumber = this.mouseDownInfo.lineNumber;\n        const iconClicked = this.mouseDownInfo.iconClicked;\n        const range = e.target.range;\n        if (!range || range.startLineNumber !== lineNumber) {\n            return;\n        }\n        if (iconClicked) {\n            if (e.target.type !== 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */) {\n                return;\n            }\n        }\n        else {\n            const model = this.editor.getModel();\n            if (!model || range.startColumn !== model.getLineMaxColumn(lineNumber)) {\n                return;\n            }\n        }\n        const region = foldingModel.getRegionAtLine(lineNumber);\n        if (region && region.startLineNumber === lineNumber) {\n            const isCollapsed = region.isCollapsed;\n            if (iconClicked || isCollapsed) {\n                const surrounding = e.event.altKey;\n                let toToggle = [];\n                if (surrounding) {\n                    const filter = (otherRegion) => !otherRegion.containedBy(region) && !region.containedBy(otherRegion);\n                    const toMaybeToggle = foldingModel.getRegionsInside(null, filter);\n                    for (const r of toMaybeToggle) {\n                        if (r.isCollapsed) {\n                            toToggle.push(r);\n                        }\n                    }\n                    // if any surrounding regions are folded, unfold those. Otherwise, fold all surrounding\n                    if (toToggle.length === 0) {\n                        toToggle = toMaybeToggle;\n                    }\n                }\n                else {\n                    const recursive = e.event.middleButton || e.event.shiftKey;\n                    if (recursive) {\n                        for (const r of foldingModel.getRegionsInside(region)) {\n                            if (r.isCollapsed === isCollapsed) {\n                                toToggle.push(r);\n                            }\n                        }\n                    }\n                    // when recursive, first only collapse all children. If all are already folded or there are no children, also fold parent.\n                    if (isCollapsed || !recursive || toToggle.length === 0) {\n                        toToggle.push(region);\n                    }\n                }\n                foldingModel.toggleCollapseState(toToggle);\n                this.reveal({ lineNumber, column: 1 });\n            }\n        }\n    }\n    reveal(position) {\n        this.editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n    }\n};\nFoldingController.ID = 'editor.contrib.folding';\nFoldingController = __decorate([\n    __param(1, IContextKeyService),\n    __param(2, ILanguageConfigurationService),\n    __param(3, INotificationService),\n    __param(4, ILanguageFeatureDebounceService),\n    __param(5, ILanguageFeaturesService)\n], FoldingController);\nexport class RangesLimitReporter {\n    constructor(editor) {\n        this.editor = editor;\n        this._onDidChange = new Emitter();\n        this._computed = 0;\n        this._limited = false;\n    }\n    get limit() {\n        return this.editor.getOptions().get(45 /* EditorOption.foldingMaximumRegions */);\n    }\n    update(computed, limited) {\n        if (computed !== this._computed || limited !== this._limited) {\n            this._computed = computed;\n            this._limited = limited;\n            this._onDidChange.fire();\n        }\n    }\n}\nclass FoldingAction extends EditorAction {\n    runEditorCommand(accessor, editor, args) {\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const foldingController = FoldingController.get(editor);\n        if (!foldingController) {\n            return;\n        }\n        const foldingModelPromise = foldingController.getFoldingModel();\n        if (foldingModelPromise) {\n            this.reportTelemetry(accessor, editor);\n            return foldingModelPromise.then(foldingModel => {\n                if (foldingModel) {\n                    this.invoke(foldingController, foldingModel, editor, args, languageConfigurationService);\n                    const selection = editor.getSelection();\n                    if (selection) {\n                        foldingController.reveal(selection.getStartPosition());\n                    }\n                }\n            });\n        }\n    }\n    getSelectedLines(editor) {\n        const selections = editor.getSelections();\n        return selections ? selections.map(s => s.startLineNumber) : [];\n    }\n    getLineNumbers(args, editor) {\n        if (args && args.selectionLines) {\n            return args.selectionLines.map(l => l + 1); // to 0-bases line numbers\n        }\n        return this.getSelectedLines(editor);\n    }\n    run(_accessor, _editor) {\n    }\n}\nfunction foldingArgumentsConstraint(args) {\n    if (!types.isUndefined(args)) {\n        if (!types.isObject(args)) {\n            return false;\n        }\n        const foldingArgs = args;\n        if (!types.isUndefined(foldingArgs.levels) && !types.isNumber(foldingArgs.levels)) {\n            return false;\n        }\n        if (!types.isUndefined(foldingArgs.direction) && !types.isString(foldingArgs.direction)) {\n            return false;\n        }\n        if (!types.isUndefined(foldingArgs.selectionLines) && (!Array.isArray(foldingArgs.selectionLines) || !foldingArgs.selectionLines.every(types.isNumber))) {\n            return false;\n        }\n    }\n    return true;\n}\nclass UnfoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfold',\n            label: nls.localize('unfoldAction.label', \"Unfold\"),\n            alias: 'Unfold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 94 /* KeyCode.BracketRight */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 94 /* KeyCode.BracketRight */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            description: {\n                description: 'Unfold the content in the editor',\n                args: [\n                    {\n                        name: 'Unfold editor argument',\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t* 'levels': Number of levels to unfold. If not set, defaults to 1.\n\t\t\t\t\t\t* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.\n\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t`,\n                        constraint: foldingArgumentsConstraint,\n                        schema: {\n                            'type': 'object',\n                            'properties': {\n                                'levels': {\n                                    'type': 'number',\n                                    'default': 1\n                                },\n                                'direction': {\n                                    'type': 'string',\n                                    'enum': ['up', 'down'],\n                                    'default': 'down'\n                                },\n                                'selectionLines': {\n                                    'type': 'array',\n                                    'items': {\n                                        'type': 'number'\n                                    }\n                                }\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args) {\n        const levels = args && args.levels || 1;\n        const lineNumbers = this.getLineNumbers(args, editor);\n        if (args && args.direction === 'up') {\n            setCollapseStateLevelsUp(foldingModel, false, levels, lineNumbers);\n        }\n        else {\n            setCollapseStateLevelsDown(foldingModel, false, levels, lineNumbers);\n        }\n    }\n}\nclass UnFoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldRecursively',\n            label: nls.localize('unFoldRecursivelyAction.label', \"Unfold Recursively\"),\n            alias: 'Unfold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 94 /* KeyCode.BracketRight */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, _args) {\n        setCollapseStateLevelsDown(foldingModel, false, Number.MAX_VALUE, this.getSelectedLines(editor));\n    }\n}\nclass FoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.fold',\n            label: nls.localize('foldAction.label', \"Fold\"),\n            alias: 'Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 92 /* KeyCode.BracketLeft */,\n                mac: {\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 512 /* KeyMod.Alt */ | 92 /* KeyCode.BracketLeft */\n                },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            description: {\n                description: 'Fold the content in the editor',\n                args: [\n                    {\n                        name: 'Fold editor argument',\n                        description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t\t\t* 'levels': Number of levels to fold.\n\t\t\t\t\t\t\t* 'direction': If 'up', folds given number of levels up otherwise folds down.\n\t\t\t\t\t\t\t* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.\n\t\t\t\t\t\t\tIf no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.\n\t\t\t\t\t\t`,\n                        constraint: foldingArgumentsConstraint,\n                        schema: {\n                            'type': 'object',\n                            'properties': {\n                                'levels': {\n                                    'type': 'number',\n                                },\n                                'direction': {\n                                    'type': 'string',\n                                    'enum': ['up', 'down'],\n                                },\n                                'selectionLines': {\n                                    'type': 'array',\n                                    'items': {\n                                        'type': 'number'\n                                    }\n                                }\n                            }\n                        }\n                    }\n                ]\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args) {\n        const lineNumbers = this.getLineNumbers(args, editor);\n        const levels = args && args.levels;\n        const direction = args && args.direction;\n        if (typeof levels !== 'number' && typeof direction !== 'string') {\n            // fold the region at the location or if already collapsed, the first uncollapsed parent instead.\n            setCollapseStateUp(foldingModel, true, lineNumbers);\n        }\n        else {\n            if (direction === 'up') {\n                setCollapseStateLevelsUp(foldingModel, true, levels || 1, lineNumbers);\n            }\n            else {\n                setCollapseStateLevelsDown(foldingModel, true, levels || 1, lineNumbers);\n            }\n        }\n    }\n}\nclass ToggleFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.toggleFold',\n            label: nls.localize('toggleFoldAction.label', \"Toggle Fold\"),\n            alias: 'Toggle Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 42 /* KeyCode.KeyL */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        toggleCollapseState(foldingModel, 1, selectedLines);\n    }\n}\nclass FoldRecursivelyAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldRecursively',\n            label: nls.localize('foldRecursivelyAction.label', \"Fold Recursively\"),\n            alias: 'Fold Recursively',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 92 /* KeyCode.BracketLeft */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateLevelsDown(foldingModel, true, Number.MAX_VALUE, selectedLines);\n    }\n}\nclass FoldAllBlockCommentsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllBlockComments',\n            label: nls.localize('foldAllBlockComments.label', \"Fold All Block Comments\"),\n            alias: 'Fold All Block Comments',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 90 /* KeyCode.Slash */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Comment.value, true);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const comments = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).comments;\n            if (comments && comments.blockCommentStartToken) {\n                const regExp = new RegExp('^\\\\s*' + escapeRegExpCharacters(comments.blockCommentStartToken));\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\n            }\n        }\n    }\n}\nclass FoldAllRegionsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllMarkerRegions',\n            label: nls.localize('foldAllMarkerRegions.label', \"Fold All Regions\"),\n            alias: 'Fold All Regions',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 29 /* KeyCode.Digit8 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, true);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const foldingRules = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\n                const regExp = new RegExp(foldingRules.markers.start);\n                setCollapseStateForMatchingLines(foldingModel, regExp, true);\n            }\n        }\n    }\n}\nclass UnfoldAllRegionsAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAllMarkerRegions',\n            label: nls.localize('unfoldAllMarkerRegions.label', \"Unfold All Regions\"),\n            alias: 'Unfold All Regions',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 30 /* KeyCode.Digit9 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor, args, languageConfigurationService) {\n        if (foldingModel.regions.hasTypes()) {\n            setCollapseStateForType(foldingModel, FoldingRangeKind.Region.value, false);\n        }\n        else {\n            const editorModel = editor.getModel();\n            if (!editorModel) {\n                return;\n            }\n            const foldingRules = languageConfigurationService.getLanguageConfiguration(editorModel.getLanguageId()).foldingRules;\n            if (foldingRules && foldingRules.markers && foldingRules.markers.start) {\n                const regExp = new RegExp(foldingRules.markers.start);\n                setCollapseStateForMatchingLines(foldingModel, regExp, false);\n            }\n        }\n    }\n}\nclass FoldAllRegionsExceptAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAllExcept',\n            label: nls.localize('foldAllExcept.label', \"Fold All Regions Except Selected\"),\n            alias: 'Fold All Regions Except Selected',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 88 /* KeyCode.Minus */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateForRest(foldingModel, true, selectedLines);\n    }\n}\nclass UnfoldAllRegionsExceptAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAllExcept',\n            label: nls.localize('unfoldAllExcept.label', \"Unfold All Regions Except Selected\"),\n            alias: 'Unfold All Regions Except Selected',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 86 /* KeyCode.Equal */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        setCollapseStateForRest(foldingModel, false, selectedLines);\n    }\n}\nclass FoldAllAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.foldAll',\n            label: nls.localize('foldAllAction.label', \"Fold All\"),\n            alias: 'Fold All',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 21 /* KeyCode.Digit0 */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, _editor) {\n        setCollapseStateLevelsDown(foldingModel, true);\n    }\n}\nclass UnfoldAllAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.unfoldAll',\n            label: nls.localize('unfoldAllAction.label', \"Unfold All\"),\n            alias: 'Unfold All',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 40 /* KeyCode.KeyJ */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, _editor) {\n        setCollapseStateLevelsDown(foldingModel, false);\n    }\n}\nclass FoldLevelAction extends FoldingAction {\n    getFoldingLevel() {\n        return parseInt(this.id.substr(FoldLevelAction.ID_PREFIX.length));\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        setCollapseStateAtLevel(foldingModel, this.getFoldingLevel(), true, this.getSelectedLines(editor));\n    }\n}\nFoldLevelAction.ID_PREFIX = 'editor.foldLevel';\nFoldLevelAction.ID = (level) => FoldLevelAction.ID_PREFIX + level;\n/** Action to go to the parent fold of current line */\nclass GotoParentFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoParentFold',\n            label: nls.localize('gotoParentFold.label', \"Go to Parent Fold\"),\n            alias: 'Go to Parent Fold',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getParentFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\n/** Action to go to the previous fold of current line */\nclass GotoPreviousFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoPreviousFold',\n            label: nls.localize('gotoPreviousFold.label', \"Go to Previous Folding Range\"),\n            alias: 'Go to Previous Folding Range',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getPreviousFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\n/** Action to go to the next fold of current line */\nclass GotoNextFoldAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.gotoNextFold',\n            label: nls.localize('gotoNextFold.label', \"Go to Next Folding Range\"),\n            alias: 'Go to Next Folding Range',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        const selectedLines = this.getSelectedLines(editor);\n        if (selectedLines.length > 0) {\n            const startLineNumber = getNextFoldLine(selectedLines[0], foldingModel);\n            if (startLineNumber !== null) {\n                editor.setSelection({\n                    startLineNumber: startLineNumber,\n                    startColumn: 1,\n                    endLineNumber: startLineNumber,\n                    endColumn: 1\n                });\n            }\n        }\n    }\n}\nclass FoldRangeFromSelectionAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.createFoldingRangeFromSelection',\n            label: nls.localize('createManualFoldRange.label', \"Create Folding Range from Selection\"),\n            alias: 'Create Folding Range from Selection',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 87 /* KeyCode.Comma */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(_foldingController, foldingModel, editor) {\n        var _a;\n        const collapseRanges = [];\n        const selections = editor.getSelections();\n        if (selections) {\n            for (const selection of selections) {\n                let endLineNumber = selection.endLineNumber;\n                if (selection.endColumn === 1) {\n                    --endLineNumber;\n                }\n                if (endLineNumber > selection.startLineNumber) {\n                    collapseRanges.push({\n                        startLineNumber: selection.startLineNumber,\n                        endLineNumber: endLineNumber,\n                        type: undefined,\n                        isCollapsed: true,\n                        source: 1 /* FoldSource.userDefined */\n                    });\n                    editor.setSelection({\n                        startLineNumber: selection.startLineNumber,\n                        startColumn: 1,\n                        endLineNumber: selection.startLineNumber,\n                        endColumn: 1\n                    });\n                }\n            }\n            if (collapseRanges.length > 0) {\n                collapseRanges.sort((a, b) => {\n                    return a.startLineNumber - b.startLineNumber;\n                });\n                const newRanges = FoldingRegions.sanitizeAndMerge(foldingModel.regions, collapseRanges, (_a = editor.getModel()) === null || _a === void 0 ? void 0 : _a.getLineCount());\n                foldingModel.updatePost(FoldingRegions.fromFoldRanges(newRanges));\n            }\n        }\n    }\n}\nclass RemoveFoldRangeFromSelectionAction extends FoldingAction {\n    constructor() {\n        super({\n            id: 'editor.removeManualFoldingRanges',\n            label: nls.localize('removeManualFoldingRanges.label', \"Remove Manual Folding Ranges\"),\n            alias: 'Remove Manual Folding Ranges',\n            precondition: CONTEXT_FOLDING_ENABLED,\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 89 /* KeyCode.Period */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            }\n        });\n    }\n    invoke(foldingController, foldingModel, editor) {\n        const selections = editor.getSelections();\n        if (selections) {\n            const ranges = [];\n            for (const selection of selections) {\n                const { startLineNumber, endLineNumber } = selection;\n                ranges.push(endLineNumber >= startLineNumber ? { startLineNumber, endLineNumber } : { endLineNumber, startLineNumber });\n            }\n            foldingModel.removeManualRanges(ranges);\n            foldingController.triggerFoldingModelChanged();\n        }\n    }\n}\nregisterEditorContribution(FoldingController.ID, FoldingController, 0 /* EditorContributionInstantiation.Eager */); // eager because it uses `saveViewState`/`restoreViewState`\nregisterEditorAction(UnfoldAction);\nregisterEditorAction(UnFoldRecursivelyAction);\nregisterEditorAction(FoldAction);\nregisterEditorAction(FoldRecursivelyAction);\nregisterEditorAction(FoldAllAction);\nregisterEditorAction(UnfoldAllAction);\nregisterEditorAction(FoldAllBlockCommentsAction);\nregisterEditorAction(FoldAllRegionsAction);\nregisterEditorAction(UnfoldAllRegionsAction);\nregisterEditorAction(FoldAllRegionsExceptAction);\nregisterEditorAction(UnfoldAllRegionsExceptAction);\nregisterEditorAction(ToggleFoldAction);\nregisterEditorAction(GotoParentFoldAction);\nregisterEditorAction(GotoPreviousFoldAction);\nregisterEditorAction(GotoNextFoldAction);\nregisterEditorAction(FoldRangeFromSelectionAction);\nregisterEditorAction(RemoveFoldRangeFromSelectionAction);\nfor (let i = 1; i <= 7; i++) {\n    registerInstantiatedEditorAction(new FoldLevelAction({\n        id: FoldLevelAction.ID(i),\n        label: nls.localize('foldLevelAction.label', \"Fold Level {0}\", i),\n        alias: `Fold Level ${i}`,\n        precondition: CONTEXT_FOLDING_ENABLED,\n        kbOpts: {\n            kbExpr: EditorContextKeys.editorTextFocus,\n            primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | (21 /* KeyCode.Digit0 */ + i)),\n            weight: 100 /* KeybindingWeight.EditorContrib */\n        }\n    }));\n}\nCommandsRegistry.registerCommand('_executeFoldingRangeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource] = args;\n        if (!(resource instanceof URI)) {\n            throw illegalArgument();\n        }\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const model = accessor.get(IModelService).getModel(resource);\n        if (!model) {\n            throw illegalArgument();\n        }\n        const configurationService = accessor.get(IConfigurationService);\n        if (!configurationService.getValue('editor.folding', { resource })) {\n            return [];\n        }\n        const languageConfigurationService = accessor.get(ILanguageConfigurationService);\n        const strategy = configurationService.getValue('editor.foldingStrategy', { resource });\n        const foldingLimitReporter = {\n            get limit() {\n                return configurationService.getValue('editor.foldingMaximumRegions', { resource });\n            },\n            update: (computed, limited) => { }\n        };\n        const indentRangeProvider = new IndentRangeProvider(model, languageConfigurationService, foldingLimitReporter);\n        let rangeProvider = indentRangeProvider;\n        if (strategy !== 'indentation') {\n            const providers = FoldingController.getFoldingRangeProviders(languageFeaturesService, model);\n            if (providers.length) {\n                rangeProvider = new SyntaxRangeProvider(model, providers, () => { }, foldingLimitReporter, indentRangeProvider);\n            }\n        }\n        const ranges = yield rangeProvider.compute(CancellationToken.None);\n        const result = [];\n        try {\n            if (ranges) {\n                for (let i = 0; i < ranges.length; i++) {\n                    const type = ranges.getType(i);\n                    result.push({ start: ranges.getStartLineNumber(i), end: ranges.getEndLineNumber(i), kind: type ? FoldingRangeKind.fromValue(type) : undefined });\n                }\n            }\n            return result;\n        }\n        finally {\n            rangeProvider.dispose();\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport const foldSourceAbbr = {\n    [0 /* FoldSource.provider */]: ' ',\n    [1 /* FoldSource.userDefined */]: 'u',\n    [2 /* FoldSource.recovered */]: 'r',\n};\nexport const MAX_FOLDING_REGIONS = 0xFFFF;\nexport const MAX_LINE_NUMBER = 0xFFFFFF;\nconst MASK_INDENT = 0xFF000000;\nclass BitField {\n    constructor(size) {\n        const numWords = Math.ceil(size / 32);\n        this._states = new Uint32Array(numWords);\n    }\n    get(index) {\n        const arrayIndex = (index / 32) | 0;\n        const bit = index % 32;\n        return (this._states[arrayIndex] & (1 << bit)) !== 0;\n    }\n    set(index, newState) {\n        const arrayIndex = (index / 32) | 0;\n        const bit = index % 32;\n        const value = this._states[arrayIndex];\n        if (newState) {\n            this._states[arrayIndex] = value | (1 << bit);\n        }\n        else {\n            this._states[arrayIndex] = value & ~(1 << bit);\n        }\n    }\n}\nexport class FoldingRegions {\n    constructor(startIndexes, endIndexes, types) {\n        if (startIndexes.length !== endIndexes.length || startIndexes.length > MAX_FOLDING_REGIONS) {\n            throw new Error('invalid startIndexes or endIndexes size');\n        }\n        this._startIndexes = startIndexes;\n        this._endIndexes = endIndexes;\n        this._collapseStates = new BitField(startIndexes.length);\n        this._userDefinedStates = new BitField(startIndexes.length);\n        this._recoveredStates = new BitField(startIndexes.length);\n        this._types = types;\n        this._parentsComputed = false;\n    }\n    ensureParentIndices() {\n        if (!this._parentsComputed) {\n            this._parentsComputed = true;\n            const parentIndexes = [];\n            const isInsideLast = (startLineNumber, endLineNumber) => {\n                const index = parentIndexes[parentIndexes.length - 1];\n                return this.getStartLineNumber(index) <= startLineNumber && this.getEndLineNumber(index) >= endLineNumber;\n            };\n            for (let i = 0, len = this._startIndexes.length; i < len; i++) {\n                const startLineNumber = this._startIndexes[i];\n                const endLineNumber = this._endIndexes[i];\n                if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n                    throw new Error('startLineNumber or endLineNumber must not exceed ' + MAX_LINE_NUMBER);\n                }\n                while (parentIndexes.length > 0 && !isInsideLast(startLineNumber, endLineNumber)) {\n                    parentIndexes.pop();\n                }\n                const parentIndex = parentIndexes.length > 0 ? parentIndexes[parentIndexes.length - 1] : -1;\n                parentIndexes.push(i);\n                this._startIndexes[i] = startLineNumber + ((parentIndex & 0xFF) << 24);\n                this._endIndexes[i] = endLineNumber + ((parentIndex & 0xFF00) << 16);\n            }\n        }\n    }\n    get length() {\n        return this._startIndexes.length;\n    }\n    getStartLineNumber(index) {\n        return this._startIndexes[index] & MAX_LINE_NUMBER;\n    }\n    getEndLineNumber(index) {\n        return this._endIndexes[index] & MAX_LINE_NUMBER;\n    }\n    getType(index) {\n        return this._types ? this._types[index] : undefined;\n    }\n    hasTypes() {\n        return !!this._types;\n    }\n    isCollapsed(index) {\n        return this._collapseStates.get(index);\n    }\n    setCollapsed(index, newState) {\n        this._collapseStates.set(index, newState);\n    }\n    isUserDefined(index) {\n        return this._userDefinedStates.get(index);\n    }\n    setUserDefined(index, newState) {\n        return this._userDefinedStates.set(index, newState);\n    }\n    isRecovered(index) {\n        return this._recoveredStates.get(index);\n    }\n    setRecovered(index, newState) {\n        return this._recoveredStates.set(index, newState);\n    }\n    getSource(index) {\n        if (this.isUserDefined(index)) {\n            return 1 /* FoldSource.userDefined */;\n        }\n        else if (this.isRecovered(index)) {\n            return 2 /* FoldSource.recovered */;\n        }\n        return 0 /* FoldSource.provider */;\n    }\n    setSource(index, source) {\n        if (source === 1 /* FoldSource.userDefined */) {\n            this.setUserDefined(index, true);\n            this.setRecovered(index, false);\n        }\n        else if (source === 2 /* FoldSource.recovered */) {\n            this.setUserDefined(index, false);\n            this.setRecovered(index, true);\n        }\n        else {\n            this.setUserDefined(index, false);\n            this.setRecovered(index, false);\n        }\n    }\n    setCollapsedAllOfType(type, newState) {\n        let hasChanged = false;\n        if (this._types) {\n            for (let i = 0; i < this._types.length; i++) {\n                if (this._types[i] === type) {\n                    this.setCollapsed(i, newState);\n                    hasChanged = true;\n                }\n            }\n        }\n        return hasChanged;\n    }\n    toRegion(index) {\n        return new FoldingRegion(this, index);\n    }\n    getParentIndex(index) {\n        this.ensureParentIndices();\n        const parent = ((this._startIndexes[index] & MASK_INDENT) >>> 24) + ((this._endIndexes[index] & MASK_INDENT) >>> 16);\n        if (parent === MAX_FOLDING_REGIONS) {\n            return -1;\n        }\n        return parent;\n    }\n    contains(index, line) {\n        return this.getStartLineNumber(index) <= line && this.getEndLineNumber(index) >= line;\n    }\n    findIndex(line) {\n        let low = 0, high = this._startIndexes.length;\n        if (high === 0) {\n            return -1; // no children\n        }\n        while (low < high) {\n            const mid = Math.floor((low + high) / 2);\n            if (line < this.getStartLineNumber(mid)) {\n                high = mid;\n            }\n            else {\n                low = mid + 1;\n            }\n        }\n        return low - 1;\n    }\n    findRange(line) {\n        let index = this.findIndex(line);\n        if (index >= 0) {\n            const endLineNumber = this.getEndLineNumber(index);\n            if (endLineNumber >= line) {\n                return index;\n            }\n            index = this.getParentIndex(index);\n            while (index !== -1) {\n                if (this.contains(index, line)) {\n                    return index;\n                }\n                index = this.getParentIndex(index);\n            }\n        }\n        return -1;\n    }\n    toString() {\n        const res = [];\n        for (let i = 0; i < this.length; i++) {\n            res[i] = `[${foldSourceAbbr[this.getSource(i)]}${this.isCollapsed(i) ? '+' : '-'}] ${this.getStartLineNumber(i)}/${this.getEndLineNumber(i)}`;\n        }\n        return res.join(', ');\n    }\n    toFoldRange(index) {\n        return {\n            startLineNumber: this._startIndexes[index] & MAX_LINE_NUMBER,\n            endLineNumber: this._endIndexes[index] & MAX_LINE_NUMBER,\n            type: this._types ? this._types[index] : undefined,\n            isCollapsed: this.isCollapsed(index),\n            source: this.getSource(index)\n        };\n    }\n    static fromFoldRanges(ranges) {\n        const rangesLength = ranges.length;\n        const startIndexes = new Uint32Array(rangesLength);\n        const endIndexes = new Uint32Array(rangesLength);\n        let types = [];\n        let gotTypes = false;\n        for (let i = 0; i < rangesLength; i++) {\n            const range = ranges[i];\n            startIndexes[i] = range.startLineNumber;\n            endIndexes[i] = range.endLineNumber;\n            types.push(range.type);\n            if (range.type) {\n                gotTypes = true;\n            }\n        }\n        if (!gotTypes) {\n            types = undefined;\n        }\n        const regions = new FoldingRegions(startIndexes, endIndexes, types);\n        for (let i = 0; i < rangesLength; i++) {\n            if (ranges[i].isCollapsed) {\n                regions.setCollapsed(i, true);\n            }\n            regions.setSource(i, ranges[i].source);\n        }\n        return regions;\n    }\n    /**\n     * Two inputs, each a FoldingRegions or a FoldRange[], are merged.\n     * Each input must be pre-sorted on startLineNumber.\n     * The first list is assumed to always include all regions currently defined by range providers.\n     * The second list only contains the previously collapsed and all manual ranges.\n     * If the line position matches, the range of the new range is taken, and the range is no longer manual\n     * When an entry in one list overlaps an entry in the other, the second list's entry \"wins\" and\n     * overlapping entries in the first list are discarded.\n     * Invalid entries are discarded. An entry is invalid if:\n     * \t\tthe start and end line numbers aren't a valid range of line numbers,\n     * \t\tit is out of sequence or has the same start line as a preceding entry,\n     * \t\tit overlaps a preceding entry and is not fully contained by that entry.\n     */\n    static sanitizeAndMerge(rangesA, rangesB, maxLineNumber) {\n        maxLineNumber = maxLineNumber !== null && maxLineNumber !== void 0 ? maxLineNumber : Number.MAX_VALUE;\n        const getIndexedFunction = (r, limit) => {\n            return Array.isArray(r)\n                ? ((i) => { return (i < limit) ? r[i] : undefined; })\n                : ((i) => { return (i < limit) ? r.toFoldRange(i) : undefined; });\n        };\n        const getA = getIndexedFunction(rangesA, rangesA.length);\n        const getB = getIndexedFunction(rangesB, rangesB.length);\n        let indexA = 0;\n        let indexB = 0;\n        let nextA = getA(0);\n        let nextB = getB(0);\n        const stackedRanges = [];\n        let topStackedRange;\n        let prevLineNumber = 0;\n        const resultRanges = [];\n        while (nextA || nextB) {\n            let useRange = undefined;\n            if (nextB && (!nextA || nextA.startLineNumber >= nextB.startLineNumber)) {\n                if (nextA && nextA.startLineNumber === nextB.startLineNumber) {\n                    if (nextB.source === 1 /* FoldSource.userDefined */) {\n                        // a user defined range (possibly unfolded)\n                        useRange = nextB;\n                    }\n                    else {\n                        // a previously folded range or a (possibly unfolded) recovered range\n                        useRange = nextA;\n                        useRange.isCollapsed = nextB.isCollapsed && nextA.endLineNumber === nextB.endLineNumber;\n                        useRange.source = 0 /* FoldSource.provider */;\n                    }\n                    nextA = getA(++indexA); // not necessary, just for speed\n                }\n                else {\n                    useRange = nextB;\n                    if (nextB.isCollapsed && nextB.source === 0 /* FoldSource.provider */) {\n                        // a previously collapsed range\n                        useRange.source = 2 /* FoldSource.recovered */;\n                    }\n                }\n                nextB = getB(++indexB);\n            }\n            else {\n                // nextA is next. The user folded B set takes precedence and we sometimes need to look\n                // ahead in it to check for an upcoming conflict.\n                let scanIndex = indexB;\n                let prescanB = nextB;\n                while (true) {\n                    if (!prescanB || prescanB.startLineNumber > nextA.endLineNumber) {\n                        useRange = nextA;\n                        break; // no conflict, use this nextA\n                    }\n                    if (prescanB.source === 1 /* FoldSource.userDefined */ && prescanB.endLineNumber > nextA.endLineNumber) {\n                        // we found a user folded range, it wins\n                        break; // without setting nextResult, so this nextA gets skipped\n                    }\n                    prescanB = getB(++scanIndex);\n                }\n                nextA = getA(++indexA);\n            }\n            if (useRange) {\n                while (topStackedRange\n                    && topStackedRange.endLineNumber < useRange.startLineNumber) {\n                    topStackedRange = stackedRanges.pop();\n                }\n                if (useRange.endLineNumber > useRange.startLineNumber\n                    && useRange.startLineNumber > prevLineNumber\n                    && useRange.endLineNumber <= maxLineNumber\n                    && (!topStackedRange\n                        || topStackedRange.endLineNumber >= useRange.endLineNumber)) {\n                    resultRanges.push(useRange);\n                    prevLineNumber = useRange.startLineNumber;\n                    if (topStackedRange) {\n                        stackedRanges.push(topStackedRange);\n                    }\n                    topStackedRange = useRange;\n                }\n            }\n        }\n        return resultRanges;\n    }\n}\nexport class FoldingRegion {\n    constructor(ranges, index) {\n        this.ranges = ranges;\n        this.index = index;\n    }\n    get startLineNumber() {\n        return this.ranges.getStartLineNumber(this.index);\n    }\n    get endLineNumber() {\n        return this.ranges.getEndLineNumber(this.index);\n    }\n    get regionIndex() {\n        return this.index;\n    }\n    get parentIndex() {\n        return this.ranges.getParentIndex(this.index);\n    }\n    get isCollapsed() {\n        return this.ranges.isCollapsed(this.index);\n    }\n    containedBy(range) {\n        return range.startLineNumber <= this.startLineNumber && range.endLineNumber >= this.endLineNumber;\n    }\n    containsLine(lineNumber) {\n        return this.startLineNumber <= lineNumber && lineNumber <= this.endLineNumber;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { computeIndentLevel } from '../../../common/model/utils.js';\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\nconst MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT = 5000;\nconst ID_INDENT_PROVIDER = 'indent';\nexport class IndentRangeProvider {\n    constructor(editorModel, languageConfigurationService, foldingRangesLimit) {\n        this.editorModel = editorModel;\n        this.languageConfigurationService = languageConfigurationService;\n        this.foldingRangesLimit = foldingRangesLimit;\n        this.id = ID_INDENT_PROVIDER;\n    }\n    dispose() { }\n    compute(cancelationToken) {\n        const foldingRules = this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules;\n        const offSide = foldingRules && !!foldingRules.offSide;\n        const markers = foldingRules && foldingRules.markers;\n        return Promise.resolve(computeRanges(this.editorModel, offSide, markers, this.foldingRangesLimit));\n    }\n}\n// public only for testing\nexport class RangesCollector {\n    constructor(foldingRangesLimit) {\n        this._startIndexes = [];\n        this._endIndexes = [];\n        this._indentOccurrences = [];\n        this._length = 0;\n        this._foldingRangesLimit = foldingRangesLimit;\n    }\n    insertFirst(startLineNumber, endLineNumber, indent) {\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n            return;\n        }\n        const index = this._length;\n        this._startIndexes[index] = startLineNumber;\n        this._endIndexes[index] = endLineNumber;\n        this._length++;\n        if (indent < 1000) {\n            this._indentOccurrences[indent] = (this._indentOccurrences[indent] || 0) + 1;\n        }\n    }\n    toIndentRanges(model) {\n        const limit = this._foldingRangesLimit.limit;\n        if (this._length <= limit) {\n            this._foldingRangesLimit.update(this._length, false);\n            // reverse and create arrays of the exact length\n            const startIndexes = new Uint32Array(this._length);\n            const endIndexes = new Uint32Array(this._length);\n            for (let i = this._length - 1, k = 0; i >= 0; i--, k++) {\n                startIndexes[k] = this._startIndexes[i];\n                endIndexes[k] = this._endIndexes[i];\n            }\n            return new FoldingRegions(startIndexes, endIndexes);\n        }\n        else {\n            this._foldingRangesLimit.update(this._length, limit);\n            let entries = 0;\n            let maxIndent = this._indentOccurrences.length;\n            for (let i = 0; i < this._indentOccurrences.length; i++) {\n                const n = this._indentOccurrences[i];\n                if (n) {\n                    if (n + entries > limit) {\n                        maxIndent = i;\n                        break;\n                    }\n                    entries += n;\n                }\n            }\n            const tabSize = model.getOptions().tabSize;\n            // reverse and create arrays of the exact length\n            const startIndexes = new Uint32Array(limit);\n            const endIndexes = new Uint32Array(limit);\n            for (let i = this._length - 1, k = 0; i >= 0; i--) {\n                const startIndex = this._startIndexes[i];\n                const lineContent = model.getLineContent(startIndex);\n                const indent = computeIndentLevel(lineContent, tabSize);\n                if (indent < maxIndent || (indent === maxIndent && entries++ < limit)) {\n                    startIndexes[k] = startIndex;\n                    endIndexes[k] = this._endIndexes[i];\n                    k++;\n                }\n            }\n            return new FoldingRegions(startIndexes, endIndexes);\n        }\n    }\n}\nconst foldingRangesLimitDefault = {\n    limit: MAX_FOLDING_REGIONS_FOR_INDENT_DEFAULT,\n    update: () => { }\n};\nexport function computeRanges(model, offSide, markers, foldingRangesLimit = foldingRangesLimitDefault) {\n    const tabSize = model.getOptions().tabSize;\n    const result = new RangesCollector(foldingRangesLimit);\n    let pattern = undefined;\n    if (markers) {\n        pattern = new RegExp(`(${markers.start.source})|(?:${markers.end.source})`);\n    }\n    const previousRegions = [];\n    const line = model.getLineCount() + 1;\n    previousRegions.push({ indent: -1, endAbove: line, line }); // sentinel, to make sure there's at least one entry\n    for (let line = model.getLineCount(); line > 0; line--) {\n        const lineContent = model.getLineContent(line);\n        const indent = computeIndentLevel(lineContent, tabSize);\n        let previous = previousRegions[previousRegions.length - 1];\n        if (indent === -1) {\n            if (offSide) {\n                // for offSide languages, empty lines are associated to the previous block\n                // note: the next block is already written to the results, so this only\n                // impacts the end position of the block before\n                previous.endAbove = line;\n            }\n            continue; // only whitespace\n        }\n        let m;\n        if (pattern && (m = lineContent.match(pattern))) {\n            // folding pattern match\n            if (m[1]) { // start pattern match\n                // discard all regions until the folding pattern\n                let i = previousRegions.length - 1;\n                while (i > 0 && previousRegions[i].indent !== -2) {\n                    i--;\n                }\n                if (i > 0) {\n                    previousRegions.length = i + 1;\n                    previous = previousRegions[i];\n                    // new folding range from pattern, includes the end line\n                    result.insertFirst(line, previous.line, indent);\n                    previous.line = line;\n                    previous.indent = indent;\n                    previous.endAbove = line;\n                    continue;\n                }\n                else {\n                    // no end marker found, treat line as a regular line\n                }\n            }\n            else { // end pattern match\n                previousRegions.push({ indent: -2, endAbove: line, line });\n                continue;\n            }\n        }\n        if (previous.indent > indent) {\n            // discard all regions with larger indent\n            do {\n                previousRegions.pop();\n                previous = previousRegions[previousRegions.length - 1];\n            } while (previous.indent > indent);\n            // new folding range\n            const endLineNumber = previous.endAbove - 1;\n            if (endLineNumber - line >= 1) { // needs at east size 1\n                result.insertFirst(line, endLineNumber, indent);\n            }\n        }\n        if (previous.indent === indent) {\n            previous.endAbove = line;\n        }\n        else { // previous.indent < indent\n            // new region with a bigger indent\n            previousRegions.push({ indent, endAbove: line, line });\n        }\n    }\n    return result.toIndentRanges(model);\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { FoldingRegions, MAX_LINE_NUMBER } from './foldingRanges.js';\nconst foldingContext = {};\nconst ID_SYNTAX_PROVIDER = 'syntax';\nexport class SyntaxRangeProvider {\n    constructor(editorModel, providers, handleFoldingRangesChange, foldingRangesLimit, fallbackRangeProvider // used when all providers return null\n    ) {\n        this.editorModel = editorModel;\n        this.providers = providers;\n        this.handleFoldingRangesChange = handleFoldingRangesChange;\n        this.foldingRangesLimit = foldingRangesLimit;\n        this.fallbackRangeProvider = fallbackRangeProvider;\n        this.id = ID_SYNTAX_PROVIDER;\n        this.disposables = new DisposableStore();\n        if (fallbackRangeProvider) {\n            this.disposables.add(fallbackRangeProvider);\n        }\n        for (const provider of providers) {\n            if (typeof provider.onDidChange === 'function') {\n                this.disposables.add(provider.onDidChange(handleFoldingRangesChange));\n            }\n        }\n    }\n    compute(cancellationToken) {\n        return collectSyntaxRanges(this.providers, this.editorModel, cancellationToken).then(ranges => {\n            var _a, _b;\n            if (ranges) {\n                const res = sanitizeRanges(ranges, this.foldingRangesLimit);\n                return res;\n            }\n            return (_b = (_a = this.fallbackRangeProvider) === null || _a === void 0 ? void 0 : _a.compute(cancellationToken)) !== null && _b !== void 0 ? _b : null;\n        });\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nfunction collectSyntaxRanges(providers, model, cancellationToken) {\n    let rangeData = null;\n    const promises = providers.map((provider, i) => {\n        return Promise.resolve(provider.provideFoldingRanges(model, foldingContext, cancellationToken)).then(ranges => {\n            if (cancellationToken.isCancellationRequested) {\n                return;\n            }\n            if (Array.isArray(ranges)) {\n                if (!Array.isArray(rangeData)) {\n                    rangeData = [];\n                }\n                const nLines = model.getLineCount();\n                for (const r of ranges) {\n                    if (r.start > 0 && r.end > r.start && r.end <= nLines) {\n                        rangeData.push({ start: r.start, end: r.end, rank: i, kind: r.kind });\n                    }\n                }\n            }\n        }, onUnexpectedExternalError);\n    });\n    return Promise.all(promises).then(_ => {\n        return rangeData;\n    });\n}\nclass RangesCollector {\n    constructor(foldingRangesLimit) {\n        this._startIndexes = [];\n        this._endIndexes = [];\n        this._nestingLevels = [];\n        this._nestingLevelCounts = [];\n        this._types = [];\n        this._length = 0;\n        this._foldingRangesLimit = foldingRangesLimit;\n    }\n    add(startLineNumber, endLineNumber, type, nestingLevel) {\n        if (startLineNumber > MAX_LINE_NUMBER || endLineNumber > MAX_LINE_NUMBER) {\n            return;\n        }\n        const index = this._length;\n        this._startIndexes[index] = startLineNumber;\n        this._endIndexes[index] = endLineNumber;\n        this._nestingLevels[index] = nestingLevel;\n        this._types[index] = type;\n        this._length++;\n        if (nestingLevel < 30) {\n            this._nestingLevelCounts[nestingLevel] = (this._nestingLevelCounts[nestingLevel] || 0) + 1;\n        }\n    }\n    toIndentRanges() {\n        const limit = this._foldingRangesLimit.limit;\n        if (this._length <= limit) {\n            this._foldingRangesLimit.update(this._length, false);\n            const startIndexes = new Uint32Array(this._length);\n            const endIndexes = new Uint32Array(this._length);\n            for (let i = 0; i < this._length; i++) {\n                startIndexes[i] = this._startIndexes[i];\n                endIndexes[i] = this._endIndexes[i];\n            }\n            return new FoldingRegions(startIndexes, endIndexes, this._types);\n        }\n        else {\n            this._foldingRangesLimit.update(this._length, limit);\n            let entries = 0;\n            let maxLevel = this._nestingLevelCounts.length;\n            for (let i = 0; i < this._nestingLevelCounts.length; i++) {\n                const n = this._nestingLevelCounts[i];\n                if (n) {\n                    if (n + entries > limit) {\n                        maxLevel = i;\n                        break;\n                    }\n                    entries += n;\n                }\n            }\n            const startIndexes = new Uint32Array(limit);\n            const endIndexes = new Uint32Array(limit);\n            const types = [];\n            for (let i = 0, k = 0; i < this._length; i++) {\n                const level = this._nestingLevels[i];\n                if (level < maxLevel || (level === maxLevel && entries++ < limit)) {\n                    startIndexes[k] = this._startIndexes[i];\n                    endIndexes[k] = this._endIndexes[i];\n                    types[k] = this._types[i];\n                    k++;\n                }\n            }\n            return new FoldingRegions(startIndexes, endIndexes, types);\n        }\n    }\n}\nexport function sanitizeRanges(rangeData, foldingRangesLimit) {\n    const sorted = rangeData.sort((d1, d2) => {\n        let diff = d1.start - d2.start;\n        if (diff === 0) {\n            diff = d1.rank - d2.rank;\n        }\n        return diff;\n    });\n    const collector = new RangesCollector(foldingRangesLimit);\n    let top = undefined;\n    const previous = [];\n    for (const entry of sorted) {\n        if (!top) {\n            top = entry;\n            collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n        }\n        else {\n            if (entry.start > top.start) {\n                if (entry.end <= top.end) {\n                    previous.push(top);\n                    top = entry;\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n                }\n                else {\n                    if (entry.start > top.end) {\n                        do {\n                            top = previous.pop();\n                        } while (top && entry.start > top.end);\n                        if (top) {\n                            previous.push(top);\n                        }\n                        top = entry;\n                    }\n                    collector.add(entry.start, entry.end, entry.kind && entry.kind.value, previous.length);\n                }\n            }\n        }\n    }\n    return collector.toIndentRanges();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditorAction, registerEditorAction } from '../../../browser/editorExtensions.js';\nimport { EditorZoom } from '../../../common/config/editorZoom.js';\nimport * as nls from '../../../../nls.js';\nclass EditorFontZoomIn extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomIn',\n            label: nls.localize('EditorFontZoomIn.label', \"Editor Font Zoom In\"),\n            alias: 'Editor Font Zoom In',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() + 1);\n    }\n}\nclass EditorFontZoomOut extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomOut',\n            label: nls.localize('EditorFontZoomOut.label', \"Editor Font Zoom Out\"),\n            alias: 'Editor Font Zoom Out',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(EditorZoom.getZoomLevel() - 1);\n    }\n}\nclass EditorFontZoomReset extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.fontZoomReset',\n            label: nls.localize('EditorFontZoomReset.label', \"Editor Font Zoom Reset\"),\n            alias: 'Editor Font Zoom Reset',\n            precondition: undefined\n        });\n    }\n    run(accessor, editor) {\n        EditorZoom.setZoomLevel(0);\n    }\n}\nregisterEditorAction(EditorFontZoomIn);\nregisterEditorAction(EditorFontZoomOut);\nregisterEditorAction(EditorFontZoomReset);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { asArray, isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource, TextModelCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { Selection } from '../../../common/core/selection.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ITextModelService } from '../../../common/services/resolverService.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry } from '../../../../platform/commands/common/commands.js';\nimport { ExtensionIdentifierSet } from '../../../../platform/extensions/common/extensions.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nexport function alertFormattingEdits(edits) {\n    edits = edits.filter(edit => edit.range);\n    if (!edits.length) {\n        return;\n    }\n    let { range } = edits[0];\n    for (let i = 1; i < edits.length; i++) {\n        range = Range.plusRange(range, edits[i].range);\n    }\n    const { startLineNumber, endLineNumber } = range;\n    if (startLineNumber === endLineNumber) {\n        if (edits.length === 1) {\n            alert(nls.localize('hint11', \"Made 1 formatting edit on line {0}\", startLineNumber));\n        }\n        else {\n            alert(nls.localize('hintn1', \"Made {0} formatting edits on line {1}\", edits.length, startLineNumber));\n        }\n    }\n    else {\n        if (edits.length === 1) {\n            alert(nls.localize('hint1n', \"Made 1 formatting edit between lines {0} and {1}\", startLineNumber, endLineNumber));\n        }\n        else {\n            alert(nls.localize('hintnn', \"Made {0} formatting edits between lines {1} and {2}\", edits.length, startLineNumber, endLineNumber));\n        }\n    }\n}\nexport function getRealAndSyntheticDocumentFormattersOrdered(documentFormattingEditProvider, documentRangeFormattingEditProvider, model) {\n    const result = [];\n    const seen = new ExtensionIdentifierSet();\n    // (1) add all document formatter\n    const docFormatter = documentFormattingEditProvider.ordered(model);\n    for (const formatter of docFormatter) {\n        result.push(formatter);\n        if (formatter.extensionId) {\n            seen.add(formatter.extensionId);\n        }\n    }\n    // (2) add all range formatter as document formatter (unless the same extension already did that)\n    const rangeFormatter = documentRangeFormattingEditProvider.ordered(model);\n    for (const formatter of rangeFormatter) {\n        if (formatter.extensionId) {\n            if (seen.has(formatter.extensionId)) {\n                continue;\n            }\n            seen.add(formatter.extensionId);\n        }\n        result.push({\n            displayName: formatter.displayName,\n            extensionId: formatter.extensionId,\n            provideDocumentFormattingEdits(model, options, token) {\n                return formatter.provideDocumentRangeFormattingEdits(model, model.getFullModelRange(), options, token);\n            }\n        });\n    }\n    return result;\n}\nexport class FormattingConflicts {\n    static setFormatterSelector(selector) {\n        const remove = FormattingConflicts._selectors.unshift(selector);\n        return { dispose: remove };\n    }\n    static select(formatter, document, mode) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (formatter.length === 0) {\n                return undefined;\n            }\n            const selector = Iterable.first(FormattingConflicts._selectors);\n            if (selector) {\n                return yield selector(formatter, document, mode);\n            }\n            return undefined;\n        });\n    }\n}\nFormattingConflicts._selectors = new LinkedList();\nexport function formatDocumentRangesWithSelectedProvider(accessor, editorOrModel, rangeOrRanges, mode, progress, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const instaService = accessor.get(IInstantiationService);\n        const { documentRangeFormattingEditProvider: documentRangeFormattingEditProviderRegistry } = accessor.get(ILanguageFeaturesService);\n        const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n        const provider = documentRangeFormattingEditProviderRegistry.ordered(model);\n        const selected = yield FormattingConflicts.select(provider, model, mode);\n        if (selected) {\n            progress.report(selected);\n            yield instaService.invokeFunction(formatDocumentRangesWithProvider, selected, editorOrModel, rangeOrRanges, token);\n        }\n    });\n}\nexport function formatDocumentRangesWithProvider(accessor, provider, editorOrModel, rangeOrRanges, token) {\n    var _a, _b;\n    return __awaiter(this, void 0, void 0, function* () {\n        const workerService = accessor.get(IEditorWorkerService);\n        const logService = accessor.get(ILogService);\n        let model;\n        let cts;\n        if (isCodeEditor(editorOrModel)) {\n            model = editorOrModel.getModel();\n            cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n        }\n        else {\n            model = editorOrModel;\n            cts = new TextModelCancellationTokenSource(editorOrModel, token);\n        }\n        // make sure that ranges don't overlap nor touch each other\n        const ranges = [];\n        let len = 0;\n        for (const range of asArray(rangeOrRanges).sort(Range.compareRangesUsingStarts)) {\n            if (len > 0 && Range.areIntersectingOrTouching(ranges[len - 1], range)) {\n                ranges[len - 1] = Range.fromPositions(ranges[len - 1].getStartPosition(), range.getEndPosition());\n            }\n            else {\n                len = ranges.push(range);\n            }\n        }\n        const computeEdits = (range) => __awaiter(this, void 0, void 0, function* () {\n            var _c, _d;\n            logService.trace(`[format][provideDocumentRangeFormattingEdits] (request)`, (_c = provider.extensionId) === null || _c === void 0 ? void 0 : _c.value, range);\n            const result = (yield provider.provideDocumentRangeFormattingEdits(model, range, model.getFormattingOptions(), cts.token)) || [];\n            logService.trace(`[format][provideDocumentRangeFormattingEdits] (response)`, (_d = provider.extensionId) === null || _d === void 0 ? void 0 : _d.value, result);\n            return result;\n        });\n        const hasIntersectingEdit = (a, b) => {\n            if (!a.length || !b.length) {\n                return false;\n            }\n            // quick exit if the list of ranges are completely unrelated [O(n)]\n            const mergedA = a.reduce((acc, val) => { return Range.plusRange(acc, val.range); }, a[0].range);\n            if (!b.some(x => { return Range.intersectRanges(mergedA, x.range); })) {\n                return false;\n            }\n            // fallback to a complete check [O(n^2)]\n            for (const edit of a) {\n                for (const otherEdit of b) {\n                    if (Range.intersectRanges(edit.range, otherEdit.range)) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        };\n        const allEdits = [];\n        const rawEditsList = [];\n        try {\n            if (typeof provider.provideDocumentRangesFormattingEdits === 'function') {\n                logService.trace(`[format][provideDocumentRangeFormattingEdits] (request)`, (_a = provider.extensionId) === null || _a === void 0 ? void 0 : _a.value, ranges);\n                const result = (yield provider.provideDocumentRangesFormattingEdits(model, ranges, model.getFormattingOptions(), cts.token)) || [];\n                logService.trace(`[format][provideDocumentRangeFormattingEdits] (response)`, (_b = provider.extensionId) === null || _b === void 0 ? void 0 : _b.value, result);\n                rawEditsList.push(result);\n            }\n            else {\n                for (const range of ranges) {\n                    if (cts.token.isCancellationRequested) {\n                        return true;\n                    }\n                    rawEditsList.push(yield computeEdits(range));\n                }\n                for (let i = 0; i < ranges.length; ++i) {\n                    for (let j = i + 1; j < ranges.length; ++j) {\n                        if (cts.token.isCancellationRequested) {\n                            return true;\n                        }\n                        if (hasIntersectingEdit(rawEditsList[i], rawEditsList[j])) {\n                            // Merge ranges i and j into a single range, recompute the associated edits\n                            const mergedRange = Range.plusRange(ranges[i], ranges[j]);\n                            const edits = yield computeEdits(mergedRange);\n                            ranges.splice(j, 1);\n                            ranges.splice(i, 1);\n                            ranges.push(mergedRange);\n                            rawEditsList.splice(j, 1);\n                            rawEditsList.splice(i, 1);\n                            rawEditsList.push(edits);\n                            // Restart scanning\n                            i = 0;\n                            j = 0;\n                        }\n                    }\n                }\n            }\n            for (const rawEdits of rawEditsList) {\n                if (cts.token.isCancellationRequested) {\n                    return true;\n                }\n                const minimalEdits = yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n                if (minimalEdits) {\n                    allEdits.push(...minimalEdits);\n                }\n            }\n        }\n        finally {\n            cts.dispose();\n        }\n        if (allEdits.length === 0) {\n            return false;\n        }\n        if (isCodeEditor(editorOrModel)) {\n            // use editor to apply edits\n            FormattingEdit.execute(editorOrModel, allEdits, true);\n            alertFormattingEdits(allEdits);\n            editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n        }\n        else {\n            // use model to apply edits\n            const [{ range }] = allEdits;\n            const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n            model.pushEditOperations([initialSelection], allEdits.map(edit => {\n                return {\n                    text: edit.text,\n                    range: Range.lift(edit.range),\n                    forceMoveMarkers: true\n                };\n            }), undoEdits => {\n                for (const { range } of undoEdits) {\n                    if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                        return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                    }\n                }\n                return null;\n            });\n        }\n        return true;\n    });\n}\nexport function formatDocumentWithSelectedProvider(accessor, editorOrModel, mode, progress, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const instaService = accessor.get(IInstantiationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const model = isCodeEditor(editorOrModel) ? editorOrModel.getModel() : editorOrModel;\n        const provider = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n        const selected = yield FormattingConflicts.select(provider, model, mode);\n        if (selected) {\n            progress.report(selected);\n            yield instaService.invokeFunction(formatDocumentWithProvider, selected, editorOrModel, mode, token);\n        }\n    });\n}\nexport function formatDocumentWithProvider(accessor, provider, editorOrModel, mode, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const workerService = accessor.get(IEditorWorkerService);\n        let model;\n        let cts;\n        if (isCodeEditor(editorOrModel)) {\n            model = editorOrModel.getModel();\n            cts = new EditorStateCancellationTokenSource(editorOrModel, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */, undefined, token);\n        }\n        else {\n            model = editorOrModel;\n            cts = new TextModelCancellationTokenSource(editorOrModel, token);\n        }\n        let edits;\n        try {\n            const rawEdits = yield provider.provideDocumentFormattingEdits(model, model.getFormattingOptions(), cts.token);\n            edits = yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            if (cts.token.isCancellationRequested) {\n                return true;\n            }\n        }\n        finally {\n            cts.dispose();\n        }\n        if (!edits || edits.length === 0) {\n            return false;\n        }\n        if (isCodeEditor(editorOrModel)) {\n            // use editor to apply edits\n            FormattingEdit.execute(editorOrModel, edits, mode !== 2 /* FormattingMode.Silent */);\n            if (mode !== 2 /* FormattingMode.Silent */) {\n                alertFormattingEdits(edits);\n                editorOrModel.revealPositionInCenterIfOutsideViewport(editorOrModel.getPosition(), 1 /* ScrollType.Immediate */);\n            }\n        }\n        else {\n            // use model to apply edits\n            const [{ range }] = edits;\n            const initialSelection = new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\n            model.pushEditOperations([initialSelection], edits.map(edit => {\n                return {\n                    text: edit.text,\n                    range: Range.lift(edit.range),\n                    forceMoveMarkers: true\n                };\n            }), undoEdits => {\n                for (const { range } of undoEdits) {\n                    if (Range.areIntersectingOrTouching(range, initialSelection)) {\n                        return [new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn)];\n                    }\n                }\n                return null;\n            });\n        }\n        return true;\n    });\n}\nexport function getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, model, range, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = languageFeaturesService.documentRangeFormattingEditProvider.ordered(model);\n        for (const provider of providers) {\n            const rawEdits = yield Promise.resolve(provider.provideDocumentRangeFormattingEdits(model, range, options, token)).catch(onUnexpectedExternalError);\n            if (isNonEmptyArray(rawEdits)) {\n                return yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            }\n        }\n        return undefined;\n    });\n}\nexport function getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, model, options, token) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const providers = getRealAndSyntheticDocumentFormattersOrdered(languageFeaturesService.documentFormattingEditProvider, languageFeaturesService.documentRangeFormattingEditProvider, model);\n        for (const provider of providers) {\n            const rawEdits = yield Promise.resolve(provider.provideDocumentFormattingEdits(model, options, token)).catch(onUnexpectedExternalError);\n            if (isNonEmptyArray(rawEdits)) {\n                return yield workerService.computeMoreMinimalEdits(model.uri, rawEdits);\n            }\n        }\n        return undefined;\n    });\n}\nexport function getOnTypeFormattingEdits(workerService, languageFeaturesService, model, position, ch, options, token) {\n    const providers = languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n    if (providers.length === 0) {\n        return Promise.resolve(undefined);\n    }\n    if (providers[0].autoFormatTriggerCharacters.indexOf(ch) < 0) {\n        return Promise.resolve(undefined);\n    }\n    return Promise.resolve(providers[0].provideOnTypeFormattingEdits(model, position, ch, options, token)).catch(onUnexpectedExternalError).then(edits => {\n        return workerService.computeMoreMinimalEdits(model.uri, edits);\n    });\n}\nCommandsRegistry.registerCommand('_executeFormatRangeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, range, options] = args;\n        assertType(URI.isUri(resource));\n        assertType(Range.isIRange(range));\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getDocumentRangeFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, Range.lift(range), options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\nCommandsRegistry.registerCommand('_executeFormatDocumentProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, options] = args;\n        assertType(URI.isUri(resource));\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getDocumentFormattingEditsUntilResult(workerService, languageFeaturesService, reference.object.textEditorModel, options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\nCommandsRegistry.registerCommand('_executeFormatOnTypeProvider', function (accessor, ...args) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const [resource, position, ch, options] = args;\n        assertType(URI.isUri(resource));\n        assertType(Position.isIPosition(position));\n        assertType(typeof ch === 'string');\n        const resolverService = accessor.get(ITextModelService);\n        const workerService = accessor.get(IEditorWorkerService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const reference = yield resolverService.createModelReference(resource);\n        try {\n            return getOnTypeFormattingEdits(workerService, languageFeaturesService, reference.object.textEditorModel, Position.lift(position), ch, options, CancellationToken.None);\n        }\n        finally {\n            reference.dispose();\n        }\n    });\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, registerEditorAction, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { CharacterSet } from '../../../common/core/characterClassifier.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IEditorWorkerService } from '../../../common/services/editorWorker.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { alertFormattingEdits, formatDocumentRangesWithSelectedProvider, formatDocumentWithSelectedProvider, getOnTypeFormattingEdits } from './format.js';\nimport { FormattingEdit } from './formattingEdit.js';\nimport * as nls from '../../../../nls.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IEditorProgressService, Progress } from '../../../../platform/progress/common/progress.js';\nlet FormatOnType = class FormatOnType {\n    constructor(_editor, _languageFeaturesService, _workerService) {\n        this._editor = _editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._workerService = _workerService;\n        this._disposables = new DisposableStore();\n        this._sessionDisposables = new DisposableStore();\n        this._disposables.add(_languageFeaturesService.onTypeFormattingEditProvider.onDidChange(this._update, this));\n        this._disposables.add(_editor.onDidChangeModel(() => this._update()));\n        this._disposables.add(_editor.onDidChangeModelLanguage(() => this._update()));\n        this._disposables.add(_editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(54 /* EditorOption.formatOnType */)) {\n                this._update();\n            }\n        }));\n        this._update();\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._sessionDisposables.dispose();\n    }\n    _update() {\n        // clean up\n        this._sessionDisposables.clear();\n        // we are disabled\n        if (!this._editor.getOption(54 /* EditorOption.formatOnType */)) {\n            return;\n        }\n        // no model\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        // no support\n        const [support] = this._languageFeaturesService.onTypeFormattingEditProvider.ordered(model);\n        if (!support || !support.autoFormatTriggerCharacters) {\n            return;\n        }\n        // register typing listeners that will trigger the format\n        const triggerChars = new CharacterSet();\n        for (const ch of support.autoFormatTriggerCharacters) {\n            triggerChars.add(ch.charCodeAt(0));\n        }\n        this._sessionDisposables.add(this._editor.onDidType((text) => {\n            const lastCharCode = text.charCodeAt(text.length - 1);\n            if (triggerChars.has(lastCharCode)) {\n                this._trigger(String.fromCharCode(lastCharCode));\n            }\n        }));\n    }\n    _trigger(ch) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        if (this._editor.getSelections().length > 1 || !this._editor.getSelection().isEmpty()) {\n            return;\n        }\n        const model = this._editor.getModel();\n        const position = this._editor.getPosition();\n        const cts = new CancellationTokenSource();\n        // install a listener that checks if edits happens before the\n        // position on which we format right now. If so, we won't\n        // apply the format edits\n        const unbind = this._editor.onDidChangeModelContent((e) => {\n            if (e.isFlush) {\n                // a model.setValue() was called\n                // cancel only once\n                cts.cancel();\n                unbind.dispose();\n                return;\n            }\n            for (let i = 0, len = e.changes.length; i < len; i++) {\n                const change = e.changes[i];\n                if (change.range.endLineNumber <= position.lineNumber) {\n                    // cancel only once\n                    cts.cancel();\n                    unbind.dispose();\n                    return;\n                }\n            }\n        });\n        getOnTypeFormattingEdits(this._workerService, this._languageFeaturesService, model, position, ch, model.getFormattingOptions(), cts.token).then(edits => {\n            if (cts.token.isCancellationRequested) {\n                return;\n            }\n            if (isNonEmptyArray(edits)) {\n                FormattingEdit.execute(this._editor, edits, true);\n                alertFormattingEdits(edits);\n            }\n        }).finally(() => {\n            unbind.dispose();\n        });\n    }\n};\nFormatOnType.ID = 'editor.contrib.autoFormat';\nFormatOnType = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IEditorWorkerService)\n], FormatOnType);\nlet FormatOnPaste = class FormatOnPaste {\n    constructor(editor, _languageFeaturesService, _instantiationService) {\n        this.editor = editor;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._instantiationService = _instantiationService;\n        this._callOnDispose = new DisposableStore();\n        this._callOnModel = new DisposableStore();\n        this._callOnDispose.add(editor.onDidChangeConfiguration(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModel(() => this._update()));\n        this._callOnDispose.add(editor.onDidChangeModelLanguage(() => this._update()));\n        this._callOnDispose.add(_languageFeaturesService.documentRangeFormattingEditProvider.onDidChange(this._update, this));\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        this._callOnModel.dispose();\n    }\n    _update() {\n        // clean up\n        this._callOnModel.clear();\n        // we are disabled\n        if (!this.editor.getOption(53 /* EditorOption.formatOnPaste */)) {\n            return;\n        }\n        // no model\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        // no formatter\n        if (!this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())) {\n            return;\n        }\n        this._callOnModel.add(this.editor.onDidPaste(({ range }) => this._trigger(range)));\n    }\n    _trigger(range) {\n        if (!this.editor.hasModel()) {\n            return;\n        }\n        if (this.editor.getSelections().length > 1) {\n            return;\n        }\n        this._instantiationService.invokeFunction(formatDocumentRangesWithSelectedProvider, this.editor, range, 2 /* FormattingMode.Silent */, Progress.None, CancellationToken.None).catch(onUnexpectedError);\n    }\n};\nFormatOnPaste.ID = 'editor.contrib.formatOnPaste';\nFormatOnPaste = __decorate([\n    __param(1, ILanguageFeaturesService),\n    __param(2, IInstantiationService)\n], FormatOnPaste);\nclass FormatDocumentAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatDocument',\n            label: nls.localize('formatDocument.label', \"Format Document\"),\n            alias: 'Format Document',\n            precondition: ContextKeyExpr.and(EditorContextKeys.notInCompositeEditor, EditorContextKeys.writable, EditorContextKeys.hasDocumentFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 36 /* KeyCode.KeyF */,\n                linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 39 /* KeyCode.KeyI */ },\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                group: '1_modification',\n                order: 1.3\n            }\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (editor.hasModel()) {\n                const instaService = accessor.get(IInstantiationService);\n                const progressService = accessor.get(IEditorProgressService);\n                yield progressService.showWhile(instaService.invokeFunction(formatDocumentWithSelectedProvider, editor, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None), 250);\n            }\n        });\n    }\n}\nclass FormatSelectionAction extends EditorAction {\n    constructor() {\n        super({\n            id: 'editor.action.formatSelection',\n            label: nls.localize('formatSelection.label', \"Format Selection\"),\n            alias: 'Format Selection',\n            precondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasDocumentSelectionFormattingProvider),\n            kbOpts: {\n                kbExpr: EditorContextKeys.editorTextFocus,\n                primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 2048 /* KeyMod.CtrlCmd */ | 36 /* KeyCode.KeyF */),\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            contextMenuOpts: {\n                when: EditorContextKeys.hasNonEmptySelection,\n                group: '1_modification',\n                order: 1.31\n            }\n        });\n    }\n    run(accessor, editor) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!editor.hasModel()) {\n                return;\n            }\n            const instaService = accessor.get(IInstantiationService);\n            const model = editor.getModel();\n            const ranges = editor.getSelections().map(range => {\n                return range.isEmpty()\n                    ? new Range(range.startLineNumber, 1, range.startLineNumber, model.getLineMaxColumn(range.startLineNumber))\n                    : range;\n            });\n            const progressService = accessor.get(IEditorProgressService);\n            yield progressService.showWhile(instaService.invokeFunction(formatDocumentRangesWithSelectedProvider, editor, ranges, 1 /* FormattingMode.Explicit */, Progress.None, CancellationToken.None), 250);\n        });\n    }\n}\nregisterEditorContribution(FormatOnType.ID, FormatOnType, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorContribution(FormatOnPaste.ID, FormatOnPaste, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\nregisterEditorAction(FormatDocumentAction);\nregisterEditorAction(FormatSelectionAction);\n// this is the old format action that does both (format document OR format selection)\n// and we keep it here such that existing keybinding configurations etc will still work\nCommandsRegistry.registerCommand('editor.action.format', (accessor) => __awaiter(void 0, void 0, void 0, function* () {\n    const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n    if (!editor || !editor.hasModel()) {\n        return;\n    }\n    const commandService = accessor.get(ICommandService);\n    if (editor.getSelection().isEmpty()) {\n        yield commandService.executeCommand('editor.action.formatDocument');\n    }\n    else {\n        yield commandService.executeCommand('editor.action.formatSelection');\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Range } from '../../../common/core/range.js';\nimport { StableEditorScrollState } from '../../../browser/stableEditorScroll.js';\nexport class FormattingEdit {\n    static _handleEolEdits(editor, edits) {\n        let newEol = undefined;\n        const singleEdits = [];\n        for (const edit of edits) {\n            if (typeof edit.eol === 'number') {\n                newEol = edit.eol;\n            }\n            if (edit.range && typeof edit.text === 'string') {\n                singleEdits.push(edit);\n            }\n        }\n        if (typeof newEol === 'number') {\n            if (editor.hasModel()) {\n                editor.getModel().pushEOL(newEol);\n            }\n        }\n        return singleEdits;\n    }\n    static _isFullModelReplaceEdit(editor, edit) {\n        if (!editor.hasModel()) {\n            return false;\n        }\n        const model = editor.getModel();\n        const editRange = model.validateRange(edit.range);\n        const fullModelRange = model.getFullModelRange();\n        return fullModelRange.equalsRange(editRange);\n    }\n    static execute(editor, _edits, addUndoStops) {\n        if (addUndoStops) {\n            editor.pushUndoStop();\n        }\n        const scrollState = StableEditorScrollState.capture(editor);\n        const edits = FormattingEdit._handleEolEdits(editor, _edits);\n        if (edits.length === 1 && FormattingEdit._isFullModelReplaceEdit(editor, edits[0])) {\n            // We use replace semantics and hope that markers stay put...\n            editor.executeEdits('formatEditsCommand', edits.map(edit => EditOperation.replace(Range.lift(edit.range), edit.text)));\n        }\n        else {\n            editor.executeEdits('formatEditsCommand', edits.map(edit => EditOperation.replaceMove(Range.lift(edit.range), edit.text)));\n        }\n        if (addUndoStops) {\n            editor.pushUndoStop();\n        }\n        scrollState.restoreRelativeVerticalPositionOfCursor(editor);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { LinkedList } from '../../../../base/common/linkedList.js';\nimport { compare } from '../../../../base/common/strings.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { Range } from '../../../common/core/range.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IMarkerService, MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nexport class MarkerCoordinate {\n    constructor(marker, index, total) {\n        this.marker = marker;\n        this.index = index;\n        this.total = total;\n    }\n}\nexport let MarkerList = class MarkerList {\n    constructor(resourceFilter, _markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._dispoables = new DisposableStore();\n        this._markers = [];\n        this._nextIdx = -1;\n        if (URI.isUri(resourceFilter)) {\n            this._resourceFilter = uri => uri.toString() === resourceFilter.toString();\n        }\n        else if (resourceFilter) {\n            this._resourceFilter = resourceFilter;\n        }\n        const compareOrder = this._configService.getValue('problems.sortOrder');\n        const compareMarker = (a, b) => {\n            let res = compare(a.resource.toString(), b.resource.toString());\n            if (res === 0) {\n                if (compareOrder === 'position') {\n                    res = Range.compareRangesUsingStarts(a, b) || MarkerSeverity.compare(a.severity, b.severity);\n                }\n                else {\n                    res = MarkerSeverity.compare(a.severity, b.severity) || Range.compareRangesUsingStarts(a, b);\n                }\n            }\n            return res;\n        };\n        const updateMarker = () => {\n            this._markers = this._markerService.read({\n                resource: URI.isUri(resourceFilter) ? resourceFilter : undefined,\n                severities: MarkerSeverity.Error | MarkerSeverity.Warning | MarkerSeverity.Info\n            });\n            if (typeof resourceFilter === 'function') {\n                this._markers = this._markers.filter(m => this._resourceFilter(m.resource));\n            }\n            this._markers.sort(compareMarker);\n        };\n        updateMarker();\n        this._dispoables.add(_markerService.onMarkerChanged(uris => {\n            if (!this._resourceFilter || uris.some(uri => this._resourceFilter(uri))) {\n                updateMarker();\n                this._nextIdx = -1;\n                this._onDidChange.fire();\n            }\n        }));\n    }\n    dispose() {\n        this._dispoables.dispose();\n        this._onDidChange.dispose();\n    }\n    matches(uri) {\n        if (!this._resourceFilter && !uri) {\n            return true;\n        }\n        if (!this._resourceFilter || !uri) {\n            return false;\n        }\n        return this._resourceFilter(uri);\n    }\n    get selected() {\n        const marker = this._markers[this._nextIdx];\n        return marker && new MarkerCoordinate(marker, this._nextIdx + 1, this._markers.length);\n    }\n    _initIdx(model, position, fwd) {\n        let found = false;\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === model.uri.toString());\n        if (idx < 0) {\n            idx = binarySearch(this._markers, { resource: model.uri }, (a, b) => compare(a.resource.toString(), b.resource.toString()));\n            if (idx < 0) {\n                idx = ~idx;\n            }\n        }\n        for (let i = idx; i < this._markers.length; i++) {\n            let range = Range.lift(this._markers[i]);\n            if (range.isEmpty()) {\n                const word = model.getWordAtPosition(range.getStartPosition());\n                if (word) {\n                    range = new Range(range.startLineNumber, word.startColumn, range.startLineNumber, word.endColumn);\n                }\n            }\n            if (position && (range.containsPosition(position) || position.isBeforeOrEqual(range.getStartPosition()))) {\n                this._nextIdx = i;\n                found = true;\n                break;\n            }\n            if (this._markers[i].resource.toString() !== model.uri.toString()) {\n                break;\n            }\n        }\n        if (!found) {\n            // after the last change\n            this._nextIdx = fwd ? 0 : this._markers.length - 1;\n        }\n        if (this._nextIdx < 0) {\n            this._nextIdx = this._markers.length - 1;\n        }\n    }\n    resetIndex() {\n        this._nextIdx = -1;\n    }\n    move(fwd, model, position) {\n        if (this._markers.length === 0) {\n            return false;\n        }\n        const oldIdx = this._nextIdx;\n        if (this._nextIdx === -1) {\n            this._initIdx(model, position, fwd);\n        }\n        else if (fwd) {\n            this._nextIdx = (this._nextIdx + 1) % this._markers.length;\n        }\n        else if (!fwd) {\n            this._nextIdx = (this._nextIdx - 1 + this._markers.length) % this._markers.length;\n        }\n        if (oldIdx !== this._nextIdx) {\n            return true;\n        }\n        return false;\n    }\n    find(uri, position) {\n        let idx = this._markers.findIndex(marker => marker.resource.toString() === uri.toString());\n        if (idx < 0) {\n            return undefined;\n        }\n        for (; idx < this._markers.length; idx++) {\n            if (Range.containsPosition(this._markers[idx], position)) {\n                return new MarkerCoordinate(this._markers[idx], idx + 1, this._markers.length);\n            }\n        }\n        return undefined;\n    }\n};\nMarkerList = __decorate([\n    __param(1, IMarkerService),\n    __param(2, IConfigurationService)\n], MarkerList);\nexport const IMarkerNavigationService = createDecorator('IMarkerNavigationService');\nlet MarkerNavigationService = class MarkerNavigationService {\n    constructor(_markerService, _configService) {\n        this._markerService = _markerService;\n        this._configService = _configService;\n        this._provider = new LinkedList();\n    }\n    getMarkerList(resource) {\n        for (const provider of this._provider) {\n            const result = provider.getMarkerList(resource);\n            if (result) {\n                return result;\n            }\n        }\n        // default\n        return new MarkerList(resource, this._markerService, this._configService);\n    }\n};\nMarkerNavigationService = __decorate([\n    __param(0, IMarkerService),\n    __param(1, IConfigurationService)\n], MarkerNavigationService);\nregisterSingleton(IMarkerNavigationService, MarkerNavigationService, 1 /* InstantiationType.Delayed */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { ScrollableElement } from '../../../../base/browser/ui/scrollbar/scrollableElement.js';\nimport { isNonEmptyArray } from '../../../../base/common/arrays.js';\nimport { Color } from '../../../../base/common/color.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { basename } from '../../../../base/common/resources.js';\nimport { splitLines } from '../../../../base/common/strings.js';\nimport './media/gotoErrorWidget.css';\nimport { Range } from '../../../common/core/range.js';\nimport { peekViewTitleForeground, peekViewTitleInfoForeground, PeekViewWidget } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { createAndFillInActionBarActions } from '../../../../platform/actions/browser/menuEntryActionViewItem.js';\nimport { IMenuService, MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { ILabelService } from '../../../../platform/label/common/label.js';\nimport { MarkerSeverity } from '../../../../platform/markers/common/markers.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { SeverityIcon } from '../../../../platform/severityIcon/browser/severityIcon.js';\nimport { contrastBorder, editorBackground, editorErrorBorder, editorErrorForeground, editorInfoBorder, editorInfoForeground, editorWarningBorder, editorWarningForeground, oneOf, registerColor, transparent } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\nclass MessageWidget {\n    constructor(parent, editor, onRelatedInformation, _openerService, _labelService) {\n        this._openerService = _openerService;\n        this._labelService = _labelService;\n        this._lines = 0;\n        this._longestLineLength = 0;\n        this._relatedDiagnostics = new WeakMap();\n        this._disposables = new DisposableStore();\n        this._editor = editor;\n        const domNode = document.createElement('div');\n        domNode.className = 'descriptioncontainer';\n        this._messageBlock = document.createElement('div');\n        this._messageBlock.classList.add('message');\n        this._messageBlock.setAttribute('aria-live', 'assertive');\n        this._messageBlock.setAttribute('role', 'alert');\n        domNode.appendChild(this._messageBlock);\n        this._relatedBlock = document.createElement('div');\n        domNode.appendChild(this._relatedBlock);\n        this._disposables.add(dom.addStandardDisposableListener(this._relatedBlock, 'click', event => {\n            event.preventDefault();\n            const related = this._relatedDiagnostics.get(event.target);\n            if (related) {\n                onRelatedInformation(related);\n            }\n        }));\n        this._scrollable = new ScrollableElement(domNode, {\n            horizontal: 1 /* ScrollbarVisibility.Auto */,\n            vertical: 1 /* ScrollbarVisibility.Auto */,\n            useShadows: false,\n            horizontalScrollbarSize: 6,\n            verticalScrollbarSize: 6\n        });\n        parent.appendChild(this._scrollable.getDomNode());\n        this._disposables.add(this._scrollable.onScroll(e => {\n            domNode.style.left = `-${e.scrollLeft}px`;\n            domNode.style.top = `-${e.scrollTop}px`;\n        }));\n        this._disposables.add(this._scrollable);\n    }\n    dispose() {\n        dispose(this._disposables);\n    }\n    update(marker) {\n        const { source, message, relatedInformation, code } = marker;\n        let sourceAndCodeLength = ((source === null || source === void 0 ? void 0 : source.length) || 0) + '()'.length;\n        if (code) {\n            if (typeof code === 'string') {\n                sourceAndCodeLength += code.length;\n            }\n            else {\n                sourceAndCodeLength += code.value.length;\n            }\n        }\n        const lines = splitLines(message);\n        this._lines = lines.length;\n        this._longestLineLength = 0;\n        for (const line of lines) {\n            this._longestLineLength = Math.max(line.length + sourceAndCodeLength, this._longestLineLength);\n        }\n        dom.clearNode(this._messageBlock);\n        this._messageBlock.setAttribute('aria-label', this.getAriaLabel(marker));\n        this._editor.applyFontInfo(this._messageBlock);\n        let lastLineElement = this._messageBlock;\n        for (const line of lines) {\n            lastLineElement = document.createElement('div');\n            lastLineElement.innerText = line;\n            if (line === '') {\n                lastLineElement.style.height = this._messageBlock.style.lineHeight;\n            }\n            this._messageBlock.appendChild(lastLineElement);\n        }\n        if (source || code) {\n            const detailsElement = document.createElement('span');\n            detailsElement.classList.add('details');\n            lastLineElement.appendChild(detailsElement);\n            if (source) {\n                const sourceElement = document.createElement('span');\n                sourceElement.innerText = source;\n                sourceElement.classList.add('source');\n                detailsElement.appendChild(sourceElement);\n            }\n            if (code) {\n                if (typeof code === 'string') {\n                    const codeElement = document.createElement('span');\n                    codeElement.innerText = `(${code})`;\n                    codeElement.classList.add('code');\n                    detailsElement.appendChild(codeElement);\n                }\n                else {\n                    this._codeLink = dom.$('a.code-link');\n                    this._codeLink.setAttribute('href', `${code.target.toString()}`);\n                    this._codeLink.onclick = (e) => {\n                        this._openerService.open(code.target, { allowCommands: true });\n                        e.preventDefault();\n                        e.stopPropagation();\n                    };\n                    const codeElement = dom.append(this._codeLink, dom.$('span'));\n                    codeElement.innerText = code.value;\n                    detailsElement.appendChild(this._codeLink);\n                }\n            }\n        }\n        dom.clearNode(this._relatedBlock);\n        this._editor.applyFontInfo(this._relatedBlock);\n        if (isNonEmptyArray(relatedInformation)) {\n            const relatedInformationNode = this._relatedBlock.appendChild(document.createElement('div'));\n            relatedInformationNode.style.paddingTop = `${Math.floor(this._editor.getOption(64 /* EditorOption.lineHeight */) * 0.66)}px`;\n            this._lines += 1;\n            for (const related of relatedInformation) {\n                const container = document.createElement('div');\n                const relatedResource = document.createElement('a');\n                relatedResource.classList.add('filename');\n                relatedResource.innerText = `${this._labelService.getUriBasenameLabel(related.resource)}(${related.startLineNumber}, ${related.startColumn}): `;\n                relatedResource.title = this._labelService.getUriLabel(related.resource);\n                this._relatedDiagnostics.set(relatedResource, related);\n                const relatedMessage = document.createElement('span');\n                relatedMessage.innerText = related.message;\n                container.appendChild(relatedResource);\n                container.appendChild(relatedMessage);\n                this._lines += 1;\n                relatedInformationNode.appendChild(container);\n            }\n        }\n        const fontInfo = this._editor.getOption(48 /* EditorOption.fontInfo */);\n        const scrollWidth = Math.ceil(fontInfo.typicalFullwidthCharacterWidth * this._longestLineLength * 0.75);\n        const scrollHeight = fontInfo.lineHeight * this._lines;\n        this._scrollable.setScrollDimensions({ scrollWidth, scrollHeight });\n    }\n    layout(height, width) {\n        this._scrollable.getDomNode().style.height = `${height}px`;\n        this._scrollable.getDomNode().style.width = `${width}px`;\n        this._scrollable.setScrollDimensions({ width, height });\n    }\n    getHeightInLines() {\n        return Math.min(17, this._lines);\n    }\n    getAriaLabel(marker) {\n        let severityLabel = '';\n        switch (marker.severity) {\n            case MarkerSeverity.Error:\n                severityLabel = nls.localize('Error', \"Error\");\n                break;\n            case MarkerSeverity.Warning:\n                severityLabel = nls.localize('Warning', \"Warning\");\n                break;\n            case MarkerSeverity.Info:\n                severityLabel = nls.localize('Info', \"Info\");\n                break;\n            case MarkerSeverity.Hint:\n                severityLabel = nls.localize('Hint', \"Hint\");\n                break;\n        }\n        let ariaLabel = nls.localize('marker aria', \"{0} at {1}. \", severityLabel, marker.startLineNumber + ':' + marker.startColumn);\n        const model = this._editor.getModel();\n        if (model && (marker.startLineNumber <= model.getLineCount()) && (marker.startLineNumber >= 1)) {\n            const lineContent = model.getLineContent(marker.startLineNumber);\n            ariaLabel = `${lineContent}, ${ariaLabel}`;\n        }\n        return ariaLabel;\n    }\n}\nexport let MarkerNavigationWidget = class MarkerNavigationWidget extends PeekViewWidget {\n    constructor(editor, _themeService, _openerService, _menuService, instantiationService, _contextKeyService, _labelService) {\n        super(editor, { showArrow: true, showFrame: true, isAccessible: true, frameWidth: 1 }, instantiationService);\n        this._themeService = _themeService;\n        this._openerService = _openerService;\n        this._menuService = _menuService;\n        this._contextKeyService = _contextKeyService;\n        this._labelService = _labelService;\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectRelatedInformation = new Emitter();\n        this.onDidSelectRelatedInformation = this._onDidSelectRelatedInformation.event;\n        this._severity = MarkerSeverity.Warning;\n        this._backgroundColor = Color.white;\n        this._applyTheme(_themeService.getColorTheme());\n        this._callOnDispose.add(_themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this.create();\n    }\n    _applyTheme(theme) {\n        this._backgroundColor = theme.getColor(editorMarkerNavigationBackground);\n        let colorId = editorMarkerNavigationError;\n        let headerBackground = editorMarkerNavigationErrorHeader;\n        if (this._severity === MarkerSeverity.Warning) {\n            colorId = editorMarkerNavigationWarning;\n            headerBackground = editorMarkerNavigationWarningHeader;\n        }\n        else if (this._severity === MarkerSeverity.Info) {\n            colorId = editorMarkerNavigationInfo;\n            headerBackground = editorMarkerNavigationInfoHeader;\n        }\n        const frameColor = theme.getColor(colorId);\n        const headerBg = theme.getColor(headerBackground);\n        this.style({\n            arrowColor: frameColor,\n            frameColor: frameColor,\n            headerBackgroundColor: headerBg,\n            primaryHeadingColor: theme.getColor(peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\n        }); // style() will trigger _applyStyles\n    }\n    _applyStyles() {\n        if (this._parentContainer) {\n            this._parentContainer.style.backgroundColor = this._backgroundColor ? this._backgroundColor.toString() : '';\n        }\n        super._applyStyles();\n    }\n    dispose() {\n        this._callOnDispose.dispose();\n        super.dispose();\n    }\n    _fillHead(container) {\n        super._fillHead(container);\n        this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(e => this.editor.focus()));\n        const actions = [];\n        const menu = this._menuService.createMenu(MarkerNavigationWidget.TitleMenu, this._contextKeyService);\n        createAndFillInActionBarActions(menu, undefined, actions);\n        this._actionbarWidget.push(actions, { label: false, icon: true, index: 0 });\n        menu.dispose();\n    }\n    _fillTitleIcon(container) {\n        this._icon = dom.append(container, dom.$(''));\n    }\n    _fillBody(container) {\n        this._parentContainer = container;\n        container.classList.add('marker-widget');\n        this._parentContainer.tabIndex = 0;\n        this._parentContainer.setAttribute('role', 'tooltip');\n        this._container = document.createElement('div');\n        container.appendChild(this._container);\n        this._message = new MessageWidget(this._container, this.editor, related => this._onDidSelectRelatedInformation.fire(related), this._openerService, this._labelService);\n        this._disposables.add(this._message);\n    }\n    show() {\n        throw new Error('call showAtMarker');\n    }\n    showAtMarker(marker, markerIdx, markerCount) {\n        // update:\n        // * title\n        // * message\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n        // update frame color (only applied on 'show')\n        this._severity = marker.severity;\n        this._applyTheme(this._themeService.getColorTheme());\n        // show\n        const range = Range.lift(marker);\n        const editorPosition = this.editor.getPosition();\n        const position = editorPosition && range.containsPosition(editorPosition) ? editorPosition : range.getStartPosition();\n        super.show(position, this.computeRequiredHeight());\n        const model = this.editor.getModel();\n        if (model) {\n            const detail = markerCount > 1\n                ? nls.localize('problems', \"{0} of {1} problems\", markerIdx, markerCount)\n                : nls.localize('change', \"{0} of {1} problem\", markerIdx, markerCount);\n            this.setTitle(basename(model.uri), detail);\n        }\n        this._icon.className = `codicon ${SeverityIcon.className(MarkerSeverity.toSeverity(this._severity))}`;\n        this.editor.revealPositionNearTop(position, 0 /* ScrollType.Smooth */);\n        this.editor.focus();\n    }\n    updateMarker(marker) {\n        this._container.classList.remove('stale');\n        this._message.update(marker);\n    }\n    showStale() {\n        this._container.classList.add('stale');\n        this._relayout();\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._heightInPixel = heightInPixel;\n        this._message.layout(heightInPixel, widthInPixel);\n        this._container.style.height = `${heightInPixel}px`;\n    }\n    _onWidth(widthInPixel) {\n        this._message.layout(this._heightInPixel, widthInPixel);\n    }\n    _relayout() {\n        super._relayout(this.computeRequiredHeight());\n    }\n    computeRequiredHeight() {\n        return 3 + this._message.getHeightInLines();\n    }\n};\nMarkerNavigationWidget.TitleMenu = new MenuId('gotoErrorTitleMenu');\nMarkerNavigationWidget = __decorate([\n    __param(1, IThemeService),\n    __param(2, IOpenerService),\n    __param(3, IMenuService),\n    __param(4, IInstantiationService),\n    __param(5, IContextKeyService),\n    __param(6, ILabelService)\n], MarkerNavigationWidget);\n// theming\nconst errorDefault = oneOf(editorErrorForeground, editorErrorBorder);\nconst warningDefault = oneOf(editorWarningForeground, editorWarningBorder);\nconst infoDefault = oneOf(editorInfoForeground, editorInfoBorder);\nconst editorMarkerNavigationError = registerColor('editorMarkerNavigationError.background', { dark: errorDefault, light: errorDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationError', 'Editor marker navigation widget error color.'));\nconst editorMarkerNavigationErrorHeader = registerColor('editorMarkerNavigationError.headerBackground', { dark: transparent(editorMarkerNavigationError, .1), light: transparent(editorMarkerNavigationError, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationErrorHeaderBackground', 'Editor marker navigation widget error heading background.'));\nconst editorMarkerNavigationWarning = registerColor('editorMarkerNavigationWarning.background', { dark: warningDefault, light: warningDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationWarning', 'Editor marker navigation widget warning color.'));\nconst editorMarkerNavigationWarningHeader = registerColor('editorMarkerNavigationWarning.headerBackground', { dark: transparent(editorMarkerNavigationWarning, .1), light: transparent(editorMarkerNavigationWarning, .1), hcDark: '#0C141F', hcLight: transparent(editorMarkerNavigationWarning, .2) }, nls.localize('editorMarkerNavigationWarningBackground', 'Editor marker navigation widget warning heading background.'));\nconst editorMarkerNavigationInfo = registerColor('editorMarkerNavigationInfo.background', { dark: infoDefault, light: infoDefault, hcDark: contrastBorder, hcLight: contrastBorder }, nls.localize('editorMarkerNavigationInfo', 'Editor marker navigation widget info color.'));\nconst editorMarkerNavigationInfoHeader = registerColor('editorMarkerNavigationInfo.headerBackground', { dark: transparent(editorMarkerNavigationInfo, .1), light: transparent(editorMarkerNavigationInfo, .1), hcDark: null, hcLight: null }, nls.localize('editorMarkerNavigationInfoHeaderBackground', 'Editor marker navigation widget info heading background.'));\nconst editorMarkerNavigationBackground = registerColor('editorMarkerNavigation.background', { dark: editorBackground, light: editorBackground, hcDark: editorBackground, hcLight: editorBackground }, nls.localize('editorMarkerNavigationBackground', 'Editor marker navigation widget background.'));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { IMarkerNavigationService } from './markerNavigationService.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { MarkerNavigationWidget } from './gotoErrorWidget.js';\nexport let MarkerController = class MarkerController {\n    static get(editor) {\n        return editor.getContribution(MarkerController.ID);\n    }\n    constructor(editor, _markerNavigationService, _contextKeyService, _editorService, _instantiationService) {\n        this._markerNavigationService = _markerNavigationService;\n        this._contextKeyService = _contextKeyService;\n        this._editorService = _editorService;\n        this._instantiationService = _instantiationService;\n        this._sessionDispoables = new DisposableStore();\n        this._editor = editor;\n        this._widgetVisible = CONTEXT_MARKERS_NAVIGATION_VISIBLE.bindTo(this._contextKeyService);\n    }\n    dispose() {\n        this._cleanUp();\n        this._sessionDispoables.dispose();\n    }\n    _cleanUp() {\n        this._widgetVisible.reset();\n        this._sessionDispoables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    _getOrCreateModel(uri) {\n        if (this._model && this._model.matches(uri)) {\n            return this._model;\n        }\n        let reusePosition = false;\n        if (this._model) {\n            reusePosition = true;\n            this._cleanUp();\n        }\n        this._model = this._markerNavigationService.getMarkerList(uri);\n        if (reusePosition) {\n            this._model.move(true, this._editor.getModel(), this._editor.getPosition());\n        }\n        this._widget = this._instantiationService.createInstance(MarkerNavigationWidget, this._editor);\n        this._widget.onDidClose(() => this.close(), this, this._sessionDispoables);\n        this._widgetVisible.set(true);\n        this._sessionDispoables.add(this._model);\n        this._sessionDispoables.add(this._widget);\n        // follow cursor\n        this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(e => {\n            var _a, _b, _c;\n            if (!((_a = this._model) === null || _a === void 0 ? void 0 : _a.selected) || !Range.containsPosition((_b = this._model) === null || _b === void 0 ? void 0 : _b.selected.marker, e.position)) {\n                (_c = this._model) === null || _c === void 0 ? void 0 : _c.resetIndex();\n            }\n        }));\n        // update markers\n        this._sessionDispoables.add(this._model.onDidChange(() => {\n            if (!this._widget || !this._widget.position || !this._model) {\n                return;\n            }\n            const info = this._model.find(this._editor.getModel().uri, this._widget.position);\n            if (info) {\n                this._widget.updateMarker(info.marker);\n            }\n            else {\n                this._widget.showStale();\n            }\n        }));\n        // open related\n        this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(related => {\n            this._editorService.openCodeEditor({\n                resource: related.resource,\n                options: { pinned: true, revealIfOpened: true, selection: Range.lift(related).collapseToStart() }\n            }, this._editor);\n            this.close(false);\n        }));\n        this._sessionDispoables.add(this._editor.onDidChangeModel(() => this._cleanUp()));\n        return this._model;\n    }\n    close(focusEditor = true) {\n        this._cleanUp();\n        if (focusEditor) {\n            this._editor.focus();\n        }\n    }\n    showAtMarker(marker) {\n        if (this._editor.hasModel()) {\n            const model = this._getOrCreateModel(this._editor.getModel().uri);\n            model.resetIndex();\n            model.move(true, this._editor.getModel(), new Position(marker.startLineNumber, marker.startColumn));\n            if (model.selected) {\n                this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n            }\n        }\n    }\n    nagivate(next, multiFile) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._editor.hasModel()) {\n                const model = this._getOrCreateModel(multiFile ? undefined : this._editor.getModel().uri);\n                model.move(next, this._editor.getModel(), this._editor.getPosition());\n                if (!model.selected) {\n                    return;\n                }\n                if (model.selected.marker.resource.toString() !== this._editor.getModel().uri.toString()) {\n                    // show in different editor\n                    this._cleanUp();\n                    const otherEditor = yield this._editorService.openCodeEditor({\n                        resource: model.selected.marker.resource,\n                        options: { pinned: false, revealIfOpened: true, selectionRevealType: 2 /* TextEditorSelectionRevealType.NearTop */, selection: model.selected.marker }\n                    }, this._editor);\n                    if (otherEditor) {\n                        (_a = MarkerController.get(otherEditor)) === null || _a === void 0 ? void 0 : _a.close();\n                        (_b = MarkerController.get(otherEditor)) === null || _b === void 0 ? void 0 : _b.nagivate(next, multiFile);\n                    }\n                }\n                else {\n                    // show in this editor\n                    this._widget.showAtMarker(model.selected.marker, model.selected.index, model.selected.total);\n                }\n            }\n        });\n    }\n};\nMarkerController.ID = 'editor.contrib.markerController';\nMarkerController = __decorate([\n    __param(1, IMarkerNavigationService),\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, IInstantiationService)\n], MarkerController);\nclass MarkerNavigationAction extends EditorAction {\n    constructor(_next, _multiFile, opts) {\n        super(opts);\n        this._next = _next;\n        this._multiFile = _multiFile;\n    }\n    run(_accessor, editor) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (editor.hasModel()) {\n                (_a = MarkerController.get(editor)) === null || _a === void 0 ? void 0 : _a.nagivate(this._next, this._multiFile);\n            }\n        });\n    }\n}\nexport class NextMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, false, {\n            id: NextMarkerAction.ID,\n            label: NextMarkerAction.LABEL,\n            alias: 'Go to Next Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: NextMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-next', Codicon.arrowDown, nls.localize('nextMarkerIcon', 'Icon for goto next marker.')),\n                group: 'navigation',\n                order: 1\n            }\n        });\n    }\n}\nNextMarkerAction.ID = 'editor.action.marker.next';\nNextMarkerAction.LABEL = nls.localize('markerAction.next.label', \"Go to Next Problem (Error, Warning, Info)\");\nclass PrevMarkerAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, false, {\n            id: PrevMarkerAction.ID,\n            label: PrevMarkerAction.LABEL,\n            alias: 'Go to Previous Problem (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MarkerNavigationWidget.TitleMenu,\n                title: PrevMarkerAction.LABEL,\n                icon: registerIcon('marker-navigation-previous', Codicon.arrowUp, nls.localize('previousMarkerIcon', 'Icon for goto previous marker.')),\n                group: 'navigation',\n                order: 2\n            }\n        });\n    }\n}\nPrevMarkerAction.ID = 'editor.action.marker.prev';\nPrevMarkerAction.LABEL = nls.localize('markerAction.previous.label', \"Go to Previous Problem (Error, Warning, Info)\");\nclass NextMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(true, true, {\n            id: 'editor.action.marker.nextInFiles',\n            label: nls.localize('markerAction.nextInFiles.label', \"Go to Next Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Next Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoNextProblem', comment: ['&& denotes a mnemonic'] }, \"Next &&Problem\"),\n                group: '6_problem_nav',\n                order: 1\n            }\n        });\n    }\n}\nclass PrevMarkerInFilesAction extends MarkerNavigationAction {\n    constructor() {\n        super(false, true, {\n            id: 'editor.action.marker.prevInFiles',\n            label: nls.localize('markerAction.previousInFiles.label', \"Go to Previous Problem in Files (Error, Warning, Info)\"),\n            alias: 'Go to Previous Problem in Files (Error, Warning, Info)',\n            precondition: undefined,\n            kbOpts: {\n                kbExpr: EditorContextKeys.focus,\n                primary: 1024 /* KeyMod.Shift */ | 66 /* KeyCode.F8 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menuOpts: {\n                menuId: MenuId.MenubarGoMenu,\n                title: nls.localize({ key: 'miGotoPreviousProblem', comment: ['&& denotes a mnemonic'] }, \"Previous &&Problem\"),\n                group: '6_problem_nav',\n                order: 2\n            }\n        });\n    }\n}\nregisterEditorContribution(MarkerController.ID, MarkerController, 4 /* EditorContributionInstantiation.Lazy */);\nregisterEditorAction(NextMarkerAction);\nregisterEditorAction(PrevMarkerAction);\nregisterEditorAction(NextMarkerInFilesAction);\nregisterEditorAction(PrevMarkerInFilesAction);\nconst CONTEXT_MARKERS_NAVIGATION_VISIBLE = new RawContextKey('markersNavigationVisible', false);\nconst MarkerCommand = EditorCommand.bindToContribution(MarkerController.get);\nregisterEditorCommand(new MarkerCommand({\n    id: 'closeMarkersNavigation',\n    precondition: CONTEXT_MARKERS_NAVIGATION_VISIBLE,\n    handler: x => x.close(),\n    kbOpts: {\n        weight: 100 /* KeybindingWeight.EditorContrib */ + 50,\n        kbExpr: EditorContextKeys.focus,\n        primary: 9 /* KeyCode.Escape */,\n        secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n    }\n}));\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { Emitter } from '../../../../base/common/event.js';\nimport { combinedDisposable, DisposableStore, dispose } from '../../../../base/common/lifecycle.js';\nimport { isEqual } from '../../../../base/common/resources.js';\nimport { EditorCommand, registerEditorCommand } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { createDecorator } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { KeybindingsRegistry } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nexport const ctxHasSymbols = new RawContextKey('hasSymbols', false, localize('hasSymbols', \"Whether there are symbol locations that can be navigated via keyboard-only.\"));\nexport const ISymbolNavigationService = createDecorator('ISymbolNavigationService');\nlet SymbolNavigationService = class SymbolNavigationService {\n    constructor(contextKeyService, _editorService, _notificationService, _keybindingService) {\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._keybindingService = _keybindingService;\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n        this._ignoreEditorChange = false;\n        this._ctxHasSymbols = ctxHasSymbols.bindTo(contextKeyService);\n    }\n    reset() {\n        var _a, _b;\n        this._ctxHasSymbols.reset();\n        (_a = this._currentState) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._currentMessage) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._currentModel = undefined;\n        this._currentIdx = -1;\n    }\n    put(anchor) {\n        const refModel = anchor.parent.parent;\n        if (refModel.references.length <= 1) {\n            this.reset();\n            return;\n        }\n        this._currentModel = refModel;\n        this._currentIdx = refModel.references.indexOf(anchor);\n        this._ctxHasSymbols.set(true);\n        this._showMessage();\n        const editorState = new EditorState(this._editorService);\n        const listener = editorState.onDidChange(_ => {\n            if (this._ignoreEditorChange) {\n                return;\n            }\n            const editor = this._editorService.getActiveCodeEditor();\n            if (!editor) {\n                return;\n            }\n            const model = editor.getModel();\n            const position = editor.getPosition();\n            if (!model || !position) {\n                return;\n            }\n            let seenUri = false;\n            let seenPosition = false;\n            for (const reference of refModel.references) {\n                if (isEqual(reference.uri, model.uri)) {\n                    seenUri = true;\n                    seenPosition = seenPosition || Range.containsPosition(reference.range, position);\n                }\n                else if (seenUri) {\n                    break;\n                }\n            }\n            if (!seenUri || !seenPosition) {\n                this.reset();\n            }\n        });\n        this._currentState = combinedDisposable(editorState, listener);\n    }\n    revealNext(source) {\n        if (!this._currentModel) {\n            return Promise.resolve();\n        }\n        // get next result and advance\n        this._currentIdx += 1;\n        this._currentIdx %= this._currentModel.references.length;\n        const reference = this._currentModel.references[this._currentIdx];\n        // status\n        this._showMessage();\n        // open editor, ignore events while that happens\n        this._ignoreEditorChange = true;\n        return this._editorService.openCodeEditor({\n            resource: reference.uri,\n            options: {\n                selection: Range.collapseToStart(reference.range),\n                selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */\n            }\n        }, source).finally(() => {\n            this._ignoreEditorChange = false;\n        });\n    }\n    _showMessage() {\n        var _a;\n        (_a = this._currentMessage) === null || _a === void 0 ? void 0 : _a.dispose();\n        const kb = this._keybindingService.lookupKeybinding('editor.gotoNextSymbolFromResult');\n        const message = kb\n            ? localize('location.kb', \"Symbol {0} of {1}, {2} for next\", this._currentIdx + 1, this._currentModel.references.length, kb.getLabel())\n            : localize('location', \"Symbol {0} of {1}\", this._currentIdx + 1, this._currentModel.references.length);\n        this._currentMessage = this._notificationService.status(message);\n    }\n};\nSymbolNavigationService = __decorate([\n    __param(0, IContextKeyService),\n    __param(1, ICodeEditorService),\n    __param(2, INotificationService),\n    __param(3, IKeybindingService)\n], SymbolNavigationService);\nregisterSingleton(ISymbolNavigationService, SymbolNavigationService, 1 /* InstantiationType.Delayed */);\nregisterEditorCommand(new class extends EditorCommand {\n    constructor() {\n        super({\n            id: 'editor.gotoNextSymbolFromResult',\n            precondition: ctxHasSymbols,\n            kbOpts: {\n                weight: 100 /* KeybindingWeight.EditorContrib */,\n                primary: 70 /* KeyCode.F12 */\n            }\n        });\n    }\n    runEditorCommand(accessor, editor) {\n        return accessor.get(ISymbolNavigationService).revealNext(editor);\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'editor.gotoNextSymbolFromResult.cancel',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    when: ctxHasSymbols,\n    primary: 9 /* KeyCode.Escape */,\n    handler(accessor) {\n        accessor.get(ISymbolNavigationService).reset();\n    }\n});\n//\nlet EditorState = class EditorState {\n    constructor(editorService) {\n        this._listener = new Map();\n        this._disposables = new DisposableStore();\n        this._onDidChange = new Emitter();\n        this.onDidChange = this._onDidChange.event;\n        this._disposables.add(editorService.onCodeEditorRemove(this._onDidRemoveEditor, this));\n        this._disposables.add(editorService.onCodeEditorAdd(this._onDidAddEditor, this));\n        editorService.listCodeEditors().forEach(this._onDidAddEditor, this);\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._onDidChange.dispose();\n        dispose(this._listener.values());\n    }\n    _onDidAddEditor(editor) {\n        this._listener.set(editor, combinedDisposable(editor.onDidChangeCursorPosition(_ => this._onDidChange.fire({ editor })), editor.onDidChangeModelContent(_ => this._onDidChange.fire({ editor }))));\n    }\n    _onDidRemoveEditor(editor) {\n        var _a;\n        (_a = this._listener.get(editor)) === null || _a === void 0 ? void 0 : _a.dispose();\n        this._listener.delete(editor);\n    }\n};\nEditorState = __decorate([\n    __param(0, ICodeEditorService)\n], EditorState);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar _a, _b, _c, _d, _e, _f, _g, _h;\nimport { isStandalone } from '../../../../base/browser/browser.js';\nimport { alert } from '../../../../base/browser/ui/aria/aria.js';\nimport { createCancelablePromise, raceCancellation } from '../../../../base/common/async.js';\nimport { KeyChord } from '../../../../base/common/keyCodes.js';\nimport { isWeb } from '../../../../base/common/platform.js';\nimport { assertType } from '../../../../base/common/types.js';\nimport { URI } from '../../../../base/common/uri.js';\nimport { EditorStateCancellationTokenSource } from '../../editorState/browser/editorState.js';\nimport { isCodeEditor } from '../../../browser/editorBrowser.js';\nimport { EditorAction2 } from '../../../browser/editorExtensions.js';\nimport { ICodeEditorService } from '../../../browser/services/codeEditorService.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/embeddedCodeEditorWidget.js';\nimport * as corePosition from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { isLocationLink } from '../../../common/languages.js';\nimport { ReferencesController } from './peek/referencesController.js';\nimport { ReferencesModel } from './referencesModel.js';\nimport { ISymbolNavigationService } from './symbolNavigation.js';\nimport { MessageController } from '../../message/browser/messageController.js';\nimport { PeekContext } from '../../peekView/browser/peekView.js';\nimport * as nls from '../../../../nls.js';\nimport { MenuId, MenuRegistry, registerAction2 } from '../../../../platform/actions/common/actions.js';\nimport { CommandsRegistry, ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { INotificationService } from '../../../../platform/notification/common/notification.js';\nimport { IEditorProgressService } from '../../../../platform/progress/common/progress.js';\nimport { getDeclarationsAtPosition, getDefinitionsAtPosition, getImplementationsAtPosition, getReferencesAtPosition, getTypeDefinitionsAtPosition } from './goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\n    submenu: MenuId.EditorContextPeek,\n    title: nls.localize('peek.submenu', \"Peek\"),\n    group: 'navigation',\n    order: 100\n});\nexport class SymbolNavigationAnchor {\n    static is(thing) {\n        if (!thing || typeof thing !== 'object') {\n            return false;\n        }\n        if (thing instanceof SymbolNavigationAnchor) {\n            return true;\n        }\n        if (corePosition.Position.isIPosition(thing.position) && thing.model) {\n            return true;\n        }\n        return false;\n    }\n    constructor(model, position) {\n        this.model = model;\n        this.position = position;\n    }\n}\nexport class SymbolNavigationAction extends EditorAction2 {\n    static all() {\n        return SymbolNavigationAction._allSymbolNavigationCommands.values();\n    }\n    static _patchConfig(opts) {\n        const result = Object.assign(Object.assign({}, opts), { f1: true });\n        // patch context menu when clause\n        if (result.menu) {\n            for (const item of Iterable.wrap(result.menu)) {\n                if (item.id === MenuId.EditorContext || item.id === MenuId.EditorContextPeek) {\n                    item.when = ContextKeyExpr.and(opts.precondition, item.when);\n                }\n            }\n        }\n        return result;\n    }\n    constructor(configuration, opts) {\n        super(SymbolNavigationAction._patchConfig(opts));\n        this.configuration = configuration;\n        SymbolNavigationAction._allSymbolNavigationCommands.set(opts.id, this);\n    }\n    runEditorCommand(accessor, editor, arg, range) {\n        if (!editor.hasModel()) {\n            return Promise.resolve(undefined);\n        }\n        const notificationService = accessor.get(INotificationService);\n        const editorService = accessor.get(ICodeEditorService);\n        const progressService = accessor.get(IEditorProgressService);\n        const symbolNavService = accessor.get(ISymbolNavigationService);\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const instaService = accessor.get(IInstantiationService);\n        const model = editor.getModel();\n        const position = editor.getPosition();\n        const anchor = SymbolNavigationAnchor.is(arg) ? arg : new SymbolNavigationAnchor(model, position);\n        const cts = new EditorStateCancellationTokenSource(editor, 1 /* CodeEditorStateFlag.Value */ | 4 /* CodeEditorStateFlag.Position */);\n        const promise = raceCancellation(this._getLocationModel(languageFeaturesService, anchor.model, anchor.position, cts.token), cts.token).then((references) => __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (!references || cts.token.isCancellationRequested) {\n                return;\n            }\n            alert(references.ariaMessage);\n            let altAction;\n            if (references.referenceAt(model.uri, position)) {\n                const altActionId = this._getAlternativeCommand(editor);\n                if (!SymbolNavigationAction._activeAlternativeCommands.has(altActionId) && SymbolNavigationAction._allSymbolNavigationCommands.has(altActionId)) {\n                    altAction = SymbolNavigationAction._allSymbolNavigationCommands.get(altActionId);\n                }\n            }\n            const referenceCount = references.references.length;\n            if (referenceCount === 0) {\n                // no result -> show message\n                if (!this.configuration.muteMessage) {\n                    const info = model.getWordAtPosition(position);\n                    (_a = MessageController.get(editor)) === null || _a === void 0 ? void 0 : _a.showMessage(this._getNoResultFoundMessage(info), position);\n                }\n            }\n            else if (referenceCount === 1 && altAction) {\n                // already at the only result, run alternative\n                SymbolNavigationAction._activeAlternativeCommands.add(this.desc.id);\n                instaService.invokeFunction((accessor) => altAction.runEditorCommand(accessor, editor, arg, range).finally(() => {\n                    SymbolNavigationAction._activeAlternativeCommands.delete(this.desc.id);\n                }));\n            }\n            else {\n                // normal results handling\n                return this._onResult(editorService, symbolNavService, editor, references, range);\n            }\n        }), (err) => {\n            // report an error\n            notificationService.error(err);\n        }).finally(() => {\n            cts.dispose();\n        });\n        progressService.showWhile(promise, 250);\n        return promise;\n    }\n    _onResult(editorService, symbolNavService, editor, model, range) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const gotoLocation = this._getGoToPreference(editor);\n            if (!(editor instanceof EmbeddedCodeEditorWidget) && (this.configuration.openInPeek || (gotoLocation === 'peek' && model.references.length > 1))) {\n                this._openInPeek(editor, model, range);\n            }\n            else {\n                const next = model.firstReference();\n                const peek = model.references.length > 1 && gotoLocation === 'gotoAndPeek';\n                const targetEditor = yield this._openReference(editor, editorService, next, this.configuration.openToSide, !peek);\n                if (peek && targetEditor) {\n                    this._openInPeek(targetEditor, model, range);\n                }\n                else {\n                    model.dispose();\n                }\n                // keep remaining locations around when using\n                // 'goto'-mode\n                if (gotoLocation === 'goto') {\n                    symbolNavService.put(next);\n                }\n            }\n        });\n    }\n    _openReference(editor, editorService, reference, sideBySide, highlight) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // range is the target-selection-range when we have one\n            // and the fallback is the 'full' range\n            let range = undefined;\n            if (isLocationLink(reference)) {\n                range = reference.targetSelectionRange;\n            }\n            if (!range) {\n                range = reference.range;\n            }\n            if (!range) {\n                return undefined;\n            }\n            const targetEditor = yield editorService.openCodeEditor({\n                resource: reference.uri,\n                options: {\n                    selection: Range.collapseToStart(range),\n                    selectionRevealType: 3 /* TextEditorSelectionRevealType.NearTopIfOutsideViewport */,\n                    selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */\n                }\n            }, editor, sideBySide);\n            if (!targetEditor) {\n                return undefined;\n            }\n            if (highlight) {\n                const modelNow = targetEditor.getModel();\n                const decorations = targetEditor.createDecorationsCollection([{ range, options: { description: 'symbol-navigate-action-highlight', className: 'symbolHighlight' } }]);\n                setTimeout(() => {\n                    if (targetEditor.getModel() === modelNow) {\n                        decorations.clear();\n                    }\n                }, 350);\n            }\n            return targetEditor;\n        });\n    }\n    _openInPeek(target, model, range) {\n        const controller = ReferencesController.get(target);\n        if (controller && target.hasModel()) {\n            controller.toggleWidget(range !== null && range !== void 0 ? range : target.getSelection(), createCancelablePromise(_ => Promise.resolve(model)), this.configuration.openInPeek);\n        }\n        else {\n            model.dispose();\n        }\n    }\n}\nSymbolNavigationAction._allSymbolNavigationCommands = new Map();\nSymbolNavigationAction._activeAlternativeCommands = new Set();\n//#region --- DEFINITION\nexport class DefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, token), nls.localize('def.title', 'Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('noResultWord', \"No definition found for '{0}'\", info.word)\n            : nls.localize('generic.noResults', \"No definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).alternativeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).multipleDefinitions;\n    }\n}\nconst goToDefinitionKb = isWeb && !isStandalone()\n    ? 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */\n    : 70 /* KeyCode.F12 */;\nregisterAction2((_a = class GoToDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToDefinitionAction.id,\n                title: {\n                    value: nls.localize('actions.goToDecl.label', \"Go to Definition\"),\n                    original: 'Go to Definition',\n                    mnemonicTitle: nls.localize({ key: 'miGotoDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Definition\")\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: goToDefinitionKb,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.1\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 2,\n                    }]\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.goToDeclaration', GoToDefinitionAction.id);\n        }\n    },\n    _a.id = 'editor.action.revealDefinition',\n    _a));\nregisterAction2((_b = class OpenDefinitionToSideAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: true,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: OpenDefinitionToSideAction.id,\n                title: {\n                    value: nls.localize('actions.goToDeclToSide.label', \"Open Definition to the Side\"),\n                    original: 'Open Definition to the Side'\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, goToDefinitionKb),\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.openDeclarationToTheSide', OpenDefinitionToSideAction.id);\n        }\n    },\n    _b.id = 'editor.action.revealDefinitionAside',\n    _b));\nregisterAction2((_c = class PeekDefinitionAction extends DefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekDefinitionAction.id,\n                title: {\n                    value: nls.localize('actions.previewDecl.label', \"Peek Definition\"),\n                    original: 'Peek Definition'\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 512 /* KeyMod.Alt */ | 70 /* KeyCode.F12 */,\n                    linux: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 68 /* KeyCode.F10 */ },\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 2\n                }\n            });\n            CommandsRegistry.registerCommandAlias('editor.action.previewDeclaration', PeekDefinitionAction.id);\n        }\n    },\n    _c.id = 'editor.action.peekDefinition',\n    _c));\n//#endregion\n//#region --- DECLARATION\nclass DeclarationAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, token), nls.localize('decl.title', 'Declarations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n            : nls.localize('decl.generic.noResults', \"No declaration found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).alternativeDeclarationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).multipleDeclarations;\n    }\n}\nregisterAction2((_d = class GoToDeclarationAction extends DeclarationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToDeclarationAction.id,\n                title: {\n                    value: nls.localize('actions.goToDeclaration.label', \"Go to Declaration\"),\n                    original: 'Go to Declaration',\n                    mnemonicTitle: nls.localize({ key: 'miGotoDeclaration', comment: ['&& denotes a mnemonic'] }, \"Go to &&Declaration\")\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.3\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 3,\n                    }],\n            });\n        }\n        _getNoResultFoundMessage(info) {\n            return info && info.word\n                ? nls.localize('decl.noResultWord', \"No declaration found for '{0}'\", info.word)\n                : nls.localize('decl.generic.noResults', \"No declaration found\");\n        }\n    },\n    _d.id = 'editor.action.revealDeclaration',\n    _d));\nregisterAction2(class PeekDeclarationAction extends DeclarationAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.peekDeclaration',\n            title: {\n                value: nls.localize('actions.peekDecl.label', \"Peek Declaration\"),\n                original: 'Peek Declaration'\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasDeclarationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 3\n            }\n        });\n    }\n});\n//#endregion\n//#region --- TYPE DEFINITION\nclass TypeDefinitionAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, token), nls.localize('typedef.title', 'Type Definitions'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToTypeDefinition.noResultWord', \"No type definition found for '{0}'\", info.word)\n            : nls.localize('goToTypeDefinition.generic.noResults', \"No type definition found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).alternativeTypeDefinitionCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).multipleTypeDefinitions;\n    }\n}\nregisterAction2((_e = class GoToTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToTypeDefinitionAction.ID,\n                title: {\n                    value: nls.localize('actions.goToTypeDefinition.label', \"Go to Type Definition\"),\n                    original: 'Go to Type Definition',\n                    mnemonicTitle: nls.localize({ key: 'miGotoTypeDefinition', comment: ['&& denotes a mnemonic'] }, \"Go to &&Type Definition\")\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 0,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.4\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 3,\n                    }]\n            });\n        }\n    },\n    _e.ID = 'editor.action.goToTypeDefinition',\n    _e));\nregisterAction2((_f = class PeekTypeDefinitionAction extends TypeDefinitionAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekTypeDefinitionAction.ID,\n                title: {\n                    value: nls.localize('actions.peekTypeDefinition.label', \"Peek Type Definition\"),\n                    original: 'Peek Type Definition'\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasTypeDefinitionProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 4\n                }\n            });\n        }\n    },\n    _f.ID = 'editor.action.peekTypeDefinition',\n    _f));\n//#endregion\n//#region --- IMPLEMENTATION\nclass ImplementationAction extends SymbolNavigationAction {\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, token), nls.localize('impl.title', 'Implementations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && info.word\n            ? nls.localize('goToImplementation.noResultWord', \"No implementation found for '{0}'\", info.word)\n            : nls.localize('goToImplementation.generic.noResults', \"No implementation found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).alternativeImplementationCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).multipleImplementations;\n    }\n}\nregisterAction2((_g = class GoToImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: false,\n                muteMessage: false\n            }, {\n                id: GoToImplementationAction.ID,\n                title: {\n                    value: nls.localize('actions.goToImplementation.label', \"Go to Implementations\"),\n                    original: 'Go to Implementations',\n                    mnemonicTitle: nls.localize({ key: 'miGotoImplementation', comment: ['&& denotes a mnemonic'] }, \"Go to &&Implementations\")\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: [{\n                        id: MenuId.EditorContext,\n                        group: 'navigation',\n                        order: 1.45\n                    }, {\n                        id: MenuId.MenubarGoMenu,\n                        precondition: null,\n                        group: '4_symbol_nav',\n                        order: 4,\n                    }]\n            });\n        }\n    },\n    _g.ID = 'editor.action.goToImplementation',\n    _g));\nregisterAction2((_h = class PeekImplementationAction extends ImplementationAction {\n        constructor() {\n            super({\n                openToSide: false,\n                openInPeek: true,\n                muteMessage: false\n            }, {\n                id: PeekImplementationAction.ID,\n                title: {\n                    value: nls.localize('actions.peekImplementation.label', \"Peek Implementations\"),\n                    original: 'Peek Implementations'\n                },\n                precondition: ContextKeyExpr.and(EditorContextKeys.hasImplementationProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n                keybinding: {\n                    when: EditorContextKeys.editorTextFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                    weight: 100 /* KeybindingWeight.EditorContrib */\n                },\n                menu: {\n                    id: MenuId.EditorContextPeek,\n                    group: 'peek',\n                    order: 5\n                }\n            });\n        }\n    },\n    _h.ID = 'editor.action.peekImplementation',\n    _h));\n//#endregion\n//#region --- REFERENCES\nclass ReferencesAction extends SymbolNavigationAction {\n    _getNoResultFoundMessage(info) {\n        return info\n            ? nls.localize('references.no', \"No references found for '{0}'\", info.word)\n            : nls.localize('references.noGeneric', \"No references found\");\n    }\n    _getAlternativeCommand(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).alternativeReferenceCommand;\n    }\n    _getGoToPreference(editor) {\n        return editor.getOption(56 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n}\nregisterAction2(class GoToReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: false,\n            muteMessage: false\n        }, {\n            id: 'editor.action.goToReferences',\n            title: {\n                value: nls.localize('goToReferences.label', \"Go to References\"),\n                original: 'Go to References',\n                mnemonicTitle: nls.localize({ key: 'miGotoReference', comment: ['&& denotes a mnemonic'] }, \"Go to &&References\")\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            keybinding: {\n                when: EditorContextKeys.editorTextFocus,\n                primary: 1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */,\n                weight: 100 /* KeybindingWeight.EditorContrib */\n            },\n            menu: [{\n                    id: MenuId.EditorContext,\n                    group: 'navigation',\n                    order: 1.45\n                }, {\n                    id: MenuId.MenubarGoMenu,\n                    precondition: null,\n                    group: '4_symbol_nav',\n                    order: 5,\n                }]\n        });\n    }\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, true, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\nregisterAction2(class PeekReferencesAction extends ReferencesAction {\n    constructor() {\n        super({\n            openToSide: false,\n            openInPeek: true,\n            muteMessage: false\n        }, {\n            id: 'editor.action.referenceSearch.trigger',\n            title: {\n                value: nls.localize('references.action.label', \"Peek References\"),\n                original: 'Peek References'\n            },\n            precondition: ContextKeyExpr.and(EditorContextKeys.hasReferenceProvider, PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n            menu: {\n                id: MenuId.EditorContextPeek,\n                group: 'peek',\n                order: 6\n            }\n        });\n    }\n    _getLocationModel(languageFeaturesService, model, position, token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(yield getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, token), nls.localize('ref.title', 'References'));\n        });\n    }\n});\n//#endregion\n//#region --- GENERIC goto symbols command\nclass GenericGoToLocationAction extends SymbolNavigationAction {\n    constructor(config, _references, _gotoMultipleBehaviour) {\n        super(config, {\n            id: 'editor.action.goToLocation',\n            title: {\n                value: nls.localize('label.generic', \"Go to Any Symbol\"),\n                original: 'Go to Any Symbol'\n            },\n            precondition: ContextKeyExpr.and(PeekContext.notInPeekEditor, EditorContextKeys.isInWalkThroughSnippet.toNegated()),\n        });\n        this._references = _references;\n        this._gotoMultipleBehaviour = _gotoMultipleBehaviour;\n    }\n    _getLocationModel(languageFeaturesService, _model, _position, _token) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new ReferencesModel(this._references, nls.localize('generic.title', 'Locations'));\n        });\n    }\n    _getNoResultFoundMessage(info) {\n        return info && nls.localize('generic.noResult', \"No results for '{0}'\", info.word) || '';\n    }\n    _getGoToPreference(editor) {\n        var _a;\n        return (_a = this._gotoMultipleBehaviour) !== null && _a !== void 0 ? _a : editor.getOption(56 /* EditorOption.gotoLocation */).multipleReferences;\n    }\n    _getAlternativeCommand() { return ''; }\n}\nCommandsRegistry.registerCommand({\n    id: 'editor.action.goToLocations',\n    description: {\n        description: 'Go to locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n            { name: 'noResultsMessage', description: 'Human readable message that shows when locations is empty.' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple, noResultsMessage, openInPeek) => __awaiter(void 0, void 0, void 0, function* () {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        assertType(Array.isArray(references));\n        assertType(typeof multiple === 'undefined' || typeof multiple === 'string');\n        assertType(typeof openInPeek === 'undefined' || typeof openInPeek === 'boolean');\n        const editorService = accessor.get(ICodeEditorService);\n        const editor = yield editorService.openCodeEditor({ resource }, editorService.getFocusedCodeEditor());\n        if (isCodeEditor(editor)) {\n            editor.setPosition(position);\n            editor.revealPositionInCenterIfOutsideViewport(position, 0 /* ScrollType.Smooth */);\n            return editor.invokeWithinContext(accessor => {\n                const command = new class extends GenericGoToLocationAction {\n                    _getNoResultFoundMessage(info) {\n                        return noResultsMessage || super._getNoResultFoundMessage(info);\n                    }\n                }({\n                    muteMessage: !Boolean(noResultsMessage),\n                    openInPeek: Boolean(openInPeek),\n                    openToSide: false\n                }, references, multiple);\n                accessor.get(IInstantiationService).invokeFunction(command.run.bind(command), editor);\n            });\n        }\n    })\n});\nCommandsRegistry.registerCommand({\n    id: 'editor.action.peekLocations',\n    description: {\n        description: 'Peek locations from a position in a file',\n        args: [\n            { name: 'uri', description: 'The text document in which to start', constraint: URI },\n            { name: 'position', description: 'The position at which to start', constraint: corePosition.Position.isIPosition },\n            { name: 'locations', description: 'An array of locations.', constraint: Array },\n            { name: 'multiple', description: 'Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto' },\n        ]\n    },\n    handler: (accessor, resource, position, references, multiple) => __awaiter(void 0, void 0, void 0, function* () {\n        accessor.get(ICommandService).executeCommand('editor.action.goToLocations', resource, position, references, multiple, undefined, true);\n    })\n});\n//#endregion\n//#region --- REFERENCE search special commands\nCommandsRegistry.registerCommand({\n    id: 'editor.action.findReferences',\n    handler: (accessor, resource, position) => {\n        assertType(URI.isUri(resource));\n        assertType(corePosition.Position.isIPosition(position));\n        const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n        const codeEditorService = accessor.get(ICodeEditorService);\n        return codeEditorService.openCodeEditor({ resource }, codeEditorService.getFocusedCodeEditor()).then(control => {\n            if (!isCodeEditor(control) || !control.hasModel()) {\n                return undefined;\n            }\n            const controller = ReferencesController.get(control);\n            if (!controller) {\n                return undefined;\n            }\n            const references = createCancelablePromise(token => getReferencesAtPosition(languageFeaturesService.referenceProvider, control.getModel(), corePosition.Position.lift(position), false, token).then(references => new ReferencesModel(references, nls.localize('ref.title', 'References'))));\n            const range = new Range(position.lineNumber, position.column, position.lineNumber, position.column);\n            return Promise.resolve(controller.toggleWidget(range, references, false));\n        });\n    }\n});\n// use NEW command\nCommandsRegistry.registerCommandAlias('editor.action.showReferences', 'editor.action.peekLocations');\n//#endregion\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { coalesce } from '../../../../base/common/arrays.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { registerModelAndPositionCommand } from '../../../browser/editorExtensions.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { ReferencesModel } from './referencesModel.js';\nfunction getLocationLinks(model, position, registry, provide) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const provider = registry.ordered(model);\n        // get results\n        const promises = provider.map((provider) => {\n            return Promise.resolve(provide(provider, model, position)).then(undefined, err => {\n                onUnexpectedExternalError(err);\n                return undefined;\n            });\n        });\n        const values = yield Promise.all(promises);\n        return coalesce(values.flat());\n    });\n}\nexport function getDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDefinition(model, position, token);\n    });\n}\nexport function getDeclarationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideDeclaration(model, position, token);\n    });\n}\nexport function getImplementationsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideImplementation(model, position, token);\n    });\n}\nexport function getTypeDefinitionsAtPosition(registry, model, position, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => {\n        return provider.provideTypeDefinition(model, position, token);\n    });\n}\nexport function getReferencesAtPosition(registry, model, position, compact, token) {\n    return getLocationLinks(model, position, registry, (provider, model, position) => __awaiter(this, void 0, void 0, function* () {\n        const result = yield provider.provideReferences(model, position, { includeDeclaration: true }, token);\n        if (!compact || !result || result.length !== 2) {\n            return result;\n        }\n        const resultWithoutDeclaration = yield provider.provideReferences(model, position, { includeDeclaration: false }, token);\n        if (resultWithoutDeclaration && resultWithoutDeclaration.length === 1) {\n            return resultWithoutDeclaration;\n        }\n        return result;\n    }));\n}\n// -- API commands ----\nfunction _sortedAndDeduped(callback) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const rawLinks = yield callback();\n        const model = new ReferencesModel(rawLinks, '');\n        const modelLinks = model.references.map(ref => ref.link);\n        model.dispose();\n        return modelLinks;\n    });\n}\nregisterModelAndPositionCommand('_executeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDefinitionsAtPosition(languageFeaturesService.definitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeTypeDefinitionProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getTypeDefinitionsAtPosition(languageFeaturesService.typeDefinitionProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeDeclarationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getDeclarationsAtPosition(languageFeaturesService.declarationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeReferenceProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getReferencesAtPosition(languageFeaturesService.referenceProvider, model, position, false, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\nregisterModelAndPositionCommand('_executeImplementationProvider', (accessor, model, position) => {\n    const languageFeaturesService = accessor.get(ILanguageFeaturesService);\n    const promise = getImplementationsAtPosition(languageFeaturesService.implementationProvider, model, position, CancellationToken.None);\n    return _sortedAndDeduped(() => promise);\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../../../base/common/event.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport * as platform from '../../../../../base/common/platform.js';\nfunction hasModifier(e, modifier) {\n    return !!e[modifier];\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkMouseEvent {\n    constructor(source, opts) {\n        this.target = source.target;\n        this.isLeftClick = source.event.leftButton;\n        this.isMiddleClick = source.event.middleButton;\n        this.isRightClick = source.event.rightButton;\n        this.hasTriggerModifier = hasModifier(source.event, opts.triggerModifier);\n        this.hasSideBySideModifier = hasModifier(source.event, opts.triggerSideBySideModifier);\n        this.isNoneOrSingleMouseDown = (source.event.detail <= 1);\n    }\n}\n/**\n * An event that encapsulates the various trigger modifiers logic needed for go to definition.\n */\nexport class ClickLinkKeyboardEvent {\n    constructor(source, opts) {\n        this.keyCodeIsTriggerKey = (source.keyCode === opts.triggerKey);\n        this.keyCodeIsSideBySideKey = (source.keyCode === opts.triggerSideBySideKey);\n        this.hasTriggerModifier = hasModifier(source, opts.triggerModifier);\n    }\n}\nexport class ClickLinkOptions {\n    constructor(triggerKey, triggerModifier, triggerSideBySideKey, triggerSideBySideModifier) {\n        this.triggerKey = triggerKey;\n        this.triggerModifier = triggerModifier;\n        this.triggerSideBySideKey = triggerSideBySideKey;\n        this.triggerSideBySideModifier = triggerSideBySideModifier;\n    }\n    equals(other) {\n        return (this.triggerKey === other.triggerKey\n            && this.triggerModifier === other.triggerModifier\n            && this.triggerSideBySideKey === other.triggerSideBySideKey\n            && this.triggerSideBySideModifier === other.triggerSideBySideModifier);\n    }\n}\nfunction createOptions(multiCursorModifier) {\n    if (multiCursorModifier === 'altKey') {\n        if (platform.isMacintosh) {\n            return new ClickLinkOptions(57 /* KeyCode.Meta */, 'metaKey', 6 /* KeyCode.Alt */, 'altKey');\n        }\n        return new ClickLinkOptions(5 /* KeyCode.Ctrl */, 'ctrlKey', 6 /* KeyCode.Alt */, 'altKey');\n    }\n    if (platform.isMacintosh) {\n        return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 57 /* KeyCode.Meta */, 'metaKey');\n    }\n    return new ClickLinkOptions(6 /* KeyCode.Alt */, 'altKey', 5 /* KeyCode.Ctrl */, 'ctrlKey');\n}\nexport class ClickLinkGesture extends Disposable {\n    constructor(editor, alwaysFireOnMouseUp) {\n        super();\n        this._onMouseMoveOrRelevantKeyDown = this._register(new Emitter());\n        this.onMouseMoveOrRelevantKeyDown = this._onMouseMoveOrRelevantKeyDown.event;\n        this._onExecute = this._register(new Emitter());\n        this.onExecute = this._onExecute.event;\n        this._onCancel = this._register(new Emitter());\n        this.onCancel = this._onCancel.event;\n        this._editor = editor;\n        this._alwaysFireExecuteOnMouseUp = alwaysFireOnMouseUp;\n        this._opts = createOptions(this._editor.getOption(75 /* EditorOption.multiCursorModifier */));\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._lineNumberOnMouseDown = 0;\n        this._register(this._editor.onDidChangeConfiguration((e) => {\n            if (e.hasChanged(75 /* EditorOption.multiCursorModifier */)) {\n                const newOpts = createOptions(this._editor.getOption(75 /* EditorOption.multiCursorModifier */));\n                if (this._opts.equals(newOpts)) {\n                    return;\n                }\n                this._opts = newOpts;\n                this._lastMouseMoveEvent = null;\n                this._hasTriggerKeyOnMouseDown = false;\n                this._lineNumberOnMouseDown = 0;\n                this._onCancel.fire();\n            }\n        }));\n        this._register(this._editor.onMouseMove((e) => this._onEditorMouseMove(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseDown((e) => this._onEditorMouseDown(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onMouseUp((e) => this._onEditorMouseUp(new ClickLinkMouseEvent(e, this._opts))));\n        this._register(this._editor.onKeyDown((e) => this._onEditorKeyDown(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onKeyUp((e) => this._onEditorKeyUp(new ClickLinkKeyboardEvent(e, this._opts))));\n        this._register(this._editor.onMouseDrag(() => this._resetHandler()));\n        this._register(this._editor.onDidChangeCursorSelection((e) => this._onDidChangeCursorSelection(e)));\n        this._register(this._editor.onDidChangeModel((e) => this._resetHandler()));\n        this._register(this._editor.onDidChangeModelContent(() => this._resetHandler()));\n        this._register(this._editor.onDidScrollChange((e) => {\n            if (e.scrollTopChanged || e.scrollLeftChanged) {\n                this._resetHandler();\n            }\n        }));\n    }\n    _onDidChangeCursorSelection(e) {\n        if (e.selection && e.selection.startColumn !== e.selection.endColumn) {\n            this._resetHandler(); // immediately stop this feature if the user starts to select (https://github.com/microsoft/vscode/issues/7827)\n        }\n    }\n    _onEditorMouseMove(mouseEvent) {\n        this._lastMouseMoveEvent = mouseEvent;\n        this._onMouseMoveOrRelevantKeyDown.fire([mouseEvent, null]);\n    }\n    _onEditorMouseDown(mouseEvent) {\n        // We need to record if we had the trigger key on mouse down because someone might select something in the editor\n        // holding the mouse down and then while mouse is down start to press Ctrl/Cmd to start a copy operation and then\n        // release the mouse button without wanting to do the navigation.\n        // With this flag we prevent goto definition if the mouse was down before the trigger key was pressed.\n        this._hasTriggerKeyOnMouseDown = mouseEvent.hasTriggerModifier;\n        this._lineNumberOnMouseDown = mouseEvent.target.position ? mouseEvent.target.position.lineNumber : 0;\n    }\n    _onEditorMouseUp(mouseEvent) {\n        const currentLineNumber = mouseEvent.target.position ? mouseEvent.target.position.lineNumber : 0;\n        if (this._hasTriggerKeyOnMouseDown && this._lineNumberOnMouseDown && this._lineNumberOnMouseDown === currentLineNumber || this._alwaysFireExecuteOnMouseUp) {\n            this._onExecute.fire(mouseEvent);\n        }\n    }\n    _onEditorKeyDown(e) {\n        if (this._lastMouseMoveEvent\n            && (e.keyCodeIsTriggerKey // User just pressed Ctrl/Cmd (normal goto definition)\n                || (e.keyCodeIsSideBySideKey && e.hasTriggerModifier) // User pressed Ctrl/Cmd+Alt (goto definition to the side)\n            )) {\n            this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent, e]);\n        }\n        else if (e.hasTriggerModifier) {\n            this._onCancel.fire(); // remove decorations if user holds another key with ctrl/cmd to prevent accident goto declaration\n        }\n    }\n    _onEditorKeyUp(e) {\n        if (e.keyCodeIsTriggerKey) {\n            this._onCancel.fire();\n        }\n    }\n    _resetHandler() {\n        this._lastMouseMoveEvent = null;\n        this._hasTriggerKeyOnMouseDown = false;\n        this._onCancel.fire();\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { MarkdownString } from '../../../../../base/common/htmlContent.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { withNullAsUndefined } from '../../../../../base/common/types.js';\nimport './goToDefinitionAtPosition.css';\nimport { EditorState } from '../../../editorState/browser/editorState.js';\nimport { registerEditorContribution } from '../../../../browser/editorExtensions.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { ClickLinkGesture } from './clickLinkGesture.js';\nimport { PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { DefinitionAction } from '../goToCommands.js';\nimport { getDefinitionsAtPosition } from '../goToSymbol.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { ModelDecorationInjectedTextOptions } from '../../../../common/model/textModel.js';\nexport let GotoDefinitionAtPositionEditorContribution = class GotoDefinitionAtPositionEditorContribution {\n    constructor(editor, textModelResolverService, languageService, languageFeaturesService) {\n        this.textModelResolverService = textModelResolverService;\n        this.languageService = languageService;\n        this.languageFeaturesService = languageFeaturesService;\n        this.toUnhook = new DisposableStore();\n        this.toUnhookForKeyboard = new DisposableStore();\n        this.currentWordAtPosition = null;\n        this.previousPromise = null;\n        this.editor = editor;\n        this.linkDecorations = this.editor.createDecorationsCollection();\n        const linkGesture = new ClickLinkGesture(editor);\n        this.toUnhook.add(linkGesture);\n        this.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n            this.startFindDefinitionFromMouse(mouseEvent, withNullAsUndefined(keyboardEvent));\n        }));\n        this.toUnhook.add(linkGesture.onExecute((mouseEvent) => {\n            if (this.isEnabled(mouseEvent)) {\n                this.gotoDefinition(mouseEvent.target.position, mouseEvent.hasSideBySideModifier)\n                    .catch((error) => {\n                    onUnexpectedError(error);\n                })\n                    .finally(() => {\n                    this.removeLinkDecorations();\n                });\n            }\n        }));\n        this.toUnhook.add(linkGesture.onCancel(() => {\n            this.removeLinkDecorations();\n            this.currentWordAtPosition = null;\n        }));\n    }\n    static get(editor) {\n        return editor.getContribution(GotoDefinitionAtPositionEditorContribution.ID);\n    }\n    startFindDefinitionFromCursor(position) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // For issue: https://github.com/microsoft/vscode/issues/46257\n            // equivalent to mouse move with meta/ctrl key\n            // First find the definition and add decorations\n            // to the editor to be shown with the content hover widget\n            yield this.startFindDefinition(position);\n            // Add listeners for editor cursor move and key down events\n            // Dismiss the \"extended\" editor decorations when the user hides\n            // the hover widget. There is no event for the widget itself so these\n            // serve as a best effort. After removing the link decorations, the hover\n            // widget is clean and will only show declarations per next request.\n            this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                this.toUnhookForKeyboard.clear();\n            }));\n            this.toUnhookForKeyboard.add(this.editor.onKeyDown((e) => {\n                if (e) {\n                    this.currentWordAtPosition = null;\n                    this.removeLinkDecorations();\n                    this.toUnhookForKeyboard.clear();\n                }\n            }));\n        });\n    }\n    startFindDefinitionFromMouse(mouseEvent, withKey) {\n        // check if we are active and on a content widget\n        if (mouseEvent.target.type === 9 /* MouseTargetType.CONTENT_WIDGET */ && this.linkDecorations.length > 0) {\n            return;\n        }\n        if (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\n            this.currentWordAtPosition = null;\n            this.removeLinkDecorations();\n            return;\n        }\n        const position = mouseEvent.target.position;\n        this.startFindDefinition(position);\n    }\n    startFindDefinition(position) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            // Dispose listeners for updating decorations when using keyboard to show definition hover\n            this.toUnhookForKeyboard.clear();\n            // Find word at mouse position\n            const word = position ? (_a = this.editor.getModel()) === null || _a === void 0 ? void 0 : _a.getWordAtPosition(position) : null;\n            if (!word) {\n                this.currentWordAtPosition = null;\n                this.removeLinkDecorations();\n                return;\n            }\n            // Return early if word at position is still the same\n            if (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\n                return;\n            }\n            this.currentWordAtPosition = word;\n            // Find definition and decorate word if found\n            const state = new EditorState(this.editor, 4 /* CodeEditorStateFlag.Position */ | 1 /* CodeEditorStateFlag.Value */ | 2 /* CodeEditorStateFlag.Selection */ | 8 /* CodeEditorStateFlag.Scroll */);\n            if (this.previousPromise) {\n                this.previousPromise.cancel();\n                this.previousPromise = null;\n            }\n            this.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\n            let results;\n            try {\n                results = yield this.previousPromise;\n            }\n            catch (error) {\n                onUnexpectedError(error);\n                return;\n            }\n            if (!results || !results.length || !state.validate(this.editor)) {\n                this.removeLinkDecorations();\n                return;\n            }\n            const linkRange = results[0].originSelectionRange\n                ? Range.lift(results[0].originSelectionRange)\n                : new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n            // Multiple results\n            if (results.length > 1) {\n                let combinedRange = linkRange;\n                for (const { originSelectionRange } of results) {\n                    if (originSelectionRange) {\n                        combinedRange = Range.plusRange(combinedRange, originSelectionRange);\n                    }\n                }\n                this.addDecoration(combinedRange, new MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length)));\n            }\n            else {\n                // Single result\n                const result = results[0];\n                if (!result.uri) {\n                    return;\n                }\n                this.textModelResolverService.createModelReference(result.uri).then(ref => {\n                    if (!ref.object || !ref.object.textEditorModel) {\n                        ref.dispose();\n                        return;\n                    }\n                    const { object: { textEditorModel } } = ref;\n                    const { startLineNumber } = result.range;\n                    if (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\n                        // invalid range\n                        ref.dispose();\n                        return;\n                    }\n                    const previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\n                    const languageId = this.languageService.guessLanguageIdByFilepathOrFirstLine(textEditorModel.uri);\n                    this.addDecoration(linkRange, previewValue ? new MarkdownString().appendCodeblock(languageId ? languageId : '', previewValue) : undefined);\n                    ref.dispose();\n                });\n            }\n        });\n    }\n    getPreviewValue(textEditorModel, startLineNumber, result) {\n        let rangeToUse = result.range;\n        const numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\n        if (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES) {\n            rangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\n        }\n        const previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\n        return previewValue;\n    }\n    stripIndentationFromPreviewRange(textEditorModel, startLineNumber, previewRange) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        let minIndent = startIndent;\n        for (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            minIndent = Math.min(minIndent, endIndent);\n        }\n        const previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\n        return previewValue;\n    }\n    getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber) {\n        const startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n        const maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\n        let endLineNumber = startLineNumber + 1;\n        for (; endLineNumber < maxLineNumber; endLineNumber++) {\n            const endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n            if (startIndent === endIndent) {\n                break;\n            }\n        }\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n    }\n    addDecoration(range, hoverMessage) {\n        const newDecorations = {\n            range: range,\n            options: {\n                description: 'goto-definition-link',\n                inlineClassName: 'goto-definition-link',\n                hoverMessage\n            }\n        };\n        this.linkDecorations.set([newDecorations]);\n    }\n    removeLinkDecorations() {\n        this.linkDecorations.clear();\n    }\n    isEnabled(mouseEvent, withKey) {\n        var _a;\n        return this.editor.hasModel()\n            && mouseEvent.isLeftClick\n            && mouseEvent.isNoneOrSingleMouseDown\n            && mouseEvent.target.type === 6 /* MouseTargetType.CONTENT_TEXT */\n            && !(((_a = mouseEvent.target.detail.injectedText) === null || _a === void 0 ? void 0 : _a.options) instanceof ModelDecorationInjectedTextOptions)\n            && (mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false))\n            && this.languageFeaturesService.definitionProvider.has(this.editor.getModel());\n    }\n    findDefinition(position, token) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return Promise.resolve(null);\n        }\n        return getDefinitionsAtPosition(this.languageFeaturesService.definitionProvider, model, position, token);\n    }\n    gotoDefinition(position, openToSide) {\n        this.editor.setPosition(position);\n        return this.editor.invokeWithinContext((accessor) => {\n            const canPeek = !openToSide && this.editor.getOption(85 /* EditorOption.definitionLinkOpensInPeek */) && !this.isInPeekEditor(accessor);\n            const action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { title: { value: '', original: '' }, id: '', precondition: undefined });\n            return action.run(accessor);\n        });\n    }\n    isInPeekEditor(accessor) {\n        const contextKeyService = accessor.get(IContextKeyService);\n        return PeekContext.inPeekEditor.getValue(contextKeyService);\n    }\n    dispose() {\n        this.toUnhook.dispose();\n        this.toUnhookForKeyboard.dispose();\n    }\n};\nGotoDefinitionAtPositionEditorContribution.ID = 'editor.contrib.gotodefinitionatposition';\nGotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES = 8;\nGotoDefinitionAtPositionEditorContribution = __decorate([\n    __param(1, ITextModelService),\n    __param(2, ILanguageService),\n    __param(3, ILanguageFeaturesService)\n], GotoDefinitionAtPositionEditorContribution);\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution, 2 /* EditorContributionInstantiation.BeforeFirstInteraction */);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { CountBadge } from '../../../../../base/browser/ui/countBadge/countBadge.js';\nimport { HighlightedLabel } from '../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js';\nimport { IconLabel } from '../../../../../base/browser/ui/iconLabel/iconLabel.js';\nimport { createMatches, FuzzyScore } from '../../../../../base/common/filters.js';\nimport { Disposable } from '../../../../../base/common/lifecycle.js';\nimport { basename, dirname } from '../../../../../base/common/resources.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { localize } from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { defaultCountBadgeStyles } from '../../../../../platform/theme/browser/defaultStyles.js';\nimport { FileReferences, OneReference, ReferencesModel } from '../referencesModel.js';\nexport let DataSource = class DataSource {\n    constructor(_resolverService) {\n        this._resolverService = _resolverService;\n    }\n    hasChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return true;\n        }\n        if (element instanceof FileReferences) {\n            return true;\n        }\n        return false;\n    }\n    getChildren(element) {\n        if (element instanceof ReferencesModel) {\n            return element.groups;\n        }\n        if (element instanceof FileReferences) {\n            return element.resolve(this._resolverService).then(val => {\n                // if (element.failure) {\n                // \t// refresh the element on failure so that\n                // \t// we can update its rendering\n                // \treturn tree.refresh(element).then(() => val.children);\n                // }\n                return val.children;\n            });\n        }\n        throw new Error('bad tree');\n    }\n};\nDataSource = __decorate([\n    __param(0, ITextModelService)\n], DataSource);\n//#endregion\nexport class Delegate {\n    getHeight() {\n        return 23;\n    }\n    getTemplateId(element) {\n        if (element instanceof FileReferences) {\n            return FileReferencesRenderer.id;\n        }\n        else {\n            return OneReferenceRenderer.id;\n        }\n    }\n}\nexport let StringRepresentationProvider = class StringRepresentationProvider {\n    constructor(_keybindingService) {\n        this._keybindingService = _keybindingService;\n    }\n    getKeyboardNavigationLabel(element) {\n        var _a;\n        if (element instanceof OneReference) {\n            const parts = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n            if (parts) {\n                return parts.value;\n            }\n        }\n        // FileReferences or unresolved OneReference\n        return basename(element.uri);\n    }\n};\nStringRepresentationProvider = __decorate([\n    __param(0, IKeybindingService)\n], StringRepresentationProvider);\nexport class IdentityProvider {\n    getId(element) {\n        return element instanceof OneReference ? element.id : element.uri;\n    }\n}\n//#region render: File\nlet FileReferencesTemplate = class FileReferencesTemplate extends Disposable {\n    constructor(container, _labelService) {\n        super();\n        this._labelService = _labelService;\n        const parent = document.createElement('div');\n        parent.classList.add('reference-file');\n        this.file = this._register(new IconLabel(parent, { supportHighlights: true }));\n        this.badge = new CountBadge(dom.append(parent, dom.$('.count')), {}, defaultCountBadgeStyles);\n        container.appendChild(parent);\n    }\n    set(element, matches) {\n        const parent = dirname(element.uri);\n        this.file.setLabel(this._labelService.getUriBasenameLabel(element.uri), this._labelService.getUriLabel(parent, { relative: true }), { title: this._labelService.getUriLabel(element.uri), matches });\n        const len = element.children.length;\n        this.badge.setCount(len);\n        if (len > 1) {\n            this.badge.setTitleFormat(localize('referencesCount', \"{0} references\", len));\n        }\n        else {\n            this.badge.setTitleFormat(localize('referenceCount', \"{0} reference\", len));\n        }\n    }\n};\nFileReferencesTemplate = __decorate([\n    __param(1, ILabelService)\n], FileReferencesTemplate);\nexport let FileReferencesRenderer = class FileReferencesRenderer {\n    constructor(_instantiationService) {\n        this._instantiationService = _instantiationService;\n        this.templateId = FileReferencesRenderer.id;\n    }\n    renderTemplate(container) {\n        return this._instantiationService.createInstance(FileReferencesTemplate, container);\n    }\n    renderElement(node, index, template) {\n        template.set(node.element, createMatches(node.filterData));\n    }\n    disposeTemplate(templateData) {\n        templateData.dispose();\n    }\n};\nFileReferencesRenderer.id = 'FileReferencesRenderer';\nFileReferencesRenderer = __decorate([\n    __param(0, IInstantiationService)\n], FileReferencesRenderer);\n//#endregion\n//#region render: Reference\nclass OneReferenceTemplate {\n    constructor(container) {\n        this.label = new HighlightedLabel(container);\n    }\n    set(element, score) {\n        var _a;\n        const preview = (_a = element.parent.getPreview(element)) === null || _a === void 0 ? void 0 : _a.preview(element.range);\n        if (!preview || !preview.value) {\n            // this means we FAILED to resolve the document or the value is the empty string\n            this.label.set(`${basename(element.uri)}:${element.range.startLineNumber + 1}:${element.range.startColumn + 1}`);\n        }\n        else {\n            // render search match as highlight unless\n            // we have score, then render the score\n            const { value, highlight } = preview;\n            if (score && !FuzzyScore.isDefault(score)) {\n                this.label.element.classList.toggle('referenceMatch', false);\n                this.label.set(value, createMatches(score));\n            }\n            else {\n                this.label.element.classList.toggle('referenceMatch', true);\n                this.label.set(value, [highlight]);\n            }\n        }\n    }\n}\nexport class OneReferenceRenderer {\n    constructor() {\n        this.templateId = OneReferenceRenderer.id;\n    }\n    renderTemplate(container) {\n        return new OneReferenceTemplate(container);\n    }\n    renderElement(node, index, templateData) {\n        templateData.set(node.element, node.filterData);\n    }\n    disposeTemplate() {\n    }\n}\nOneReferenceRenderer.id = 'OneReferenceRenderer';\n//#endregion\nexport class AccessibilityProvider {\n    getWidgetAriaLabel() {\n        return localize('treeAriaLabel', \"References\");\n    }\n    getAriaLabel(element) {\n        return element.ariaMessage;\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport * as dom from '../../../../../base/browser/dom.js';\nimport { Sizing, SplitView } from '../../../../../base/browser/ui/splitview/splitview.js';\nimport { Color } from '../../../../../base/common/color.js';\nimport { Emitter, Event } from '../../../../../base/common/event.js';\nimport { DisposableStore, dispose } from '../../../../../base/common/lifecycle.js';\nimport { Schemas } from '../../../../../base/common/network.js';\nimport { basenameOrAuthority, dirname } from '../../../../../base/common/resources.js';\nimport './referencesWidget.css';\nimport { EmbeddedCodeEditorWidget } from '../../../../browser/widget/embeddedCodeEditorWidget.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { ModelDecorationOptions, TextModel } from '../../../../common/model/textModel.js';\nimport { ILanguageConfigurationService } from '../../../../common/languages/languageConfigurationRegistry.js';\nimport { PLAINTEXT_LANGUAGE_ID } from '../../../../common/languages/modesRegistry.js';\nimport { ILanguageService } from '../../../../common/languages/language.js';\nimport { ITextModelService } from '../../../../common/services/resolverService.js';\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, IdentityProvider, OneReferenceRenderer, StringRepresentationProvider } from './referencesTree.js';\nimport * as peekView from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nimport { ILabelService } from '../../../../../platform/label/common/label.js';\nimport { WorkbenchAsyncDataTree } from '../../../../../platform/list/browser/listService.js';\nimport { IThemeService } from '../../../../../platform/theme/common/themeService.js';\nimport { IUndoRedoService } from '../../../../../platform/undoRedo/common/undoRedo.js';\nimport { FileReferences, OneReference } from '../referencesModel.js';\nclass DecorationsManager {\n    constructor(_editor, _model) {\n        this._editor = _editor;\n        this._model = _model;\n        this._decorations = new Map();\n        this._decorationIgnoreSet = new Set();\n        this._callOnDispose = new DisposableStore();\n        this._callOnModelChange = new DisposableStore();\n        this._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\n        this._onModelChanged();\n    }\n    dispose() {\n        this._callOnModelChange.dispose();\n        this._callOnDispose.dispose();\n        this.removeDecorations();\n    }\n    _onModelChanged() {\n        this._callOnModelChange.clear();\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const ref of this._model.references) {\n            if (ref.uri.toString() === model.uri.toString()) {\n                this._addDecorations(ref.parent);\n                return;\n            }\n        }\n    }\n    _addDecorations(reference) {\n        if (!this._editor.hasModel()) {\n            return;\n        }\n        this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\n        const newDecorations = [];\n        const newDecorationsActualIndex = [];\n        for (let i = 0, len = reference.children.length; i < len; i++) {\n            const oneReference = reference.children[i];\n            if (this._decorationIgnoreSet.has(oneReference.id)) {\n                continue;\n            }\n            if (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\n                continue;\n            }\n            newDecorations.push({\n                range: oneReference.range,\n                options: DecorationsManager.DecorationOptions\n            });\n            newDecorationsActualIndex.push(i);\n        }\n        this._editor.changeDecorations((changeAccessor) => {\n            const decorations = changeAccessor.deltaDecorations([], newDecorations);\n            for (let i = 0; i < decorations.length; i++) {\n                this._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\n            }\n        });\n    }\n    _onDecorationChanged() {\n        const toRemove = [];\n        const model = this._editor.getModel();\n        if (!model) {\n            return;\n        }\n        for (const [decorationId, reference] of this._decorations) {\n            const newRange = model.getDecorationRange(decorationId);\n            if (!newRange) {\n                continue;\n            }\n            let ignore = false;\n            if (Range.equalsRange(newRange, reference.range)) {\n                continue;\n            }\n            if (Range.spansMultipleLines(newRange)) {\n                ignore = true;\n            }\n            else {\n                const lineLength = reference.range.endColumn - reference.range.startColumn;\n                const newLineLength = newRange.endColumn - newRange.startColumn;\n                if (lineLength !== newLineLength) {\n                    ignore = true;\n                }\n            }\n            if (ignore) {\n                this._decorationIgnoreSet.add(reference.id);\n                toRemove.push(decorationId);\n            }\n            else {\n                reference.range = newRange;\n            }\n        }\n        for (let i = 0, len = toRemove.length; i < len; i++) {\n            this._decorations.delete(toRemove[i]);\n        }\n        this._editor.removeDecorations(toRemove);\n    }\n    removeDecorations() {\n        this._editor.removeDecorations([...this._decorations.keys()]);\n        this._decorations.clear();\n    }\n}\nDecorationsManager.DecorationOptions = ModelDecorationOptions.register({\n    description: 'reference-decoration',\n    stickiness: 1 /* TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges */,\n    className: 'reference-decoration'\n});\nexport class LayoutData {\n    constructor() {\n        this.ratio = 0.7;\n        this.heightInLines = 18;\n    }\n    static fromJSON(raw) {\n        let ratio;\n        let heightInLines;\n        try {\n            const data = JSON.parse(raw);\n            ratio = data.ratio;\n            heightInLines = data.heightInLines;\n        }\n        catch (_a) {\n            //\n        }\n        return {\n            ratio: ratio || 0.7,\n            heightInLines: heightInLines || 18\n        };\n    }\n}\nclass ReferencesTree extends WorkbenchAsyncDataTree {\n}\n/**\n * ZoneWidget that is shown inside the editor\n */\nexport let ReferenceWidget = class ReferenceWidget extends peekView.PeekViewWidget {\n    constructor(editor, _defaultTreeKeyboardSupport, layoutData, themeService, _textModelResolverService, _instantiationService, _peekViewService, _uriLabel, _undoRedoService, _keybindingService, _languageService, _languageConfigurationService) {\n        super(editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true, supportOnTitleClick: true }, _instantiationService);\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this.layoutData = layoutData;\n        this._textModelResolverService = _textModelResolverService;\n        this._instantiationService = _instantiationService;\n        this._peekViewService = _peekViewService;\n        this._uriLabel = _uriLabel;\n        this._undoRedoService = _undoRedoService;\n        this._keybindingService = _keybindingService;\n        this._languageService = _languageService;\n        this._languageConfigurationService = _languageConfigurationService;\n        this._disposeOnNewModel = new DisposableStore();\n        this._callOnDispose = new DisposableStore();\n        this._onDidSelectReference = new Emitter();\n        this.onDidSelectReference = this._onDidSelectReference.event;\n        this._dim = new dom.Dimension(0, 0);\n        this._applyTheme(themeService.getColorTheme());\n        this._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n        this._peekViewService.addExclusiveWidget(editor, this);\n        this.create();\n    }\n    dispose() {\n        this.setModel(undefined);\n        this._callOnDispose.dispose();\n        this._disposeOnNewModel.dispose();\n        dispose(this._preview);\n        dispose(this._previewNotAvailableMessage);\n        dispose(this._tree);\n        dispose(this._previewModelReference);\n        this._splitView.dispose();\n        super.dispose();\n    }\n    _applyTheme(theme) {\n        const borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\n        this.style({\n            arrowColor: borderColor,\n            frameColor: borderColor,\n            headerBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\n            primaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\n            secondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\n        });\n    }\n    show(where) {\n        super.show(where, this.layoutData.heightInLines || 18);\n    }\n    focusOnReferenceTree() {\n        this._tree.domFocus();\n    }\n    focusOnPreviewEditor() {\n        this._preview.focus();\n    }\n    isPreviewEditorFocused() {\n        return this._preview.hasTextFocus();\n    }\n    _onTitleClick(e) {\n        if (this._preview && this._preview.getModel()) {\n            this._onDidSelectReference.fire({\n                element: this._getFocusedReference(),\n                kind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\n                source: 'title'\n            });\n        }\n    }\n    _fillBody(containerElement) {\n        this.setCssClass('reference-zone-widget');\n        // message pane\n        this._messageContainer = dom.append(containerElement, dom.$('div.messages'));\n        dom.hide(this._messageContainer);\n        this._splitView = new SplitView(containerElement, { orientation: 1 /* Orientation.HORIZONTAL */ });\n        // editor\n        this._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\n        const options = {\n            scrollBeyondLastLine: false,\n            scrollbar: {\n                verticalScrollbarSize: 14,\n                horizontal: 'auto',\n                useShadows: true,\n                verticalHasArrows: false,\n                horizontalHasArrows: false,\n                alwaysConsumeMouseWheel: false\n            },\n            overviewRulerLanes: 2,\n            fixedOverflowWidgets: true,\n            minimap: {\n                enabled: false\n            }\n        };\n        this._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, {}, this.editor);\n        dom.hide(this._previewContainer);\n        this._previewNotAvailableMessage = new TextModel(nls.localize('missingPreviewMessage', \"no preview available\"), PLAINTEXT_LANGUAGE_ID, TextModel.DEFAULT_CREATION_OPTIONS, null, this._undoRedoService, this._languageService, this._languageConfigurationService);\n        // tree\n        this._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\n        const treeOptions = {\n            keyboardSupport: this._defaultTreeKeyboardSupport,\n            accessibilityProvider: new AccessibilityProvider(),\n            keyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\n            identityProvider: new IdentityProvider(),\n            openOnSingleClick: true,\n            selectionNavigation: true,\n            overrideStyles: {\n                listBackground: peekView.peekViewResultsBackground\n            }\n        };\n        if (this._defaultTreeKeyboardSupport) {\n            // the tree will consume `Escape` and prevent the widget from closing\n            this._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', (e) => {\n                if (e.equals(9 /* KeyCode.Escape */)) {\n                    this._keybindingService.dispatchEvent(e, e.target);\n                    e.stopPropagation();\n                }\n            }, true));\n        }\n        this._tree = this._instantiationService.createInstance(ReferencesTree, 'ReferencesWidget', this._treeContainer, new Delegate(), [\n            this._instantiationService.createInstance(FileReferencesRenderer),\n            this._instantiationService.createInstance(OneReferenceRenderer),\n        ], this._instantiationService.createInstance(DataSource), treeOptions);\n        // split stuff\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._previewContainer,\n            minimumSize: 200,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._preview.layout({ height: this._dim.height, width });\n            }\n        }, Sizing.Distribute);\n        this._splitView.addView({\n            onDidChange: Event.None,\n            element: this._treeContainer,\n            minimumSize: 100,\n            maximumSize: Number.MAX_VALUE,\n            layout: (width) => {\n                this._treeContainer.style.height = `${this._dim.height}px`;\n                this._treeContainer.style.width = `${width}px`;\n                this._tree.layout(this._dim.height, width);\n            }\n        }, Sizing.Distribute);\n        this._disposables.add(this._splitView.onDidSashChange(() => {\n            if (this._dim.width) {\n                this.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\n            }\n        }, undefined));\n        // listen on selection and focus\n        const onEvent = (element, kind) => {\n            if (element instanceof OneReference) {\n                if (kind === 'show') {\n                    this._revealReference(element, false);\n                }\n                this._onDidSelectReference.fire({ element, kind, source: 'tree' });\n            }\n        };\n        this._tree.onDidOpen(e => {\n            if (e.sideBySide) {\n                onEvent(e.element, 'side');\n            }\n            else if (e.editorOptions.pinned) {\n                onEvent(e.element, 'goto');\n            }\n            else {\n                onEvent(e.element, 'show');\n            }\n        });\n        dom.hide(this._treeContainer);\n    }\n    _onWidth(width) {\n        if (this._dim) {\n            this._doLayoutBody(this._dim.height, width);\n        }\n    }\n    _doLayoutBody(heightInPixel, widthInPixel) {\n        super._doLayoutBody(heightInPixel, widthInPixel);\n        this._dim = new dom.Dimension(widthInPixel, heightInPixel);\n        this.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\n        this._splitView.layout(widthInPixel);\n        this._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\n    }\n    setSelection(selection) {\n        return this._revealReference(selection, true).then(() => {\n            if (!this._model) {\n                // disposed\n                return;\n            }\n            // show in tree\n            this._tree.setSelection([selection]);\n            this._tree.setFocus([selection]);\n        });\n    }\n    setModel(newModel) {\n        // clean up\n        this._disposeOnNewModel.clear();\n        this._model = newModel;\n        if (this._model) {\n            return this._onNewModel();\n        }\n        return Promise.resolve();\n    }\n    _onNewModel() {\n        if (!this._model) {\n            return Promise.resolve(undefined);\n        }\n        if (this._model.isEmpty) {\n            this.setTitle('');\n            this._messageContainer.innerText = nls.localize('noResults', \"No results\");\n            dom.show(this._messageContainer);\n            return Promise.resolve(undefined);\n        }\n        dom.hide(this._messageContainer);\n        this._decorationsManager = new DecorationsManager(this._preview, this._model);\n        this._disposeOnNewModel.add(this._decorationsManager);\n        // listen on model changes\n        this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference)));\n        // listen on editor\n        this._disposeOnNewModel.add(this._preview.onMouseDown(e => {\n            const { event, target } = e;\n            if (event.detail !== 2) {\n                return;\n            }\n            const element = this._getFocusedReference();\n            if (!element) {\n                return;\n            }\n            this._onDidSelectReference.fire({\n                element: { uri: element.uri, range: target.range },\n                kind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\n                source: 'editor'\n            });\n        }));\n        // make sure things are rendered\n        this.container.classList.add('results-loaded');\n        dom.show(this._treeContainer);\n        dom.show(this._previewContainer);\n        this._splitView.layout(this._dim.width);\n        this.focusOnReferenceTree();\n        // pick input and a reference to begin with\n        return this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\n    }\n    _getFocusedReference() {\n        const [element] = this._tree.getFocus();\n        if (element instanceof OneReference) {\n            return element;\n        }\n        else if (element instanceof FileReferences) {\n            if (element.children.length > 0) {\n                return element.children[0];\n            }\n        }\n        return undefined;\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._revealReference(reference, false);\n            this._onDidSelectReference.fire({ element: reference, kind: 'goto', source: 'tree' });\n        });\n    }\n    _revealReference(reference, revealParent) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // check if there is anything to do...\n            if (this._revealedReference === reference) {\n                return;\n            }\n            this._revealedReference = reference;\n            // Update widget header\n            if (reference.uri.scheme !== Schemas.inMemory) {\n                this.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\n            }\n            else {\n                this.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\n            }\n            const promise = this._textModelResolverService.createModelReference(reference.uri);\n            if (this._tree.getInput() === reference.parent) {\n                this._tree.reveal(reference);\n            }\n            else {\n                if (revealParent) {\n                    this._tree.reveal(reference.parent);\n                }\n                yield this._tree.expand(reference.parent);\n                this._tree.reveal(reference);\n            }\n            const ref = yield promise;\n            if (!this._model) {\n                // disposed\n                ref.dispose();\n                return;\n            }\n            dispose(this._previewModelReference);\n            // show in editor\n            const model = ref.object;\n            if (model) {\n                const scrollType = this._preview.getModel() === model.textEditorModel ? 0 /* ScrollType.Smooth */ : 1 /* ScrollType.Immediate */;\n                const sel = Range.lift(reference.range).collapseToStart();\n                this._previewModelReference = ref;\n                this._preview.setModel(model.textEditorModel);\n                this._preview.setSelection(sel);\n                this._preview.revealRangeInCenter(sel, scrollType);\n            }\n            else {\n                this._preview.setModel(this._previewNotAvailableMessage);\n                ref.dispose();\n            }\n        });\n    }\n};\nReferenceWidget = __decorate([\n    __param(3, IThemeService),\n    __param(4, ITextModelService),\n    __param(5, IInstantiationService),\n    __param(6, peekView.IPeekViewService),\n    __param(7, ILabelService),\n    __param(8, IUndoRedoService),\n    __param(9, IKeybindingService),\n    __param(10, ILanguageService),\n    __param(11, ILanguageConfigurationService)\n], ReferenceWidget);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { createCancelablePromise } from '../../../../../base/common/async.js';\nimport { onUnexpectedError } from '../../../../../base/common/errors.js';\nimport { KeyChord } from '../../../../../base/common/keyCodes.js';\nimport { DisposableStore } from '../../../../../base/common/lifecycle.js';\nimport { ICodeEditorService } from '../../../../browser/services/codeEditorService.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { Range } from '../../../../common/core/range.js';\nimport { getOuterEditor, PeekContext } from '../../../peekView/browser/peekView.js';\nimport * as nls from '../../../../../nls.js';\nimport { CommandsRegistry } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { ContextKeyExpr, IContextKeyService, RawContextKey } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { KeybindingsRegistry } from '../../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { IListService, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse, WorkbenchTreeElementCanExpand } from '../../../../../platform/list/browser/listService.js';\nimport { INotificationService } from '../../../../../platform/notification/common/notification.js';\nimport { IStorageService } from '../../../../../platform/storage/common/storage.js';\nimport { OneReference } from '../referencesModel.js';\nimport { LayoutData, ReferenceWidget } from './referencesWidget.js';\nexport const ctxReferenceSearchVisible = new RawContextKey('referenceSearchVisible', false, nls.localize('referenceSearchVisible', \"Whether reference peek is visible, like 'Peek References' or 'Peek Definition'\"));\nexport let ReferencesController = class ReferencesController {\n    static get(editor) {\n        return editor.getContribution(ReferencesController.ID);\n    }\n    constructor(_defaultTreeKeyboardSupport, _editor, contextKeyService, _editorService, _notificationService, _instantiationService, _storageService, _configurationService) {\n        this._defaultTreeKeyboardSupport = _defaultTreeKeyboardSupport;\n        this._editor = _editor;\n        this._editorService = _editorService;\n        this._notificationService = _notificationService;\n        this._instantiationService = _instantiationService;\n        this._storageService = _storageService;\n        this._configurationService = _configurationService;\n        this._disposables = new DisposableStore();\n        this._requestIdPool = 0;\n        this._ignoreModelChangeEvent = false;\n        this._referenceSearchVisible = ctxReferenceSearchVisible.bindTo(contextKeyService);\n    }\n    dispose() {\n        var _a, _b;\n        this._referenceSearchVisible.reset();\n        this._disposables.dispose();\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._widget = undefined;\n        this._model = undefined;\n    }\n    toggleWidget(range, modelPromise, peekMode) {\n        // close current widget and return early is position didn't change\n        let widgetPosition;\n        if (this._widget) {\n            widgetPosition = this._widget.position;\n        }\n        this.closeWidget();\n        if (!!widgetPosition && range.containsPosition(widgetPosition)) {\n            return;\n        }\n        this._peekMode = peekMode;\n        this._referenceSearchVisible.set(true);\n        // close the widget on model/mode changes\n        this._disposables.add(this._editor.onDidChangeModelLanguage(() => { this.closeWidget(); }));\n        this._disposables.add(this._editor.onDidChangeModel(() => {\n            if (!this._ignoreModelChangeEvent) {\n                this.closeWidget();\n            }\n        }));\n        const storageKey = 'peekViewLayout';\n        const data = LayoutData.fromJSON(this._storageService.get(storageKey, 0 /* StorageScope.PROFILE */, '{}'));\n        this._widget = this._instantiationService.createInstance(ReferenceWidget, this._editor, this._defaultTreeKeyboardSupport, data);\n        this._widget.setTitle(nls.localize('labelLoading', \"Loading...\"));\n        this._widget.show(range);\n        this._disposables.add(this._widget.onDidClose(() => {\n            modelPromise.cancel();\n            if (this._widget) {\n                this._storageService.store(storageKey, JSON.stringify(this._widget.layoutData), 0 /* StorageScope.PROFILE */, 1 /* StorageTarget.MACHINE */);\n                this._widget = undefined;\n            }\n            this.closeWidget();\n        }));\n        this._disposables.add(this._widget.onDidSelectReference(event => {\n            const { element, kind } = event;\n            if (!element) {\n                return;\n            }\n            switch (kind) {\n                case 'open':\n                    if (event.source !== 'editor' || !this._configurationService.getValue('editor.stablePeek')) {\n                        // when stable peek is configured we don't close\n                        // the peek window on selecting the editor\n                        this.openReference(element, false, false);\n                    }\n                    break;\n                case 'side':\n                    this.openReference(element, true, false);\n                    break;\n                case 'goto':\n                    if (peekMode) {\n                        this._gotoReference(element, true);\n                    }\n                    else {\n                        this.openReference(element, false, true);\n                    }\n                    break;\n            }\n        }));\n        const requestId = ++this._requestIdPool;\n        modelPromise.then(model => {\n            var _a;\n            // still current request? widget still open?\n            if (requestId !== this._requestIdPool || !this._widget) {\n                model.dispose();\n                return undefined;\n            }\n            (_a = this._model) === null || _a === void 0 ? void 0 : _a.dispose();\n            this._model = model;\n            // show widget\n            return this._widget.setModel(this._model).then(() => {\n                if (this._widget && this._model && this._editor.hasModel()) { // might have been closed\n                    // set title\n                    if (!this._model.isEmpty) {\n                        this._widget.setMetaTitle(nls.localize('metaTitle.N', \"{0} ({1})\", this._model.title, this._model.references.length));\n                    }\n                    else {\n                        this._widget.setMetaTitle('');\n                    }\n                    // set 'best' selection\n                    const uri = this._editor.getModel().uri;\n                    const pos = new Position(range.startLineNumber, range.startColumn);\n                    const selection = this._model.nearestReference(uri, pos);\n                    if (selection) {\n                        return this._widget.setSelection(selection).then(() => {\n                            if (this._widget && this._editor.getOption(84 /* EditorOption.peekWidgetDefaultFocus */) === 'editor') {\n                                this._widget.focusOnPreviewEditor();\n                            }\n                        });\n                    }\n                }\n                return undefined;\n            });\n        }, error => {\n            this._notificationService.error(error);\n        });\n    }\n    changeFocusBetweenPreviewAndReferences() {\n        if (!this._widget) {\n            // can be called while still resolving...\n            return;\n        }\n        if (this._widget.isPreviewEditorFocused()) {\n            this._widget.focusOnReferenceTree();\n        }\n        else {\n            this._widget.focusOnPreviewEditor();\n        }\n    }\n    goToNextOrPreviousReference(fwd) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\n                // can be called while still resolving...\n                return;\n            }\n            const currentPosition = this._widget.position;\n            if (!currentPosition) {\n                return;\n            }\n            const source = this._model.nearestReference(this._editor.getModel().uri, currentPosition);\n            if (!source) {\n                return;\n            }\n            const target = this._model.nextOrPreviousReference(source, fwd);\n            const editorFocus = this._editor.hasTextFocus();\n            const previewEditorFocus = this._widget.isPreviewEditorFocused();\n            yield this._widget.setSelection(target);\n            yield this._gotoReference(target, false);\n            if (editorFocus) {\n                this._editor.focus();\n            }\n            else if (this._widget && previewEditorFocus) {\n                this._widget.focusOnPreviewEditor();\n            }\n        });\n    }\n    revealReference(reference) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this._editor.hasModel() || !this._model || !this._widget) {\n                // can be called while still resolving...\n                return;\n            }\n            yield this._widget.revealReference(reference);\n        });\n    }\n    closeWidget(focusEditor = true) {\n        var _a, _b;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.dispose();\n        (_b = this._model) === null || _b === void 0 ? void 0 : _b.dispose();\n        this._referenceSearchVisible.reset();\n        this._disposables.clear();\n        this._widget = undefined;\n        this._model = undefined;\n        if (focusEditor) {\n            this._editor.focus();\n        }\n        this._requestIdPool += 1; // Cancel pending requests\n    }\n    _gotoReference(ref, pinned) {\n        var _a;\n        (_a = this._widget) === null || _a === void 0 ? void 0 : _a.hide();\n        this._ignoreModelChangeEvent = true;\n        const range = Range.lift(ref.range).collapseToStart();\n        return this._editorService.openCodeEditor({\n            resource: ref.uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor).then(openedEditor => {\n            var _a;\n            this._ignoreModelChangeEvent = false;\n            if (!openedEditor || !this._widget) {\n                // something went wrong...\n                this.closeWidget();\n                return;\n            }\n            if (this._editor === openedEditor) {\n                //\n                this._widget.show(range);\n                this._widget.focusOnReferenceTree();\n            }\n            else {\n                // we opened a different editor instance which means a different controller instance.\n                // therefore we stop with this controller and continue with the other\n                const other = ReferencesController.get(openedEditor);\n                const model = this._model.clone();\n                this.closeWidget();\n                openedEditor.focus();\n                other === null || other === void 0 ? void 0 : other.toggleWidget(range, createCancelablePromise(_ => Promise.resolve(model)), (_a = this._peekMode) !== null && _a !== void 0 ? _a : false);\n            }\n        }, (err) => {\n            this._ignoreModelChangeEvent = false;\n            onUnexpectedError(err);\n        });\n    }\n    openReference(ref, sideBySide, pinned) {\n        // clear stage\n        if (!sideBySide) {\n            this.closeWidget();\n        }\n        const { uri, range } = ref;\n        this._editorService.openCodeEditor({\n            resource: uri,\n            options: { selection: range, selectionSource: \"code.jump\" /* TextEditorSelectionSource.JUMP */, pinned }\n        }, this._editor, sideBySide);\n    }\n};\nReferencesController.ID = 'editor.contrib.referencesController';\nReferencesController = __decorate([\n    __param(2, IContextKeyService),\n    __param(3, ICodeEditorService),\n    __param(4, INotificationService),\n    __param(5, IInstantiationService),\n    __param(6, IStorageService),\n    __param(7, IConfigurationService)\n], ReferencesController);\nfunction withController(accessor, fn) {\n    const outerEditor = getOuterEditor(accessor);\n    if (!outerEditor) {\n        return;\n    }\n    const controller = ReferencesController.get(outerEditor);\n    if (controller) {\n        fn(controller);\n    }\n}\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'togglePeekWidgetFocus',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: KeyChord(2048 /* KeyMod.CtrlCmd */ | 41 /* KeyCode.KeyK */, 60 /* KeyCode.F2 */),\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.changeFocusBetweenPreviewAndReferences();\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToNextReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 62 /* KeyCode.F4 */,\n    secondary: [70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(true);\n        });\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'goToPreviousReference',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 10,\n    primary: 1024 /* KeyMod.Shift */ | 62 /* KeyCode.F4 */,\n    secondary: [1024 /* KeyMod.Shift */ | 70 /* KeyCode.F12 */],\n    when: ContextKeyExpr.or(ctxReferenceSearchVisible, PeekContext.inPeekEditor),\n    handler(accessor) {\n        withController(accessor, controller => {\n            controller.goToNextOrPreviousReference(false);\n        });\n    }\n});\n// commands that aren't needed anymore because there is now ContextKeyExpr.OR\nCommandsRegistry.registerCommandAlias('goToNextReferenceFromEmbeddedEditor', 'goToNextReference');\nCommandsRegistry.registerCommandAlias('goToPreviousReferenceFromEmbeddedEditor', 'goToPreviousReference');\n// close\nCommandsRegistry.registerCommandAlias('closeReferenceSearchEditor', 'closeReferenceSearch');\nCommandsRegistry.registerCommand('closeReferenceSearch', accessor => withController(accessor, controller => controller.closeWidget()));\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 100 /* KeybindingWeight.EditorContrib */ - 101,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(PeekContext.inPeekEditor, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerKeybindingRule({\n    id: 'closeReferenceSearch',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */ + 50,\n    primary: 9 /* KeyCode.Escape */,\n    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */],\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, ContextKeyExpr.not('config.editor.stablePeek'))\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'revealReference',\n    weight: 200 /* KeybindingWeight.WorkbenchContrib */,\n    primary: 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 3 /* KeyCode.Enter */,\n        secondary: [2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */]\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.revealReference(focus[0]));\n        }\n    }\n});\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n    id: 'openReferenceToSide',\n    weight: 100 /* KeybindingWeight.EditorContrib */,\n    primary: 2048 /* KeyMod.CtrlCmd */ | 3 /* KeyCode.Enter */,\n    mac: {\n        primary: 256 /* KeyMod.WinCtrl */ | 3 /* KeyCode.Enter */\n    },\n    when: ContextKeyExpr.and(ctxReferenceSearchVisible, WorkbenchListFocusContextKey, WorkbenchTreeElementCanCollapse.negate(), WorkbenchTreeElementCanExpand.negate()),\n    handler(accessor) {\n        var _a;\n        const listService = accessor.get(IListService);\n        const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n        if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n            withController(accessor, controller => controller.openReference(focus[0], true, true));\n        }\n    }\n});\nCommandsRegistry.registerCommand('openReference', (accessor) => {\n    var _a;\n    const listService = accessor.get(IListService);\n    const focus = (_a = listService.lastFocusedList) === null || _a === void 0 ? void 0 : _a.getFocus();\n    if (Array.isArray(focus) && focus[0] instanceof OneReference) {\n        withController(accessor, controller => controller.openReference(focus[0], false, true));\n    }\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { defaultGenerator } from '../../../../base/common/idGenerator.js';\nimport { dispose } from '../../../../base/common/lifecycle.js';\nimport { ResourceMap } from '../../../../base/common/map.js';\nimport { basename, extUri } from '../../../../base/common/resources.js';\nimport * as strings from '../../../../base/common/strings.js';\nimport { Range } from '../../../common/core/range.js';\nimport { localize } from '../../../../nls.js';\nexport class OneReference {\n    constructor(isProviderFirst, parent, link, _rangeCallback) {\n        this.isProviderFirst = isProviderFirst;\n        this.parent = parent;\n        this.link = link;\n        this._rangeCallback = _rangeCallback;\n        this.id = defaultGenerator.nextId();\n    }\n    get uri() {\n        return this.link.uri;\n    }\n    get range() {\n        var _a, _b;\n        return (_b = (_a = this._range) !== null && _a !== void 0 ? _a : this.link.targetSelectionRange) !== null && _b !== void 0 ? _b : this.link.range;\n    }\n    set range(value) {\n        this._range = value;\n        this._rangeCallback(this);\n    }\n    get ariaMessage() {\n        var _a;\n        const preview = (_a = this.parent.getPreview(this)) === null || _a === void 0 ? void 0 : _a.preview(this.range);\n        if (!preview) {\n            return localize('aria.oneReference', \"in {0} on line {1} at column {2}\", basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n        else {\n            return localize({ key: 'aria.oneReference.preview', comment: ['Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code'] }, \"{0} in {1} on line {2} at column {3}\", preview.value, basename(this.uri), this.range.startLineNumber, this.range.startColumn);\n        }\n    }\n}\nexport class FilePreview {\n    constructor(_modelReference) {\n        this._modelReference = _modelReference;\n    }\n    dispose() {\n        this._modelReference.dispose();\n    }\n    preview(range, n = 8) {\n        const model = this._modelReference.object.textEditorModel;\n        if (!model) {\n            return undefined;\n        }\n        const { startLineNumber, startColumn, endLineNumber, endColumn } = range;\n        const word = model.getWordUntilPosition({ lineNumber: startLineNumber, column: startColumn - n });\n        const beforeRange = new Range(startLineNumber, word.startColumn, startLineNumber, startColumn);\n        const afterRange = new Range(endLineNumber, endColumn, endLineNumber, 1073741824 /* Constants.MAX_SAFE_SMALL_INTEGER */);\n        const before = model.getValueInRange(beforeRange).replace(/^\\s+/, '');\n        const inside = model.getValueInRange(range);\n        const after = model.getValueInRange(afterRange).replace(/\\s+$/, '');\n        return {\n            value: before + inside + after,\n            highlight: { start: before.length, end: before.length + inside.length }\n        };\n    }\n}\nexport class FileReferences {\n    constructor(parent, uri) {\n        this.parent = parent;\n        this.uri = uri;\n        this.children = [];\n        this._previews = new ResourceMap();\n    }\n    dispose() {\n        dispose(this._previews.values());\n        this._previews.clear();\n    }\n    getPreview(child) {\n        return this._previews.get(child.uri);\n    }\n    get ariaMessage() {\n        const len = this.children.length;\n        if (len === 1) {\n            return localize('aria.fileReferences.1', \"1 symbol in {0}, full path {1}\", basename(this.uri), this.uri.fsPath);\n        }\n        else {\n            return localize('aria.fileReferences.N', \"{0} symbols in {1}, full path {2}\", len, basename(this.uri), this.uri.fsPath);\n        }\n    }\n    resolve(textModelResolverService) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this._previews.size !== 0) {\n                return this;\n            }\n            for (const child of this.children) {\n                if (this._previews.has(child.uri)) {\n                    continue;\n                }\n                try {\n                    const ref = yield textModelResolverService.createModelReference(child.uri);\n                    this._previews.set(child.uri, new FilePreview(ref));\n                }\n                catch (err) {\n                    onUnexpectedError(err);\n                }\n            }\n            return this;\n        });\n    }\n}\nexport class ReferencesModel {\n    constructor(links, title) {\n        this.groups = [];\n        this.references = [];\n        this._onDidChangeReferenceRange = new Emitter();\n        this.onDidChangeReferenceRange = this._onDidChangeReferenceRange.event;\n        this._links = links;\n        this._title = title;\n        // grouping and sorting\n        const [providersFirst] = links;\n        links.sort(ReferencesModel._compareReferences);\n        let current;\n        for (const link of links) {\n            if (!current || !extUri.isEqual(current.uri, link.uri, true)) {\n                // new group\n                current = new FileReferences(this, link.uri);\n                this.groups.push(current);\n            }\n            // append, check for equality first!\n            if (current.children.length === 0 || ReferencesModel._compareReferences(link, current.children[current.children.length - 1]) !== 0) {\n                const oneRef = new OneReference(providersFirst === link, current, link, ref => this._onDidChangeReferenceRange.fire(ref));\n                this.references.push(oneRef);\n                current.children.push(oneRef);\n            }\n        }\n    }\n    dispose() {\n        dispose(this.groups);\n        this._onDidChangeReferenceRange.dispose();\n        this.groups.length = 0;\n    }\n    clone() {\n        return new ReferencesModel(this._links, this._title);\n    }\n    get title() {\n        return this._title;\n    }\n    get isEmpty() {\n        return this.groups.length === 0;\n    }\n    get ariaMessage() {\n        if (this.isEmpty) {\n            return localize('aria.result.0', \"No results found\");\n        }\n        else if (this.references.length === 1) {\n            return localize('aria.result.1', \"Found 1 symbol in {0}\", this.references[0].uri.fsPath);\n        }\n        else if (this.groups.length === 1) {\n            return localize('aria.result.n1', \"Found {0} symbols in {1}\", this.references.length, this.groups[0].uri.fsPath);\n        }\n        else {\n            return localize('aria.result.nm', \"Found {0} symbols in {1} files\", this.references.length, this.groups.length);\n        }\n    }\n    nextOrPreviousReference(reference, next) {\n        const { parent } = reference;\n        let idx = parent.children.indexOf(reference);\n        const childCount = parent.children.length;\n        const groupCount = parent.parent.groups.length;\n        if (groupCount === 1 || next && idx + 1 < childCount || !next && idx > 0) {\n            // cycling within one file\n            if (next) {\n                idx = (idx + 1) % childCount;\n            }\n            else {\n                idx = (idx + childCount - 1) % childCount;\n            }\n            return parent.children[idx];\n        }\n        idx = parent.parent.groups.indexOf(parent);\n        if (next) {\n            idx = (idx + 1) % groupCount;\n            return parent.parent.groups[idx].children[0];\n        }\n        else {\n            idx = (idx + groupCount - 1) % groupCount;\n            return parent.parent.groups[idx].children[parent.parent.groups[idx].children.length - 1];\n        }\n    }\n    nearestReference(resource, position) {\n        const nearest = this.references.map((ref, idx) => {\n            return {\n                idx,\n                prefixLen: strings.commonPrefixLength(ref.uri.toString(), resource.toString()),\n                offsetDist: Math.abs(ref.range.startLineNumber - position.lineNumber) * 100 + Math.abs(ref.range.startColumn - position.column)\n            };\n        }).sort((a, b) => {\n            if (a.prefixLen > b.prefixLen) {\n                return -1;\n            }\n            else if (a.prefixLen < b.prefixLen) {\n                return 1;\n            }\n            else if (a.offsetDist < b.offsetDist) {\n                return -1;\n            }\n            else if (a.offsetDist > b.offsetDist) {\n                return 1;\n            }\n            else {\n                return 0;\n            }\n        })[0];\n        if (nearest) {\n            return this.references[nearest.idx];\n        }\n        return undefined;\n    }\n    referenceAt(resource, position) {\n        for (const ref of this.references) {\n            if (ref.uri.toString() === resource.toString()) {\n                if (Range.containsPosition(ref.range, position)) {\n                    return ref;\n                }\n            }\n        }\n        return undefined;\n    }\n    firstReference() {\n        for (const ref of this.references) {\n            if (ref.isProviderFirst) {\n                return ref;\n            }\n        }\n        return this.references[0];\n    }\n    static _compareReferences(a, b) {\n        return extUri.compare(a.uri, b.uri) || Range.compareRangesUsingStarts(a.range, b.range);\n    }\n}\n"],"names":["FoldingModel","textModel","decorationProvider","_classCallCheck","this","_updateEventEmitter","Emitter","onDidChange","event","_textModel","_decorationProvider","_regions","FoldingRegions","Uint32Array","_editorDecorationIds","_createClass","key","get","value","toggledRegions","_this","length","sort","r1","r2","regionIndex","processed","changeDecorations","accessor","_step","k","dirtyRegionEndLine","lastHiddenLine","updateDecorationsUntil","index","endLineNumber","getEndLineNumber","isCollapsed","isManual","regions","getSource","changeDecorationOptions","getDecorationOption","_iterator","_createForOfIteratorHelper","s","n","done","editorDecorationId","newCollapseState","setCollapsed","Math","max","err","e","f","fire","model","collapseStateChanged","ranges","newFoldingRanges","Array","intersects","foldRange","_step2","_iterator2","range","startLineNumber","i","toFoldRange","source","push","updatePost","fromFoldRanges","newRegions","blockedLineNumers","arguments","undefined","foldedOrManualRanges","_currentFoldedOrManualRanges","newRanges","sanitizeAndMerge","getLineCount","_this2","newEditorDecorations","limit","getStartLineNumber","decorationRange","startColumn","getLineMaxColumn","endColumn","options","deltaDecorations","isBlocked","_step3","_iterator3","blockedLineNumber","foldedRanges","decRange","getDecorationRange","type","result","maxLineNumber","checksum","_getLinesChecksum","state","_a","_b","isArray","_step4","rangesToRestore","_iterator4","lineNumber1","lineNumber2","hash","getLineContent","removeDecorations","lineNumber","filter","findRange","level","current","toRegion","parentIndex","region","Number","MAX_VALUE","levelStack","len","containedBy","pop","setCollapseStateLevelsDown","foldingModel","doCollapse","levels","lineNumbers","toToggle","_step6","_iterator6","getRegionAtLine","regionsInside","getRegionsInside","r","apply","_toConsumableArray","toggleCollapseState","setCollapseStateLevelsUp","_step7","_iterator7","getAllRegionsAtLine","setCollapseStateForRest","blockedLineNumbers","_step9","filteredRegions","_iterator9","every","filteredRegion","setCollapseStateForMatchingLines","regExp","editorModel","test","setCollapseStateForType","getType","HiddenRangeModel","_hasLineChanges","_foldingModel","_foldingModelListener","_","updateHiddenRanges","_hiddenRanges","changes","some","change","countEOL","text","updateHiddenAreas","newHiddenAreas","lastCollapsedStart","lastCollapsedEnd","Range","applyHiddenRanges","line","selections","hasChanges","lastRange","adjustLine","isInside","selection","adjustedStartLine","setStartPosition","adjustedEndLine","setEndPosition","hiddenRanges","dispose","findFirstInSorted","foldBackground","registerColor","light","transparent","editorSelectionBackground","dark","hcDark","hcLight","localize","iconForeground","foldingExpandedIcon","registerIcon","Codicon","chevronDown","foldingCollapsedIcon","chevronRight","foldingManualCollapsedIcon","foldingManualExpandedIcon","foldedBackgroundMinimap","color","themeColorFromId","position","MinimapPosition","Inline","FoldingDecorationProvider","editor","showFoldingControls","showFoldingHighlights","isHidden","HIDDEN_RANGE_DECORATION","NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION","NO_CONTROLS_COLLAPSED_RANGE_DECORATION","NO_CONTROLS_EXPANDED_RANGE_DECORATION","MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION","MANUALLY_COLLAPSED_VISUAL_DECORATION","COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION","COLLAPSED_VISUAL_DECORATION","MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION","EXPANDED_AUTO_HIDE_VISUAL_DECORATION","MANUALLY_EXPANDED_VISUAL_DECORATION","EXPANDED_VISUAL_DECORATION","callback","decorationIds","ModelDecorationOptions","register","description","stickiness","afterContentClassName","isWholeLine","firstLineDecorationClassName","ThemeIcon","asClassName","className","minimap","__decorate","decorators","target","desc","d","c","Object","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","then","CONTEXT_FOLDING_ENABLED","RawContextKey","FoldingController","_Disposable","_inherits","_super","_createSuper","contextKeyService","languageConfigurationService","notificationService","languageFeatureDebounceService","languageFeaturesService","call","localToDispose","_register","DisposableStore","_foldingLimitReporter","RangesLimitReporter","getOptions","_isEnabled","_useFoldingProviders","_unfoldOnClickAfterEndOfLine","_restoringViewState","_currentModelHasFoldedImports","_foldingImportsByDefault","updateDebounceInfo","for","foldingRangeProvider","min","hiddenRangeModel","rangeProvider","foldingRegionPromise","foldingModelPromise","updateScheduler","cursorChangedScheduler","mouseDownInfo","foldingDecorationProvider","foldingEnabled","bindTo","set","onDidChangeModel","onModelChanged","onDidChangeConfiguration","hasChanged","triggerFoldingModelChanged","onFoldingStrategyChanged","getModel","isTooLargeForTokenization","collapsedRegions","getMemento","provider","id","lineCount","foldedImports","applyMemento","clear","add","hr","onHiddenRangesChanges","Delayer","RunOnceScheduler","revealCursor","onDidChangeModelLanguageConfiguration","onDidChangeModelContent","onDidChangeCursorPosition","onCursorPositionChanged","onMouseDown","onEditorMouseDown","onMouseUp","onEditorMouseUp","cancel","_this3","indentRangeProvider","IndentRangeProvider","selectedProviders","getFoldingRangeProviders","SyntaxRangeProvider","notifyChangeModelContent","_this4","trigger","sw","StopWatch","getRangeProvider","createCancelablePromise","token","compute","foldingRanges","scrollState","setCollapsedAllOfType","FoldingRangeKind","Imports","StableEditorScrollState","capture","getSelections","selectionLineNumbers","map","update","restore","newValue","elapsed","defaultDelay","onUnexpectedError","adjustSelections","setSelections","setHiddenAreas","hasRanges","schedule","_this5","getFoldingModel","_loop","selectionStartLineNumber","reveal","getPosition","leftButton","middleButton","iconClicked","data","detail","offsetLeftInGutter","element","offsetLeft","offsetX","isAfterLines","altKey","toMaybeToggle","otherRegion","recursive","shiftKey","column","revealPositionInCenterIfOutsideViewport","getContribution","ID","foldingRangeProviders","ordered","_foldingRangeSelector","Disposable","IContextKeyService","ILanguageConfigurationService","INotificationService","ILanguageFeatureDebounceService","ILanguageFeaturesService","_onDidChange","_computed","_limited","computed","limited","FoldingAction","_EditorAction","_super2","args","_this6","foldingController","reportTelemetry","invoke","getSelection","getStartPosition","selectionLines","l","getSelectedLines","_accessor","_editor","EditorAction","foldingArgumentsConstraint","types","foldingArgs","direction","UnfoldAction","_FoldingAction","_super3","label","nls","alias","precondition","kbOpts","kbExpr","EditorContextKeys","editorTextFocus","primary","mac","weight","name","constraint","schema","_foldingController","getLineNumbers","UnFoldRecursivelyAction","_FoldingAction2","_super4","KeyChord","_args","FoldAction","_FoldingAction3","_super5","_step8","_iterator8","setCollapseStateUp","ToggleFoldAction","_FoldingAction4","_super6","_step5","_iterator5","FoldRecursivelyAction","_FoldingAction5","_super7","selectedLines","FoldAllBlockCommentsAction","_FoldingAction6","_super8","hasTypes","Comment","comments","getLanguageConfiguration","getLanguageId","blockCommentStartToken","RegExp","escapeRegExpCharacters","FoldAllRegionsAction","_FoldingAction7","_super9","Region","foldingRules","markers","start","UnfoldAllRegionsAction","_FoldingAction8","_super10","FoldAllRegionsExceptAction","_FoldingAction9","_super11","UnfoldAllRegionsExceptAction","_FoldingAction10","_super12","FoldAllAction","_FoldingAction11","_super13","UnfoldAllAction","_FoldingAction12","_super14","FoldLevelAction","_FoldingAction13","_super15","parseInt","substr","ID_PREFIX","foldLevel","containsLine","setCollapseStateAtLevel","getFoldingLevel","GotoParentFoldAction","_FoldingAction14","_super16","foldingRegion","parentFoldingIdx","getParentFoldLine","setSelection","GotoPreviousFoldAction","_FoldingAction15","_super17","expectedParentIndex","minLineNumber","getPreviousFoldLine","GotoNextFoldAction","_FoldingAction16","_super18","getNextFoldLine","FoldRangeFromSelectionAction","_FoldingAction17","_super19","collapseRanges","a","b","RemoveFoldRangeFromSelectionAction","_FoldingAction18","_super20","removeManualRanges","registerEditorContribution","registerEditorAction","registerInstantiatedEditorAction","concat","CommandsRegistry","registerCommand","_len","_key","_regeneratorRuntime","mark","_callee","resource","configurationService","strategy","foldingLimitReporter","providers","_i","wrap","_context","prev","URI","illegalArgument","IModelService","IConfigurationService","getValue","abrupt","t0","CancellationToken","None","sent","end","kind","fromValue","finish","stop","foldSourceAbbr","_foldSourceAbbr","_defineProperty","MAX_LINE_NUMBER","MASK_INDENT","BitField","size","numWords","ceil","_states","arrayIndex","bit","newState","startIndexes","endIndexes","Error","_startIndexes","_endIndexes","_collapseStates","_userDefinedStates","_recoveredStates","_types","_parentsComputed","parentIndexes","isInsideLast","isUserDefined","isRecovered","setUserDefined","setRecovered","FoldingRegion","ensureParentIndices","parent","low","high","mid","floor","findIndex","getParentIndex","contains","res","join","rangesLength","gotTypes","setSource","rangesA","rangesB","topStackedRange","getIndexedFunction","getA","getB","indexA","indexB","nextA","nextB","stackedRanges","prevLineNumber","resultRanges","useRange","scanIndex","prescanB","foldingRangesLimit","cancelationToken","offSide","foldingRangesLimitDefault","tabSize","RangesCollector","pattern","previousRegions","indent","endAbove","lineContent","computeIndentLevel","previous","m","match","insertFirst","toIndentRanges","computeRanges","_indentOccurrences","_length","_foldingRangesLimit","entries","maxIndent","startIndex","foldingContext","handleFoldingRangesChange","fallbackRangeProvider","disposables","cancellationToken","rangeData","promises","provideFoldingRanges","isCancellationRequested","nLines","rank","onUnexpectedExternalError","all","collectSyntaxRanges","sorted","d1","d2","diff","collector","top","entry","sanitizeRanges","_nestingLevels","_nestingLevelCounts","nestingLevel","maxLevel","EditorFontZoomIn","EditorZoom","setZoomLevel","getZoomLevel","EditorFontZoomOut","_EditorAction2","EditorFontZoomReset","_EditorAction3","alertFormattingEdits","edits","edit","plusRange","_range","alert","getRealAndSyntheticDocumentFormattersOrdered","documentFormattingEditProvider","documentRangeFormattingEditProvider","seen","ExtensionIdentifierSet","docFormatter","formatter","extensionId","rangeFormatter","has","displayName","provideDocumentFormattingEdits","provideDocumentRangeFormattingEdits","getFullModelRange","FormattingConflicts","selector","_selectors","unshift","document","mode","Iterable","first","formatDocumentRangesWithSelectedProvider","editorOrModel","rangeOrRanges","progress","_callee2","instaService","_accessor$get","documentRangeFormattingEditProviderRegistry","selected","_context2","IInstantiationService","isCodeEditor","select","report","invokeFunction","formatDocumentRangesWithProvider","_callee4","workerService","logService","cts","_range4","computeEdits","hasIntersectingEdit","allEdits","rawEditsList","j","mergedRange","_rawEditsList","rawEdits","minimalEdits","_range2","initialSelection","_context4","IEditorWorkerService","ILogService","EditorStateCancellationTokenSource","TextModelCancellationTokenSource","asArray","compareRangesUsingStarts","areIntersectingOrTouching","fromPositions","getEndPosition","_callee3","_c","_d","_context3","trace","getFormattingOptions","mergedA","reduce","acc","val","x","intersectRanges","otherEdit","provideDocumentRangesFormattingEdits","t1","t2","t3","splice","computeMoreMinimalEdits","uri","FormattingEdit","execute","Selection","pushEditOperations","lift","forceMoveMarkers","undoEdits","formatDocumentWithSelectedProvider","_callee5","_context5","formatDocumentWithProvider","_callee6","_edits","_edits2","_context6","_slicedToArray","getDocumentRangeFormattingEditsUntilResult","_callee7","_context7","catch","isNonEmptyArray","getDocumentFormattingEditsUntilResult","_callee8","_iterator10","_step10","_context8","getOnTypeFormattingEdits","ch","onTypeFormattingEditProvider","autoFormatTriggerCharacters","indexOf","provideOnTypeFormattingEdits","LinkedList","_callee9","resolverService","reference","_context9","assertType","isUri","isIRange","ITextModelService","createModelReference","object","textEditorModel","_len2","_key2","_callee10","_context10","_len3","_key3","_callee11","_context11","Position","isIPosition","FormatOnType","_languageFeaturesService","_workerService","_disposables","_sessionDisposables","_update","onDidChangeModelLanguage","getOption","hasModel","_this$_languageFeatur","support","triggerChars","CharacterSet","charCodeAt","onDidType","lastCharCode","_trigger","String","fromCharCode","isEmpty","CancellationTokenSource","unbind","isFlush","finally","FormatOnPaste","_instantiationService","_callOnDispose","_callOnModel","onDidPaste","_ref","Progress","FormatDocumentAction","ContextKeyExpr","and","notInCompositeEditor","writable","hasDocumentFormattingProvider","linux","contextMenuOpts","group","order","progressService","IEditorProgressService","showWhile","FormatSelectionAction","hasDocumentSelectionFormattingProvider","when","hasNonEmptySelection","commandService","ICodeEditorService","getFocusedCodeEditor","ICommandService","executeCommand","newEol","singleEdits","eol","pushEOL","editRange","validateRange","equalsRange","addUndoStops","pushUndoStop","_handleEolEdits","_isFullModelReplaceEdit","executeEdits","EditOperation","replace","replaceMove","restoreRelativeVerticalPositionOfCursor","MarkerCoordinate","marker","total","MarkerList","resourceFilter","_markerService","_configService","_dispoables","_markers","_nextIdx","_resourceFilter","toString","compareOrder","compareMarker","compare","MarkerSeverity","severity","updateMarker","read","severities","Warning","Info","onMarkerChanged","uris","fwd","found","idx","binarySearch","word","getWordAtPosition","containsPosition","isBeforeOrEqual","oldIdx","_initIdx","IMarkerService","IMarkerNavigationService","createDecorator","MarkerNavigationService","_provider","getMarkerList","registerSingleton","MessageWidget","onRelatedInformation","_openerService","_labelService","_lines","_longestLineLength","_relatedDiagnostics","WeakMap","domNode","createElement","_messageBlock","classList","setAttribute","appendChild","_relatedBlock","dom","addStandardDisposableListener","preventDefault","related","_scrollable","ScrollableElement","horizontal","vertical","useShadows","horizontalScrollbarSize","verticalScrollbarSize","getDomNode","onScroll","style","left","scrollLeft","scrollTop","message","relatedInformation","code","sourceAndCodeLength","lines","splitLines","clearNode","getAriaLabel","applyFontInfo","lastLineElement","innerText","height","lineHeight","detailsElement","sourceElement","codeElement","_codeLink","$","onclick","open","allowCommands","stopPropagation","append","relatedInformationNode","paddingTop","container","relatedResource","getUriBasenameLabel","title","getUriLabel","relatedMessage","fontInfo","scrollWidth","typicalFullwidthCharacterWidth","scrollHeight","setScrollDimensions","width","severityLabel","Hint","ariaLabel","MarkerNavigationWidget","_PeekViewWidget","_themeService","_menuService","instantiationService","_contextKeyService","showArrow","showFrame","isAccessible","frameWidth","_onDidSelectRelatedInformation","onDidSelectRelatedInformation","_severity","_backgroundColor","Color","white","_applyTheme","getColorTheme","onDidColorThemeChange","bind","_assertThisInitialized","create","theme","getColor","editorMarkerNavigationBackground","colorId","editorMarkerNavigationError","headerBackground","editorMarkerNavigationErrorHeader","editorMarkerNavigationWarning","editorMarkerNavigationWarningHeader","editorMarkerNavigationInfo","editorMarkerNavigationInfoHeader","frameColor","headerBg","arrowColor","headerBackgroundColor","primaryHeadingColor","peekViewTitleForeground","secondaryHeadingColor","peekViewTitleInfoForeground","_parentContainer","backgroundColor","_get","_getPrototypeOf","prototype","_actionbarWidget","actionRunner","onWillRun","focus","actions","menu","createMenu","TitleMenu","createAndFillInActionBarActions","icon","_icon","tabIndex","_container","_message","markerIdx","markerCount","remove","editorPosition","computeRequiredHeight","setTitle","basename","SeverityIcon","toSeverity","revealPositionNearTop","_relayout","heightInPixel","widthInPixel","_heightInPixel","layout","getHeightInLines","PeekViewWidget","MenuId","IThemeService","IOpenerService","IMenuService","ILabelService","errorDefault","oneOf","editorErrorForeground","editorErrorBorder","warningDefault","editorWarningForeground","editorWarningBorder","infoDefault","editorInfoForeground","editorInfoBorder","contrastBorder","editorBackground","MarkerController","_markerNavigationService","_editorService","_sessionDispoables","_widgetVisible","CONTEXT_MARKERS_NAVIGATION_VISIBLE","_cleanUp","reset","_widget","_model","matches","reusePosition","move","createInstance","onDidClose","close","resetIndex","info","find","showStale","openCodeEditor","pinned","revealIfOpened","collapseToStart","focusEditor","_getOrCreateModel","showAtMarker","multiFile","otherEditor","selectionRevealType","nagivate","MarkerNavigationAction","_next","_multiFile","opts","NextMarkerAction","_MarkerNavigationActi","LABEL","menuOpts","menuId","arrowDown","PrevMarkerAction","_MarkerNavigationActi2","arrowUp","NextMarkerInFilesAction","_MarkerNavigationActi3","MenubarGoMenu","comment","PrevMarkerInFilesAction","_MarkerNavigationActi4","MarkerCommand","EditorCommand","bindToContribution","registerEditorCommand","handler","secondary","ctxHasSymbols","ISymbolNavigationService","SymbolNavigationService","_notificationService","_keybindingService","_currentModel","_currentIdx","_ignoreEditorChange","_ctxHasSymbols","_currentState","_currentMessage","anchor","refModel","references","_showMessage","editorState","EditorState","listener","getActiveCodeEditor","seenUri","seenPosition","isEqual","combinedDisposable","kb","lookupKeybinding","getLabel","status","IKeybindingService","_EditorCommand","_class","revealNext","KeybindingsRegistry","registerCommandAndKeybindingRule","editorService","_listener","Map","onCodeEditorRemove","_onDidRemoveEditor","onCodeEditorAdd","_onDidAddEditor","listCodeEditors","forEach","values","delete","_e","_f","_g","_h","MenuRegistry","appendMenuItem","EditorContext","submenu","EditorContextPeek","SymbolNavigationAnchor","thing","corePosition","SymbolNavigationAction","configuration","_patchConfig","_allSymbolNavigationCommands","arg","symbolNavService","is","promise","raceCancellation","_getLocationModel","altAction","altActionId","referenceCount","ariaMessage","referenceAt","_getAlternativeCommand","_activeAlternativeCommands","muteMessage","MessageController","showMessage","_getNoResultFoundMessage","runEditorCommand","_onResult","error","gotoLocation","peek","targetEditor","_getGoToPreference","EmbeddedCodeEditorWidget","openInPeek","_openInPeek","firstReference","_openReference","openToSide","put","sideBySide","highlight","modelNow","decorations","isLocationLink","targetSelectionRange","selectionSource","createDecorationsCollection","setTimeout","controller","ReferencesController","toggleWidget","assign","f1","item","EditorAction2","Set","DefinitionAction","_SymbolNavigationActi","ReferencesModel","getDefinitionsAtPosition","definitionProvider","alternativeDefinitionCommand","multipleDefinitions","goToDefinitionKb","isWeb","isStandalone","registerAction2","_DefinitionAction","GoToDefinitionAction","original","mnemonicTitle","hasDefinitionProvider","isInWalkThroughSnippet","toNegated","keybinding","registerCommandAlias","_DefinitionAction2","OpenDefinitionToSideAction","_DefinitionAction3","PeekDefinitionAction","PeekContext","notInPeekEditor","DeclarationAction","_SymbolNavigationActi2","getDeclarationsAtPosition","declarationProvider","alternativeDeclarationCommand","multipleDeclarations","_DeclarationAction","GoToDeclarationAction","hasDeclarationProvider","_DeclarationAction2","PeekDeclarationAction","TypeDefinitionAction","_SymbolNavigationActi3","getTypeDefinitionsAtPosition","typeDefinitionProvider","alternativeTypeDefinitionCommand","multipleTypeDefinitions","_TypeDefinitionAction","GoToTypeDefinitionAction","hasTypeDefinitionProvider","_TypeDefinitionAction2","PeekTypeDefinitionAction","ImplementationAction","_SymbolNavigationActi4","getImplementationsAtPosition","implementationProvider","alternativeImplementationCommand","multipleImplementations","_ImplementationAction","GoToImplementationAction","hasImplementationProvider","_ImplementationAction2","PeekImplementationAction","ReferencesAction","_SymbolNavigationActi5","alternativeReferenceCommand","multipleReferences","_ReferencesAction","GoToReferencesAction","hasReferenceProvider","getReferencesAtPosition","referenceProvider","_ReferencesAction2","PeekReferencesAction","GenericGoToLocationAction","_SymbolNavigationActi6","config","_references","_gotoMultipleBehaviour","_this7","_position","_token","multiple","noResultsMessage","setPosition","invokeWithinContext","command","_GenericGoToLocationA","Boolean","run","_callee12","_context12","codeEditorService","control","getLocationLinks","registry","provide","coalesce","flat","provideDefinition","provideDeclaration","provideImplementation","provideTypeDefinition","compact","resultWithoutDeclaration","provideReferences","includeDeclaration","_sortedAndDeduped","rawLinks","modelLinks","ref","link","registerModelAndPositionCommand","hasModifier","modifier","ClickLinkMouseEvent","isLeftClick","isMiddleClick","isRightClick","rightButton","hasTriggerModifier","triggerModifier","hasSideBySideModifier","triggerSideBySideModifier","isNoneOrSingleMouseDown","ClickLinkKeyboardEvent","keyCodeIsTriggerKey","keyCode","triggerKey","keyCodeIsSideBySideKey","triggerSideBySideKey","ClickLinkOptions","other","createOptions","multiCursorModifier","platform","ClickLinkGesture","alwaysFireOnMouseUp","_onMouseMoveOrRelevantKeyDown","onMouseMoveOrRelevantKeyDown","_onExecute","onExecute","_onCancel","onCancel","_alwaysFireExecuteOnMouseUp","_opts","_lastMouseMoveEvent","_hasTriggerKeyOnMouseDown","_lineNumberOnMouseDown","newOpts","equals","onMouseMove","_onEditorMouseMove","_onEditorMouseDown","_onEditorMouseUp","onKeyDown","_onEditorKeyDown","onKeyUp","_onEditorKeyUp","onMouseDrag","_resetHandler","onDidChangeCursorSelection","_onDidChangeCursorSelection","onDidScrollChange","scrollTopChanged","scrollLeftChanged","mouseEvent","currentLineNumber","GotoDefinitionAtPositionEditorContribution","textModelResolverService","languageService","toUnhook","toUnhookForKeyboard","currentWordAtPosition","previousPromise","linkDecorations","linkGesture","_ref2","keyboardEvent","startFindDefinitionFromMouse","withNullAsUndefined","isEnabled","gotoDefinition","removeLinkDecorations","startFindDefinition","withKey","results","linkRange","combinedRange","originSelectionRange","findDefinition","validate","addDecoration","MarkdownString","appendText","previewValue","getPreviewValue","languageId","guessLanguageIdByFilepathOrFirstLine","appendCodeblock","rangeToUse","MAX_SOURCE_PREVIEW_LINES","getPreviewRangeBasedOnIndentation","stripIndentationFromPreviewRange","previewRange","minIndent","getLineFirstNonWhitespaceColumn","endIndent","getValueInRange","trim","startIndent","hoverMessage","newDecorations","inlineClassName","injectedText","ModelDecorationInjectedTextOptions","canPeek","isInPeekEditor","inPeekEditor","ILanguageService","DataSource","_resolverService","FileReferences","groups","children","Delegate","FileReferencesRenderer","OneReferenceRenderer","StringRepresentationProvider","OneReference","parts","getPreview","preview","IdentityProvider","FileReferencesTemplate","file","IconLabel","supportHighlights","badge","CountBadge","defaultCountBadgeStyles","dirname","setLabel","relative","setCount","setTitleFormat","templateId","node","template","createMatches","filterData","templateData","OneReferenceTemplate","HighlightedLabel","score","FuzzyScore","isDefault","toggle","AccessibilityProvider","DecorationsManager","_decorations","_decorationIgnoreSet","_callOnModelChange","_onModelChanged","_addDecorations","onDidChangeDecorations","_onDecorationChanged","newDecorationsActualIndex","oneReference","DecorationOptions","changeAccessor","toRemove","_step2$value","decorationId","newRange","ignore","spansMultipleLines","keys","LayoutData","ratio","heightInLines","raw","JSON","parse","ReferencesTree","_WorkbenchAsyncDataTr","WorkbenchAsyncDataTree","ReferenceWidget","_peekView$PeekViewWid","_defaultTreeKeyboardSupport","layoutData","themeService","_textModelResolverService","_peekViewService","_uriLabel","_undoRedoService","_languageService","_languageConfigurationService","isResizeable","supportOnTitleClick","_disposeOnNewModel","_onDidSelectReference","onDidSelectReference","_dim","Dimension","addExclusiveWidget","setModel","_preview","_previewNotAvailableMessage","_tree","_previewModelReference","_splitView","borderColor","peekView","where","domFocus","hasTextFocus","_getFocusedReference","ctrlKey","metaKey","containerElement","setCssClass","_messageContainer","hide","SplitView","orientation","_previewContainer","scrollBeyondLastLine","scrollbar","verticalHasArrows","horizontalHasArrows","alwaysConsumeMouseWheel","overviewRulerLanes","fixedOverflowWidgets","enabled","TextModel","PLAINTEXT_LANGUAGE_ID","DEFAULT_CREATION_OPTIONS","_treeContainer","treeOptions","keyboardSupport","accessibilityProvider","keyboardNavigationLabelProvider","identityProvider","openOnSingleClick","selectionNavigation","overrideStyles","listBackground","dispatchEvent","addView","Event","minimumSize","maximumSize","Sizing","Distribute","onDidSashChange","getViewSize","onEvent","_revealReference","onDidOpen","editorOptions","_doLayoutBody","_viewZone","resizeView","setFocus","newModel","_onNewModel","show","_decorationsManager","onDidChangeReferenceRange","rerender","focusOnReferenceTree","setInput","_this$_tree$getFocus","getFocus","revealParent","scrollType","sel","_revealedReference","scheme","Schemas","inMemory","basenameOrAuthority","getInput","expand","revealRangeInCenter","IUndoRedoService","ctxReferenceSearchVisible","_storageService","_configurationService","_requestIdPool","_ignoreModelChangeEvent","_referenceSearchVisible","modelPromise","peekMode","widgetPosition","closeWidget","_peekMode","storageKey","fromJSON","store","stringify","openReference","_gotoReference","requestId","setMetaTitle","pos","nearestReference","focusOnPreviewEditor","isPreviewEditorFocused","currentPosition","editorFocus","previewEditorFocus","nextOrPreviousReference","revealReference","openedEditor","clone","withController","fn","outerEditor","getOuterEditor","IStorageService","or","changeFocusBetweenPreviewAndReferences","goToNextOrPreviousReference","registerKeybindingRule","not","WorkbenchListFocusContextKey","WorkbenchTreeElementCanCollapse","negate","WorkbenchTreeElementCanExpand","IListService","lastFocusedList","isProviderFirst","_rangeCallback","defaultGenerator","nextId","FilePreview","_modelReference","getWordUntilPosition","beforeRange","afterRange","before","inside","_previews","ResourceMap","child","fsPath","links","_onDidChangeReferenceRange","_links","_title","providersFirst","_compareReferences","extUri","oneRef","childCount","groupCount","nearest","prefixLen","strings","offsetDist","abs"],"sourceRoot":""}