{"version":3,"file":"static/js/monaco-editor-vendor.751b4862.e7ab7d37.js","mappings":"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","sources":["../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/config/domFontInfo.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/config/migrateOptions.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/config/editorConfiguration.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/config/elementSizeObserver.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/config/charWidthReader.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/config/fontMeasurements.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/config/tabFocus.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/controller/mouseTarget.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/controller/mouseHandler.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/controller/pointerHandler.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/controller/textAreaHandler.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/controller/textAreaInput.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/controller/textAreaState.js","../node_modules/@uiw/react-monacoeditor/node_modules/monaco-editor/esm/vs/editor/browser/coreCommands.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { FastDomNode } from '../../../base/browser/fastDomNode.js';\nexport function applyFontInfo(domNode, fontInfo) {\n    if (domNode instanceof FastDomNode) {\n        domNode.setFontFamily(fontInfo.getMassagedFontFamily());\n        domNode.setFontWeight(fontInfo.fontWeight);\n        domNode.setFontSize(fontInfo.fontSize);\n        domNode.setFontFeatureSettings(fontInfo.fontFeatureSettings);\n        domNode.setFontVariationSettings(fontInfo.fontVariationSettings);\n        domNode.setLineHeight(fontInfo.lineHeight);\n        domNode.setLetterSpacing(fontInfo.letterSpacing);\n    }\n    else {\n        domNode.style.fontFamily = fontInfo.getMassagedFontFamily();\n        domNode.style.fontWeight = fontInfo.fontWeight;\n        domNode.style.fontSize = fontInfo.fontSize + 'px';\n        domNode.style.fontFeatureSettings = fontInfo.fontFeatureSettings;\n        domNode.style.fontVariationSettings = fontInfo.fontVariationSettings;\n        domNode.style.lineHeight = fontInfo.lineHeight + 'px';\n        domNode.style.letterSpacing = fontInfo.letterSpacing + 'px';\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nexport class EditorSettingMigration {\n    constructor(key, migrate) {\n        this.key = key;\n        this.migrate = migrate;\n    }\n    apply(options) {\n        const value = EditorSettingMigration._read(options, this.key);\n        const read = (key) => EditorSettingMigration._read(options, key);\n        const write = (key, value) => EditorSettingMigration._write(options, key, value);\n        this.migrate(value, read, write);\n    }\n    static _read(source, key) {\n        if (typeof source === 'undefined') {\n            return undefined;\n        }\n        const firstDotIndex = key.indexOf('.');\n        if (firstDotIndex >= 0) {\n            const firstSegment = key.substring(0, firstDotIndex);\n            return this._read(source[firstSegment], key.substring(firstDotIndex + 1));\n        }\n        return source[key];\n    }\n    static _write(target, key, value) {\n        const firstDotIndex = key.indexOf('.');\n        if (firstDotIndex >= 0) {\n            const firstSegment = key.substring(0, firstDotIndex);\n            target[firstSegment] = target[firstSegment] || {};\n            this._write(target[firstSegment], key.substring(firstDotIndex + 1), value);\n            return;\n        }\n        target[key] = value;\n    }\n}\nEditorSettingMigration.items = [];\nfunction registerEditorSettingMigration(key, migrate) {\n    EditorSettingMigration.items.push(new EditorSettingMigration(key, migrate));\n}\nfunction registerSimpleEditorSettingMigration(key, values) {\n    registerEditorSettingMigration(key, (value, read, write) => {\n        if (typeof value !== 'undefined') {\n            for (const [oldValue, newValue] of values) {\n                if (value === oldValue) {\n                    write(key, newValue);\n                    return;\n                }\n            }\n        }\n    });\n}\n/**\n * Compatibility with old options\n */\nexport function migrateOptions(options) {\n    EditorSettingMigration.items.forEach(migration => migration.apply(options));\n}\nregisterSimpleEditorSettingMigration('wordWrap', [[true, 'on'], [false, 'off']]);\nregisterSimpleEditorSettingMigration('lineNumbers', [[true, 'on'], [false, 'off']]);\nregisterSimpleEditorSettingMigration('cursorBlinking', [['visible', 'solid']]);\nregisterSimpleEditorSettingMigration('renderWhitespace', [[true, 'boundary'], [false, 'none']]);\nregisterSimpleEditorSettingMigration('renderLineHighlight', [[true, 'line'], [false, 'none']]);\nregisterSimpleEditorSettingMigration('acceptSuggestionOnEnter', [[true, 'on'], [false, 'off']]);\nregisterSimpleEditorSettingMigration('tabCompletion', [[false, 'off'], [true, 'onlySnippets']]);\nregisterSimpleEditorSettingMigration('hover', [[true, { enabled: true }], [false, { enabled: false }]]);\nregisterSimpleEditorSettingMigration('parameterHints', [[true, { enabled: true }], [false, { enabled: false }]]);\nregisterSimpleEditorSettingMigration('autoIndent', [[false, 'advanced'], [true, 'full']]);\nregisterSimpleEditorSettingMigration('matchBrackets', [[true, 'always'], [false, 'never']]);\nregisterSimpleEditorSettingMigration('renderFinalNewline', [[true, 'on'], [false, 'off']]);\nregisterSimpleEditorSettingMigration('cursorSmoothCaretAnimation', [[true, 'on'], [false, 'off']]);\nregisterEditorSettingMigration('autoClosingBrackets', (value, read, write) => {\n    if (value === false) {\n        write('autoClosingBrackets', 'never');\n        if (typeof read('autoClosingQuotes') === 'undefined') {\n            write('autoClosingQuotes', 'never');\n        }\n        if (typeof read('autoSurround') === 'undefined') {\n            write('autoSurround', 'never');\n        }\n    }\n});\nregisterEditorSettingMigration('renderIndentGuides', (value, read, write) => {\n    if (typeof value !== 'undefined') {\n        write('renderIndentGuides', undefined);\n        if (typeof read('guides.indentation') === 'undefined') {\n            write('guides.indentation', !!value);\n        }\n    }\n});\nregisterEditorSettingMigration('highlightActiveIndentGuide', (value, read, write) => {\n    if (typeof value !== 'undefined') {\n        write('highlightActiveIndentGuide', undefined);\n        if (typeof read('guides.highlightActiveIndentation') === 'undefined') {\n            write('guides.highlightActiveIndentation', !!value);\n        }\n    }\n});\nconst suggestFilteredTypesMapping = {\n    method: 'showMethods',\n    function: 'showFunctions',\n    constructor: 'showConstructors',\n    deprecated: 'showDeprecated',\n    field: 'showFields',\n    variable: 'showVariables',\n    class: 'showClasses',\n    struct: 'showStructs',\n    interface: 'showInterfaces',\n    module: 'showModules',\n    property: 'showProperties',\n    event: 'showEvents',\n    operator: 'showOperators',\n    unit: 'showUnits',\n    value: 'showValues',\n    constant: 'showConstants',\n    enum: 'showEnums',\n    enumMember: 'showEnumMembers',\n    keyword: 'showKeywords',\n    text: 'showWords',\n    color: 'showColors',\n    file: 'showFiles',\n    reference: 'showReferences',\n    folder: 'showFolders',\n    typeParameter: 'showTypeParameters',\n    snippet: 'showSnippets',\n};\nregisterEditorSettingMigration('suggest.filteredTypes', (value, read, write) => {\n    if (value && typeof value === 'object') {\n        for (const entry of Object.entries(suggestFilteredTypesMapping)) {\n            const v = value[entry[0]];\n            if (v === false) {\n                if (typeof read(`suggest.${entry[1]}`) === 'undefined') {\n                    write(`suggest.${entry[1]}`, false);\n                }\n            }\n        }\n        write('suggest.filteredTypes', undefined);\n    }\n});\nregisterEditorSettingMigration('quickSuggestions', (input, read, write) => {\n    if (typeof input === 'boolean') {\n        const value = input ? 'on' : 'off';\n        const newValue = { comments: value, strings: value, other: value };\n        write('quickSuggestions', newValue);\n    }\n});\n// Sticky Scroll\nregisterEditorSettingMigration('experimental.stickyScroll.enabled', (value, read, write) => {\n    if (typeof value === 'boolean') {\n        write('experimental.stickyScroll.enabled', undefined);\n        if (typeof read('stickyScroll.enabled') === 'undefined') {\n            write('stickyScroll.enabled', value);\n        }\n    }\n});\nregisterEditorSettingMigration('experimental.stickyScroll.maxLineCount', (value, read, write) => {\n    if (typeof value === 'number') {\n        write('experimental.stickyScroll.maxLineCount', undefined);\n        if (typeof read('stickyScroll.maxLineCount') === 'undefined') {\n            write('stickyScroll.maxLineCount', value);\n        }\n    }\n});\n// Code Actions on Save\n// registerEditorSettingMigration('codeActionsOnSave', (value, read, write) => {\n// \tif (value && typeof value === 'object') {\n// \t\tlet toBeModified = false;\n// \t\tconst newValue = {} as any;\n// \t\tfor (const entry of Object.entries(value)) {\n// \t\t\tif (typeof entry[1] === 'boolean') {\n// \t\t\t\ttoBeModified = true;\n// \t\t\t\tnewValue[entry[0]] = entry[1] ? 'explicit' : 'never';\n// \t\t\t} else {\n// \t\t\t\tnewValue[entry[0]] = entry[1];\n// \t\t\t}\n// \t\t}\n// \t\tif (toBeModified) {\n// \t\t\twrite(`codeActionsOnSave`, newValue);\n// \t\t}\n// \t}\n// });\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as browser from '../../../base/browser/browser.js';\nimport * as arrays from '../../../base/common/arrays.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport * as objects from '../../../base/common/objects.js';\nimport * as platform from '../../../base/common/platform.js';\nimport { ElementSizeObserver } from './elementSizeObserver.js';\nimport { FontMeasurements } from './fontMeasurements.js';\nimport { migrateOptions } from './migrateOptions.js';\nimport { TabFocus } from './tabFocus.js';\nimport { ComputeOptionsMemory, ConfigurationChangedEvent, editorOptionsRegistry } from '../../common/config/editorOptions.js';\nimport { EditorZoom } from '../../common/config/editorZoom.js';\nimport { BareFontInfo } from '../../common/config/fontInfo.js';\nimport { IAccessibilityService } from '../../../platform/accessibility/common/accessibility.js';\nlet EditorConfiguration = class EditorConfiguration extends Disposable {\n    constructor(isSimpleWidget, options, container, _accessibilityService) {\n        super();\n        this._accessibilityService = _accessibilityService;\n        this._onDidChange = this._register(new Emitter());\n        this.onDidChange = this._onDidChange.event;\n        this._onDidChangeFast = this._register(new Emitter());\n        this.onDidChangeFast = this._onDidChangeFast.event;\n        this._isDominatedByLongLines = false;\n        this._viewLineCount = 1;\n        this._lineNumbersDigitCount = 1;\n        this._reservedHeight = 0;\n        this._glyphMarginDecorationLaneCount = 1;\n        this._computeOptionsMemory = new ComputeOptionsMemory();\n        this.isSimpleWidget = isSimpleWidget;\n        this._containerObserver = this._register(new ElementSizeObserver(container, options.dimension));\n        this._rawOptions = deepCloneAndMigrateOptions(options);\n        this._validatedOptions = EditorOptionsUtil.validateOptions(this._rawOptions);\n        this.options = this._computeOptions();\n        if (this.options.get(13 /* EditorOption.automaticLayout */)) {\n            this._containerObserver.startObserving();\n        }\n        this._register(EditorZoom.onDidChangeZoomLevel(() => this._recomputeOptions()));\n        this._register(TabFocus.onDidChangeTabFocus(() => this._recomputeOptions()));\n        this._register(this._containerObserver.onDidChange(() => this._recomputeOptions()));\n        this._register(FontMeasurements.onDidChange(() => this._recomputeOptions()));\n        this._register(browser.PixelRatio.onDidChange(() => this._recomputeOptions()));\n        this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(() => this._recomputeOptions()));\n    }\n    _recomputeOptions() {\n        const newOptions = this._computeOptions();\n        const changeEvent = EditorOptionsUtil.checkEquals(this.options, newOptions);\n        if (changeEvent === null) {\n            // nothing changed!\n            return;\n        }\n        this.options = newOptions;\n        this._onDidChangeFast.fire(changeEvent);\n        this._onDidChange.fire(changeEvent);\n    }\n    _computeOptions() {\n        const partialEnv = this._readEnvConfiguration();\n        const bareFontInfo = BareFontInfo.createFromValidatedSettings(this._validatedOptions, partialEnv.pixelRatio, this.isSimpleWidget);\n        const fontInfo = this._readFontInfo(bareFontInfo);\n        const env = {\n            memory: this._computeOptionsMemory,\n            outerWidth: partialEnv.outerWidth,\n            outerHeight: partialEnv.outerHeight - this._reservedHeight,\n            fontInfo: fontInfo,\n            extraEditorClassName: partialEnv.extraEditorClassName,\n            isDominatedByLongLines: this._isDominatedByLongLines,\n            viewLineCount: this._viewLineCount,\n            lineNumbersDigitCount: this._lineNumbersDigitCount,\n            emptySelectionClipboard: partialEnv.emptySelectionClipboard,\n            pixelRatio: partialEnv.pixelRatio,\n            tabFocusMode: TabFocus.getTabFocusMode(),\n            accessibilitySupport: partialEnv.accessibilitySupport,\n            glyphMarginDecorationLaneCount: this._glyphMarginDecorationLaneCount\n        };\n        return EditorOptionsUtil.computeOptions(this._validatedOptions, env);\n    }\n    _readEnvConfiguration() {\n        return {\n            extraEditorClassName: getExtraEditorClassName(),\n            outerWidth: this._containerObserver.getWidth(),\n            outerHeight: this._containerObserver.getHeight(),\n            emptySelectionClipboard: browser.isWebKit || browser.isFirefox,\n            pixelRatio: browser.PixelRatio.value,\n            accessibilitySupport: (this._accessibilityService.isScreenReaderOptimized()\n                ? 2 /* AccessibilitySupport.Enabled */\n                : this._accessibilityService.getAccessibilitySupport())\n        };\n    }\n    _readFontInfo(bareFontInfo) {\n        return FontMeasurements.readFontInfo(bareFontInfo);\n    }\n    getRawOptions() {\n        return this._rawOptions;\n    }\n    updateOptions(_newOptions) {\n        const newOptions = deepCloneAndMigrateOptions(_newOptions);\n        const didChange = EditorOptionsUtil.applyUpdate(this._rawOptions, newOptions);\n        if (!didChange) {\n            return;\n        }\n        this._validatedOptions = EditorOptionsUtil.validateOptions(this._rawOptions);\n        this._recomputeOptions();\n    }\n    observeContainer(dimension) {\n        this._containerObserver.observe(dimension);\n    }\n    setIsDominatedByLongLines(isDominatedByLongLines) {\n        if (this._isDominatedByLongLines === isDominatedByLongLines) {\n            return;\n        }\n        this._isDominatedByLongLines = isDominatedByLongLines;\n        this._recomputeOptions();\n    }\n    setModelLineCount(modelLineCount) {\n        const lineNumbersDigitCount = digitCount(modelLineCount);\n        if (this._lineNumbersDigitCount === lineNumbersDigitCount) {\n            return;\n        }\n        this._lineNumbersDigitCount = lineNumbersDigitCount;\n        this._recomputeOptions();\n    }\n    setViewLineCount(viewLineCount) {\n        if (this._viewLineCount === viewLineCount) {\n            return;\n        }\n        this._viewLineCount = viewLineCount;\n        this._recomputeOptions();\n    }\n    setReservedHeight(reservedHeight) {\n        if (this._reservedHeight === reservedHeight) {\n            return;\n        }\n        this._reservedHeight = reservedHeight;\n        this._recomputeOptions();\n    }\n    setGlyphMarginDecorationLaneCount(decorationLaneCount) {\n        if (this._glyphMarginDecorationLaneCount === decorationLaneCount) {\n            return;\n        }\n        this._glyphMarginDecorationLaneCount = decorationLaneCount;\n        this._recomputeOptions();\n    }\n};\nEditorConfiguration = __decorate([\n    __param(3, IAccessibilityService)\n], EditorConfiguration);\nexport { EditorConfiguration };\nfunction digitCount(n) {\n    let r = 0;\n    while (n) {\n        n = Math.floor(n / 10);\n        r++;\n    }\n    return r ? r : 1;\n}\nfunction getExtraEditorClassName() {\n    let extra = '';\n    if (!browser.isSafari && !browser.isWebkitWebView) {\n        // Use user-select: none in all browsers except Safari and native macOS WebView\n        extra += 'no-user-select ';\n    }\n    if (browser.isSafari) {\n        // See https://github.com/microsoft/vscode/issues/108822\n        extra += 'no-minimap-shadow ';\n        extra += 'enable-user-select ';\n    }\n    if (platform.isMacintosh) {\n        extra += 'mac ';\n    }\n    return extra;\n}\nclass ValidatedEditorOptions {\n    constructor() {\n        this._values = [];\n    }\n    _read(option) {\n        return this._values[option];\n    }\n    get(id) {\n        return this._values[id];\n    }\n    _write(option, value) {\n        this._values[option] = value;\n    }\n}\nexport class ComputedEditorOptions {\n    constructor() {\n        this._values = [];\n    }\n    _read(id) {\n        if (id >= this._values.length) {\n            throw new Error('Cannot read uninitialized value');\n        }\n        return this._values[id];\n    }\n    get(id) {\n        return this._read(id);\n    }\n    _write(id, value) {\n        this._values[id] = value;\n    }\n}\nclass EditorOptionsUtil {\n    static validateOptions(options) {\n        const result = new ValidatedEditorOptions();\n        for (const editorOption of editorOptionsRegistry) {\n            const value = (editorOption.name === '_never_' ? undefined : options[editorOption.name]);\n            result._write(editorOption.id, editorOption.validate(value));\n        }\n        return result;\n    }\n    static computeOptions(options, env) {\n        const result = new ComputedEditorOptions();\n        for (const editorOption of editorOptionsRegistry) {\n            result._write(editorOption.id, editorOption.compute(env, result, options._read(editorOption.id)));\n        }\n        return result;\n    }\n    static _deepEquals(a, b) {\n        if (typeof a !== 'object' || typeof b !== 'object' || !a || !b) {\n            return a === b;\n        }\n        if (Array.isArray(a) || Array.isArray(b)) {\n            return (Array.isArray(a) && Array.isArray(b) ? arrays.equals(a, b) : false);\n        }\n        if (Object.keys(a).length !== Object.keys(b).length) {\n            return false;\n        }\n        for (const key in a) {\n            if (!EditorOptionsUtil._deepEquals(a[key], b[key])) {\n                return false;\n            }\n        }\n        return true;\n    }\n    static checkEquals(a, b) {\n        const result = [];\n        let somethingChanged = false;\n        for (const editorOption of editorOptionsRegistry) {\n            const changed = !EditorOptionsUtil._deepEquals(a._read(editorOption.id), b._read(editorOption.id));\n            result[editorOption.id] = changed;\n            if (changed) {\n                somethingChanged = true;\n            }\n        }\n        return (somethingChanged ? new ConfigurationChangedEvent(result) : null);\n    }\n    /**\n     * Returns true if something changed.\n     * Modifies `options`.\n    */\n    static applyUpdate(options, update) {\n        let changed = false;\n        for (const editorOption of editorOptionsRegistry) {\n            if (update.hasOwnProperty(editorOption.name)) {\n                const result = editorOption.applyUpdate(options[editorOption.name], update[editorOption.name]);\n                options[editorOption.name] = result.newValue;\n                changed = changed || result.didChange;\n            }\n        }\n        return changed;\n    }\n}\nfunction deepCloneAndMigrateOptions(_options) {\n    const options = objects.deepClone(_options);\n    migrateOptions(options);\n    return options;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { Emitter } from '../../../base/common/event.js';\nexport class ElementSizeObserver extends Disposable {\n    constructor(referenceDomElement, dimension) {\n        super();\n        this._onDidChange = this._register(new Emitter());\n        this.onDidChange = this._onDidChange.event;\n        this._referenceDomElement = referenceDomElement;\n        this._width = -1;\n        this._height = -1;\n        this._resizeObserver = null;\n        this.measureReferenceDomElement(false, dimension);\n    }\n    dispose() {\n        this.stopObserving();\n        super.dispose();\n    }\n    getWidth() {\n        return this._width;\n    }\n    getHeight() {\n        return this._height;\n    }\n    startObserving() {\n        if (!this._resizeObserver && this._referenceDomElement) {\n            // We want to react to the resize observer only once per animation frame\n            // The first time the resize observer fires, we will react to it immediately.\n            // Otherwise we will postpone to the next animation frame.\n            // We'll use `observeContentRect` to store the content rect we received.\n            let observeContentRect = null;\n            const observeNow = () => {\n                if (observeContentRect) {\n                    this.observe({ width: observeContentRect.width, height: observeContentRect.height });\n                }\n                else {\n                    this.observe();\n                }\n            };\n            let shouldObserve = false;\n            let alreadyObservedThisAnimationFrame = false;\n            const update = () => {\n                if (shouldObserve && !alreadyObservedThisAnimationFrame) {\n                    try {\n                        shouldObserve = false;\n                        alreadyObservedThisAnimationFrame = true;\n                        observeNow();\n                    }\n                    finally {\n                        requestAnimationFrame(() => {\n                            alreadyObservedThisAnimationFrame = false;\n                            update();\n                        });\n                    }\n                }\n            };\n            this._resizeObserver = new ResizeObserver((entries) => {\n                observeContentRect = (entries && entries[0] && entries[0].contentRect ? entries[0].contentRect : null);\n                shouldObserve = true;\n                update();\n            });\n            this._resizeObserver.observe(this._referenceDomElement);\n        }\n    }\n    stopObserving() {\n        if (this._resizeObserver) {\n            this._resizeObserver.disconnect();\n            this._resizeObserver = null;\n        }\n    }\n    observe(dimension) {\n        this.measureReferenceDomElement(true, dimension);\n    }\n    measureReferenceDomElement(emitEvent, dimension) {\n        let observedWidth = 0;\n        let observedHeight = 0;\n        if (dimension) {\n            observedWidth = dimension.width;\n            observedHeight = dimension.height;\n        }\n        else if (this._referenceDomElement) {\n            observedWidth = this._referenceDomElement.clientWidth;\n            observedHeight = this._referenceDomElement.clientHeight;\n        }\n        observedWidth = Math.max(5, observedWidth);\n        observedHeight = Math.max(5, observedHeight);\n        if (this._width !== observedWidth || this._height !== observedHeight) {\n            this._width = observedWidth;\n            this._height = observedHeight;\n            if (emitEvent) {\n                this._onDidChange.fire();\n            }\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { applyFontInfo } from './domFontInfo.js';\nexport class CharWidthRequest {\n    constructor(chr, type) {\n        this.chr = chr;\n        this.type = type;\n        this.width = 0;\n    }\n    fulfill(width) {\n        this.width = width;\n    }\n}\nclass DomCharWidthReader {\n    constructor(bareFontInfo, requests) {\n        this._bareFontInfo = bareFontInfo;\n        this._requests = requests;\n        this._container = null;\n        this._testElements = null;\n    }\n    read() {\n        // Create a test container with all these test elements\n        this._createDomElements();\n        // Add the container to the DOM\n        document.body.appendChild(this._container);\n        // Read character widths\n        this._readFromDomElements();\n        // Remove the container from the DOM\n        document.body.removeChild(this._container);\n        this._container = null;\n        this._testElements = null;\n    }\n    _createDomElements() {\n        const container = document.createElement('div');\n        container.style.position = 'absolute';\n        container.style.top = '-50000px';\n        container.style.width = '50000px';\n        const regularDomNode = document.createElement('div');\n        applyFontInfo(regularDomNode, this._bareFontInfo);\n        container.appendChild(regularDomNode);\n        const boldDomNode = document.createElement('div');\n        applyFontInfo(boldDomNode, this._bareFontInfo);\n        boldDomNode.style.fontWeight = 'bold';\n        container.appendChild(boldDomNode);\n        const italicDomNode = document.createElement('div');\n        applyFontInfo(italicDomNode, this._bareFontInfo);\n        italicDomNode.style.fontStyle = 'italic';\n        container.appendChild(italicDomNode);\n        const testElements = [];\n        for (const request of this._requests) {\n            let parent;\n            if (request.type === 0 /* CharWidthRequestType.Regular */) {\n                parent = regularDomNode;\n            }\n            if (request.type === 2 /* CharWidthRequestType.Bold */) {\n                parent = boldDomNode;\n            }\n            if (request.type === 1 /* CharWidthRequestType.Italic */) {\n                parent = italicDomNode;\n            }\n            parent.appendChild(document.createElement('br'));\n            const testElement = document.createElement('span');\n            DomCharWidthReader._render(testElement, request);\n            parent.appendChild(testElement);\n            testElements.push(testElement);\n        }\n        this._container = container;\n        this._testElements = testElements;\n    }\n    static _render(testElement, request) {\n        if (request.chr === ' ') {\n            let htmlString = '\\u00a0';\n            // Repeat character 256 (2^8) times\n            for (let i = 0; i < 8; i++) {\n                htmlString += htmlString;\n            }\n            testElement.innerText = htmlString;\n        }\n        else {\n            let testString = request.chr;\n            // Repeat character 256 (2^8) times\n            for (let i = 0; i < 8; i++) {\n                testString += testString;\n            }\n            testElement.textContent = testString;\n        }\n    }\n    _readFromDomElements() {\n        for (let i = 0, len = this._requests.length; i < len; i++) {\n            const request = this._requests[i];\n            const testElement = this._testElements[i];\n            request.fulfill(testElement.offsetWidth / 256);\n        }\n    }\n}\nexport function readCharWidths(bareFontInfo, requests) {\n    const reader = new DomCharWidthReader(bareFontInfo, requests);\n    reader.read();\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as browser from '../../../base/browser/browser.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { CharWidthRequest, readCharWidths } from './charWidthReader.js';\nimport { EditorFontLigatures } from '../../common/config/editorOptions.js';\nimport { FontInfo } from '../../common/config/fontInfo.js';\nexport class FontMeasurementsImpl extends Disposable {\n    constructor() {\n        super();\n        this._onDidChange = this._register(new Emitter());\n        this.onDidChange = this._onDidChange.event;\n        this._cache = new FontMeasurementsCache();\n        this._evictUntrustedReadingsTimeout = -1;\n    }\n    dispose() {\n        if (this._evictUntrustedReadingsTimeout !== -1) {\n            window.clearTimeout(this._evictUntrustedReadingsTimeout);\n            this._evictUntrustedReadingsTimeout = -1;\n        }\n        super.dispose();\n    }\n    /**\n     * Clear all cached font information and trigger a change event.\n     */\n    clearAllFontInfos() {\n        this._cache = new FontMeasurementsCache();\n        this._onDidChange.fire();\n    }\n    _writeToCache(item, value) {\n        this._cache.put(item, value);\n        if (!value.isTrusted && this._evictUntrustedReadingsTimeout === -1) {\n            // Try reading again after some time\n            this._evictUntrustedReadingsTimeout = window.setTimeout(() => {\n                this._evictUntrustedReadingsTimeout = -1;\n                this._evictUntrustedReadings();\n            }, 5000);\n        }\n    }\n    _evictUntrustedReadings() {\n        const values = this._cache.getValues();\n        let somethingRemoved = false;\n        for (const item of values) {\n            if (!item.isTrusted) {\n                somethingRemoved = true;\n                this._cache.remove(item);\n            }\n        }\n        if (somethingRemoved) {\n            this._onDidChange.fire();\n        }\n    }\n    /**\n     * Read font information.\n     */\n    readFontInfo(bareFontInfo) {\n        if (!this._cache.has(bareFontInfo)) {\n            let readConfig = this._actualReadFontInfo(bareFontInfo);\n            if (readConfig.typicalHalfwidthCharacterWidth <= 2 || readConfig.typicalFullwidthCharacterWidth <= 2 || readConfig.spaceWidth <= 2 || readConfig.maxDigitWidth <= 2) {\n                // Hey, it's Bug 14341 ... we couldn't read\n                readConfig = new FontInfo({\n                    pixelRatio: browser.PixelRatio.value,\n                    fontFamily: readConfig.fontFamily,\n                    fontWeight: readConfig.fontWeight,\n                    fontSize: readConfig.fontSize,\n                    fontFeatureSettings: readConfig.fontFeatureSettings,\n                    fontVariationSettings: readConfig.fontVariationSettings,\n                    lineHeight: readConfig.lineHeight,\n                    letterSpacing: readConfig.letterSpacing,\n                    isMonospace: readConfig.isMonospace,\n                    typicalHalfwidthCharacterWidth: Math.max(readConfig.typicalHalfwidthCharacterWidth, 5),\n                    typicalFullwidthCharacterWidth: Math.max(readConfig.typicalFullwidthCharacterWidth, 5),\n                    canUseHalfwidthRightwardsArrow: readConfig.canUseHalfwidthRightwardsArrow,\n                    spaceWidth: Math.max(readConfig.spaceWidth, 5),\n                    middotWidth: Math.max(readConfig.middotWidth, 5),\n                    wsmiddotWidth: Math.max(readConfig.wsmiddotWidth, 5),\n                    maxDigitWidth: Math.max(readConfig.maxDigitWidth, 5),\n                }, false);\n            }\n            this._writeToCache(bareFontInfo, readConfig);\n        }\n        return this._cache.get(bareFontInfo);\n    }\n    _createRequest(chr, type, all, monospace) {\n        const result = new CharWidthRequest(chr, type);\n        all.push(result);\n        monospace === null || monospace === void 0 ? void 0 : monospace.push(result);\n        return result;\n    }\n    _actualReadFontInfo(bareFontInfo) {\n        const all = [];\n        const monospace = [];\n        const typicalHalfwidthCharacter = this._createRequest('n', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        const typicalFullwidthCharacter = this._createRequest('\\uff4d', 0 /* CharWidthRequestType.Regular */, all, null);\n        const space = this._createRequest(' ', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        const digit0 = this._createRequest('0', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        const digit1 = this._createRequest('1', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        const digit2 = this._createRequest('2', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        const digit3 = this._createRequest('3', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        const digit4 = this._createRequest('4', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        const digit5 = this._createRequest('5', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        const digit6 = this._createRequest('6', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        const digit7 = this._createRequest('7', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        const digit8 = this._createRequest('8', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        const digit9 = this._createRequest('9', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        // monospace test: used for whitespace rendering\n        const rightwardsArrow = this._createRequest('→', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        const halfwidthRightwardsArrow = this._createRequest('￫', 0 /* CharWidthRequestType.Regular */, all, null);\n        // U+00B7 - MIDDLE DOT\n        const middot = this._createRequest('·', 0 /* CharWidthRequestType.Regular */, all, monospace);\n        // U+2E31 - WORD SEPARATOR MIDDLE DOT\n        const wsmiddotWidth = this._createRequest(String.fromCharCode(0x2E31), 0 /* CharWidthRequestType.Regular */, all, null);\n        // monospace test: some characters\n        const monospaceTestChars = '|/-_ilm%';\n        for (let i = 0, len = monospaceTestChars.length; i < len; i++) {\n            this._createRequest(monospaceTestChars.charAt(i), 0 /* CharWidthRequestType.Regular */, all, monospace);\n            this._createRequest(monospaceTestChars.charAt(i), 1 /* CharWidthRequestType.Italic */, all, monospace);\n            this._createRequest(monospaceTestChars.charAt(i), 2 /* CharWidthRequestType.Bold */, all, monospace);\n        }\n        readCharWidths(bareFontInfo, all);\n        const maxDigitWidth = Math.max(digit0.width, digit1.width, digit2.width, digit3.width, digit4.width, digit5.width, digit6.width, digit7.width, digit8.width, digit9.width);\n        let isMonospace = (bareFontInfo.fontFeatureSettings === EditorFontLigatures.OFF);\n        const referenceWidth = monospace[0].width;\n        for (let i = 1, len = monospace.length; isMonospace && i < len; i++) {\n            const diff = referenceWidth - monospace[i].width;\n            if (diff < -0.001 || diff > 0.001) {\n                isMonospace = false;\n                break;\n            }\n        }\n        let canUseHalfwidthRightwardsArrow = true;\n        if (isMonospace && halfwidthRightwardsArrow.width !== referenceWidth) {\n            // using a halfwidth rightwards arrow would break monospace...\n            canUseHalfwidthRightwardsArrow = false;\n        }\n        if (halfwidthRightwardsArrow.width > rightwardsArrow.width) {\n            // using a halfwidth rightwards arrow would paint a larger arrow than a regular rightwards arrow\n            canUseHalfwidthRightwardsArrow = false;\n        }\n        return new FontInfo({\n            pixelRatio: browser.PixelRatio.value,\n            fontFamily: bareFontInfo.fontFamily,\n            fontWeight: bareFontInfo.fontWeight,\n            fontSize: bareFontInfo.fontSize,\n            fontFeatureSettings: bareFontInfo.fontFeatureSettings,\n            fontVariationSettings: bareFontInfo.fontVariationSettings,\n            lineHeight: bareFontInfo.lineHeight,\n            letterSpacing: bareFontInfo.letterSpacing,\n            isMonospace: isMonospace,\n            typicalHalfwidthCharacterWidth: typicalHalfwidthCharacter.width,\n            typicalFullwidthCharacterWidth: typicalFullwidthCharacter.width,\n            canUseHalfwidthRightwardsArrow: canUseHalfwidthRightwardsArrow,\n            spaceWidth: space.width,\n            middotWidth: middot.width,\n            wsmiddotWidth: wsmiddotWidth.width,\n            maxDigitWidth: maxDigitWidth\n        }, true);\n    }\n}\nclass FontMeasurementsCache {\n    constructor() {\n        this._keys = Object.create(null);\n        this._values = Object.create(null);\n    }\n    has(item) {\n        const itemId = item.getId();\n        return !!this._values[itemId];\n    }\n    get(item) {\n        const itemId = item.getId();\n        return this._values[itemId];\n    }\n    put(item, value) {\n        const itemId = item.getId();\n        this._keys[itemId] = item;\n        this._values[itemId] = value;\n    }\n    remove(item) {\n        const itemId = item.getId();\n        delete this._keys[itemId];\n        delete this._values[itemId];\n    }\n    getValues() {\n        return Object.keys(this._keys).map(id => this._values[id]);\n    }\n}\nexport const FontMeasurements = new FontMeasurementsImpl();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Emitter } from '../../../base/common/event.js';\nclass TabFocusImpl {\n    constructor() {\n        this._tabFocus = false;\n        this._onDidChangeTabFocus = new Emitter();\n        this.onDidChangeTabFocus = this._onDidChangeTabFocus.event;\n    }\n    getTabFocusMode() {\n        return this._tabFocus;\n    }\n    setTabFocusMode(tabFocusMode) {\n        this._tabFocus = tabFocusMode;\n        this._onDidChangeTabFocus.fire(this._tabFocus);\n    }\n}\n/**\n * Control what pressing Tab does.\n * If it is false, pressing Tab or Shift-Tab will be handled by the editor.\n * If it is true, pressing Tab or Shift-Tab will move the browser focus.\n * Defaults to false.\n */\nexport const TabFocus = new TabFocusImpl();\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { PageCoordinates } from '../editorDom.js';\nimport { PartFingerprints } from '../view/viewPart.js';\nimport { ViewLine } from '../viewParts/lines/viewLine.js';\nimport { Position } from '../../common/core/position.js';\nimport { Range as EditorRange } from '../../common/core/range.js';\nimport { CursorColumns } from '../../common/core/cursorColumns.js';\nimport * as dom from '../../../base/browser/dom.js';\nimport { AtomicTabMoveOperations } from '../../common/cursor/cursorAtomicMoveOperations.js';\nclass UnknownHitTestResult {\n    constructor(hitTarget = null) {\n        this.hitTarget = hitTarget;\n        this.type = 0 /* HitTestResultType.Unknown */;\n    }\n}\nclass ContentHitTestResult {\n    constructor(position, spanNode, injectedText) {\n        this.position = position;\n        this.spanNode = spanNode;\n        this.injectedText = injectedText;\n        this.type = 1 /* HitTestResultType.Content */;\n    }\n}\nvar HitTestResult;\n(function (HitTestResult) {\n    function createFromDOMInfo(ctx, spanNode, offset) {\n        const position = ctx.getPositionFromDOMInfo(spanNode, offset);\n        if (position) {\n            return new ContentHitTestResult(position, spanNode, null);\n        }\n        return new UnknownHitTestResult(spanNode);\n    }\n    HitTestResult.createFromDOMInfo = createFromDOMInfo;\n})(HitTestResult || (HitTestResult = {}));\nexport class PointerHandlerLastRenderData {\n    constructor(lastViewCursorsRenderData, lastTextareaPosition) {\n        this.lastViewCursorsRenderData = lastViewCursorsRenderData;\n        this.lastTextareaPosition = lastTextareaPosition;\n    }\n}\nexport class MouseTarget {\n    static _deduceRage(position, range = null) {\n        if (!range && position) {\n            return new EditorRange(position.lineNumber, position.column, position.lineNumber, position.column);\n        }\n        return range !== null && range !== void 0 ? range : null;\n    }\n    static createUnknown(element, mouseColumn, position) {\n        return { type: 0 /* MouseTargetType.UNKNOWN */, element, mouseColumn, position, range: this._deduceRage(position) };\n    }\n    static createTextarea(element, mouseColumn) {\n        return { type: 1 /* MouseTargetType.TEXTAREA */, element, mouseColumn, position: null, range: null };\n    }\n    static createMargin(type, element, mouseColumn, position, range, detail) {\n        return { type, element, mouseColumn, position, range, detail };\n    }\n    static createViewZone(type, element, mouseColumn, position, detail) {\n        return { type, element, mouseColumn, position, range: this._deduceRage(position), detail };\n    }\n    static createContentText(element, mouseColumn, position, range, detail) {\n        return { type: 6 /* MouseTargetType.CONTENT_TEXT */, element, mouseColumn, position, range: this._deduceRage(position, range), detail };\n    }\n    static createContentEmpty(element, mouseColumn, position, detail) {\n        return { type: 7 /* MouseTargetType.CONTENT_EMPTY */, element, mouseColumn, position, range: this._deduceRage(position), detail };\n    }\n    static createContentWidget(element, mouseColumn, detail) {\n        return { type: 9 /* MouseTargetType.CONTENT_WIDGET */, element, mouseColumn, position: null, range: null, detail };\n    }\n    static createScrollbar(element, mouseColumn, position) {\n        return { type: 11 /* MouseTargetType.SCROLLBAR */, element, mouseColumn, position, range: this._deduceRage(position) };\n    }\n    static createOverlayWidget(element, mouseColumn, detail) {\n        return { type: 12 /* MouseTargetType.OVERLAY_WIDGET */, element, mouseColumn, position: null, range: null, detail };\n    }\n    static createOutsideEditor(mouseColumn, position, outsidePosition, outsideDistance) {\n        return { type: 13 /* MouseTargetType.OUTSIDE_EDITOR */, element: null, mouseColumn, position, range: this._deduceRage(position), outsidePosition, outsideDistance };\n    }\n    static _typeToString(type) {\n        if (type === 1 /* MouseTargetType.TEXTAREA */) {\n            return 'TEXTAREA';\n        }\n        if (type === 2 /* MouseTargetType.GUTTER_GLYPH_MARGIN */) {\n            return 'GUTTER_GLYPH_MARGIN';\n        }\n        if (type === 3 /* MouseTargetType.GUTTER_LINE_NUMBERS */) {\n            return 'GUTTER_LINE_NUMBERS';\n        }\n        if (type === 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */) {\n            return 'GUTTER_LINE_DECORATIONS';\n        }\n        if (type === 5 /* MouseTargetType.GUTTER_VIEW_ZONE */) {\n            return 'GUTTER_VIEW_ZONE';\n        }\n        if (type === 6 /* MouseTargetType.CONTENT_TEXT */) {\n            return 'CONTENT_TEXT';\n        }\n        if (type === 7 /* MouseTargetType.CONTENT_EMPTY */) {\n            return 'CONTENT_EMPTY';\n        }\n        if (type === 8 /* MouseTargetType.CONTENT_VIEW_ZONE */) {\n            return 'CONTENT_VIEW_ZONE';\n        }\n        if (type === 9 /* MouseTargetType.CONTENT_WIDGET */) {\n            return 'CONTENT_WIDGET';\n        }\n        if (type === 10 /* MouseTargetType.OVERVIEW_RULER */) {\n            return 'OVERVIEW_RULER';\n        }\n        if (type === 11 /* MouseTargetType.SCROLLBAR */) {\n            return 'SCROLLBAR';\n        }\n        if (type === 12 /* MouseTargetType.OVERLAY_WIDGET */) {\n            return 'OVERLAY_WIDGET';\n        }\n        return 'UNKNOWN';\n    }\n    static toString(target) {\n        return this._typeToString(target.type) + ': ' + target.position + ' - ' + target.range + ' - ' + JSON.stringify(target.detail);\n    }\n}\nclass ElementPath {\n    static isTextArea(path) {\n        return (path.length === 2\n            && path[0] === 3 /* PartFingerprint.OverflowGuard */\n            && path[1] === 6 /* PartFingerprint.TextArea */);\n    }\n    static isChildOfViewLines(path) {\n        return (path.length >= 4\n            && path[0] === 3 /* PartFingerprint.OverflowGuard */\n            && path[3] === 7 /* PartFingerprint.ViewLines */);\n    }\n    static isStrictChildOfViewLines(path) {\n        return (path.length > 4\n            && path[0] === 3 /* PartFingerprint.OverflowGuard */\n            && path[3] === 7 /* PartFingerprint.ViewLines */);\n    }\n    static isChildOfScrollableElement(path) {\n        return (path.length >= 2\n            && path[0] === 3 /* PartFingerprint.OverflowGuard */\n            && path[1] === 5 /* PartFingerprint.ScrollableElement */);\n    }\n    static isChildOfMinimap(path) {\n        return (path.length >= 2\n            && path[0] === 3 /* PartFingerprint.OverflowGuard */\n            && path[1] === 8 /* PartFingerprint.Minimap */);\n    }\n    static isChildOfContentWidgets(path) {\n        return (path.length >= 4\n            && path[0] === 3 /* PartFingerprint.OverflowGuard */\n            && path[3] === 1 /* PartFingerprint.ContentWidgets */);\n    }\n    static isChildOfOverflowGuard(path) {\n        return (path.length >= 1\n            && path[0] === 3 /* PartFingerprint.OverflowGuard */);\n    }\n    static isChildOfOverflowingContentWidgets(path) {\n        return (path.length >= 1\n            && path[0] === 2 /* PartFingerprint.OverflowingContentWidgets */);\n    }\n    static isChildOfOverlayWidgets(path) {\n        return (path.length >= 2\n            && path[0] === 3 /* PartFingerprint.OverflowGuard */\n            && path[1] === 4 /* PartFingerprint.OverlayWidgets */);\n    }\n}\nexport class HitTestContext {\n    constructor(context, viewHelper, lastRenderData) {\n        this.viewModel = context.viewModel;\n        const options = context.configuration.options;\n        this.layoutInfo = options.get(143 /* EditorOption.layoutInfo */);\n        this.viewDomNode = viewHelper.viewDomNode;\n        this.lineHeight = options.get(66 /* EditorOption.lineHeight */);\n        this.stickyTabStops = options.get(115 /* EditorOption.stickyTabStops */);\n        this.typicalHalfwidthCharacterWidth = options.get(50 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth;\n        this.lastRenderData = lastRenderData;\n        this._context = context;\n        this._viewHelper = viewHelper;\n    }\n    getZoneAtCoord(mouseVerticalOffset) {\n        return HitTestContext.getZoneAtCoord(this._context, mouseVerticalOffset);\n    }\n    static getZoneAtCoord(context, mouseVerticalOffset) {\n        // The target is either a view zone or the empty space after the last view-line\n        const viewZoneWhitespace = context.viewLayout.getWhitespaceAtVerticalOffset(mouseVerticalOffset);\n        if (viewZoneWhitespace) {\n            const viewZoneMiddle = viewZoneWhitespace.verticalOffset + viewZoneWhitespace.height / 2;\n            const lineCount = context.viewModel.getLineCount();\n            let positionBefore = null;\n            let position;\n            let positionAfter = null;\n            if (viewZoneWhitespace.afterLineNumber !== lineCount) {\n                // There are more lines after this view zone\n                positionAfter = new Position(viewZoneWhitespace.afterLineNumber + 1, 1);\n            }\n            if (viewZoneWhitespace.afterLineNumber > 0) {\n                // There are more lines above this view zone\n                positionBefore = new Position(viewZoneWhitespace.afterLineNumber, context.viewModel.getLineMaxColumn(viewZoneWhitespace.afterLineNumber));\n            }\n            if (positionAfter === null) {\n                position = positionBefore;\n            }\n            else if (positionBefore === null) {\n                position = positionAfter;\n            }\n            else if (mouseVerticalOffset < viewZoneMiddle) {\n                position = positionBefore;\n            }\n            else {\n                position = positionAfter;\n            }\n            return {\n                viewZoneId: viewZoneWhitespace.id,\n                afterLineNumber: viewZoneWhitespace.afterLineNumber,\n                positionBefore: positionBefore,\n                positionAfter: positionAfter,\n                position: position\n            };\n        }\n        return null;\n    }\n    getFullLineRangeAtCoord(mouseVerticalOffset) {\n        if (this._context.viewLayout.isAfterLines(mouseVerticalOffset)) {\n            // Below the last line\n            const lineNumber = this._context.viewModel.getLineCount();\n            const maxLineColumn = this._context.viewModel.getLineMaxColumn(lineNumber);\n            return {\n                range: new EditorRange(lineNumber, maxLineColumn, lineNumber, maxLineColumn),\n                isAfterLines: true\n            };\n        }\n        const lineNumber = this._context.viewLayout.getLineNumberAtVerticalOffset(mouseVerticalOffset);\n        const maxLineColumn = this._context.viewModel.getLineMaxColumn(lineNumber);\n        return {\n            range: new EditorRange(lineNumber, 1, lineNumber, maxLineColumn),\n            isAfterLines: false\n        };\n    }\n    getLineNumberAtVerticalOffset(mouseVerticalOffset) {\n        return this._context.viewLayout.getLineNumberAtVerticalOffset(mouseVerticalOffset);\n    }\n    isAfterLines(mouseVerticalOffset) {\n        return this._context.viewLayout.isAfterLines(mouseVerticalOffset);\n    }\n    isInTopPadding(mouseVerticalOffset) {\n        return this._context.viewLayout.isInTopPadding(mouseVerticalOffset);\n    }\n    isInBottomPadding(mouseVerticalOffset) {\n        return this._context.viewLayout.isInBottomPadding(mouseVerticalOffset);\n    }\n    getVerticalOffsetForLineNumber(lineNumber) {\n        return this._context.viewLayout.getVerticalOffsetForLineNumber(lineNumber);\n    }\n    findAttribute(element, attr) {\n        return HitTestContext._findAttribute(element, attr, this._viewHelper.viewDomNode);\n    }\n    static _findAttribute(element, attr, stopAt) {\n        while (element && element !== element.ownerDocument.body) {\n            if (element.hasAttribute && element.hasAttribute(attr)) {\n                return element.getAttribute(attr);\n            }\n            if (element === stopAt) {\n                return null;\n            }\n            element = element.parentNode;\n        }\n        return null;\n    }\n    getLineWidth(lineNumber) {\n        return this._viewHelper.getLineWidth(lineNumber);\n    }\n    visibleRangeForPosition(lineNumber, column) {\n        return this._viewHelper.visibleRangeForPosition(lineNumber, column);\n    }\n    getPositionFromDOMInfo(spanNode, offset) {\n        return this._viewHelper.getPositionFromDOMInfo(spanNode, offset);\n    }\n    getCurrentScrollTop() {\n        return this._context.viewLayout.getCurrentScrollTop();\n    }\n    getCurrentScrollLeft() {\n        return this._context.viewLayout.getCurrentScrollLeft();\n    }\n}\nclass BareHitTestRequest {\n    constructor(ctx, editorPos, pos, relativePos) {\n        this.editorPos = editorPos;\n        this.pos = pos;\n        this.relativePos = relativePos;\n        this.mouseVerticalOffset = Math.max(0, ctx.getCurrentScrollTop() + this.relativePos.y);\n        this.mouseContentHorizontalOffset = ctx.getCurrentScrollLeft() + this.relativePos.x - ctx.layoutInfo.contentLeft;\n        this.isInMarginArea = (this.relativePos.x < ctx.layoutInfo.contentLeft && this.relativePos.x >= ctx.layoutInfo.glyphMarginLeft);\n        this.isInContentArea = !this.isInMarginArea;\n        this.mouseColumn = Math.max(0, MouseTargetFactory._getMouseColumn(this.mouseContentHorizontalOffset, ctx.typicalHalfwidthCharacterWidth));\n    }\n}\nclass HitTestRequest extends BareHitTestRequest {\n    constructor(ctx, editorPos, pos, relativePos, target) {\n        super(ctx, editorPos, pos, relativePos);\n        this._ctx = ctx;\n        if (target) {\n            this.target = target;\n            this.targetPath = PartFingerprints.collect(target, ctx.viewDomNode);\n        }\n        else {\n            this.target = null;\n            this.targetPath = new Uint8Array(0);\n        }\n    }\n    toString() {\n        return `pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}\\n\\ttarget: ${this.target ? this.target.outerHTML : null}`;\n    }\n    _getMouseColumn(position = null) {\n        if (position && position.column < this._ctx.viewModel.getLineMaxColumn(position.lineNumber)) {\n            // Most likely, the line contains foreign decorations...\n            return CursorColumns.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(position.lineNumber), position.column, this._ctx.viewModel.model.getOptions().tabSize) + 1;\n        }\n        return this.mouseColumn;\n    }\n    fulfillUnknown(position = null) {\n        return MouseTarget.createUnknown(this.target, this._getMouseColumn(position), position);\n    }\n    fulfillTextarea() {\n        return MouseTarget.createTextarea(this.target, this._getMouseColumn());\n    }\n    fulfillMargin(type, position, range, detail) {\n        return MouseTarget.createMargin(type, this.target, this._getMouseColumn(position), position, range, detail);\n    }\n    fulfillViewZone(type, position, detail) {\n        return MouseTarget.createViewZone(type, this.target, this._getMouseColumn(position), position, detail);\n    }\n    fulfillContentText(position, range, detail) {\n        return MouseTarget.createContentText(this.target, this._getMouseColumn(position), position, range, detail);\n    }\n    fulfillContentEmpty(position, detail) {\n        return MouseTarget.createContentEmpty(this.target, this._getMouseColumn(position), position, detail);\n    }\n    fulfillContentWidget(detail) {\n        return MouseTarget.createContentWidget(this.target, this._getMouseColumn(), detail);\n    }\n    fulfillScrollbar(position) {\n        return MouseTarget.createScrollbar(this.target, this._getMouseColumn(position), position);\n    }\n    fulfillOverlayWidget(detail) {\n        return MouseTarget.createOverlayWidget(this.target, this._getMouseColumn(), detail);\n    }\n    withTarget(target) {\n        return new HitTestRequest(this._ctx, this.editorPos, this.pos, this.relativePos, target);\n    }\n}\nconst EMPTY_CONTENT_AFTER_LINES = { isAfterLines: true };\nfunction createEmptyContentDataInLines(horizontalDistanceToText) {\n    return {\n        isAfterLines: false,\n        horizontalDistanceToText: horizontalDistanceToText\n    };\n}\nexport class MouseTargetFactory {\n    constructor(context, viewHelper) {\n        this._context = context;\n        this._viewHelper = viewHelper;\n    }\n    mouseTargetIsWidget(e) {\n        const t = e.target;\n        const path = PartFingerprints.collect(t, this._viewHelper.viewDomNode);\n        // Is it a content widget?\n        if (ElementPath.isChildOfContentWidgets(path) || ElementPath.isChildOfOverflowingContentWidgets(path)) {\n            return true;\n        }\n        // Is it an overlay widget?\n        if (ElementPath.isChildOfOverlayWidgets(path)) {\n            return true;\n        }\n        return false;\n    }\n    createMouseTarget(lastRenderData, editorPos, pos, relativePos, target) {\n        const ctx = new HitTestContext(this._context, this._viewHelper, lastRenderData);\n        const request = new HitTestRequest(ctx, editorPos, pos, relativePos, target);\n        try {\n            const r = MouseTargetFactory._createMouseTarget(ctx, request, false);\n            if (r.type === 6 /* MouseTargetType.CONTENT_TEXT */) {\n                // Snap to the nearest soft tab boundary if atomic soft tabs are enabled.\n                if (ctx.stickyTabStops && r.position !== null) {\n                    const position = MouseTargetFactory._snapToSoftTabBoundary(r.position, ctx.viewModel);\n                    const range = EditorRange.fromPositions(position, position).plusRange(r.range);\n                    return request.fulfillContentText(position, range, r.detail);\n                }\n            }\n            // console.log(MouseTarget.toString(r));\n            return r;\n        }\n        catch (err) {\n            // console.log(err);\n            return request.fulfillUnknown();\n        }\n    }\n    static _createMouseTarget(ctx, request, domHitTestExecuted) {\n        // console.log(`${domHitTestExecuted ? '=>' : ''}CAME IN REQUEST: ${request}`);\n        // First ensure the request has a target\n        if (request.target === null) {\n            if (domHitTestExecuted) {\n                // Still no target... and we have already executed hit test...\n                return request.fulfillUnknown();\n            }\n            const hitTestResult = MouseTargetFactory._doHitTest(ctx, request);\n            if (hitTestResult.type === 1 /* HitTestResultType.Content */) {\n                return MouseTargetFactory.createMouseTargetFromHitTestPosition(ctx, request, hitTestResult.spanNode, hitTestResult.position, hitTestResult.injectedText);\n            }\n            return this._createMouseTarget(ctx, request.withTarget(hitTestResult.hitTarget), true);\n        }\n        // we know for a fact that request.target is not null\n        const resolvedRequest = request;\n        let result = null;\n        if (!ElementPath.isChildOfOverflowGuard(request.targetPath) && !ElementPath.isChildOfOverflowingContentWidgets(request.targetPath)) {\n            // We only render dom nodes inside the overflow guard or in the overflowing content widgets\n            result = result || request.fulfillUnknown();\n        }\n        result = result || MouseTargetFactory._hitTestContentWidget(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestOverlayWidget(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestMinimap(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestScrollbarSlider(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestViewZone(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestMargin(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestViewCursor(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestTextArea(ctx, resolvedRequest);\n        result = result || MouseTargetFactory._hitTestViewLines(ctx, resolvedRequest, domHitTestExecuted);\n        result = result || MouseTargetFactory._hitTestScrollbar(ctx, resolvedRequest);\n        return (result || request.fulfillUnknown());\n    }\n    static _hitTestContentWidget(ctx, request) {\n        // Is it a content widget?\n        if (ElementPath.isChildOfContentWidgets(request.targetPath) || ElementPath.isChildOfOverflowingContentWidgets(request.targetPath)) {\n            const widgetId = ctx.findAttribute(request.target, 'widgetId');\n            if (widgetId) {\n                return request.fulfillContentWidget(widgetId);\n            }\n            else {\n                return request.fulfillUnknown();\n            }\n        }\n        return null;\n    }\n    static _hitTestOverlayWidget(ctx, request) {\n        // Is it an overlay widget?\n        if (ElementPath.isChildOfOverlayWidgets(request.targetPath)) {\n            const widgetId = ctx.findAttribute(request.target, 'widgetId');\n            if (widgetId) {\n                return request.fulfillOverlayWidget(widgetId);\n            }\n            else {\n                return request.fulfillUnknown();\n            }\n        }\n        return null;\n    }\n    static _hitTestViewCursor(ctx, request) {\n        if (request.target) {\n            // Check if we've hit a painted cursor\n            const lastViewCursorsRenderData = ctx.lastRenderData.lastViewCursorsRenderData;\n            for (const d of lastViewCursorsRenderData) {\n                if (request.target === d.domNode) {\n                    return request.fulfillContentText(d.position, null, { mightBeForeignElement: false, injectedText: null });\n                }\n            }\n        }\n        if (request.isInContentArea) {\n            // Edge has a bug when hit-testing the exact position of a cursor,\n            // instead of returning the correct dom node, it returns the\n            // first or last rendered view line dom node, therefore help it out\n            // and first check if we are on top of a cursor\n            const lastViewCursorsRenderData = ctx.lastRenderData.lastViewCursorsRenderData;\n            const mouseContentHorizontalOffset = request.mouseContentHorizontalOffset;\n            const mouseVerticalOffset = request.mouseVerticalOffset;\n            for (const d of lastViewCursorsRenderData) {\n                if (mouseContentHorizontalOffset < d.contentLeft) {\n                    // mouse position is to the left of the cursor\n                    continue;\n                }\n                if (mouseContentHorizontalOffset > d.contentLeft + d.width) {\n                    // mouse position is to the right of the cursor\n                    continue;\n                }\n                const cursorVerticalOffset = ctx.getVerticalOffsetForLineNumber(d.position.lineNumber);\n                if (cursorVerticalOffset <= mouseVerticalOffset\n                    && mouseVerticalOffset <= cursorVerticalOffset + d.height) {\n                    return request.fulfillContentText(d.position, null, { mightBeForeignElement: false, injectedText: null });\n                }\n            }\n        }\n        return null;\n    }\n    static _hitTestViewZone(ctx, request) {\n        const viewZoneData = ctx.getZoneAtCoord(request.mouseVerticalOffset);\n        if (viewZoneData) {\n            const mouseTargetType = (request.isInContentArea ? 8 /* MouseTargetType.CONTENT_VIEW_ZONE */ : 5 /* MouseTargetType.GUTTER_VIEW_ZONE */);\n            return request.fulfillViewZone(mouseTargetType, viewZoneData.position, viewZoneData);\n        }\n        return null;\n    }\n    static _hitTestTextArea(ctx, request) {\n        // Is it the textarea?\n        if (ElementPath.isTextArea(request.targetPath)) {\n            if (ctx.lastRenderData.lastTextareaPosition) {\n                return request.fulfillContentText(ctx.lastRenderData.lastTextareaPosition, null, { mightBeForeignElement: false, injectedText: null });\n            }\n            return request.fulfillTextarea();\n        }\n        return null;\n    }\n    static _hitTestMargin(ctx, request) {\n        if (request.isInMarginArea) {\n            const res = ctx.getFullLineRangeAtCoord(request.mouseVerticalOffset);\n            const pos = res.range.getStartPosition();\n            let offset = Math.abs(request.relativePos.x);\n            const detail = {\n                isAfterLines: res.isAfterLines,\n                glyphMarginLeft: ctx.layoutInfo.glyphMarginLeft,\n                glyphMarginWidth: ctx.layoutInfo.glyphMarginWidth,\n                lineNumbersWidth: ctx.layoutInfo.lineNumbersWidth,\n                offsetX: offset\n            };\n            offset -= ctx.layoutInfo.glyphMarginLeft;\n            if (offset <= ctx.layoutInfo.glyphMarginWidth) {\n                // On the glyph margin\n                return request.fulfillMargin(2 /* MouseTargetType.GUTTER_GLYPH_MARGIN */, pos, res.range, detail);\n            }\n            offset -= ctx.layoutInfo.glyphMarginWidth;\n            if (offset <= ctx.layoutInfo.lineNumbersWidth) {\n                // On the line numbers\n                return request.fulfillMargin(3 /* MouseTargetType.GUTTER_LINE_NUMBERS */, pos, res.range, detail);\n            }\n            offset -= ctx.layoutInfo.lineNumbersWidth;\n            // On the line decorations\n            return request.fulfillMargin(4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */, pos, res.range, detail);\n        }\n        return null;\n    }\n    static _hitTestViewLines(ctx, request, domHitTestExecuted) {\n        if (!ElementPath.isChildOfViewLines(request.targetPath)) {\n            return null;\n        }\n        if (ctx.isInTopPadding(request.mouseVerticalOffset)) {\n            return request.fulfillContentEmpty(new Position(1, 1), EMPTY_CONTENT_AFTER_LINES);\n        }\n        // Check if it is below any lines and any view zones\n        if (ctx.isAfterLines(request.mouseVerticalOffset) || ctx.isInBottomPadding(request.mouseVerticalOffset)) {\n            // This most likely indicates it happened after the last view-line\n            const lineCount = ctx.viewModel.getLineCount();\n            const maxLineColumn = ctx.viewModel.getLineMaxColumn(lineCount);\n            return request.fulfillContentEmpty(new Position(lineCount, maxLineColumn), EMPTY_CONTENT_AFTER_LINES);\n        }\n        if (domHitTestExecuted) {\n            // Check if we are hitting a view-line (can happen in the case of inline decorations on empty lines)\n            // See https://github.com/microsoft/vscode/issues/46942\n            if (ElementPath.isStrictChildOfViewLines(request.targetPath)) {\n                const lineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\n                if (ctx.viewModel.getLineLength(lineNumber) === 0) {\n                    const lineWidth = ctx.getLineWidth(lineNumber);\n                    const detail = createEmptyContentDataInLines(request.mouseContentHorizontalOffset - lineWidth);\n                    return request.fulfillContentEmpty(new Position(lineNumber, 1), detail);\n                }\n                const lineWidth = ctx.getLineWidth(lineNumber);\n                if (request.mouseContentHorizontalOffset >= lineWidth) {\n                    const detail = createEmptyContentDataInLines(request.mouseContentHorizontalOffset - lineWidth);\n                    const pos = new Position(lineNumber, ctx.viewModel.getLineMaxColumn(lineNumber));\n                    return request.fulfillContentEmpty(pos, detail);\n                }\n            }\n            // We have already executed hit test...\n            return request.fulfillUnknown();\n        }\n        const hitTestResult = MouseTargetFactory._doHitTest(ctx, request);\n        if (hitTestResult.type === 1 /* HitTestResultType.Content */) {\n            return MouseTargetFactory.createMouseTargetFromHitTestPosition(ctx, request, hitTestResult.spanNode, hitTestResult.position, hitTestResult.injectedText);\n        }\n        return this._createMouseTarget(ctx, request.withTarget(hitTestResult.hitTarget), true);\n    }\n    static _hitTestMinimap(ctx, request) {\n        if (ElementPath.isChildOfMinimap(request.targetPath)) {\n            const possibleLineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\n            const maxColumn = ctx.viewModel.getLineMaxColumn(possibleLineNumber);\n            return request.fulfillScrollbar(new Position(possibleLineNumber, maxColumn));\n        }\n        return null;\n    }\n    static _hitTestScrollbarSlider(ctx, request) {\n        if (ElementPath.isChildOfScrollableElement(request.targetPath)) {\n            if (request.target && request.target.nodeType === 1) {\n                const className = request.target.className;\n                if (className && /\\b(slider|scrollbar)\\b/.test(className)) {\n                    const possibleLineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\n                    const maxColumn = ctx.viewModel.getLineMaxColumn(possibleLineNumber);\n                    return request.fulfillScrollbar(new Position(possibleLineNumber, maxColumn));\n                }\n            }\n        }\n        return null;\n    }\n    static _hitTestScrollbar(ctx, request) {\n        // Is it the overview ruler?\n        // Is it a child of the scrollable element?\n        if (ElementPath.isChildOfScrollableElement(request.targetPath)) {\n            const possibleLineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\n            const maxColumn = ctx.viewModel.getLineMaxColumn(possibleLineNumber);\n            return request.fulfillScrollbar(new Position(possibleLineNumber, maxColumn));\n        }\n        return null;\n    }\n    getMouseColumn(relativePos) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(143 /* EditorOption.layoutInfo */);\n        const mouseContentHorizontalOffset = this._context.viewLayout.getCurrentScrollLeft() + relativePos.x - layoutInfo.contentLeft;\n        return MouseTargetFactory._getMouseColumn(mouseContentHorizontalOffset, options.get(50 /* EditorOption.fontInfo */).typicalHalfwidthCharacterWidth);\n    }\n    static _getMouseColumn(mouseContentHorizontalOffset, typicalHalfwidthCharacterWidth) {\n        if (mouseContentHorizontalOffset < 0) {\n            return 1;\n        }\n        const chars = Math.round(mouseContentHorizontalOffset / typicalHalfwidthCharacterWidth);\n        return (chars + 1);\n    }\n    static createMouseTargetFromHitTestPosition(ctx, request, spanNode, pos, injectedText) {\n        const lineNumber = pos.lineNumber;\n        const column = pos.column;\n        const lineWidth = ctx.getLineWidth(lineNumber);\n        if (request.mouseContentHorizontalOffset > lineWidth) {\n            const detail = createEmptyContentDataInLines(request.mouseContentHorizontalOffset - lineWidth);\n            return request.fulfillContentEmpty(pos, detail);\n        }\n        const visibleRange = ctx.visibleRangeForPosition(lineNumber, column);\n        if (!visibleRange) {\n            return request.fulfillUnknown(pos);\n        }\n        const columnHorizontalOffset = visibleRange.left;\n        if (Math.abs(request.mouseContentHorizontalOffset - columnHorizontalOffset) < 1) {\n            return request.fulfillContentText(pos, null, { mightBeForeignElement: !!injectedText, injectedText });\n        }\n        const points = [];\n        points.push({ offset: visibleRange.left, column: column });\n        if (column > 1) {\n            const visibleRange = ctx.visibleRangeForPosition(lineNumber, column - 1);\n            if (visibleRange) {\n                points.push({ offset: visibleRange.left, column: column - 1 });\n            }\n        }\n        const lineMaxColumn = ctx.viewModel.getLineMaxColumn(lineNumber);\n        if (column < lineMaxColumn) {\n            const visibleRange = ctx.visibleRangeForPosition(lineNumber, column + 1);\n            if (visibleRange) {\n                points.push({ offset: visibleRange.left, column: column + 1 });\n            }\n        }\n        points.sort((a, b) => a.offset - b.offset);\n        const mouseCoordinates = request.pos.toClientCoordinates();\n        const spanNodeClientRect = spanNode.getBoundingClientRect();\n        const mouseIsOverSpanNode = (spanNodeClientRect.left <= mouseCoordinates.clientX && mouseCoordinates.clientX <= spanNodeClientRect.right);\n        let rng = null;\n        for (let i = 1; i < points.length; i++) {\n            const prev = points[i - 1];\n            const curr = points[i];\n            if (prev.offset <= request.mouseContentHorizontalOffset && request.mouseContentHorizontalOffset <= curr.offset) {\n                rng = new EditorRange(lineNumber, prev.column, lineNumber, curr.column);\n                // See https://github.com/microsoft/vscode/issues/152819\n                // Due to the use of zwj, the browser's hit test result is skewed towards the left\n                // Here we try to correct that if the mouse horizontal offset is closer to the right than the left\n                const prevDelta = Math.abs(prev.offset - request.mouseContentHorizontalOffset);\n                const nextDelta = Math.abs(curr.offset - request.mouseContentHorizontalOffset);\n                pos = (prevDelta < nextDelta\n                    ? new Position(lineNumber, prev.column)\n                    : new Position(lineNumber, curr.column));\n                break;\n            }\n        }\n        return request.fulfillContentText(pos, rng, { mightBeForeignElement: !mouseIsOverSpanNode || !!injectedText, injectedText });\n    }\n    /**\n     * Most probably WebKit browsers and Edge\n     */\n    static _doHitTestWithCaretRangeFromPoint(ctx, request) {\n        // In Chrome, especially on Linux it is possible to click between lines,\n        // so try to adjust the `hity` below so that it lands in the center of a line\n        const lineNumber = ctx.getLineNumberAtVerticalOffset(request.mouseVerticalOffset);\n        const lineStartVerticalOffset = ctx.getVerticalOffsetForLineNumber(lineNumber);\n        const lineEndVerticalOffset = lineStartVerticalOffset + ctx.lineHeight;\n        const isBelowLastLine = (lineNumber === ctx.viewModel.getLineCount()\n            && request.mouseVerticalOffset > lineEndVerticalOffset);\n        if (!isBelowLastLine) {\n            const lineCenteredVerticalOffset = Math.floor((lineStartVerticalOffset + lineEndVerticalOffset) / 2);\n            let adjustedPageY = request.pos.y + (lineCenteredVerticalOffset - request.mouseVerticalOffset);\n            if (adjustedPageY <= request.editorPos.y) {\n                adjustedPageY = request.editorPos.y + 1;\n            }\n            if (adjustedPageY >= request.editorPos.y + request.editorPos.height) {\n                adjustedPageY = request.editorPos.y + request.editorPos.height - 1;\n            }\n            const adjustedPage = new PageCoordinates(request.pos.x, adjustedPageY);\n            const r = this._actualDoHitTestWithCaretRangeFromPoint(ctx, adjustedPage.toClientCoordinates());\n            if (r.type === 1 /* HitTestResultType.Content */) {\n                return r;\n            }\n        }\n        // Also try to hit test without the adjustment (for the edge cases that we are near the top or bottom)\n        return this._actualDoHitTestWithCaretRangeFromPoint(ctx, request.pos.toClientCoordinates());\n    }\n    static _actualDoHitTestWithCaretRangeFromPoint(ctx, coords) {\n        const shadowRoot = dom.getShadowRoot(ctx.viewDomNode);\n        let range;\n        if (shadowRoot) {\n            if (typeof shadowRoot.caretRangeFromPoint === 'undefined') {\n                range = shadowCaretRangeFromPoint(shadowRoot, coords.clientX, coords.clientY);\n            }\n            else {\n                range = shadowRoot.caretRangeFromPoint(coords.clientX, coords.clientY);\n            }\n        }\n        else {\n            range = ctx.viewDomNode.ownerDocument.caretRangeFromPoint(coords.clientX, coords.clientY);\n        }\n        if (!range || !range.startContainer) {\n            return new UnknownHitTestResult();\n        }\n        // Chrome always hits a TEXT_NODE, while Edge sometimes hits a token span\n        const startContainer = range.startContainer;\n        if (startContainer.nodeType === startContainer.TEXT_NODE) {\n            // startContainer is expected to be the token text\n            const parent1 = startContainer.parentNode; // expected to be the token span\n            const parent2 = parent1 ? parent1.parentNode : null; // expected to be the view line container span\n            const parent3 = parent2 ? parent2.parentNode : null; // expected to be the view line div\n            const parent3ClassName = parent3 && parent3.nodeType === parent3.ELEMENT_NODE ? parent3.className : null;\n            if (parent3ClassName === ViewLine.CLASS_NAME) {\n                return HitTestResult.createFromDOMInfo(ctx, parent1, range.startOffset);\n            }\n            else {\n                return new UnknownHitTestResult(startContainer.parentNode);\n            }\n        }\n        else if (startContainer.nodeType === startContainer.ELEMENT_NODE) {\n            // startContainer is expected to be the token span\n            const parent1 = startContainer.parentNode; // expected to be the view line container span\n            const parent2 = parent1 ? parent1.parentNode : null; // expected to be the view line div\n            const parent2ClassName = parent2 && parent2.nodeType === parent2.ELEMENT_NODE ? parent2.className : null;\n            if (parent2ClassName === ViewLine.CLASS_NAME) {\n                return HitTestResult.createFromDOMInfo(ctx, startContainer, startContainer.textContent.length);\n            }\n            else {\n                return new UnknownHitTestResult(startContainer);\n            }\n        }\n        return new UnknownHitTestResult();\n    }\n    /**\n     * Most probably Gecko\n     */\n    static _doHitTestWithCaretPositionFromPoint(ctx, coords) {\n        const hitResult = ctx.viewDomNode.ownerDocument.caretPositionFromPoint(coords.clientX, coords.clientY);\n        if (hitResult.offsetNode.nodeType === hitResult.offsetNode.TEXT_NODE) {\n            // offsetNode is expected to be the token text\n            const parent1 = hitResult.offsetNode.parentNode; // expected to be the token span\n            const parent2 = parent1 ? parent1.parentNode : null; // expected to be the view line container span\n            const parent3 = parent2 ? parent2.parentNode : null; // expected to be the view line div\n            const parent3ClassName = parent3 && parent3.nodeType === parent3.ELEMENT_NODE ? parent3.className : null;\n            if (parent3ClassName === ViewLine.CLASS_NAME) {\n                return HitTestResult.createFromDOMInfo(ctx, hitResult.offsetNode.parentNode, hitResult.offset);\n            }\n            else {\n                return new UnknownHitTestResult(hitResult.offsetNode.parentNode);\n            }\n        }\n        // For inline decorations, Gecko sometimes returns the `<span>` of the line and the offset is the `<span>` with the inline decoration\n        // Some other times, it returns the `<span>` with the inline decoration\n        if (hitResult.offsetNode.nodeType === hitResult.offsetNode.ELEMENT_NODE) {\n            const parent1 = hitResult.offsetNode.parentNode;\n            const parent1ClassName = parent1 && parent1.nodeType === parent1.ELEMENT_NODE ? parent1.className : null;\n            const parent2 = parent1 ? parent1.parentNode : null;\n            const parent2ClassName = parent2 && parent2.nodeType === parent2.ELEMENT_NODE ? parent2.className : null;\n            if (parent1ClassName === ViewLine.CLASS_NAME) {\n                // it returned the `<span>` of the line and the offset is the `<span>` with the inline decoration\n                const tokenSpan = hitResult.offsetNode.childNodes[Math.min(hitResult.offset, hitResult.offsetNode.childNodes.length - 1)];\n                if (tokenSpan) {\n                    return HitTestResult.createFromDOMInfo(ctx, tokenSpan, 0);\n                }\n            }\n            else if (parent2ClassName === ViewLine.CLASS_NAME) {\n                // it returned the `<span>` with the inline decoration\n                return HitTestResult.createFromDOMInfo(ctx, hitResult.offsetNode, 0);\n            }\n        }\n        return new UnknownHitTestResult(hitResult.offsetNode);\n    }\n    static _snapToSoftTabBoundary(position, viewModel) {\n        const lineContent = viewModel.getLineContent(position.lineNumber);\n        const { tabSize } = viewModel.model.getOptions();\n        const newPosition = AtomicTabMoveOperations.atomicPosition(lineContent, position.column - 1, tabSize, 2 /* Direction.Nearest */);\n        if (newPosition !== -1) {\n            return new Position(position.lineNumber, newPosition + 1);\n        }\n        return position;\n    }\n    static _doHitTest(ctx, request) {\n        let result = new UnknownHitTestResult();\n        if (typeof ctx.viewDomNode.ownerDocument.caretRangeFromPoint === 'function') {\n            result = this._doHitTestWithCaretRangeFromPoint(ctx, request);\n        }\n        else if (ctx.viewDomNode.ownerDocument.caretPositionFromPoint) {\n            result = this._doHitTestWithCaretPositionFromPoint(ctx, request.pos.toClientCoordinates());\n        }\n        if (result.type === 1 /* HitTestResultType.Content */) {\n            const injectedText = ctx.viewModel.getInjectedTextAt(result.position);\n            const normalizedPosition = ctx.viewModel.normalizePosition(result.position, 2 /* PositionAffinity.None */);\n            if (injectedText || !normalizedPosition.equals(result.position)) {\n                result = new ContentHitTestResult(normalizedPosition, result.spanNode, injectedText);\n            }\n        }\n        return result;\n    }\n}\nfunction shadowCaretRangeFromPoint(shadowRoot, x, y) {\n    const range = document.createRange();\n    // Get the element under the point\n    let el = shadowRoot.elementFromPoint(x, y);\n    if (el !== null) {\n        // Get the last child of the element until its firstChild is a text node\n        // This assumes that the pointer is on the right of the line, out of the tokens\n        // and that we want to get the offset of the last token of the line\n        while (el && el.firstChild && el.firstChild.nodeType !== el.firstChild.TEXT_NODE && el.lastChild && el.lastChild.firstChild) {\n            el = el.lastChild;\n        }\n        // Grab its rect\n        const rect = el.getBoundingClientRect();\n        // And its font (the computed shorthand font property might be empty, see #3217)\n        const fontStyle = window.getComputedStyle(el, null).getPropertyValue('font-style');\n        const fontVariant = window.getComputedStyle(el, null).getPropertyValue('font-variant');\n        const fontWeight = window.getComputedStyle(el, null).getPropertyValue('font-weight');\n        const fontSize = window.getComputedStyle(el, null).getPropertyValue('font-size');\n        const lineHeight = window.getComputedStyle(el, null).getPropertyValue('line-height');\n        const fontFamily = window.getComputedStyle(el, null).getPropertyValue('font-family');\n        const font = `${fontStyle} ${fontVariant} ${fontWeight} ${fontSize}/${lineHeight} ${fontFamily}`;\n        // And also its txt content\n        const text = el.innerText;\n        // Position the pixel cursor at the left of the element\n        let pixelCursor = rect.left;\n        let offset = 0;\n        let step;\n        // If the point is on the right of the box put the cursor after the last character\n        if (x > rect.left + rect.width) {\n            offset = text.length;\n        }\n        else {\n            const charWidthReader = CharWidthReader.getInstance();\n            // Goes through all the characters of the innerText, and checks if the x of the point\n            // belongs to the character.\n            for (let i = 0; i < text.length + 1; i++) {\n                // The step is half the width of the character\n                step = charWidthReader.getCharWidth(text.charAt(i), font) / 2;\n                // Move to the center of the character\n                pixelCursor += step;\n                // If the x of the point is smaller that the position of the cursor, the point is over that character\n                if (x < pixelCursor) {\n                    offset = i;\n                    break;\n                }\n                // Move between the current character and the next\n                pixelCursor += step;\n            }\n        }\n        // Creates a range with the text node of the element and set the offset found\n        range.setStart(el.firstChild, offset);\n        range.setEnd(el.firstChild, offset);\n    }\n    return range;\n}\nclass CharWidthReader {\n    static getInstance() {\n        if (!CharWidthReader._INSTANCE) {\n            CharWidthReader._INSTANCE = new CharWidthReader();\n        }\n        return CharWidthReader._INSTANCE;\n    }\n    constructor() {\n        this._cache = {};\n        this._canvas = document.createElement('canvas');\n    }\n    getCharWidth(char, font) {\n        const cacheKey = char + font;\n        if (this._cache[cacheKey]) {\n            return this._cache[cacheKey];\n        }\n        const context = this._canvas.getContext('2d');\n        context.font = font;\n        const metrics = context.measureText(char);\n        const width = metrics.width;\n        this._cache[cacheKey] = width;\n        return width;\n    }\n}\nCharWidthReader._INSTANCE = null;\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../base/browser/dom.js';\nimport { StandardWheelEvent } from '../../../base/browser/mouseEvent.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport * as platform from '../../../base/common/platform.js';\nimport { HitTestContext, MouseTarget, MouseTargetFactory } from './mouseTarget.js';\nimport { ClientCoordinates, EditorMouseEvent, EditorMouseEventFactory, GlobalEditorPointerMoveMonitor, createEditorPagePosition, createCoordinatesRelativeToEditor, PageCoordinates } from '../editorDom.js';\nimport { EditorZoom } from '../../common/config/editorZoom.js';\nimport { Position } from '../../common/core/position.js';\nimport { Selection } from '../../common/core/selection.js';\nimport { ViewEventHandler } from '../../common/viewEventHandler.js';\nimport { MouseWheelClassifier } from '../../../base/browser/ui/scrollbar/scrollableElement.js';\nexport class MouseHandler extends ViewEventHandler {\n    constructor(context, viewController, viewHelper) {\n        super();\n        this._mouseLeaveMonitor = null;\n        this._context = context;\n        this.viewController = viewController;\n        this.viewHelper = viewHelper;\n        this.mouseTargetFactory = new MouseTargetFactory(this._context, viewHelper);\n        this._mouseDownOperation = this._register(new MouseDownOperation(this._context, this.viewController, this.viewHelper, this.mouseTargetFactory, (e, testEventTarget) => this._createMouseTarget(e, testEventTarget), (e) => this._getMouseColumn(e)));\n        this.lastMouseLeaveTime = -1;\n        this._height = this._context.configuration.options.get(143 /* EditorOption.layoutInfo */).height;\n        const mouseEvents = new EditorMouseEventFactory(this.viewHelper.viewDomNode);\n        this._register(mouseEvents.onContextMenu(this.viewHelper.viewDomNode, (e) => this._onContextMenu(e, true)));\n        this._register(mouseEvents.onMouseMove(this.viewHelper.viewDomNode, (e) => {\n            this._onMouseMove(e);\n            // See https://github.com/microsoft/vscode/issues/138789\n            // When moving the mouse really quickly, the browser sometimes forgets to\n            // send us a `mouseleave` or `mouseout` event. We therefore install here\n            // a global `mousemove` listener to manually recover if the mouse goes outside\n            // the editor. As soon as the mouse leaves outside of the editor, we\n            // remove this listener\n            if (!this._mouseLeaveMonitor) {\n                this._mouseLeaveMonitor = dom.addDisposableListener(this.viewHelper.viewDomNode.ownerDocument, 'mousemove', (e) => {\n                    if (!this.viewHelper.viewDomNode.contains(e.target)) {\n                        // went outside the editor!\n                        this._onMouseLeave(new EditorMouseEvent(e, false, this.viewHelper.viewDomNode));\n                    }\n                });\n            }\n        }));\n        this._register(mouseEvents.onMouseUp(this.viewHelper.viewDomNode, (e) => this._onMouseUp(e)));\n        this._register(mouseEvents.onMouseLeave(this.viewHelper.viewDomNode, (e) => this._onMouseLeave(e)));\n        // `pointerdown` events can't be used to determine if there's a double click, or triple click\n        // because their `e.detail` is always 0.\n        // We will therefore save the pointer id for the mouse and then reuse it in the `mousedown` event\n        // for `element.setPointerCapture`.\n        let capturePointerId = 0;\n        this._register(mouseEvents.onPointerDown(this.viewHelper.viewDomNode, (e, pointerId) => {\n            capturePointerId = pointerId;\n        }));\n        // The `pointerup` listener registered by `GlobalEditorPointerMoveMonitor` does not get invoked 100% of the times.\n        // I speculate that this is because the `pointerup` listener is only registered during the `mousedown` event, and perhaps\n        // the `pointerup` event is already queued for dispatching, which makes it that the new listener doesn't get fired.\n        // See https://github.com/microsoft/vscode/issues/146486 for repro steps.\n        // To compensate for that, we simply register here a `pointerup` listener and just communicate it.\n        this._register(dom.addDisposableListener(this.viewHelper.viewDomNode, dom.EventType.POINTER_UP, (e) => {\n            this._mouseDownOperation.onPointerUp();\n        }));\n        this._register(mouseEvents.onMouseDown(this.viewHelper.viewDomNode, (e) => this._onMouseDown(e, capturePointerId)));\n        this._setupMouseWheelZoomListener();\n        this._context.addEventHandler(this);\n    }\n    _setupMouseWheelZoomListener() {\n        const classifier = MouseWheelClassifier.INSTANCE;\n        let prevMouseWheelTime = 0;\n        let gestureStartZoomLevel = EditorZoom.getZoomLevel();\n        let gestureHasZoomModifiers = false;\n        let gestureAccumulatedDelta = 0;\n        const onMouseWheel = (browserEvent) => {\n            this.viewController.emitMouseWheel(browserEvent);\n            if (!this._context.configuration.options.get(75 /* EditorOption.mouseWheelZoom */)) {\n                return;\n            }\n            const e = new StandardWheelEvent(browserEvent);\n            classifier.acceptStandardWheelEvent(e);\n            if (classifier.isPhysicalMouseWheel()) {\n                if (hasMouseWheelZoomModifiers(browserEvent)) {\n                    const zoomLevel = EditorZoom.getZoomLevel();\n                    const delta = e.deltaY > 0 ? 1 : -1;\n                    EditorZoom.setZoomLevel(zoomLevel + delta);\n                    e.preventDefault();\n                    e.stopPropagation();\n                }\n            }\n            else {\n                // we consider mousewheel events that occur within 50ms of each other to be part of the same gesture\n                // we don't want to consider mouse wheel events where ctrl/cmd is pressed during the inertia phase\n                // we also want to accumulate deltaY values from the same gesture and use that to set the zoom level\n                if (Date.now() - prevMouseWheelTime > 50) {\n                    // reset if more than 50ms have passed\n                    gestureStartZoomLevel = EditorZoom.getZoomLevel();\n                    gestureHasZoomModifiers = hasMouseWheelZoomModifiers(browserEvent);\n                    gestureAccumulatedDelta = 0;\n                }\n                prevMouseWheelTime = Date.now();\n                gestureAccumulatedDelta += e.deltaY;\n                if (gestureHasZoomModifiers) {\n                    EditorZoom.setZoomLevel(gestureStartZoomLevel + gestureAccumulatedDelta / 5);\n                    e.preventDefault();\n                    e.stopPropagation();\n                }\n            }\n        };\n        this._register(dom.addDisposableListener(this.viewHelper.viewDomNode, dom.EventType.MOUSE_WHEEL, onMouseWheel, { capture: true, passive: false }));\n        function hasMouseWheelZoomModifiers(browserEvent) {\n            return (platform.isMacintosh\n                // on macOS we support cmd + two fingers scroll (`metaKey` set)\n                // and also the two fingers pinch gesture (`ctrKey` set)\n                ? ((browserEvent.metaKey || browserEvent.ctrlKey) && !browserEvent.shiftKey && !browserEvent.altKey)\n                : (browserEvent.ctrlKey && !browserEvent.metaKey && !browserEvent.shiftKey && !browserEvent.altKey));\n        }\n    }\n    dispose() {\n        this._context.removeEventHandler(this);\n        if (this._mouseLeaveMonitor) {\n            this._mouseLeaveMonitor.dispose();\n            this._mouseLeaveMonitor = null;\n        }\n        super.dispose();\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        if (e.hasChanged(143 /* EditorOption.layoutInfo */)) {\n            // layout change\n            const height = this._context.configuration.options.get(143 /* EditorOption.layoutInfo */).height;\n            if (this._height !== height) {\n                this._height = height;\n                this._mouseDownOperation.onHeightChanged();\n            }\n        }\n        return false;\n    }\n    onCursorStateChanged(e) {\n        this._mouseDownOperation.onCursorStateChanged(e);\n        return false;\n    }\n    onFocusChanged(e) {\n        return false;\n    }\n    // --- end event handlers\n    getTargetAtClientPoint(clientX, clientY) {\n        const clientPos = new ClientCoordinates(clientX, clientY);\n        const pos = clientPos.toPageCoordinates();\n        const editorPos = createEditorPagePosition(this.viewHelper.viewDomNode);\n        if (pos.y < editorPos.y || pos.y > editorPos.y + editorPos.height || pos.x < editorPos.x || pos.x > editorPos.x + editorPos.width) {\n            return null;\n        }\n        const relativePos = createCoordinatesRelativeToEditor(this.viewHelper.viewDomNode, editorPos, pos);\n        return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(), editorPos, pos, relativePos, null);\n    }\n    _createMouseTarget(e, testEventTarget) {\n        let target = e.target;\n        if (!this.viewHelper.viewDomNode.contains(target)) {\n            const shadowRoot = dom.getShadowRoot(this.viewHelper.viewDomNode);\n            if (shadowRoot) {\n                target = shadowRoot.elementsFromPoint(e.posx, e.posy).find((el) => this.viewHelper.viewDomNode.contains(el));\n            }\n        }\n        return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(), e.editorPos, e.pos, e.relativePos, testEventTarget ? target : null);\n    }\n    _getMouseColumn(e) {\n        return this.mouseTargetFactory.getMouseColumn(e.relativePos);\n    }\n    _onContextMenu(e, testEventTarget) {\n        this.viewController.emitContextMenu({\n            event: e,\n            target: this._createMouseTarget(e, testEventTarget)\n        });\n    }\n    _onMouseMove(e) {\n        const targetIsWidget = this.mouseTargetFactory.mouseTargetIsWidget(e);\n        if (!targetIsWidget) {\n            e.preventDefault();\n        }\n        if (this._mouseDownOperation.isActive()) {\n            // In selection/drag operation\n            return;\n        }\n        const actualMouseMoveTime = e.timestamp;\n        if (actualMouseMoveTime < this.lastMouseLeaveTime) {\n            // Due to throttling, this event occurred before the mouse left the editor, therefore ignore it.\n            return;\n        }\n        this.viewController.emitMouseMove({\n            event: e,\n            target: this._createMouseTarget(e, true)\n        });\n    }\n    _onMouseLeave(e) {\n        if (this._mouseLeaveMonitor) {\n            this._mouseLeaveMonitor.dispose();\n            this._mouseLeaveMonitor = null;\n        }\n        this.lastMouseLeaveTime = (new Date()).getTime();\n        this.viewController.emitMouseLeave({\n            event: e,\n            target: null\n        });\n    }\n    _onMouseUp(e) {\n        this.viewController.emitMouseUp({\n            event: e,\n            target: this._createMouseTarget(e, true)\n        });\n    }\n    _onMouseDown(e, pointerId) {\n        const t = this._createMouseTarget(e, true);\n        const targetIsContent = (t.type === 6 /* MouseTargetType.CONTENT_TEXT */ || t.type === 7 /* MouseTargetType.CONTENT_EMPTY */);\n        const targetIsGutter = (t.type === 2 /* MouseTargetType.GUTTER_GLYPH_MARGIN */ || t.type === 3 /* MouseTargetType.GUTTER_LINE_NUMBERS */ || t.type === 4 /* MouseTargetType.GUTTER_LINE_DECORATIONS */);\n        const targetIsLineNumbers = (t.type === 3 /* MouseTargetType.GUTTER_LINE_NUMBERS */);\n        const selectOnLineNumbers = this._context.configuration.options.get(108 /* EditorOption.selectOnLineNumbers */);\n        const targetIsViewZone = (t.type === 8 /* MouseTargetType.CONTENT_VIEW_ZONE */ || t.type === 5 /* MouseTargetType.GUTTER_VIEW_ZONE */);\n        const targetIsWidget = (t.type === 9 /* MouseTargetType.CONTENT_WIDGET */);\n        let shouldHandle = e.leftButton || e.middleButton;\n        if (platform.isMacintosh && e.leftButton && e.ctrlKey) {\n            shouldHandle = false;\n        }\n        const focus = () => {\n            e.preventDefault();\n            this.viewHelper.focusTextArea();\n        };\n        if (shouldHandle && (targetIsContent || (targetIsLineNumbers && selectOnLineNumbers))) {\n            focus();\n            this._mouseDownOperation.start(t.type, e, pointerId);\n        }\n        else if (targetIsGutter) {\n            // Do not steal focus\n            e.preventDefault();\n        }\n        else if (targetIsViewZone) {\n            const viewZoneData = t.detail;\n            if (shouldHandle && this.viewHelper.shouldSuppressMouseDownOnViewZone(viewZoneData.viewZoneId)) {\n                focus();\n                this._mouseDownOperation.start(t.type, e, pointerId);\n                e.preventDefault();\n            }\n        }\n        else if (targetIsWidget && this.viewHelper.shouldSuppressMouseDownOnWidget(t.detail)) {\n            focus();\n            e.preventDefault();\n        }\n        this.viewController.emitMouseDown({\n            event: e,\n            target: t\n        });\n    }\n}\nclass MouseDownOperation extends Disposable {\n    constructor(_context, _viewController, _viewHelper, _mouseTargetFactory, createMouseTarget, getMouseColumn) {\n        super();\n        this._context = _context;\n        this._viewController = _viewController;\n        this._viewHelper = _viewHelper;\n        this._mouseTargetFactory = _mouseTargetFactory;\n        this._createMouseTarget = createMouseTarget;\n        this._getMouseColumn = getMouseColumn;\n        this._mouseMoveMonitor = this._register(new GlobalEditorPointerMoveMonitor(this._viewHelper.viewDomNode));\n        this._topBottomDragScrolling = this._register(new TopBottomDragScrolling(this._context, this._viewHelper, this._mouseTargetFactory, (position, inSelectionMode, revealType) => this._dispatchMouse(position, inSelectionMode, revealType)));\n        this._mouseState = new MouseDownState();\n        this._currentSelection = new Selection(1, 1, 1, 1);\n        this._isActive = false;\n        this._lastMouseEvent = null;\n    }\n    dispose() {\n        super.dispose();\n    }\n    isActive() {\n        return this._isActive;\n    }\n    _onMouseDownThenMove(e) {\n        this._lastMouseEvent = e;\n        this._mouseState.setModifiers(e);\n        const position = this._findMousePosition(e, false);\n        if (!position) {\n            // Ignoring because position is unknown\n            return;\n        }\n        if (this._mouseState.isDragAndDrop) {\n            this._viewController.emitMouseDrag({\n                event: e,\n                target: position\n            });\n        }\n        else {\n            if (position.type === 13 /* MouseTargetType.OUTSIDE_EDITOR */ && (position.outsidePosition === 'above' || position.outsidePosition === 'below')) {\n                this._topBottomDragScrolling.start(position, e);\n            }\n            else {\n                this._topBottomDragScrolling.stop();\n                this._dispatchMouse(position, true, 1 /* NavigationCommandRevealType.Minimal */);\n            }\n        }\n    }\n    start(targetType, e, pointerId) {\n        this._lastMouseEvent = e;\n        this._mouseState.setStartedOnLineNumbers(targetType === 3 /* MouseTargetType.GUTTER_LINE_NUMBERS */);\n        this._mouseState.setStartButtons(e);\n        this._mouseState.setModifiers(e);\n        const position = this._findMousePosition(e, true);\n        if (!position || !position.position) {\n            // Ignoring because position is unknown\n            return;\n        }\n        this._mouseState.trySetCount(e.detail, position.position);\n        // Overwrite the detail of the MouseEvent, as it will be sent out in an event and contributions might rely on it.\n        e.detail = this._mouseState.count;\n        const options = this._context.configuration.options;\n        if (!options.get(90 /* EditorOption.readOnly */)\n            && options.get(35 /* EditorOption.dragAndDrop */)\n            && !options.get(22 /* EditorOption.columnSelection */)\n            && !this._mouseState.altKey // we don't support multiple mouse\n            && e.detail < 2 // only single click on a selection can work\n            && !this._isActive // the mouse is not down yet\n            && !this._currentSelection.isEmpty() // we don't drag single cursor\n            && (position.type === 6 /* MouseTargetType.CONTENT_TEXT */) // single click on text\n            && position.position && this._currentSelection.containsPosition(position.position) // single click on a selection\n        ) {\n            this._mouseState.isDragAndDrop = true;\n            this._isActive = true;\n            this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode, pointerId, e.buttons, (e) => this._onMouseDownThenMove(e), (browserEvent) => {\n                const position = this._findMousePosition(this._lastMouseEvent, false);\n                if (browserEvent && browserEvent instanceof KeyboardEvent) {\n                    // cancel\n                    this._viewController.emitMouseDropCanceled();\n                }\n                else {\n                    this._viewController.emitMouseDrop({\n                        event: this._lastMouseEvent,\n                        target: (position ? this._createMouseTarget(this._lastMouseEvent, true) : null) // Ignoring because position is unknown, e.g., Content View Zone\n                    });\n                }\n                this._stop();\n            });\n            return;\n        }\n        this._mouseState.isDragAndDrop = false;\n        this._dispatchMouse(position, e.shiftKey, 1 /* NavigationCommandRevealType.Minimal */);\n        if (!this._isActive) {\n            this._isActive = true;\n            this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode, pointerId, e.buttons, (e) => this._onMouseDownThenMove(e), () => this._stop());\n        }\n    }\n    _stop() {\n        this._isActive = false;\n        this._topBottomDragScrolling.stop();\n    }\n    onHeightChanged() {\n        this._mouseMoveMonitor.stopMonitoring();\n    }\n    onPointerUp() {\n        this._mouseMoveMonitor.stopMonitoring();\n    }\n    onCursorStateChanged(e) {\n        this._currentSelection = e.selections[0];\n    }\n    _getPositionOutsideEditor(e) {\n        const editorContent = e.editorPos;\n        const model = this._context.viewModel;\n        const viewLayout = this._context.viewLayout;\n        const mouseColumn = this._getMouseColumn(e);\n        if (e.posy < editorContent.y) {\n            const outsideDistance = editorContent.y - e.posy;\n            const verticalOffset = Math.max(viewLayout.getCurrentScrollTop() - outsideDistance, 0);\n            const viewZoneData = HitTestContext.getZoneAtCoord(this._context, verticalOffset);\n            if (viewZoneData) {\n                const newPosition = this._helpPositionJumpOverViewZone(viewZoneData);\n                if (newPosition) {\n                    return MouseTarget.createOutsideEditor(mouseColumn, newPosition, 'above', outsideDistance);\n                }\n            }\n            const aboveLineNumber = viewLayout.getLineNumberAtVerticalOffset(verticalOffset);\n            return MouseTarget.createOutsideEditor(mouseColumn, new Position(aboveLineNumber, 1), 'above', outsideDistance);\n        }\n        if (e.posy > editorContent.y + editorContent.height) {\n            const outsideDistance = e.posy - editorContent.y - editorContent.height;\n            const verticalOffset = viewLayout.getCurrentScrollTop() + e.relativePos.y;\n            const viewZoneData = HitTestContext.getZoneAtCoord(this._context, verticalOffset);\n            if (viewZoneData) {\n                const newPosition = this._helpPositionJumpOverViewZone(viewZoneData);\n                if (newPosition) {\n                    return MouseTarget.createOutsideEditor(mouseColumn, newPosition, 'below', outsideDistance);\n                }\n            }\n            const belowLineNumber = viewLayout.getLineNumberAtVerticalOffset(verticalOffset);\n            return MouseTarget.createOutsideEditor(mouseColumn, new Position(belowLineNumber, model.getLineMaxColumn(belowLineNumber)), 'below', outsideDistance);\n        }\n        const possibleLineNumber = viewLayout.getLineNumberAtVerticalOffset(viewLayout.getCurrentScrollTop() + e.relativePos.y);\n        if (e.posx < editorContent.x) {\n            const outsideDistance = editorContent.x - e.posx;\n            return MouseTarget.createOutsideEditor(mouseColumn, new Position(possibleLineNumber, 1), 'left', outsideDistance);\n        }\n        if (e.posx > editorContent.x + editorContent.width) {\n            const outsideDistance = e.posx - editorContent.x - editorContent.width;\n            return MouseTarget.createOutsideEditor(mouseColumn, new Position(possibleLineNumber, model.getLineMaxColumn(possibleLineNumber)), 'right', outsideDistance);\n        }\n        return null;\n    }\n    _findMousePosition(e, testEventTarget) {\n        const positionOutsideEditor = this._getPositionOutsideEditor(e);\n        if (positionOutsideEditor) {\n            return positionOutsideEditor;\n        }\n        const t = this._createMouseTarget(e, testEventTarget);\n        const hintedPosition = t.position;\n        if (!hintedPosition) {\n            return null;\n        }\n        if (t.type === 8 /* MouseTargetType.CONTENT_VIEW_ZONE */ || t.type === 5 /* MouseTargetType.GUTTER_VIEW_ZONE */) {\n            const newPosition = this._helpPositionJumpOverViewZone(t.detail);\n            if (newPosition) {\n                return MouseTarget.createViewZone(t.type, t.element, t.mouseColumn, newPosition, t.detail);\n            }\n        }\n        return t;\n    }\n    _helpPositionJumpOverViewZone(viewZoneData) {\n        // Force position on view zones to go above or below depending on where selection started from\n        const selectionStart = new Position(this._currentSelection.selectionStartLineNumber, this._currentSelection.selectionStartColumn);\n        const positionBefore = viewZoneData.positionBefore;\n        const positionAfter = viewZoneData.positionAfter;\n        if (positionBefore && positionAfter) {\n            if (positionBefore.isBefore(selectionStart)) {\n                return positionBefore;\n            }\n            else {\n                return positionAfter;\n            }\n        }\n        return null;\n    }\n    _dispatchMouse(position, inSelectionMode, revealType) {\n        if (!position.position) {\n            return;\n        }\n        this._viewController.dispatchMouse({\n            position: position.position,\n            mouseColumn: position.mouseColumn,\n            startedOnLineNumbers: this._mouseState.startedOnLineNumbers,\n            revealType,\n            inSelectionMode: inSelectionMode,\n            mouseDownCount: this._mouseState.count,\n            altKey: this._mouseState.altKey,\n            ctrlKey: this._mouseState.ctrlKey,\n            metaKey: this._mouseState.metaKey,\n            shiftKey: this._mouseState.shiftKey,\n            leftButton: this._mouseState.leftButton,\n            middleButton: this._mouseState.middleButton,\n            onInjectedText: position.type === 6 /* MouseTargetType.CONTENT_TEXT */ && position.detail.injectedText !== null\n        });\n    }\n}\nclass TopBottomDragScrolling extends Disposable {\n    constructor(_context, _viewHelper, _mouseTargetFactory, _dispatchMouse) {\n        super();\n        this._context = _context;\n        this._viewHelper = _viewHelper;\n        this._mouseTargetFactory = _mouseTargetFactory;\n        this._dispatchMouse = _dispatchMouse;\n        this._operation = null;\n    }\n    dispose() {\n        super.dispose();\n        this.stop();\n    }\n    start(position, mouseEvent) {\n        if (this._operation) {\n            this._operation.setPosition(position, mouseEvent);\n        }\n        else {\n            this._operation = new TopBottomDragScrollingOperation(this._context, this._viewHelper, this._mouseTargetFactory, this._dispatchMouse, position, mouseEvent);\n        }\n    }\n    stop() {\n        if (this._operation) {\n            this._operation.dispose();\n            this._operation = null;\n        }\n    }\n}\nclass TopBottomDragScrollingOperation extends Disposable {\n    constructor(_context, _viewHelper, _mouseTargetFactory, _dispatchMouse, position, mouseEvent) {\n        super();\n        this._context = _context;\n        this._viewHelper = _viewHelper;\n        this._mouseTargetFactory = _mouseTargetFactory;\n        this._dispatchMouse = _dispatchMouse;\n        this._position = position;\n        this._mouseEvent = mouseEvent;\n        this._lastTime = Date.now();\n        this._animationFrameDisposable = dom.scheduleAtNextAnimationFrame(() => this._execute());\n    }\n    dispose() {\n        this._animationFrameDisposable.dispose();\n    }\n    setPosition(position, mouseEvent) {\n        this._position = position;\n        this._mouseEvent = mouseEvent;\n    }\n    /**\n     * update internal state and return elapsed ms since last time\n     */\n    _tick() {\n        const now = Date.now();\n        const elapsed = now - this._lastTime;\n        this._lastTime = now;\n        return elapsed;\n    }\n    /**\n     * get the number of lines per second to auto-scroll\n     */\n    _getScrollSpeed() {\n        const lineHeight = this._context.configuration.options.get(66 /* EditorOption.lineHeight */);\n        const viewportInLines = this._context.configuration.options.get(143 /* EditorOption.layoutInfo */).height / lineHeight;\n        const outsideDistanceInLines = this._position.outsideDistance / lineHeight;\n        if (outsideDistanceInLines <= 1.5) {\n            return Math.max(30, viewportInLines * (1 + outsideDistanceInLines));\n        }\n        if (outsideDistanceInLines <= 3) {\n            return Math.max(60, viewportInLines * (2 + outsideDistanceInLines));\n        }\n        return Math.max(200, viewportInLines * (7 + outsideDistanceInLines));\n    }\n    _execute() {\n        const lineHeight = this._context.configuration.options.get(66 /* EditorOption.lineHeight */);\n        const scrollSpeedInLines = this._getScrollSpeed();\n        const elapsed = this._tick();\n        const scrollInPixels = scrollSpeedInLines * (elapsed / 1000) * lineHeight;\n        const scrollValue = (this._position.outsidePosition === 'above' ? -scrollInPixels : scrollInPixels);\n        this._context.viewModel.viewLayout.deltaScrollNow(0, scrollValue);\n        this._viewHelper.renderNow();\n        const viewportData = this._context.viewLayout.getLinesViewportData();\n        const edgeLineNumber = (this._position.outsidePosition === 'above' ? viewportData.startLineNumber : viewportData.endLineNumber);\n        // First, try to find a position that matches the horizontal position of the mouse\n        let mouseTarget;\n        {\n            const editorPos = createEditorPagePosition(this._viewHelper.viewDomNode);\n            const horizontalScrollbarHeight = this._context.configuration.options.get(143 /* EditorOption.layoutInfo */).horizontalScrollbarHeight;\n            const pos = new PageCoordinates(this._mouseEvent.pos.x, editorPos.y + editorPos.height - horizontalScrollbarHeight - 0.1);\n            const relativePos = createCoordinatesRelativeToEditor(this._viewHelper.viewDomNode, editorPos, pos);\n            mouseTarget = this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(), editorPos, pos, relativePos, null);\n        }\n        if (!mouseTarget.position || mouseTarget.position.lineNumber !== edgeLineNumber) {\n            if (this._position.outsidePosition === 'above') {\n                mouseTarget = MouseTarget.createOutsideEditor(this._position.mouseColumn, new Position(edgeLineNumber, 1), 'above', this._position.outsideDistance);\n            }\n            else {\n                mouseTarget = MouseTarget.createOutsideEditor(this._position.mouseColumn, new Position(edgeLineNumber, this._context.viewModel.getLineMaxColumn(edgeLineNumber)), 'below', this._position.outsideDistance);\n            }\n        }\n        this._dispatchMouse(mouseTarget, true, 2 /* NavigationCommandRevealType.None */);\n        this._animationFrameDisposable = dom.scheduleAtNextAnimationFrame(() => this._execute());\n    }\n}\nclass MouseDownState {\n    get altKey() { return this._altKey; }\n    get ctrlKey() { return this._ctrlKey; }\n    get metaKey() { return this._metaKey; }\n    get shiftKey() { return this._shiftKey; }\n    get leftButton() { return this._leftButton; }\n    get middleButton() { return this._middleButton; }\n    get startedOnLineNumbers() { return this._startedOnLineNumbers; }\n    constructor() {\n        this._altKey = false;\n        this._ctrlKey = false;\n        this._metaKey = false;\n        this._shiftKey = false;\n        this._leftButton = false;\n        this._middleButton = false;\n        this._startedOnLineNumbers = false;\n        this._lastMouseDownPosition = null;\n        this._lastMouseDownPositionEqualCount = 0;\n        this._lastMouseDownCount = 0;\n        this._lastSetMouseDownCountTime = 0;\n        this.isDragAndDrop = false;\n    }\n    get count() {\n        return this._lastMouseDownCount;\n    }\n    setModifiers(source) {\n        this._altKey = source.altKey;\n        this._ctrlKey = source.ctrlKey;\n        this._metaKey = source.metaKey;\n        this._shiftKey = source.shiftKey;\n    }\n    setStartButtons(source) {\n        this._leftButton = source.leftButton;\n        this._middleButton = source.middleButton;\n    }\n    setStartedOnLineNumbers(startedOnLineNumbers) {\n        this._startedOnLineNumbers = startedOnLineNumbers;\n    }\n    trySetCount(setMouseDownCount, newMouseDownPosition) {\n        // a. Invalidate multiple clicking if too much time has passed (will be hit by IE because the detail field of mouse events contains garbage in IE10)\n        const currentTime = (new Date()).getTime();\n        if (currentTime - this._lastSetMouseDownCountTime > MouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME) {\n            setMouseDownCount = 1;\n        }\n        this._lastSetMouseDownCountTime = currentTime;\n        // b. Ensure that we don't jump from single click to triple click in one go (will be hit by IE because the detail field of mouse events contains garbage in IE10)\n        if (setMouseDownCount > this._lastMouseDownCount + 1) {\n            setMouseDownCount = this._lastMouseDownCount + 1;\n        }\n        // c. Invalidate multiple clicking if the logical position is different\n        if (this._lastMouseDownPosition && this._lastMouseDownPosition.equals(newMouseDownPosition)) {\n            this._lastMouseDownPositionEqualCount++;\n        }\n        else {\n            this._lastMouseDownPositionEqualCount = 1;\n        }\n        this._lastMouseDownPosition = newMouseDownPosition;\n        // Finally set the lastMouseDownCount\n        this._lastMouseDownCount = Math.min(setMouseDownCount, this._lastMouseDownPositionEqualCount);\n    }\n}\nMouseDownState.CLEAR_MOUSE_DOWN_COUNT_TIME = 400; // ms\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as dom from '../../../base/browser/dom.js';\nimport * as platform from '../../../base/common/platform.js';\nimport { EventType, Gesture } from '../../../base/browser/touch.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { MouseHandler } from './mouseHandler.js';\nimport { EditorMouseEvent, EditorPointerEventFactory } from '../editorDom.js';\nimport { BrowserFeatures } from '../../../base/browser/canIUse.js';\nimport { TextAreaSyntethicEvents } from './textAreaInput.js';\n/**\n * Currently only tested on iOS 13/ iPadOS.\n */\nexport class PointerEventHandler extends MouseHandler {\n    constructor(context, viewController, viewHelper) {\n        super(context, viewController, viewHelper);\n        this._register(Gesture.addTarget(this.viewHelper.linesContentDomNode));\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, EventType.Tap, (e) => this.onTap(e)));\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, EventType.Change, (e) => this.onChange(e)));\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, EventType.Contextmenu, (e) => this._onContextMenu(new EditorMouseEvent(e, false, this.viewHelper.viewDomNode), false)));\n        this._lastPointerType = 'mouse';\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, 'pointerdown', (e) => {\n            const pointerType = e.pointerType;\n            if (pointerType === 'mouse') {\n                this._lastPointerType = 'mouse';\n                return;\n            }\n            else if (pointerType === 'touch') {\n                this._lastPointerType = 'touch';\n            }\n            else {\n                this._lastPointerType = 'pen';\n            }\n        }));\n        // PonterEvents\n        const pointerEvents = new EditorPointerEventFactory(this.viewHelper.viewDomNode);\n        this._register(pointerEvents.onPointerMove(this.viewHelper.viewDomNode, (e) => this._onMouseMove(e)));\n        this._register(pointerEvents.onPointerUp(this.viewHelper.viewDomNode, (e) => this._onMouseUp(e)));\n        this._register(pointerEvents.onPointerLeave(this.viewHelper.viewDomNode, (e) => this._onMouseLeave(e)));\n        this._register(pointerEvents.onPointerDown(this.viewHelper.viewDomNode, (e, pointerId) => this._onMouseDown(e, pointerId)));\n    }\n    onTap(event) {\n        if (!event.initialTarget || !this.viewHelper.linesContentDomNode.contains(event.initialTarget)) {\n            return;\n        }\n        event.preventDefault();\n        this.viewHelper.focusTextArea();\n        const target = this._createMouseTarget(new EditorMouseEvent(event, false, this.viewHelper.viewDomNode), false);\n        if (target.position) {\n            // this.viewController.moveTo(target.position);\n            this.viewController.dispatchMouse({\n                position: target.position,\n                mouseColumn: target.position.column,\n                startedOnLineNumbers: false,\n                revealType: 1 /* NavigationCommandRevealType.Minimal */,\n                mouseDownCount: event.tapCount,\n                inSelectionMode: false,\n                altKey: false,\n                ctrlKey: false,\n                metaKey: false,\n                shiftKey: false,\n                leftButton: false,\n                middleButton: false,\n                onInjectedText: target.type === 6 /* MouseTargetType.CONTENT_TEXT */ && target.detail.injectedText !== null\n            });\n        }\n    }\n    onChange(e) {\n        if (this._lastPointerType === 'touch') {\n            this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX, -e.translationY);\n        }\n    }\n    _onMouseDown(e, pointerId) {\n        if (e.browserEvent.pointerType === 'touch') {\n            return;\n        }\n        super._onMouseDown(e, pointerId);\n    }\n}\nclass TouchHandler extends MouseHandler {\n    constructor(context, viewController, viewHelper) {\n        super(context, viewController, viewHelper);\n        this._register(Gesture.addTarget(this.viewHelper.linesContentDomNode));\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, EventType.Tap, (e) => this.onTap(e)));\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, EventType.Change, (e) => this.onChange(e)));\n        this._register(dom.addDisposableListener(this.viewHelper.linesContentDomNode, EventType.Contextmenu, (e) => this._onContextMenu(new EditorMouseEvent(e, false, this.viewHelper.viewDomNode), false)));\n    }\n    onTap(event) {\n        event.preventDefault();\n        this.viewHelper.focusTextArea();\n        const target = this._createMouseTarget(new EditorMouseEvent(event, false, this.viewHelper.viewDomNode), false);\n        if (target.position) {\n            // Send the tap event also to the <textarea> (for input purposes)\n            const event = document.createEvent('CustomEvent');\n            event.initEvent(TextAreaSyntethicEvents.Tap, false, true);\n            this.viewHelper.dispatchTextAreaEvent(event);\n            this.viewController.moveTo(target.position, 1 /* NavigationCommandRevealType.Minimal */);\n        }\n    }\n    onChange(e) {\n        this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX, -e.translationY);\n    }\n}\nexport class PointerHandler extends Disposable {\n    constructor(context, viewController, viewHelper) {\n        super();\n        if ((platform.isIOS && BrowserFeatures.pointerEvents)) {\n            this.handler = this._register(new PointerEventHandler(context, viewController, viewHelper));\n        }\n        else if (window.TouchEvent) {\n            this.handler = this._register(new TouchHandler(context, viewController, viewHelper));\n        }\n        else {\n            this.handler = this._register(new MouseHandler(context, viewController, viewHelper));\n        }\n    }\n    getTargetAtClientPoint(clientX, clientY) {\n        return this.handler.getTargetAtClientPoint(clientX, clientY);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport './textAreaHandler.css';\nimport * as nls from '../../../nls.js';\nimport * as browser from '../../../base/browser/browser.js';\nimport { createFastDomNode } from '../../../base/browser/fastDomNode.js';\nimport * as platform from '../../../base/common/platform.js';\nimport * as strings from '../../../base/common/strings.js';\nimport { applyFontInfo } from '../config/domFontInfo.js';\nimport { CopyOptions, TextAreaInput, TextAreaWrapper } from './textAreaInput.js';\nimport { PagedScreenReaderStrategy, TextAreaState, _debugComposition } from './textAreaState.js';\nimport { PartFingerprints, ViewPart } from '../view/viewPart.js';\nimport { LineNumbersOverlay } from '../viewParts/lineNumbers/lineNumbers.js';\nimport { Margin } from '../viewParts/margin/margin.js';\nimport { EditorOptions } from '../../common/config/editorOptions.js';\nimport { getMapForWordSeparators } from '../../common/core/wordCharacterClassifier.js';\nimport { Position } from '../../common/core/position.js';\nimport { Range } from '../../common/core/range.js';\nimport { Selection } from '../../common/core/selection.js';\nimport { MOUSE_CURSOR_TEXT_CSS_CLASS_NAME } from '../../../base/browser/ui/mouseCursor/mouseCursor.js';\nimport { TokenizationRegistry } from '../../common/languages.js';\nimport { Color } from '../../../base/common/color.js';\nimport { IME } from '../../../base/common/ime.js';\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\nclass VisibleTextAreaData {\n    constructor(_context, modelLineNumber, distanceToModelLineStart, widthOfHiddenLineTextBefore, distanceToModelLineEnd) {\n        this._context = _context;\n        this.modelLineNumber = modelLineNumber;\n        this.distanceToModelLineStart = distanceToModelLineStart;\n        this.widthOfHiddenLineTextBefore = widthOfHiddenLineTextBefore;\n        this.distanceToModelLineEnd = distanceToModelLineEnd;\n        this._visibleTextAreaBrand = undefined;\n        this.startPosition = null;\n        this.endPosition = null;\n        this.visibleTextareaStart = null;\n        this.visibleTextareaEnd = null;\n        /**\n         * When doing composition, the currently composed text might be split up into\n         * multiple tokens, then merged again into a single token, etc. Here we attempt\n         * to keep the presentation of the <textarea> stable by using the previous used\n         * style if multiple tokens come into play. This avoids flickering.\n         */\n        this._previousPresentation = null;\n    }\n    prepareRender(visibleRangeProvider) {\n        const startModelPosition = new Position(this.modelLineNumber, this.distanceToModelLineStart + 1);\n        const endModelPosition = new Position(this.modelLineNumber, this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber) - this.distanceToModelLineEnd);\n        this.startPosition = this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(startModelPosition);\n        this.endPosition = this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(endModelPosition);\n        if (this.startPosition.lineNumber === this.endPosition.lineNumber) {\n            this.visibleTextareaStart = visibleRangeProvider.visibleRangeForPosition(this.startPosition);\n            this.visibleTextareaEnd = visibleRangeProvider.visibleRangeForPosition(this.endPosition);\n        }\n        else {\n            // TODO: what if the view positions are not on the same line?\n            this.visibleTextareaStart = null;\n            this.visibleTextareaEnd = null;\n        }\n    }\n    definePresentation(tokenPresentation) {\n        if (!this._previousPresentation) {\n            // To avoid flickering, once set, always reuse a presentation throughout the entire IME session\n            if (tokenPresentation) {\n                this._previousPresentation = tokenPresentation;\n            }\n            else {\n                this._previousPresentation = {\n                    foreground: 1 /* ColorId.DefaultForeground */,\n                    italic: false,\n                    bold: false,\n                    underline: false,\n                    strikethrough: false,\n                };\n            }\n        }\n        return this._previousPresentation;\n    }\n}\nconst canUseZeroSizeTextarea = (browser.isFirefox);\nlet TextAreaHandler = class TextAreaHandler extends ViewPart {\n    constructor(context, viewController, visibleRangeProvider, _keybindingService) {\n        super(context);\n        this._keybindingService = _keybindingService;\n        this._primaryCursorPosition = new Position(1, 1);\n        this._primaryCursorVisibleRange = null;\n        this._viewController = viewController;\n        this._visibleRangeProvider = visibleRangeProvider;\n        this._scrollLeft = 0;\n        this._scrollTop = 0;\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(143 /* EditorOption.layoutInfo */);\n        this._setAccessibilityOptions(options);\n        this._contentLeft = layoutInfo.contentLeft;\n        this._contentWidth = layoutInfo.contentWidth;\n        this._contentHeight = layoutInfo.height;\n        this._fontInfo = options.get(50 /* EditorOption.fontInfo */);\n        this._lineHeight = options.get(66 /* EditorOption.lineHeight */);\n        this._emptySelectionClipboard = options.get(37 /* EditorOption.emptySelectionClipboard */);\n        this._copyWithSyntaxHighlighting = options.get(25 /* EditorOption.copyWithSyntaxHighlighting */);\n        this._visibleTextArea = null;\n        this._selections = [new Selection(1, 1, 1, 1)];\n        this._modelSelections = [new Selection(1, 1, 1, 1)];\n        this._lastRenderPosition = null;\n        // Text Area (The focus will always be in the textarea when the cursor is blinking)\n        this.textArea = createFastDomNode(document.createElement('textarea'));\n        PartFingerprints.write(this.textArea, 6 /* PartFingerprint.TextArea */);\n        this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`);\n        this.textArea.setAttribute('wrap', this._textAreaWrapping && !this._visibleTextArea ? 'on' : 'off');\n        const { tabSize } = this._context.viewModel.model.getOptions();\n        this.textArea.domNode.style.tabSize = `${tabSize * this._fontInfo.spaceWidth}px`;\n        this.textArea.setAttribute('autocorrect', 'off');\n        this.textArea.setAttribute('autocapitalize', 'off');\n        this.textArea.setAttribute('autocomplete', 'off');\n        this.textArea.setAttribute('spellcheck', 'false');\n        this.textArea.setAttribute('aria-label', this._getAriaLabel(options));\n        this.textArea.setAttribute('aria-required', options.get(5 /* EditorOption.ariaRequired */) ? 'true' : 'false');\n        this.textArea.setAttribute('tabindex', String(options.get(123 /* EditorOption.tabIndex */)));\n        this.textArea.setAttribute('role', 'textbox');\n        this.textArea.setAttribute('aria-roledescription', nls.localize('editor', \"editor\"));\n        this.textArea.setAttribute('aria-multiline', 'true');\n        this.textArea.setAttribute('aria-autocomplete', options.get(90 /* EditorOption.readOnly */) ? 'none' : 'both');\n        this._ensureReadOnlyAttribute();\n        this.textAreaCover = createFastDomNode(document.createElement('div'));\n        this.textAreaCover.setPosition('absolute');\n        const simpleModel = {\n            getLineCount: () => {\n                return this._context.viewModel.getLineCount();\n            },\n            getLineMaxColumn: (lineNumber) => {\n                return this._context.viewModel.getLineMaxColumn(lineNumber);\n            },\n            getValueInRange: (range, eol) => {\n                return this._context.viewModel.getValueInRange(range, eol);\n            },\n            getValueLengthInRange: (range, eol) => {\n                return this._context.viewModel.getValueLengthInRange(range, eol);\n            },\n            modifyPosition: (position, offset) => {\n                return this._context.viewModel.modifyPosition(position, offset);\n            }\n        };\n        const textAreaInputHost = {\n            getDataToCopy: () => {\n                const rawTextToCopy = this._context.viewModel.getPlainTextToCopy(this._modelSelections, this._emptySelectionClipboard, platform.isWindows);\n                const newLineCharacter = this._context.viewModel.model.getEOL();\n                const isFromEmptySelection = (this._emptySelectionClipboard && this._modelSelections.length === 1 && this._modelSelections[0].isEmpty());\n                const multicursorText = (Array.isArray(rawTextToCopy) ? rawTextToCopy : null);\n                const text = (Array.isArray(rawTextToCopy) ? rawTextToCopy.join(newLineCharacter) : rawTextToCopy);\n                let html = undefined;\n                let mode = null;\n                if (CopyOptions.forceCopyWithSyntaxHighlighting || (this._copyWithSyntaxHighlighting && text.length < 65536)) {\n                    const richText = this._context.viewModel.getRichTextToCopy(this._modelSelections, this._emptySelectionClipboard);\n                    if (richText) {\n                        html = richText.html;\n                        mode = richText.mode;\n                    }\n                }\n                return {\n                    isFromEmptySelection,\n                    multicursorText,\n                    text,\n                    html,\n                    mode\n                };\n            },\n            getScreenReaderContent: () => {\n                if (this._accessibilitySupport === 1 /* AccessibilitySupport.Disabled */) {\n                    // We know for a fact that a screen reader is not attached\n                    // On OSX, we write the character before the cursor to allow for \"long-press\" composition\n                    // Also on OSX, we write the word before the cursor to allow for the Accessibility Keyboard to give good hints\n                    const selection = this._selections[0];\n                    if (platform.isMacintosh && selection.isEmpty()) {\n                        const position = selection.getStartPosition();\n                        let textBefore = this._getWordBeforePosition(position);\n                        if (textBefore.length === 0) {\n                            textBefore = this._getCharacterBeforePosition(position);\n                        }\n                        if (textBefore.length > 0) {\n                            return new TextAreaState(textBefore, textBefore.length, textBefore.length, Range.fromPositions(position), 0);\n                        }\n                    }\n                    // on macOS, write current selection into textarea will allow system text services pick selected text,\n                    // but we still want to limit the amount of text given Chromium handles very poorly text even of a few\n                    // thousand chars\n                    // (https://github.com/microsoft/vscode/issues/27799)\n                    const LIMIT_CHARS = 500;\n                    if (platform.isMacintosh && !selection.isEmpty() && simpleModel.getValueLengthInRange(selection, 0 /* EndOfLinePreference.TextDefined */) < LIMIT_CHARS) {\n                        const text = simpleModel.getValueInRange(selection, 0 /* EndOfLinePreference.TextDefined */);\n                        return new TextAreaState(text, 0, text.length, selection, 0);\n                    }\n                    // on Safari, document.execCommand('cut') and document.execCommand('copy') will just not work\n                    // if the textarea has no content selected. So if there is an editor selection, ensure something\n                    // is selected in the textarea.\n                    if (browser.isSafari && !selection.isEmpty()) {\n                        const placeholderText = 'vscode-placeholder';\n                        return new TextAreaState(placeholderText, 0, placeholderText.length, null, undefined);\n                    }\n                    return TextAreaState.EMPTY;\n                }\n                if (browser.isAndroid) {\n                    // when tapping in the editor on a word, Android enters composition mode.\n                    // in the `compositionstart` event we cannot clear the textarea, because\n                    // it then forgets to ever send a `compositionend`.\n                    // we therefore only write the current word in the textarea\n                    const selection = this._selections[0];\n                    if (selection.isEmpty()) {\n                        const position = selection.getStartPosition();\n                        const [wordAtPosition, positionOffsetInWord] = this._getAndroidWordAtPosition(position);\n                        if (wordAtPosition.length > 0) {\n                            return new TextAreaState(wordAtPosition, positionOffsetInWord, positionOffsetInWord, Range.fromPositions(position), 0);\n                        }\n                    }\n                    return TextAreaState.EMPTY;\n                }\n                return PagedScreenReaderStrategy.fromEditorSelection(simpleModel, this._selections[0], this._accessibilityPageSize, this._accessibilitySupport === 0 /* AccessibilitySupport.Unknown */);\n            },\n            deduceModelPosition: (viewAnchorPosition, deltaOffset, lineFeedCnt) => {\n                return this._context.viewModel.deduceModelPositionRelativeToViewPosition(viewAnchorPosition, deltaOffset, lineFeedCnt);\n            }\n        };\n        const textAreaWrapper = this._register(new TextAreaWrapper(this.textArea.domNode));\n        this._textAreaInput = this._register(new TextAreaInput(textAreaInputHost, textAreaWrapper, platform.OS, {\n            isAndroid: browser.isAndroid,\n            isChrome: browser.isChrome,\n            isFirefox: browser.isFirefox,\n            isSafari: browser.isSafari,\n        }));\n        this._register(this._textAreaInput.onKeyDown((e) => {\n            this._viewController.emitKeyDown(e);\n        }));\n        this._register(this._textAreaInput.onKeyUp((e) => {\n            this._viewController.emitKeyUp(e);\n        }));\n        this._register(this._textAreaInput.onPaste((e) => {\n            let pasteOnNewLine = false;\n            let multicursorText = null;\n            let mode = null;\n            if (e.metadata) {\n                pasteOnNewLine = (this._emptySelectionClipboard && !!e.metadata.isFromEmptySelection);\n                multicursorText = (typeof e.metadata.multicursorText !== 'undefined' ? e.metadata.multicursorText : null);\n                mode = e.metadata.mode;\n            }\n            this._viewController.paste(e.text, pasteOnNewLine, multicursorText, mode);\n        }));\n        this._register(this._textAreaInput.onCut(() => {\n            this._viewController.cut();\n        }));\n        this._register(this._textAreaInput.onType((e) => {\n            if (e.replacePrevCharCnt || e.replaceNextCharCnt || e.positionDelta) {\n                // must be handled through the new command\n                if (_debugComposition) {\n                    console.log(` => compositionType: <<${e.text}>>, ${e.replacePrevCharCnt}, ${e.replaceNextCharCnt}, ${e.positionDelta}`);\n                }\n                this._viewController.compositionType(e.text, e.replacePrevCharCnt, e.replaceNextCharCnt, e.positionDelta);\n            }\n            else {\n                if (_debugComposition) {\n                    console.log(` => type: <<${e.text}>>`);\n                }\n                this._viewController.type(e.text);\n            }\n        }));\n        this._register(this._textAreaInput.onSelectionChangeRequest((modelSelection) => {\n            this._viewController.setSelection(modelSelection);\n        }));\n        this._register(this._textAreaInput.onCompositionStart((e) => {\n            // The textarea might contain some content when composition starts.\n            //\n            // When we make the textarea visible, it always has a height of 1 line,\n            // so we don't need to worry too much about content on lines above or below\n            // the selection.\n            //\n            // However, the text on the current line needs to be made visible because\n            // some IME methods allow to move to other glyphs on the current line\n            // (by pressing arrow keys).\n            //\n            // (1) The textarea might contain only some parts of the current line,\n            // like the word before the selection. Also, the content inside the textarea\n            // can grow or shrink as composition occurs. We therefore anchor the textarea\n            // in terms of distance to a certain line start and line end.\n            //\n            // (2) Also, we should not make \\t characters visible, because their rendering\n            // inside the <textarea> will not align nicely with our rendering. We therefore\n            // will hide (if necessary) some of the leading text on the current line.\n            const ta = this.textArea.domNode;\n            const modelSelection = this._modelSelections[0];\n            const { distanceToModelLineStart, widthOfHiddenTextBefore } = (() => {\n                // Find the text that is on the current line before the selection\n                const textBeforeSelection = ta.value.substring(0, Math.min(ta.selectionStart, ta.selectionEnd));\n                const lineFeedOffset1 = textBeforeSelection.lastIndexOf('\\n');\n                const lineTextBeforeSelection = textBeforeSelection.substring(lineFeedOffset1 + 1);\n                // We now search to see if we should hide some part of it (if it contains \\t)\n                const tabOffset1 = lineTextBeforeSelection.lastIndexOf('\\t');\n                const desiredVisibleBeforeCharCount = lineTextBeforeSelection.length - tabOffset1 - 1;\n                const startModelPosition = modelSelection.getStartPosition();\n                const visibleBeforeCharCount = Math.min(startModelPosition.column - 1, desiredVisibleBeforeCharCount);\n                const distanceToModelLineStart = startModelPosition.column - 1 - visibleBeforeCharCount;\n                const hiddenLineTextBefore = lineTextBeforeSelection.substring(0, lineTextBeforeSelection.length - visibleBeforeCharCount);\n                const { tabSize } = this._context.viewModel.model.getOptions();\n                const widthOfHiddenTextBefore = measureText(this.textArea.domNode.ownerDocument, hiddenLineTextBefore, this._fontInfo, tabSize);\n                return { distanceToModelLineStart, widthOfHiddenTextBefore };\n            })();\n            const { distanceToModelLineEnd } = (() => {\n                // Find the text that is on the current line after the selection\n                const textAfterSelection = ta.value.substring(Math.max(ta.selectionStart, ta.selectionEnd));\n                const lineFeedOffset2 = textAfterSelection.indexOf('\\n');\n                const lineTextAfterSelection = lineFeedOffset2 === -1 ? textAfterSelection : textAfterSelection.substring(0, lineFeedOffset2);\n                const tabOffset2 = lineTextAfterSelection.indexOf('\\t');\n                const desiredVisibleAfterCharCount = (tabOffset2 === -1 ? lineTextAfterSelection.length : lineTextAfterSelection.length - tabOffset2 - 1);\n                const endModelPosition = modelSelection.getEndPosition();\n                const visibleAfterCharCount = Math.min(this._context.viewModel.model.getLineMaxColumn(endModelPosition.lineNumber) - endModelPosition.column, desiredVisibleAfterCharCount);\n                const distanceToModelLineEnd = this._context.viewModel.model.getLineMaxColumn(endModelPosition.lineNumber) - endModelPosition.column - visibleAfterCharCount;\n                return { distanceToModelLineEnd };\n            })();\n            // Scroll to reveal the location in the editor where composition occurs\n            this._context.viewModel.revealRange('keyboard', true, Range.fromPositions(this._selections[0].getStartPosition()), 0 /* viewEvents.VerticalRevealType.Simple */, 1 /* ScrollType.Immediate */);\n            this._visibleTextArea = new VisibleTextAreaData(this._context, modelSelection.startLineNumber, distanceToModelLineStart, widthOfHiddenTextBefore, distanceToModelLineEnd);\n            // We turn off wrapping if the <textarea> becomes visible for composition\n            this.textArea.setAttribute('wrap', this._textAreaWrapping && !this._visibleTextArea ? 'on' : 'off');\n            this._visibleTextArea.prepareRender(this._visibleRangeProvider);\n            this._render();\n            // Show the textarea\n            this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME} ime-input`);\n            this._viewController.compositionStart();\n            this._context.viewModel.onCompositionStart();\n        }));\n        this._register(this._textAreaInput.onCompositionUpdate((e) => {\n            if (!this._visibleTextArea) {\n                return;\n            }\n            this._visibleTextArea.prepareRender(this._visibleRangeProvider);\n            this._render();\n        }));\n        this._register(this._textAreaInput.onCompositionEnd(() => {\n            this._visibleTextArea = null;\n            // We turn on wrapping as necessary if the <textarea> hides after composition\n            this.textArea.setAttribute('wrap', this._textAreaWrapping && !this._visibleTextArea ? 'on' : 'off');\n            this._render();\n            this.textArea.setClassName(`inputarea ${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`);\n            this._viewController.compositionEnd();\n            this._context.viewModel.onCompositionEnd();\n        }));\n        this._register(this._textAreaInput.onFocus(() => {\n            this._context.viewModel.setHasFocus(true);\n        }));\n        this._register(this._textAreaInput.onBlur(() => {\n            this._context.viewModel.setHasFocus(false);\n        }));\n        this._register(IME.onDidChange(() => {\n            this._ensureReadOnlyAttribute();\n        }));\n    }\n    writeScreenReaderContent(reason) {\n        this._textAreaInput.writeScreenReaderContent(reason);\n    }\n    dispose() {\n        super.dispose();\n    }\n    _getAndroidWordAtPosition(position) {\n        const ANDROID_WORD_SEPARATORS = '`~!@#$%^&*()-=+[{]}\\\\|;:\",.<>/?';\n        const lineContent = this._context.viewModel.getLineContent(position.lineNumber);\n        const wordSeparators = getMapForWordSeparators(ANDROID_WORD_SEPARATORS);\n        let goingLeft = true;\n        let startColumn = position.column;\n        let goingRight = true;\n        let endColumn = position.column;\n        let distance = 0;\n        while (distance < 50 && (goingLeft || goingRight)) {\n            if (goingLeft && startColumn <= 1) {\n                goingLeft = false;\n            }\n            if (goingLeft) {\n                const charCode = lineContent.charCodeAt(startColumn - 2);\n                const charClass = wordSeparators.get(charCode);\n                if (charClass !== 0 /* WordCharacterClass.Regular */) {\n                    goingLeft = false;\n                }\n                else {\n                    startColumn--;\n                }\n            }\n            if (goingRight && endColumn > lineContent.length) {\n                goingRight = false;\n            }\n            if (goingRight) {\n                const charCode = lineContent.charCodeAt(endColumn - 1);\n                const charClass = wordSeparators.get(charCode);\n                if (charClass !== 0 /* WordCharacterClass.Regular */) {\n                    goingRight = false;\n                }\n                else {\n                    endColumn++;\n                }\n            }\n            distance++;\n        }\n        return [lineContent.substring(startColumn - 1, endColumn - 1), position.column - startColumn];\n    }\n    _getWordBeforePosition(position) {\n        const lineContent = this._context.viewModel.getLineContent(position.lineNumber);\n        const wordSeparators = getMapForWordSeparators(this._context.configuration.options.get(129 /* EditorOption.wordSeparators */));\n        let column = position.column;\n        let distance = 0;\n        while (column > 1) {\n            const charCode = lineContent.charCodeAt(column - 2);\n            const charClass = wordSeparators.get(charCode);\n            if (charClass !== 0 /* WordCharacterClass.Regular */ || distance > 50) {\n                return lineContent.substring(column - 1, position.column - 1);\n            }\n            distance++;\n            column--;\n        }\n        return lineContent.substring(0, position.column - 1);\n    }\n    _getCharacterBeforePosition(position) {\n        if (position.column > 1) {\n            const lineContent = this._context.viewModel.getLineContent(position.lineNumber);\n            const charBefore = lineContent.charAt(position.column - 2);\n            if (!strings.isHighSurrogate(charBefore.charCodeAt(0))) {\n                return charBefore;\n            }\n        }\n        return '';\n    }\n    _getAriaLabel(options) {\n        var _a, _b, _c;\n        const accessibilitySupport = options.get(2 /* EditorOption.accessibilitySupport */);\n        if (accessibilitySupport === 1 /* AccessibilitySupport.Disabled */) {\n            const toggleKeybindingLabel = (_a = this._keybindingService.lookupKeybinding('editor.action.toggleScreenReaderAccessibilityMode')) === null || _a === void 0 ? void 0 : _a.getAriaLabel();\n            const runCommandKeybindingLabel = (_b = this._keybindingService.lookupKeybinding('workbench.action.showCommands')) === null || _b === void 0 ? void 0 : _b.getAriaLabel();\n            const keybindingEditorKeybindingLabel = (_c = this._keybindingService.lookupKeybinding('workbench.action.openGlobalKeybindings')) === null || _c === void 0 ? void 0 : _c.getAriaLabel();\n            const editorNotAccessibleMessage = nls.localize('accessibilityModeOff', \"The editor is not accessible at this time.\");\n            if (toggleKeybindingLabel) {\n                return nls.localize('accessibilityOffAriaLabel', \"{0} To enable screen reader optimized mode, use {1}\", editorNotAccessibleMessage, toggleKeybindingLabel);\n            }\n            else if (runCommandKeybindingLabel) {\n                return nls.localize('accessibilityOffAriaLabelNoKb', \"{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.\", editorNotAccessibleMessage, runCommandKeybindingLabel);\n            }\n            else if (keybindingEditorKeybindingLabel) {\n                return nls.localize('accessibilityOffAriaLabelNoKbs', \"{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.\", editorNotAccessibleMessage, keybindingEditorKeybindingLabel);\n            }\n            else {\n                // SOS\n                return editorNotAccessibleMessage;\n            }\n        }\n        return options.get(4 /* EditorOption.ariaLabel */);\n    }\n    _setAccessibilityOptions(options) {\n        this._accessibilitySupport = options.get(2 /* EditorOption.accessibilitySupport */);\n        const accessibilityPageSize = options.get(3 /* EditorOption.accessibilityPageSize */);\n        if (this._accessibilitySupport === 2 /* AccessibilitySupport.Enabled */ && accessibilityPageSize === EditorOptions.accessibilityPageSize.defaultValue) {\n            // If a screen reader is attached and the default value is not set we should automatically increase the page size to 500 for a better experience\n            this._accessibilityPageSize = 500;\n        }\n        else {\n            this._accessibilityPageSize = accessibilityPageSize;\n        }\n        // When wrapping is enabled and a screen reader might be attached,\n        // we will size the textarea to match the width used for wrapping points computation (see `domLineBreaksComputer.ts`).\n        // This is because screen readers will read the text in the textarea and we'd like that the\n        // wrapping points in the textarea match the wrapping points in the editor.\n        const layoutInfo = options.get(143 /* EditorOption.layoutInfo */);\n        const wrappingColumn = layoutInfo.wrappingColumn;\n        if (wrappingColumn !== -1 && this._accessibilitySupport !== 1 /* AccessibilitySupport.Disabled */) {\n            const fontInfo = options.get(50 /* EditorOption.fontInfo */);\n            this._textAreaWrapping = true;\n            this._textAreaWidth = Math.round(wrappingColumn * fontInfo.typicalHalfwidthCharacterWidth);\n        }\n        else {\n            this._textAreaWrapping = false;\n            this._textAreaWidth = (canUseZeroSizeTextarea ? 0 : 1);\n        }\n    }\n    // --- begin event handlers\n    onConfigurationChanged(e) {\n        const options = this._context.configuration.options;\n        const layoutInfo = options.get(143 /* EditorOption.layoutInfo */);\n        this._setAccessibilityOptions(options);\n        this._contentLeft = layoutInfo.contentLeft;\n        this._contentWidth = layoutInfo.contentWidth;\n        this._contentHeight = layoutInfo.height;\n        this._fontInfo = options.get(50 /* EditorOption.fontInfo */);\n        this._lineHeight = options.get(66 /* EditorOption.lineHeight */);\n        this._emptySelectionClipboard = options.get(37 /* EditorOption.emptySelectionClipboard */);\n        this._copyWithSyntaxHighlighting = options.get(25 /* EditorOption.copyWithSyntaxHighlighting */);\n        this.textArea.setAttribute('wrap', this._textAreaWrapping && !this._visibleTextArea ? 'on' : 'off');\n        const { tabSize } = this._context.viewModel.model.getOptions();\n        this.textArea.domNode.style.tabSize = `${tabSize * this._fontInfo.spaceWidth}px`;\n        this.textArea.setAttribute('aria-label', this._getAriaLabel(options));\n        this.textArea.setAttribute('aria-required', options.get(5 /* EditorOption.ariaRequired */) ? 'true' : 'false');\n        this.textArea.setAttribute('tabindex', String(options.get(123 /* EditorOption.tabIndex */)));\n        if (e.hasChanged(34 /* EditorOption.domReadOnly */) || e.hasChanged(90 /* EditorOption.readOnly */)) {\n            this._ensureReadOnlyAttribute();\n        }\n        if (e.hasChanged(2 /* EditorOption.accessibilitySupport */)) {\n            this._textAreaInput.writeScreenReaderContent('strategy changed');\n        }\n        return true;\n    }\n    onCursorStateChanged(e) {\n        this._selections = e.selections.slice(0);\n        this._modelSelections = e.modelSelections.slice(0);\n        // We must update the <textarea> synchronously, otherwise long press IME on macos breaks.\n        // See https://github.com/microsoft/vscode/issues/165821\n        this._textAreaInput.writeScreenReaderContent('selection changed');\n        return true;\n    }\n    onDecorationsChanged(e) {\n        // true for inline decorations that can end up relayouting text\n        return true;\n    }\n    onFlushed(e) {\n        return true;\n    }\n    onLinesChanged(e) {\n        return true;\n    }\n    onLinesDeleted(e) {\n        return true;\n    }\n    onLinesInserted(e) {\n        return true;\n    }\n    onScrollChanged(e) {\n        this._scrollLeft = e.scrollLeft;\n        this._scrollTop = e.scrollTop;\n        return true;\n    }\n    onZonesChanged(e) {\n        return true;\n    }\n    // --- end event handlers\n    // --- begin view API\n    isFocused() {\n        return this._textAreaInput.isFocused();\n    }\n    focusTextArea() {\n        this._textAreaInput.focusTextArea();\n    }\n    getLastRenderData() {\n        return this._lastRenderPosition;\n    }\n    setAriaOptions(options) {\n        if (options.activeDescendant) {\n            this.textArea.setAttribute('aria-haspopup', 'true');\n            this.textArea.setAttribute('aria-autocomplete', 'list');\n            this.textArea.setAttribute('aria-activedescendant', options.activeDescendant);\n        }\n        else {\n            this.textArea.setAttribute('aria-haspopup', 'false');\n            this.textArea.setAttribute('aria-autocomplete', 'both');\n            this.textArea.removeAttribute('aria-activedescendant');\n        }\n        if (options.role) {\n            this.textArea.setAttribute('role', options.role);\n        }\n    }\n    // --- end view API\n    _ensureReadOnlyAttribute() {\n        const options = this._context.configuration.options;\n        // When someone requests to disable IME, we set the \"readonly\" attribute on the <textarea>.\n        // This will prevent composition.\n        const useReadOnly = !IME.enabled || (options.get(34 /* EditorOption.domReadOnly */) && options.get(90 /* EditorOption.readOnly */));\n        if (useReadOnly) {\n            this.textArea.setAttribute('readonly', 'true');\n        }\n        else {\n            this.textArea.removeAttribute('readonly');\n        }\n    }\n    prepareRender(ctx) {\n        var _a;\n        this._primaryCursorPosition = new Position(this._selections[0].positionLineNumber, this._selections[0].positionColumn);\n        this._primaryCursorVisibleRange = ctx.visibleRangeForPosition(this._primaryCursorPosition);\n        (_a = this._visibleTextArea) === null || _a === void 0 ? void 0 : _a.prepareRender(ctx);\n    }\n    render(ctx) {\n        this._textAreaInput.writeScreenReaderContent('render');\n        this._render();\n    }\n    _render() {\n        var _a;\n        if (this._visibleTextArea) {\n            // The text area is visible for composition reasons\n            const visibleStart = this._visibleTextArea.visibleTextareaStart;\n            const visibleEnd = this._visibleTextArea.visibleTextareaEnd;\n            const startPosition = this._visibleTextArea.startPosition;\n            const endPosition = this._visibleTextArea.endPosition;\n            if (startPosition && endPosition && visibleStart && visibleEnd && visibleEnd.left >= this._scrollLeft && visibleStart.left <= this._scrollLeft + this._contentWidth) {\n                const top = (this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber) - this._scrollTop);\n                const lineCount = this._newlinecount(this.textArea.domNode.value.substr(0, this.textArea.domNode.selectionStart));\n                let scrollLeft = this._visibleTextArea.widthOfHiddenLineTextBefore;\n                let left = (this._contentLeft + visibleStart.left - this._scrollLeft);\n                // See https://github.com/microsoft/vscode/issues/141725#issuecomment-1050670841\n                // Here we are adding +1 to avoid flickering that might be caused by having a width that is too small.\n                // This could be caused by rounding errors that might only show up with certain font families.\n                // In other words, a pixel might be lost when doing something like\n                //      `Math.round(end) - Math.round(start)`\n                // vs\n                //      `Math.round(end - start)`\n                let width = visibleEnd.left - visibleStart.left + 1;\n                if (left < this._contentLeft) {\n                    // the textarea would be rendered on top of the margin,\n                    // so reduce its width. We use the same technique as\n                    // for hiding text before\n                    const delta = (this._contentLeft - left);\n                    left += delta;\n                    scrollLeft += delta;\n                    width -= delta;\n                }\n                if (width > this._contentWidth) {\n                    // the textarea would be wider than the content width,\n                    // so reduce its width.\n                    width = this._contentWidth;\n                }\n                // Try to render the textarea with the color/font style to match the text under it\n                const viewLineData = this._context.viewModel.getViewLineData(startPosition.lineNumber);\n                const startTokenIndex = viewLineData.tokens.findTokenIndexAtOffset(startPosition.column - 1);\n                const endTokenIndex = viewLineData.tokens.findTokenIndexAtOffset(endPosition.column - 1);\n                const textareaSpansSingleToken = (startTokenIndex === endTokenIndex);\n                const presentation = this._visibleTextArea.definePresentation((textareaSpansSingleToken ? viewLineData.tokens.getPresentation(startTokenIndex) : null));\n                this.textArea.domNode.scrollTop = lineCount * this._lineHeight;\n                this.textArea.domNode.scrollLeft = scrollLeft;\n                this._doRender({\n                    lastRenderPosition: null,\n                    top: top,\n                    left: left,\n                    width: width,\n                    height: this._lineHeight,\n                    useCover: false,\n                    color: (TokenizationRegistry.getColorMap() || [])[presentation.foreground],\n                    italic: presentation.italic,\n                    bold: presentation.bold,\n                    underline: presentation.underline,\n                    strikethrough: presentation.strikethrough\n                });\n            }\n            return;\n        }\n        if (!this._primaryCursorVisibleRange) {\n            // The primary cursor is outside the viewport => place textarea to the top left\n            this._renderAtTopLeft();\n            return;\n        }\n        const left = this._contentLeft + this._primaryCursorVisibleRange.left - this._scrollLeft;\n        if (left < this._contentLeft || left > this._contentLeft + this._contentWidth) {\n            // cursor is outside the viewport\n            this._renderAtTopLeft();\n            return;\n        }\n        const top = this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber) - this._scrollTop;\n        if (top < 0 || top > this._contentHeight) {\n            // cursor is outside the viewport\n            this._renderAtTopLeft();\n            return;\n        }\n        // The primary cursor is in the viewport (at least vertically) => place textarea on the cursor\n        if (platform.isMacintosh) {\n            // For the popup emoji input, we will make the text area as high as the line height\n            // We will also make the fontSize and lineHeight the correct dimensions to help with the placement of these pickers\n            this._doRender({\n                lastRenderPosition: this._primaryCursorPosition,\n                top,\n                left: this._textAreaWrapping ? this._contentLeft : left,\n                width: this._textAreaWidth,\n                height: this._lineHeight,\n                useCover: false\n            });\n            // In case the textarea contains a word, we're going to try to align the textarea's cursor\n            // with our cursor by scrolling the textarea as much as possible\n            this.textArea.domNode.scrollLeft = this._primaryCursorVisibleRange.left;\n            const lineCount = (_a = this._textAreaInput.textAreaState.newlineCountBeforeSelection) !== null && _a !== void 0 ? _a : this._newlinecount(this.textArea.domNode.value.substr(0, this.textArea.domNode.selectionStart));\n            this.textArea.domNode.scrollTop = lineCount * this._lineHeight;\n            return;\n        }\n        this._doRender({\n            lastRenderPosition: this._primaryCursorPosition,\n            top: top,\n            left: this._textAreaWrapping ? this._contentLeft : left,\n            width: this._textAreaWidth,\n            height: (canUseZeroSizeTextarea ? 0 : 1),\n            useCover: false\n        });\n    }\n    _newlinecount(text) {\n        let result = 0;\n        let startIndex = -1;\n        do {\n            startIndex = text.indexOf('\\n', startIndex + 1);\n            if (startIndex === -1) {\n                break;\n            }\n            result++;\n        } while (true);\n        return result;\n    }\n    _renderAtTopLeft() {\n        // (in WebKit the textarea is 1px by 1px because it cannot handle input to a 0x0 textarea)\n        // specifically, when doing Korean IME, setting the textarea to 0x0 breaks IME badly.\n        this._doRender({\n            lastRenderPosition: null,\n            top: 0,\n            left: 0,\n            width: this._textAreaWidth,\n            height: (canUseZeroSizeTextarea ? 0 : 1),\n            useCover: true\n        });\n    }\n    _doRender(renderData) {\n        this._lastRenderPosition = renderData.lastRenderPosition;\n        const ta = this.textArea;\n        const tac = this.textAreaCover;\n        applyFontInfo(ta, this._fontInfo);\n        ta.setTop(renderData.top);\n        ta.setLeft(renderData.left);\n        ta.setWidth(renderData.width);\n        ta.setHeight(renderData.height);\n        ta.setColor(renderData.color ? Color.Format.CSS.formatHex(renderData.color) : '');\n        ta.setFontStyle(renderData.italic ? 'italic' : '');\n        if (renderData.bold) {\n            // fontWeight is also set by `applyFontInfo`, so only overwrite it if necessary\n            ta.setFontWeight('bold');\n        }\n        ta.setTextDecoration(`${renderData.underline ? ' underline' : ''}${renderData.strikethrough ? ' line-through' : ''}`);\n        tac.setTop(renderData.useCover ? renderData.top : 0);\n        tac.setLeft(renderData.useCover ? renderData.left : 0);\n        tac.setWidth(renderData.useCover ? renderData.width : 0);\n        tac.setHeight(renderData.useCover ? renderData.height : 0);\n        const options = this._context.configuration.options;\n        if (options.get(57 /* EditorOption.glyphMargin */)) {\n            tac.setClassName('monaco-editor-background textAreaCover ' + Margin.OUTER_CLASS_NAME);\n        }\n        else {\n            if (options.get(67 /* EditorOption.lineNumbers */).renderType !== 0 /* RenderLineNumbersType.Off */) {\n                tac.setClassName('monaco-editor-background textAreaCover ' + LineNumbersOverlay.CLASS_NAME);\n            }\n            else {\n                tac.setClassName('monaco-editor-background textAreaCover');\n            }\n        }\n    }\n};\nTextAreaHandler = __decorate([\n    __param(3, IKeybindingService)\n], TextAreaHandler);\nexport { TextAreaHandler };\nfunction measureText(document, text, fontInfo, tabSize) {\n    if (text.length === 0) {\n        return 0;\n    }\n    const container = document.createElement('div');\n    container.style.position = 'absolute';\n    container.style.top = '-50000px';\n    container.style.width = '50000px';\n    const regularDomNode = document.createElement('span');\n    applyFontInfo(regularDomNode, fontInfo);\n    regularDomNode.style.whiteSpace = 'pre'; // just like the textarea\n    regularDomNode.style.tabSize = `${tabSize * fontInfo.spaceWidth}px`; // just like the textarea\n    regularDomNode.append(text);\n    container.appendChild(regularDomNode);\n    document.body.appendChild(container);\n    const res = regularDomNode.offsetWidth;\n    document.body.removeChild(container);\n    return res;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as browser from '../../../base/browser/browser.js';\nimport * as dom from '../../../base/browser/dom.js';\nimport { DomEmitter } from '../../../base/browser/event.js';\nimport { StandardKeyboardEvent } from '../../../base/browser/keyboardEvent.js';\nimport { inputLatency } from '../../../base/browser/performance.js';\nimport { RunOnceScheduler } from '../../../base/common/async.js';\nimport { Emitter } from '../../../base/common/event.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport { Mimes } from '../../../base/common/mime.js';\nimport * as strings from '../../../base/common/strings.js';\nimport { TextAreaState, _debugComposition } from './textAreaState.js';\nimport { Selection } from '../../common/core/selection.js';\nexport var TextAreaSyntethicEvents;\n(function (TextAreaSyntethicEvents) {\n    TextAreaSyntethicEvents.Tap = '-monaco-textarea-synthetic-tap';\n})(TextAreaSyntethicEvents || (TextAreaSyntethicEvents = {}));\nexport const CopyOptions = {\n    forceCopyWithSyntaxHighlighting: false\n};\n/**\n * Every time we write to the clipboard, we record a bit of extra metadata here.\n * Every time we read from the cipboard, if the text matches our last written text,\n * we can fetch the previous metadata.\n */\nexport class InMemoryClipboardMetadataManager {\n    constructor() {\n        this._lastState = null;\n    }\n    set(lastCopiedValue, data) {\n        this._lastState = { lastCopiedValue, data };\n    }\n    get(pastedText) {\n        if (this._lastState && this._lastState.lastCopiedValue === pastedText) {\n            // match!\n            return this._lastState.data;\n        }\n        this._lastState = null;\n        return null;\n    }\n}\nInMemoryClipboardMetadataManager.INSTANCE = new InMemoryClipboardMetadataManager();\nclass CompositionContext {\n    constructor() {\n        this._lastTypeTextLength = 0;\n    }\n    handleCompositionUpdate(text) {\n        text = text || '';\n        const typeInput = {\n            text: text,\n            replacePrevCharCnt: this._lastTypeTextLength,\n            replaceNextCharCnt: 0,\n            positionDelta: 0\n        };\n        this._lastTypeTextLength = text.length;\n        return typeInput;\n    }\n}\n/**\n * Writes screen reader content to the textarea and is able to analyze its input events to generate:\n *  - onCut\n *  - onPaste\n *  - onType\n *\n * Composition events are generated for presentation purposes (composition input is reflected in onType).\n */\nexport class TextAreaInput extends Disposable {\n    get textAreaState() {\n        return this._textAreaState;\n    }\n    constructor(_host, _textArea, _OS, _browser) {\n        super();\n        this._host = _host;\n        this._textArea = _textArea;\n        this._OS = _OS;\n        this._browser = _browser;\n        this._onFocus = this._register(new Emitter());\n        this.onFocus = this._onFocus.event;\n        this._onBlur = this._register(new Emitter());\n        this.onBlur = this._onBlur.event;\n        this._onKeyDown = this._register(new Emitter());\n        this.onKeyDown = this._onKeyDown.event;\n        this._onKeyUp = this._register(new Emitter());\n        this.onKeyUp = this._onKeyUp.event;\n        this._onCut = this._register(new Emitter());\n        this.onCut = this._onCut.event;\n        this._onPaste = this._register(new Emitter());\n        this.onPaste = this._onPaste.event;\n        this._onType = this._register(new Emitter());\n        this.onType = this._onType.event;\n        this._onCompositionStart = this._register(new Emitter());\n        this.onCompositionStart = this._onCompositionStart.event;\n        this._onCompositionUpdate = this._register(new Emitter());\n        this.onCompositionUpdate = this._onCompositionUpdate.event;\n        this._onCompositionEnd = this._register(new Emitter());\n        this.onCompositionEnd = this._onCompositionEnd.event;\n        this._onSelectionChangeRequest = this._register(new Emitter());\n        this.onSelectionChangeRequest = this._onSelectionChangeRequest.event;\n        this._asyncTriggerCut = this._register(new RunOnceScheduler(() => this._onCut.fire(), 0));\n        this._asyncFocusGainWriteScreenReaderContent = this._register(new RunOnceScheduler(() => this.writeScreenReaderContent('asyncFocusGain'), 0));\n        this._textAreaState = TextAreaState.EMPTY;\n        this._selectionChangeListener = null;\n        this.writeScreenReaderContent('ctor');\n        this._hasFocus = false;\n        this._currentComposition = null;\n        let lastKeyDown = null;\n        this._register(this._textArea.onKeyDown((_e) => {\n            const e = new StandardKeyboardEvent(_e);\n            if (e.keyCode === 114 /* KeyCode.KEY_IN_COMPOSITION */\n                || (this._currentComposition && e.keyCode === 1 /* KeyCode.Backspace */)) {\n                // Stop propagation for keyDown events if the IME is processing key input\n                e.stopPropagation();\n            }\n            if (e.equals(9 /* KeyCode.Escape */)) {\n                // Prevent default always for `Esc`, otherwise it will generate a keypress\n                // See https://msdn.microsoft.com/en-us/library/ie/ms536939(v=vs.85).aspx\n                e.preventDefault();\n            }\n            lastKeyDown = e;\n            this._onKeyDown.fire(e);\n        }));\n        this._register(this._textArea.onKeyUp((_e) => {\n            const e = new StandardKeyboardEvent(_e);\n            this._onKeyUp.fire(e);\n        }));\n        this._register(this._textArea.onCompositionStart((e) => {\n            if (_debugComposition) {\n                console.log(`[compositionstart]`, e);\n            }\n            const currentComposition = new CompositionContext();\n            if (this._currentComposition) {\n                // simply reset the composition context\n                this._currentComposition = currentComposition;\n                return;\n            }\n            this._currentComposition = currentComposition;\n            if (this._OS === 2 /* OperatingSystem.Macintosh */\n                && lastKeyDown\n                && lastKeyDown.equals(114 /* KeyCode.KEY_IN_COMPOSITION */)\n                && this._textAreaState.selectionStart === this._textAreaState.selectionEnd\n                && this._textAreaState.selectionStart > 0\n                && this._textAreaState.value.substr(this._textAreaState.selectionStart - 1, 1) === e.data\n                && (lastKeyDown.code === 'ArrowRight' || lastKeyDown.code === 'ArrowLeft')) {\n                // Handling long press case on Chromium/Safari macOS + arrow key => pretend the character was selected\n                if (_debugComposition) {\n                    console.log(`[compositionstart] Handling long press case on macOS + arrow key`, e);\n                }\n                // Pretend the previous character was composed (in order to get it removed by subsequent compositionupdate events)\n                currentComposition.handleCompositionUpdate('x');\n                this._onCompositionStart.fire({ data: e.data });\n                return;\n            }\n            if (this._browser.isAndroid) {\n                // when tapping on the editor, Android enters composition mode to edit the current word\n                // so we cannot clear the textarea on Android and we must pretend the current word was selected\n                this._onCompositionStart.fire({ data: e.data });\n                return;\n            }\n            this._onCompositionStart.fire({ data: e.data });\n        }));\n        this._register(this._textArea.onCompositionUpdate((e) => {\n            if (_debugComposition) {\n                console.log(`[compositionupdate]`, e);\n            }\n            const currentComposition = this._currentComposition;\n            if (!currentComposition) {\n                // should not be possible to receive a 'compositionupdate' without a 'compositionstart'\n                return;\n            }\n            if (this._browser.isAndroid) {\n                // On Android, the data sent with the composition update event is unusable.\n                // For example, if the cursor is in the middle of a word like Mic|osoft\n                // and Microsoft is chosen from the keyboard's suggestions, the e.data will contain \"Microsoft\".\n                // This is not really usable because it doesn't tell us where the edit began and where it ended.\n                const newState = TextAreaState.readFromTextArea(this._textArea, this._textAreaState);\n                const typeInput = TextAreaState.deduceAndroidCompositionInput(this._textAreaState, newState);\n                this._textAreaState = newState;\n                this._onType.fire(typeInput);\n                this._onCompositionUpdate.fire(e);\n                return;\n            }\n            const typeInput = currentComposition.handleCompositionUpdate(e.data);\n            this._textAreaState = TextAreaState.readFromTextArea(this._textArea, this._textAreaState);\n            this._onType.fire(typeInput);\n            this._onCompositionUpdate.fire(e);\n        }));\n        this._register(this._textArea.onCompositionEnd((e) => {\n            if (_debugComposition) {\n                console.log(`[compositionend]`, e);\n            }\n            const currentComposition = this._currentComposition;\n            if (!currentComposition) {\n                // https://github.com/microsoft/monaco-editor/issues/1663\n                // On iOS 13.2, Chinese system IME randomly trigger an additional compositionend event with empty data\n                return;\n            }\n            this._currentComposition = null;\n            if (this._browser.isAndroid) {\n                // On Android, the data sent with the composition update event is unusable.\n                // For example, if the cursor is in the middle of a word like Mic|osoft\n                // and Microsoft is chosen from the keyboard's suggestions, the e.data will contain \"Microsoft\".\n                // This is not really usable because it doesn't tell us where the edit began and where it ended.\n                const newState = TextAreaState.readFromTextArea(this._textArea, this._textAreaState);\n                const typeInput = TextAreaState.deduceAndroidCompositionInput(this._textAreaState, newState);\n                this._textAreaState = newState;\n                this._onType.fire(typeInput);\n                this._onCompositionEnd.fire();\n                return;\n            }\n            const typeInput = currentComposition.handleCompositionUpdate(e.data);\n            this._textAreaState = TextAreaState.readFromTextArea(this._textArea, this._textAreaState);\n            this._onType.fire(typeInput);\n            this._onCompositionEnd.fire();\n        }));\n        this._register(this._textArea.onInput((e) => {\n            if (_debugComposition) {\n                console.log(`[input]`, e);\n            }\n            // Pretend here we touched the text area, as the `input` event will most likely\n            // result in a `selectionchange` event which we want to ignore\n            this._textArea.setIgnoreSelectionChangeTime('received input event');\n            if (this._currentComposition) {\n                return;\n            }\n            const newState = TextAreaState.readFromTextArea(this._textArea, this._textAreaState);\n            const typeInput = TextAreaState.deduceInput(this._textAreaState, newState, /*couldBeEmojiInput*/ this._OS === 2 /* OperatingSystem.Macintosh */);\n            if (typeInput.replacePrevCharCnt === 0 && typeInput.text.length === 1) {\n                // one character was typed\n                if (strings.isHighSurrogate(typeInput.text.charCodeAt(0))\n                    || typeInput.text.charCodeAt(0) === 0x7f /* Delete */) {\n                    // Ignore invalid input but keep it around for next time\n                    return;\n                }\n            }\n            this._textAreaState = newState;\n            if (typeInput.text !== ''\n                || typeInput.replacePrevCharCnt !== 0\n                || typeInput.replaceNextCharCnt !== 0\n                || typeInput.positionDelta !== 0) {\n                this._onType.fire(typeInput);\n            }\n        }));\n        // --- Clipboard operations\n        this._register(this._textArea.onCut((e) => {\n            // Pretend here we touched the text area, as the `cut` event will most likely\n            // result in a `selectionchange` event which we want to ignore\n            this._textArea.setIgnoreSelectionChangeTime('received cut event');\n            this._ensureClipboardGetsEditorSelection(e);\n            this._asyncTriggerCut.schedule();\n        }));\n        this._register(this._textArea.onCopy((e) => {\n            this._ensureClipboardGetsEditorSelection(e);\n        }));\n        this._register(this._textArea.onPaste((e) => {\n            // Pretend here we touched the text area, as the `paste` event will most likely\n            // result in a `selectionchange` event which we want to ignore\n            this._textArea.setIgnoreSelectionChangeTime('received paste event');\n            e.preventDefault();\n            if (!e.clipboardData) {\n                return;\n            }\n            let [text, metadata] = ClipboardEventUtils.getTextData(e.clipboardData);\n            if (!text) {\n                return;\n            }\n            // try the in-memory store\n            metadata = metadata || InMemoryClipboardMetadataManager.INSTANCE.get(text);\n            this._onPaste.fire({\n                text: text,\n                metadata: metadata\n            });\n        }));\n        this._register(this._textArea.onFocus(() => {\n            const hadFocus = this._hasFocus;\n            this._setHasFocus(true);\n            if (this._browser.isSafari && !hadFocus && this._hasFocus) {\n                // When \"tabbing into\" the textarea, immediately after dispatching the 'focus' event,\n                // Safari will always move the selection at offset 0 in the textarea\n                this._asyncFocusGainWriteScreenReaderContent.schedule();\n            }\n        }));\n        this._register(this._textArea.onBlur(() => {\n            if (this._currentComposition) {\n                // See https://github.com/microsoft/vscode/issues/112621\n                // where compositionend is not triggered when the editor\n                // is taken off-dom during a composition\n                // Clear the flag to be able to write to the textarea\n                this._currentComposition = null;\n                // Clear the textarea to avoid an unwanted cursor type\n                this.writeScreenReaderContent('blurWithoutCompositionEnd');\n                // Fire artificial composition end\n                this._onCompositionEnd.fire();\n            }\n            this._setHasFocus(false);\n        }));\n        this._register(this._textArea.onSyntheticTap(() => {\n            if (this._browser.isAndroid && this._currentComposition) {\n                // on Android, tapping does not cancel the current composition, so the\n                // textarea is stuck showing the old composition\n                // Clear the flag to be able to write to the textarea\n                this._currentComposition = null;\n                // Clear the textarea to avoid an unwanted cursor type\n                this.writeScreenReaderContent('tapWithoutCompositionEnd');\n                // Fire artificial composition end\n                this._onCompositionEnd.fire();\n            }\n        }));\n    }\n    _installSelectionChangeListener() {\n        // See https://github.com/microsoft/vscode/issues/27216 and https://github.com/microsoft/vscode/issues/98256\n        // When using a Braille display, it is possible for users to reposition the\n        // system caret. This is reflected in Chrome as a `selectionchange` event.\n        //\n        // The `selectionchange` event appears to be emitted under numerous other circumstances,\n        // so it is quite a challenge to distinguish a `selectionchange` coming in from a user\n        // using a Braille display from all the other cases.\n        //\n        // The problems with the `selectionchange` event are:\n        //  * the event is emitted when the textarea is focused programmatically -- textarea.focus()\n        //  * the event is emitted when the selection is changed in the textarea programmatically -- textarea.setSelectionRange(...)\n        //  * the event is emitted when the value of the textarea is changed programmatically -- textarea.value = '...'\n        //  * the event is emitted when tabbing into the textarea\n        //  * the event is emitted asynchronously (sometimes with a delay as high as a few tens of ms)\n        //  * the event sometimes comes in bursts for a single logical textarea operation\n        // `selectionchange` events often come multiple times for a single logical change\n        // so throttle multiple `selectionchange` events that burst in a short period of time.\n        let previousSelectionChangeEventTime = 0;\n        return dom.addDisposableListener(this._textArea.ownerDocument, 'selectionchange', (e) => {\n            inputLatency.onSelectionChange();\n            if (!this._hasFocus) {\n                return;\n            }\n            if (this._currentComposition) {\n                return;\n            }\n            if (!this._browser.isChrome) {\n                // Support only for Chrome until testing happens on other browsers\n                return;\n            }\n            const now = Date.now();\n            const delta1 = now - previousSelectionChangeEventTime;\n            previousSelectionChangeEventTime = now;\n            if (delta1 < 5) {\n                // received another `selectionchange` event within 5ms of the previous `selectionchange` event\n                // => ignore it\n                return;\n            }\n            const delta2 = now - this._textArea.getIgnoreSelectionChangeTime();\n            this._textArea.resetSelectionChangeTime();\n            if (delta2 < 100) {\n                // received a `selectionchange` event within 100ms since we touched the textarea\n                // => ignore it, since we caused it\n                return;\n            }\n            if (!this._textAreaState.selection) {\n                // Cannot correlate a position in the textarea with a position in the editor...\n                return;\n            }\n            const newValue = this._textArea.getValue();\n            if (this._textAreaState.value !== newValue) {\n                // Cannot correlate a position in the textarea with a position in the editor...\n                return;\n            }\n            const newSelectionStart = this._textArea.getSelectionStart();\n            const newSelectionEnd = this._textArea.getSelectionEnd();\n            if (this._textAreaState.selectionStart === newSelectionStart && this._textAreaState.selectionEnd === newSelectionEnd) {\n                // Nothing to do...\n                return;\n            }\n            const _newSelectionStartPosition = this._textAreaState.deduceEditorPosition(newSelectionStart);\n            const newSelectionStartPosition = this._host.deduceModelPosition(_newSelectionStartPosition[0], _newSelectionStartPosition[1], _newSelectionStartPosition[2]);\n            const _newSelectionEndPosition = this._textAreaState.deduceEditorPosition(newSelectionEnd);\n            const newSelectionEndPosition = this._host.deduceModelPosition(_newSelectionEndPosition[0], _newSelectionEndPosition[1], _newSelectionEndPosition[2]);\n            const newSelection = new Selection(newSelectionStartPosition.lineNumber, newSelectionStartPosition.column, newSelectionEndPosition.lineNumber, newSelectionEndPosition.column);\n            this._onSelectionChangeRequest.fire(newSelection);\n        });\n    }\n    dispose() {\n        super.dispose();\n        if (this._selectionChangeListener) {\n            this._selectionChangeListener.dispose();\n            this._selectionChangeListener = null;\n        }\n    }\n    focusTextArea() {\n        // Setting this._hasFocus and writing the screen reader content\n        // will result in a focus() and setSelectionRange() in the textarea\n        this._setHasFocus(true);\n        // If the editor is off DOM, focus cannot be really set, so let's double check that we have managed to set the focus\n        this.refreshFocusState();\n    }\n    isFocused() {\n        return this._hasFocus;\n    }\n    refreshFocusState() {\n        this._setHasFocus(this._textArea.hasFocus());\n    }\n    _setHasFocus(newHasFocus) {\n        if (this._hasFocus === newHasFocus) {\n            // no change\n            return;\n        }\n        this._hasFocus = newHasFocus;\n        if (this._selectionChangeListener) {\n            this._selectionChangeListener.dispose();\n            this._selectionChangeListener = null;\n        }\n        if (this._hasFocus) {\n            this._selectionChangeListener = this._installSelectionChangeListener();\n        }\n        if (this._hasFocus) {\n            this.writeScreenReaderContent('focusgain');\n        }\n        if (this._hasFocus) {\n            this._onFocus.fire();\n        }\n        else {\n            this._onBlur.fire();\n        }\n    }\n    _setAndWriteTextAreaState(reason, textAreaState) {\n        if (!this._hasFocus) {\n            textAreaState = textAreaState.collapseSelection();\n        }\n        textAreaState.writeToTextArea(reason, this._textArea, this._hasFocus);\n        this._textAreaState = textAreaState;\n    }\n    writeScreenReaderContent(reason) {\n        if (this._currentComposition) {\n            // Do not write to the text area when doing composition\n            return;\n        }\n        this._setAndWriteTextAreaState(reason, this._host.getScreenReaderContent());\n    }\n    _ensureClipboardGetsEditorSelection(e) {\n        const dataToCopy = this._host.getDataToCopy();\n        const storedMetadata = {\n            version: 1,\n            isFromEmptySelection: dataToCopy.isFromEmptySelection,\n            multicursorText: dataToCopy.multicursorText,\n            mode: dataToCopy.mode\n        };\n        InMemoryClipboardMetadataManager.INSTANCE.set(\n        // When writing \"LINE\\r\\n\" to the clipboard and then pasting,\n        // Firefox pastes \"LINE\\n\", so let's work around this quirk\n        (this._browser.isFirefox ? dataToCopy.text.replace(/\\r\\n/g, '\\n') : dataToCopy.text), storedMetadata);\n        e.preventDefault();\n        if (e.clipboardData) {\n            ClipboardEventUtils.setTextData(e.clipboardData, dataToCopy.text, dataToCopy.html, storedMetadata);\n        }\n    }\n}\nexport const ClipboardEventUtils = {\n    getTextData(clipboardData) {\n        const text = clipboardData.getData(Mimes.text);\n        let metadata = null;\n        const rawmetadata = clipboardData.getData('vscode-editor-data');\n        if (typeof rawmetadata === 'string') {\n            try {\n                metadata = JSON.parse(rawmetadata);\n                if (metadata.version !== 1) {\n                    metadata = null;\n                }\n            }\n            catch (err) {\n                // no problem!\n            }\n        }\n        if (text.length === 0 && metadata === null && clipboardData.files.length > 0) {\n            // no textual data pasted, generate text from file names\n            const files = Array.prototype.slice.call(clipboardData.files, 0);\n            return [files.map(file => file.name).join('\\n'), null];\n        }\n        return [text, metadata];\n    },\n    setTextData(clipboardData, text, html, metadata) {\n        clipboardData.setData(Mimes.text, text);\n        if (typeof html === 'string') {\n            clipboardData.setData('text/html', html);\n        }\n        clipboardData.setData('vscode-editor-data', JSON.stringify(metadata));\n    }\n};\nexport class TextAreaWrapper extends Disposable {\n    get ownerDocument() {\n        return this._actual.ownerDocument;\n    }\n    constructor(_actual) {\n        super();\n        this._actual = _actual;\n        this.onKeyDown = this._register(new DomEmitter(this._actual, 'keydown')).event;\n        this.onKeyUp = this._register(new DomEmitter(this._actual, 'keyup')).event;\n        this.onCompositionStart = this._register(new DomEmitter(this._actual, 'compositionstart')).event;\n        this.onCompositionUpdate = this._register(new DomEmitter(this._actual, 'compositionupdate')).event;\n        this.onCompositionEnd = this._register(new DomEmitter(this._actual, 'compositionend')).event;\n        this.onBeforeInput = this._register(new DomEmitter(this._actual, 'beforeinput')).event;\n        this.onInput = this._register(new DomEmitter(this._actual, 'input')).event;\n        this.onCut = this._register(new DomEmitter(this._actual, 'cut')).event;\n        this.onCopy = this._register(new DomEmitter(this._actual, 'copy')).event;\n        this.onPaste = this._register(new DomEmitter(this._actual, 'paste')).event;\n        this.onFocus = this._register(new DomEmitter(this._actual, 'focus')).event;\n        this.onBlur = this._register(new DomEmitter(this._actual, 'blur')).event;\n        this._onSyntheticTap = this._register(new Emitter());\n        this.onSyntheticTap = this._onSyntheticTap.event;\n        this._ignoreSelectionChangeTime = 0;\n        this._register(this.onKeyDown(() => inputLatency.onKeyDown()));\n        this._register(this.onBeforeInput(() => inputLatency.onBeforeInput()));\n        this._register(this.onInput(() => inputLatency.onInput()));\n        this._register(this.onKeyUp(() => inputLatency.onKeyUp()));\n        this._register(dom.addDisposableListener(this._actual, TextAreaSyntethicEvents.Tap, () => this._onSyntheticTap.fire()));\n    }\n    hasFocus() {\n        const shadowRoot = dom.getShadowRoot(this._actual);\n        if (shadowRoot) {\n            return shadowRoot.activeElement === this._actual;\n        }\n        else if (dom.isInDOM(this._actual)) {\n            return this._actual.ownerDocument.activeElement === this._actual;\n        }\n        else {\n            return false;\n        }\n    }\n    setIgnoreSelectionChangeTime(reason) {\n        this._ignoreSelectionChangeTime = Date.now();\n    }\n    getIgnoreSelectionChangeTime() {\n        return this._ignoreSelectionChangeTime;\n    }\n    resetSelectionChangeTime() {\n        this._ignoreSelectionChangeTime = 0;\n    }\n    getValue() {\n        // console.log('current value: ' + this._textArea.value);\n        return this._actual.value;\n    }\n    setValue(reason, value) {\n        const textArea = this._actual;\n        if (textArea.value === value) {\n            // No change\n            return;\n        }\n        // console.log('reason: ' + reason + ', current value: ' + textArea.value + ' => new value: ' + value);\n        this.setIgnoreSelectionChangeTime('setValue');\n        textArea.value = value;\n    }\n    getSelectionStart() {\n        return this._actual.selectionDirection === 'backward' ? this._actual.selectionEnd : this._actual.selectionStart;\n    }\n    getSelectionEnd() {\n        return this._actual.selectionDirection === 'backward' ? this._actual.selectionStart : this._actual.selectionEnd;\n    }\n    setSelectionRange(reason, selectionStart, selectionEnd) {\n        const textArea = this._actual;\n        let activeElement = null;\n        const shadowRoot = dom.getShadowRoot(textArea);\n        if (shadowRoot) {\n            activeElement = shadowRoot.activeElement;\n        }\n        else {\n            activeElement = textArea.ownerDocument.activeElement;\n        }\n        const currentIsFocused = (activeElement === textArea);\n        const currentSelectionStart = textArea.selectionStart;\n        const currentSelectionEnd = textArea.selectionEnd;\n        if (currentIsFocused && currentSelectionStart === selectionStart && currentSelectionEnd === selectionEnd) {\n            // No change\n            // Firefox iframe bug https://github.com/microsoft/monaco-editor/issues/643#issuecomment-367871377\n            if (browser.isFirefox && window.parent !== window) {\n                textArea.focus();\n            }\n            return;\n        }\n        // console.log('reason: ' + reason + ', setSelectionRange: ' + selectionStart + ' -> ' + selectionEnd);\n        if (currentIsFocused) {\n            // No need to focus, only need to change the selection range\n            this.setIgnoreSelectionChangeTime('setSelectionRange');\n            textArea.setSelectionRange(selectionStart, selectionEnd);\n            if (browser.isFirefox && window.parent !== window) {\n                textArea.focus();\n            }\n            return;\n        }\n        // If the focus is outside the textarea, browsers will try really hard to reveal the textarea.\n        // Here, we try to undo the browser's desperate reveal.\n        try {\n            const scrollState = dom.saveParentsScrollTop(textArea);\n            this.setIgnoreSelectionChangeTime('setSelectionRange');\n            textArea.focus();\n            textArea.setSelectionRange(selectionStart, selectionEnd);\n            dom.restoreParentsScrollTop(textArea, scrollState);\n        }\n        catch (e) {\n            // Sometimes IE throws when setting selection (e.g. textarea is off-DOM)\n        }\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as strings from '../../../base/common/strings.js';\nimport { Range } from '../../common/core/range.js';\nexport const _debugComposition = false;\nexport class TextAreaState {\n    constructor(value, \n    /** the offset where selection starts inside `value` */\n    selectionStart, \n    /** the offset where selection ends inside `value` */\n    selectionEnd, \n    /** the editor range in the view coordinate system that matches the selection inside `value` */\n    selection, \n    /** the visible line count (wrapped, not necessarily matching \\n characters) for the text in `value` before `selectionStart` */\n    newlineCountBeforeSelection) {\n        this.value = value;\n        this.selectionStart = selectionStart;\n        this.selectionEnd = selectionEnd;\n        this.selection = selection;\n        this.newlineCountBeforeSelection = newlineCountBeforeSelection;\n    }\n    toString() {\n        return `[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`;\n    }\n    static readFromTextArea(textArea, previousState) {\n        const value = textArea.getValue();\n        const selectionStart = textArea.getSelectionStart();\n        const selectionEnd = textArea.getSelectionEnd();\n        let newlineCountBeforeSelection = undefined;\n        if (previousState) {\n            const valueBeforeSelectionStart = value.substring(0, selectionStart);\n            const previousValueBeforeSelectionStart = previousState.value.substring(0, previousState.selectionStart);\n            if (valueBeforeSelectionStart === previousValueBeforeSelectionStart) {\n                newlineCountBeforeSelection = previousState.newlineCountBeforeSelection;\n            }\n        }\n        return new TextAreaState(value, selectionStart, selectionEnd, null, newlineCountBeforeSelection);\n    }\n    collapseSelection() {\n        if (this.selectionStart === this.value.length) {\n            return this;\n        }\n        return new TextAreaState(this.value, this.value.length, this.value.length, null, undefined);\n    }\n    writeToTextArea(reason, textArea, select) {\n        if (_debugComposition) {\n            console.log(`writeToTextArea ${reason}: ${this.toString()}`);\n        }\n        textArea.setValue(reason, this.value);\n        if (select) {\n            textArea.setSelectionRange(reason, this.selectionStart, this.selectionEnd);\n        }\n    }\n    deduceEditorPosition(offset) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        if (offset <= this.selectionStart) {\n            const str = this.value.substring(offset, this.selectionStart);\n            return this._finishDeduceEditorPosition((_b = (_a = this.selection) === null || _a === void 0 ? void 0 : _a.getStartPosition()) !== null && _b !== void 0 ? _b : null, str, -1);\n        }\n        if (offset >= this.selectionEnd) {\n            const str = this.value.substring(this.selectionEnd, offset);\n            return this._finishDeduceEditorPosition((_d = (_c = this.selection) === null || _c === void 0 ? void 0 : _c.getEndPosition()) !== null && _d !== void 0 ? _d : null, str, 1);\n        }\n        const str1 = this.value.substring(this.selectionStart, offset);\n        if (str1.indexOf(String.fromCharCode(8230)) === -1) {\n            return this._finishDeduceEditorPosition((_f = (_e = this.selection) === null || _e === void 0 ? void 0 : _e.getStartPosition()) !== null && _f !== void 0 ? _f : null, str1, 1);\n        }\n        const str2 = this.value.substring(offset, this.selectionEnd);\n        return this._finishDeduceEditorPosition((_h = (_g = this.selection) === null || _g === void 0 ? void 0 : _g.getEndPosition()) !== null && _h !== void 0 ? _h : null, str2, -1);\n    }\n    _finishDeduceEditorPosition(anchor, deltaText, signum) {\n        let lineFeedCnt = 0;\n        let lastLineFeedIndex = -1;\n        while ((lastLineFeedIndex = deltaText.indexOf('\\n', lastLineFeedIndex + 1)) !== -1) {\n            lineFeedCnt++;\n        }\n        return [anchor, signum * deltaText.length, lineFeedCnt];\n    }\n    static deduceInput(previousState, currentState, couldBeEmojiInput) {\n        if (!previousState) {\n            // This is the EMPTY state\n            return {\n                text: '',\n                replacePrevCharCnt: 0,\n                replaceNextCharCnt: 0,\n                positionDelta: 0\n            };\n        }\n        if (_debugComposition) {\n            console.log('------------------------deduceInput');\n            console.log(`PREVIOUS STATE: ${previousState.toString()}`);\n            console.log(`CURRENT STATE: ${currentState.toString()}`);\n        }\n        const prefixLength = Math.min(strings.commonPrefixLength(previousState.value, currentState.value), previousState.selectionStart, currentState.selectionStart);\n        const suffixLength = Math.min(strings.commonSuffixLength(previousState.value, currentState.value), previousState.value.length - previousState.selectionEnd, currentState.value.length - currentState.selectionEnd);\n        const previousValue = previousState.value.substring(prefixLength, previousState.value.length - suffixLength);\n        const currentValue = currentState.value.substring(prefixLength, currentState.value.length - suffixLength);\n        const previousSelectionStart = previousState.selectionStart - prefixLength;\n        const previousSelectionEnd = previousState.selectionEnd - prefixLength;\n        const currentSelectionStart = currentState.selectionStart - prefixLength;\n        const currentSelectionEnd = currentState.selectionEnd - prefixLength;\n        if (_debugComposition) {\n            console.log(`AFTER DIFFING PREVIOUS STATE: <${previousValue}>, selectionStart: ${previousSelectionStart}, selectionEnd: ${previousSelectionEnd}`);\n            console.log(`AFTER DIFFING CURRENT STATE: <${currentValue}>, selectionStart: ${currentSelectionStart}, selectionEnd: ${currentSelectionEnd}`);\n        }\n        if (currentSelectionStart === currentSelectionEnd) {\n            // no current selection\n            const replacePreviousCharacters = (previousState.selectionStart - prefixLength);\n            if (_debugComposition) {\n                console.log(`REMOVE PREVIOUS: ${replacePreviousCharacters} chars`);\n            }\n            return {\n                text: currentValue,\n                replacePrevCharCnt: replacePreviousCharacters,\n                replaceNextCharCnt: 0,\n                positionDelta: 0\n            };\n        }\n        // there is a current selection => composition case\n        const replacePreviousCharacters = previousSelectionEnd - previousSelectionStart;\n        return {\n            text: currentValue,\n            replacePrevCharCnt: replacePreviousCharacters,\n            replaceNextCharCnt: 0,\n            positionDelta: 0\n        };\n    }\n    static deduceAndroidCompositionInput(previousState, currentState) {\n        if (!previousState) {\n            // This is the EMPTY state\n            return {\n                text: '',\n                replacePrevCharCnt: 0,\n                replaceNextCharCnt: 0,\n                positionDelta: 0\n            };\n        }\n        if (_debugComposition) {\n            console.log('------------------------deduceAndroidCompositionInput');\n            console.log(`PREVIOUS STATE: ${previousState.toString()}`);\n            console.log(`CURRENT STATE: ${currentState.toString()}`);\n        }\n        if (previousState.value === currentState.value) {\n            return {\n                text: '',\n                replacePrevCharCnt: 0,\n                replaceNextCharCnt: 0,\n                positionDelta: currentState.selectionEnd - previousState.selectionEnd\n            };\n        }\n        const prefixLength = Math.min(strings.commonPrefixLength(previousState.value, currentState.value), previousState.selectionEnd);\n        const suffixLength = Math.min(strings.commonSuffixLength(previousState.value, currentState.value), previousState.value.length - previousState.selectionEnd);\n        const previousValue = previousState.value.substring(prefixLength, previousState.value.length - suffixLength);\n        const currentValue = currentState.value.substring(prefixLength, currentState.value.length - suffixLength);\n        const previousSelectionStart = previousState.selectionStart - prefixLength;\n        const previousSelectionEnd = previousState.selectionEnd - prefixLength;\n        const currentSelectionStart = currentState.selectionStart - prefixLength;\n        const currentSelectionEnd = currentState.selectionEnd - prefixLength;\n        if (_debugComposition) {\n            console.log(`AFTER DIFFING PREVIOUS STATE: <${previousValue}>, selectionStart: ${previousSelectionStart}, selectionEnd: ${previousSelectionEnd}`);\n            console.log(`AFTER DIFFING CURRENT STATE: <${currentValue}>, selectionStart: ${currentSelectionStart}, selectionEnd: ${currentSelectionEnd}`);\n        }\n        return {\n            text: currentValue,\n            replacePrevCharCnt: previousSelectionEnd,\n            replaceNextCharCnt: previousValue.length - previousSelectionEnd,\n            positionDelta: currentSelectionEnd - currentValue.length\n        };\n    }\n}\nTextAreaState.EMPTY = new TextAreaState('', 0, 0, null, undefined);\nexport class PagedScreenReaderStrategy {\n    static _getPageOfLine(lineNumber, linesPerPage) {\n        return Math.floor((lineNumber - 1) / linesPerPage);\n    }\n    static _getRangeForPage(page, linesPerPage) {\n        const offset = page * linesPerPage;\n        const startLineNumber = offset + 1;\n        const endLineNumber = offset + linesPerPage;\n        return new Range(startLineNumber, 1, endLineNumber + 1, 1);\n    }\n    static fromEditorSelection(model, selection, linesPerPage, trimLongText) {\n        // Chromium handles very poorly text even of a few thousand chars\n        // Cut text to avoid stalling the entire UI\n        const LIMIT_CHARS = 500;\n        const selectionStartPage = PagedScreenReaderStrategy._getPageOfLine(selection.startLineNumber, linesPerPage);\n        const selectionStartPageRange = PagedScreenReaderStrategy._getRangeForPage(selectionStartPage, linesPerPage);\n        const selectionEndPage = PagedScreenReaderStrategy._getPageOfLine(selection.endLineNumber, linesPerPage);\n        const selectionEndPageRange = PagedScreenReaderStrategy._getRangeForPage(selectionEndPage, linesPerPage);\n        let pretextRange = selectionStartPageRange.intersectRanges(new Range(1, 1, selection.startLineNumber, selection.startColumn));\n        if (trimLongText && model.getValueLengthInRange(pretextRange, 1 /* EndOfLinePreference.LF */) > LIMIT_CHARS) {\n            const pretextStart = model.modifyPosition(pretextRange.getEndPosition(), -LIMIT_CHARS);\n            pretextRange = Range.fromPositions(pretextStart, pretextRange.getEndPosition());\n        }\n        const pretext = model.getValueInRange(pretextRange, 1 /* EndOfLinePreference.LF */);\n        const lastLine = model.getLineCount();\n        const lastLineMaxColumn = model.getLineMaxColumn(lastLine);\n        let posttextRange = selectionEndPageRange.intersectRanges(new Range(selection.endLineNumber, selection.endColumn, lastLine, lastLineMaxColumn));\n        if (trimLongText && model.getValueLengthInRange(posttextRange, 1 /* EndOfLinePreference.LF */) > LIMIT_CHARS) {\n            const posttextEnd = model.modifyPosition(posttextRange.getStartPosition(), LIMIT_CHARS);\n            posttextRange = Range.fromPositions(posttextRange.getStartPosition(), posttextEnd);\n        }\n        const posttext = model.getValueInRange(posttextRange, 1 /* EndOfLinePreference.LF */);\n        let text;\n        if (selectionStartPage === selectionEndPage || selectionStartPage + 1 === selectionEndPage) {\n            // take full selection\n            text = model.getValueInRange(selection, 1 /* EndOfLinePreference.LF */);\n        }\n        else {\n            const selectionRange1 = selectionStartPageRange.intersectRanges(selection);\n            const selectionRange2 = selectionEndPageRange.intersectRanges(selection);\n            text = (model.getValueInRange(selectionRange1, 1 /* EndOfLinePreference.LF */)\n                + String.fromCharCode(8230)\n                + model.getValueInRange(selectionRange2, 1 /* EndOfLinePreference.LF */));\n        }\n        if (trimLongText && text.length > 2 * LIMIT_CHARS) {\n            text = text.substring(0, LIMIT_CHARS) + String.fromCharCode(8230) + text.substring(text.length - LIMIT_CHARS, text.length);\n        }\n        return new TextAreaState(pretext + text + posttext, pretext.length, pretext.length + text.length, selection, pretextRange.endLineNumber - pretextRange.startLineNumber);\n    }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as nls from '../../nls.js';\nimport { isFirefox } from '../../base/browser/browser.js';\nimport * as types from '../../base/common/types.js';\nimport { status } from '../../base/browser/ui/aria/aria.js';\nimport { Command, EditorCommand, registerEditorCommand, UndoCommand, RedoCommand, SelectAllCommand } from './editorExtensions.js';\nimport { ICodeEditorService } from './services/codeEditorService.js';\nimport { ColumnSelection } from '../common/cursor/cursorColumnSelection.js';\nimport { CursorState } from '../common/cursorCommon.js';\nimport { DeleteOperations } from '../common/cursor/cursorDeleteOperations.js';\nimport { CursorMove as CursorMove_, CursorMoveCommands } from '../common/cursor/cursorMoveCommands.js';\nimport { TypeOperations } from '../common/cursor/cursorTypeOperations.js';\nimport { Position } from '../common/core/position.js';\nimport { Range } from '../common/core/range.js';\nimport { EditorContextKeys } from '../common/editorContextKeys.js';\nimport { ContextKeyExpr } from '../../platform/contextkey/common/contextkey.js';\nimport { KeybindingsRegistry } from '../../platform/keybinding/common/keybindingsRegistry.js';\nimport { getActiveElement } from '../../base/browser/dom.js';\nconst CORE_WEIGHT = 0 /* KeybindingWeight.EditorCore */;\nexport class CoreEditorCommand extends EditorCommand {\n    runEditorCommand(accessor, editor, args) {\n        const viewModel = editor._getViewModel();\n        if (!viewModel) {\n            // the editor has no view => has no cursors\n            return;\n        }\n        this.runCoreEditorCommand(viewModel, args || {});\n    }\n}\nexport var EditorScroll_;\n(function (EditorScroll_) {\n    const isEditorScrollArgs = function (arg) {\n        if (!types.isObject(arg)) {\n            return false;\n        }\n        const scrollArg = arg;\n        if (!types.isString(scrollArg.to)) {\n            return false;\n        }\n        if (!types.isUndefined(scrollArg.by) && !types.isString(scrollArg.by)) {\n            return false;\n        }\n        if (!types.isUndefined(scrollArg.value) && !types.isNumber(scrollArg.value)) {\n            return false;\n        }\n        if (!types.isUndefined(scrollArg.revealCursor) && !types.isBoolean(scrollArg.revealCursor)) {\n            return false;\n        }\n        return true;\n    };\n    EditorScroll_.description = {\n        description: 'Scroll editor in the given direction',\n        args: [\n            {\n                name: 'Editor scroll argument object',\n                description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'to': A mandatory direction value.\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t\t'up', 'down'\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t* 'by': Unit to move. Default is computed based on 'to' value.\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t\t'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t* 'value': Number of units to move. Default is '1'.\n\t\t\t\t\t* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n\t\t\t\t`,\n                constraint: isEditorScrollArgs,\n                schema: {\n                    'type': 'object',\n                    'required': ['to'],\n                    'properties': {\n                        'to': {\n                            'type': 'string',\n                            'enum': ['up', 'down']\n                        },\n                        'by': {\n                            'type': 'string',\n                            'enum': ['line', 'wrappedLine', 'page', 'halfPage', 'editor']\n                        },\n                        'value': {\n                            'type': 'number',\n                            'default': 1\n                        },\n                        'revealCursor': {\n                            'type': 'boolean',\n                        }\n                    }\n                }\n            }\n        ]\n    };\n    /**\n     * Directions in the view for editor scroll command.\n     */\n    EditorScroll_.RawDirection = {\n        Up: 'up',\n        Right: 'right',\n        Down: 'down',\n        Left: 'left'\n    };\n    /**\n     * Units for editor scroll 'by' argument\n     */\n    EditorScroll_.RawUnit = {\n        Line: 'line',\n        WrappedLine: 'wrappedLine',\n        Page: 'page',\n        HalfPage: 'halfPage',\n        Editor: 'editor',\n        Column: 'column'\n    };\n    function parse(args) {\n        let direction;\n        switch (args.to) {\n            case EditorScroll_.RawDirection.Up:\n                direction = 1 /* Direction.Up */;\n                break;\n            case EditorScroll_.RawDirection.Right:\n                direction = 2 /* Direction.Right */;\n                break;\n            case EditorScroll_.RawDirection.Down:\n                direction = 3 /* Direction.Down */;\n                break;\n            case EditorScroll_.RawDirection.Left:\n                direction = 4 /* Direction.Left */;\n                break;\n            default:\n                // Illegal arguments\n                return null;\n        }\n        let unit;\n        switch (args.by) {\n            case EditorScroll_.RawUnit.Line:\n                unit = 1 /* Unit.Line */;\n                break;\n            case EditorScroll_.RawUnit.WrappedLine:\n                unit = 2 /* Unit.WrappedLine */;\n                break;\n            case EditorScroll_.RawUnit.Page:\n                unit = 3 /* Unit.Page */;\n                break;\n            case EditorScroll_.RawUnit.HalfPage:\n                unit = 4 /* Unit.HalfPage */;\n                break;\n            case EditorScroll_.RawUnit.Editor:\n                unit = 5 /* Unit.Editor */;\n                break;\n            case EditorScroll_.RawUnit.Column:\n                unit = 6 /* Unit.Column */;\n                break;\n            default:\n                unit = 2 /* Unit.WrappedLine */;\n        }\n        const value = Math.floor(args.value || 1);\n        const revealCursor = !!args.revealCursor;\n        return {\n            direction: direction,\n            unit: unit,\n            value: value,\n            revealCursor: revealCursor,\n            select: (!!args.select)\n        };\n    }\n    EditorScroll_.parse = parse;\n})(EditorScroll_ || (EditorScroll_ = {}));\nexport var RevealLine_;\n(function (RevealLine_) {\n    const isRevealLineArgs = function (arg) {\n        if (!types.isObject(arg)) {\n            return false;\n        }\n        const reveaLineArg = arg;\n        if (!types.isNumber(reveaLineArg.lineNumber) && !types.isString(reveaLineArg.lineNumber)) {\n            return false;\n        }\n        if (!types.isUndefined(reveaLineArg.at) && !types.isString(reveaLineArg.at)) {\n            return false;\n        }\n        return true;\n    };\n    RevealLine_.description = {\n        description: 'Reveal the given line at the given logical position',\n        args: [\n            {\n                name: 'Reveal line argument object',\n                description: `Property-value pairs that can be passed through this argument:\n\t\t\t\t\t* 'lineNumber': A mandatory line number value.\n\t\t\t\t\t* 'at': Logical position at which line has to be revealed.\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t\t\t'top', 'center', 'bottom'\n\t\t\t\t\t\t\\`\\`\\`\n\t\t\t\t`,\n                constraint: isRevealLineArgs,\n                schema: {\n                    'type': 'object',\n                    'required': ['lineNumber'],\n                    'properties': {\n                        'lineNumber': {\n                            'type': ['number', 'string'],\n                        },\n                        'at': {\n                            'type': 'string',\n                            'enum': ['top', 'center', 'bottom']\n                        }\n                    }\n                }\n            }\n        ]\n    };\n    /**\n     * Values for reveal line 'at' argument\n     */\n    RevealLine_.RawAtArgument = {\n        Top: 'top',\n        Center: 'center',\n        Bottom: 'bottom'\n    };\n})(RevealLine_ || (RevealLine_ = {}));\nclass EditorOrNativeTextInputCommand {\n    constructor(target) {\n        // 1. handle case when focus is in editor.\n        target.addImplementation(10000, 'code-editor', (accessor, args) => {\n            // Only if editor text focus (i.e. not if editor has widget focus).\n            const focusedEditor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n            if (focusedEditor && focusedEditor.hasTextFocus()) {\n                return this._runEditorCommand(accessor, focusedEditor, args);\n            }\n            return false;\n        });\n        // 2. handle case when focus is in some other `input` / `textarea`.\n        target.addImplementation(1000, 'generic-dom-input-textarea', (accessor, args) => {\n            // Only if focused on an element that allows for entering text\n            const activeElement = getActiveElement();\n            if (activeElement && ['input', 'textarea'].indexOf(activeElement.tagName.toLowerCase()) >= 0) {\n                this.runDOMCommand(activeElement);\n                return true;\n            }\n            return false;\n        });\n        // 3. (default) handle case when focus is somewhere else.\n        target.addImplementation(0, 'generic-dom', (accessor, args) => {\n            // Redirecting to active editor\n            const activeEditor = accessor.get(ICodeEditorService).getActiveCodeEditor();\n            if (activeEditor) {\n                activeEditor.focus();\n                return this._runEditorCommand(accessor, activeEditor, args);\n            }\n            return false;\n        });\n    }\n    _runEditorCommand(accessor, editor, args) {\n        const result = this.runEditorCommand(accessor, editor, args);\n        if (result) {\n            return result;\n        }\n        return true;\n    }\n}\nexport var CoreNavigationCommands;\n(function (CoreNavigationCommands) {\n    class BaseMoveToCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            if (!args.position) {\n                return;\n            }\n            viewModel.model.pushStackElement();\n            const cursorStateChanged = viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, [\n                CursorMoveCommands.moveTo(viewModel, viewModel.getPrimaryCursorState(), this._inSelectionMode, args.position, args.viewPosition)\n            ]);\n            if (cursorStateChanged && args.revealType !== 2 /* NavigationCommandRevealType.None */) {\n                viewModel.revealPrimaryCursor(args.source, true, true);\n            }\n        }\n    }\n    CoreNavigationCommands.MoveTo = registerEditorCommand(new BaseMoveToCommand({\n        id: '_moveTo',\n        inSelectionMode: false,\n        precondition: undefined\n    }));\n    CoreNavigationCommands.MoveToSelect = registerEditorCommand(new BaseMoveToCommand({\n        id: '_moveToSelect',\n        inSelectionMode: true,\n        precondition: undefined\n    }));\n    class ColumnSelectCommand extends CoreEditorCommand {\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            const result = this._getColumnSelectResult(viewModel, viewModel.getPrimaryCursorState(), viewModel.getCursorColumnSelectData(), args);\n            if (result === null) {\n                // invalid arguments\n                return;\n            }\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, result.viewStates.map((viewState) => CursorState.fromViewState(viewState)));\n            viewModel.setCursorColumnSelectData({\n                isReal: true,\n                fromViewLineNumber: result.fromLineNumber,\n                fromViewVisualColumn: result.fromVisualColumn,\n                toViewLineNumber: result.toLineNumber,\n                toViewVisualColumn: result.toVisualColumn\n            });\n            if (result.reversed) {\n                viewModel.revealTopMostCursor(args.source);\n            }\n            else {\n                viewModel.revealBottomMostCursor(args.source);\n            }\n        }\n    }\n    CoreNavigationCommands.ColumnSelect = registerEditorCommand(new class extends ColumnSelectCommand {\n        constructor() {\n            super({\n                id: 'columnSelect',\n                precondition: undefined\n            });\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            if (typeof args.position === 'undefined' || typeof args.viewPosition === 'undefined' || typeof args.mouseColumn === 'undefined') {\n                return null;\n            }\n            // validate `args`\n            const validatedPosition = viewModel.model.validatePosition(args.position);\n            const validatedViewPosition = viewModel.coordinatesConverter.validateViewPosition(new Position(args.viewPosition.lineNumber, args.viewPosition.column), validatedPosition);\n            const fromViewLineNumber = args.doColumnSelect ? prevColumnSelectData.fromViewLineNumber : validatedViewPosition.lineNumber;\n            const fromViewVisualColumn = args.doColumnSelect ? prevColumnSelectData.fromViewVisualColumn : args.mouseColumn - 1;\n            return ColumnSelection.columnSelect(viewModel.cursorConfig, viewModel, fromViewLineNumber, fromViewVisualColumn, validatedViewPosition.lineNumber, args.mouseColumn - 1);\n        }\n    });\n    CoreNavigationCommands.CursorColumnSelectLeft = registerEditorCommand(new class extends ColumnSelectCommand {\n        constructor() {\n            super({\n                id: 'cursorColumnSelectLeft',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 15 /* KeyCode.LeftArrow */,\n                    linux: { primary: 0 }\n                }\n            });\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            return ColumnSelection.columnSelectLeft(viewModel.cursorConfig, viewModel, prevColumnSelectData);\n        }\n    });\n    CoreNavigationCommands.CursorColumnSelectRight = registerEditorCommand(new class extends ColumnSelectCommand {\n        constructor() {\n            super({\n                id: 'cursorColumnSelectRight',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 17 /* KeyCode.RightArrow */,\n                    linux: { primary: 0 }\n                }\n            });\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            return ColumnSelection.columnSelectRight(viewModel.cursorConfig, viewModel, prevColumnSelectData);\n        }\n    });\n    class ColumnSelectUpCommand extends ColumnSelectCommand {\n        constructor(opts) {\n            super(opts);\n            this._isPaged = opts.isPaged;\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            return ColumnSelection.columnSelectUp(viewModel.cursorConfig, viewModel, prevColumnSelectData, this._isPaged);\n        }\n    }\n    CoreNavigationCommands.CursorColumnSelectUp = registerEditorCommand(new ColumnSelectUpCommand({\n        isPaged: false,\n        id: 'cursorColumnSelectUp',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 16 /* KeyCode.UpArrow */,\n            linux: { primary: 0 }\n        }\n    }));\n    CoreNavigationCommands.CursorColumnSelectPageUp = registerEditorCommand(new ColumnSelectUpCommand({\n        isPaged: true,\n        id: 'cursorColumnSelectPageUp',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 11 /* KeyCode.PageUp */,\n            linux: { primary: 0 }\n        }\n    }));\n    class ColumnSelectDownCommand extends ColumnSelectCommand {\n        constructor(opts) {\n            super(opts);\n            this._isPaged = opts.isPaged;\n        }\n        _getColumnSelectResult(viewModel, primary, prevColumnSelectData, args) {\n            return ColumnSelection.columnSelectDown(viewModel.cursorConfig, viewModel, prevColumnSelectData, this._isPaged);\n        }\n    }\n    CoreNavigationCommands.CursorColumnSelectDown = registerEditorCommand(new ColumnSelectDownCommand({\n        isPaged: false,\n        id: 'cursorColumnSelectDown',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 18 /* KeyCode.DownArrow */,\n            linux: { primary: 0 }\n        }\n    }));\n    CoreNavigationCommands.CursorColumnSelectPageDown = registerEditorCommand(new ColumnSelectDownCommand({\n        isPaged: true,\n        id: 'cursorColumnSelectPageDown',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 512 /* KeyMod.Alt */ | 12 /* KeyCode.PageDown */,\n            linux: { primary: 0 }\n        }\n    }));\n    class CursorMoveImpl extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'cursorMove',\n                precondition: undefined,\n                description: CursorMove_.description\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const parsed = CursorMove_.parse(args);\n            if (!parsed) {\n                // illegal arguments\n                return;\n            }\n            this._runCursorMove(viewModel, args.source, parsed);\n        }\n        _runCursorMove(viewModel, source, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(source, 3 /* CursorChangeReason.Explicit */, CursorMoveImpl._move(viewModel, viewModel.getCursorStates(), args));\n            viewModel.revealPrimaryCursor(source, true);\n        }\n        static _move(viewModel, cursors, args) {\n            const inSelectionMode = args.select;\n            const value = args.value;\n            switch (args.direction) {\n                case 0 /* CursorMove_.Direction.Left */:\n                case 1 /* CursorMove_.Direction.Right */:\n                case 2 /* CursorMove_.Direction.Up */:\n                case 3 /* CursorMove_.Direction.Down */:\n                case 4 /* CursorMove_.Direction.PrevBlankLine */:\n                case 5 /* CursorMove_.Direction.NextBlankLine */:\n                case 6 /* CursorMove_.Direction.WrappedLineStart */:\n                case 7 /* CursorMove_.Direction.WrappedLineFirstNonWhitespaceCharacter */:\n                case 8 /* CursorMove_.Direction.WrappedLineColumnCenter */:\n                case 9 /* CursorMove_.Direction.WrappedLineEnd */:\n                case 10 /* CursorMove_.Direction.WrappedLineLastNonWhitespaceCharacter */:\n                    return CursorMoveCommands.simpleMove(viewModel, cursors, args.direction, inSelectionMode, value, args.unit);\n                case 11 /* CursorMove_.Direction.ViewPortTop */:\n                case 13 /* CursorMove_.Direction.ViewPortBottom */:\n                case 12 /* CursorMove_.Direction.ViewPortCenter */:\n                case 14 /* CursorMove_.Direction.ViewPortIfOutside */:\n                    return CursorMoveCommands.viewportMove(viewModel, cursors, args.direction, inSelectionMode, value);\n                default:\n                    return null;\n            }\n        }\n    }\n    CoreNavigationCommands.CursorMoveImpl = CursorMoveImpl;\n    CoreNavigationCommands.CursorMove = registerEditorCommand(new CursorMoveImpl());\n    class CursorMoveBasedCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._staticArgs = opts.args;\n        }\n        runCoreEditorCommand(viewModel, dynamicArgs) {\n            let args = this._staticArgs;\n            if (this._staticArgs.value === -1 /* Constants.PAGE_SIZE_MARKER */) {\n                // -1 is a marker for page size\n                args = {\n                    direction: this._staticArgs.direction,\n                    unit: this._staticArgs.unit,\n                    select: this._staticArgs.select,\n                    value: dynamicArgs.pageSize || viewModel.cursorConfig.pageSize\n                };\n            }\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(dynamicArgs.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.simpleMove(viewModel, viewModel.getCursorStates(), args.direction, args.select, args.value, args.unit));\n            viewModel.revealPrimaryCursor(dynamicArgs.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorLeft = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 0 /* CursorMove_.Direction.Left */,\n            unit: 0 /* CursorMove_.Unit.None */,\n            select: false,\n            value: 1\n        },\n        id: 'cursorLeft',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 15 /* KeyCode.LeftArrow */,\n            mac: { primary: 15 /* KeyCode.LeftArrow */, secondary: [256 /* KeyMod.WinCtrl */ | 32 /* KeyCode.KeyB */] }\n        }\n    }));\n    CoreNavigationCommands.CursorLeftSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 0 /* CursorMove_.Direction.Left */,\n            unit: 0 /* CursorMove_.Unit.None */,\n            select: true,\n            value: 1\n        },\n        id: 'cursorLeftSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */\n        }\n    }));\n    CoreNavigationCommands.CursorRight = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 1 /* CursorMove_.Direction.Right */,\n            unit: 0 /* CursorMove_.Unit.None */,\n            select: false,\n            value: 1\n        },\n        id: 'cursorRight',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 17 /* KeyCode.RightArrow */,\n            mac: { primary: 17 /* KeyCode.RightArrow */, secondary: [256 /* KeyMod.WinCtrl */ | 36 /* KeyCode.KeyF */] }\n        }\n    }));\n    CoreNavigationCommands.CursorRightSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 1 /* CursorMove_.Direction.Right */,\n            unit: 0 /* CursorMove_.Unit.None */,\n            select: true,\n            value: 1\n        },\n        id: 'cursorRightSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */\n        }\n    }));\n    CoreNavigationCommands.CursorUp = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 2 /* CursorMove_.Direction.Up */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: false,\n            value: 1\n        },\n        id: 'cursorUp',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 16 /* KeyCode.UpArrow */,\n            mac: { primary: 16 /* KeyCode.UpArrow */, secondary: [256 /* KeyMod.WinCtrl */ | 46 /* KeyCode.KeyP */] }\n        }\n    }));\n    CoreNavigationCommands.CursorUpSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 2 /* CursorMove_.Direction.Up */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: true,\n            value: 1\n        },\n        id: 'cursorUpSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */,\n            secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */],\n            mac: { primary: 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */ },\n            linux: { primary: 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */ }\n        }\n    }));\n    CoreNavigationCommands.CursorPageUp = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 2 /* CursorMove_.Direction.Up */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: false,\n            value: -1 /* Constants.PAGE_SIZE_MARKER */\n        },\n        id: 'cursorPageUp',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 11 /* KeyCode.PageUp */\n        }\n    }));\n    CoreNavigationCommands.CursorPageUpSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 2 /* CursorMove_.Direction.Up */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: true,\n            value: -1 /* Constants.PAGE_SIZE_MARKER */\n        },\n        id: 'cursorPageUpSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 11 /* KeyCode.PageUp */\n        }\n    }));\n    CoreNavigationCommands.CursorDown = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 3 /* CursorMove_.Direction.Down */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: false,\n            value: 1\n        },\n        id: 'cursorDown',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 18 /* KeyCode.DownArrow */,\n            mac: { primary: 18 /* KeyCode.DownArrow */, secondary: [256 /* KeyMod.WinCtrl */ | 44 /* KeyCode.KeyN */] }\n        }\n    }));\n    CoreNavigationCommands.CursorDownSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 3 /* CursorMove_.Direction.Down */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: true,\n            value: 1\n        },\n        id: 'cursorDownSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */,\n            secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */],\n            mac: { primary: 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */ },\n            linux: { primary: 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */ }\n        }\n    }));\n    CoreNavigationCommands.CursorPageDown = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 3 /* CursorMove_.Direction.Down */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: false,\n            value: -1 /* Constants.PAGE_SIZE_MARKER */\n        },\n        id: 'cursorPageDown',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 12 /* KeyCode.PageDown */\n        }\n    }));\n    CoreNavigationCommands.CursorPageDownSelect = registerEditorCommand(new CursorMoveBasedCommand({\n        args: {\n            direction: 3 /* CursorMove_.Direction.Down */,\n            unit: 2 /* CursorMove_.Unit.WrappedLine */,\n            select: true,\n            value: -1 /* Constants.PAGE_SIZE_MARKER */\n        },\n        id: 'cursorPageDownSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 12 /* KeyCode.PageDown */\n        }\n    }));\n    CoreNavigationCommands.CreateCursor = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'createCursor',\n                precondition: undefined\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            if (!args.position) {\n                return;\n            }\n            let newState;\n            if (args.wholeLine) {\n                newState = CursorMoveCommands.line(viewModel, viewModel.getPrimaryCursorState(), false, args.position, args.viewPosition);\n            }\n            else {\n                newState = CursorMoveCommands.moveTo(viewModel, viewModel.getPrimaryCursorState(), false, args.position, args.viewPosition);\n            }\n            const states = viewModel.getCursorStates();\n            // Check if we should remove a cursor (sort of like a toggle)\n            if (states.length > 1) {\n                const newModelPosition = (newState.modelState ? newState.modelState.position : null);\n                const newViewPosition = (newState.viewState ? newState.viewState.position : null);\n                for (let i = 0, len = states.length; i < len; i++) {\n                    const state = states[i];\n                    if (newModelPosition && !state.modelState.selection.containsPosition(newModelPosition)) {\n                        continue;\n                    }\n                    if (newViewPosition && !state.viewState.selection.containsPosition(newViewPosition)) {\n                        continue;\n                    }\n                    // => Remove the cursor\n                    states.splice(i, 1);\n                    viewModel.model.pushStackElement();\n                    viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, states);\n                    return;\n                }\n            }\n            // => Add the new cursor\n            states.push(newState);\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, states);\n        }\n    });\n    CoreNavigationCommands.LastCursorMoveToSelect = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: '_lastCursorMoveToSelect',\n                precondition: undefined\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            if (!args.position) {\n                return;\n            }\n            const lastAddedCursorIndex = viewModel.getLastAddedCursorIndex();\n            const states = viewModel.getCursorStates();\n            const newStates = states.slice(0);\n            newStates[lastAddedCursorIndex] = CursorMoveCommands.moveTo(viewModel, states[lastAddedCursorIndex], true, args.position, args.viewPosition);\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, newStates);\n        }\n    });\n    class HomeCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.moveToBeginningOfLine(viewModel, viewModel.getCursorStates(), this._inSelectionMode));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorHome = registerEditorCommand(new HomeCommand({\n        inSelectionMode: false,\n        id: 'cursorHome',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 14 /* KeyCode.Home */,\n            mac: { primary: 14 /* KeyCode.Home */, secondary: [2048 /* KeyMod.CtrlCmd */ | 15 /* KeyCode.LeftArrow */] }\n        }\n    }));\n    CoreNavigationCommands.CursorHomeSelect = registerEditorCommand(new HomeCommand({\n        inSelectionMode: true,\n        id: 'cursorHomeSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 14 /* KeyCode.Home */,\n            mac: { primary: 1024 /* KeyMod.Shift */ | 14 /* KeyCode.Home */, secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */] }\n        }\n    }));\n    class LineStartCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, this._exec(viewModel.getCursorStates()));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n        _exec(cursors) {\n            const result = [];\n            for (let i = 0, len = cursors.length; i < len; i++) {\n                const cursor = cursors[i];\n                const lineNumber = cursor.modelState.position.lineNumber;\n                result[i] = CursorState.fromModelState(cursor.modelState.move(this._inSelectionMode, lineNumber, 1, 0));\n            }\n            return result;\n        }\n    }\n    CoreNavigationCommands.CursorLineStart = registerEditorCommand(new LineStartCommand({\n        inSelectionMode: false,\n        id: 'cursorLineStart',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 0,\n            mac: { primary: 256 /* KeyMod.WinCtrl */ | 31 /* KeyCode.KeyA */ }\n        }\n    }));\n    CoreNavigationCommands.CursorLineStartSelect = registerEditorCommand(new LineStartCommand({\n        inSelectionMode: true,\n        id: 'cursorLineStartSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 0,\n            mac: { primary: 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 31 /* KeyCode.KeyA */ }\n        }\n    }));\n    class EndCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.moveToEndOfLine(viewModel, viewModel.getCursorStates(), this._inSelectionMode, args.sticky || false));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorEnd = registerEditorCommand(new EndCommand({\n        inSelectionMode: false,\n        id: 'cursorEnd',\n        precondition: undefined,\n        kbOpts: {\n            args: { sticky: false },\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 13 /* KeyCode.End */,\n            mac: { primary: 13 /* KeyCode.End */, secondary: [2048 /* KeyMod.CtrlCmd */ | 17 /* KeyCode.RightArrow */] }\n        },\n        description: {\n            description: `Go to End`,\n            args: [{\n                    name: 'args',\n                    schema: {\n                        type: 'object',\n                        properties: {\n                            'sticky': {\n                                description: nls.localize('stickydesc', \"Stick to the end even when going to longer lines\"),\n                                type: 'boolean',\n                                default: false\n                            }\n                        }\n                    }\n                }]\n        }\n    }));\n    CoreNavigationCommands.CursorEndSelect = registerEditorCommand(new EndCommand({\n        inSelectionMode: true,\n        id: 'cursorEndSelect',\n        precondition: undefined,\n        kbOpts: {\n            args: { sticky: false },\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 1024 /* KeyMod.Shift */ | 13 /* KeyCode.End */,\n            mac: { primary: 1024 /* KeyMod.Shift */ | 13 /* KeyCode.End */, secondary: [2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */] }\n        },\n        description: {\n            description: `Select to End`,\n            args: [{\n                    name: 'args',\n                    schema: {\n                        type: 'object',\n                        properties: {\n                            'sticky': {\n                                description: nls.localize('stickydesc', \"Stick to the end even when going to longer lines\"),\n                                type: 'boolean',\n                                default: false\n                            }\n                        }\n                    }\n                }]\n        }\n    }));\n    class LineEndCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, this._exec(viewModel, viewModel.getCursorStates()));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n        _exec(viewModel, cursors) {\n            const result = [];\n            for (let i = 0, len = cursors.length; i < len; i++) {\n                const cursor = cursors[i];\n                const lineNumber = cursor.modelState.position.lineNumber;\n                const maxColumn = viewModel.model.getLineMaxColumn(lineNumber);\n                result[i] = CursorState.fromModelState(cursor.modelState.move(this._inSelectionMode, lineNumber, maxColumn, 0));\n            }\n            return result;\n        }\n    }\n    CoreNavigationCommands.CursorLineEnd = registerEditorCommand(new LineEndCommand({\n        inSelectionMode: false,\n        id: 'cursorLineEnd',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 0,\n            mac: { primary: 256 /* KeyMod.WinCtrl */ | 35 /* KeyCode.KeyE */ }\n        }\n    }));\n    CoreNavigationCommands.CursorLineEndSelect = registerEditorCommand(new LineEndCommand({\n        inSelectionMode: true,\n        id: 'cursorLineEndSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 0,\n            mac: { primary: 256 /* KeyMod.WinCtrl */ | 1024 /* KeyMod.Shift */ | 35 /* KeyCode.KeyE */ }\n        }\n    }));\n    class TopCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.moveToBeginningOfBuffer(viewModel, viewModel.getCursorStates(), this._inSelectionMode));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorTop = registerEditorCommand(new TopCommand({\n        inSelectionMode: false,\n        id: 'cursorTop',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 14 /* KeyCode.Home */,\n            mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */ }\n        }\n    }));\n    CoreNavigationCommands.CursorTopSelect = registerEditorCommand(new TopCommand({\n        inSelectionMode: true,\n        id: 'cursorTopSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 14 /* KeyCode.Home */,\n            mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */ }\n        }\n    }));\n    class BottomCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, CursorMoveCommands.moveToEndOfBuffer(viewModel, viewModel.getCursorStates(), this._inSelectionMode));\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    }\n    CoreNavigationCommands.CursorBottom = registerEditorCommand(new BottomCommand({\n        inSelectionMode: false,\n        id: 'cursorBottom',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 13 /* KeyCode.End */,\n            mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */ }\n        }\n    }));\n    CoreNavigationCommands.CursorBottomSelect = registerEditorCommand(new BottomCommand({\n        inSelectionMode: true,\n        id: 'cursorBottomSelect',\n        precondition: undefined,\n        kbOpts: {\n            weight: CORE_WEIGHT,\n            kbExpr: EditorContextKeys.textInputFocus,\n            primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 13 /* KeyCode.End */,\n            mac: { primary: 2048 /* KeyMod.CtrlCmd */ | 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */ }\n        }\n    }));\n    class EditorScrollImpl extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'editorScroll',\n                precondition: undefined,\n                description: EditorScroll_.description\n            });\n        }\n        determineScrollMethod(args) {\n            const horizontalUnits = [6 /* EditorScroll_.Unit.Column */];\n            const verticalUnits = [\n                1 /* EditorScroll_.Unit.Line */,\n                2 /* EditorScroll_.Unit.WrappedLine */,\n                3 /* EditorScroll_.Unit.Page */,\n                4 /* EditorScroll_.Unit.HalfPage */,\n                5 /* EditorScroll_.Unit.Editor */,\n                6 /* EditorScroll_.Unit.Column */\n            ];\n            const horizontalDirections = [4 /* EditorScroll_.Direction.Left */, 2 /* EditorScroll_.Direction.Right */];\n            const verticalDirections = [1 /* EditorScroll_.Direction.Up */, 3 /* EditorScroll_.Direction.Down */];\n            if (horizontalUnits.includes(args.unit) && horizontalDirections.includes(args.direction)) {\n                return this._runHorizontalEditorScroll.bind(this);\n            }\n            if (verticalUnits.includes(args.unit) && verticalDirections.includes(args.direction)) {\n                return this._runVerticalEditorScroll.bind(this);\n            }\n            return null;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const parsed = EditorScroll_.parse(args);\n            if (!parsed) {\n                // illegal arguments\n                return;\n            }\n            const runEditorScroll = this.determineScrollMethod(parsed);\n            if (!runEditorScroll) {\n                // Incompatible unit and direction\n                return;\n            }\n            runEditorScroll(viewModel, args.source, parsed);\n        }\n        _runVerticalEditorScroll(viewModel, source, args) {\n            const desiredScrollTop = this._computeDesiredScrollTop(viewModel, args);\n            if (args.revealCursor) {\n                // must ensure cursor is in new visible range\n                const desiredVisibleViewRange = viewModel.getCompletelyVisibleViewRangeAtScrollTop(desiredScrollTop);\n                viewModel.setCursorStates(source, 3 /* CursorChangeReason.Explicit */, [\n                    CursorMoveCommands.findPositionInViewportIfOutside(viewModel, viewModel.getPrimaryCursorState(), desiredVisibleViewRange, args.select)\n                ]);\n            }\n            viewModel.viewLayout.setScrollPosition({ scrollTop: desiredScrollTop }, 0 /* ScrollType.Smooth */);\n        }\n        _computeDesiredScrollTop(viewModel, args) {\n            if (args.unit === 1 /* EditorScroll_.Unit.Line */) {\n                // scrolling by model lines\n                const futureViewport = viewModel.viewLayout.getFutureViewport();\n                const visibleViewRange = viewModel.getCompletelyVisibleViewRangeAtScrollTop(futureViewport.top);\n                const visibleModelRange = viewModel.coordinatesConverter.convertViewRangeToModelRange(visibleViewRange);\n                let desiredTopModelLineNumber;\n                if (args.direction === 1 /* EditorScroll_.Direction.Up */) {\n                    // must go x model lines up\n                    desiredTopModelLineNumber = Math.max(1, visibleModelRange.startLineNumber - args.value);\n                }\n                else {\n                    // must go x model lines down\n                    desiredTopModelLineNumber = Math.min(viewModel.model.getLineCount(), visibleModelRange.startLineNumber + args.value);\n                }\n                const viewPosition = viewModel.coordinatesConverter.convertModelPositionToViewPosition(new Position(desiredTopModelLineNumber, 1));\n                return viewModel.viewLayout.getVerticalOffsetForLineNumber(viewPosition.lineNumber);\n            }\n            if (args.unit === 5 /* EditorScroll_.Unit.Editor */) {\n                let desiredTopModelLineNumber = 0;\n                if (args.direction === 3 /* EditorScroll_.Direction.Down */) {\n                    desiredTopModelLineNumber = viewModel.model.getLineCount() - viewModel.cursorConfig.pageSize;\n                }\n                return viewModel.viewLayout.getVerticalOffsetForLineNumber(desiredTopModelLineNumber);\n            }\n            let noOfLines;\n            if (args.unit === 3 /* EditorScroll_.Unit.Page */) {\n                noOfLines = viewModel.cursorConfig.pageSize * args.value;\n            }\n            else if (args.unit === 4 /* EditorScroll_.Unit.HalfPage */) {\n                noOfLines = Math.round(viewModel.cursorConfig.pageSize / 2) * args.value;\n            }\n            else {\n                noOfLines = args.value;\n            }\n            const deltaLines = (args.direction === 1 /* EditorScroll_.Direction.Up */ ? -1 : 1) * noOfLines;\n            return viewModel.viewLayout.getCurrentScrollTop() + deltaLines * viewModel.cursorConfig.lineHeight;\n        }\n        _runHorizontalEditorScroll(viewModel, source, args) {\n            const desiredScrollLeft = this._computeDesiredScrollLeft(viewModel, args);\n            viewModel.viewLayout.setScrollPosition({ scrollLeft: desiredScrollLeft }, 0 /* ScrollType.Smooth */);\n        }\n        _computeDesiredScrollLeft(viewModel, args) {\n            const deltaColumns = (args.direction === 4 /* EditorScroll_.Direction.Left */ ? -1 : 1) * args.value;\n            return viewModel.viewLayout.getCurrentScrollLeft() + deltaColumns * viewModel.cursorConfig.typicalHalfwidthCharacterWidth;\n        }\n    }\n    CoreNavigationCommands.EditorScrollImpl = EditorScrollImpl;\n    CoreNavigationCommands.EditorScroll = registerEditorCommand(new EditorScrollImpl());\n    CoreNavigationCommands.ScrollLineUp = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollLineUp',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 16 /* KeyCode.UpArrow */,\n                    mac: { primary: 256 /* KeyMod.WinCtrl */ | 11 /* KeyCode.PageUp */ }\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll.runCoreEditorCommand(viewModel, {\n                to: EditorScroll_.RawDirection.Up,\n                by: EditorScroll_.RawUnit.WrappedLine,\n                value: 1,\n                revealCursor: false,\n                select: false,\n                source: args.source\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollPageUp = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollPageUp',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 11 /* KeyCode.PageUp */,\n                    win: { primary: 512 /* KeyMod.Alt */ | 11 /* KeyCode.PageUp */ },\n                    linux: { primary: 512 /* KeyMod.Alt */ | 11 /* KeyCode.PageUp */ }\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll.runCoreEditorCommand(viewModel, {\n                to: EditorScroll_.RawDirection.Up,\n                by: EditorScroll_.RawUnit.Page,\n                value: 1,\n                revealCursor: false,\n                select: false,\n                source: args.source\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollEditorTop = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollEditorTop',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll.runCoreEditorCommand(viewModel, {\n                to: EditorScroll_.RawDirection.Up,\n                by: EditorScroll_.RawUnit.Editor,\n                value: 1,\n                revealCursor: false,\n                select: false,\n                source: args.source\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollLineDown = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollLineDown',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 18 /* KeyCode.DownArrow */,\n                    mac: { primary: 256 /* KeyMod.WinCtrl */ | 12 /* KeyCode.PageDown */ }\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll.runCoreEditorCommand(viewModel, {\n                to: EditorScroll_.RawDirection.Down,\n                by: EditorScroll_.RawUnit.WrappedLine,\n                value: 1,\n                revealCursor: false,\n                select: false,\n                source: args.source\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollPageDown = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollPageDown',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 2048 /* KeyMod.CtrlCmd */ | 12 /* KeyCode.PageDown */,\n                    win: { primary: 512 /* KeyMod.Alt */ | 12 /* KeyCode.PageDown */ },\n                    linux: { primary: 512 /* KeyMod.Alt */ | 12 /* KeyCode.PageDown */ }\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll.runCoreEditorCommand(viewModel, {\n                to: EditorScroll_.RawDirection.Down,\n                by: EditorScroll_.RawUnit.Page,\n                value: 1,\n                revealCursor: false,\n                select: false,\n                source: args.source\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollEditorBottom = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollEditorBottom',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll.runCoreEditorCommand(viewModel, {\n                to: EditorScroll_.RawDirection.Down,\n                by: EditorScroll_.RawUnit.Editor,\n                value: 1,\n                revealCursor: false,\n                select: false,\n                source: args.source\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollLeft = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollLeft',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll.runCoreEditorCommand(viewModel, {\n                to: EditorScroll_.RawDirection.Left,\n                by: EditorScroll_.RawUnit.Column,\n                value: 2,\n                revealCursor: false,\n                select: false,\n                source: args.source\n            });\n        }\n    });\n    CoreNavigationCommands.ScrollRight = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'scrollRight',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            CoreNavigationCommands.EditorScroll.runCoreEditorCommand(viewModel, {\n                to: EditorScroll_.RawDirection.Right,\n                by: EditorScroll_.RawUnit.Column,\n                value: 2,\n                revealCursor: false,\n                select: false,\n                source: args.source\n            });\n        }\n    });\n    class WordCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            if (!args.position) {\n                return;\n            }\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, [\n                CursorMoveCommands.word(viewModel, viewModel.getPrimaryCursorState(), this._inSelectionMode, args.position)\n            ]);\n            if (args.revealType !== 2 /* NavigationCommandRevealType.None */) {\n                viewModel.revealPrimaryCursor(args.source, true, true);\n            }\n        }\n    }\n    CoreNavigationCommands.WordSelect = registerEditorCommand(new WordCommand({\n        inSelectionMode: false,\n        id: '_wordSelect',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.WordSelectDrag = registerEditorCommand(new WordCommand({\n        inSelectionMode: true,\n        id: '_wordSelectDrag',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.LastCursorWordSelect = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'lastCursorWordSelect',\n                precondition: undefined\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            if (!args.position) {\n                return;\n            }\n            const lastAddedCursorIndex = viewModel.getLastAddedCursorIndex();\n            const states = viewModel.getCursorStates();\n            const newStates = states.slice(0);\n            const lastAddedState = states[lastAddedCursorIndex];\n            newStates[lastAddedCursorIndex] = CursorMoveCommands.word(viewModel, lastAddedState, lastAddedState.modelState.hasSelection(), args.position);\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, newStates);\n        }\n    });\n    class LineCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            if (!args.position) {\n                return;\n            }\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, [\n                CursorMoveCommands.line(viewModel, viewModel.getPrimaryCursorState(), this._inSelectionMode, args.position, args.viewPosition)\n            ]);\n            if (args.revealType !== 2 /* NavigationCommandRevealType.None */) {\n                viewModel.revealPrimaryCursor(args.source, false, true);\n            }\n        }\n    }\n    CoreNavigationCommands.LineSelect = registerEditorCommand(new LineCommand({\n        inSelectionMode: false,\n        id: '_lineSelect',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.LineSelectDrag = registerEditorCommand(new LineCommand({\n        inSelectionMode: true,\n        id: '_lineSelectDrag',\n        precondition: undefined\n    }));\n    class LastCursorLineCommand extends CoreEditorCommand {\n        constructor(opts) {\n            super(opts);\n            this._inSelectionMode = opts.inSelectionMode;\n        }\n        runCoreEditorCommand(viewModel, args) {\n            if (!args.position) {\n                return;\n            }\n            const lastAddedCursorIndex = viewModel.getLastAddedCursorIndex();\n            const states = viewModel.getCursorStates();\n            const newStates = states.slice(0);\n            newStates[lastAddedCursorIndex] = CursorMoveCommands.line(viewModel, states[lastAddedCursorIndex], this._inSelectionMode, args.position, args.viewPosition);\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, newStates);\n        }\n    }\n    CoreNavigationCommands.LastCursorLineSelect = registerEditorCommand(new LastCursorLineCommand({\n        inSelectionMode: false,\n        id: 'lastCursorLineSelect',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.LastCursorLineSelectDrag = registerEditorCommand(new LastCursorLineCommand({\n        inSelectionMode: true,\n        id: 'lastCursorLineSelectDrag',\n        precondition: undefined\n    }));\n    CoreNavigationCommands.CancelSelection = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'cancelSelection',\n                precondition: EditorContextKeys.hasNonEmptySelection,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 9 /* KeyCode.Escape */,\n                    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, [\n                CursorMoveCommands.cancelSelection(viewModel, viewModel.getPrimaryCursorState())\n            ]);\n            viewModel.revealPrimaryCursor(args.source, true);\n        }\n    });\n    CoreNavigationCommands.RemoveSecondaryCursors = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'removeSecondaryCursors',\n                precondition: EditorContextKeys.hasMultipleSelections,\n                kbOpts: {\n                    weight: CORE_WEIGHT + 1,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 9 /* KeyCode.Escape */,\n                    secondary: [1024 /* KeyMod.Shift */ | 9 /* KeyCode.Escape */]\n                }\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, [\n                viewModel.getPrimaryCursorState()\n            ]);\n            viewModel.revealPrimaryCursor(args.source, true);\n            status(nls.localize('removedCursor', \"Removed secondary cursors\"));\n        }\n    });\n    CoreNavigationCommands.RevealLine = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'revealLine',\n                precondition: undefined,\n                description: RevealLine_.description\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            const revealLineArg = args;\n            const lineNumberArg = revealLineArg.lineNumber || 0;\n            let lineNumber = typeof lineNumberArg === 'number' ? (lineNumberArg + 1) : (parseInt(lineNumberArg) + 1);\n            if (lineNumber < 1) {\n                lineNumber = 1;\n            }\n            const lineCount = viewModel.model.getLineCount();\n            if (lineNumber > lineCount) {\n                lineNumber = lineCount;\n            }\n            const range = new Range(lineNumber, 1, lineNumber, viewModel.model.getLineMaxColumn(lineNumber));\n            let revealAt = 0 /* VerticalRevealType.Simple */;\n            if (revealLineArg.at) {\n                switch (revealLineArg.at) {\n                    case RevealLine_.RawAtArgument.Top:\n                        revealAt = 3 /* VerticalRevealType.Top */;\n                        break;\n                    case RevealLine_.RawAtArgument.Center:\n                        revealAt = 1 /* VerticalRevealType.Center */;\n                        break;\n                    case RevealLine_.RawAtArgument.Bottom:\n                        revealAt = 4 /* VerticalRevealType.Bottom */;\n                        break;\n                    default:\n                        break;\n                }\n            }\n            const viewRange = viewModel.coordinatesConverter.convertModelRangeToViewRange(range);\n            viewModel.revealRange(args.source, false, viewRange, revealAt, 0 /* ScrollType.Smooth */);\n        }\n    });\n    CoreNavigationCommands.SelectAll = new class extends EditorOrNativeTextInputCommand {\n        constructor() {\n            super(SelectAllCommand);\n        }\n        runDOMCommand(activeElement) {\n            if (isFirefox) {\n                activeElement.focus();\n                activeElement.select();\n            }\n            activeElement.ownerDocument.execCommand('selectAll');\n        }\n        runEditorCommand(accessor, editor, args) {\n            const viewModel = editor._getViewModel();\n            if (!viewModel) {\n                // the editor has no view => has no cursors\n                return;\n            }\n            this.runCoreEditorCommand(viewModel, args);\n        }\n        runCoreEditorCommand(viewModel, args) {\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates('keyboard', 3 /* CursorChangeReason.Explicit */, [\n                CursorMoveCommands.selectAll(viewModel, viewModel.getPrimaryCursorState())\n            ]);\n        }\n    }();\n    CoreNavigationCommands.SetSelection = registerEditorCommand(new class extends CoreEditorCommand {\n        constructor() {\n            super({\n                id: 'setSelection',\n                precondition: undefined\n            });\n        }\n        runCoreEditorCommand(viewModel, args) {\n            if (!args.selection) {\n                return;\n            }\n            viewModel.model.pushStackElement();\n            viewModel.setCursorStates(args.source, 3 /* CursorChangeReason.Explicit */, [\n                CursorState.fromModelSelection(args.selection)\n            ]);\n        }\n    });\n})(CoreNavigationCommands || (CoreNavigationCommands = {}));\nconst columnSelectionCondition = ContextKeyExpr.and(EditorContextKeys.textInputFocus, EditorContextKeys.columnSelection);\nfunction registerColumnSelection(id, keybinding) {\n    KeybindingsRegistry.registerKeybindingRule({\n        id: id,\n        primary: keybinding,\n        when: columnSelectionCondition,\n        weight: CORE_WEIGHT + 1\n    });\n}\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectLeft.id, 1024 /* KeyMod.Shift */ | 15 /* KeyCode.LeftArrow */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectRight.id, 1024 /* KeyMod.Shift */ | 17 /* KeyCode.RightArrow */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectUp.id, 1024 /* KeyMod.Shift */ | 16 /* KeyCode.UpArrow */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectPageUp.id, 1024 /* KeyMod.Shift */ | 11 /* KeyCode.PageUp */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectDown.id, 1024 /* KeyMod.Shift */ | 18 /* KeyCode.DownArrow */);\nregisterColumnSelection(CoreNavigationCommands.CursorColumnSelectPageDown.id, 1024 /* KeyMod.Shift */ | 12 /* KeyCode.PageDown */);\nfunction registerCommand(command) {\n    command.register();\n    return command;\n}\nexport var CoreEditingCommands;\n(function (CoreEditingCommands) {\n    class CoreEditingCommand extends EditorCommand {\n        runEditorCommand(accessor, editor, args) {\n            const viewModel = editor._getViewModel();\n            if (!viewModel) {\n                // the editor has no view => has no cursors\n                return;\n            }\n            this.runCoreEditingCommand(editor, viewModel, args || {});\n        }\n    }\n    CoreEditingCommands.CoreEditingCommand = CoreEditingCommand;\n    CoreEditingCommands.LineBreakInsert = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'lineBreakInsert',\n                precondition: EditorContextKeys.writable,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 0,\n                    mac: { primary: 256 /* KeyMod.WinCtrl */ | 45 /* KeyCode.KeyO */ }\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            editor.pushUndoStop();\n            editor.executeCommands(this.id, TypeOperations.lineBreakInsert(viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection)));\n        }\n    });\n    CoreEditingCommands.Outdent = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'outdent',\n                precondition: EditorContextKeys.writable,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.tabDoesNotMoveFocus),\n                    primary: 1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            editor.pushUndoStop();\n            editor.executeCommands(this.id, TypeOperations.outdent(viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection)));\n            editor.pushUndoStop();\n        }\n    });\n    CoreEditingCommands.Tab = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'tab',\n                precondition: EditorContextKeys.writable,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: ContextKeyExpr.and(EditorContextKeys.editorTextFocus, EditorContextKeys.tabDoesNotMoveFocus),\n                    primary: 2 /* KeyCode.Tab */\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            editor.pushUndoStop();\n            editor.executeCommands(this.id, TypeOperations.tab(viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection)));\n            editor.pushUndoStop();\n        }\n    });\n    CoreEditingCommands.DeleteLeft = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'deleteLeft',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 1 /* KeyCode.Backspace */,\n                    secondary: [1024 /* KeyMod.Shift */ | 1 /* KeyCode.Backspace */],\n                    mac: { primary: 1 /* KeyCode.Backspace */, secondary: [1024 /* KeyMod.Shift */ | 1 /* KeyCode.Backspace */, 256 /* KeyMod.WinCtrl */ | 38 /* KeyCode.KeyH */, 256 /* KeyMod.WinCtrl */ | 1 /* KeyCode.Backspace */] }\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            const [shouldPushStackElementBefore, commands] = DeleteOperations.deleteLeft(viewModel.getPrevEditOperationType(), viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection), viewModel.getCursorAutoClosedCharacters());\n            if (shouldPushStackElementBefore) {\n                editor.pushUndoStop();\n            }\n            editor.executeCommands(this.id, commands);\n            viewModel.setPrevEditOperationType(2 /* EditOperationType.DeletingLeft */);\n        }\n    });\n    CoreEditingCommands.DeleteRight = registerEditorCommand(new class extends CoreEditingCommand {\n        constructor() {\n            super({\n                id: 'deleteRight',\n                precondition: undefined,\n                kbOpts: {\n                    weight: CORE_WEIGHT,\n                    kbExpr: EditorContextKeys.textInputFocus,\n                    primary: 20 /* KeyCode.Delete */,\n                    mac: { primary: 20 /* KeyCode.Delete */, secondary: [256 /* KeyMod.WinCtrl */ | 34 /* KeyCode.KeyD */, 256 /* KeyMod.WinCtrl */ | 20 /* KeyCode.Delete */] }\n                }\n            });\n        }\n        runCoreEditingCommand(editor, viewModel, args) {\n            const [shouldPushStackElementBefore, commands] = DeleteOperations.deleteRight(viewModel.getPrevEditOperationType(), viewModel.cursorConfig, viewModel.model, viewModel.getCursorStates().map(s => s.modelState.selection));\n            if (shouldPushStackElementBefore) {\n                editor.pushUndoStop();\n            }\n            editor.executeCommands(this.id, commands);\n            viewModel.setPrevEditOperationType(3 /* EditOperationType.DeletingRight */);\n        }\n    });\n    CoreEditingCommands.Undo = new class extends EditorOrNativeTextInputCommand {\n        constructor() {\n            super(UndoCommand);\n        }\n        runDOMCommand(activeElement) {\n            activeElement.ownerDocument.execCommand('undo');\n        }\n        runEditorCommand(accessor, editor, args) {\n            if (!editor.hasModel() || editor.getOption(90 /* EditorOption.readOnly */) === true) {\n                return;\n            }\n            return editor.getModel().undo();\n        }\n    }();\n    CoreEditingCommands.Redo = new class extends EditorOrNativeTextInputCommand {\n        constructor() {\n            super(RedoCommand);\n        }\n        runDOMCommand(activeElement) {\n            activeElement.ownerDocument.execCommand('redo');\n        }\n        runEditorCommand(accessor, editor, args) {\n            if (!editor.hasModel() || editor.getOption(90 /* EditorOption.readOnly */) === true) {\n                return;\n            }\n            return editor.getModel().redo();\n        }\n    }();\n})(CoreEditingCommands || (CoreEditingCommands = {}));\n/**\n * A command that will invoke a command on the focused editor.\n */\nclass EditorHandlerCommand extends Command {\n    constructor(id, handlerId, description) {\n        super({\n            id: id,\n            precondition: undefined,\n            description: description\n        });\n        this._handlerId = handlerId;\n    }\n    runCommand(accessor, args) {\n        const editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n        if (!editor) {\n            return;\n        }\n        editor.trigger('keyboard', this._handlerId, args);\n    }\n}\nfunction registerOverwritableCommand(handlerId, description) {\n    registerCommand(new EditorHandlerCommand('default:' + handlerId, handlerId));\n    registerCommand(new EditorHandlerCommand(handlerId, handlerId, description));\n}\nregisterOverwritableCommand(\"type\" /* Handler.Type */, {\n    description: `Type`,\n    args: [{\n            name: 'args',\n            schema: {\n                'type': 'object',\n                'required': ['text'],\n                'properties': {\n                    'text': {\n                        'type': 'string'\n                    }\n                },\n            }\n        }]\n});\nregisterOverwritableCommand(\"replacePreviousChar\" /* Handler.ReplacePreviousChar */);\nregisterOverwritableCommand(\"compositionType\" /* Handler.CompositionType */);\nregisterOverwritableCommand(\"compositionStart\" /* Handler.CompositionStart */);\nregisterOverwritableCommand(\"compositionEnd\" /* Handler.CompositionEnd */);\nregisterOverwritableCommand(\"paste\" /* Handler.Paste */);\nregisterOverwritableCommand(\"cut\" /* Handler.Cut */);\n"],"names":["applyFontInfo","domNode","fontInfo","FastDomNode","setFontFamily","getMassagedFontFamily","setFontWeight","fontWeight","setFontSize","fontSize","setFontFeatureSettings","fontFeatureSettings","setFontVariationSettings","fontVariationSettings","setLineHeight","lineHeight","setLetterSpacing","letterSpacing","style","fontFamily","EditorSettingMigration","constructor","key","migrate","this","apply","options","value","_read","write","_write","source","firstDotIndex","indexOf","firstSegment","substring","target","registerEditorSettingMigration","items","push","registerSimpleEditorSettingMigration","values","read","oldValue","newValue","enabled","undefined","suggestFilteredTypesMapping","method","function","deprecated","field","variable","class","struct","interface","module","property","event","operator","unit","constant","enum","enumMember","keyword","text","color","file","reference","folder","typeParameter","snippet","entry","Object","entries","concat","input","comments","strings","other","__decorate","decorators","desc","d","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","EditorConfiguration","Disposable","isSimpleWidget","container","_accessibilityService","super","_onDidChange","_register","Emitter","onDidChange","_onDidChangeFast","onDidChangeFast","_isDominatedByLongLines","_viewLineCount","_lineNumbersDigitCount","_reservedHeight","_glyphMarginDecorationLaneCount","_computeOptionsMemory","ComputeOptionsMemory","_containerObserver","ElementSizeObserver","dimension","_rawOptions","deepCloneAndMigrateOptions","_validatedOptions","EditorOptionsUtil","validateOptions","_computeOptions","get","startObserving","EditorZoom","onDidChangeZoomLevel","_recomputeOptions","TabFocus","onDidChangeTabFocus","FontMeasurements","browser","onDidChangeScreenReaderOptimized","newOptions","changeEvent","checkEquals","fire","partialEnv","_readEnvConfiguration","bareFontInfo","BareFontInfo","createFromValidatedSettings","pixelRatio","_readFontInfo","env","memory","outerWidth","outerHeight","extraEditorClassName","isDominatedByLongLines","viewLineCount","lineNumbersDigitCount","emptySelectionClipboard","tabFocusMode","getTabFocusMode","accessibilitySupport","glyphMarginDecorationLaneCount","computeOptions","getExtraEditorClassName","getWidth","getHeight","isScreenReaderOptimized","getAccessibilitySupport","readFontInfo","getRawOptions","updateOptions","_newOptions","applyUpdate","observeContainer","observe","setIsDominatedByLongLines","setModelLineCount","modelLineCount","n","Math","floor","digitCount","setViewLineCount","setReservedHeight","reservedHeight","setGlyphMarginDecorationLaneCount","decorationLaneCount","extra","platform","IAccessibilityService","ValidatedEditorOptions","_values","option","id","ComputedEditorOptions","Error","result","editorOption","editorOptionsRegistry","name","validate","compute","_deepEquals","a","b","Array","isArray","arrays","keys","somethingChanged","changed","ConfigurationChangedEvent","update","hasOwnProperty","didChange","_options","objects","forEach","migration","migrateOptions","referenceDomElement","_referenceDomElement","_width","_height","_resizeObserver","measureReferenceDomElement","dispose","stopObserving","observeContentRect","observeNow","width","height","shouldObserve","alreadyObservedThisAnimationFrame","requestAnimationFrame","ResizeObserver","contentRect","disconnect","emitEvent","observedWidth","observedHeight","clientWidth","clientHeight","max","CharWidthRequest","chr","type","fulfill","DomCharWidthReader","requests","_bareFontInfo","_requests","_container","_testElements","_createDomElements","document","body","appendChild","_readFromDomElements","removeChild","createElement","position","top","regularDomNode","boldDomNode","italicDomNode","fontStyle","testElements","request","parent","testElement","_render","htmlString","innerText","testString","textContent","len","offsetWidth","FontMeasurementsImpl","_cache","FontMeasurementsCache","_evictUntrustedReadingsTimeout","window","clearTimeout","clearAllFontInfos","_writeToCache","item","put","isTrusted","setTimeout","_evictUntrustedReadings","getValues","somethingRemoved","remove","has","readConfig","_actualReadFontInfo","typicalHalfwidthCharacterWidth","typicalFullwidthCharacterWidth","spaceWidth","maxDigitWidth","FontInfo","isMonospace","canUseHalfwidthRightwardsArrow","middotWidth","wsmiddotWidth","_createRequest","all","monospace","typicalHalfwidthCharacter","typicalFullwidthCharacter","space","digit0","digit1","digit2","digit3","digit4","digit5","digit6","digit7","digit8","digit9","rightwardsArrow","halfwidthRightwardsArrow","middot","String","fromCharCode","monospaceTestChars","charAt","readCharWidths","EditorFontLigatures","OFF","referenceWidth","diff","_keys","create","itemId","getId","map","_tabFocus","_onDidChangeTabFocus","setTabFocusMode","HitTestResult","UnknownHitTestResult","hitTarget","ContentHitTestResult","spanNode","injectedText","createFromDOMInfo","ctx","offset","getPositionFromDOMInfo","PointerHandlerLastRenderData","lastViewCursorsRenderData","lastTextareaPosition","MouseTarget","_deduceRage","range","EditorRange","lineNumber","column","createUnknown","element","mouseColumn","createTextarea","createMargin","detail","createViewZone","createContentText","createContentEmpty","createContentWidget","createScrollbar","createOverlayWidget","createOutsideEditor","outsidePosition","outsideDistance","_typeToString","toString","JSON","stringify","ElementPath","isTextArea","path","isChildOfViewLines","isStrictChildOfViewLines","isChildOfScrollableElement","isChildOfMinimap","isChildOfContentWidgets","isChildOfOverflowGuard","isChildOfOverflowingContentWidgets","isChildOfOverlayWidgets","HitTestContext","context","viewHelper","lastRenderData","viewModel","configuration","layoutInfo","viewDomNode","stickyTabStops","_context","_viewHelper","getZoneAtCoord","mouseVerticalOffset","viewZoneWhitespace","viewLayout","getWhitespaceAtVerticalOffset","viewZoneMiddle","verticalOffset","lineCount","getLineCount","positionBefore","positionAfter","afterLineNumber","Position","getLineMaxColumn","viewZoneId","getFullLineRangeAtCoord","isAfterLines","maxLineColumn","getLineNumberAtVerticalOffset","isInTopPadding","isInBottomPadding","getVerticalOffsetForLineNumber","findAttribute","attr","_findAttribute","stopAt","ownerDocument","hasAttribute","getAttribute","parentNode","getLineWidth","visibleRangeForPosition","getCurrentScrollTop","getCurrentScrollLeft","BareHitTestRequest","editorPos","pos","relativePos","y","mouseContentHorizontalOffset","x","contentLeft","isInMarginArea","glyphMarginLeft","isInContentArea","MouseTargetFactory","_getMouseColumn","HitTestRequest","_ctx","targetPath","PartFingerprints","collect","Uint8Array","outerHTML","CursorColumns","visibleColumnFromColumn","getLineContent","model","getOptions","tabSize","fulfillUnknown","fulfillTextarea","fulfillMargin","fulfillViewZone","fulfillContentText","fulfillContentEmpty","fulfillContentWidget","fulfillScrollbar","fulfillOverlayWidget","withTarget","EMPTY_CONTENT_AFTER_LINES","createEmptyContentDataInLines","horizontalDistanceToText","mouseTargetIsWidget","e","t","createMouseTarget","_createMouseTarget","_snapToSoftTabBoundary","fromPositions","plusRange","err","domHitTestExecuted","hitTestResult","_doHitTest","createMouseTargetFromHitTestPosition","resolvedRequest","_hitTestContentWidget","_hitTestOverlayWidget","_hitTestMinimap","_hitTestScrollbarSlider","_hitTestViewZone","_hitTestMargin","_hitTestViewCursor","_hitTestTextArea","_hitTestViewLines","_hitTestScrollbar","widgetId","mightBeForeignElement","cursorVerticalOffset","viewZoneData","mouseTargetType","res","getStartPosition","abs","glyphMarginWidth","lineNumbersWidth","offsetX","getLineLength","lineWidth","possibleLineNumber","maxColumn","nodeType","className","test","getMouseColumn","round","visibleRange","columnHorizontalOffset","left","points","sort","mouseCoordinates","toClientCoordinates","spanNodeClientRect","getBoundingClientRect","mouseIsOverSpanNode","clientX","right","rng","prev","curr","_doHitTestWithCaretRangeFromPoint","lineStartVerticalOffset","lineEndVerticalOffset","lineCenteredVerticalOffset","adjustedPageY","adjustedPage","PageCoordinates","_actualDoHitTestWithCaretRangeFromPoint","coords","shadowRoot","dom","caretRangeFromPoint","createRange","el","elementFromPoint","firstChild","TEXT_NODE","lastChild","rect","getComputedStyle","getPropertyValue","fontVariant","font","step","pixelCursor","charWidthReader","CharWidthReader","getInstance","getCharWidth","setStart","setEnd","shadowCaretRangeFromPoint","clientY","startContainer","parent1","parent2","parent3","ELEMENT_NODE","ViewLine","CLASS_NAME","startOffset","_doHitTestWithCaretPositionFromPoint","hitResult","caretPositionFromPoint","offsetNode","parent1ClassName","parent2ClassName","tokenSpan","childNodes","min","lineContent","newPosition","AtomicTabMoveOperations","atomicPosition","getInjectedTextAt","normalizedPosition","normalizePosition","equals","_INSTANCE","_canvas","char","cacheKey","getContext","measureText","MouseHandler","ViewEventHandler","viewController","_mouseLeaveMonitor","mouseTargetFactory","_mouseDownOperation","MouseDownOperation","testEventTarget","lastMouseLeaveTime","mouseEvents","EditorMouseEventFactory","onContextMenu","_onContextMenu","onMouseMove","_onMouseMove","contains","_onMouseLeave","EditorMouseEvent","onMouseUp","_onMouseUp","onMouseLeave","capturePointerId","onPointerDown","pointerId","POINTER_UP","onPointerUp","onMouseDown","_onMouseDown","_setupMouseWheelZoomListener","addEventHandler","classifier","MouseWheelClassifier","INSTANCE","prevMouseWheelTime","gestureStartZoomLevel","getZoomLevel","gestureHasZoomModifiers","gestureAccumulatedDelta","hasMouseWheelZoomModifiers","browserEvent","metaKey","ctrlKey","shiftKey","altKey","MOUSE_WHEEL","emitMouseWheel","StandardWheelEvent","acceptStandardWheelEvent","isPhysicalMouseWheel","zoomLevel","delta","deltaY","setZoomLevel","preventDefault","stopPropagation","Date","now","capture","passive","removeEventHandler","onConfigurationChanged","hasChanged","onHeightChanged","onCursorStateChanged","onFocusChanged","getTargetAtClientPoint","ClientCoordinates","toPageCoordinates","createEditorPagePosition","createCoordinatesRelativeToEditor","getLastRenderData","elementsFromPoint","posx","posy","find","emitContextMenu","isActive","timestamp","emitMouseMove","getTime","emitMouseLeave","emitMouseUp","targetIsContent","targetIsGutter","targetIsLineNumbers","selectOnLineNumbers","targetIsViewZone","targetIsWidget","shouldHandle","leftButton","middleButton","focus","focusTextArea","start","shouldSuppressMouseDownOnViewZone","shouldSuppressMouseDownOnWidget","emitMouseDown","_viewController","_mouseTargetFactory","_mouseMoveMonitor","GlobalEditorPointerMoveMonitor","_topBottomDragScrolling","TopBottomDragScrolling","inSelectionMode","revealType","_dispatchMouse","_mouseState","MouseDownState","_currentSelection","Selection","_isActive","_lastMouseEvent","_onMouseDownThenMove","setModifiers","_findMousePosition","isDragAndDrop","emitMouseDrag","stop","targetType","setStartedOnLineNumbers","setStartButtons","trySetCount","count","isEmpty","containsPosition","startMonitoring","viewLinesDomNode","buttons","KeyboardEvent","emitMouseDropCanceled","emitMouseDrop","_stop","stopMonitoring","selections","_getPositionOutsideEditor","editorContent","_helpPositionJumpOverViewZone","aboveLineNumber","belowLineNumber","positionOutsideEditor","selectionStart","selectionStartLineNumber","selectionStartColumn","isBefore","dispatchMouse","startedOnLineNumbers","mouseDownCount","onInjectedText","_operation","mouseEvent","setPosition","TopBottomDragScrollingOperation","_position","_mouseEvent","_lastTime","_animationFrameDisposable","_execute","_tick","elapsed","_getScrollSpeed","viewportInLines","outsideDistanceInLines","scrollInPixels","scrollValue","deltaScrollNow","renderNow","viewportData","getLinesViewportData","edgeLineNumber","startLineNumber","endLineNumber","mouseTarget","horizontalScrollbarHeight","_altKey","_ctrlKey","_metaKey","_shiftKey","_leftButton","_middleButton","_startedOnLineNumbers","_lastMouseDownPosition","_lastMouseDownPositionEqualCount","_lastMouseDownCount","_lastSetMouseDownCountTime","setMouseDownCount","newMouseDownPosition","currentTime","CLEAR_MOUSE_DOWN_COUNT_TIME","PointerEventHandler","Gesture","addTarget","linesContentDomNode","EventType","Tap","onTap","Change","onChange","Contextmenu","_lastPointerType","pointerType","pointerEvents","EditorPointerEventFactory","onPointerMove","onPointerLeave","initialTarget","tapCount","translationX","translationY","TouchHandler","createEvent","initEvent","TextAreaSyntethicEvents","dispatchTextAreaEvent","moveTo","PointerHandler","BrowserFeatures","handler","TouchEvent","VisibleTextAreaData","modelLineNumber","distanceToModelLineStart","widthOfHiddenLineTextBefore","distanceToModelLineEnd","_visibleTextAreaBrand","startPosition","endPosition","visibleTextareaStart","visibleTextareaEnd","_previousPresentation","prepareRender","visibleRangeProvider","startModelPosition","endModelPosition","coordinatesConverter","convertModelPositionToViewPosition","definePresentation","tokenPresentation","foreground","italic","bold","underline","strikethrough","canUseZeroSizeTextarea","TextAreaHandler","ViewPart","_keybindingService","_primaryCursorPosition","_primaryCursorVisibleRange","_visibleRangeProvider","_scrollLeft","_scrollTop","_setAccessibilityOptions","_contentLeft","_contentWidth","contentWidth","_contentHeight","_fontInfo","_lineHeight","_emptySelectionClipboard","_copyWithSyntaxHighlighting","_visibleTextArea","_selections","_modelSelections","_lastRenderPosition","textArea","createFastDomNode","setClassName","MOUSE_CURSOR_TEXT_CSS_CLASS_NAME","setAttribute","_textAreaWrapping","_getAriaLabel","nls","_ensureReadOnlyAttribute","textAreaCover","simpleModel","getValueInRange","eol","getValueLengthInRange","modifyPosition","textAreaInputHost","getDataToCopy","rawTextToCopy","getPlainTextToCopy","newLineCharacter","getEOL","isFromEmptySelection","multicursorText","join","html","mode","CopyOptions","forceCopyWithSyntaxHighlighting","richText","getRichTextToCopy","getScreenReaderContent","_accessibilitySupport","selection","textBefore","_getWordBeforePosition","_getCharacterBeforePosition","TextAreaState","Range","LIMIT_CHARS","placeholderText","EMPTY","wordAtPosition","positionOffsetInWord","_getAndroidWordAtPosition","PagedScreenReaderStrategy","fromEditorSelection","_accessibilityPageSize","deduceModelPosition","viewAnchorPosition","deltaOffset","lineFeedCnt","deduceModelPositionRelativeToViewPosition","textAreaWrapper","TextAreaWrapper","_textAreaInput","TextAreaInput","OS","isAndroid","isChrome","isFirefox","isSafari","onKeyDown","emitKeyDown","onKeyUp","emitKeyUp","onPaste","pasteOnNewLine","metadata","paste","onCut","cut","onType","replacePrevCharCnt","replaceNextCharCnt","positionDelta","_debugComposition","console","log","compositionType","onSelectionChangeRequest","modelSelection","setSelection","onCompositionStart","ta","widthOfHiddenTextBefore","textBeforeSelection","selectionEnd","lineFeedOffset1","lastIndexOf","lineTextBeforeSelection","tabOffset1","desiredVisibleBeforeCharCount","visibleBeforeCharCount","hiddenLineTextBefore","whiteSpace","append","textAfterSelection","lineFeedOffset2","lineTextAfterSelection","tabOffset2","desiredVisibleAfterCharCount","getEndPosition","visibleAfterCharCount","revealRange","compositionStart","onCompositionUpdate","onCompositionEnd","compositionEnd","onFocus","setHasFocus","onBlur","IME","writeScreenReaderContent","reason","wordSeparators","getMapForWordSeparators","goingLeft","startColumn","goingRight","endColumn","distance","charCode","charCodeAt","charBefore","_a","_b","_c","toggleKeybindingLabel","lookupKeybinding","getAriaLabel","runCommandKeybindingLabel","keybindingEditorKeybindingLabel","editorNotAccessibleMessage","accessibilityPageSize","EditorOptions","defaultValue","wrappingColumn","_textAreaWidth","slice","modelSelections","onDecorationsChanged","onFlushed","onLinesChanged","onLinesDeleted","onLinesInserted","onScrollChanged","scrollLeft","scrollTop","onZonesChanged","isFocused","setAriaOptions","activeDescendant","removeAttribute","role","positionLineNumber","positionColumn","render","visibleStart","visibleEnd","_newlinecount","substr","viewLineData","getViewLineData","startTokenIndex","tokens","findTokenIndexAtOffset","textareaSpansSingleToken","presentation","getPresentation","_doRender","lastRenderPosition","useCover","TokenizationRegistry","getColorMap","_renderAtTopLeft","textAreaState","newlineCountBeforeSelection","startIndex","renderData","tac","setTop","setLeft","setWidth","setHeight","setColor","Color","Format","CSS","formatHex","setFontStyle","setTextDecoration","Margin","OUTER_CLASS_NAME","renderType","LineNumbersOverlay","IKeybindingService","InMemoryClipboardMetadataManager","_lastState","set","lastCopiedValue","data","pastedText","CompositionContext","_lastTypeTextLength","handleCompositionUpdate","typeInput","_textAreaState","_host","_textArea","_OS","_browser","_onFocus","_onBlur","_onKeyDown","_onKeyUp","_onCut","_onPaste","_onType","_onCompositionStart","_onCompositionUpdate","_onCompositionEnd","_onSelectionChangeRequest","_asyncTriggerCut","RunOnceScheduler","_asyncFocusGainWriteScreenReaderContent","_selectionChangeListener","_hasFocus","_currentComposition","lastKeyDown","_e","StandardKeyboardEvent","keyCode","currentComposition","code","newState","readFromTextArea","deduceAndroidCompositionInput","onInput","setIgnoreSelectionChangeTime","deduceInput","_ensureClipboardGetsEditorSelection","schedule","onCopy","clipboardData","ClipboardEventUtils","getTextData","hadFocus","_setHasFocus","onSyntheticTap","_installSelectionChangeListener","previousSelectionChangeEventTime","inputLatency","onSelectionChange","delta1","delta2","getIgnoreSelectionChangeTime","resetSelectionChangeTime","getValue","newSelectionStart","getSelectionStart","newSelectionEnd","getSelectionEnd","_newSelectionStartPosition","deduceEditorPosition","newSelectionStartPosition","_newSelectionEndPosition","newSelectionEndPosition","newSelection","refreshFocusState","hasFocus","newHasFocus","_setAndWriteTextAreaState","collapseSelection","writeToTextArea","dataToCopy","storedMetadata","version","replace","setTextData","getData","Mimes","rawmetadata","parse","files","prototype","call","setData","_actual","DomEmitter","onBeforeInput","_onSyntheticTap","_ignoreSelectionChangeTime","activeElement","setValue","selectionDirection","setSelectionRange","currentIsFocused","currentSelectionStart","currentSelectionEnd","scrollState","previousState","select","_d","_f","_g","_h","str","_finishDeduceEditorPosition","str1","str2","anchor","deltaText","signum","lastLineFeedIndex","currentState","couldBeEmojiInput","prefixLength","suffixLength","previousValue","currentValue","previousSelectionStart","previousSelectionEnd","replacePreviousCharacters","_getPageOfLine","linesPerPage","_getRangeForPage","page","trimLongText","selectionStartPage","selectionStartPageRange","selectionEndPage","selectionEndPageRange","pretextRange","intersectRanges","pretextStart","pretext","lastLine","lastLineMaxColumn","posttextRange","posttextEnd","posttext","selectionRange1","selectionRange2","CoreEditorCommand","EditorCommand","runEditorCommand","accessor","editor","args","_getViewModel","runCoreEditorCommand","EditorScroll_","RevealLine_","CoreNavigationCommands","description","constraint","arg","types","scrollArg","to","by","revealCursor","schema","RawDirection","Up","Right","Down","Left","RawUnit","Line","WrappedLine","Page","HalfPage","Editor","Column","direction","reveaLineArg","at","RawAtArgument","Top","Center","Bottom","EditorOrNativeTextInputCommand","addImplementation","focusedEditor","ICodeEditorService","getFocusedCodeEditor","hasTextFocus","_runEditorCommand","getActiveElement","tagName","toLowerCase","runDOMCommand","activeEditor","getActiveCodeEditor","BaseMoveToCommand","opts","_inSelectionMode","pushStackElement","setCursorStates","CursorMoveCommands","getPrimaryCursorState","viewPosition","revealPrimaryCursor","MoveTo","registerEditorCommand","precondition","MoveToSelect","ColumnSelectCommand","_getColumnSelectResult","getCursorColumnSelectData","viewStates","viewState","CursorState","fromViewState","setCursorColumnSelectData","isReal","fromViewLineNumber","fromLineNumber","fromViewVisualColumn","fromVisualColumn","toViewLineNumber","toLineNumber","toViewVisualColumn","toVisualColumn","reversed","revealTopMostCursor","revealBottomMostCursor","ColumnSelect","primary","prevColumnSelectData","validatedPosition","validatePosition","validatedViewPosition","validateViewPosition","doColumnSelect","ColumnSelection","columnSelect","cursorConfig","CursorColumnSelectLeft","kbOpts","weight","kbExpr","EditorContextKeys","textInputFocus","linux","columnSelectLeft","CursorColumnSelectRight","columnSelectRight","ColumnSelectUpCommand","_isPaged","isPaged","columnSelectUp","CursorColumnSelectUp","CursorColumnSelectPageUp","ColumnSelectDownCommand","columnSelectDown","CursorColumnSelectDown","CursorColumnSelectPageDown","CursorMoveImpl","CursorMove_","parsed","_runCursorMove","_move","getCursorStates","cursors","simpleMove","viewportMove","CursorMove","CursorMoveBasedCommand","_staticArgs","dynamicArgs","pageSize","CursorLeft","mac","secondary","CursorLeftSelect","CursorRight","CursorRightSelect","CursorUp","CursorUpSelect","CursorPageUp","CursorPageUpSelect","CursorDown","CursorDownSelect","CursorPageDown","CursorPageDownSelect","CreateCursor","wholeLine","line","states","newModelPosition","modelState","newViewPosition","state","splice","LastCursorMoveToSelect","lastAddedCursorIndex","getLastAddedCursorIndex","newStates","HomeCommand","moveToBeginningOfLine","CursorHome","CursorHomeSelect","LineStartCommand","_exec","cursor","fromModelState","move","CursorLineStart","CursorLineStartSelect","EndCommand","moveToEndOfLine","sticky","CursorEnd","properties","default","CursorEndSelect","LineEndCommand","CursorLineEnd","CursorLineEndSelect","TopCommand","moveToBeginningOfBuffer","CursorTop","CursorTopSelect","BottomCommand","moveToEndOfBuffer","CursorBottom","CursorBottomSelect","EditorScrollImpl","determineScrollMethod","includes","_runHorizontalEditorScroll","bind","_runVerticalEditorScroll","runEditorScroll","desiredScrollTop","_computeDesiredScrollTop","desiredVisibleViewRange","getCompletelyVisibleViewRangeAtScrollTop","findPositionInViewportIfOutside","setScrollPosition","futureViewport","getFutureViewport","visibleViewRange","visibleModelRange","convertViewRangeToModelRange","desiredTopModelLineNumber","noOfLines","deltaLines","desiredScrollLeft","_computeDesiredScrollLeft","deltaColumns","EditorScroll","ScrollLineUp","ScrollPageUp","win","ScrollEditorTop","ScrollLineDown","ScrollPageDown","ScrollEditorBottom","ScrollLeft","ScrollRight","WordCommand","word","WordSelect","WordSelectDrag","LastCursorWordSelect","lastAddedState","hasSelection","LineCommand","LineSelect","LineSelectDrag","LastCursorLineCommand","LastCursorLineSelect","LastCursorLineSelectDrag","CancelSelection","hasNonEmptySelection","cancelSelection","RemoveSecondaryCursors","hasMultipleSelections","CORE_WEIGHT","status","RevealLine","revealLineArg","lineNumberArg","parseInt","revealAt","viewRange","convertModelRangeToViewRange","SelectAll","SelectAllCommand","execCommand","selectAll","SetSelection","fromModelSelection","columnSelectionCondition","ContextKeyExpr","and","columnSelection","registerColumnSelection","keybinding","KeybindingsRegistry","registerKeybindingRule","when","registerCommand","command","register","CoreEditingCommands","CoreEditingCommand","runCoreEditingCommand","LineBreakInsert","writable","pushUndoStop","executeCommands","TypeOperations","lineBreakInsert","s","Outdent","editorTextFocus","tabDoesNotMoveFocus","outdent","Tab","tab","DeleteLeft","shouldPushStackElementBefore","commands","DeleteOperations","deleteLeft","getPrevEditOperationType","getCursorAutoClosedCharacters","setPrevEditOperationType","DeleteRight","deleteRight","Undo","UndoCommand","hasModel","getOption","getModel","undo","Redo","RedoCommand","redo","EditorHandlerCommand","Command","handlerId","_handlerId","runCommand","trigger","registerOverwritableCommand"],"sourceRoot":""}