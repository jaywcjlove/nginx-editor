"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[173],{7123:(e,t,i)=>{i.d(t,{Ad:()=>I,Q1:()=>M,L9:()=>P});var n=i(32605),o=i(67809),s=i(61498),r=i(87766),a=i(23525),l=i(99005),c=i(15739),d=i(91861),h=i(17303),u=i(85287),g=i(39263),p=i(16391),m=i(73990),v=i(72330),f=i(39686),_=i(37647);class b extends r.jG{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new n.fg(10,10);super(),this._editor=e,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._resizableNode=this._register(new _.v),this._contentPosition=null,this._isResizing=!1,this._resizableNode.domNode.style.position="absolute",this._resizableNode.minSize=n.fg.lift(t),this._resizableNode.layout(t.height,t.width),this._resizableNode.enableSashes(!0,!0,!0,!0),this._register(this._resizableNode.onDidResize((e=>{this._resize(new n.fg(e.dimension.width,e.dimension.height)),e.done&&(this._isResizing=!1)}))),this._register(this._resizableNode.onDidWillResize((()=>{this._isResizing=!0})))}get isResizing(){return this._isResizing}getDomNode(){return this._resizableNode.domNode}getPosition(){return this._contentPosition}get position(){var e;return(null===(e=this._contentPosition)||void 0===e?void 0:e.position)?a.y.lift(this._contentPosition.position):void 0}_availableVerticalSpaceAbove(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);if(!t||!i)return;return n.BK(t).top+i.top-30}_availableVerticalSpaceBelow(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);if(!t||!i)return;const o=n.BK(t),s=n.tG(t.ownerDocument.body),r=o.top+i.top+i.height;return s.height-r-24}_findPositionPreference(e,t){var i,n;const o=Math.min(null!==(i=this._availableVerticalSpaceBelow(t))&&void 0!==i?i:1/0,e),s=Math.min(null!==(n=this._availableVerticalSpaceAbove(t))&&void 0!==n?n:1/0,e),r=Math.min(Math.max(s,o),e),a=Math.min(e,r);let l;return l=this._editor.getOption(60).above?a<=s?1:2:a<=o?2:1,1===l?this._resizableNode.enableSashes(!0,!0,!1,!1):this._resizableNode.enableSashes(!1,!0,!0,!1),l}_resize(e){this._resizableNode.layout(e.height,e.width)}}var C,w,y=i(66457),S=i(73429),L=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},x=function(e,t){return function(i,n){t(i,n,e)}};const k=n.$;let I=C=class extends r.jG{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._currentResult=null,this._widget=this._register(this._instantiationService.createInstance(M,this._editor)),this._participants=[];for(const n of u.B2.getAll())this._participants.push(this._instantiationService.createInstance(n,this._editor));this._participants.sort(((e,t)=>e.hoverOrdinal-t.hoverOrdinal)),this._computer=new T(this._editor,this._participants),this._hoverOperation=this._register(new h.w(this._editor,this._computer)),this._register(this._hoverOperation.onResult((e=>{if(!this._computer.anchor)return;const t=e.hasLoadingMessage?this._addLoadingMessage(e.value):e.value;this._withResult(new D(this._computer.anchor,t,e.isComplete))}))),this._register(n.b2(this._widget.getDomNode(),"keydown",(e=>{e.equals(9)&&this.hide()}))),this._register(d.dG.onDidChange((()=>{this._widget.position&&this._currentResult&&this._setCurrentResult(this._currentResult)})))}get widget(){return this._widget}maybeShowAt(e){if(this._widget.isResizing)return!0;const t=[];for(const n of this._participants)if(n.suggestHoverAnchor){const i=n.suggestHoverAnchor(e);i&&t.push(i)}const i=e.target;if(6===i.type&&t.push(new u.hx(0,i.range,e.event.posx,e.event.posy)),7===i.type){const n=this._editor.getOption(50).typicalHalfwidthCharacterWidth/2;!i.detail.isAfterLines&&"number"===typeof i.detail.horizontalDistanceToText&&i.detail.horizontalDistanceToText<n&&t.push(new u.hx(0,i.range,e.event.posx,e.event.posy))}return 0===t.length?this._startShowingOrUpdateHover(null,0,0,!1,e):(t.sort(((e,t)=>t.priority-e.priority)),this._startShowingOrUpdateHover(t[0],0,0,!1,e))}startShowingAtRange(e,t,i,n){this._startShowingOrUpdateHover(new u.hx(0,e,void 0,void 0),t,i,n,null)}_startShowingOrUpdateHover(e,t,i,n,o){if(!this._widget.position||!this._currentResult)return!!e&&(this._startHoverOperationIfNecessary(e,t,i,n,!1),!0);return this._editor.getOption(60).sticky&&o&&this._widget.isMouseGettingCloser(o.event.posx,o.event.posy)?(e&&this._startHoverOperationIfNecessary(e,t,i,n,!0),!0):e?!(!e||!this._currentResult.anchor.equals(e))||(e.canAdoptVisibleHover(this._currentResult.anchor,this._widget.position)?(this._setCurrentResult(this._currentResult.filter(e)),this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):(this._setCurrentResult(null),this._startHoverOperationIfNecessary(e,t,i,n,!1),!0)):(this._setCurrentResult(null),!1)}_startHoverOperationIfNecessary(e,t,i,n,o){this._computer.anchor&&this._computer.anchor.equals(e)||(this._hoverOperation.cancel(),this._computer.anchor=e,this._computer.shouldFocus=n,this._computer.source=i,this._computer.insistOnKeepingHoverVisible=o,this._hoverOperation.start(t))}_setCurrentResult(e){this._currentResult!==e&&(e&&0===e.messages.length&&(e=null),this._currentResult=e,this._currentResult?this._renderMessages(this._currentResult.anchor,this._currentResult.messages):this._widget.hide())}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._setCurrentResult(null)}get isColorPickerVisible(){return this._widget.isColorPickerVisible}get isVisibleFromKeyboard(){return this._widget.isVisibleFromKeyboard}get isVisible(){return this._widget.isVisible}get isFocused(){return this._widget.isFocused}get isResizing(){return this._widget.isResizing}containsNode(e){return!!e&&this._widget.getDomNode().contains(e)}_addLoadingMessage(e){if(this._computer.anchor)for(const t of this._participants)if(t.createLoadingMessage){const i=t.createLoadingMessage(this._computer.anchor);if(i)return e.slice(0).concat([i])}return e}_withResult(e){if(this._widget.position&&this._currentResult&&this._currentResult.isComplete){if(!e.isComplete)return;if(this._computer.insistOnKeepingHoverVisible&&0===e.messages.length)return}this._setCurrentResult(e)}_renderMessages(e,t){const{showAtPosition:i,showAtSecondaryPosition:n,highlightRange:o}=C.computeHoverRanges(this._editor,e.range,t),s=new r.Cm,a=s.add(new P(this._keybindingService)),l=document.createDocumentFragment();let c=null;const d={fragment:l,statusBar:a,setColorPicker:e=>c=e,onContentsChanged:()=>this._widget.onContentsChanged(),setMinimumDimensions:e=>this._widget.setMinimumDimensions(e),hide:()=>this.hide()};for(const r of this._participants){const e=t.filter((e=>e.owner===r));e.length>0&&s.add(r.renderHoverParts(d,e))}const h=t.some((e=>e.isBeforeContent));if(a.hasContent&&l.appendChild(a.hoverElement),l.hasChildNodes()){if(o){const e=this._editor.createDecorationsCollection();e.set([{range:o,options:C._DECORATION_OPTIONS}]),s.add((0,r.s)((()=>{e.clear()})))}this._widget.showAt(l,new R(c,i,n,this._editor.getOption(60).above,this._computer.shouldFocus,this._computer.source,h,e.initialMousePosX,e.initialMousePosY,s))}else s.dispose()}static computeHoverRanges(e,t,i){let n=1;if(e.hasModel()){const i=e._getViewModel(),o=i.coordinatesConverter,s=o.convertModelRangeToViewRange(t),r=new a.y(s.startLineNumber,i.getLineMinColumn(s.startLineNumber));n=o.convertViewPositionToModelPosition(r).column}const o=t.startLineNumber;let s=t.startColumn,r=i[0].range,c=null;for(const a of i)r=l.Q.plusRange(r,a.range),a.range.startLineNumber===o&&a.range.endLineNumber===o&&(s=Math.max(Math.min(s,a.range.startColumn),n)),a.forceShowAtRange&&(c=a.range);return{showAtPosition:c?c.getStartPosition():new a.y(o,t.startColumn),showAtSecondaryPosition:c?c.getStartPosition():new a.y(o,s),highlightRange:r}}focus(){this._widget.focus()}scrollUp(){this._widget.scrollUp()}scrollDown(){this._widget.scrollDown()}scrollLeft(){this._widget.scrollLeft()}scrollRight(){this._widget.scrollRight()}pageUp(){this._widget.pageUp()}pageDown(){this._widget.pageDown()}goToTop(){this._widget.goToTop()}goToBottom(){this._widget.goToBottom()}};I._DECORATION_OPTIONS=c.kI.register({description:"content-hover-highlight",className:"hoverHighlight"}),I=C=L([x(1,g._Y),x(2,p.b)],I);class D{constructor(e,t,i){this.anchor=e,this.messages=t,this.isComplete=i}filter(e){const t=this.messages.filter((t=>t.isValidForHoverAnchor(e)));return t.length===this.messages.length?this:new N(this,this.anchor,t,this.isComplete)}}class N extends D{constructor(e,t,i,n){super(t,i,n),this.original=e}filter(e){return this.original.filter(e)}}class R{constructor(e,t,i,n,o,s,r,a,l,c){this.colorPicker=e,this.showAtPosition=t,this.showAtSecondaryPosition=i,this.preferAbove=n,this.stoleFocus=o,this.source=s,this.isBeforeContent=r,this.initialMousePosX=a,this.initialMousePosY=l,this.disposables=c,this.closestMouseDistance=void 0}}let M=w=class extends b{get isColorPickerVisible(){var e;return Boolean(null===(e=this._visibleData)||void 0===e?void 0:e.colorPicker)}get isVisibleFromKeyboard(){var e;return 1===(null===(e=this._visibleData)||void 0===e?void 0:e.source)}get isVisible(){var e;return null!==(e=this._hoverVisibleKey.get())&&void 0!==e&&e}get isFocused(){var e;return null!==(e=this._hoverFocusedKey.get())&&void 0!==e&&e}constructor(e,t,i,s,r){const a=e.getOption(66)+8,l=new n.fg(150,a);super(e,l),this._configurationService=i,this._accessibilityService=s,this._keybindingService=r,this._hover=this._register(new o.N4),this._minimumSize=l,this._hoverVisibleKey=v.R.hoverVisible.bindTo(t),this._hoverFocusedKey=v.R.hoverFocused.bindTo(t),n.BC(this._resizableNode.domNode,this._hover.containerDomNode),this._resizableNode.domNode.style.zIndex="50",this._register(this._editor.onDidLayoutChange((()=>this._layout()))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(50)&&this._updateFont()})));const c=this._register(n.w5(this._resizableNode.domNode));this._register(c.onDidFocus((()=>{this._hoverFocusedKey.set(!0)}))),this._register(c.onDidBlur((()=>{this._hoverFocusedKey.set(!1)}))),this._setHoverData(void 0),this._layout(),this._editor.addContentWidget(this)}dispose(){var e;super.dispose(),null===(e=this._visibleData)||void 0===e||e.disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return w.ID}static _applyDimensions(e,t,i){const n="number"===typeof t?"".concat(t,"px"):t,o="number"===typeof i?"".concat(i,"px"):i;e.style.width=n,e.style.height=o}_setContentsDomNodeDimensions(e,t){const i=this._hover.contentsDomNode;return w._applyDimensions(i,e,t)}_setContainerDomNodeDimensions(e,t){const i=this._hover.containerDomNode;return w._applyDimensions(i,e,t)}_setHoverWidgetDimensions(e,t){this._setContentsDomNodeDimensions(e,t),this._setContainerDomNodeDimensions(e,t),this._layoutContentWidget()}static _applyMaxDimensions(e,t,i){const n="number"===typeof t?"".concat(t,"px"):t,o="number"===typeof i?"".concat(i,"px"):i;e.style.maxWidth=n,e.style.maxHeight=o}_setHoverWidgetMaxDimensions(e,t){w._applyMaxDimensions(this._hover.contentsDomNode,e,t),w._applyMaxDimensions(this._hover.containerDomNode,e,t),this._hover.containerDomNode.style.setProperty("--vscode-hover-maxWidth","number"===typeof e?"".concat(e,"px"):e),this._layoutContentWidget()}_hasHorizontalScrollbar(){const e=this._hover.scrollbar.getScrollDimensions();return e.scrollWidth>e.width}_adjustContentsBottomPadding(){const e=this._hover.contentsDomNode,t="".concat(this._hover.scrollbar.options.horizontalScrollbarSize,"px");e.style.paddingBottom!==t&&(e.style.paddingBottom=t)}_setAdjustedHoverWidgetDimensions(e){this._setHoverWidgetMaxDimensions("none","none");const t=e.width,i=e.height;this._setHoverWidgetDimensions(t,i),this._hasHorizontalScrollbar()&&(this._adjustContentsBottomPadding(),this._setContentsDomNodeDimensions(t,i-10))}_updateResizableNodeMaxDimensions(){var e,t;const i=null!==(e=this._findMaximumRenderingWidth())&&void 0!==e?e:1/0,o=null!==(t=this._findMaximumRenderingHeight())&&void 0!==t?t:1/0;this._resizableNode.maxSize=new n.fg(i,o),this._setHoverWidgetMaxDimensions(i,o)}_resize(e){var t,i;w._lastDimensions=new n.fg(e.width,e.height),this._setAdjustedHoverWidgetDimensions(e),this._resizableNode.layout(e.height,e.width),this._updateResizableNodeMaxDimensions(),this._hover.scrollbar.scanDomNode(),this._editor.layoutContentWidget(this),null===(i=null===(t=this._visibleData)||void 0===t?void 0:t.colorPicker)||void 0===i||i.layout()}_findAvailableSpaceVertically(){var e;const t=null===(e=this._visibleData)||void 0===e?void 0:e.showAtPosition;if(t)return 1===this._positionPreference?this._availableVerticalSpaceAbove(t):this._availableVerticalSpaceBelow(t)}_findMaximumRenderingHeight(){const e=this._findAvailableSpaceVertically();if(!e)return;let t=6;return Array.from(this._hover.contentsDomNode.children).forEach((e=>{t+=e.clientHeight})),this._hasHorizontalScrollbar()&&(t+=10),Math.min(e,t)}_isHoverTextOverflowing(){this._hover.containerDomNode.style.setProperty("--vscode-hover-whiteSpace","nowrap"),this._hover.containerDomNode.style.setProperty("--vscode-hover-sourceWhiteSpace","nowrap");const e=Array.from(this._hover.contentsDomNode.children).some((e=>e.scrollWidth>e.clientWidth));return this._hover.containerDomNode.style.removeProperty("--vscode-hover-whiteSpace"),this._hover.containerDomNode.style.removeProperty("--vscode-hover-sourceWhiteSpace"),e}_findMaximumRenderingWidth(){if(!this._editor||!this._editor.hasModel())return;const e=this._isHoverTextOverflowing(),t="undefined"===typeof this._contentWidth?0:this._contentWidth-2;if(e||this._hover.containerDomNode.clientWidth<t){return n.tG(this._hover.containerDomNode.ownerDocument.body).width-14}return this._hover.containerDomNode.clientWidth+2}isMouseGettingCloser(e,t){if(!this._visibleData)return!1;if("undefined"===typeof this._visibleData.initialMousePosX||"undefined"===typeof this._visibleData.initialMousePosY)return this._visibleData.initialMousePosX=e,this._visibleData.initialMousePosY=t,!1;const i=n.BK(this.getDomNode());"undefined"===typeof this._visibleData.closestMouseDistance&&(this._visibleData.closestMouseDistance=O(this._visibleData.initialMousePosX,this._visibleData.initialMousePosY,i.left,i.top,i.width,i.height));const o=O(e,t,i.left,i.top,i.width,i.height);return!(o>this._visibleData.closestMouseDistance+4)&&(this._visibleData.closestMouseDistance=Math.min(this._visibleData.closestMouseDistance,o),!0)}_setHoverData(e){var t;null===(t=this._visibleData)||void 0===t||t.disposables.dispose(),this._visibleData=e,this._hoverVisibleKey.set(!!e),this._hover.containerDomNode.classList.toggle("hidden",!e)}_layout(){const{fontSize:e,lineHeight:t}=this._editor.getOption(50),i=this._hover.contentsDomNode;i.style.fontSize="".concat(e,"px"),i.style.lineHeight="".concat(t/e),this._updateMaxDimensions()}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach((e=>this._editor.applyFontInfo(e)))}_updateContent(e){const t=this._hover.contentsDomNode;t.style.paddingBottom="",t.textContent="",t.appendChild(e)}_layoutContentWidget(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}_updateMaxDimensions(){const e=Math.max(this._editor.getLayoutInfo().height/4,250,w._lastDimensions.height),t=Math.max(.66*this._editor.getLayoutInfo().width,500,w._lastDimensions.width);this._setHoverWidgetMaxDimensions(t,e)}_render(e,t){this._setHoverData(t),this._updateFont(),this._updateContent(e),this._updateMaxDimensions(),this.onContentsChanged(),this._editor.render()}getPosition(){var e;return this._visibleData?{position:this._visibleData.showAtPosition,secondaryPosition:this._visibleData.showAtSecondaryPosition,positionAffinity:this._visibleData.isBeforeContent?3:void 0,preference:[null!==(e=this._positionPreference)&&void 0!==e?e:1]}:null}showAt(e,t){var i,s,r,a;if(!this._editor||!this._editor.hasModel())return;this._render(e,t);const l=n.OK(this._hover.containerDomNode),c=t.showAtPosition;this._positionPreference=null!==(i=this._findPositionPreference(l,c))&&void 0!==i?i:1,this.onContentsChanged(),t.stoleFocus&&this._hover.containerDomNode.focus(),null===(s=t.colorPicker)||void 0===s||s.layout();const d=(0,o.vr)(!0===this._configurationService.getValue("accessibility.verbosity.hover")&&this._accessibilityService.isScreenReaderOptimized(),null!==(a=null===(r=this._keybindingService.lookupKeybinding("editor.action.accessibleView"))||void 0===r?void 0:r.getAriaLabel())&&void 0!==a?a:"");d&&(this._hover.contentsDomNode.ariaLabel=this._hover.contentsDomNode.textContent+", "+d)}hide(){if(!this._visibleData)return;const e=this._visibleData.stoleFocus||this._hoverFocusedKey.get();this._setHoverData(void 0),this._resizableNode.maxSize=new n.fg(1/0,1/0),this._resizableNode.clearSashHoverState(),this._hoverFocusedKey.set(!1),this._editor.layoutContentWidget(this),e&&this._editor.focus()}_removeConstraintsRenderNormally(){const e=this._editor.getLayoutInfo();this._resizableNode.layout(e.height,e.width),this._setHoverWidgetDimensions("auto","auto")}_adjustHoverHeightForScrollbar(e){var t;const i=this._hover.containerDomNode,o=this._hover.contentsDomNode,s=null!==(t=this._findMaximumRenderingHeight())&&void 0!==t?t:1/0;this._setContainerDomNodeDimensions(n.Tr(i),Math.min(s,e)),this._setContentsDomNodeDimensions(n.Tr(o),Math.min(s,e-10))}setMinimumDimensions(e){this._minimumSize=new n.fg(Math.max(this._minimumSize.width,e.width),Math.max(this._minimumSize.height,e.height)),this._updateMinimumWidth()}_updateMinimumWidth(){const e="undefined"===typeof this._contentWidth?this._minimumSize.width:Math.min(this._contentWidth,this._minimumSize.width);this._resizableNode.minSize=new n.fg(e,this._minimumSize.height)}onContentsChanged(){var e;this._removeConstraintsRenderNormally();const t=this._hover.containerDomNode;let i=n.OK(t),o=n.Tr(t);if(this._resizableNode.layout(i,o),this._setHoverWidgetDimensions(o,i),i=n.OK(t),o=n.Tr(t),this._contentWidth=o,this._updateMinimumWidth(),this._resizableNode.layout(i,o),this._hasHorizontalScrollbar()&&(this._adjustContentsBottomPadding(),this._adjustHoverHeightForScrollbar(i)),null===(e=this._visibleData)||void 0===e?void 0:e.showAtPosition){const e=n.OK(this._hover.containerDomNode);this._positionPreference=this._findPositionPreference(e,this._visibleData.showAtPosition)}this._layoutContentWidget()}focus(){this._hover.containerDomNode.focus()}scrollUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e-t.lineHeight})}scrollDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e+t.lineHeight})}scrollLeft(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e-30})}scrollRight(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e+30})}pageUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e-t})}pageDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e+t})}goToTop(){this._hover.scrollbar.setScrollPosition({scrollTop:0})}goToBottom(){this._hover.scrollbar.setScrollPosition({scrollTop:this._hover.scrollbar.getScrollDimensions().scrollHeight})}};M.ID="editor.contrib.resizableContentHoverWidget",M._lastDimensions=new n.fg(0,0),M=w=L([x(1,f.fN),x(2,y.pG),x(3,S.j),x(4,p.b)],M);let P=class extends r.jG{get hasContent(){return this._hasContent}constructor(e){super(),this._keybindingService=e,this._hasContent=!1,this.hoverElement=k("div.hover-row.status-bar"),this.actionsElement=n.BC(this.hoverElement,k("div.actions"))}addAction(e){const t=this._keybindingService.lookupKeybinding(e.commandId),i=t?t.getLabel():null;return this._hasContent=!0,this._register(o.jQ.render(this.actionsElement,e,i))}append(e){const t=n.BC(this.actionsElement,e);return this._hasContent=!0,t}};P=L([x(0,p.b)],P);class T{get anchor(){return this._anchor}set anchor(e){this._anchor=e}get shouldFocus(){return this._shouldFocus}set shouldFocus(e){this._shouldFocus=e}get source(){return this._source}set source(e){this._source=e}get insistOnKeepingHoverVisible(){return this._insistOnKeepingHoverVisible}set insistOnKeepingHoverVisible(e){this._insistOnKeepingHoverVisible=e}constructor(e,t){this._editor=e,this._participants=t,this._anchor=null,this._shouldFocus=!1,this._source=0,this._insistOnKeepingHoverVisible=!1}static _getLineDecorations(e,t){if(1!==t.type&&!t.supportsMarkerHover)return[];const i=e.getModel(),n=t.range.startLineNumber;if(n>i.getLineCount())return[];const o=i.getLineMaxColumn(n);return e.getLineDecorations(n).filter((e=>{if(e.options.isWholeLine)return!0;const i=e.range.startLineNumber===n?e.range.startColumn:1,s=e.range.endLineNumber===n?e.range.endColumn:o;if(e.options.showIfCollapsed){if(i>t.range.startColumn+1||t.range.endColumn-1>s)return!1}else if(i>t.range.startColumn||t.range.endColumn>s)return!1;return!0}))}computeAsync(e){const t=this._anchor;if(!this._editor.hasModel()||!t)return m.AE.EMPTY;const i=T._getLineDecorations(this._editor,t);return m.AE.merge(this._participants.map((n=>n.computeAsync?n.computeAsync(t,i,e):m.AE.EMPTY)))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const e=T._getLineDecorations(this._editor,this._anchor);let t=[];for(const i of this._participants)t=t.concat(i.computeSync(this._anchor,e));return(0,s.Yc)(t)}}function O(e,t,i,n,o,s){const r=i+o/2,a=n+s/2,l=Math.max(Math.abs(e-r)-o/2,0),c=Math.max(Math.abs(t-a)-s/2,0);return Math.sqrt(l*l+c*c)}},53998:(e,t,i)=>{i.d(t,{Zt:()=>d});var n=i(73990),o=i(25143),s=i(29591),r=i(30050),a=i(63910),l=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};class c{constructor(e,t,i){this.provider=e,this.hover=t,this.ordinal=i}}function d(e,t,i,o){const r=e.ordered(t).map(((e,n)=>function(e,t,i,n,o){return l(this,void 0,void 0,(function*(){try{const s=yield Promise.resolve(e.provideHover(i,n,o));if(s&&function(e){const t="undefined"!==typeof e.range,i="undefined"!==typeof e.contents&&e.contents&&e.contents.length>0;return t&&i}(s))return new c(e,s,t)}catch(r){(0,s.M_)(r)}}))}(e,n,t,i,o)));return n.AE.fromPromises(r).coalesce()}(0,r.ke)("_executeHoverProvider",((e,t,i)=>function(e,t,i,n){return d(e,t,i,n).map((e=>e.hover)).toPromise()}(e.get(a.u).hoverProvider,t,i,o.X.None)))},50122:(e,t,i)=>{i.d(t,{D:()=>Z});var n=i(57443),o=i(87766),s=i(30050),r=i(99005),a=i(72330),l=i(63970),c=i(33541),d=i(7123),h=i(32605),u=i(61498),g=i(58348),p=i(28969),m=i(17303),v=i(67809);const f=h.$;class _ extends o.jG{constructor(e,t,i){super(),this._renderDisposeables=this._register(new o.Cm),this._editor=e,this._isVisible=!1,this._messages=[],this._hover=this._register(new v.N4),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new p.T({editor:this._editor},t,i)),this._computer=new b(this._editor),this._hoverOperation=this._register(new m.w(this._editor,this._computer)),this._register(this._hoverOperation.onResult((e=>{this._withResult(e.value)}))),this._register(this._editor.onDidChangeModelDecorations((()=>this._onModelDecorationsChanged()))),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(50)&&this._updateFont()}))),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return _.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach((e=>this._editor.applyFontInfo(e)))}_onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._hoverOperation.start(0))}startShowingAt(e){this._computer.lineNumber!==e&&(this._hoverOperation.cancel(),this.hide(),this._computer.lineNumber=e,this._hoverOperation.start(0))}hide(){this._computer.lineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._computer.lineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();const i=document.createDocumentFragment();for(const n of t){const e=f("div.hover-row.markdown-hover"),t=h.BC(e,f("div.hover-contents")),o=this._renderDisposeables.add(this._markdownRenderer.render(n.value));t.appendChild(o.element),i.appendChild(e)}this._updateContents(i),this._showAt(e)}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont()}_showAt(e){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const t=this._editor.getLayoutInfo(),i=this._editor.getTopForLineNumber(e),n=this._editor.getScrollTop(),o=this._editor.getOption(66),s=i-n-(this._hover.containerDomNode.clientHeight-o)/2;this._hover.containerDomNode.style.left="".concat(t.glyphMarginLeft+t.glyphMarginWidth,"px"),this._hover.containerDomNode.style.top="".concat(Math.max(Math.round(s),0),"px")}}_.ID="editor.contrib.modesGlyphHoverWidget";class b{get lineNumber(){return this._lineNumber}set lineNumber(e){this._lineNumber=e}constructor(e){this._editor=e,this._lineNumber=-1}computeSync(){const e=e=>({value:e}),t=this._editor.getLineDecorations(this._lineNumber),i=[];if(!t)return i;for(const n of t){if(!n.options.glyphMarginClassName)continue;const t=n.options.glyphMarginHoverMessage;t&&!(0,g.it)(t)&&i.push(...(0,u._j)(t).map(e))}return i}}var C=i(39263),w=i(2531),y=i(68010),S=i(19700),L=i(85287),x=i(69406),k=i(73990),I=i(29591),D=i(53059),N=i(63910),R=i(70006),M=i(1170),P=i(76301),T=i(59303),O=i(19995),A=i(51413),E=i(39747),H=i(3607),F=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},W=function(e,t){return function(i,n){t(i,n,e)}};const V=h.$;class U{constructor(e,t,i){this.owner=e,this.range=t,this.marker=i}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}const z={type:1,filter:{include:T.gB.QuickFix},triggerAction:T.fo.QuickFixHover};let B=class{constructor(e,t,i,n){this._editor=e,this._markerDecorationsService=t,this._openerService=i,this._languageFeaturesService=n,this.hoverOrdinal=1,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||1!==e.type&&!e.supportsMarkerHover)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,o=i.getLineMaxColumn(n),s=[];for(const a of t){const t=a.range.startLineNumber===n?a.range.startColumn:1,l=a.range.endLineNumber===n?a.range.endColumn:o,c=this._markerDecorationsService.getMarker(i.uri,a);if(!c)continue;const d=new r.Q(e.range.startLineNumber,t,e.range.startLineNumber,l);s.push(new U(this,d,c))}return s}renderHoverParts(e,t){if(!t.length)return o.jG.None;const i=new o.Cm;t.forEach((t=>e.fragment.appendChild(this.renderMarkerHover(t,i))));const n=1===t.length?t[0]:t.sort(((e,t)=>E.cj.compare(e.marker.severity,t.marker.severity)))[0];return this.renderMarkerStatusbar(e,n,i),i}renderMarkerHover(e,t){const i=V("div.hover-row"),n=h.BC(i,V("div.marker.hover-contents")),{source:o,message:s,code:r,relatedInformation:a}=e.marker;this._editor.applyFontInfo(n);const l=h.BC(n,V("span"));if(l.style.whiteSpace="pre-wrap",l.innerText=s,o||r)if(r&&"string"!==typeof r){const e=V("span");if(o){h.BC(e,V("span")).innerText=o}const i=h.BC(e,V("a.code-link"));i.setAttribute("href",r.target.toString()),t.add(h.ko(i,"click",(e=>{this._openerService.open(r.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()})));h.BC(i,V("span")).innerText=r.value;const s=h.BC(n,e);s.style.opacity="0.6",s.style.paddingLeft="6px"}else{const e=h.BC(n,V("span"));e.style.opacity="0.6",e.style.paddingLeft="6px",e.innerText=o&&r?"".concat(o,"(").concat(r,")"):o||"(".concat(r,")")}if((0,u.EI)(a))for(const{message:c,resource:d,startLineNumber:u,startColumn:g}of a){const e=h.BC(n,V("div"));e.style.marginTop="8px";const i=h.BC(e,V("a"));i.innerText="".concat((0,D.P8)(d),"(").concat(u,", ").concat(g,"): "),i.style.cursor="pointer",t.add(h.ko(i,"click",(e=>{e.stopPropagation(),e.preventDefault(),this._openerService&&this._openerService.open(d,{fromUserGesture:!0,editorOptions:{selection:{startLineNumber:u,startColumn:g}}}).catch(I.dz)})));const o=h.BC(e,V("span"));o.innerText=c,this._editor.applyFontInfo(o)}return i}renderMarkerStatusbar(e,t,i){if(t.marker.severity!==E.cj.Error&&t.marker.severity!==E.cj.Warning&&t.marker.severity!==E.cj.Info||e.statusBar.addAction({label:A.kg("view problem","View Problem"),commandId:O.i.ID,run:()=>{var i;e.hide(),null===(i=O.j.get(this._editor))||void 0===i||i.showAtMarker(t.marker),this._editor.focus()}}),!this._editor.getOption(90)){const n=e.statusBar.append(V("div"));this.recentMarkerCodeActionsInfo&&(E.oc.makeKey(this.recentMarkerCodeActionsInfo.marker)===E.oc.makeKey(t.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(n.textContent=A.kg("noQuickFixes","No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const s=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?o.jG.None:i.add((0,k.EQ)((()=>n.textContent=A.kg("checkingForQuickFixes","Checking for quick fixes...")),200));n.textContent||(n.textContent=String.fromCharCode(160));const r=this.getCodeActions(t.marker);i.add((0,o.s)((()=>r.cancel()))),r.then((r=>{if(s.dispose(),this.recentMarkerCodeActionsInfo={marker:t.marker,hasCodeActions:r.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions)return r.dispose(),void(n.textContent=A.kg("noQuickFixes","No quick fixes available"));n.style.display="none";let a=!1;i.add((0,o.s)((()=>{a||r.dispose()}))),e.statusBar.addAction({label:A.kg("quick fixes","Quick Fix..."),commandId:M.pQ,run:t=>{a=!0;const i=P.C.get(this._editor),n=h.BK(t);e.hide(),null===i||void 0===i||i.showCodeActions(z,r,{x:n.left,y:n.top,width:n.width,height:n.height})}})}),I.dz)}}getCodeActions(e){return(0,k.SS)((t=>(0,M.dU)(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new r.Q(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),z,H.ke.None,t)))}};B=F([W(1,R.A),W(2,w.Cr),W(3,N.u)],B);var j,K=i(17907),Q=i(16391),q=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},G=function(e,t){return function(i,n){t(i,n,e)}};const Y=!1;let Z=j=class extends o.jG{static get(e){return e.getContribution(j.ID)}constructor(e,t,i,n,s){super(),this._editor=e,this._instantiationService=t,this._openerService=i,this._languageService=n,this._keybindingService=s,this._toUnhook=new o.Cm,this._hoverActivatedByColorDecoratorClick=!1,this._isMouseDown=!1,this._hoverClicked=!1,this._contentWidget=null,this._glyphWidget=null,this._reactToEditorMouseMoveRunner=this._register(new k.uC((()=>this._reactToEditorMouseMove(this._mouseMoveEvent)),0)),this._hookEvents(),this._register(this._editor.onDidChangeConfiguration((e=>{e.hasChanged(60)&&(this._unhookEvents(),this._hookEvents())}))),this._register(this._editor.onMouseLeave((()=>{this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()})))}_hookEvents(){const e=this._editor.getOption(60);this._isHoverEnabled=e.enabled,this._isHoverSticky=e.sticky,this._hidingDelay=e.hidingDelay,this._isHoverEnabled?(this._toUnhook.add(this._editor.onMouseDown((e=>this._onEditorMouseDown(e)))),this._toUnhook.add(this._editor.onMouseUp((e=>this._onEditorMouseUp(e)))),this._toUnhook.add(this._editor.onMouseMove((e=>this._onEditorMouseMove(e)))),this._toUnhook.add(this._editor.onKeyDown((e=>this._onKeyDown(e))))):(this._toUnhook.add(this._editor.onMouseMove((e=>this._onEditorMouseMove(e)))),this._toUnhook.add(this._editor.onKeyDown((e=>this._onKeyDown(e))))),this._toUnhook.add(this._editor.onMouseLeave((e=>this._onEditorMouseLeave(e)))),this._toUnhook.add(this._editor.onDidChangeModel((()=>this._hideWidgets()))),this._toUnhook.add(this._editor.onDidScrollChange((e=>this._onEditorScrollChanged(e))))}_unhookEvents(){this._toUnhook.clear()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){var t;this._isMouseDown=!0;const i=e.target;9!==i.type||i.detail!==d.Q1.ID?12===i.type&&i.detail===_.ID||(12!==i.type&&(this._hoverClicked=!1),(null===(t=this._contentWidget)||void 0===t?void 0:t.widget.isResizing)||this._hideWidgets()):this._hoverClicked=!0}_onEditorMouseUp(e){this._isMouseDown=!1}_onEditorMouseLeave(e){var t,i;const n=e.event.browserEvent.relatedTarget;(null===(t=this._contentWidget)||void 0===t?void 0:t.widget.isResizing)||(null===(i=this._contentWidget)||void 0===i?void 0:i.containsNode(n))||this._hideWidgets()}_isMouseOverWidget(e){var t,i,n,o,s;const r=e.target;return!(!this._isHoverSticky||9!==r.type||r.detail!==d.Q1.ID)||(!(!this._isHoverSticky||!(null===(t=this._contentWidget)||void 0===t?void 0:t.containsNode(null===(i=e.event.browserEvent.view)||void 0===i?void 0:i.document.activeElement))||(null===(o=null===(n=e.event.browserEvent.view)||void 0===n?void 0:n.getSelection())||void 0===o?void 0:o.isCollapsed))||(!(this._isHoverSticky||9!==r.type||r.detail!==d.Q1.ID||!(null===(s=this._contentWidget)||void 0===s?void 0:s.isColorPickerVisible))||!(!this._isHoverSticky||12!==r.type||r.detail!==_.ID)))}_onEditorMouseMove(e){var t,i,n,o;if(this._mouseMoveEvent=e,(null===(t=this._contentWidget)||void 0===t?void 0:t.isFocused)||(null===(i=this._contentWidget)||void 0===i?void 0:i.isResizing))return;if(this._isMouseDown&&this._hoverClicked)return;if(this._isHoverSticky&&(null===(n=this._contentWidget)||void 0===n?void 0:n.isVisibleFromKeyboard))return;this._isMouseOverWidget(e)?this._reactToEditorMouseMoveRunner.cancel():(null===(o=this._contentWidget)||void 0===o?void 0:o.isVisible)&&this._isHoverSticky&&this._hidingDelay>0?this._reactToEditorMouseMoveRunner.isScheduled()||this._reactToEditorMouseMoveRunner.schedule(this._hidingDelay):this._reactToEditorMouseMove(e)}_reactToEditorMouseMove(e){var t,i,n;if(!e)return;const o=e.target,s=null===(t=o.element)||void 0===t?void 0:t.classList.contains("colorpicker-color-decoration"),r=this._editor.getOption(146);if(s&&("click"===r&&!this._hoverActivatedByColorDecoratorClick||"hover"===r&&!this._isHoverEnabled||"clickAndHover"===r&&!this._isHoverEnabled&&!this._hoverActivatedByColorDecoratorClick)||!s&&!this._isHoverEnabled&&!this._hoverActivatedByColorDecoratorClick)return void this._hideWidgets();if(this._getOrCreateContentWidget().maybeShowAt(e))null===(i=this._glyphWidget)||void 0===i||i.hide();else{if(2===o.type&&o.position)return null===(n=this._contentWidget)||void 0===n||n.hide(),this._glyphWidget||(this._glyphWidget=new _(this._editor,this._languageService,this._openerService)),void this._glyphWidget.startShowingAt(o.position.lineNumber);Y,this._hideWidgets()}}_onKeyDown(e){var t;if(!this._editor.hasModel())return;const i=this._keybindingService.softDispatch(e,this._editor.getDomNode()),n=1===i.kind||2===i.kind&&"editor.action.showHover"===i.commandId&&(null===(t=this._contentWidget)||void 0===t?void 0:t.isVisible);5===e.keyCode||6===e.keyCode||57===e.keyCode||4===e.keyCode||n||this._hideWidgets()}_hideWidgets(){var e,t,i;this._isMouseDown&&this._hoverClicked&&(null===(e=this._contentWidget)||void 0===e?void 0:e.isColorPickerVisible)||K.bo.dropDownVisible||(this._hoverActivatedByColorDecoratorClick=!1,this._hoverClicked=!1,null===(t=this._glyphWidget)||void 0===t||t.hide(),null===(i=this._contentWidget)||void 0===i||i.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(d.Ad,this._editor)),this._contentWidget}showContentHover(e,t,i,n){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this._hoverActivatedByColorDecoratorClick=o,this._getOrCreateContentWidget().startShowingAtRange(e,t,i,n)}focus(){var e;null===(e=this._contentWidget)||void 0===e||e.focus()}scrollUp(){var e;null===(e=this._contentWidget)||void 0===e||e.scrollUp()}scrollDown(){var e;null===(e=this._contentWidget)||void 0===e||e.scrollDown()}scrollLeft(){var e;null===(e=this._contentWidget)||void 0===e||e.scrollLeft()}scrollRight(){var e;null===(e=this._contentWidget)||void 0===e||e.scrollRight()}pageUp(){var e;null===(e=this._contentWidget)||void 0===e||e.pageUp()}pageDown(){var e;null===(e=this._contentWidget)||void 0===e||e.pageDown()}goToTop(){var e;null===(e=this._contentWidget)||void 0===e||e.goToTop()}goToBottom(){var e;null===(e=this._contentWidget)||void 0===e||e.goToBottom()}get isColorPickerVisible(){var e;return null===(e=this._contentWidget)||void 0===e?void 0:e.isColorPickerVisible}get isHoverVisible(){var e;return null===(e=this._contentWidget)||void 0===e?void 0:e.isVisible}dispose(){var e,t;super.dispose(),this._unhookEvents(),this._toUnhook.dispose(),null===(e=this._glyphWidget)||void 0===e||e.dispose(),null===(t=this._contentWidget)||void 0===t||t.dispose()}};Z.ID="editor.contrib.hover",Z=j=q([G(1,C._Y),G(2,w.Cr),G(3,l.L),G(4,Q.b)],Z);class $ extends s.ks{constructor(){super({id:"editor.action.showHover",label:A.kg({key:"showOrFocusHover",comment:["Label for action that will trigger the showing/focusing of a hover in the editor.","If the hover is not visible, it will show the hover.","This allows for users to show the hover without using the mouse.","If the hover is already visible, it will take focus."]},"Show or Focus Hover"),description:{description:"Show or Focus Hover",args:[{name:"args",schema:{type:"object",properties:{focus:{description:"Controls if when triggered with the keyboard, the hover should take focus immediately.",type:"boolean",default:!1}}}}]},alias:"Show or Focus Hover",precondition:void 0,kbOpts:{kbExpr:a.R.editorTextFocus,primary:(0,n.m5)(2089,2087),weight:100}})}run(e,t,i){if(!t.hasModel())return;const n=Z.get(t);if(!n)return;const o=t.getPosition(),s=new r.Q(o.lineNumber,o.column,o.lineNumber,o.column),a=2===t.getOption(2)||!!(null===i||void 0===i?void 0:i.focus);n.isHoverVisible?n.focus():n.showContentHover(s,1,1,a)}}class X extends s.ks{constructor(){super({id:"editor.action.showDefinitionPreviewHover",label:A.kg({key:"showDefinitionPreviewHover",comment:["Label for action that will trigger the showing of definition preview hover in the editor.","This allows for users to show the definition preview hover without using the mouse."]},"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0})}run(e,t){const i=Z.get(t);if(!i)return;const n=t.getPosition();if(!n)return;const o=new r.Q(n.lineNumber,n.column,n.lineNumber,n.column),s=c.k.get(t);if(!s)return;s.startFindDefinitionFromCursor(n).then((()=>{i.showContentHover(o,1,1,!0)}))}}class J extends s.ks{constructor(){super({id:"editor.action.scrollUpHover",label:A.kg({key:"scrollUpHover",comment:["Action that allows to scroll up in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Up Hover"),alias:"Scroll Up Hover",precondition:a.R.hoverFocused,kbOpts:{kbExpr:a.R.hoverFocused,primary:16,weight:100}})}run(e,t){const i=Z.get(t);i&&i.scrollUp()}}class ee extends s.ks{constructor(){super({id:"editor.action.scrollDownHover",label:A.kg({key:"scrollDownHover",comment:["Action that allows to scroll down in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Down Hover"),alias:"Scroll Down Hover",precondition:a.R.hoverFocused,kbOpts:{kbExpr:a.R.hoverFocused,primary:18,weight:100}})}run(e,t){const i=Z.get(t);i&&i.scrollDown()}}class te extends s.ks{constructor(){super({id:"editor.action.scrollLeftHover",label:A.kg({key:"scrollLeftHover",comment:["Action that allows to scroll left in the hover widget with the left arrow when the hover widget is focused."]},"Scroll Left Hover"),alias:"Scroll Left Hover",precondition:a.R.hoverFocused,kbOpts:{kbExpr:a.R.hoverFocused,primary:15,weight:100}})}run(e,t){const i=Z.get(t);i&&i.scrollLeft()}}class ie extends s.ks{constructor(){super({id:"editor.action.scrollRightHover",label:A.kg({key:"scrollRightHover",comment:["Action that allows to scroll right in the hover widget with the right arrow when the hover widget is focused."]},"Scroll Right Hover"),alias:"Scroll Right Hover",precondition:a.R.hoverFocused,kbOpts:{kbExpr:a.R.hoverFocused,primary:17,weight:100}})}run(e,t){const i=Z.get(t);i&&i.scrollRight()}}class ne extends s.ks{constructor(){super({id:"editor.action.pageUpHover",label:A.kg({key:"pageUpHover",comment:["Action that allows to page up in the hover widget with the page up command when the hover widget is focused."]},"Page Up Hover"),alias:"Page Up Hover",precondition:a.R.hoverFocused,kbOpts:{kbExpr:a.R.hoverFocused,primary:11,secondary:[528],weight:100}})}run(e,t){const i=Z.get(t);i&&i.pageUp()}}class oe extends s.ks{constructor(){super({id:"editor.action.pageDownHover",label:A.kg({key:"pageDownHover",comment:["Action that allows to page down in the hover widget with the page down command when the hover widget is focused."]},"Page Down Hover"),alias:"Page Down Hover",precondition:a.R.hoverFocused,kbOpts:{kbExpr:a.R.hoverFocused,primary:12,secondary:[530],weight:100}})}run(e,t){const i=Z.get(t);i&&i.pageDown()}}class se extends s.ks{constructor(){super({id:"editor.action.goToTopHover",label:A.kg({key:"goToTopHover",comment:["Action that allows to go to the top of the hover widget with the home command when the hover widget is focused."]},"Go To Top Hover"),alias:"Go To Bottom Hover",precondition:a.R.hoverFocused,kbOpts:{kbExpr:a.R.hoverFocused,primary:14,secondary:[2064],weight:100}})}run(e,t){const i=Z.get(t);i&&i.goToTop()}}class re extends s.ks{constructor(){super({id:"editor.action.goToBottomHover",label:A.kg({key:"goToBottomHover",comment:["Action that allows to go to the bottom in the hover widget with the end command when the hover widget is focused."]},"Go To Bottom Hover"),alias:"Go To Bottom Hover",precondition:a.R.hoverFocused,kbOpts:{kbExpr:a.R.hoverFocused,primary:13,secondary:[2066],weight:100}})}run(e,t){const i=Z.get(t);i&&i.goToBottom()}}(0,s.HW)(Z.ID,Z,2),(0,s.Fl)($),(0,s.Fl)(X),(0,s.Fl)(J),(0,s.Fl)(ee),(0,s.Fl)(te),(0,s.Fl)(ie),(0,s.Fl)(ne),(0,s.Fl)(oe),(0,s.Fl)(se),(0,s.Fl)(re),L.B2.register(x.xJ),L.B2.register(B),(0,S.zy)(((e,t)=>{const i=e.getColor(y.oZ8);i&&(t.addRule(".monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ".concat(i.transparent(.5),"; }")),t.addRule(".monaco-editor .monaco-hover hr { border-top: 1px solid ".concat(i.transparent(.5),"; }")),t.addRule(".monaco-editor .monaco-hover hr { border-bottom: 0px solid ".concat(i.transparent(.5),"; }")))}))},17303:(e,t,i)=>{i.d(t,{w:()=>d});var n=i(73990),o=i(29591),s=i(48250),r=i(87766),a=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))},l=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"===typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,o){(function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)})(n,o,(t=e[i](t)).done,t.value)}))}}};class c{constructor(e,t,i){this.value=e,this.isComplete=t,this.hasLoadingMessage=i}}class d extends r.jG{constructor(e,t){super(),this._editor=e,this._computer=t,this._onResult=this._register(new s.vl),this.onResult=this._onResult.event,this._firstWaitScheduler=this._register(new n.uC((()=>this._triggerAsyncComputation()),0)),this._secondWaitScheduler=this._register(new n.uC((()=>this._triggerSyncComputation()),0)),this._loadingMessageScheduler=this._register(new n.uC((()=>this._triggerLoadingMessage()),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),super.dispose()}get _hoverTime(){return this._editor.getOption(60).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._state=e,t&&this._fireResult()}_triggerAsyncComputation(){this._setState(2),this._secondWaitScheduler.schedule(this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=(0,n.bI)((e=>this._computer.computeAsync(e))),(()=>{a(this,void 0,void 0,(function*(){var e,t,i,n;try{try{for(var s,r=!0,a=l(this._asyncIterable);!(e=(s=yield a.next()).done);r=!0){n=s.value,r=!1;const e=n;e&&(this._result.push(e),this._fireResult())}}catch(c){t={error:c}}finally{try{r||e||!(i=a.return)||(yield i.call(a))}finally{if(t)throw t.error}}this._asyncIterableDone=!0,3!==this._state&&4!==this._state||this._setState(0)}catch(d){(0,o.dz)(d)}}))})()):this._asyncIterableDone=!0}_triggerSyncComputation(){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync())),this._setState(this._asyncIterableDone?0:3)}_triggerLoadingMessage(){3===this._state&&this._setState(4)}_fireResult(){if(1===this._state||2===this._state)return;const e=0===this._state,t=4===this._state;this._onResult.fire(new c(this._result.slice(0),e,t))}start(e){if(0===e)0===this._state&&(this._setState(1),this._firstWaitScheduler.schedule(this._firstWaitTime),this._loadingMessageScheduler.schedule(this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation()}}cancel(){this._firstWaitScheduler.cancel(),this._secondWaitScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._setState(0,!1)}}},85287:(e,t,i)=>{i.d(t,{B2:()=>s,hx:()=>n,mm:()=>o});class n{constructor(e,t,i,n){this.priority=e,this.range=t,this.initialMousePosX=i,this.initialMousePosY=n,this.type=1}equals(e){return 1===e.type&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return 1===e.type&&t.lineNumber===this.range.startLineNumber}}class o{constructor(e,t,i,n,o,s){this.priority=e,this.owner=t,this.range=i,this.initialMousePosX=n,this.initialMousePosY=o,this.supportsMarkerHover=s,this.type=2}equals(e){return 2===e.type&&this.owner===e.owner}canAdoptVisibleHover(e,t){return 2===e.type&&this.owner===e.owner}}const s=new class{constructor(){this._participants=[]}register(e){this._participants.push(e)}getAll(){return this._participants}}},69406:(e,t,i)=>{i.d(t,{eH:()=>C,fm:()=>y,xJ:()=>w});var n=i(32605),o=i(61498),s=i(73990),r=i(58348),a=i(87766),l=i(28969),c=i(23525),d=i(99005),h=i(63970),u=i(53998),g=i(51413),p=i(66457),m=i(2531),v=i(63910),f=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},_=function(e,t){return function(i,n){t(i,n,e)}};const b=n.$;class C{constructor(e,t,i,n,o){this.owner=e,this.range=t,this.contents=i,this.isBeforeContent=n,this.ordinal=o}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let w=class{constructor(e,t,i,n,o){this._editor=e,this._languageService=t,this._openerService=i,this._configurationService=n,this._languageFeaturesService=o,this.hoverOrdinal=3}createLoadingMessage(e){return new C(this,e.range,[(new r.Bc).appendText(g.kg("modesContentHover.loading","Loading..."))],!1,2e3)}computeSync(e,t){if(!this._editor.hasModel()||1!==e.type)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,s=i.getLineMaxColumn(n),a=[];let l=1e3;const c=i.getLineLength(n),h=i.getLanguageIdAtPosition(e.range.startLineNumber,e.range.startColumn),u=this._editor.getOption(116),p=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:h});let m=!1;u>=0&&c>u&&e.range.startColumn>=u&&(m=!0,a.push(new C(this,e.range,[{value:g.kg("stopped rendering","Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.")}],!1,l++))),!m&&"number"===typeof p&&c>=p&&a.push(new C(this,e.range,[{value:g.kg("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],!1,l++));let v=!1;for(const g of t){const t=g.range.startLineNumber===n?g.range.startColumn:1,i=g.range.endLineNumber===n?g.range.endColumn:s,c=g.options.hoverMessage;if(!c||(0,r.it)(c))continue;g.options.beforeContentClassName&&(v=!0);const h=new d.Q(e.range.startLineNumber,t,e.range.startLineNumber,i);a.push(new C(this,h,(0,o._j)(c),v,l++))}return a}computeAsync(e,t,i){if(!this._editor.hasModel()||1!==e.type)return s.AE.EMPTY;const n=this._editor.getModel();if(!this._languageFeaturesService.hoverProvider.has(n))return s.AE.EMPTY;const o=new c.y(e.range.startLineNumber,e.range.startColumn);return(0,u.Zt)(this._languageFeaturesService.hoverProvider,n,o,i).filter((e=>!(0,r.it)(e.hover.contents))).map((t=>{const i=t.hover.range?d.Q.lift(t.hover.range):e.range;return new C(this,i,t.hover.contents,!1,t.ordinal)}))}renderHoverParts(e,t){return y(e,t,this._editor,this._languageService,this._openerService)}};function y(e,t,i,o,s){t.sort(((e,t)=>e.ordinal-t.ordinal));const c=new a.Cm;for(const a of t)for(const t of a.contents){if((0,r.it)(t))continue;const a=b("div.hover-row.markdown-hover"),d=n.BC(a,b("div.hover-contents")),h=c.add(new l.T({editor:i},o,s));c.add(h.onDidRenderAsync((()=>{d.className="hover-contents code-hover-contents",e.onContentsChanged()})));const u=c.add(h.render(t));d.appendChild(u.element),e.fragment.appendChild(a)}return c}w=f([_(1,h.L),_(2,m.Cr),_(3,p.pG),_(4,v.u)],w)},89762:(e,t,i)=>{var n=i(73990),o=i(29591),s=i(39212),r=i(30050),a=i(99005),l=i(5190),c=i(72330),d=i(15739),h=i(35296),u=i(51413);class g{constructor(e,t,i){this._editRange=e,this._originalSelection=t,this._text=i}getEditOperations(e,t){t.addTrackedEditOperation(this._editRange,this._text)}computeCursorState(e,t){const i=t.getInverseEditOperations()[0].range;return this._originalSelection.isEmpty()?new l.L(i.endLineNumber,Math.min(this._originalSelection.positionColumn,i.endColumn),i.endLineNumber,Math.min(this._originalSelection.positionColumn,i.endColumn)):new l.L(i.endLineNumber,i.endColumn-this._text.length,i.endLineNumber,i.endColumn)}}var p,m=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},v=function(e,t){return function(i,n){t(i,n,e)}};let f=p=class{static get(e){return e.getContribution(p.ID)}constructor(e,t){this.editor=e,this.editorWorkerService=t,this.decorations=this.editor.createDecorationsCollection()}dispose(){}run(e,t){var i;null===(i=this.currentRequest)||void 0===i||i.cancel();const r=this.editor.getSelection(),c=this.editor.getModel();if(!c||!r)return;let d=r;if(d.startLineNumber!==d.endLineNumber)return;const h=new s.$t(this.editor,5),u=c.uri;return this.editorWorkerService.canNavigateValueSet(u)?(this.currentRequest=(0,n.SS)((e=>this.editorWorkerService.navigateValueSet(u,d,t))),this.currentRequest.then((t=>{var i;if(!t||!t.range||!t.value)return;if(!h.validate(this.editor))return;const s=a.Q.lift(t.range);let r=t.range;const c=t.value.length-(d.endColumn-d.startColumn);r={startLineNumber:r.startLineNumber,startColumn:r.startColumn,endLineNumber:r.endLineNumber,endColumn:r.startColumn+t.value.length},c>1&&(d=new l.L(d.startLineNumber,d.startColumn,d.endLineNumber,d.endColumn+c-1));const u=new g(s,d,t.value);this.editor.pushUndoStop(),this.editor.executeCommand(e,u),this.editor.pushUndoStop(),this.decorations.set([{range:r,options:p.DECORATION}]),null===(i=this.decorationRemover)||void 0===i||i.cancel(),this.decorationRemover=(0,n.wR)(350),this.decorationRemover.then((()=>this.decorations.clear())).catch(o.dz)})).catch(o.dz)):Promise.resolve(void 0)}};f.ID="editor.contrib.inPlaceReplaceController",f.DECORATION=d.kI.register({description:"in-place-replace",className:"valueSetReplacement"}),f=p=m([v(1,h.w)],f);class _ extends r.ks{constructor(){super({id:"editor.action.inPlaceReplace.up",label:u.kg("InPlaceReplaceAction.previous.label","Replace with Previous Value"),alias:"Replace with Previous Value",precondition:c.R.writable,kbOpts:{kbExpr:c.R.editorTextFocus,primary:3159,weight:100}})}run(e,t){const i=f.get(t);return i?i.run(this.id,!1):Promise.resolve(void 0)}}class b extends r.ks{constructor(){super({id:"editor.action.inPlaceReplace.down",label:u.kg("InPlaceReplaceAction.next.label","Replace with Next Value"),alias:"Replace with Next Value",precondition:c.R.writable,kbOpts:{kbExpr:c.R.editorTextFocus,primary:3161,weight:100}})}run(e,t){const i=f.get(t);return i?i.run(this.id,!0):Promise.resolve(void 0)}}(0,r.HW)(f.ID,f,4),(0,r.Fl)(_),(0,r.Fl)(b)},85764:(e,t,i)=>{function n(e,t){let i=0;for(let n=0;n<e.length;n++)"\t"===e.charAt(n)?i+=t:i++;return i}function o(e,t,i){e=e<0?0:e;let n="";if(!i){const i=Math.floor(e/t);e%=t;for(let e=0;e<i;e++)n+="\t"}for(let o=0;o<e;o++)n+=" ";return n}i.d(t,{c:()=>n,k:()=>o})},2768:(e,t,i)=>{var n=i(87766),o=i(12780),s=i(30050),r=i(90984),a=i(94597),l=i(99005),c=i(5190),d=i(72330),h=i(80158),u=i(21950),g=i(85764),p=i(51413),m=i(50051),v=i(77327),f=i(47893),_=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},b=function(e,t){return function(i,n){t(i,n,e)}};function C(e,t,i,n,s){if(1===e.getLineCount()&&1===e.getLineMaxColumn(1))return[];const l=t.getLanguageConfiguration(e.getLanguageId()).indentationRules;if(!l)return[];for(n=Math.min(n,e.getLineCount());i<=n&&l.unIndentedLinePattern;){const t=e.getLineContent(i);if(!l.unIndentedLinePattern.test(t))break;i++}if(i>n-1)return[];const{tabSize:d,indentSize:h,insertSpaces:u}=e.getOptions(),g=(e,t)=>(t=t||1,r.Y.shiftIndent(e,e.length+t,d,h,u)),p=(e,t)=>(t=t||1,r.Y.unshiftIndent(e,e.length+t,d,h,u)),m=[];let f;const _=e.getLineContent(i);let b=_;if(void 0!==s&&null!==s){f=s;const e=o.UU(_);b=f+_.substring(e.length),l.decreaseIndentPattern&&l.decreaseIndentPattern.test(b)&&(f=p(f),b=f+_.substring(e.length)),_!==b&&m.push(a.k.replaceMove(new c.L(i,1,i,e.length+1),(0,v.P)(f,h,u)))}else f=o.UU(_);let C=f;l.increaseIndentPattern&&l.increaseIndentPattern.test(b)?(C=g(C),f=g(f)):l.indentNextLinePattern&&l.indentNextLinePattern.test(b)&&(C=g(C));for(let r=++i;r<=n;r++){const t=e.getLineContent(r),i=o.UU(t),n=C+t.substring(i.length);l.decreaseIndentPattern&&l.decreaseIndentPattern.test(n)&&(C=p(C),f=p(f)),i!==C&&m.push(a.k.replaceMove(new c.L(r,1,r,i.length+1),(0,v.P)(C,h,u))),l.unIndentedLinePattern&&l.unIndentedLinePattern.test(t)||(l.increaseIndentPattern&&l.increaseIndentPattern.test(n)?(f=g(f),C=f):C=l.indentNextLinePattern&&l.indentNextLinePattern.test(n)?g(C):f)}return m}class w extends s.ks{constructor(){super({id:w.ID,label:p.kg("indentationToSpaces","Convert Indentation to Spaces"),alias:"Convert Indentation to Spaces",precondition:d.R.writable})}run(e,t){const i=t.getModel();if(!i)return;const n=i.getOptions(),o=t.getSelection();if(!o)return;const s=new T(o,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[s]),t.pushUndoStop(),i.updateOptions({insertSpaces:!0})}}w.ID="editor.action.indentationToSpaces";class y extends s.ks{constructor(){super({id:y.ID,label:p.kg("indentationToTabs","Convert Indentation to Tabs"),alias:"Convert Indentation to Tabs",precondition:d.R.writable})}run(e,t){const i=t.getModel();if(!i)return;const n=i.getOptions(),o=t.getSelection();if(!o)return;const s=new O(o,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[s]),t.pushUndoStop(),i.updateOptions({insertSpaces:!1})}}y.ID="editor.action.indentationToTabs";class S extends s.ks{constructor(e,t,i){super(i),this.insertSpaces=e,this.displaySizeOnly=t}run(e,t){const i=e.get(m.GK),n=e.get(u.S),o=t.getModel();if(!o)return;const s=n.getCreationOptions(o.getLanguageId(),o.uri,o.isForSimpleWidget),r=o.getOptions(),a=[1,2,3,4,5,6,7,8].map((e=>({id:e.toString(),label:e.toString(),description:e===s.tabSize&&e===r.tabSize?p.kg("configuredTabSize","Configured Tab Size"):e===s.tabSize?p.kg("defaultTabSize","Default Tab Size"):e===r.tabSize?p.kg("currentTabSize","Current Tab Size"):void 0}))),l=Math.min(o.getOptions().tabSize-1,7);setTimeout((()=>{i.pick(a,{placeHolder:p.kg({key:"selectTabWidth",comment:["Tab corresponds to the tab key"]},"Select Tab Size for Current File"),activeItem:a[l]}).then((e=>{if(e&&o&&!o.isDisposed()){const t=parseInt(e.label,10);this.displaySizeOnly?o.updateOptions({tabSize:t}):o.updateOptions({tabSize:t,indentSize:t,insertSpaces:this.insertSpaces})}}))}),50)}}class L extends S{constructor(){super(!1,!1,{id:L.ID,label:p.kg("indentUsingTabs","Indent Using Tabs"),alias:"Indent Using Tabs",precondition:void 0})}}L.ID="editor.action.indentUsingTabs";class x extends S{constructor(){super(!0,!1,{id:x.ID,label:p.kg("indentUsingSpaces","Indent Using Spaces"),alias:"Indent Using Spaces",precondition:void 0})}}x.ID="editor.action.indentUsingSpaces";class k extends S{constructor(){super(!0,!0,{id:k.ID,label:p.kg("changeTabDisplaySize","Change Tab Display Size"),alias:"Change Tab Display Size",precondition:void 0})}}k.ID="editor.action.changeTabDisplaySize";class I extends s.ks{constructor(){super({id:I.ID,label:p.kg("detectIndentation","Detect Indentation from Content"),alias:"Detect Indentation from Content",precondition:void 0})}run(e,t){const i=e.get(u.S),n=t.getModel();if(!n)return;const o=i.getCreationOptions(n.getLanguageId(),n.uri,n.isForSimpleWidget);n.detectIndentation(o.insertSpaces,o.tabSize)}}I.ID="editor.action.detectIndentation";class D extends s.ks{constructor(){super({id:"editor.action.reindentlines",label:p.kg("editor.reindentlines","Reindent Lines"),alias:"Reindent Lines",precondition:d.R.writable})}run(e,t){const i=e.get(h.JZ),n=t.getModel();if(!n)return;const o=C(n,i,1,n.getLineCount());o.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,o),t.pushUndoStop())}}class N extends s.ks{constructor(){super({id:"editor.action.reindentselectedlines",label:p.kg("editor.reindentselectedlines","Reindent Selected Lines"),alias:"Reindent Selected Lines",precondition:d.R.writable})}run(e,t){const i=e.get(h.JZ),n=t.getModel();if(!n)return;const o=t.getSelections();if(null===o)return;const s=[];for(const r of o){let e=r.startLineNumber,t=r.endLineNumber;if(e!==t&&1===r.endColumn&&t--,1===e){if(e===t)continue}else e--;const o=C(n,i,e,t);s.push(...o)}s.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,s),t.pushUndoStop())}}class R{constructor(e,t){this._initialSelection=t,this._edits=[],this._selectionId=null;for(const i of e)i.range&&"string"===typeof i.text&&this._edits.push(i)}getEditOperations(e,t){for(const n of this._edits)t.addEditOperation(l.Q.lift(n.range),n.text);let i=!1;Array.isArray(this._edits)&&1===this._edits.length&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!1))),i||(this._selectionId=t.trackSelection(this._initialSelection))}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}let M=class{constructor(e,t){this.editor=e,this._languageConfigurationService=t,this.callOnDispose=new n.Cm,this.callOnModel=new n.Cm,this.callOnDispose.add(e.onDidChangeConfiguration((()=>this.update()))),this.callOnDispose.add(e.onDidChangeModel((()=>this.update()))),this.callOnDispose.add(e.onDidChangeModelLanguage((()=>this.update())))}update(){this.callOnModel.clear(),this.editor.getOption(12)<4||this.editor.getOption(55)||this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste((e=>{let{range:t}=e;this.trigger(t)})))}trigger(e){const t=this.editor.getSelections();if(null===t||t.length>1)return;const i=this.editor.getModel();if(!i)return;if(!i.tokenization.isCheapToTokenize(e.getStartPosition().lineNumber))return;const n=this.editor.getOption(12),{tabSize:s,indentSize:a,insertSpaces:c}=i.getOptions(),d=[],h={shiftIndent:e=>r.Y.shiftIndent(e,e.length+1,s,a,c),unshiftIndent:e=>r.Y.unshiftIndent(e,e.length+1,s,a,c)};let u=e.startLineNumber;for(;u<=e.endLineNumber&&this.shouldIgnoreLine(i,u);)u++;if(u>e.endLineNumber)return;let p=i.getLineContent(u);if(!/\S/.test(p.substring(0,e.startColumn-1))){const e=(0,f.$f)(n,i,i.getLanguageId(),u,h,this._languageConfigurationService);if(null!==e){const t=o.UU(p),n=g.c(e,s);if(n!==g.c(t,s)){const e=g.k(n,s,c);d.push({range:new l.Q(u,1,u,t.length+1),text:e}),p=e+p.substr(t.length)}else{const e=(0,f.Yb)(i,u,this._languageConfigurationService);if(0===e||8===e)return}}}const m=u;for(;u<e.endLineNumber&&!/\S/.test(i.getLineContent(u+1));)u++;if(u!==e.endLineNumber){const t={tokenization:{getLineTokens:e=>i.tokenization.getLineTokens(e),getLanguageId:()=>i.getLanguageId(),getLanguageIdAtPosition:(e,t)=>i.getLanguageIdAtPosition(e,t)},getLineContent:e=>e===m?p:i.getLineContent(e)},r=(0,f.$f)(n,t,i.getLanguageId(),u+1,h,this._languageConfigurationService);if(null!==r){const t=g.c(r,s),n=g.c(o.UU(i.getLineContent(u+1)),s);if(t!==n){const r=t-n;for(let t=u+1;t<=e.endLineNumber;t++){const e=i.getLineContent(t),n=o.UU(e),a=g.c(n,s)+r,h=g.k(a,s,c);h!==n&&d.push({range:new l.Q(t,1,t,n.length+1),text:h})}}}}if(d.length>0){this.editor.pushUndoStop();const e=new R(d,this.editor.getSelection());this.editor.executeCommand("autoIndentOnPaste",e),this.editor.pushUndoStop()}}shouldIgnoreLine(e,t){e.tokenization.forceTokenization(t);const i=e.getLineFirstNonWhitespaceColumn(t);if(0===i)return!0;const n=e.tokenization.getLineTokens(t);if(n.getCount()>0){const e=n.findTokenIndexAtOffset(i);if(e>=0&&1===n.getStandardTokenType(e))return!0}return!1}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}};function P(e,t,i,n){if(1===e.getLineCount()&&1===e.getLineMaxColumn(1))return;let o="";for(let r=0;r<i;r++)o+=" ";const s=new RegExp(o,"gi");for(let r=1,a=e.getLineCount();r<=a;r++){let i=e.getLineFirstNonWhitespaceColumn(r);if(0===i&&(i=e.getLineMaxColumn(r)),1===i)continue;const a=new l.Q(r,1,r,i),c=e.getValueInRange(a),d=n?c.replace(/\t/gi,o):c.replace(s,"\t");t.addEditOperation(a,d)}}M.ID="editor.contrib.autoIndentOnPaste",M=_([b(1,h.JZ)],M);class T{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),P(e,t,this.tabSize,!0)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}class O{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),P(e,t,this.tabSize,!1)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}(0,s.HW)(M.ID,M,2),(0,s.Fl)(w),(0,s.Fl)(y),(0,s.Fl)(L),(0,s.Fl)(x),(0,s.Fl)(k),(0,s.Fl)(I),(0,s.Fl)(D),(0,s.Fl)(N)},90809:(e,t,i)=>{var n=i(30050),o=i(85287),s=i(32605),r=i(61498),a=i(73990),l=i(25143),c=i(29591),d=i(87766),h=i(67512),u=i(32031),g=i(97072),p=i(23726),m=i(56718),v=i(81196),f=i(94597),_=i(99005),b=i(91861),C=i(32743),w=i(15739),y=i(50044),S=i(63910),L=i(58066),x=i(59183),k=i(23525),I=i(83888),D=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};class N{constructor(e,t){this.range=e,this.direction=t}}class R{constructor(e,t,i){this.hint=e,this.anchor=t,this.provider=i,this._isResolved=!1}with(e){const t=new R(this.hint,e.anchor,this.provider);return t._isResolved=this._isResolved,t._currentResolve=this._currentResolve,t}resolve(e){return D(this,void 0,void 0,(function*(){if("function"===typeof this.provider.resolveInlayHint){if(this._currentResolve){if(yield this._currentResolve,e.isCancellationRequested)return;return this.resolve(e)}this._isResolved||(this._currentResolve=this._doResolve(e).finally((()=>this._currentResolve=void 0))),yield this._currentResolve}}))}_doResolve(e){var t,i;return D(this,void 0,void 0,(function*(){try{const n=yield Promise.resolve(this.provider.resolveInlayHint(this.hint,e));this.hint.tooltip=null!==(t=null===n||void 0===n?void 0:n.tooltip)&&void 0!==t?t:this.hint.tooltip,this.hint.label=null!==(i=null===n||void 0===n?void 0:n.label)&&void 0!==i?i:this.hint.label,this._isResolved=!0}catch(n){(0,c.M_)(n),this._isResolved=!1}}))}}class M{static create(e,t,i,n){return D(this,void 0,void 0,(function*(){const o=[],s=e.ordered(t).reverse().map((e=>i.map((i=>D(this,void 0,void 0,(function*(){try{const s=yield e.provideInlayHints(t,i,n);(null===s||void 0===s?void 0:s.hints.length)&&o.push([s,e])}catch(s){(0,c.M_)(s)}}))))));if(yield Promise.all(s.flat()),n.isCancellationRequested||t.isDisposed())throw new c.AL;return new M(i,o,t)}))}constructor(e,t,i){this._disposables=new d.Cm,this.ranges=e,this.provider=new Set;const n=[];for(const[o,s]of t){this._disposables.add(o),this.provider.add(s);for(const e of o.hints){const t=i.validatePosition(e.position);let o="before";const r=M._getRangeAtPosition(i,t);let a;r.getStartPosition().isBefore(t)?(a=_.Q.fromPositions(r.getStartPosition(),t),o="after"):(a=_.Q.fromPositions(t,r.getEndPosition()),o="before"),n.push(new R(e,new N(a,o),s))}}this.items=n.sort(((e,t)=>k.y.compare(e.hint.position,t.hint.position)))}dispose(){this._disposables.dispose()}static _getRangeAtPosition(e,t){const i=t.lineNumber,n=e.getWordAtPosition(t);if(n)return new _.Q(i,n.startColumn,i,n.endColumn);e.tokenization.tokenizeIfCheap(i);const o=e.tokenization.getLineTokens(i),s=t.column-1,r=o.findTokenIndexAtOffset(s);let a=o.getStartOffset(r),l=o.getEndOffset(r);return l-a===1&&(a===s&&r>1?(a=o.getStartOffset(r-1),l=o.getEndOffset(r-1)):l===s&&r<o.getCount()-1&&(a=o.getStartOffset(r+1),l=o.getEndOffset(r+1))),new _.Q(i,a+1,i,l+1)}}var P,T=i(77136),O=i(39587),A=i(42502),E=i(39263),H=i(39895),F=i(68010),W=i(19700),V=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},U=function(e,t){return function(i,n){t(i,n,e)}},z=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};class B{constructor(){this._entries=new h.qK(50)}get(e){const t=B._key(e);return this._entries.get(t)}set(e,t){const i=B._key(e);this._entries.set(i,t)}static _key(e){return"".concat(e.uri.toString(),"/").concat(e.getVersionId())}}const j=(0,E.u1)("IInlayHintsCache");(0,A.v)(j,B,1);class K{constructor(e,t){this.item=e,this.index=t}get part(){const e=this.item.hint.label;return"string"===typeof e?{label:e}:e[this.index]}}class Q{constructor(e,t){this.part=e,this.hasTriggerModifier=t}}let q=P=class{static get(e){var t;return null!==(t=e.getContribution(P.ID))&&void 0!==t?t:void 0}constructor(e,t,i,n,o,s,r){this._editor=e,this._languageFeaturesService=t,this._inlayHintsCache=n,this._commandService=o,this._notificationService=s,this._instaService=r,this._disposables=new d.Cm,this._sessionDisposables=new d.Cm,this._decorationsMetadata=new Map,this._ruleFactory=new p.Qn(this._editor),this._activeRenderMode=0,this._debounceInfo=i.for(t.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(t.inlayHintsProvider.onDidChange((()=>this._update()))),this._disposables.add(e.onDidChangeModel((()=>this._update()))),this._disposables.add(e.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(e.onDidChangeConfiguration((e=>{e.hasChanged(139)&&this._update()}))),this._update()}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){this._sessionDisposables.clear(),this._removeAllDecorations();const e=this._editor.getOption(139);if("off"===e.enabled)return;const t=this._editor.getModel();if(!t||!this._languageFeaturesService.inlayHintsProvider.has(t))return;const i=this._inlayHintsCache.get(t);let n;i&&this._updateHintsDecorators([t.getFullModelRange()],i),this._sessionDisposables.add((0,d.s)((()=>{t.isDisposed()||this._cacheHintsForFastRestore(t)})));const o=new Set,r=new a.uC((()=>z(this,void 0,void 0,(function*(){const e=Date.now();null===n||void 0===n||n.dispose(!0),n=new l.Q;const i=t.onWillDispose((()=>null===n||void 0===n?void 0:n.cancel()));try{const i=n.token,s=yield M.create(this._languageFeaturesService.inlayHintsProvider,t,this._getHintsRanges(),i);if(r.delay=this._debounceInfo.update(t,Date.now()-e),i.isCancellationRequested)return void s.dispose();for(const e of s.provider)"function"!==typeof e.onDidChangeInlayHints||o.has(e)||(o.add(e),this._sessionDisposables.add(e.onDidChangeInlayHints((()=>{r.isScheduled()||r.schedule()}))));this._sessionDisposables.add(s),this._updateHintsDecorators(s.ranges,s.items),this._cacheHintsForFastRestore(t)}catch(s){(0,c.dz)(s)}finally{n.dispose(),i.dispose()}}))),this._debounceInfo.get(t));if(this._sessionDisposables.add(r),this._sessionDisposables.add((0,d.s)((()=>null===n||void 0===n?void 0:n.dispose(!0)))),r.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange((e=>{!e.scrollTopChanged&&r.isScheduled()||r.schedule()}))),this._sessionDisposables.add(this._editor.onDidChangeModelContent((e=>{const t=Math.max(r.delay,1250);r.schedule(t)}))),"on"===e.enabled)this._activeRenderMode=0;else{let t,i;"onUnlessPressed"===e.enabled?(t=0,i=1):(t=1,i=0),this._activeRenderMode=t,this._sessionDisposables.add(s.Di.getInstance().event((e=>{if(!this._editor.hasModel())return;const n=e.altKey&&e.ctrlKey&&!e.shiftKey&&!e.metaKey?i:t;if(n!==this._activeRenderMode){this._activeRenderMode=n;const e=this._editor.getModel(),t=this._copyInlayHintsWithCurrentAnchor(e);this._updateHintsDecorators([e.getFullModelRange()],t),r.schedule(0)}})))}this._sessionDisposables.add(this._installDblClickGesture((()=>r.schedule(0)))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){const e=new d.Cm,t=e.add(new x.gi(this._editor)),i=new d.Cm;return e.add(i),e.add(t.onMouseMoveOrRelevantKeyDown((e=>{const[t]=e,n=this._getInlayHintLabelPart(t),o=this._editor.getModel();if(!n||!o)return void i.clear();const s=new l.Q;i.add((0,d.s)((()=>s.dispose(!0)))),n.item.resolve(s.token),this._activeInlayHintPart=n.part.command||n.part.location?new Q(n,t.hasTriggerModifier):void 0;const r=o.validatePosition(n.item.hint.position).lineNumber,a=new _.Q(r,1,r,o.getLineMaxColumn(r)),c=this._getInlineHintsForRange(a);this._updateHintsDecorators([a],c),i.add((0,d.s)((()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([a],c)})))}))),e.add(t.onCancel((()=>i.clear()))),e.add(t.onExecute((e=>z(this,void 0,void 0,(function*(){const t=this._getInlayHintLabelPart(e);if(t){const i=t.part;i.location?this._instaService.invokeFunction(T.U,e,this._editor,i.location):b.uB.is(i.command)&&(yield this._invokeCommand(i.command,t.item))}}))))),e}_getInlineHintsForRange(e){const t=new Set;for(const i of this._decorationsMetadata.values())e.containsRange(i.item.anchor.range)&&t.add(i.item);return Array.from(t)}_installDblClickGesture(e){return this._editor.onMouseUp((t=>z(this,void 0,void 0,(function*(){if(2!==t.event.detail)return;const i=this._getInlayHintLabelPart(t);if(i&&(t.event.preventDefault(),yield i.item.resolve(l.X.None),(0,r.EI)(i.item.hint.textEdits))){const t=i.item.hint.textEdits.map((e=>f.k.replace(_.Q.lift(e.range),e.text)));this._editor.executeEdits("inlayHint.default",t),e()}}))))}_installContextMenu(){return this._editor.onContextMenu((e=>z(this,void 0,void 0,(function*(){if(!(e.event.target instanceof HTMLElement))return;const t=this._getInlayHintLabelPart(e);t&&(yield this._instaService.invokeFunction(T.h,this._editor,e.event.target,t))}))))}_getInlayHintLabelPart(e){var t;if(6!==e.target.type)return;const i=null===(t=e.target.detail.injectedText)||void 0===t?void 0:t.options;return i instanceof w.Ho&&(null===i||void 0===i?void 0:i.attachedData)instanceof K?i.attachedData:void 0}_invokeCommand(e,t){var i;return z(this,void 0,void 0,(function*(){try{yield this._commandService.executeCommand(e.id,...null!==(i=e.arguments)&&void 0!==i?i:[])}catch(n){this._notificationService.notify({severity:H.AI.Error,source:t.provider.displayName,message:n})}}))}_cacheHintsForFastRestore(e){const t=this._copyInlayHintsWithCurrentAnchor(e);this._inlayHintsCache.set(e,t)}_copyInlayHintsWithCurrentAnchor(e){const t=new Map;for(const[i,n]of this._decorationsMetadata){if(t.has(n.item))continue;const o=e.getDecorationRange(i);if(o){const e=new N(o,n.item.anchor.direction),i=n.item.with({anchor:e});t.set(n.item,i)}}return Array.from(t.values())}_getHintsRanges(){const e=this._editor.getModel(),t=this._editor.getVisibleRangesPlusViewportAboveBelow(),i=[];for(const n of t.sort(_.Q.compareRangesUsingStarts)){const t=e.validateRange(new _.Q(n.startLineNumber-30,n.startColumn,n.endLineNumber+30,n.endColumn));0!==i.length&&_.Q.areIntersectingOrTouching(i[i.length-1],t)?i[i.length-1]=_.Q.plusRange(i[i.length-1],t):i.push(t)}return i}_updateHintsDecorators(e,t){var i,n;const o=[],s=(e,t,i,n,s)=>{const r={content:i,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:t.className,cursorStops:n,attachedData:s};o.push({item:e,classNameRef:t,decoration:{range:e.anchor.range,options:{description:"InlayHint",showIfCollapsed:e.anchor.range.isEmpty(),collapseOnReplaceEdit:!e.anchor.range.isEmpty(),stickiness:0,[e.anchor.direction]:0===this._activeRenderMode?r:void 0}}})},a=(e,t)=>{const i=this._ruleFactory.createClassNameRef({width:"".concat(l/3|0,"px"),display:"inline-block"});s(e,i,"\u200a",t?C.VW.Right:C.VW.None)},{fontSize:l,fontFamily:c,padding:d,isUniform:h}=this._getLayoutInfo(),u="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(u,c);for(const m of t){m.hint.paddingLeft&&a(m,!1);const e="string"===typeof m.hint.label?[{label:m.hint.label}]:m.hint.label;for(let t=0;t<e.length;t++){const n=e[t],o=0===t,a=t===e.length-1,c={fontSize:"".concat(l,"px"),fontFamily:"var(".concat(u,"), ").concat(v.jU.fontFamily),verticalAlign:h?"baseline":"middle",unicodeBidi:"isolate"};(0,r.EI)(m.hint.textEdits)&&(c.cursor="default"),this._fillInColors(c,m.hint),(n.command||n.location)&&(null===(i=this._activeInlayHintPart)||void 0===i?void 0:i.part.item)===m&&this._activeInlayHintPart.part.index===t&&(c.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(c.color=(0,W.Yf)(F.Ztu),c.cursor="pointer")),d&&(o&&a?(c.padding="1px ".concat(0|Math.max(1,l/4),"px"),c.borderRadius="".concat(l/4|0,"px")):o?(c.padding="1px 0 1px ".concat(0|Math.max(1,l/4),"px"),c.borderRadius="".concat(l/4|0,"px 0 0 ").concat(l/4|0,"px")):a?(c.padding="1px ".concat(0|Math.max(1,l/4),"px 1px 0"),c.borderRadius="0 ".concat(l/4|0,"px ").concat(l/4|0,"px 0")):c.padding="1px 0 1px 0"),s(m,this._ruleFactory.createClassNameRef(c),G(n.label),a&&!m.hint.paddingRight?C.VW.Right:C.VW.None,new K(m,t))}if(m.hint.paddingRight&&a(m,!0),o.length>P._MAX_DECORATORS)break}const g=[];for(const r of e)for(const{id:e}of null!==(n=this._editor.getDecorationsInRange(r))&&void 0!==n?n:[]){const t=this._decorationsMetadata.get(e);t&&(g.push(e),t.classNameRef.dispose(),this._decorationsMetadata.delete(e))}const p=m.D.capture(this._editor);this._editor.changeDecorations((e=>{const t=e.deltaDecorations(g,o.map((e=>e.decoration)));for(let i=0;i<t.length;i++){const e=o[i];this._decorationsMetadata.set(t[i],e)}})),p.restore(this._editor)}_fillInColors(e,t){t.kind===b.r4.Parameter?(e.backgroundColor=(0,W.Yf)(F.B2L),e.color=(0,W.Yf)(F.sjA)):t.kind===b.r4.Type?(e.backgroundColor=(0,W.Yf)(F._pU),e.color=(0,W.Yf)(F.HwT)):(e.backgroundColor=(0,W.Yf)(F.WL6),e.color=(0,W.Yf)(F.P6i))}_getLayoutInfo(){const e=this._editor.getOption(139),t=e.padding,i=this._editor.getOption(52),n=this._editor.getOption(49);let o=e.fontSize;(!o||o<5||o>i)&&(o=i);const s=e.fontFamily||n;return{fontSize:o,fontFamily:s,padding:t,isUniform:!t&&s===n&&o===i}}_removeAllDecorations(){this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));for(const e of this._decorationsMetadata.values())e.classNameRef.dispose();this._decorationsMetadata.clear()}};function G(e){return e.replace(/[ \t]/g,"\xa0")}q.ID="editor.contrib.InlayHints",q._MAX_DECORATORS=1500,q=P=V([U(1,S.u),U(2,y.U),U(3,j),U(4,O.d),U(5,H.Ot),U(6,E._Y)],q),O.w.registerCommand("_executeInlayHintProvider",(function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return z(void 0,void 0,void 0,(function*(){const[t,n]=i;(0,u.j)(g.r.isUri(t)),(0,u.j)(_.Q.isIRange(n));const{inlayHintsProvider:o}=e.get(S.u),s=yield e.get(L.b).createModelReference(t);try{const e=yield M.create(o,s.object.textEditorModel,[_.Q.lift(n)],l.X.None),t=e.items.map((e=>e.hint));return setTimeout((()=>e.dispose()),0),t}finally{s.dispose()}}))}));var Y=i(58348),Z=i(63970),$=i(53998),X=i(69406),J=i(66457),ee=i(2531),te=i(51413),ie=i(66731),ne=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},oe=function(e,t){return function(i,n){t(i,n,e)}},se=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))},re=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"===typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,o){(function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)})(n,o,(t=e[i](t)).done,t.value)}))}}};class ae extends o.mm{constructor(e,t,i,n){super(10,t,e.item.anchor.range,i,n,!0),this.part=e}}let le=class extends X.xJ{constructor(e,t,i,n,o,s){super(e,t,i,n,s),this._resolverService=o,this.hoverOrdinal=6}suggestHoverAnchor(e){var t;if(!q.get(this._editor))return null;if(6!==e.target.type)return null;const i=null===(t=e.target.detail.injectedText)||void 0===t?void 0:t.options;return i instanceof w.Ho&&i.attachedData instanceof K?new ae(i.attachedData,this,e.event.posx,e.event.posy):null}computeSync(){return[]}computeAsync(e,t,i){return e instanceof ae?new a.AE((t=>se(this,void 0,void 0,(function*(){var n,o,s,a;const{part:l}=e;if(yield l.item.resolve(i),i.isCancellationRequested)return;let c,d;if("string"===typeof l.item.hint.tooltip?c=(new Y.Bc).appendText(l.item.hint.tooltip):l.item.hint.tooltip&&(c=l.item.hint.tooltip),c&&t.emitOne(new X.eH(this,e.range,[c],!1,0)),(0,r.EI)(l.item.hint.textEdits)&&t.emitOne(new X.eH(this,e.range,[(new Y.Bc).appendText((0,te.kg)("hint.dbl","Double-click to insert"))],!1,10001)),"string"===typeof l.part.tooltip?d=(new Y.Bc).appendText(l.part.tooltip):l.part.tooltip&&(d=l.part.tooltip),d&&t.emitOne(new X.eH(this,e.range,[d],!1,1)),l.part.location||l.part.command){let i;const n="altKey"===this._editor.getOption(77)?ie.zx?(0,te.kg)("links.navigate.kb.meta.mac","cmd + click"):(0,te.kg)("links.navigate.kb.meta","ctrl + click"):ie.zx?(0,te.kg)("links.navigate.kb.alt.mac","option + click"):(0,te.kg)("links.navigate.kb.alt","alt + click");l.part.location&&l.part.command?i=(new Y.Bc).appendText((0,te.kg)("hint.defAndCommand","Go to Definition ({0}), right click for more",n)):l.part.location?i=(new Y.Bc).appendText((0,te.kg)("hint.def","Go to Definition ({0})",n)):l.part.command&&(i=new Y.Bc("[".concat((0,te.kg)("hint.cmd","Execute Command"),"](").concat((h=l.part.command,g.r.from({scheme:I.ny.command,path:h.id,query:h.arguments&&encodeURIComponent(JSON.stringify(h.arguments))}).toString()),' "').concat(l.part.command.title,'") (').concat(n,")"),{isTrusted:!0})),i&&t.emitOne(new X.eH(this,e.range,[i],!1,1e4))}var h;const u=yield this._resolveInlayHintLabelPartHover(l,i);try{for(var p,m=!0,v=re(u);!(n=(p=yield v.next()).done);m=!0){a=p.value,m=!1;const e=a;t.emitOne(e)}}catch(f){o={error:f}}finally{try{m||n||!(s=v.return)||(yield s.call(v))}finally{if(o)throw o.error}}})))):a.AE.EMPTY}_resolveInlayHintLabelPartHover(e,t){return se(this,void 0,void 0,(function*(){if(!e.part.location)return a.AE.EMPTY;const{uri:i,range:n}=e.part.location,o=yield this._resolverService.createModelReference(i);try{const i=o.object.textEditorModel;return this._languageFeaturesService.hoverProvider.has(i)?(0,$.Zt)(this._languageFeaturesService.hoverProvider,i,new k.y(n.startLineNumber,n.startColumn),t).filter((e=>!(0,Y.it)(e.hover.contents))).map((t=>new X.eH(this,e.item.anchor.range,t.hover.contents,!1,2+t.ordinal))):a.AE.EMPTY}finally{o.dispose()}}))}};le=ne([oe(1,Z.L),oe(2,ee.Cr),oe(3,J.pG),oe(4,L.b),oe(5,S.u)],le),(0,n.HW)(q.ID,q,1),o.B2.register(le)},77136:(e,t,i)=>{i.d(t,{U:()=>b,h:()=>_});var n=i(32605),o=i(63169),s=i(25143),r=i(43783),a=i(99005),l=i(58066),c=i(29911),d=i(78472),h=i(35155),u=i(39587),g=i(39686),p=i(6748),m=i(39263),v=i(39895),f=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};function _(e,t,i,d){var g;return f(this,void 0,void 0,(function*(){const _=e.get(l.b),b=e.get(p.Z),C=e.get(u.d),w=e.get(m._Y),y=e.get(v.Ot);if(yield d.item.resolve(s.X.None),!d.part.location)return;const S=d.part.location,L=[],x=new Set(h.ZG.getMenuItems(h.D8.EditorContext).map((e=>(0,h.is)(e)?e.command.id:(0,r.b)())));for(const e of c.bn.all())x.has(e.desc.id)&&L.push(new o.rc(e.desc.id,h.Xe.label(e.desc,{renderShortTitle:!0}),void 0,!0,(()=>f(this,void 0,void 0,(function*(){const i=yield _.createModelReference(S.uri);try{const n=new c.QS(i.object.textEditorModel,a.Q.getStartPosition(S.range)),o=d.item.anchor.range;yield w.invokeFunction(e.runEditorCommand.bind(e),t,n,o)}finally{i.dispose()}})))));if(d.part.command){const{command:e}=d.part;L.push(new o.wv),L.push(new o.rc(e.id,e.title,void 0,!0,(()=>f(this,void 0,void 0,(function*(){var t;try{yield C.executeCommand(e.id,...null!==(t=e.arguments)&&void 0!==t?t:[])}catch(i){y.notify({severity:v.AI.Error,source:d.item.provider.displayName,message:i})}})))))}const k=t.getOption(126);b.showContextMenu({domForShadowRoot:k&&null!==(g=t.getDomNode())&&void 0!==g?g:void 0,getAnchor:()=>{const e=n.BK(i);return{x:e.left,y:e.top+e.height+8}},getActions:()=>L,onHide:()=>{t.focus()},autoSelectFirstItem:!0})}))}function b(e,t,i,n){return f(this,void 0,void 0,(function*(){const o=e.get(l.b),s=yield o.createModelReference(n.uri);yield i.invokeWithinContext((e=>f(this,void 0,void 0,(function*(){const o=t.hasSideBySideModifier,r=e.get(g.fN),l=d.x2.inPeekEditor.getValue(r),h=!o&&i.getOption(87)&&!l;return new c.mR({openToSide:o,openInPeek:h,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(e,new c.QS(s.object.textEditorModel,a.Q.getStartPosition(n.range)),a.Q.lift(n.range))})))),s.dispose()}))}},79267:(e,t,i)=>{i.d(t,{PA:()=>s,Vl:()=>o,Wt:()=>n});const n="editor.action.inlineSuggest.commit",o="editor.action.inlineSuggest.showPrevious",s="editor.action.inlineSuggest.showNext"},63606:(e,t,i)=>{i.d(t,{p:()=>c});var n=i(96664),o=i(12780),s=i(47221),r=i(39686),a=i(87766),l=i(51413);class c extends a.jG{constructor(e,t){super(),this.contextKeyService=e,this.model=t,this.inlineCompletionVisible=c.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=c.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=c.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService),this.suppressSuggestions=c.suppressSuggestions.bindTo(this.contextKeyService),this._register((0,n.fm)((e=>{const t=this.model.read(e),i=null===t||void 0===t?void 0:t.state.read(e),n=!!(null===i||void 0===i?void 0:i.inlineCompletion)&&void 0!==(null===i||void 0===i?void 0:i.ghostText)&&!(null===i||void 0===i?void 0:i.ghostText.isEmpty());this.inlineCompletionVisible.set(n),(null===i||void 0===i?void 0:i.ghostText)&&(null===i||void 0===i?void 0:i.inlineCompletion)&&this.suppressSuggestions.set(i.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions)}))),this._register((0,n.fm)((e=>{const t=this.model.read(e);let i=!1,n=!0;const r=null===t||void 0===t?void 0:t.ghostText.read(e);if((null===t||void 0===t?void 0:t.selectedSuggestItem)&&r&&r.parts.length>0){const{column:e,lines:a}=r.parts[0],l=a[0];if(e<=t.textModel.getLineIndentColumn(r.lineNumber)){let e=(0,o.HG)(l);-1===e&&(e=l.length-1),i=e>0;const r=t.textModel.getOptions().tabSize;n=s.A.visibleColumnFromColumn(l,e+1,r)<r}}this.inlineCompletionSuggestsIndentation.set(i),this.inlineCompletionSuggestsIndentationLessThanTabSize.set(n)})))}}c.inlineSuggestionVisible=new r.N1("inlineSuggestionVisible",!1,(0,l.kg)("inlineSuggestionVisible","Whether an inline suggestion is visible")),c.inlineSuggestionHasIndentation=new r.N1("inlineSuggestionHasIndentation",!1,(0,l.kg)("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace")),c.inlineSuggestionHasIndentationLessThanTabSize=new r.N1("inlineSuggestionHasIndentationLessThanTabSize",!0,(0,l.kg)("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab")),c.suppressSuggestions=new r.N1("inlineSuggestionSuppressSuggestions",void 0,(0,l.kg)("suppressSuggestions","Whether suggestions should be suppressed for the current suggestion"))},53199:(e,t,i)=>{var n=i(30050),o=i(85287),s=i(96664),r=i(72330),a=i(79267),l=i(63606),c=i(82224),d=i(48250),h=i(87766),u=i(49300),g=i(23525),p=i(50044),m=i(63910),v=i(28925),f=i(12780),_=i(30381),b=i(81196),C=i(99005),w=i(16724),y=i(63970),S=i(32743),L=i(73957),x=i(23033),k=i(98105),I=i(29591);class D{constructor(e){this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)"\n"===e.charAt(t)&&this.lineStartOffsetByLineIdx.push(t+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}}const N=[];class R{constructor(e,t){if(this.startColumn=e,this.endColumnExclusive=t,e>t)throw new I.D7("startColumn ".concat(e," cannot be after endColumnExclusive ").concat(t))}toRange(e){return new C.Q(e,this.startColumn,e,this.endColumnExclusive)}equals(e){return this.startColumn===e.startColumn&&this.endColumnExclusive===e.endColumnExclusive}}function M(e,t){return new g.y(e.lineNumber+t.lineNumber-1,1===t.lineNumber?e.column+t.column-1:t.column)}function P(e){let t=1,i=1;for(const n of e)"\n"===n?(t++,i=1):i++;return new g.y(t,i)}class T{constructor(e,t){this.lineNumber=e,this.parts=t}equals(e){return this.lineNumber===e.lineNumber&&this.parts.length===e.parts.length&&this.parts.every(((t,i)=>t.equals(e.parts[i])))}renderForScreenReader(e){if(0===this.parts.length)return"";const t=this.parts[this.parts.length-1];return function(e,t){const i=new D(e),n=t.map((e=>{const t=C.Q.lift(e.range);return{startOffset:i.getOffset(t.getStartPosition()),endOffset:i.getOffset(t.getEndPosition()),text:e.text}}));n.sort(((e,t)=>t.startOffset-e.startOffset));for(const o of n)e=e.substring(0,o.startOffset)+o.text+e.substring(o.endOffset);return e}(e.substr(0,t.column-1),this.parts.map((e=>({range:{startLineNumber:1,endLineNumber:1,startColumn:e.column,endColumn:e.column},text:e.lines.join("\n")})))).substring(this.parts[0].column-1)}isEmpty(){return this.parts.every((e=>0===e.lines.length))}get lineCount(){return 1+this.parts.reduce(((e,t)=>e+t.lines.length-1),0)}}class O{constructor(e,t,i){this.column=e,this.lines=t,this.preview=i}equals(e){return this.column===e.column&&this.lines.length===e.lines.length&&this.lines.every(((t,i)=>t===e.lines[i]))}}class A{constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.lineNumber=e,this.columnRange=t,this.newLines=i,this.additionalReservedLineCount=n,this.parts=[new O(this.columnRange.endColumnExclusive,this.newLines,!1)]}renderForScreenReader(e){return this.newLines.join("\n")}get lineCount(){return this.newLines.length}isEmpty(){return this.parts.every((e=>0===e.lines.length))}equals(e){return this.lineNumber===e.lineNumber&&this.columnRange.equals(e.columnRange)&&this.newLines.length===e.newLines.length&&this.newLines.every(((t,i)=>t===e.newLines[i]))&&this.additionalReservedLineCount===e.additionalReservedLineCount}}function E(e,t){return e===t||!(!e||!t)&&((e instanceof T&&t instanceof T||e instanceof A&&t instanceof A)&&e.equals(t))}var H=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},F=function(e,t){return function(i,n){t(i,n,e)}};const W="ghost-text";let V=class extends h.jG{constructor(e,t,i){super(),this.editor=e,this.model=t,this.languageService=i,this.isDisposed=(0,s.FY)(this,!1),this.currentTextModel=(0,s.y0)(this.editor.onDidChangeModel,(()=>this.editor.getModel())),this.uiState=(0,s.un)(this,(e=>{if(this.isDisposed.read(e))return;const t=this.currentTextModel.read(e);if(t!==this.model.targetTextModel.read(e))return;const i=this.model.ghostText.read(e);if(!i)return;const n=i instanceof A?i.columnRange:void 0,o=[],s=[];function r(e,t){if(s.length>0){const i=s[s.length-1];t&&i.decorations.push(new x.d(i.content.length+1,i.content.length+1+e[0].length,t,0)),i.content+=e[0],e=e.slice(1)}for(const i of e)s.push({content:i,decorations:t?[new x.d(1,i.length+1,t,0)]:[]})}const a=t.getLineContent(i.lineNumber);let l,c=0;for(const h of i.parts){let e=h.lines;void 0===l?(o.push({column:h.column,text:e[0],preview:h.preview}),e=e.slice(1)):r([a.substring(c,h.column-1)],void 0),e.length>0&&(r(e,W),void 0===l&&h.column<=a.length&&(l=h.column)),c=h.column-1}void 0!==l&&r([a.substring(c)],void 0);const d=void 0!==l?new R(l,a.length+1):void 0;return{replacedRange:n,inlineTexts:o,additionalLines:s,hiddenRange:d,lineNumber:i.lineNumber,additionalReservedLineCount:this.model.minReservedLineCount.read(e),targetTextModel:t}})),this.decorations=(0,s.un)(this,(e=>{const t=this.uiState.read(e);if(!t)return[];const i=[];t.replacedRange&&i.push({range:t.replacedRange.toRange(t.lineNumber),options:{inlineClassName:"inline-completion-text-to-replace",description:"GhostTextReplacement"}}),t.hiddenRange&&i.push({range:t.hiddenRange.toRange(t.lineNumber),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}});for(const n of t.inlineTexts)i.push({range:C.Q.fromPositions(new g.y(t.lineNumber,n.column)),options:{description:W,after:{content:n.text,inlineClassName:n.preview?"ghost-text-decoration-preview":"ghost-text-decoration",cursorStops:S.VW.Left},showIfCollapsed:!0}});return i})),this.additionalLinesWidget=this._register(new U(this.editor,this.languageService.languageIdCodec,(0,s.un)((e=>{const t=this.uiState.read(e);return t?{lineNumber:t.lineNumber,additionalLines:t.additionalLines,minReservedLineCount:t.additionalReservedLineCount,targetTextModel:t.targetTextModel}:void 0})))),this._register((0,h.s)((()=>{this.isDisposed.set(!0,void 0)}))),this._register(function(e,t){const i=new h.Cm,n=e.createDecorationsCollection();return i.add((0,s.zL)({debugName:()=>"Apply decorations from ".concat(t.debugName)},(e=>{const i=t.read(e);n.set(i)}))),i.add({dispose:()=>{n.clear()}}),i}(this.editor,this.decorations))}ownsViewZone(e){return this.additionalLinesWidget.viewZoneId===e}};V=H([F(2,y.L)],V);class U extends h.jG{get viewZoneId(){return this._viewZoneId}constructor(e,t,i){super(),this.editor=e,this.languageIdCodec=t,this.lines=i,this._viewZoneId=void 0,this.editorOptionsChanged=(0,s.yQ)("editorOptionChanged",d.Jh.filter(this.editor.onDidChangeConfiguration,(e=>e.hasChanged(33)||e.hasChanged(116)||e.hasChanged(98)||e.hasChanged(93)||e.hasChanged(51)||e.hasChanged(50)||e.hasChanged(66)))),this._register((0,s.fm)((e=>{const t=this.lines.read(e);this.editorOptionsChanged.read(e),t?this.updateLines(t.lineNumber,t.additionalLines,t.minReservedLineCount):this.clear()})))}dispose(){super.dispose(),this.clear()}clear(){this.editor.changeViewZones((e=>{this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0)}))}updateLines(e,t,i){const n=this.editor.getModel();if(!n)return;const{tabSize:o}=n.getOptions();this.editor.changeViewZones((n=>{this._viewZoneId&&(n.removeZone(this._viewZoneId),this._viewZoneId=void 0);const s=Math.max(t.length,i);if(s>0){const i=document.createElement("div");!function(e,t,i,n,o){const s=n.get(33),r=n.get(116),a="none",l=n.get(93),c=n.get(51),d=n.get(50),h=n.get(66),u=new w.fe(1e4);u.appendString('<div class="suggest-preview-text">');for(let m=0,v=i.length;m<v;m++){const e=i[m],n=e.content;u.appendString('<div class="view-line'),u.appendString('" style="top:'),u.appendString(String(m*h)),u.appendString('px;width:1000000px;">');const g=f.aC(n),p=f.E_(n),v=L.f.createEmpty(n,o);(0,k.UW)(new k.zL(d.isMonospace&&!s,d.canUseHalfwidthRightwardsArrow,n,!1,g,p,0,v,e.decorations,t,0,d.spaceWidth,d.middotWidth,d.wsmiddotWidth,r,a,l,c!==b.Bc.OFF,null),u),u.appendString("</div>")}u.appendString("</div>"),(0,_.M)(e,d);const g=u.build(),p=z?z.createHTML(g):g;e.innerHTML=p}(i,o,t,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=n.addZone({afterLineNumber:e,heightInLines:s,domNode:i,afterColumnAffinity:1})}}))}}const z=(0,v.H)("editorGhostText",{createHTML:e=>e});var B=i(17907),j=i(21457),K=i(32031),Q=i(94597),q=i(91861),G=i(80158),Y=i(25143),Z=i(86373),$=i(28070),X=i(73990),J=i(67512),ee=i(69799),te=i(57855),ie=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};function ne(e,t,i,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Y.X.None,s=arguments.length>5?arguments[5]:void 0;return ie(this,void 0,void 0,(function*(){const r=function(e,t){const i=t.getWordAtPosition(e),n=t.getLineMaxColumn(e.lineNumber);return i?new C.Q(e.lineNumber,i.startColumn,e.lineNumber,n):C.Q.fromPositions(e,e.with(void 0,n))}(t,i),a=e.all(i),l=new J.db;for(const e of a)e.groupId&&l.add(e.groupId,e);function c(e){if(!e.yieldsToGroupIds)return[];const t=[];for(const i of e.yieldsToGroupIds||[]){const e=l.get(i);for(const i of e)t.push(i)}return t}const d=new Map,h=new Set;function u(e,t){if(t=[...t,e],h.has(e))return t;h.add(e);try{const i=c(e);for(const e of i){const i=u(e,t);if(i)return i}}finally{h.delete(e)}}function g(e){const s=d.get(e);if(s)return s;const r=u(e,[]);r&&(0,I.M_)(new Error("Inline completions: cyclic yield-to dependency detected. Path: ".concat(r.map((e=>e.toString?e.toString():""+e)).join(" -> "))));const a=new X.Zv;return d.set(e,a.p),(()=>ie(this,void 0,void 0,(function*(){if(!r){const t=c(e);for(const e of t){const t=yield g(e);if(t&&t.items.length>0)return}}try{return yield e.provideInlineCompletions(i,t,n,o)}catch(s){return void(0,I.M_)(s)}})))().then((e=>a.complete(e)),(e=>a.error(e))),a.p}const p=yield Promise.all(a.map((e=>ie(this,void 0,void 0,(function*(){return{provider:e,completions:yield g(e)}}))))),m=new Map,v=[];for(const e of p){const t=e.completions;if(!t)continue;const n=new se(t,e.provider);v.push(n);for(const e of t.items){const t=re.from(e,n,r,i,s);m.set(t.hash(),t)}}return new oe(Array.from(m.values()),new Set(m.keys()),v)}))}class oe{constructor(e,t,i){this.completions=e,this.hashs=t,this.providerResults=i}has(e){return this.hashs.has(e.hash())}dispose(){for(const e of this.providerResults)e.removeRef()}}class se{constructor(e,t){this.inlineCompletions=e,this.provider=t,this.refCount=1}addRef(){this.refCount++}removeRef(){this.refCount--,0===this.refCount&&this.provider.freeInlineCompletions(this.inlineCompletions)}}class re{static from(e,t,i,n,o){let s,r,a=e.range?C.Q.lift(e.range):i;if("string"===typeof e.insertText){if(s=e.insertText,o&&e.completeBracketPairs){s=ae(s,a.getStartPosition(),n,o);const t=s.length-e.insertText.length;0!==t&&(a=new C.Q(a.startLineNumber,a.startColumn,a.endLineNumber,a.endColumn+t))}r=void 0}else if("snippet"in e.insertText){const t=e.insertText.snippet.length;if(o&&e.completeBracketPairs){e.insertText.snippet=ae(e.insertText.snippet,a.getStartPosition(),n,o);const i=e.insertText.snippet.length-t;0!==i&&(a=new C.Q(a.startLineNumber,a.startColumn,a.endLineNumber,a.endColumn+i))}const i=(new te.fr).parse(e.insertText.snippet);1===i.children.length&&i.children[0]instanceof te.EY?(s=i.children[0].value,r=void 0):(s=i.toString(),r={snippet:e.insertText.snippet,range:a})}else(0,$.xb)(e.insertText);return new re(s,e.command,a,s,r,e.additionalTextEdits||N,e,t)}constructor(e,t,i,n,o,s,r,a){this.filterText=e,this.command=t,this.range=i,this.insertText=n,this.snippetInfo=o,this.additionalTextEdits=s,this.sourceInlineCompletion=r,this.source=a,n=(e=e.replace(/\r\n|\r/g,"\n")).replace(/\r\n|\r/g,"\n")}withRange(e){return new re(this.filterText,this.command,e,this.insertText,this.snippetInfo,this.additionalTextEdits,this.sourceInlineCompletion,this.source)}hash(){return JSON.stringify({insertText:this.insertText,range:this.range.toString()})}}function ae(e,t,i,n){const o=i.getLineContent(t.lineNumber).substring(0,t.column-1)+e,s=i.tokenization.tokenizeLineWithEdit(t,o.length-(t.column-1),e),r=null===s||void 0===s?void 0:s.sliceAndInflate(t.column-1,o.length,0);if(!r)return e;return(0,ee.I)(r,n)}var le=i(97853);class ce{constructor(e,t){this.range=e,this.text=t}removeCommonPrefix(e,t){const i=t?this.range.intersectRanges(t):this.range;if(!i)return this;const n=e.getValueInRange(i,1),o=(0,f.Qp)(n,this.text),s=M(this.range.getStartPosition(),P(n.substring(0,o))),r=this.text.substring(o),a=C.Q.fromPositions(s,this.range.getEndPosition());return new ce(a,r)}augments(e){return this.text.startsWith(e.text)&&(t=this.range,(i=e.range).getStartPosition().equals(t.getStartPosition())&&i.getEndPosition().isBeforeOrEqual(t.getEndPosition()));var t,i}computeGhostText(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=this.removeCommonPrefix(e);if(o.range.endLineNumber!==o.range.startLineNumber)return;const s=e.getLineContent(o.range.startLineNumber),r=(0,f.UU)(s).length;if(o.range.startColumn-1<=r){const e=(0,f.UU)(o.text).length,t=s.substring(o.range.startColumn-1,r),[i,n]=[o.range.getStartPosition(),o.range.getEndPosition()],a=i.column+t.length<=n.column?i.delta(0,t.length):n,l=C.Q.fromPositions(a,n),c=o.text.startsWith(t)?o.text.substring(t.length):o.text.substring(e);o=new ce(l,c)}const a=e.getValueInRange(o.range),l=function(e,t){if((null===de||void 0===de?void 0:de.originalValue)===e&&(null===de||void 0===de?void 0:de.newValue)===t)return null===de||void 0===de?void 0:de.changes;{let i=ue(e,t,!0);if(i){const n=he(i);if(n>0){const o=ue(e,t,!1);o&&he(o)<n&&(i=o)}}return de={originalValue:e,newValue:t,changes:i},i}}(a,o.text);if(!l)return;const c=o.range.startLineNumber,d=new Array;if("prefix"===t){const e=l.filter((e=>0===e.originalLength));if(e.length>1||1===e.length&&e[0].originalStart!==a.length)return}const h=o.text.length-n;for(const u of l){const e=o.range.startColumn+u.originalStart+u.originalLength;if("subwordSmart"===t&&i&&i.lineNumber===o.range.startLineNumber&&e<i.column)return;if(u.originalLength>0)return;if(0===u.modifiedLength)continue;const n=u.modifiedStart+u.modifiedLength,s=Math.max(u.modifiedStart,Math.min(n,h)),r=o.text.substring(u.modifiedStart,s),a=o.text.substring(s,Math.max(u.modifiedStart,n));if(r.length>0){const t=(0,f.uz)(r);d.push(new O(e,t,!1))}if(a.length>0){const t=(0,f.uz)(a);d.push(new O(e,t,!0))}}return new T(c,d)}}let de;function he(e){let t=0;for(const i of e)t+=i.originalLength;return t}function ue(e,t,i){if(e.length>5e3||t.length>5e3)return;function n(e){let t=0;for(let i=0,n=e.length;i<n;i++){const n=e.charCodeAt(i);n>t&&(t=n)}return t}const o=Math.max(n(e),n(t));function s(e){if(e<0)throw new Error("unexpected");return o+e+1}function r(e){let t=0,n=0;const o=new Int32Array(e.length);for(let r=0,a=e.length;r<a;r++)if(i&&"("===e[r]){const e=100*n+t;o[r]=s(2*e),t++}else if(i&&")"===e[r]){t=Math.max(t-1,0);const e=100*n+t;o[r]=s(2*e+1),0===t&&n++}else o[r]=e.charCodeAt(r);return o}const a=r(e),l=r(t);return new le.uP({getElements:()=>a},{getElements:()=>l}).ComputeDiff(!1).changes}var ge=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},pe=function(e,t){return function(i,n){t(i,n,e)}},me=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};let ve=class extends h.jG{constructor(e,t,i,n,o){super(),this.textModel=e,this.versionId=t,this._debounceValue=i,this.languageFeaturesService=n,this.languageConfigurationService=o,this._updateOperation=this._register(new h.HE),this.inlineCompletions=(0,s.X2)("inlineCompletions",void 0),this.suggestWidgetInlineCompletions=(0,s.X2)("suggestWidgetInlineCompletions",void 0),this._register(this.textModel.onDidChangeContent((()=>{this._updateOperation.clear()})))}fetch(e,t,i){var n,o;const r=new fe(e,t,this.textModel.getVersionId()),a=t.selectedSuggestionInfo?this.suggestWidgetInlineCompletions:this.inlineCompletions;if(null===(n=this._updateOperation.value)||void 0===n?void 0:n.request.satisfies(r))return this._updateOperation.value.promise;if(null===(o=a.get())||void 0===o?void 0:o.request.satisfies(r))return Promise.resolve(!0);const l=!!this._updateOperation.value;this._updateOperation.clear();const c=new Y.Q,d=(()=>me(this,void 0,void 0,(function*(){var n,o;if((l||t.triggerKind===q.qw.Automatic)&&(yield(n=this._debounceValue.get(this.textModel),new Promise((e=>{let t;const i=setTimeout((()=>{t&&t.dispose(),e()}),n);o&&(t=o.onCancellationRequested((()=>{clearTimeout(i),t&&t.dispose(),e()})))})))),c.token.isCancellationRequested||this.textModel.getVersionId()!==r.versionId)return!1;const d=new Date,h=yield ne(this.languageFeaturesService.inlineCompletionsProvider,e,this.textModel,t,c.token,this.languageConfigurationService);if(c.token.isCancellationRequested||this.textModel.getVersionId()!==r.versionId)return!1;const u=new Date;this._debounceValue.update(this.textModel,u.getTime()-d.getTime());const g=new be(h,r,this.textModel,this.versionId);if(i){const t=i.toInlineCompletion(void 0);i.canBeReused(this.textModel,e)&&!h.has(t)&&g.prepend(i.inlineCompletion,t.range,!0)}return this._updateOperation.clear(),(0,s.Rn)((e=>{a.set(g,e)})),!0})))(),h=new _e(r,c,d);return this._updateOperation.value=h,d}clear(e){this._updateOperation.clear(),this.inlineCompletions.set(void 0,e),this.suggestWidgetInlineCompletions.set(void 0,e)}clearSuggestWidgetInlineCompletions(e){var t;(null===(t=this._updateOperation.value)||void 0===t?void 0:t.request.context.selectedSuggestionInfo)&&this._updateOperation.clear(),this.suggestWidgetInlineCompletions.set(void 0,e)}cancelUpdate(){this._updateOperation.clear()}};ve=ge([pe(3,m.u),pe(4,G.JZ)],ve);class fe{constructor(e,t,i){this.position=e,this.context=t,this.versionId=i}satisfies(e){return this.position.equals(e.position)&&function(e,t,i){if(!e||!t)return e===t;return i(e,t)}(this.context.selectedSuggestionInfo,e.context.selectedSuggestionInfo,((e,t)=>e.equals(t)))&&(e.context.triggerKind===q.qw.Automatic||this.context.triggerKind===q.qw.Explicit)&&this.versionId===e.versionId}}class _e{constructor(e,t,i){this.request=e,this.cancellationTokenSource=t,this.promise=i}dispose(){this.cancellationTokenSource.cancel()}}class be{get inlineCompletions(){return this._inlineCompletions}constructor(e,t,i,n){this.inlineCompletionProviderResult=e,this.request=t,this.textModel=i,this.versionId=n,this._refCount=1,this._prependedInlineCompletionItems=[],this._rangeVersionIdValue=0,this._rangeVersionId=(0,s.un)(this,(e=>{this.versionId.read(e);let t=!1;for(const i of this._inlineCompletions)t=t||i._updateRange(this.textModel);return t&&this._rangeVersionIdValue++,this._rangeVersionIdValue}));const o=i.deltaDecorations([],e.completions.map((e=>({range:e.range,options:{description:"inline-completion-tracking-range"}}))));this._inlineCompletions=e.completions.map(((e,t)=>new Ce(e,o[t],this._rangeVersionId)))}clone(){return this._refCount++,this}dispose(){if(this._refCount--,0===this._refCount){setTimeout((()=>{this.textModel.isDisposed()||this.textModel.deltaDecorations(this._inlineCompletions.map((e=>e.decorationId)),[])}),0),this.inlineCompletionProviderResult.dispose();for(const e of this._prependedInlineCompletionItems)e.source.removeRef()}}prepend(e,t,i){i&&e.source.addRef();const n=this.textModel.deltaDecorations([],[{range:t,options:{description:"inline-completion-tracking-range"}}])[0];this._inlineCompletions.unshift(new Ce(e,n,this._rangeVersionId,t)),this._prependedInlineCompletionItems.push(e)}}class Ce{get forwardStable(){var e;return null!==(e=this.inlineCompletion.source.inlineCompletions.enableForwardStability)&&void 0!==e&&e}constructor(e,t,i,n){this.inlineCompletion=e,this.decorationId=t,this.rangeVersion=i,this.semanticId=JSON.stringify([this.inlineCompletion.filterText,this.inlineCompletion.insertText,this.inlineCompletion.range.getStartPosition().toString()]),this._isValid=!0,this._updatedRange=null!==n&&void 0!==n?n:e.range}toInlineCompletion(e){return this.inlineCompletion.withRange(this._getUpdatedRange(e))}toSingleTextEdit(e){return new ce(this._getUpdatedRange(e),this.inlineCompletion.insertText)}isVisible(e,t,i){const n=this._toFilterTextReplacement(i).removeCommonPrefix(e);if(!this._isValid||!this.inlineCompletion.range.getStartPosition().equals(this._getUpdatedRange(i).getStartPosition())||t.lineNumber!==n.range.startLineNumber)return!1;const o=e.getValueInRange(n.range,1).toLowerCase(),s=n.text.toLowerCase(),r=Math.max(0,t.column-n.range.startColumn);let a=s.substring(0,r),l=s.substring(r),c=o.substring(0,r),d=o.substring(r);const h=e.getLineIndentColumn(n.range.startLineNumber);return n.range.startColumn<=h&&(c=c.trimStart(),0===c.length&&(d=d.trimStart()),a=a.trimStart(),0===a.length&&(l=l.trimStart())),a.startsWith(c)&&!!(0,Z.dE)(d,l)}canBeReused(e,t){return this._isValid&&this._getUpdatedRange(void 0).containsPosition(t)&&this.isVisible(e,t,void 0)&&!this._isSmallerThanOriginal(void 0)}_toFilterTextReplacement(e){return new ce(this._getUpdatedRange(e),this.inlineCompletion.filterText)}_isSmallerThanOriginal(e){return we(this._getUpdatedRange(e)).isBefore(we(this.inlineCompletion.range))}_getUpdatedRange(e){return this.rangeVersion.read(e),this._updatedRange}_updateRange(e){const t=e.getDecorationRange(this.decorationId);return t?!this._updatedRange.equalsRange(t)&&(this._updatedRange=t,!0):(this._isValid=!1,!0)}}function we(e){return e.startLineNumber===e.endLineNumber?new g.y(1,1+e.endColumn-e.startColumn):new g.y(1+e.endLineNumber-e.startLineNumber,e.endColumn)}var ye,Se=i(42416),Le=i(39587),xe=i(39263),ke=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},Ie=function(e,t){return function(i,n){t(i,n,e)}},De=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};!function(e){e[e.Undo=0]="Undo",e[e.Redo=1]="Redo",e[e.AcceptWord=2]="AcceptWord",e[e.Other=3]="Other"}(ye||(ye={}));let Ne=class extends h.jG{get isAcceptingPartially(){return this._isAcceptingPartially}constructor(e,t,i,n,o,r,a,l,c,d,h,u){let g;super(),this.textModel=e,this.selectedSuggestItem=t,this.cursorPosition=i,this.textModelVersionId=n,this._debounceValue=o,this._suggestPreviewEnabled=r,this._suggestPreviewMode=a,this._inlineSuggestMode=l,this._enabled=c,this._instantiationService=d,this._commandService=h,this._languageConfigurationService=u,this._source=this._register(this._instantiationService.createInstance(ve,this.textModel,this.textModelVersionId,this._debounceValue)),this._isActive=(0,s.FY)(this,!1),this._forceUpdate=(0,s.Yd)("forceUpdate"),this._selectedInlineCompletionId=(0,s.FY)(this,void 0),this._isAcceptingPartially=!1,this._preserveCurrentCompletionReasons=new Set([ye.Redo,ye.Undo,ye.AcceptWord]),this._fetchInlineCompletions=(0,s.nb)({owner:this,createEmptyChangeSummary:()=>({preserveCurrentCompletion:!1,inlineCompletionTriggerKind:q.qw.Automatic}),handleChange:(e,t)=>(e.didChange(this.textModelVersionId)&&this._preserveCurrentCompletionReasons.has(e.change)?t.preserveCurrentCompletion=!0:e.didChange(this._forceUpdate)&&(t.inlineCompletionTriggerKind=e.change),!0)},((e,t)=>{this._forceUpdate.read(e);if(!(this._enabled.read(e)&&this.selectedSuggestItem.read(e)||this._isActive.read(e)))return void this._source.cancelUpdate();this.textModelVersionId.read(e);const i=this.selectedInlineCompletion.get(),n=t.preserveCurrentCompletion||(null===i||void 0===i?void 0:i.forwardStable)?i:void 0,o=this._source.suggestWidgetInlineCompletions.get(),r=this.selectedSuggestItem.read(e);if(o&&!r){const e=this._source.inlineCompletions.get();(0,s.Rn)((t=>{e&&o.request.versionId>e.request.versionId&&this._source.inlineCompletions.set(o.clone(),t),this._source.clearSuggestWidgetInlineCompletions(t)}))}const a=this.cursorPosition.read(e),l={triggerKind:t.inlineCompletionTriggerKind,selectedSuggestionInfo:null===r||void 0===r?void 0:r.toSelectedSuggestionInfo()};return this._source.fetch(a,l,n)})),this._filteredInlineCompletionItems=(0,s.un)(this,(e=>{const t=this._source.inlineCompletions.read(e);if(!t)return[];const i=this.cursorPosition.read(e),n=t.inlineCompletions.filter((t=>t.isVisible(this.textModel,i,e)));return n})),this.selectedInlineCompletionIndex=(0,s.un)(this,(e=>{const t=this._selectedInlineCompletionId.read(e),i=this._filteredInlineCompletionItems.read(e),n=void 0===this._selectedInlineCompletionId?-1:i.findIndex((e=>e.semanticId===t));return-1===n?(this._selectedInlineCompletionId.set(void 0,void 0),0):n})),this.selectedInlineCompletion=(0,s.un)(this,(e=>this._filteredInlineCompletionItems.read(e)[this.selectedInlineCompletionIndex.read(e)])),this.lastTriggerKind=this._source.inlineCompletions.map((e=>null===e||void 0===e?void 0:e.request.context.triggerKind)),this.inlineCompletionsCount=(0,s.un)(this,(e=>this.lastTriggerKind.read(e)===q.qw.Explicit?this._filteredInlineCompletionItems.read(e).length:void 0)),this.state=(0,s.C)({owner:this,equalityComparer:(e,t)=>e&&t?E(e.ghostText,t.ghostText)&&e.inlineCompletion===t.inlineCompletion&&e.suggestItem===t.suggestItem:e===t},(e=>{var t;const i=this.textModel,n=this.selectedSuggestItem.read(e);if(n){const o=n.toSingleTextEdit().removeCommonPrefix(i),s=this._computeAugmentedCompletion(o,e);if(!this._suggestPreviewEnabled.read(e)&&!s)return;const r=null!==(t=null===s||void 0===s?void 0:s.edit)&&void 0!==t?t:o,a=s?s.edit.text.length-o.text.length:0,l=this._suggestPreviewMode.read(e),c=this.cursorPosition.read(e),d=r.computeGhostText(i,l,c,a);return{ghostText:null!==d&&void 0!==d?d:new T(r.range.endLineNumber,[]),inlineCompletion:null===s||void 0===s?void 0:s.completion,suggestItem:n}}{if(!this._isActive.read(e))return;const t=this.selectedInlineCompletion.read(e);if(!t)return;const n=t.toSingleTextEdit(e),o=this._inlineSuggestMode.read(e),s=this.cursorPosition.read(e),r=n.computeGhostText(i,o,s);return r?{ghostText:r,inlineCompletion:t,suggestItem:void 0}:void 0}})),this.ghostText=(0,s.C)({owner:this,equalityComparer:E},(e=>{const t=this.state.read(e);if(t)return t.ghostText})),this._register((0,s.OI)(this._fetchInlineCompletions)),this._register((0,s.fm)((e=>{var t,i;const n=this.state.read(e),o=null===n||void 0===n?void 0:n.inlineCompletion;if((null===o||void 0===o?void 0:o.semanticId)!==(null===g||void 0===g?void 0:g.semanticId)&&(g=o,o)){const e=o.inlineCompletion,n=e.source;null===(i=(t=n.provider).handleItemDidShow)||void 0===i||i.call(t,n.inlineCompletions,e.sourceInlineCompletion,e.insertText)}})))}trigger(e){return De(this,void 0,void 0,(function*(){this._isActive.set(!0,e),yield this._fetchInlineCompletions.get()}))}triggerExplicitly(e){return De(this,void 0,void 0,(function*(){(0,s.PO)(e,(e=>{this._isActive.set(!0,e),this._forceUpdate.trigger(e,q.qw.Explicit)})),yield this._fetchInlineCompletions.get()}))}stop(e){(0,s.PO)(e,(e=>{this._isActive.set(!1,e),this._source.clear(e)}))}_computeAugmentedCompletion(e,t){const i=this.textModel,n=this._source.suggestWidgetInlineCompletions.read(t),o=n?n.inlineCompletions:[this.selectedInlineCompletion.read(t)].filter(K.O9);return(0,j.oH)(o,(n=>{let o=n.toSingleTextEdit(t);return o=o.removeCommonPrefix(i,C.Q.fromPositions(o.range.getStartPosition(),e.range.getEndPosition())),o.augments(e)?{edit:o,completion:n}:void 0}))}_deltaSelectedInlineCompletionIndex(e){return De(this,void 0,void 0,(function*(){yield this.triggerExplicitly();const t=this._filteredInlineCompletionItems.get()||[];if(t.length>0){const i=(this.selectedInlineCompletionIndex.get()+e+t.length)%t.length;this._selectedInlineCompletionId.set(t[i].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}))}next(){return De(this,void 0,void 0,(function*(){yield this._deltaSelectedInlineCompletionIndex(1)}))}previous(){return De(this,void 0,void 0,(function*(){yield this._deltaSelectedInlineCompletionIndex(-1)}))}accept(e){var t;return De(this,void 0,void 0,(function*(){if(e.getModel()!==this.textModel)throw new I.D7;const i=this.state.get();if(!i||i.ghostText.isEmpty()||!i.inlineCompletion)return;const n=i.inlineCompletion.toInlineCompletion(void 0);e.pushUndoStop(),n.snippetInfo?(e.executeEdits("inlineSuggestion.accept",[Q.k.replaceMove(n.range,""),...n.additionalTextEdits]),e.setPosition(n.snippetInfo.range.getStartPosition()),null===(t=Se.O.get(e))||void 0===t||t.insert(n.snippetInfo.snippet,{undoStopBefore:!1})):e.executeEdits("inlineSuggestion.accept",[Q.k.replaceMove(n.range,n.insertText),...n.additionalTextEdits]),n.command&&n.source.addRef(),(0,s.Rn)((e=>{this._source.clear(e),this._isActive.set(!1,e)})),n.command&&(yield this._commandService.executeCommand(n.command.id,...n.command.arguments||[]).then(void 0,I.M_),n.source.removeRef())}))}acceptNextWord(e){return De(this,void 0,void 0,(function*(){yield this._acceptNext(e,((e,t)=>{const i=this.textModel.getLanguageIdAtPosition(e.lineNumber,e.column),n=this._languageConfigurationService.getLanguageConfiguration(i),o=new RegExp(n.wordDefinition.source,n.wordDefinition.flags.replace("g","")),s=t.match(o);let r=0;r=s&&void 0!==s.index?0===s.index?s[0].length:s.index:t.length;const a=/\s+/g.exec(t);return a&&void 0!==a.index&&a.index+a[0].length<r&&(r=a.index+a[0].length),r}))}))}acceptNextLine(e){return De(this,void 0,void 0,(function*(){yield this._acceptNext(e,((e,t)=>{const i=t.match(/\n/);return i&&void 0!==i.index?i.index+1:t.length}))}))}_acceptNext(e,t){return De(this,void 0,void 0,(function*(){if(e.getModel()!==this.textModel)throw new I.D7;const i=this.state.get();if(!i||i.ghostText.isEmpty()||!i.inlineCompletion)return;const n=i.ghostText,o=i.inlineCompletion.toInlineCompletion(void 0);if(o.snippetInfo||o.filterText!==o.insertText)return void(yield this.accept(e));const s=n.parts[0],r=new g.y(n.lineNumber,s.column),a=s.lines.join("\n"),l=t(r,a);if(l===a.length&&1===n.parts.length)return void this.accept(e);const c=a.substring(0,l);this._isAcceptingPartially=!0;try{e.pushUndoStop(),e.executeEdits("inlineSuggestion.accept",[Q.k.replace(C.Q.fromPositions(r),c)]);const t=P(c);e.setPosition(M(r,t))}finally{this._isAcceptingPartially=!1}if(o.source.provider.handlePartialAccept){const t=C.Q.fromPositions(o.range.getStartPosition(),M(r,P(c))),i=e.getModel().getValueInRange(t,1);o.source.provider.handlePartialAccept(o.source.inlineCompletions,o.sourceInlineCompletion,i.length)}}))}handleSuggestAccepted(e){var t,i;const n=e.toSingleTextEdit().removeCommonPrefix(this.textModel),o=this._computeAugmentedCompletion(n,void 0);if(!o)return;const s=o.completion.inlineCompletion;null===(i=(t=s.source.provider).handlePartialAccept)||void 0===i||i.call(t,s.source.inlineCompletions,s.sourceInlineCompletion,n.text.length)}};Ne=ke([Ie(9,xe._Y),Ie(10,Le.d),Ie(11,G.JZ)],Ne);var Re=i(40362),Me=i(60092),Pe=i(61498);class Te extends h.jG{get selectedItem(){return this._selectedItem}constructor(e,t,i,n){super(),this.editor=e,this.suggestControllerPreselector=t,this.checkModelVersion=i,this.onWillAccept=n,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this._selectedItem=(0,s.FY)(this,void 0),this._register(e.onKeyDown((e=>{e.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))}))),this._register(e.onKeyUp((e=>{e.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))})));const o=Me.D.get(this.editor);if(o){this._register(o.registerSelector({priority:100,select:(e,t,i)=>{var n;(0,s.Rn)((e=>this.checkModelVersion(e)));const r=this.editor.getModel();if(!r)return-1;const a=null===(n=this.suggestControllerPreselector())||void 0===n?void 0:n.removeCommonPrefix(r);if(!a)return-1;const l=g.y.lift(t),c=i.map(((e,t)=>{const i=Oe.fromSuggestion(o,r,l,e,this.isShiftKeyPressed).toSingleTextEdit().removeCommonPrefix(r);return{index:t,valid:a.augments(i),prefixLength:i.text.length,suggestItem:e}})).filter((e=>e&&e.valid&&e.prefixLength>0)),d=(0,j.Nf)(c,(0,Pe.VE)((e=>e.prefixLength),Pe.U9));return d?d.index:-1}}));let e=!1;const t=()=>{e||(e=!0,this._register(o.widget.value.onDidShow((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))),this._register(o.widget.value.onDidHide((()=>{this.isSuggestWidgetVisible=!1,this.update(!1)}))),this._register(o.widget.value.onDidFocus((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))))};this._register(d.Jh.once(o.model.onDidTrigger)((e=>{t()}))),this._register(o.onWillInsertSuggestItem((e=>{const t=this.editor.getPosition(),i=this.editor.getModel();if(!t||!i)return;const n=Oe.fromSuggestion(o,i,t,e.item,this.isShiftKeyPressed);this.onWillAccept(n)})))}this.update(this._isActive)}update(e){const t=this.getSuggestItemInfo();this._isActive===e&&function(e,t){if(e===t)return!0;if(!e||!t)return!1;return e.equals(t)}(this._currentSuggestItemInfo,t)||(this._isActive=e,this._currentSuggestItemInfo=t,(0,s.Rn)((e=>{this.checkModelVersion(e),this._selectedItem.set(this._isActive?this._currentSuggestItemInfo:void 0,e)})))}getSuggestItemInfo(){const e=Me.D.get(this.editor);if(!e||!this.isSuggestWidgetVisible)return;const t=e.widget.value.getFocusedItem(),i=this.editor.getPosition(),n=this.editor.getModel();return t&&i&&n?Oe.fromSuggestion(e,n,i,t.item,this.isShiftKeyPressed):void 0}stopForceRenderingAbove(){const e=Me.D.get(this.editor);null===e||void 0===e||e.stopForceRenderingAbove()}forceRenderingAbove(){const e=Me.D.get(this.editor);null===e||void 0===e||e.forceRenderingAbove()}}class Oe{static fromSuggestion(e,t,i,n,o){let{insertText:s}=n.completion,r=!1;if(4&n.completion.insertTextRules){const e=(new te.fr).parse(s);e.children.length<100&&Re.O.adjustWhitespace(t,i,!0,e),s=e.toString(),r=!0}const a=e.getOverwriteInfo(n,o);return new Oe(C.Q.fromPositions(i.delta(0,-a.overwriteBefore),i.delta(0,Math.max(a.overwriteAfter,0))),s,n.completion.kind,r)}constructor(e,t,i,n){this.range=e,this.insertText=t,this.completionItemKind=i,this.isSnippetText=n}equals(e){return this.range.equalsRange(e.range)&&this.insertText===e.insertText&&this.completionItemKind===e.completionItemKind&&this.isSnippetText===e.isSnippetText}toSelectedSuggestionInfo(){return new q.GE(this.range,this.insertText,this.completionItemKind,this.isSnippetText)}toSingleTextEdit(){return new ce(this.range,this.insertText)}}var Ae,Ee=i(51413),He=i(41030),Fe=i(66457),We=i(39686),Ve=i(16391),Ue=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},ze=function(e,t){return function(i,n){t(i,n,e)}};let Be=Ae=class extends h.jG{static get(e){return e.getContribution(Ae.ID)}constructor(e,t,i,n,o,r,c,p,m){super(),this.editor=e,this.instantiationService=t,this.contextKeyService=i,this.configurationService=n,this.commandService=o,this.debounceService=r,this.languageFeaturesService=c,this.audioCueService=p,this._keybindingService=m,this.model=(0,s.X2)("inlineCompletionModel",void 0),this.textModelVersionId=(0,s.FY)(this,-1),this.cursorPosition=(0,s.FY)(this,new g.y(1,1)),this.suggestWidgetAdaptor=this._register(new Te(this.editor,(()=>{var e,t;return null===(t=null===(e=this.model.get())||void 0===e?void 0:e.selectedInlineCompletion.get())||void 0===t?void 0:t.toSingleTextEdit(void 0)}),(e=>this.updateObservables(e,ye.Other)),(e=>{(0,s.Rn)((t=>{var i;this.updateObservables(t,ye.Other),null===(i=this.model.get())||void 0===i||i.handleSuggestAccepted(e)}))}))),this._enabled=(0,s.y0)(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(62).enabled)),this.ghostTextWidget=this._register(this.instantiationService.createInstance(V,this.editor,{ghostText:this.model.map(((e,t)=>null===e||void 0===e?void 0:e.ghostText.read(t))),minReservedLineCount:(0,s.lk)(0),targetTextModel:this.model.map((e=>null===e||void 0===e?void 0:e.textModel))})),this._debounceValue=this.debounceService.for(this.languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:50}),this._register(new l.p(this.contextKeyService,this.model)),this._register(d.Jh.runAndSubscribe(e.onDidChangeModel,(()=>(0,s.Rn)((i=>{this.model.set(void 0,i),this.updateObservables(i,ye.Other);const n=e.getModel();if(n){const o=t.createInstance(Ne,n,this.suggestWidgetAdaptor.selectedItem,this.cursorPosition,this.textModelVersionId,this._debounceValue,(0,s.y0)(e.onDidChangeConfiguration,(()=>e.getOption(117).preview)),(0,s.y0)(e.onDidChangeConfiguration,(()=>e.getOption(117).previewMode)),(0,s.y0)(e.onDidChangeConfiguration,(()=>e.getOption(62).mode)),this._enabled);this.model.set(o,i)}})))));const v=e=>{var t;return e.isUndoing?ye.Undo:e.isRedoing?ye.Redo:(null===(t=this.model.get())||void 0===t?void 0:t.isAcceptingPartially)?ye.AcceptWord:ye.Other};let f;this._register(e.onDidChangeModelContent((e=>(0,s.Rn)((t=>this.updateObservables(t,v(e))))))),this._register(e.onDidChangeCursorPosition((e=>(0,s.Rn)((t=>{var i;this.updateObservables(t,ye.Other),3!==e.reason&&"api"!==e.source||null===(i=this.model.get())||void 0===i||i.stop(t)}))))),this._register(e.onDidType((()=>(0,s.Rn)((e=>{var t;this.updateObservables(e,ye.Other),this._enabled.get()&&(null===(t=this.model.get())||void 0===t||t.trigger(e))}))))),this._register(this.commandService.onDidExecuteCommand((t=>{new Set([u.Yh.Tab.id,u.Yh.DeleteLeft.id,u.Yh.DeleteRight.id,a.Wt,"acceptSelectedSuggestion"]).has(t.commandId)&&e.hasTextFocus()&&this._enabled.get()&&(0,s.Rn)((e=>{var t;null===(t=this.model.get())||void 0===t||t.trigger(e)}))}))),this._register(this.editor.onDidBlurEditorWidget((()=>{this.contextKeyService.getContextKeyValue("accessibleViewIsShown")||this.configurationService.getValue("editor.inlineSuggest.keepOnBlur")||e.getOption(62).keepOnBlur||B.bo.dropDownVisible||(0,s.Rn)((e=>{var t;null===(t=this.model.get())||void 0===t||t.stop(e)}))}))),this._register((0,s.fm)((e=>{var t;const i=null===(t=this.model.read(e))||void 0===t?void 0:t.state.read(e);(null===i||void 0===i?void 0:i.suggestItem)?i.ghostText.lineCount>=2&&this.suggestWidgetAdaptor.forceRenderingAbove():this.suggestWidgetAdaptor.stopForceRenderingAbove()}))),this._register((0,h.s)((()=>{this.suggestWidgetAdaptor.stopForceRenderingAbove()}))),this._register((0,s.fm)((e=>{const t=this.model.read(e),i=null===t||void 0===t?void 0:t.state.read(e);if(t&&i&&i.inlineCompletion){if(i.inlineCompletion.semanticId!==f){f=i.inlineCompletion.semanticId;const e=t.textModel.getLineContent(i.ghostText.lineNumber);this.audioCueService.playAudioCue(He.gv.inlineSuggestion).then((()=>{this.editor.getOption(8)&&this.provideScreenReaderUpdate(i.ghostText.renderForScreenReader(e))}))}}else f=void 0}))),this._register(new B.Pm(this.editor,this.model,this.instantiationService)),this._register(this.configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("accessibility.verbosity.inlineCompletions")&&this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this.configurationService.getValue("accessibility.verbosity.inlineCompletions")})}))),this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this.configurationService.getValue("accessibility.verbosity.inlineCompletions")})}provideScreenReaderUpdate(e){const t=this.contextKeyService.getContextKeyValue("accessibleViewIsShown"),i=this._keybindingService.lookupKeybinding("editor.action.accessibleView");let n;!t&&i&&this.editor.getOption(147)&&(n=(0,Ee.kg)("showAccessibleViewHint","Inspect this in the accessible view ({0})",i.getAriaLabel())),n?(0,c.xE)(e+", "+n):(0,c.xE)(e)}updateObservables(e,t){var i,n;const o=this.editor.getModel();this.textModelVersionId.set(null!==(i=null===o||void 0===o?void 0:o.getVersionId())&&void 0!==i?i:-1,e,t),this.cursorPosition.set(null!==(n=this.editor.getPosition())&&void 0!==n?n:new g.y(1,1),e)}shouldShowHoverAt(e){var t;const i=null===(t=this.model.get())||void 0===t?void 0:t.ghostText.get();return!!i&&i.parts.some((t=>e.containsPosition(new g.y(i.lineNumber,t.column))))}shouldShowHoverAtViewZone(e){return this.ghostTextWidget.ownsViewZone(e)}};Be.ID="editor.contrib.inlineCompletionsController",Be=Ae=Ue([ze(1,xe._Y),ze(2,We.fN),ze(3,Fe.pG),ze(4,Le.d),ze(5,p.U),ze(6,m.u),ze(7,He.C6),ze(8,Ve.b)],Be);var je=i(23436),Ke=i(35155),Qe=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};class qe extends n.ks{constructor(){super({id:qe.ID,label:Ee.kg("action.inlineSuggest.showNext","Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:We.M$.and(r.R.writable,l.p.inlineSuggestionVisible),kbOpts:{weight:100,primary:606}})}run(e,t){var i;return Qe(this,void 0,void 0,(function*(){const e=Be.get(t);null===(i=null===e||void 0===e?void 0:e.model.get())||void 0===i||i.next()}))}}qe.ID=a.PA;class Ge extends n.ks{constructor(){super({id:Ge.ID,label:Ee.kg("action.inlineSuggest.showPrevious","Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:We.M$.and(r.R.writable,l.p.inlineSuggestionVisible),kbOpts:{weight:100,primary:604}})}run(e,t){var i;return Qe(this,void 0,void 0,(function*(){const e=Be.get(t);null===(i=null===e||void 0===e?void 0:e.model.get())||void 0===i||i.previous()}))}}Ge.ID=a.Vl;class Ye extends n.ks{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:Ee.kg("action.inlineSuggest.trigger","Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:r.R.writable})}run(e,t){var i;return Qe(this,void 0,void 0,(function*(){const e=Be.get(t);null===(i=null===e||void 0===e?void 0:e.model.get())||void 0===i||i.triggerExplicitly()}))}}class Ze extends n.ks{constructor(){super({id:"editor.action.inlineSuggest.acceptNextWord",label:Ee.kg("action.inlineSuggest.acceptNextWord","Accept Next Word Of Inline Suggestion"),alias:"Accept Next Word Of Inline Suggestion",precondition:We.M$.and(r.R.writable,l.p.inlineSuggestionVisible),kbOpts:{weight:101,primary:2065,kbExpr:We.M$.and(r.R.writable,l.p.inlineSuggestionVisible)},menuOpts:[{menuId:Ke.D8.InlineSuggestionToolbar,title:Ee.kg("acceptWord","Accept Word"),group:"primary",order:2}]})}run(e,t){var i;return Qe(this,void 0,void 0,(function*(){const e=Be.get(t);yield null===(i=null===e||void 0===e?void 0:e.model.get())||void 0===i?void 0:i.acceptNextWord(e.editor)}))}}class $e extends n.ks{constructor(){super({id:"editor.action.inlineSuggest.acceptNextLine",label:Ee.kg("action.inlineSuggest.acceptNextLine","Accept Next Line Of Inline Suggestion"),alias:"Accept Next Line Of Inline Suggestion",precondition:We.M$.and(r.R.writable,l.p.inlineSuggestionVisible),kbOpts:{weight:101},menuOpts:[{menuId:Ke.D8.InlineSuggestionToolbar,title:Ee.kg("acceptLine","Accept Line"),group:"secondary",order:2}]})}run(e,t){var i;return Qe(this,void 0,void 0,(function*(){const e=Be.get(t);yield null===(i=null===e||void 0===e?void 0:e.model.get())||void 0===i?void 0:i.acceptNextLine(e.editor)}))}}class Xe extends n.ks{constructor(){super({id:a.Wt,label:Ee.kg("action.inlineSuggest.accept","Accept Inline Suggestion"),alias:"Accept Inline Suggestion",precondition:l.p.inlineSuggestionVisible,menuOpts:[{menuId:Ke.D8.InlineSuggestionToolbar,title:Ee.kg("accept","Accept"),group:"primary",order:1}],kbOpts:{primary:2,weight:200,kbExpr:We.M$.and(l.p.inlineSuggestionVisible,r.R.tabMovesFocus.toNegated(),l.p.inlineSuggestionHasIndentationLessThanTabSize,je.ob.Visible.toNegated(),r.R.hoverFocused.toNegated())}})}run(e,t){var i;return Qe(this,void 0,void 0,(function*(){const e=Be.get(t);e&&(null===(i=e.model.get())||void 0===i||i.accept(e.editor),e.editor.focus())}))}}class Je extends n.ks{constructor(){super({id:Je.ID,label:Ee.kg("action.inlineSuggest.hide","Hide Inline Suggestion"),alias:"Hide Inline Suggestion",precondition:l.p.inlineSuggestionVisible,kbOpts:{weight:100,primary:9}})}run(e,t){return Qe(this,void 0,void 0,(function*(){const e=Be.get(t);(0,s.Rn)((t=>{var i;null===(i=null===e||void 0===e?void 0:e.model.get())||void 0===i||i.stop(t)}))}))}}Je.ID="editor.action.inlineSuggest.hide";class et extends Ke.L{constructor(){super({id:et.ID,title:Ee.kg("action.inlineSuggest.alwaysShowToolbar","Always Show Toolbar"),f1:!1,precondition:void 0,menu:[{id:Ke.D8.InlineSuggestionToolbar,group:"secondary",order:10}],toggled:We.M$.equals("config.editor.inlineSuggest.showToolbar","always")})}run(e,t){return Qe(this,void 0,void 0,(function*(){const t=e.get(Fe.pG),i="always"===t.getValue("editor.inlineSuggest.showToolbar")?"onHover":"always";t.updateValue("editor.inlineSuggest.showToolbar",i)}))}}et.ID="editor.action.inlineSuggest.toggleAlwaysShowToolbar";var tt=i(32605),it=i(58348),nt=i(28969),ot=i(73429),st=i(2531),rt=i(96819),at=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},lt=function(e,t){return function(i,n){t(i,n,e)}};class ct{constructor(e,t,i){this.owner=e,this.range=t,this.controller=i}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let dt=class{constructor(e,t,i,n,o,s){this._editor=e,this._languageService=t,this._openerService=i,this.accessibilityService=n,this._instantiationService=o,this._telemetryService=s,this.hoverOrdinal=4}suggestHoverAnchor(e){const t=Be.get(this._editor);if(!t)return null;const i=e.target;if(8===i.type){const n=i.detail;if(t.shouldShowHoverAtViewZone(n.viewZoneId))return new o.mm(1e3,this,C.Q.fromPositions(this._editor.getModel().validatePosition(n.positionBefore||n.position)),e.event.posx,e.event.posy,!1)}if(7===i.type&&t.shouldShowHoverAt(i.range))return new o.mm(1e3,this,i.range,e.event.posx,e.event.posy,!1);if(6===i.type){if(i.detail.mightBeForeignElement&&t.shouldShowHoverAt(i.range))return new o.mm(1e3,this,i.range,e.event.posx,e.event.posy,!1)}return null}computeSync(e,t){if("always"===this._editor.getOption(62).showToolbar)return[];const i=Be.get(this._editor);return i&&i.shouldShowHoverAt(e.range)?[new ct(this,e.range,i)]:[]}renderHoverParts(e,t){const i=new h.Cm,n=t[0];this._telemetryService.publicLog2("inlineCompletionHover.shown"),this.accessibilityService.isScreenReaderOptimized()&&!this._editor.getOption(8)&&this.renderScreenReaderText(e,n,i);const o=n.controller.model.get(),r=this._instantiationService.createInstance(B.bo,this._editor,!1,(0,s.lk)(null),o.selectedInlineCompletionIndex,o.inlineCompletionsCount,o.selectedInlineCompletion.map((e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.inlineCompletion.source.inlineCompletions.commands)&&void 0!==t?t:[]})));return e.fragment.appendChild(r.getDomNode()),o.triggerExplicitly(),i.add(r),i}renderScreenReaderText(e,t,i){const n=tt.$,o=n("div.hover-row.markdown-hover"),r=tt.BC(o,n("div.hover-contents",{"aria-live":"assertive"})),a=i.add(new nt.T({editor:this._editor},this._languageService,this._openerService));i.add((0,s.fm)((n=>{var o;const s=null===(o=t.controller.model.read(n))||void 0===o?void 0:o.ghostText.read(n);if(s){const t=this._editor.getModel().getLineContent(s.lineNumber);(t=>{i.add(a.onDidRenderAsync((()=>{r.className="hover-contents code-hover-contents",e.onContentsChanged()})));const n=Ee.kg("inlineSuggestionFollows","Suggestion:"),o=i.add(a.render((new it.Bc).appendText(n).appendCodeblock("text",t)));r.replaceChildren(o.element)})(s.renderForScreenReader(t))}else tt.Ln(r)}))),e.fragment.appendChild(o)}};dt=at([lt(1,y.L),lt(2,st.Cr),lt(3,ot.j),lt(4,xe._Y),lt(5,rt.k)],dt),(0,n.HW)(Be.ID,Be,3),(0,n.Fl)(Ye),(0,n.Fl)(qe),(0,n.Fl)(Ge),(0,n.Fl)(Ze),(0,n.Fl)($e),(0,n.Fl)(Xe),(0,n.Fl)(Je),(0,Ke.ug)(et),o.B2.register(dt)},17907:(e,t,i)=>{i.d(t,{Pm:()=>M,bo:()=>O});var n,o=i(32605),s=i(92593),r=i(42108),a=i(63169),l=i(61498),c=i(73990),d=i(62112),h=i(87766),u=i(96664),g=i(66731),p=i(70145),m=i(23525),v=i(91861),f=i(79267),_=i(51413),b=i(20028),C=i(45924),w=i(35155),y=i(39587),S=i(39686),L=i(6748),x=i(39263),k=i(16391),I=i(96819),D=i(85514),N=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},R=function(e,t){return function(i,n){t(i,n,e)}};let M=class extends h.jG{constructor(e,t,i){super(),this.editor=e,this.model=t,this.instantiationService=i,this.alwaysShowToolbar=(0,u.y0)(this.editor.onDidChangeConfiguration,(()=>"always"===this.editor.getOption(62).showToolbar)),this.sessionPosition=void 0,this.position=(0,u.un)(this,(e=>{var t,i,n;const o=null===(t=this.model.read(e))||void 0===t?void 0:t.ghostText.read(e);if(!this.alwaysShowToolbar.read(e)||!o||0===o.parts.length)return this.sessionPosition=void 0,null;const s=o.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==o.lineNumber&&(this.sessionPosition=void 0);const r=new m.y(o.lineNumber,Math.min(s,null!==(n=null===(i=this.sessionPosition)||void 0===i?void 0:i.column)&&void 0!==n?n:Number.MAX_SAFE_INTEGER));return this.sessionPosition=r,r})),this._register((0,u.yC)(((t,i)=>{const n=this.model.read(t);if(!n||!this.alwaysShowToolbar.read(t))return;const o=i.add(this.instantiationService.createInstance(O,this.editor,!0,this.position,n.selectedInlineCompletionIndex,n.inlineCompletionsCount,n.selectedInlineCompletion.map((e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.inlineCompletion.source.inlineCompletions.commands)&&void 0!==t?t:[]}))));e.addContentWidget(o),i.add((0,h.s)((()=>e.removeContentWidget(o)))),i.add((0,u.fm)((e=>{this.position.read(e)&&n.lastTriggerKind.read(e)!==v.qw.Explicit&&n.triggerExplicitly()})))})))}};M=N([R(2,x._Y)],M);const P=(0,D.pU)("inline-suggestion-hints-next",d.W.chevronRight,(0,_.kg)("parameterHintsNextIcon","Icon for show next parameter hint.")),T=(0,D.pU)("inline-suggestion-hints-previous",d.W.chevronLeft,(0,_.kg)("parameterHintsPreviousIcon","Icon for show previous parameter hint."));let O=n=class extends h.jG{static get dropDownVisible(){return this._dropDownVisible}createCommandAction(e,t,i){const n=new a.rc(e,t,i,!0,(()=>this._commandService.executeCommand(e))),o=this.keybindingService.lookupKeybinding(e,this._contextKeyService);let s=t;return o&&(s=(0,_.kg)({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",t,o.getLabel())),n.tooltip=s,n}constructor(e,t,i,s,r,d,h,g,m,v,b){super(),this.editor=e,this.withBorder=t,this._position=i,this._currentSuggestionIdx=s,this._suggestionCount=r,this._extraCommands=d,this._commandService=h,this.keybindingService=m,this._contextKeyService=v,this._menuService=b,this.id="InlineSuggestionHintsContentWidget".concat(n.id++),this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=(0,o.h)("div.inlineSuggestionsHints",{className:this.withBorder?".withBorder":""},[(0,o.h)("div@toolBar")]),this.previousAction=this.createCommandAction(f.Vl,(0,_.kg)("previous","Previous"),p.L.asClassName(T)),this.availableSuggestionCountAction=new a.rc("inlineSuggestionHints.availableSuggestionCount","",void 0,!1),this.nextAction=this.createCommandAction(f.PA,(0,_.kg)("next","Next"),p.L.asClassName(P)),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(w.D8.InlineCompletionsActions,this._contextKeyService)),this.clearAvailableSuggestionCountLabelDebounced=this._register(new c.uC((()=>{this.availableSuggestionCountAction.label=""}),100)),this.disableButtonsDebounced=this._register(new c.uC((()=>{this.previousAction.enabled=this.nextAction.enabled=!1}),100)),this.lastCommands=[],this.toolBar=this._register(g.createInstance(H,this.nodes.toolBar,w.D8.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:e=>e.startsWith("primary")},actionViewItemProvider:(e,t)=>{if(e instanceof w.Xe)return g.createInstance(E,e,void 0);if(e===this.availableSuggestionCountAction){const t=new A(void 0,e,{label:!0,icon:!1});return t.setClass("availableSuggestionCount"),t}},telemetrySource:"InlineSuggestionToolbar"})),this.toolBar.setPrependedPrimaryActions([this.previousAction,this.availableSuggestionCountAction,this.nextAction]),this._register(this.toolBar.onDidChangeDropdownVisibility((e=>{n._dropDownVisible=e}))),this._register((0,u.fm)((e=>{this._position.read(e),this.editor.layoutContentWidget(this)}))),this._register((0,u.fm)((e=>{const t=this._suggestionCount.read(e),i=this._currentSuggestionIdx.read(e);void 0!==t?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label="".concat(i+1,"/").concat(t)):this.clearAvailableSuggestionCountLabelDebounced.schedule(),void 0!==t&&t>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()}))),this._register((0,u.fm)((e=>{const t=this._extraCommands.read(e);if((0,l.aI)(this.lastCommands,t))return;this.lastCommands=t;const i=t.map((e=>({class:void 0,id:e.id,enabled:!0,tooltip:e.tooltip||"",label:e.title,run:t=>this._commandService.executeCommand(e.id)})));for(const[n,o]of this.inlineCompletionsActionsMenus.getActions())for(const e of o)e instanceof w.Xe&&i.push(e);i.length>0&&i.unshift(new a.wv),this.toolBar.setAdditionalSecondaryActions(i)})))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};O._dropDownVisible=!1,O.id=0,O=n=N([R(6,y.d),R(7,x._Y),R(8,k.b),R(9,S.fN),R(10,w.ez)],O);class A extends s.Z4{constructor(){super(...arguments),this._className=void 0}setClass(e){this._className=e}render(e){super.render(e),this._className&&e.classList.add(this._className)}}class E extends b.oq{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=(0,o.h)("div.keybinding").root;new r.x(t,g.OS,Object.assign({disableTitle:!0},r.l)).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}}let H=class extends C.p{constructor(e,t,i,n,o,s,r,a){super(e,Object.assign({resetMenu:t},i),n,o,s,r,a),this.menuId=t,this.options2=i,this.menuService=n,this.contextKeyService=o,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange((()=>this.updateToolbar()))),this.updateToolbar()}updateToolbar(){var e,t,i,n,o,s,r;const a=[],l=[];(0,b.Ot)(this.menu,null===(e=this.options2)||void 0===e?void 0:e.menuOptions,{primary:a,secondary:l},null===(i=null===(t=this.options2)||void 0===t?void 0:t.toolbarOptions)||void 0===i?void 0:i.primaryGroup,null===(o=null===(n=this.options2)||void 0===n?void 0:n.toolbarOptions)||void 0===o?void 0:o.shouldInlineSubmenu,null===(r=null===(s=this.options2)||void 0===s?void 0:s.toolbarOptions)||void 0===r?void 0:r.useSeparatorsInPrimaryActions),l.push(...this.additionalActions),a.unshift(...this.prependedPrimaryActions),this.setActions(a,l)}setPrependedPrimaryActions(e){(0,l.aI)(this.prependedPrimaryActions,e,((e,t)=>e===t))||(this.prependedPrimaryActions=e,this.updateToolbar())}setAdditionalSecondaryActions(e){(0,l.aI)(this.additionalActions,e,((e,t)=>e===t))||(this.additionalActions=e,this.updateToolbar())}};H=N([R(3,w.ez),R(4,S.fN),R(5,L.Z),R(6,k.b),R(7,I.k)],H)},64380:(e,t,i)=>{i.d(t,{I:()=>f});var n=i(32605),o=i(73990),s=i(62112),r=i(87766),a=i(12780),l=i(70145),c=i(99005),d=i(15739),h=i(39263),u=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},g=function(e,t){return function(i,n){t(i,n,e)}},p=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};const m=d.kI.register({description:"inline-progress-widget",stickiness:1,showIfCollapsed:!0,after:{content:a.S8,inlineClassName:"inline-editor-progress-decoration",inlineClassNameAffectsLetterSpacing:!0}});class v extends r.jG{constructor(e,t,i,n,o){super(),this.typeId=e,this.editor=t,this.range=i,this.delegate=o,this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this.create(n),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this)}create(e){this.domNode=n.$(".inline-progress-widget"),this.domNode.role="button",this.domNode.title=e;const t=n.$("span.icon");this.domNode.append(t),t.classList.add(...l.L.asClassNameArray(s.W.loading),"codicon-modifier-spin");const i=()=>{const e=this.editor.getOption(66);this.domNode.style.height="".concat(e,"px"),this.domNode.style.width="".concat(Math.ceil(.8*e),"px")};i(),this._register(this.editor.onDidChangeConfiguration((e=>{(e.hasChanged(52)||e.hasChanged(66))&&i()}))),this._register(n.ko(this.domNode,n.Bx.CLICK,(e=>{this.delegate.cancel()})))}getId(){return v.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:{lineNumber:this.range.startLineNumber,column:this.range.startColumn},preference:[0]}}dispose(){super.dispose(),this.editor.removeContentWidget(this)}}v.baseId="editor.widget.inlineProgressWidget";let f=class extends r.jG{constructor(e,t,i){super(),this.id=e,this._editor=t,this._instantiationService=i,this._showDelay=500,this._showPromise=this._register(new r.HE),this._currentWidget=new r.HE,this._operationIdPool=0,this._currentDecorations=t.createDecorationsCollection()}showWhile(e,t,i){return p(this,void 0,void 0,(function*(){const n=this._operationIdPool++;this._currentOperation=n,this.clear(),this._showPromise.value=(0,o.EQ)((()=>{const n=c.Q.fromPositions(e);this._currentDecorations.set([{range:n,options:m}]).length>0&&(this._currentWidget.value=this._instantiationService.createInstance(v,this.id,this._editor,n,t,i))}),this._showDelay);try{return yield i}finally{this._currentOperation===n&&(this.clear(),this._currentOperation=void 0)}}))}clear(){this._showPromise.clear(),this._currentDecorations.clear(),this._currentWidget.clear()}};f=u([g(2,h._Y)],f)},70392:(e,t,i)=>{var n=i(30050),o=i(11288),s=i(72330),r=i(51413);class a extends n.ks{constructor(){super({id:"expandLineSelection",label:r.kg("expandLineSelection","Expand Line Selection"),alias:"Expand Line Selection",precondition:void 0,kbOpts:{weight:0,kbExpr:s.R.textInputFocus,primary:2090}})}run(e,t,i){if(i=i||{},!t.hasModel())return;const n=t._getViewModel();n.model.pushStackElement(),n.setCursorStates(i.source,3,o.c.expandLineSelection(n,n.getCursorStates())),n.revealPrimaryCursor(i.source,!0)}}(0,n.Fl)(a)},93106:(e,t,i)=>{var n=i(57443),o=i(49300),s=i(30050),r=i(77932),a=i(67599),l=i(30756),c=i(94597),d=i(23525),h=i(99005),u=i(5190),g=i(72330);class p{constructor(e,t,i){this._selection=e,this._isCopyingDown=t,this._noop=i||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(e,t){let i=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,i.startLineNumber<i.endLineNumber&&1===i.endColumn&&(this._endLineNumberDelta=1,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const n=[];for(let s=i.startLineNumber;s<=i.endLineNumber;s++)n.push(e.getLineContent(s));const o=n.join("\n");""===o&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?t.addEditOperation(new h.Q(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber+1,1),i.endLineNumber===e.getLineCount()?"":"\n"):this._isCopyingDown?t.addEditOperation(new h.Q(i.startLineNumber,1,i.startLineNumber,1),o+"\n"):t.addEditOperation(new h.Q(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),"\n"+o),this._selectionId=t.trackSelection(i),this._selectionDirection=this._selection.getDirection()}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);if(0!==this._startLineNumberDelta||0!==this._endLineNumberDelta){let e=i.startLineNumber,t=i.startColumn,n=i.endLineNumber,o=i.endColumn;0!==this._startLineNumberDelta&&(e+=this._startLineNumberDelta,t=1),0!==this._endLineNumberDelta&&(n+=this._endLineNumberDelta,o=1),i=u.L.createWithDirection(e,t,n,o,this._selectionDirection)}return i}}var m=i(12780),v=i(90984),f=i(53966),_=i(80158),b=i(85764),C=i(47893),w=i(89658),y=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},S=function(e,t){return function(i,n){t(i,n,e)}};let L=class{constructor(e,t,i,n){this._languageConfigurationService=n,this._selection=e,this._isMovingDown=t,this._autoIndent=i,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(e,t){const i=e.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===i)return void(this._selectionId=t.trackSelection(this._selection));if(!this._isMovingDown&&1===this._selection.startLineNumber)return void(this._selectionId=t.trackSelection(this._selection));this._moveEndPositionDown=!1;let n=this._selection;n.startLineNumber<n.endLineNumber&&1===n.endColumn&&(this._moveEndPositionDown=!0,n=n.setEndPosition(n.endLineNumber-1,e.getLineMaxColumn(n.endLineNumber-1)));const{tabSize:o,indentSize:s,insertSpaces:r}=e.getOptions(),a=this.buildIndentConverter(o,s,r),l={tokenization:{getLineTokens:t=>e.tokenization.getLineTokens(t),getLanguageId:()=>e.getLanguageId(),getLanguageIdAtPosition:(t,i)=>e.getLanguageIdAtPosition(t,i)},getLineContent:null};if(n.startLineNumber===n.endLineNumber&&1===e.getLineMaxColumn(n.startLineNumber)){const i=n.startLineNumber,o=this._isMovingDown?i+1:i-1;1===e.getLineMaxColumn(o)?t.addEditOperation(new h.Q(1,1,1,1),null):(t.addEditOperation(new h.Q(i,1,i,1),e.getLineContent(o)),t.addEditOperation(new h.Q(o,1,o,e.getLineMaxColumn(o)),null)),n=new u.L(o,1,o,1)}else{let i,s;if(this._isMovingDown){i=n.endLineNumber+1,s=e.getLineContent(i),t.addEditOperation(new h.Q(i-1,e.getLineMaxColumn(i-1),i,e.getLineMaxColumn(i)),null);let c=s;if(this.shouldAutoIndent(e,n)){const d=this.matchEnterRule(e,a,o,i,n.startLineNumber-1);if(null!==d){const t=m.UU(e.getLineContent(i)),n=d+b.c(t,o),a=b.k(n,o,r);c=a+this.trimStart(s)}else{l.getLineContent=t=>t===n.startLineNumber?e.getLineContent(i):e.getLineContent(t);const t=(0,C.$f)(this._autoIndent,l,e.getLanguageIdAtPosition(i,1),n.startLineNumber,a,this._languageConfigurationService);if(null!==t){const n=m.UU(e.getLineContent(i)),a=b.c(t,o);if(a!==b.c(n,o)){const e=b.k(a,o,r);c=e+this.trimStart(s)}}}t.addEditOperation(new h.Q(n.startLineNumber,1,n.startLineNumber,1),c+"\n");const u=this.matchEnterRuleMovingDown(e,a,o,n.startLineNumber,i,c);if(null!==u)0!==u&&this.getIndentEditsOfMovingBlock(e,t,n,o,r,u);else{l.getLineContent=t=>t===n.startLineNumber?c:t>=n.startLineNumber+1&&t<=n.endLineNumber+1?e.getLineContent(t-1):e.getLineContent(t);const s=(0,C.$f)(this._autoIndent,l,e.getLanguageIdAtPosition(i,1),n.startLineNumber+1,a,this._languageConfigurationService);if(null!==s){const i=m.UU(e.getLineContent(n.startLineNumber)),a=b.c(s,o),l=b.c(i,o);if(a!==l){const i=a-l;this.getIndentEditsOfMovingBlock(e,t,n,o,r,i)}}}}else t.addEditOperation(new h.Q(n.startLineNumber,1,n.startLineNumber,1),c+"\n")}else if(i=n.startLineNumber-1,s=e.getLineContent(i),t.addEditOperation(new h.Q(i,1,i+1,1),null),t.addEditOperation(new h.Q(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber),n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),"\n"+s),this.shouldAutoIndent(e,n)){l.getLineContent=t=>t===i?e.getLineContent(n.startLineNumber):e.getLineContent(t);const s=this.matchEnterRule(e,a,o,n.startLineNumber,n.startLineNumber-2);if(null!==s)0!==s&&this.getIndentEditsOfMovingBlock(e,t,n,o,r,s);else{const s=(0,C.$f)(this._autoIndent,l,e.getLanguageIdAtPosition(n.startLineNumber,1),i,a,this._languageConfigurationService);if(null!==s){const i=m.UU(e.getLineContent(n.startLineNumber)),a=b.c(s,o),l=b.c(i,o);if(a!==l){const i=a-l;this.getIndentEditsOfMovingBlock(e,t,n,o,r,i)}}}}}this._selectionId=t.trackSelection(n)}buildIndentConverter(e,t,i){return{shiftIndent:n=>v.Y.shiftIndent(n,n.length+1,e,t,i),unshiftIndent:n=>v.Y.unshiftIndent(n,n.length+1,e,t,i)}}parseEnterResult(e,t,i,n,o){if(o){let s=o.indentation;o.indentAction===f.l.None||o.indentAction===f.l.Indent?s=o.indentation+o.appendText:o.indentAction===f.l.IndentOutdent?s=o.indentation:o.indentAction===f.l.Outdent&&(s=t.unshiftIndent(o.indentation)+o.appendText);const r=e.getLineContent(n);if(this.trimStart(r).indexOf(this.trimStart(s))>=0){const o=m.UU(e.getLineContent(n));let r=m.UU(s);const a=(0,C.Yb)(e,n,this._languageConfigurationService);null!==a&&2&a&&(r=t.unshiftIndent(r));return b.c(r,i)-b.c(o,i)}}return null}matchEnterRuleMovingDown(e,t,i,n,o,s){if(m.lT(s)>=0){const s=e.getLineMaxColumn(o),r=(0,w.h)(this._autoIndent,e,new h.Q(o,s,o,s),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,r)}{let o=n-1;for(;o>=1;){const t=e.getLineContent(o);if(m.lT(t)>=0)break;o--}if(o<1||n>e.getLineCount())return null;const s=e.getLineMaxColumn(o),r=(0,w.h)(this._autoIndent,e,new h.Q(o,s,o,s),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,r)}}matchEnterRule(e,t,i,n,o,s){let r=o;for(;r>=1;){let t;t=r===o&&void 0!==s?s:e.getLineContent(r);if(m.lT(t)>=0)break;r--}if(r<1||n>e.getLineCount())return null;const a=e.getLineMaxColumn(r),l=(0,w.h)(this._autoIndent,e,new h.Q(r,a,r,a),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,l)}trimStart(e){return e.replace(/^\s+/,"")}shouldAutoIndent(e,t){if(this._autoIndent<4)return!1;if(!e.tokenization.isCheapToTokenize(t.startLineNumber))return!1;const i=e.getLanguageIdAtPosition(t.startLineNumber,1);return i===e.getLanguageIdAtPosition(t.endLineNumber,1)&&null!==this._languageConfigurationService.getLanguageConfiguration(i).indentRulesSupport}getIndentEditsOfMovingBlock(e,t,i,n,o,s){for(let r=i.startLineNumber;r<=i.endLineNumber;r++){const a=e.getLineContent(r),l=m.UU(a),c=b.c(l,n)+s,d=b.k(c,n,o);d!==l&&(t.addEditOperation(new h.Q(r,1,r,l.length+1),d),r===i.endLineNumber&&i.endColumn<=l.length+1&&""===d&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&i.startLineNumber<i.endLineNumber&&(i=i.setEndPosition(i.endLineNumber,2)),i}};L=y([S(3,_.JZ)],L);class x{static getCollator(){return x._COLLATOR||(x._COLLATOR=new Intl.Collator),x._COLLATOR}constructor(e,t){this.selection=e,this.descending=t,this.selectionId=null}getEditOperations(e,t){const i=function(e,t,i){const n=k(e,t,i);if(!n)return null;return c.k.replace(new h.Q(n.startLineNumber,1,n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),n.after.join("\n"))}(e,this.selection,this.descending);i&&t.addEditOperation(i.range,i.text),this.selectionId=t.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}static canRun(e,t,i){if(null===e)return!1;const n=k(e,t,i);if(!n)return!1;for(let o=0,s=n.before.length;o<s;o++)if(n.before[o]!==n.after[o])return!0;return!1}}function k(e,t,i){const n=t.startLineNumber;let o=t.endLineNumber;if(1===t.endColumn&&o--,n>=o)return null;const s=[];for(let a=n;a<=o;a++)s.push(e.getLineContent(a));let r=s.slice(0);return r.sort(x.getCollator().compare),!0===i&&(r=r.reverse()),{startLineNumber:n,endLineNumber:o,before:s,after:r}}x._COLLATOR=null;var I=i(51413),D=i(35155);class N extends s.ks{constructor(e,t){super(t),this.down=e}run(e,t){if(!t.hasModel())return;const i=t.getSelections().map(((e,t)=>({selection:e,index:t,ignore:!1})));i.sort(((e,t)=>h.Q.compareRangesUsingStarts(e.selection,t.selection)));let n=i[0];for(let s=1;s<i.length;s++){const e=i[s];n.selection.endLineNumber===e.selection.startLineNumber&&(n.index<e.index?e.ignore=!0:(n.ignore=!0,n=e))}const o=[];for(const s of i)o.push(new p(s.selection,this.down,s.ignore));t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class R extends s.ks{constructor(){super({id:"editor.action.duplicateSelection",label:I.kg("duplicateSelection","Duplicate Selection"),alias:"Duplicate Selection",precondition:g.R.writable,menuOpts:{menuId:D.D8.MenubarSelectionMenu,group:"2_line",title:I.kg({key:"miDuplicateSelection",comment:["&& denotes a mnemonic"]},"&&Duplicate Selection"),order:5}})}run(e,t,i){if(!t.hasModel())return;const n=[],o=t.getSelections(),s=t.getModel();for(const a of o)if(a.isEmpty())n.push(new p(a,!0));else{const e=new u.L(a.endLineNumber,a.endColumn,a.endLineNumber,a.endColumn);n.push(new r.tA(e,s.getValueInRange(a)))}t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class M extends s.ks{constructor(e,t){super(t),this.down=e}run(e,t){const i=e.get(_.JZ),n=[],o=t.getSelections()||[],s=t.getOption(12);for(const r of o)n.push(new L(r,this.down,s,i));t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class P extends s.ks{constructor(e,t){super(t),this.descending=e}run(e,t){const i=t.getSelections()||[];for(const o of i)if(!x.canRun(t.getModel(),o,this.descending))return;const n=[];for(let o=0,s=i.length;o<s;o++)n[o]=new x(i[o],this.descending);t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class T extends s.ks{constructor(){super({id:"editor.action.removeDuplicateLines",label:I.kg("lines.deleteDuplicates","Delete Duplicate Lines"),alias:"Delete Duplicate Lines",precondition:g.R.writable})}run(e,t){if(!t.hasModel())return;const i=t.getModel();if(1===i.getLineCount()&&1===i.getLineMaxColumn(1))return;const n=[],o=[];let s=0;for(const r of t.getSelections()){const e=new Set,t=[];for(let n=r.startLineNumber;n<=r.endLineNumber;n++){const o=i.getLineContent(n);e.has(o)||(t.push(o),e.add(o))}const a=new u.L(r.startLineNumber,1,r.endLineNumber,i.getLineMaxColumn(r.endLineNumber)),l=r.startLineNumber-s,d=new u.L(l,1,l+t.length-1,t[t.length-1].length);n.push(c.k.replace(a,t.join("\n"))),o.push(d),s+=r.endLineNumber-r.startLineNumber+1-t.length}t.pushUndoStop(),t.executeEdits(this.id,n,o),t.pushUndoStop()}}class O extends s.ks{constructor(){super({id:O.ID,label:I.kg("lines.trimTrailingWhitespace","Trim Trailing Whitespace"),alias:"Trim Trailing Whitespace",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:(0,n.m5)(2089,2102),weight:100}})}run(e,t,i){let n=[];"auto-save"===i.reason&&(n=(t.getSelections()||[]).map((e=>new d.y(e.positionLineNumber,e.positionColumn))));const o=t.getSelection();if(null===o)return;const s=new a.d(o,n);t.pushUndoStop(),t.executeCommands(this.id,[s]),t.pushUndoStop()}}O.ID="editor.action.trimTrailingWhitespace";class A extends s.ks{constructor(){super({id:"editor.action.deleteLines",label:I.kg("lines.delete","Delete Line"),alias:"Delete Line",precondition:g.R.writable,kbOpts:{kbExpr:g.R.textInputFocus,primary:3113,weight:100}})}run(e,t){if(!t.hasModel())return;const i=this._getLinesToRemove(t),n=t.getModel();if(1===n.getLineCount()&&1===n.getLineMaxColumn(1))return;let o=0;const s=[],r=[];for(let a=0,l=i.length;a<l;a++){const e=i[a];let t=e.startLineNumber,l=e.endLineNumber,d=1,h=n.getLineMaxColumn(l);l<n.getLineCount()?(l+=1,h=1):t>1&&(t-=1,d=n.getLineMaxColumn(t)),s.push(c.k.replace(new u.L(t,d,l,h),"")),r.push(new u.L(t-o,e.positionColumn,t-o,e.positionColumn)),o+=e.endLineNumber-e.startLineNumber+1}t.pushUndoStop(),t.executeEdits(this.id,s,r),t.pushUndoStop()}_getLinesToRemove(e){const t=e.getSelections().map((e=>{let t=e.endLineNumber;return e.startLineNumber<e.endLineNumber&&1===e.endColumn&&(t-=1),{startLineNumber:e.startLineNumber,selectionStartColumn:e.selectionStartColumn,endLineNumber:t,positionColumn:e.positionColumn}}));t.sort(((e,t)=>e.startLineNumber===t.startLineNumber?e.endLineNumber-t.endLineNumber:e.startLineNumber-t.startLineNumber));const i=[];let n=t[0];for(let o=1;o<t.length;o++)n.endLineNumber+1>=t[o].startLineNumber?n.endLineNumber=t[o].endLineNumber:(i.push(n),n=t[o]);return i.push(n),i}}class E extends s.ks{constructor(){super({id:"editor.action.indentLines",label:I.kg("lines.indent","Indent Line"),alias:"Indent Line",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:2142,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,l.TK.indent(i.cursorConfig,t.getModel(),t.getSelections())),t.pushUndoStop())}}class H extends s.ks{constructor(){super({id:"editor.action.outdentLines",label:I.kg("lines.outdent","Outdent Line"),alias:"Outdent Line",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:2140,weight:100}})}run(e,t){o.Yh.Outdent.runEditorCommand(e,t,null)}}class F extends s.ks{constructor(){super({id:"editor.action.insertLineBefore",label:I.kg("lines.insertBefore","Insert Line Above"),alias:"Insert Line Above",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:3075,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,l.TK.lineInsertBefore(i.cursorConfig,t.getModel(),t.getSelections())))}}class W extends s.ks{constructor(){super({id:"editor.action.insertLineAfter",label:I.kg("lines.insertAfter","Insert Line Below"),alias:"Insert Line Below",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:2051,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,l.TK.lineInsertAfter(i.cursorConfig,t.getModel(),t.getSelections())))}}class V extends s.ks{run(e,t){if(!t.hasModel())return;const i=t.getSelection(),n=this._getRangesToDelete(t),o=[];for(let a=0,l=n.length-1;a<l;a++){const e=n[a],t=n[a+1];null===h.Q.intersectRanges(e,t)?o.push(e):n[a+1]=h.Q.plusRange(e,t)}o.push(n[n.length-1]);const s=this._getEndCursorState(i,o),r=o.map((e=>c.k.replace(e,"")));t.pushUndoStop(),t.executeEdits(this.id,r,s),t.pushUndoStop()}}class U extends s.ks{constructor(){super({id:"editor.action.joinLines",label:I.kg("lines.joinLines","Join Lines"),alias:"Join Lines",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}run(e,t){const i=t.getSelections();if(null===i)return;let n=t.getSelection();if(null===n)return;i.sort(h.Q.compareRangesUsingStarts);const o=[],s=i.reduce(((e,t)=>e.isEmpty()?e.endLineNumber===t.startLineNumber?(n.equalsSelection(e)&&(n=t),t):t.startLineNumber>e.endLineNumber+1?(o.push(e),t):new u.L(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn):t.startLineNumber>e.endLineNumber?(o.push(e),t):new u.L(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn)));o.push(s);const r=t.getModel();if(null===r)return;const a=[],l=[];let d=n,g=0;for(let p=0,m=o.length;p<m;p++){const e=o[p],t=e.startLineNumber,i=1;let s,m,v=0;const f=r.getLineLength(e.endLineNumber)-e.endColumn;if(e.isEmpty()||e.startLineNumber===e.endLineNumber){const i=e.getStartPosition();i.lineNumber<r.getLineCount()?(s=t+1,m=r.getLineMaxColumn(s)):(s=i.lineNumber,m=r.getLineMaxColumn(i.lineNumber))}else s=e.endLineNumber,m=r.getLineMaxColumn(s);let _=r.getLineContent(t);for(let n=t+1;n<=s;n++){const e=r.getLineContent(n),t=r.getLineFirstNonWhitespaceColumn(n);if(t>=1){let i=!0;""===_&&(i=!1),!i||" "!==_.charAt(_.length-1)&&"\t"!==_.charAt(_.length-1)||(i=!1,_=_.replace(/[\s\uFEFF\xA0]+$/g," "));const n=e.substr(t-1);_+=(i?" ":"")+n,v=i?n.length+1:n.length}else v=0}const b=new h.Q(t,i,s,m);if(!b.isEmpty()){let i;e.isEmpty()?(a.push(c.k.replace(b,_)),i=new u.L(b.startLineNumber-g,_.length-v+1,t-g,_.length-v+1)):e.startLineNumber===e.endLineNumber?(a.push(c.k.replace(b,_)),i=new u.L(e.startLineNumber-g,e.startColumn,e.endLineNumber-g,e.endColumn)):(a.push(c.k.replace(b,_)),i=new u.L(e.startLineNumber-g,e.startColumn,e.startLineNumber-g,_.length-f)),null!==h.Q.intersectRanges(b,n)?d=i:l.push(i)}g+=b.endLineNumber-b.startLineNumber}l.unshift(d),t.pushUndoStop(),t.executeEdits(this.id,a,l),t.pushUndoStop()}}class z extends s.ks{constructor(){super({id:"editor.action.transpose",label:I.kg("editor.transpose","Transpose Characters around the Cursor"),alias:"Transpose Characters around the Cursor",precondition:g.R.writable})}run(e,t){const i=t.getSelections();if(null===i)return;const n=t.getModel();if(null===n)return;const o=[];for(let s=0,a=i.length;s<a;s++){const e=i[s];if(!e.isEmpty())continue;const t=e.getStartPosition(),a=n.getLineMaxColumn(t.lineNumber);if(t.column>=a){if(t.lineNumber===n.getLineCount())continue;const e=new h.Q(t.lineNumber,Math.max(1,t.column-1),t.lineNumber+1,1),i=n.getValueInRange(e).split("").reverse().join("");o.push(new r.iu(new u.L(t.lineNumber,Math.max(1,t.column-1),t.lineNumber+1,1),i))}else{const e=new h.Q(t.lineNumber,Math.max(1,t.column-1),t.lineNumber,t.column+1),i=n.getValueInRange(e).split("").reverse().join("");o.push(new r.ui(e,i,new u.L(t.lineNumber,t.column+1,t.lineNumber,t.column+1)))}}t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class B extends s.ks{run(e,t){const i=t.getSelections();if(null===i)return;const n=t.getModel();if(null===n)return;const o=t.getOption(129),s=[];for(const r of i)if(r.isEmpty()){const e=r.getStartPosition(),i=t.getConfiguredWordAtPosition(e);if(!i)continue;const a=new h.Q(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn),l=n.getValueInRange(a);s.push(c.k.replace(a,this._modifyText(l,o)))}else{const e=n.getValueInRange(r);s.push(c.k.replace(r,this._modifyText(e,o)))}t.pushUndoStop(),t.executeEdits(this.id,s),t.pushUndoStop()}}class j{constructor(e,t){this._pattern=e,this._flags=t,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch(e){}}return this._actual}isSupported(){return null!==this.get()}}class K extends B{constructor(){super({id:"editor.action.transformToTitlecase",label:I.kg("editor.transformToTitlecase","Transform to Title Case"),alias:"Transform to Title Case",precondition:g.R.writable})}_modifyText(e,t){const i=K.titleBoundary.get();return i?e.toLocaleLowerCase().replace(i,(e=>e.toLocaleUpperCase())):e}}K.titleBoundary=new j("(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}","gmu");class Q extends B{constructor(){super({id:"editor.action.transformToSnakecase",label:I.kg("editor.transformToSnakecase","Transform to Snake Case"),alias:"Transform to Snake Case",precondition:g.R.writable})}_modifyText(e,t){const i=Q.caseBoundary.get(),n=Q.singleLetters.get();return i&&n?e.replace(i,"$1_$2").replace(n,"$1_$2$3").toLocaleLowerCase():e}}Q.caseBoundary=new j("(\\p{Ll})(\\p{Lu})","gmu"),Q.singleLetters=new j("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu");class q extends B{constructor(){super({id:"editor.action.transformToCamelcase",label:I.kg("editor.transformToCamelcase","Transform to Camel Case"),alias:"Transform to Camel Case",precondition:g.R.writable})}_modifyText(e,t){const i=q.wordBoundary.get();if(!i)return e;const n=e.split(i);return n.shift()+n.map((e=>e.substring(0,1).toLocaleUpperCase()+e.substring(1))).join("")}}q.wordBoundary=new j("[_\\s-]","gm");class G extends B{static isSupported(){return[this.caseBoundary,this.singleLetters,this.underscoreBoundary].every((e=>e.isSupported()))}constructor(){super({id:"editor.action.transformToKebabcase",label:I.kg("editor.transformToKebabcase","Transform to Kebab Case"),alias:"Transform to Kebab Case",precondition:g.R.writable})}_modifyText(e,t){const i=G.caseBoundary.get(),n=G.singleLetters.get(),o=G.underscoreBoundary.get();return i&&n&&o?e.replace(o,"$1-$3").replace(i,"$1-$2").replace(n,"$1-$2").toLocaleLowerCase():e}}G.caseBoundary=new j("(\\p{Ll})(\\p{Lu})","gmu"),G.singleLetters=new j("(\\p{Lu}|\\p{N})(\\p{Lu}\\p{Ll})","gmu"),G.underscoreBoundary=new j("(\\S)(_)(\\S)","gm"),(0,s.Fl)(class extends N{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:I.kg("lines.copyUp","Copy Line Up"),alias:"Copy Line Up",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:D.D8.MenubarSelectionMenu,group:"2_line",title:I.kg({key:"miCopyLinesUp",comment:["&& denotes a mnemonic"]},"&&Copy Line Up"),order:1}})}}),(0,s.Fl)(class extends N{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:I.kg("lines.copyDown","Copy Line Down"),alias:"Copy Line Down",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:D.D8.MenubarSelectionMenu,group:"2_line",title:I.kg({key:"miCopyLinesDown",comment:["&& denotes a mnemonic"]},"Co&&py Line Down"),order:2}})}}),(0,s.Fl)(R),(0,s.Fl)(class extends M{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:I.kg("lines.moveUp","Move Line Up"),alias:"Move Line Up",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:D.D8.MenubarSelectionMenu,group:"2_line",title:I.kg({key:"miMoveLinesUp",comment:["&& denotes a mnemonic"]},"Mo&&ve Line Up"),order:3}})}}),(0,s.Fl)(class extends M{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:I.kg("lines.moveDown","Move Line Down"),alias:"Move Line Down",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:D.D8.MenubarSelectionMenu,group:"2_line",title:I.kg({key:"miMoveLinesDown",comment:["&& denotes a mnemonic"]},"Move &&Line Down"),order:4}})}}),(0,s.Fl)(class extends P{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:I.kg("lines.sortAscending","Sort Lines Ascending"),alias:"Sort Lines Ascending",precondition:g.R.writable})}}),(0,s.Fl)(class extends P{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:I.kg("lines.sortDescending","Sort Lines Descending"),alias:"Sort Lines Descending",precondition:g.R.writable})}}),(0,s.Fl)(T),(0,s.Fl)(O),(0,s.Fl)(A),(0,s.Fl)(E),(0,s.Fl)(H),(0,s.Fl)(F),(0,s.Fl)(W),(0,s.Fl)(class extends V{constructor(){super({id:"deleteAllLeft",label:I.kg("lines.deleteAllLeft","Delete All Left"),alias:"Delete All Left",precondition:g.R.writable,kbOpts:{kbExpr:g.R.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}_getEndCursorState(e,t){let i=null;const n=[];let o=0;return t.forEach((t=>{let s;if(1===t.endColumn&&o>0){const e=t.startLineNumber-o;s=new u.L(e,t.startColumn,e,t.startColumn)}else s=new u.L(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn);o+=t.endLineNumber-t.startLineNumber,t.intersectRanges(e)?i=s:n.push(s)})),i&&n.unshift(i),n}_getRangesToDelete(e){const t=e.getSelections();if(null===t)return[];let i=t;const n=e.getModel();return null===n?[]:(i.sort(h.Q.compareRangesUsingStarts),i=i.map((e=>{if(e.isEmpty()){if(1===e.startColumn){const t=Math.max(1,e.startLineNumber-1),i=1===e.startLineNumber?1:n.getLineLength(t)+1;return new h.Q(t,i,e.startLineNumber,1)}return new h.Q(e.startLineNumber,1,e.startLineNumber,e.startColumn)}return new h.Q(e.startLineNumber,1,e.endLineNumber,e.endColumn)})),i)}}),(0,s.Fl)(class extends V{constructor(){super({id:"deleteAllRight",label:I.kg("lines.deleteAllRight","Delete All Right"),alias:"Delete All Right",precondition:g.R.writable,kbOpts:{kbExpr:g.R.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}_getEndCursorState(e,t){let i=null;const n=[];for(let o=0,s=t.length,r=0;o<s;o++){const s=t[o],a=new u.L(s.startLineNumber-r,s.startColumn,s.startLineNumber-r,s.startColumn);s.intersectRanges(e)?i=a:n.push(a)}return i&&n.unshift(i),n}_getRangesToDelete(e){const t=e.getModel();if(null===t)return[];const i=e.getSelections();if(null===i)return[];const n=i.map((e=>{if(e.isEmpty()){const i=t.getLineMaxColumn(e.startLineNumber);return e.startColumn===i?new h.Q(e.startLineNumber,e.startColumn,e.startLineNumber+1,1):new h.Q(e.startLineNumber,e.startColumn,e.startLineNumber,i)}return e}));return n.sort(h.Q.compareRangesUsingStarts),n}}),(0,s.Fl)(U),(0,s.Fl)(z),(0,s.Fl)(class extends B{constructor(){super({id:"editor.action.transformToUppercase",label:I.kg("editor.transformToUppercase","Transform to Uppercase"),alias:"Transform to Uppercase",precondition:g.R.writable})}_modifyText(e,t){return e.toLocaleUpperCase()}}),(0,s.Fl)(class extends B{constructor(){super({id:"editor.action.transformToLowercase",label:I.kg("editor.transformToLowercase","Transform to Lowercase"),alias:"Transform to Lowercase",precondition:g.R.writable})}_modifyText(e,t){return e.toLocaleLowerCase()}}),Q.caseBoundary.isSupported()&&Q.singleLetters.isSupported()&&(0,s.Fl)(Q),q.wordBoundary.isSupported()&&(0,s.Fl)(q),K.titleBoundary.isSupported()&&(0,s.Fl)(K),G.isSupported()&&(0,s.Fl)(G)},15259:(e,t,i)=>{var n,o=i(61498),s=i(73990),r=i(25143),a=i(57397),l=i(29591),c=i(48250),d=i(87766),h=i(12780),u=i(97072),g=i(30050),p=i(32101),m=i(23525),v=i(99005),f=i(72330),_=i(15739),b=i(80158),C=i(51413),w=i(39686),y=i(63910),S=i(68010),L=i(50044),x=i(40997),k=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},I=function(e,t){return function(i,n){t(i,n,e)}},D=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};const N=new w.N1("LinkedEditingInputVisible",!1);let R=n=class extends d.jG{static get(e){return e.getContribution(n.ID)}constructor(e,t,i,n,o){super(),this.languageConfigurationService=n,this._syncRangesToken=0,this._localToDispose=this._register(new d.Cm),this._editor=e,this._providers=i.linkedEditingRangeProvider,this._enabled=!1,this._visibleContextKey=N.bindTo(t),this._debounceInformation=o.for(this._providers,"Linked Editing",{max:200}),this._currentDecorations=this._editor.createDecorationsCollection(),this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new d.Cm),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequest=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel((()=>this.reinitialize(!0)))),this._register(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(69)||e.hasChanged(92))&&this.reinitialize(!1)}))),this._register(this._providers.onDidChange((()=>this.reinitialize(!1)))),this._register(this._editor.onDidChangeModelLanguage((()=>this.reinitialize(!0)))),this.reinitialize(!0)}reinitialize(e){const t=this._editor.getModel(),i=null!==t&&(this._editor.getOption(69)||this._editor.getOption(92))&&this._providers.has(t);if(i===this._enabled&&!e)return;if(this._enabled=i,this.clearRanges(),this._localToDispose.clear(),!i||null===t)return;this._localToDispose.add(c.Jh.runAndSubscribe(t.onDidChangeLanguageConfiguration,(()=>{this._languageWordPattern=this.languageConfigurationService.getLanguageConfiguration(t.getLanguageId()).getWordDefinition()})));const n=new s.ve(this._debounceInformation.get(t)),o=()=>{var e;this._rangeUpdateTriggerPromise=n.trigger((()=>this.updateRanges()),null!==(e=this._debounceDuration)&&void 0!==e?e:this._debounceInformation.get(t))},r=new s.ve(0),a=e=>{this._rangeSyncTriggerPromise=r.trigger((()=>this._syncRanges(e)))};this._localToDispose.add(this._editor.onDidChangeCursorPosition((()=>{o()}))),this._localToDispose.add(this._editor.onDidChangeModelContent((e=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const t=this._currentDecorations.getRange(0);if(t&&e.changes.every((e=>t.intersectRanges(e.range))))return void a(this._syncRangesToken)}o()}))),this._localToDispose.add({dispose:()=>{n.dispose(),r.dispose()}}),this.updateRanges()}_syncRanges(e){if(!this._editor.hasModel()||e!==this._syncRangesToken||0===this._currentDecorations.length)return;const t=this._editor.getModel(),i=this._currentDecorations.getRange(0);if(!i||i.startLineNumber!==i.endLineNumber)return this.clearRanges();const n=t.getValueInRange(i);if(this._currentWordPattern){const e=n.match(this._currentWordPattern);if((e?e[0].length:0)!==n.length)return this.clearRanges()}const o=[];for(let s=1,r=this._currentDecorations.length;s<r;s++){const e=this._currentDecorations.getRange(s);if(e)if(e.startLineNumber!==e.endLineNumber)o.push({range:e,text:n});else{let i=t.getValueInRange(e),s=n,r=e.startColumn,a=e.endColumn;const l=h.Qp(i,s);r+=l,i=i.substr(l),s=s.substr(l);const c=h.Vi(i,s);a-=c,i=i.substr(0,i.length-c),s=s.substr(0,s.length-c),r===a&&0===s.length||o.push({range:new v.Q(e.startLineNumber,r,e.endLineNumber,a),text:s})}}if(0!==o.length)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const e=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",o),this._editor._getViewModel().setPrevEditOperationType(e)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations.clear(),this._currentRequest&&(this._currentRequest.cancel(),this._currentRequest=null,this._currentRequestPosition=null)}updateRanges(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return D(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return void this.clearRanges();const t=this._editor.getPosition();if(!this._enabled&&!e||this._editor.getSelections().length>1)return void this.clearRanges();const i=this._editor.getModel(),o=i.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===o){if(t.equals(this._currentRequestPosition))return;if(this._currentDecorations.length>0){const e=this._currentDecorations.getRange(0);if(e&&e.containsPosition(t))return}}this.clearRanges(),this._currentRequestPosition=t,this._currentRequestModelVersion=o;const r=(0,s.SS)((e=>D(this,void 0,void 0,(function*(){try{const s=new x.W(!1),a=yield T(this._providers,i,t,e);if(this._debounceInformation.update(i,s.elapsed()),r!==this._currentRequest)return;if(this._currentRequest=null,o!==i.getVersionId())return;let l=[];(null===a||void 0===a?void 0:a.ranges)&&(l=a.ranges),this._currentWordPattern=(null===a||void 0===a?void 0:a.wordPattern)||this._languageWordPattern;let c=!1;for(let e=0,i=l.length;e<i;e++)if(v.Q.containsPosition(l[e],t)){if(c=!0,0!==e){const t=l[e];l.splice(e,1),l.unshift(t)}break}if(!c)return void this.clearRanges();const d=l.map((e=>({range:e,options:n.DECORATION})));this._visibleContextKey.set(!0),this._currentDecorations.set(d),this._syncRangesToken++}catch(s){(0,l.MB)(s)||(0,l.dz)(s),this._currentRequest!==r&&this._currentRequest||this.clearRanges()}}))));return this._currentRequest=r,r}))}};R.ID="editor.contrib.linkedEditing",R.DECORATION=_.kI.register({description:"linked-editing",stickiness:0,className:"linked-editing-decoration"}),R=n=k([I(1,w.fN),I(2,y.u),I(3,b.JZ),I(4,L.U)],R);class M extends g.ks{constructor(){super({id:"editor.action.linkedEditing",label:C.kg("linkedEditing.label","Start Linked Editing"),alias:"Start Linked Editing",precondition:w.M$.and(f.R.writable,f.R.hasRenameProvider),kbOpts:{kbExpr:f.R.editorTextFocus,primary:3132,weight:100}})}runCommand(e,t){const i=e.get(p.T),[n,o]=Array.isArray(t)&&t||[void 0,void 0];return u.r.isUri(n)&&m.y.isIPosition(o)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then((e=>{e&&(e.setPosition(o),e.invokeWithinContext((t=>(this.reportTelemetry(t,e),this.run(t,e)))))}),l.dz):super.runCommand(e,t)}run(e,t){const i=R.get(t);return i?Promise.resolve(i.updateRanges(!0)):Promise.resolve()}}const P=g.DX.bindToContribution(R.get);function T(e,t,i,n){const r=e.ordered(t);return(0,s.$1)(r.map((e=>()=>D(this,void 0,void 0,(function*(){try{return yield e.provideLinkedEditingRanges(t,i,n)}catch(o){return void(0,l.M_)(o)}})))),(e=>!!e&&o.EI(null===e||void 0===e?void 0:e.ranges)))}(0,g.E_)(new P({id:"cancelLinkedEditingInput",precondition:N,handler:e=>e.clearRanges(),kbOpts:{kbExpr:f.R.editorTextFocus,weight:199,primary:9,secondary:[1033]}}));(0,S.x1A)("editor.linkedEditingBackground",{dark:a.Q1.fromHex("#f00").transparent(.3),light:a.Q1.fromHex("#f00").transparent(.3),hcDark:a.Q1.fromHex("#f00").transparent(.3),hcLight:a.Q1.white},C.kg("editorLinkedEditingBackground","Background color when the editor auto renames on type."));(0,g.ke)("_executeLinkedEditingProvider",((e,t,i)=>{const{linkedEditingRangeProvider:n}=e.get(y.u);return T(n,t,i,r.X.None)})),(0,g.HW)(R.ID,R,1),(0,g.Fl)(M)},25614:(e,t,i)=>{var n=i(73990),o=i(25143),s=i(29591),r=i(58348),a=i(87766),l=i(83888),c=i(66731),d=i(53059),h=i(40997),u=i(97072),g=i(30050),p=i(15739),m=i(50044),v=i(63910),f=i(59183),_=i(61498),b=i(32031),C=i(99005),w=i(21950),y=i(39587),S=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};class L{constructor(e,t){this._link=e,this._provider=t}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}resolve(e){return S(this,void 0,void 0,(function*(){return this._link.url?this._link.url:"function"===typeof this._provider.resolveLink?Promise.resolve(this._provider.resolveLink(this._link,e)).then((t=>(this._link=t||this._link,this._link.url?this.resolve(e):Promise.reject(new Error("missing"))))):Promise.reject(new Error("missing"))}))}}class x{constructor(e){this._disposables=new a.Cm;let t=[];for(const[i,n]of e){const e=i.links.map((e=>new L(e,n)));t=x._union(t,e),(0,a.Xm)(i)&&this._disposables.add(i)}this.links=t}dispose(){this._disposables.dispose(),this.links.length=0}static _union(e,t){const i=[];let n,o,s,r;for(n=0,s=0,o=e.length,r=t.length;n<o&&s<r;){const o=e[n],r=t[s];if(C.Q.areIntersectingOrTouching(o.range,r.range)){n++;continue}C.Q.compareRangesUsingStarts(o.range,r.range)<0?(i.push(o),n++):(i.push(r),s++)}for(;n<o;n++)i.push(e[n]);for(;s<r;s++)i.push(t[s]);return i}}function k(e,t,i){const n=[],o=e.ordered(t).reverse().map(((e,o)=>Promise.resolve(e.provideLinks(t,i)).then((t=>{t&&(n[o]=[t,e])}),s.M_)));return Promise.all(o).then((()=>{const e=new x((0,_.Yc)(n));return i.isCancellationRequested?(e.dispose(),new x([])):e}))}y.w.registerCommand("_executeLinkProvider",(function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return S(void 0,void 0,void 0,(function*(){let[t,n]=i;(0,b.j)(t instanceof u.r),"number"!==typeof n&&(n=0);const{linkProvider:s}=e.get(v.u),r=e.get(w.S).getModel(t);if(!r)return[];const a=yield k(s,r,o.X.None);if(!a)return[];for(let e=0;e<Math.min(n,a.links.length);e++)yield a.links[e].resolve(o.X.None);const l=a.links.slice(0);return a.dispose(),l}))}));var I,D=i(51413),N=i(39895),R=i(2531),M=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},P=function(e,t){return function(i,n){t(i,n,e)}},T=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};let O=I=class extends a.jG{static get(e){return e.getContribution(I.ID)}constructor(e,t,i,o,s){super(),this.editor=e,this.openerService=t,this.notificationService=i,this.languageFeaturesService=o,this.providers=this.languageFeaturesService.linkProvider,this.debounceInformation=s.for(this.providers,"Links",{min:1e3,max:4e3}),this.computeLinks=this._register(new n.uC((()=>this.computeLinksNow()),1e3)),this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null;const r=this._register(new f.gi(e));this._register(r.onMouseMoveOrRelevantKeyDown((e=>{let[t,i]=e;this._onEditorMouseMove(t,i)}))),this._register(r.onExecute((e=>{this.onEditorMouseUp(e)}))),this._register(r.onCancel((e=>{this.cleanUpActiveLinkDecoration()}))),this._register(e.onDidChangeConfiguration((e=>{e.hasChanged(70)&&(this.updateDecorations([]),this.stop(),this.computeLinks.schedule(0))}))),this._register(e.onDidChangeModelContent((e=>{this.editor.hasModel()&&this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()))}))),this._register(e.onDidChangeModel((e=>{this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.computeLinks.schedule(0)}))),this._register(e.onDidChangeModelLanguage((e=>{this.stop(),this.computeLinks.schedule(0)}))),this._register(this.providers.onDidChange((e=>{this.stop(),this.computeLinks.schedule(0)}))),this.computeLinks.schedule(0)}computeLinksNow(){return T(this,void 0,void 0,(function*(){if(!this.editor.hasModel()||!this.editor.getOption(70))return;const e=this.editor.getModel();if(!e.isTooLargeForSyncing()&&this.providers.has(e)){this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=(0,n.SS)((t=>k(this.providers,e,t)));try{const t=new h.W(!1);if(this.activeLinksList=yield this.computePromise,this.debounceInformation.update(e,t.elapsed()),e.isDisposed())return;this.updateDecorations(this.activeLinksList.links)}catch(t){(0,s.dz)(t)}finally{this.computePromise=null}}}))}updateDecorations(e){const t="altKey"===this.editor.getOption(77),i=[],n=Object.keys(this.currentOccurrences);for(const s of n){const e=this.currentOccurrences[s];i.push(e.decorationId)}const o=[];if(e)for(const s of e)o.push(E.decoration(s,t));this.editor.changeDecorations((t=>{const n=t.deltaDecorations(i,o);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let i=0,o=n.length;i<o;i++){const t=new E(e[i],n[i]);this.currentOccurrences[t.decorationId]=t}}))}_onEditorMouseMove(e,t){const i="altKey"===this.editor.getOption(77);if(this.isEnabled(e,t)){this.cleanUpActiveLinkDecoration();const t=this.getLinkOccurrence(e.target.position);t&&this.editor.changeDecorations((e=>{t.activate(e,i),this.activeLinkDecorationId=t.decorationId}))}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const e="altKey"===this.editor.getOption(77);if(this.activeLinkDecorationId){const t=this.currentOccurrences[this.activeLinkDecorationId];t&&this.editor.changeDecorations((i=>{t.deactivate(i,e)})),this.activeLinkDecorationId=null}}onEditorMouseUp(e){if(!this.isEnabled(e))return;const t=this.getLinkOccurrence(e.target.position);t&&this.openLinkOccurrence(t,e.hasSideBySideModifier,!0)}openLinkOccurrence(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.openerService)return;const{link:n}=e;n.resolve(o.X.None).then((e=>{if("string"===typeof e&&this.editor.hasModel()){const t=this.editor.getModel().uri;if(t.scheme===l.ny.file&&e.startsWith("".concat(l.ny.file,":"))){const i=u.r.parse(e);if(i.scheme===l.ny.file){const n=d.su(i);let o=null;n.startsWith("/./")?o=".".concat(n.substr(1)):n.startsWith("//./")&&(o=".".concat(n.substr(2))),o&&(e=d.uJ(t,o))}}}return this.openerService.open(e,{openToSide:t,fromUserGesture:i,allowContributedOpeners:!0,allowCommands:!0,fromWorkspace:!0})}),(e=>{const t=e instanceof Error?e.message:e;"invalid"===t?this.notificationService.warn(D.kg("invalid.url","Failed to open this link because it is not well-formed: {0}",n.url.toString())):"missing"===t?this.notificationService.warn(D.kg("missing.url","Failed to open this link because its target is missing.")):(0,s.dz)(e)}))}getLinkOccurrence(e){if(!this.editor.hasModel()||!e)return null;const t=this.editor.getModel().getDecorationsInRange({startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},0,!0);for(const i of t){const e=this.currentOccurrences[i.id];if(e)return e}return null}isEnabled(e,t){return Boolean(6===e.target.type&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey))}stop(){var e;this.computeLinks.cancel(),this.activeLinksList&&(null===(e=this.activeLinksList)||void 0===e||e.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop()}};O.ID="editor.linkDetector",O=I=M([P(1,R.Cr),P(2,N.Ot),P(3,v.u),P(4,m.U)],O);const A={general:p.kI.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),active:p.kI.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"})};class E{static decoration(e,t){return{range:e.range,options:E._getOptions(e,t,!1)}}static _getOptions(e,t,i){const n=Object.assign({},i?A.active:A.general);return n.hoverMessage=function(e,t){const i=e.url&&/^command:/i.test(e.url.toString()),n=e.tooltip?e.tooltip:i?D.kg("links.navigate.executeCmd","Execute command"):D.kg("links.navigate.follow","Follow link"),o=t?c.zx?D.kg("links.navigate.kb.meta.mac","cmd + click"):D.kg("links.navigate.kb.meta","ctrl + click"):c.zx?D.kg("links.navigate.kb.alt.mac","option + click"):D.kg("links.navigate.kb.alt","alt + click");if(e.url){let t="";if(/^command:/i.test(e.url.toString())){const i=e.url.toString().match(/^command:([^?#]+)/);if(i){const e=i[1];t=D.kg("tooltip.explanation","Execute command {0}",e)}}return new r.Bc("",!0).appendLink(e.url.toString(!0).replace(/ /g,"%20"),n,t).appendMarkdown(" (".concat(o,")"))}return(new r.Bc).appendText("".concat(n," (").concat(o,")"))}(e,t),n}constructor(e,t){this.link=e,this.decorationId=t}activate(e,t){e.changeDecorationOptions(this.decorationId,E._getOptions(this.link,t,!0))}deactivate(e,t){e.changeDecorationOptions(this.decorationId,E._getOptions(this.link,t,!1))}}class H extends g.ks{constructor(){super({id:"editor.action.openLink",label:D.kg("label","Open Link"),alias:"Open Link",precondition:void 0})}run(e,t){const i=O.get(t);if(!i)return;if(!t.hasModel())return;const n=t.getSelections();for(const o of n){const e=i.getLinkOccurrence(o.getEndPosition());e&&i.openLinkOccurrence(e,!1)}}}(0,g.HW)(O.ID,O,1),(0,g.Fl)(H)}}]);
//# sourceMappingURL=monaco-editor-vendor.dbdc571d.ad7cea43.js.map