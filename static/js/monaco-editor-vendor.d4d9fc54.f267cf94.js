"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[452],{79267:(e,t,i)=>{i.d(t,{PA:()=>o,Vl:()=>s,Wt:()=>n});const n="editor.action.inlineSuggest.commit",s="editor.action.inlineSuggest.showPrevious",o="editor.action.inlineSuggest.showNext"},68372:(e,t,i)=>{i.d(t,{AL:()=>u,Vs:()=>c,x9:()=>h,xD:()=>a,yP:()=>d});var n=i(61498),s=i(12780),o=i(23525),r=i(99005),l=i(94019);class a{constructor(e,t){this.lineNumber=e,this.parts=t}equals(e){return this.lineNumber===e.lineNumber&&this.parts.length===e.parts.length&&this.parts.every(((t,i)=>t.equals(e.parts[i])))}renderForScreenReader(e){if(0===this.parts.length)return"";const t=this.parts[this.parts.length-1],i=e.substr(0,t.column-1);return new l.mF([...this.parts.map((e=>new l.WR(r.Q.fromPositions(new o.y(1,e.column)),e.lines.join("\n"))))]).applyToString(i).substring(this.parts[0].column-1)}isEmpty(){return this.parts.every((e=>0===e.lines.length))}get lineCount(){return 1+this.parts.reduce(((e,t)=>e+t.lines.length-1),0)}}class d{constructor(e,t,i){this.column=e,this.text=t,this.preview=i,this.lines=(0,s.uz)(this.text)}equals(e){return this.column===e.column&&this.lines.length===e.lines.length&&this.lines.every(((t,i)=>t===e.lines[i]))}}class c{constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.lineNumber=e,this.columnRange=t,this.text=i,this.additionalReservedLineCount=n,this.parts=[new d(this.columnRange.endColumnExclusive,this.text,!1)],this.newLines=(0,s.uz)(this.text)}renderForScreenReader(e){return this.newLines.join("\n")}get lineCount(){return this.newLines.length}isEmpty(){return this.parts.every((e=>0===e.lines.length))}equals(e){return this.lineNumber===e.lineNumber&&this.columnRange.equals(e.columnRange)&&this.newLines.length===e.newLines.length&&this.newLines.every(((t,i)=>t===e.newLines[i]))&&this.additionalReservedLineCount===e.additionalReservedLineCount}}function u(e,t){return(0,n.aI)(e,t,h)}function h(e,t){return e===t||!(!e||!t)&&((e instanceof a&&t instanceof a||e instanceof c&&t instanceof c)&&e.equals(t))}},66131:(e,t,i)=>{i.d(t,{vS:()=>x,PM:()=>S});var n=i(28925),s=i(48250),o=i(87766),r=i(2698),l=i(12780),a=i(30381),d=i(81196),c=i(23525),u=i(99005),h=i(16724),g=i(63970),p=i(32743),m=i(73957),f=i(23033),v=i(98105),b=i(68372),C=i(77313),_=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},w=function(e,t){return function(i,n){t(i,n,e)}};const L="ghost-text";let S=class extends o.jG{constructor(e,t,i){super(),this.editor=e,this.model=t,this.languageService=i,this.isDisposed=(0,r.FY)(this,!1),this.currentTextModel=(0,r.y0)(this.editor.onDidChangeModel,(()=>this.editor.getModel())),this.uiState=(0,r.un)(this,(e=>{if(this.isDisposed.read(e))return;const t=this.currentTextModel.read(e);if(t!==this.model.targetTextModel.read(e))return;const i=this.model.ghostText.read(e);if(!i)return;const n=i instanceof b.Vs?i.columnRange:void 0,s=[],o=[];function r(e,t){if(o.length>0){const i=o[o.length-1];t&&i.decorations.push(new f.d(i.content.length+1,i.content.length+1+e[0].length,t,0)),i.content+=e[0],e=e.slice(1)}for(const i of e)o.push({content:i,decorations:t?[new f.d(1,i.length+1,t,0)]:[]})}const l=t.getLineContent(i.lineNumber);let a,d=0;for(const u of i.parts){let e=u.lines;void 0===a?(s.push({column:u.column,text:e[0],preview:u.preview}),e=e.slice(1)):r([l.substring(d,u.column-1)],void 0),e.length>0&&(r(e,L),void 0===a&&u.column<=l.length&&(a=u.column)),d=u.column-1}void 0!==a&&r([l.substring(d)],void 0);const c=void 0!==a?new C.GM(a,l.length+1):void 0;return{replacedRange:n,inlineTexts:s,additionalLines:o,hiddenRange:c,lineNumber:i.lineNumber,additionalReservedLineCount:this.model.minReservedLineCount.read(e),targetTextModel:t}})),this.decorations=(0,r.un)(this,(e=>{const t=this.uiState.read(e);if(!t)return[];const i=[];t.replacedRange&&i.push({range:t.replacedRange.toRange(t.lineNumber),options:{inlineClassName:"inline-completion-text-to-replace",description:"GhostTextReplacement"}}),t.hiddenRange&&i.push({range:t.hiddenRange.toRange(t.lineNumber),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}});for(const n of t.inlineTexts)i.push({range:u.Q.fromPositions(new c.y(t.lineNumber,n.column)),options:{description:L,after:{content:n.text,inlineClassName:n.preview?"ghost-text-decoration-preview":"ghost-text-decoration",cursorStops:p.VW.Left},showIfCollapsed:!0}});return i})),this.additionalLinesWidget=this._register(new x(this.editor,this.languageService.languageIdCodec,(0,r.un)((e=>{const t=this.uiState.read(e);return t?{lineNumber:t.lineNumber,additionalLines:t.additionalLines,minReservedLineCount:t.additionalReservedLineCount,targetTextModel:t.targetTextModel}:void 0})))),this._register((0,o.s)((()=>{this.isDisposed.set(!0,void 0)}))),this._register((0,C.pY)(this.editor,this.decorations))}ownsViewZone(e){return this.additionalLinesWidget.viewZoneId===e}};S=_([w(2,g.L)],S);class x extends o.jG{get viewZoneId(){return this._viewZoneId}constructor(e,t,i){super(),this.editor=e,this.languageIdCodec=t,this.lines=i,this._viewZoneId=void 0,this.editorOptionsChanged=(0,r.yQ)("editorOptionChanged",s.Jh.filter(this.editor.onDidChangeConfiguration,(e=>e.hasChanged(33)||e.hasChanged(117)||e.hasChanged(99)||e.hasChanged(94)||e.hasChanged(51)||e.hasChanged(50)||e.hasChanged(67)))),this._register((0,r.fm)((e=>{const t=this.lines.read(e);this.editorOptionsChanged.read(e),t?this.updateLines(t.lineNumber,t.additionalLines,t.minReservedLineCount):this.clear()})))}dispose(){super.dispose(),this.clear()}clear(){this.editor.changeViewZones((e=>{this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0)}))}updateLines(e,t,i){const n=this.editor.getModel();if(!n)return;const{tabSize:s}=n.getOptions();this.editor.changeViewZones((n=>{this._viewZoneId&&(n.removeZone(this._viewZoneId),this._viewZoneId=void 0);const o=Math.max(t.length,i);if(o>0){const i=document.createElement("div");!function(e,t,i,n,s){const o=n.get(33),r=n.get(117),c="none",u=n.get(94),g=n.get(51),p=n.get(50),f=n.get(67),b=new h.fe(1e4);b.appendString('<div class="suggest-preview-text">');for(let a=0,h=i.length;a<h;a++){const e=i[a],n=e.content;b.appendString('<div class="view-line'),b.appendString('" style="top:'),b.appendString(String(a*f)),b.appendString('px;width:1000000px;">');const h=l.aC(n),C=l.E_(n),_=m.f.createEmpty(n,s);(0,v.UW)(new v.zL(p.isMonospace&&!o,p.canUseHalfwidthRightwardsArrow,n,!1,h,C,0,_,e.decorations,t,0,p.spaceWidth,p.middotWidth,p.wsmiddotWidth,r,c,u,g!==d.Bc.OFF,null),b),b.appendString("</div>")}b.appendString("</div>"),(0,a.M)(e,p);const C=b.build(),_=y?y.createHTML(C):C;e.innerHTML=_}(i,s,t,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=n.addZone({afterLineNumber:e,heightInLines:o,domNode:i,afterColumnAffinity:1})}}))}}const y=(0,n.H)("editorGhostText",{createHTML:e=>e})},63606:(e,t,i)=>{i.d(t,{p:()=>d});var n=i(2698),s=i(12780),o=i(47221),r=i(39686),l=i(87766),a=i(51413);class d extends l.jG{constructor(e,t){super(),this.contextKeyService=e,this.model=t,this.inlineCompletionVisible=d.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=d.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=d.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService),this.suppressSuggestions=d.suppressSuggestions.bindTo(this.contextKeyService),this._register((0,n.fm)((e=>{const t=this.model.read(e),i=null===t||void 0===t?void 0:t.state.read(e),n=!!(null===i||void 0===i?void 0:i.inlineCompletion)&&void 0!==(null===i||void 0===i?void 0:i.primaryGhostText)&&!(null===i||void 0===i?void 0:i.primaryGhostText.isEmpty());this.inlineCompletionVisible.set(n),(null===i||void 0===i?void 0:i.primaryGhostText)&&(null===i||void 0===i?void 0:i.inlineCompletion)&&this.suppressSuggestions.set(i.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions)}))),this._register((0,n.fm)((e=>{const t=this.model.read(e);let i=!1,n=!0;const r=null===t||void 0===t?void 0:t.primaryGhostText.read(e);if((null===t||void 0===t?void 0:t.selectedSuggestItem)&&r&&r.parts.length>0){const{column:e,lines:l}=r.parts[0],a=l[0];if(e<=t.textModel.getLineIndentColumn(r.lineNumber)){let e=(0,s.HG)(a);-1===e&&(e=a.length-1),i=e>0;const r=t.textModel.getOptions().tabSize;n=o.A.visibleColumnFromColumn(a,e+1,r)<r}}this.inlineCompletionSuggestsIndentation.set(i),this.inlineCompletionSuggestsIndentationLessThanTabSize.set(n)})))}}d.inlineSuggestionVisible=new r.N1("inlineSuggestionVisible",!1,(0,a.kg)("inlineSuggestionVisible","Whether an inline suggestion is visible")),d.inlineSuggestionHasIndentation=new r.N1("inlineSuggestionHasIndentation",!1,(0,a.kg)("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace")),d.inlineSuggestionHasIndentationLessThanTabSize=new r.N1("inlineSuggestionHasIndentationLessThanTabSize",!0,(0,a.kg)("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab")),d.suppressSuggestions=new r.N1("inlineSuggestionSuppressSuggestions",void 0,(0,a.kg)("suppressSuggestions","Whether suggestions should be suppressed for the current suggestion"))},20496:(e,t,i)=>{var n=i(30050),s=i(85287),o=i(2698),r=i(8426),l=i(72330),a=i(79267),d=i(63606),c=i(32605),u=i(82224),h=i(73990),g=i(25143),p=i(29761),m=i(87766),f=i(92210),v=i(32031),b=i(49300),C=i(23525),_=i(50044),w=i(63910),L=i(66131),S=i(17907),x=i(61498),y=i(21457),I=i(29591),k=i(12780),N=i(94597),R=i(99005),T=i(5190),E=i(94019),D=i(35573),M=i(91861),P=i(80158),O=i(68372),A=i(86373),V=i(28070),W=i(67512),F=i(69799),U=i(77313),j=i(57855);async function B(e,t,i,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:g.XO.None,o=arguments.length>5?arguments[5]:void 0;const r=function(e,t){const i=t.getWordAtPosition(e),n=t.getLineMaxColumn(e.lineNumber);return i?new R.Q(e.lineNumber,i.startColumn,e.lineNumber,n):R.Q.fromPositions(e,e.with(void 0,n))}(t,i),l=e.all(i),a=new W.db;for(const h of l)h.groupId&&a.add(h.groupId,h);function d(e){if(!e.yieldsToGroupIds)return[];const t=[];for(const i of e.yieldsToGroupIds||[]){const e=a.get(i);for(const i of e)t.push(i)}return t}const c=new Map,u=new Set;function p(e,t){if(t=[...t,e],u.has(e))return t;u.add(e);try{const i=d(e);for(const e of i){const i=p(e,t);if(i)return i}}finally{u.delete(e)}}function m(e){const o=c.get(e);if(o)return o;const r=p(e,[]);r&&(0,I.M_)(new Error("Inline completions: cyclic yield-to dependency detected. Path: ".concat(r.map((e=>e.toString?e.toString():""+e)).join(" -> "))));const l=new h.Zv;return c.set(e,l.p),(async()=>{if(!r){const t=d(e);for(const e of t){const t=await m(e);if(t&&t.items.length>0)return}}try{return await e.provideInlineCompletions(i,t,n,s)}catch(o){return void(0,I.M_)(o)}})().then((e=>l.complete(e)),(e=>l.error(e))),l.p}const f=await Promise.all(l.map((async e=>({provider:e,completions:await m(e)})))),v=new Map,b=[];for(const h of f){const e=h.completions;if(!e)continue;const t=new Q(e,h.provider);b.push(t);for(const n of e.items){const e=q.from(n,t,r,i,o);v.set(e.hash(),e)}}return new K(Array.from(v.values()),new Set(v.keys()),b)}class K{constructor(e,t,i){this.completions=e,this.hashs=t,this.providerResults=i}has(e){return this.hashs.has(e.hash())}dispose(){for(const e of this.providerResults)e.removeRef()}}class Q{constructor(e,t){this.inlineCompletions=e,this.provider=t,this.refCount=1}addRef(){this.refCount++}removeRef(){this.refCount--,0===this.refCount&&this.provider.freeInlineCompletions(this.inlineCompletions)}}class q{static from(e,t,i,n,s){let o,r,l=e.range?R.Q.lift(e.range):i;if("string"===typeof e.insertText){if(o=e.insertText,s&&e.completeBracketPairs){o=H(o,l.getStartPosition(),n,s);const t=o.length-e.insertText.length;0!==t&&(l=new R.Q(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+t))}r=void 0}else if("snippet"in e.insertText){const t=e.insertText.snippet.length;if(s&&e.completeBracketPairs){e.insertText.snippet=H(e.insertText.snippet,l.getStartPosition(),n,s);const i=e.insertText.snippet.length-t;0!==i&&(l=new R.Q(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+i))}const i=(new j.fr).parse(e.insertText.snippet);1===i.children.length&&i.children[0]instanceof j.EY?(o=i.children[0].value,r=void 0):(o=i.toString(),r={snippet:e.insertText.snippet,range:l})}else(0,V.xb)(e.insertText);return new q(o,e.command,l,o,r,e.additionalTextEdits||(0,U.zk)(),e,t)}constructor(e,t,i,n,s,o,r,l){this.filterText=e,this.command=t,this.range=i,this.insertText=n,this.snippetInfo=s,this.additionalTextEdits=o,this.sourceInlineCompletion=r,this.source=l,n=(e=e.replace(/\r\n|\r/g,"\n")).replace(/\r\n|\r/g,"\n")}withRange(e){return new q(this.filterText,this.command,e,this.insertText,this.snippetInfo,this.additionalTextEdits,this.sourceInlineCompletion,this.source)}hash(){return JSON.stringify({insertText:this.insertText,range:this.range.toString()})}}function H(e,t,i,n){const s=i.getLineContent(t.lineNumber).substring(0,t.column-1)+e,o=i.tokenization.tokenizeLineWithEdit(t,s.length-(t.column-1),e),r=null===o||void 0===o?void 0:o.sliceAndInflate(t.column-1,s.length,0);if(!r)return e;return(0,F.I)(r,n)}var G=i(97853);function z(e,t,i){const n=i?e.range.intersectRanges(i):e.range;if(!n)return e;const s=t.getValueInRange(n,1),o=(0,k.Qp)(s,e.text),r=D.W.ofText(s.substring(0,o)).addToPosition(e.range.getStartPosition()),l=e.text.substring(o),a=R.Q.fromPositions(r,e.range.getEndPosition());return new E.WR(a,l)}function Z(e,t){return e.text.startsWith(t.text)&&(i=e.range,(n=t.range).getStartPosition().equals(i.getStartPosition())&&n.getEndPosition().isBeforeOrEqual(i.getEndPosition()));var i,n}function $(e,t,i,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=z(e,t);if(o.range.endLineNumber!==o.range.startLineNumber)return;const r=t.getLineContent(o.range.startLineNumber),l=(0,k.UU)(r).length;if(o.range.startColumn-1<=l){const e=(0,k.UU)(o.text).length,t=r.substring(o.range.startColumn-1,l),[i,n]=[o.range.getStartPosition(),o.range.getEndPosition()],s=i.column+t.length<=n.column?i.delta(0,t.length):n,a=R.Q.fromPositions(s,n),d=o.text.startsWith(t)?o.text.substring(t.length):o.text.substring(e);o=new E.WR(a,d)}const a=t.getValueInRange(o.range),d=function(e,t){if((null===Y||void 0===Y?void 0:Y.originalValue)===e&&(null===Y||void 0===Y?void 0:Y.newValue)===t)return null===Y||void 0===Y?void 0:Y.changes;{let i=X(e,t,!0);if(i){const n=J(i);if(n>0){const s=X(e,t,!1);s&&J(s)<n&&(i=s)}}return Y={originalValue:e,newValue:t,changes:i},i}}(a,o.text);if(!d)return;const c=o.range.startLineNumber,u=new Array;if("prefix"===i){const e=d.filter((e=>0===e.originalLength));if(e.length>1||1===e.length&&e[0].originalStart!==a.length)return}const h=o.text.length-s;for(const g of d){const e=o.range.startColumn+g.originalStart+g.originalLength;if("subwordSmart"===i&&n&&n.lineNumber===o.range.startLineNumber&&e<n.column)return;if(g.originalLength>0)return;if(0===g.modifiedLength)continue;const t=g.modifiedStart+g.modifiedLength,s=Math.max(g.modifiedStart,Math.min(t,h)),r=o.text.substring(g.modifiedStart,s),l=o.text.substring(s,Math.max(g.modifiedStart,t));r.length>0&&u.push(new O.yP(e,r,!1)),l.length>0&&u.push(new O.yP(e,l,!0))}return new O.xD(c,u)}let Y;function J(e){let t=0;for(const i of e)t+=i.originalLength;return t}function X(e,t,i){if(e.length>5e3||t.length>5e3)return;function n(e){let t=0;for(let i=0,n=e.length;i<n;i++){const n=e.charCodeAt(i);n>t&&(t=n)}return t}const s=Math.max(n(e),n(t));function o(e){if(e<0)throw new Error("unexpected");return s+e+1}function r(e){let t=0,n=0;const s=new Int32Array(e.length);for(let r=0,l=e.length;r<l;r++)if(i&&"("===e[r]){const e=100*n+t;s[r]=o(2*e),t++}else if(i&&")"===e[r]){t=Math.max(t-1,0);const e=100*n+t;s[r]=o(2*e+1),0===t&&n++}else s[r]=e.charCodeAt(r);return s}const l=r(e),a=r(t);return new G.uP({getElements:()=>l},{getElements:()=>a}).ComputeDiff(!1).changes}var ee=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},te=function(e,t){return function(i,n){t(i,n,e)}};let ie=class extends m.jG{constructor(e,t,i,n,s){super(),this.textModel=e,this.versionId=t,this._debounceValue=i,this.languageFeaturesService=n,this.languageConfigurationService=s,this._updateOperation=this._register(new m.HE),this.inlineCompletions=(0,o.X2)("inlineCompletions",void 0),this.suggestWidgetInlineCompletions=(0,o.X2)("suggestWidgetInlineCompletions",void 0),this._register(this.textModel.onDidChangeContent((()=>{this._updateOperation.clear()})))}fetch(e,t,i){var n,s;const r=new ne(e,t,this.textModel.getVersionId()),l=t.selectedSuggestionInfo?this.suggestWidgetInlineCompletions:this.inlineCompletions;if(null===(n=this._updateOperation.value)||void 0===n?void 0:n.request.satisfies(r))return this._updateOperation.value.promise;if(null===(s=l.get())||void 0===s?void 0:s.request.satisfies(r))return Promise.resolve(!0);const a=!!this._updateOperation.value;this._updateOperation.clear();const d=new g.Qi,c=(async()=>{var n,s;if((a||t.triggerKind===M.qw.Automatic)&&await(n=this._debounceValue.get(this.textModel),s=d.token,new Promise((e=>{let t;const i=setTimeout((()=>{t&&t.dispose(),e()}),n);s&&(t=s.onCancellationRequested((()=>{clearTimeout(i),t&&t.dispose(),e()})))}))),d.token.isCancellationRequested||this.textModel.getVersionId()!==r.versionId)return!1;const c=new Date,u=await B(this.languageFeaturesService.inlineCompletionsProvider,e,this.textModel,t,d.token,this.languageConfigurationService);if(d.token.isCancellationRequested||this.textModel.getVersionId()!==r.versionId)return!1;const h=new Date;this._debounceValue.update(this.textModel,h.getTime()-c.getTime());const g=new oe(u,r,this.textModel,this.versionId);if(i){const t=i.toInlineCompletion(void 0);i.canBeReused(this.textModel,e)&&!u.has(t)&&g.prepend(i.inlineCompletion,t.range,!0)}return this._updateOperation.clear(),(0,o.Rn)((e=>{l.set(g,e)})),!0})(),u=new se(r,d,c);return this._updateOperation.value=u,c}clear(e){this._updateOperation.clear(),this.inlineCompletions.set(void 0,e),this.suggestWidgetInlineCompletions.set(void 0,e)}clearSuggestWidgetInlineCompletions(e){var t;(null===(t=this._updateOperation.value)||void 0===t?void 0:t.request.context.selectedSuggestionInfo)&&this._updateOperation.clear(),this.suggestWidgetInlineCompletions.set(void 0,e)}cancelUpdate(){this._updateOperation.clear()}};ie=ee([te(3,w.u),te(4,P.JZ)],ie);class ne{constructor(e,t,i){this.position=e,this.context=t,this.versionId=i}satisfies(e){return this.position.equals(e.position)&&(0,p.KC)(this.context.selectedSuggestionInfo,e.context.selectedSuggestionInfo,(0,p.r)())&&(e.context.triggerKind===M.qw.Automatic||this.context.triggerKind===M.qw.Explicit)&&this.versionId===e.versionId}}class se{constructor(e,t,i){this.request=e,this.cancellationTokenSource=t,this.promise=i}dispose(){this.cancellationTokenSource.cancel()}}class oe{get inlineCompletions(){return this._inlineCompletions}constructor(e,t,i,n){this.inlineCompletionProviderResult=e,this.request=t,this._textModel=i,this._versionId=n,this._refCount=1,this._prependedInlineCompletionItems=[];const s=i.deltaDecorations([],e.completions.map((e=>({range:e.range,options:{description:"inline-completion-tracking-range"}}))));this._inlineCompletions=e.completions.map(((e,t)=>new re(e,s[t],this._textModel,this._versionId)))}clone(){return this._refCount++,this}dispose(){if(this._refCount--,0===this._refCount){setTimeout((()=>{this._textModel.isDisposed()||this._textModel.deltaDecorations(this._inlineCompletions.map((e=>e.decorationId)),[])}),0),this.inlineCompletionProviderResult.dispose();for(const e of this._prependedInlineCompletionItems)e.source.removeRef()}}prepend(e,t,i){i&&e.source.addRef();const n=this._textModel.deltaDecorations([],[{range:t,options:{description:"inline-completion-tracking-range"}}])[0];this._inlineCompletions.unshift(new re(e,n,this._textModel,this._versionId)),this._prependedInlineCompletionItems.push(e)}}class re{get forwardStable(){var e;return null!==(e=this.inlineCompletion.source.inlineCompletions.enableForwardStability)&&void 0!==e&&e}constructor(e,t,i,n){this.inlineCompletion=e,this.decorationId=t,this._textModel=i,this._modelVersion=n,this.semanticId=JSON.stringify([this.inlineCompletion.filterText,this.inlineCompletion.insertText,this.inlineCompletion.range.getStartPosition().toString()]),this._updatedRange=(0,o.C)({owner:this,equalsFn:R.Q.equalsRange},(e=>(this._modelVersion.read(e),this._textModel.getDecorationRange(this.decorationId))))}toInlineCompletion(e){var t;return this.inlineCompletion.withRange(null!==(t=this._updatedRange.read(e))&&void 0!==t?t:le)}toSingleTextEdit(e){var t;return new E.WR(null!==(t=this._updatedRange.read(e))&&void 0!==t?t:le,this.inlineCompletion.insertText)}isVisible(e,t,i){const n=z(this._toFilterTextReplacement(i),e),s=this._updatedRange.read(i);if(!s||!this.inlineCompletion.range.getStartPosition().equals(s.getStartPosition())||t.lineNumber!==n.range.startLineNumber)return!1;const o=e.getValueInRange(n.range,1),r=n.text,l=Math.max(0,t.column-n.range.startColumn);let a=r.substring(0,l),d=r.substring(l),c=o.substring(0,l),u=o.substring(l);const h=e.getLineIndentColumn(n.range.startLineNumber);return n.range.startColumn<=h&&(c=c.trimStart(),0===c.length&&(u=u.trimStart()),a=a.trimStart(),0===a.length&&(d=d.trimStart())),a.startsWith(c)&&!!(0,A.dE)(u,d)}canBeReused(e,t){const i=this._updatedRange.read(void 0);return!!i&&i.containsPosition(t)&&this.isVisible(e,t,void 0)&&D.W.ofRange(i).isGreaterThanOrEqualTo(D.W.ofRange(this.inlineCompletion.range))}_toFilterTextReplacement(e){var t;return new E.WR(null!==(t=this._updatedRange.read(e))&&void 0!==t?t:le,this.inlineCompletion.filterText)}}const le=new R.Q(1,1,1,1);var ae,de=i(42416),ce=i(39587),ue=i(39263),he=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},ge=function(e,t){return function(i,n){t(i,n,e)}};!function(e){e[e.Undo=0]="Undo",e[e.Redo=1]="Redo",e[e.AcceptWord=2]="AcceptWord",e[e.Other=3]="Other"}(ae||(ae={}));let pe=class extends m.jG{get isAcceptingPartially(){return this._isAcceptingPartially}constructor(e,t,i,n,s,r,l,a,d,c,u,h){let g;super(),this.textModel=e,this.selectedSuggestItem=t,this.textModelVersionId=i,this._positions=n,this._debounceValue=s,this._suggestPreviewEnabled=r,this._suggestPreviewMode=l,this._inlineSuggestMode=a,this._enabled=d,this._instantiationService=c,this._commandService=u,this._languageConfigurationService=h,this._source=this._register(this._instantiationService.createInstance(ie,this.textModel,this.textModelVersionId,this._debounceValue)),this._isActive=(0,o.FY)(this,!1),this._forceUpdateExplicitlySignal=(0,o.Yd)(this),this._selectedInlineCompletionId=(0,o.FY)(this,void 0),this._primaryPosition=(0,o.un)(this,(e=>{var t;return null!==(t=this._positions.read(e)[0])&&void 0!==t?t:new C.y(1,1)})),this._isAcceptingPartially=!1,this._preserveCurrentCompletionReasons=new Set([ae.Redo,ae.Undo,ae.AcceptWord]),this._fetchInlineCompletionsPromise=(0,o.nb)({owner:this,createEmptyChangeSummary:()=>({preserveCurrentCompletion:!1,inlineCompletionTriggerKind:M.qw.Automatic}),handleChange:(e,t)=>(e.didChange(this.textModelVersionId)&&this._preserveCurrentCompletionReasons.has(e.change)?t.preserveCurrentCompletion=!0:e.didChange(this._forceUpdateExplicitlySignal)&&(t.inlineCompletionTriggerKind=M.qw.Explicit),!0)},((e,t)=>{this._forceUpdateExplicitlySignal.read(e);if(!(this._enabled.read(e)&&this.selectedSuggestItem.read(e)||this._isActive.read(e)))return void this._source.cancelUpdate();this.textModelVersionId.read(e);const i=this._source.suggestWidgetInlineCompletions.get(),n=this.selectedSuggestItem.read(e);if(i&&!n){const e=this._source.inlineCompletions.get();(0,o.Rn)((t=>{(!e||i.request.versionId>e.request.versionId)&&this._source.inlineCompletions.set(i.clone(),t),this._source.clearSuggestWidgetInlineCompletions(t)}))}const s=this._primaryPosition.read(e),r={triggerKind:t.inlineCompletionTriggerKind,selectedSuggestionInfo:null===n||void 0===n?void 0:n.toSelectedSuggestionInfo()},l=this.selectedInlineCompletion.get(),a=t.preserveCurrentCompletion||(null===l||void 0===l?void 0:l.forwardStable)?l:void 0;return this._source.fetch(s,r,a)})),this._filteredInlineCompletionItems=(0,o.C)({owner:this,equalsFn:(0,p.S3)()},(e=>{const t=this._source.inlineCompletions.read(e);if(!t)return[];const i=this._primaryPosition.read(e),n=t.inlineCompletions.filter((t=>t.isVisible(this.textModel,i,e)));return n})),this.selectedInlineCompletionIndex=(0,o.un)(this,(e=>{const t=this._selectedInlineCompletionId.read(e),i=this._filteredInlineCompletionItems.read(e),n=void 0===this._selectedInlineCompletionId?-1:i.findIndex((e=>e.semanticId===t));return-1===n?(this._selectedInlineCompletionId.set(void 0,void 0),0):n})),this.selectedInlineCompletion=(0,o.un)(this,(e=>this._filteredInlineCompletionItems.read(e)[this.selectedInlineCompletionIndex.read(e)])),this.activeCommands=(0,o.C)({owner:this,equalsFn:(0,p.S3)()},(e=>{var t,i;return null!==(i=null===(t=this.selectedInlineCompletion.read(e))||void 0===t?void 0:t.inlineCompletion.source.inlineCompletions.commands)&&void 0!==i?i:[]})),this.lastTriggerKind=this._source.inlineCompletions.map(this,(e=>null===e||void 0===e?void 0:e.request.context.triggerKind)),this.inlineCompletionsCount=(0,o.un)(this,(e=>this.lastTriggerKind.read(e)===M.qw.Explicit?this._filteredInlineCompletionItems.read(e).length:void 0)),this.state=(0,o.C)({owner:this,equalsFn:(e,t)=>e&&t?(0,O.AL)(e.ghostTexts,t.ghostTexts)&&e.inlineCompletion===t.inlineCompletion&&e.suggestItem===t.suggestItem:e===t},(e=>{var t,i;const n=this.textModel,s=this.selectedSuggestItem.read(e);if(s){const o=z(s.toSingleTextEdit(),n),r=this._computeAugmentation(o,e);if(!this._suggestPreviewEnabled.read(e)&&!r)return;const l=null!==(t=null===r||void 0===r?void 0:r.edit)&&void 0!==t?t:o,a=r?r.edit.text.length-o.text.length:0,d=this._suggestPreviewMode.read(e),c=this._positions.read(e),u=[l,...me(this.textModel,c,l)],h=u.map(((e,t)=>$(e,n,d,c[t],a))).filter(v.O9);return{edits:u,primaryGhostText:null!==(i=h[0])&&void 0!==i?i:new O.xD(l.range.endLineNumber,[]),ghostTexts:h,inlineCompletion:null===r||void 0===r?void 0:r.completion,suggestItem:s}}{if(!this._isActive.read(e))return;const t=this.selectedInlineCompletion.read(e);if(!t)return;const i=t.toSingleTextEdit(e),s=this._inlineSuggestMode.read(e),o=this._positions.read(e),r=[i,...me(this.textModel,o,i)],l=r.map(((e,t)=>$(e,n,s,o[t],0))).filter(v.O9);if(!l[0])return;return{edits:r,primaryGhostText:l[0],ghostTexts:l,inlineCompletion:t,suggestItem:void 0}}})),this.ghostTexts=(0,o.C)({owner:this,equalsFn:O.AL},(e=>{const t=this.state.read(e);if(t)return t.ghostTexts})),this.primaryGhostText=(0,o.C)({owner:this,equalsFn:O.x9},(e=>{const t=this.state.read(e);if(t)return null===t||void 0===t?void 0:t.primaryGhostText})),this._register((0,o.OI)(this._fetchInlineCompletionsPromise)),this._register((0,o.fm)((e=>{var t,i;const n=this.state.read(e),s=null===n||void 0===n?void 0:n.inlineCompletion;if((null===s||void 0===s?void 0:s.semanticId)!==(null===g||void 0===g?void 0:g.semanticId)&&(g=s,s)){const e=s.inlineCompletion,n=e.source;null===(i=(t=n.provider).handleItemDidShow)||void 0===i||i.call(t,n.inlineCompletions,e.sourceInlineCompletion,e.insertText)}})))}async trigger(e){this._isActive.set(!0,e),await this._fetchInlineCompletionsPromise.get()}async triggerExplicitly(e){(0,o.PO)(e,(e=>{this._isActive.set(!0,e),this._forceUpdateExplicitlySignal.trigger(e)})),await this._fetchInlineCompletionsPromise.get()}stop(e){(0,o.PO)(e,(e=>{this._isActive.set(!1,e),this._source.clear(e)}))}_computeAugmentation(e,t){const i=this.textModel,n=this._source.suggestWidgetInlineCompletions.read(t),s=n?n.inlineCompletions:[this.selectedInlineCompletion.read(t)].filter(v.O9);return(0,y.oH)(s,(n=>{let s=n.toSingleTextEdit(t);return s=z(s,i,R.Q.fromPositions(s.range.getStartPosition(),e.range.getEndPosition())),Z(s,e)?{completion:n,edit:s}:void 0}))}async _deltaSelectedInlineCompletionIndex(e){await this.triggerExplicitly();const t=this._filteredInlineCompletionItems.get()||[];if(t.length>0){const i=(this.selectedInlineCompletionIndex.get()+e+t.length)%t.length;this._selectedInlineCompletionId.set(t[i].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}async next(){await this._deltaSelectedInlineCompletionIndex(1)}async previous(){await this._deltaSelectedInlineCompletionIndex(-1)}async accept(e){var t;if(e.getModel()!==this.textModel)throw new I.D7;const i=this.state.get();if(!i||i.primaryGhostText.isEmpty()||!i.inlineCompletion)return;const n=i.inlineCompletion.toInlineCompletion(void 0);if(e.pushUndoStop(),n.snippetInfo)e.executeEdits("inlineSuggestion.accept",[N.k.replace(n.range,""),...n.additionalTextEdits]),e.setPosition(n.snippetInfo.range.getStartPosition(),"inlineCompletionAccept"),null===(t=de.O.get(e))||void 0===t||t.insert(n.snippetInfo.snippet,{undoStopBefore:!1});else{const t=i.edits,s=fe(t).map((e=>T.L.fromPositions(e)));e.executeEdits("inlineSuggestion.accept",[...t.map((e=>N.k.replace(e.range,e.text))),...n.additionalTextEdits]),e.setSelections(s,"inlineCompletionAccept")}n.command&&n.source.addRef(),(0,o.Rn)((e=>{this._source.clear(e),this._isActive.set(!1,e)})),n.command&&(await this._commandService.executeCommand(n.command.id,...n.command.arguments||[]).then(void 0,I.M_),n.source.removeRef())}async acceptNextWord(e){await this._acceptNext(e,((e,t)=>{const i=this.textModel.getLanguageIdAtPosition(e.lineNumber,e.column),n=this._languageConfigurationService.getLanguageConfiguration(i),s=new RegExp(n.wordDefinition.source,n.wordDefinition.flags.replace("g","")),o=t.match(s);let r=0;r=o&&void 0!==o.index?0===o.index?o[0].length:o.index:t.length;const l=/\s+/g.exec(t);return l&&void 0!==l.index&&l.index+l[0].length<r&&(r=l.index+l[0].length),r}),0)}async acceptNextLine(e){await this._acceptNext(e,((e,t)=>{const i=t.match(/\n/);return i&&void 0!==i.index?i.index+1:t.length}),1)}async _acceptNext(e,t,i){if(e.getModel()!==this.textModel)throw new I.D7;const n=this.state.get();if(!n||n.primaryGhostText.isEmpty()||!n.inlineCompletion)return;const s=n.primaryGhostText,o=n.inlineCompletion.toInlineCompletion(void 0);if(o.snippetInfo||o.filterText!==o.insertText)return void await this.accept(e);const r=s.parts[0],l=new C.y(s.lineNumber,r.column),a=r.text,d=t(l,a);if(d===a.length&&1===s.parts.length)return void this.accept(e);const c=a.substring(0,d),u=this._positions.get(),h=u[0];o.source.addRef();try{this._isAcceptingPartially=!0;try{e.pushUndoStop();const t=R.Q.fromPositions(h,l),i=e.getModel().getValueInRange(t)+c,n=new E.WR(t,i),s=[n,...me(this.textModel,u,n)],o=fe(s).map((e=>T.L.fromPositions(e)));e.executeEdits("inlineSuggestion.accept",s.map((e=>N.k.replace(e.range,e.text)))),e.setSelections(o,"inlineCompletionPartialAccept")}finally{this._isAcceptingPartially=!1}if(o.source.provider.handlePartialAccept){const t=R.Q.fromPositions(o.range.getStartPosition(),D.W.ofText(c).addToPosition(l)),n=e.getModel().getValueInRange(t,1);o.source.provider.handlePartialAccept(o.source.inlineCompletions,o.sourceInlineCompletion,n.length,{kind:i})}}finally{o.source.removeRef()}}handleSuggestAccepted(e){var t,i;const n=z(e.toSingleTextEdit(),this.textModel),s=this._computeAugmentation(n,void 0);if(!s)return;const o=s.completion.inlineCompletion;null===(i=(t=o.source.provider).handlePartialAccept)||void 0===i||i.call(t,o.source.inlineCompletions,o.sourceInlineCompletion,n.text.length,{kind:2})}};function me(e,t,i){if(1===t.length)return[];const n=t[0],s=t.slice(1),o=i.range.getStartPosition(),r=i.range.getEndPosition(),l=e.getValueInRange(R.Q.fromPositions(n,r)),a=(0,U.tN)(n,o);if(a.lineNumber<1)return(0,I.dz)(new I.D7("positionWithinTextEdit line number should be bigger than 0.\n\t\t\tInvalid subtraction between ".concat(n.toString()," and ").concat(o.toString()))),[];const d=function(e,t){let i="";const n=(0,k.en)(e);for(let s=t.lineNumber-1;s<n.length;s++)i+=n[s].substring(s===t.lineNumber-1?t.column-1:0);return i}(i.text,a);return s.map((t=>{const i=(0,U.OA)((0,U.tN)(t,o),r),n=e.getValueInRange(R.Q.fromPositions(t,i)),s=(0,k.Qp)(l,n),a=R.Q.fromPositions(t,t.delta(0,s));return new E.WR(a,d)}))}function fe(e){const t=x.t9.createSortPermutation(e,((e,t)=>R.Q.compareRangesUsingStarts(e.range,t.range))),i=new E.mF(t.apply(e)).getNewRanges();return t.inverse().apply(i).map((e=>e.getEndPosition()))}pe=he([ge(9,ue._Y),ge(10,ce.d),ge(11,P.JZ)],pe);var ve=i(48250),be=i(40362),Ce=i(60547);class _e extends m.jG{get selectedItem(){return this._selectedItem}constructor(e,t,i,n){super(),this.editor=e,this.suggestControllerPreselector=t,this.checkModelVersion=i,this.onWillAccept=n,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this._selectedItem=(0,o.FY)(this,void 0),this._register(e.onKeyDown((e=>{e.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))}))),this._register(e.onKeyUp((e=>{e.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))})));const s=Ce.D.get(this.editor);if(s){this._register(s.registerSelector({priority:100,select:(e,t,i)=>{(0,o.Rn)((e=>this.checkModelVersion(e)));const n=this.editor.getModel();if(!n)return-1;const r=this.suggestControllerPreselector(),l=r?z(r,n):void 0;if(!l)return-1;const a=C.y.lift(t),d=i.map(((e,t)=>{const i=z(we.fromSuggestion(s,n,a,e,this.isShiftKeyPressed).toSingleTextEdit(),n);return{index:t,valid:Z(l,i),prefixLength:i.text.length,suggestItem:e}})).filter((e=>e&&e.valid&&e.prefixLength>0)),c=(0,y.Cn)(d,(0,x.VE)((e=>e.prefixLength),x.U9));return c?c.index:-1}}));let e=!1;const t=()=>{e||(e=!0,this._register(s.widget.value.onDidShow((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))),this._register(s.widget.value.onDidHide((()=>{this.isSuggestWidgetVisible=!1,this.update(!1)}))),this._register(s.widget.value.onDidFocus((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))))};this._register(ve.Jh.once(s.model.onDidTrigger)((e=>{t()}))),this._register(s.onWillInsertSuggestItem((e=>{const t=this.editor.getPosition(),i=this.editor.getModel();if(!t||!i)return;const n=we.fromSuggestion(s,i,t,e.item,this.isShiftKeyPressed);this.onWillAccept(n)})))}this.update(this._isActive)}update(e){const t=this.getSuggestItemInfo();this._isActive===e&&function(e,t){if(e===t)return!0;if(!e||!t)return!1;return e.equals(t)}(this._currentSuggestItemInfo,t)||(this._isActive=e,this._currentSuggestItemInfo=t,(0,o.Rn)((e=>{this.checkModelVersion(e),this._selectedItem.set(this._isActive?this._currentSuggestItemInfo:void 0,e)})))}getSuggestItemInfo(){const e=Ce.D.get(this.editor);if(!e||!this.isSuggestWidgetVisible)return;const t=e.widget.value.getFocusedItem(),i=this.editor.getPosition(),n=this.editor.getModel();return t&&i&&n?we.fromSuggestion(e,n,i,t.item,this.isShiftKeyPressed):void 0}stopForceRenderingAbove(){const e=Ce.D.get(this.editor);null===e||void 0===e||e.stopForceRenderingAbove()}forceRenderingAbove(){const e=Ce.D.get(this.editor);null===e||void 0===e||e.forceRenderingAbove()}}class we{static fromSuggestion(e,t,i,n,s){let{insertText:o}=n.completion,r=!1;if(4&n.completion.insertTextRules){const e=(new j.fr).parse(o);e.children.length<100&&be.O.adjustWhitespace(t,i,!0,e),o=e.toString(),r=!0}const l=e.getOverwriteInfo(n,s);return new we(R.Q.fromPositions(i.delta(0,-l.overwriteBefore),i.delta(0,Math.max(l.overwriteAfter,0))),o,n.completion.kind,r)}constructor(e,t,i,n){this.range=e,this.insertText=t,this.completionItemKind=i,this.isSnippetText=n}equals(e){return this.range.equalsRange(e.range)&&this.insertText===e.insertText&&this.completionItemKind===e.completionItemKind&&this.isSnippetText===e.isSnippetText}toSelectedSuggestionInfo(){return new M.GE(this.range,this.insertText,this.completionItemKind,this.isSnippetText)}toSingleTextEdit(){return new E.WR(this.range,this.insertText)}}var Le,Se=i(51413),xe=i(73429),ye=i(85429),Ie=i(66457),ke=i(39686),Ne=i(16391),Re=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},Te=function(e,t){return function(i,n){t(i,n,e)}};let Ee=Le=class extends m.jG{static get(e){return e.getContribution(Le.ID)}constructor(e,t,i,n,s,l,u,_,w,x){super(),this.editor=e,this._instantiationService=t,this._contextKeyService=i,this._configurationService=n,this._commandService=s,this._debounceService=l,this._languageFeaturesService=u,this._accessibilitySignalService=_,this._keybindingService=w,this._accessibilityService=x,this.model=this._register((0,o.X2)("inlineCompletionModel",void 0)),this._textModelVersionId=(0,o.FY)(this,-1),this._positions=(0,r.Zh)({owner:this,equalsFn:(0,p.S3)((0,p.r)())},[new C.y(1,1)]),this._suggestWidgetAdaptor=this._register(new _e(this.editor,(()=>{var e,t;return null===(t=null===(e=this.model.get())||void 0===e?void 0:e.selectedInlineCompletion.get())||void 0===t?void 0:t.toSingleTextEdit(void 0)}),(e=>this.updateObservables(e,ae.Other)),(e=>{(0,o.Rn)((t=>{var i;this.updateObservables(t,ae.Other),null===(i=this.model.get())||void 0===i||i.handleSuggestAccepted(e)}))}))),this._enabledInConfig=(0,o.y0)(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(62).enabled)),this._isScreenReaderEnabled=(0,o.y0)(this._accessibilityService.onDidChangeScreenReaderOptimized,(()=>this._accessibilityService.isScreenReaderOptimized())),this._editorDictationInProgress=(0,o.y0)(this._contextKeyService.onDidChangeContext,(()=>!0===this._contextKeyService.getContext(this.editor.getDomNode()).getValue("editorDictation.inProgress"))),this._enabled=(0,o.un)(this,(e=>this._enabledInConfig.read(e)&&(!this._isScreenReaderEnabled.read(e)||!this._editorDictationInProgress.read(e)))),this._fontFamily=(0,o.y0)(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(62).fontFamily)),this._ghostTexts=(0,o.un)(this,(e=>{var t;const i=this.model.read(e);return null!==(t=null===i||void 0===i?void 0:i.ghostTexts.read(e))&&void 0!==t?t:[]})),this._stablizedGhostTexts=function(e,t){const i=(0,o.FY)("result",[]),n=[];return t.add((0,o.fm)((t=>{const s=e.read(t);(0,o.Rn)((e=>{if(s.length!==n.length){n.length=s.length;for(let e=0;e<n.length;e++)n[e]||(n[e]=(0,o.FY)("item",s[e]));i.set([...n],e)}n.forEach(((t,i)=>t.set(s[i],e)))}))}))),i}(this._ghostTexts,this._store),this._ghostTextWidgets=(0,f.Rl)(this,this._stablizedGhostTexts,((e,t)=>t.add(this._instantiationService.createInstance(L.PM,this.editor,{ghostText:e,minReservedLineCount:(0,o.lk)(0),targetTextModel:this.model.map((e=>null===e||void 0===e?void 0:e.textModel))})))).recomputeInitiallyAndOnChange(this._store),this._debounceValue=this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:50}),this._playAccessibilitySignal=(0,o.Yd)(this),this._isReadonly=(0,o.y0)(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(91))),this._textModel=(0,o.y0)(this.editor.onDidChangeModel,(()=>this.editor.getModel())),this._textModelIfWritable=(0,o.un)((e=>this._isReadonly.read(e)?void 0:this._textModel.read(e))),this._register(new d.p(this._contextKeyService,this.model)),this._register((0,o.fm)((i=>{const n=this._textModelIfWritable.read(i);(0,o.Rn)((i=>{if(this.model.set(void 0,i),this.updateObservables(i,ae.Other),n){const s=t.createInstance(pe,n,this._suggestWidgetAdaptor.selectedItem,this._textModelVersionId,this._positions,this._debounceValue,(0,o.y0)(e.onDidChangeConfiguration,(()=>e.getOption(118).preview)),(0,o.y0)(e.onDidChangeConfiguration,(()=>e.getOption(118).previewMode)),(0,o.y0)(e.onDidChangeConfiguration,(()=>e.getOption(62).mode)),this._enabled);this.model.set(s,i)}}))})));const y=this._register((0,c.jh)());this._register((0,o.fm)((e=>{const t=this._fontFamily.read(e);y.setStyle(""===t||"default"===t?"":"\n.monaco-editor .ghost-text-decoration,\n.monaco-editor .ghost-text-decoration-preview,\n.monaco-editor .ghost-text {\n\tfont-family: ".concat(t,";\n}"))})));const I=e=>{var t;return e.isUndoing?ae.Undo:e.isRedoing?ae.Redo:(null===(t=this.model.get())||void 0===t?void 0:t.isAcceptingPartially)?ae.AcceptWord:ae.Other};this._register(e.onDidChangeModelContent((e=>(0,o.Rn)((t=>this.updateObservables(t,I(e))))))),this._register(e.onDidChangeCursorPosition((e=>(0,o.Rn)((t=>{var i;this.updateObservables(t,ae.Other),3!==e.reason&&"api"!==e.source||null===(i=this.model.get())||void 0===i||i.stop(t)}))))),this._register(e.onDidType((()=>(0,o.Rn)((e=>{var t;this.updateObservables(e,ae.Other),this._enabled.get()&&(null===(t=this.model.get())||void 0===t||t.trigger(e))}))))),this._register(this._commandService.onDidExecuteCommand((t=>{new Set([b.Yh.Tab.id,b.Yh.DeleteLeft.id,b.Yh.DeleteRight.id,a.Wt,"acceptSelectedSuggestion"]).has(t.commandId)&&e.hasTextFocus()&&this._enabled.get()&&(0,o.Rn)((e=>{var t;null===(t=this.model.get())||void 0===t||t.trigger(e)}))}))),this._register(this.editor.onDidBlurEditorWidget((()=>{this._contextKeyService.getContextKeyValue("accessibleViewIsShown")||this._configurationService.getValue("editor.inlineSuggest.keepOnBlur")||e.getOption(62).keepOnBlur||S.bo.dropDownVisible||(0,o.Rn)((e=>{var t;null===(t=this.model.get())||void 0===t||t.stop(e)}))}))),this._register((0,o.fm)((e=>{var t;const i=null===(t=this.model.read(e))||void 0===t?void 0:t.state.read(e);(null===i||void 0===i?void 0:i.suggestItem)?i.primaryGhostText.lineCount>=2&&this._suggestWidgetAdaptor.forceRenderingAbove():this._suggestWidgetAdaptor.stopForceRenderingAbove()}))),this._register((0,m.s)((()=>{this._suggestWidgetAdaptor.stopForceRenderingAbove()})));const k=this._register(new m.Cm);let N;this._register((0,o.Y)({handleChange:(e,t)=>(e.didChange(this._playAccessibilitySignal)&&(N=void 0),!0)},(async(e,t)=>{this._playAccessibilitySignal.read(e);const i=this.model.read(e),n=null===i||void 0===i?void 0:i.state.read(e);if(i&&n&&n.inlineCompletion){if(n.inlineCompletion.semanticId!==N){k.clear(),N=n.inlineCompletion.semanticId;const e=i.textModel.getLineContent(n.primaryGhostText.lineNumber);await(0,h.wR)(50,(0,g.bs)(k)),await(0,o.oJ)(this._suggestWidgetAdaptor.selectedItem,v.b0,(()=>!1),(0,g.bs)(k)),await this._accessibilitySignalService.playSignal(ye.Rh.inlineSuggestion),this.editor.getOption(8)&&this.provideScreenReaderUpdate(n.primaryGhostText.renderForScreenReader(e))}}else N=void 0}))),this._register(new S.Pm(this.editor,this.model,this._instantiationService)),this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("accessibility.verbosity.inlineCompletions")&&this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})}))),this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})}playAccessibilitySignal(e){this._playAccessibilitySignal.trigger(e)}provideScreenReaderUpdate(e){const t=this._contextKeyService.getContextKeyValue("accessibleViewIsShown"),i=this._keybindingService.lookupKeybinding("editor.action.accessibleView");let n;!t&&i&&this.editor.getOption(149)&&(n=(0,Se.kg)("showAccessibleViewHint","Inspect this in the accessible view ({0})",i.getAriaLabel())),n?(0,u.xE)(e+", "+n):(0,u.xE)(e)}updateObservables(e,t){var i,n,s;const o=this.editor.getModel();this._textModelVersionId.set(null!==(i=null===o||void 0===o?void 0:o.getVersionId())&&void 0!==i?i:-1,e,t),this._positions.set(null!==(s=null===(n=this.editor.getSelections())||void 0===n?void 0:n.map((e=>e.getPosition())))&&void 0!==s?s:[new C.y(1,1)],e)}shouldShowHoverAt(e){var t;const i=null===(t=this.model.get())||void 0===t?void 0:t.primaryGhostText.get();return!!i&&i.parts.some((t=>e.containsPosition(new C.y(i.lineNumber,t.column))))}shouldShowHoverAtViewZone(e){var t,i;return null!==(i=null===(t=this._ghostTextWidgets.get()[0])||void 0===t?void 0:t.ownsViewZone(e))&&void 0!==i&&i}};Ee.ID="editor.contrib.inlineCompletionsController",Ee=Le=Re([Te(1,ue._Y),Te(2,ke.fN),Te(3,Ie.pG),Te(4,ce.d),Te(5,_.U),Te(6,w.u),Te(7,ye.Nt),Te(8,Ne.b),Te(9,xe.j)],Ee);var De=i(23436),Me=i(35155);class Pe extends n.ks{constructor(){super({id:Pe.ID,label:Se.kg("action.inlineSuggest.showNext","Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:ke.M$.and(l.R.writable,d.p.inlineSuggestionVisible),kbOpts:{weight:100,primary:606}})}async run(e,t){var i;const n=Ee.get(t);null===(i=null===n||void 0===n?void 0:n.model.get())||void 0===i||i.next()}}Pe.ID=a.PA;class Oe extends n.ks{constructor(){super({id:Oe.ID,label:Se.kg("action.inlineSuggest.showPrevious","Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:ke.M$.and(l.R.writable,d.p.inlineSuggestionVisible),kbOpts:{weight:100,primary:604}})}async run(e,t){var i;const n=Ee.get(t);null===(i=null===n||void 0===n?void 0:n.model.get())||void 0===i||i.previous()}}Oe.ID=a.Vl;class Ae extends n.ks{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:Se.kg("action.inlineSuggest.trigger","Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:l.R.writable})}async run(e,t){const i=Ee.get(t);await(0,r.fL)((async e=>{var t;await(null===(t=null===i||void 0===i?void 0:i.model.get())||void 0===t?void 0:t.triggerExplicitly(e)),null===i||void 0===i||i.playAccessibilitySignal(e)}))}}class Ve extends n.ks{constructor(){super({id:"editor.action.inlineSuggest.acceptNextWord",label:Se.kg("action.inlineSuggest.acceptNextWord","Accept Next Word Of Inline Suggestion"),alias:"Accept Next Word Of Inline Suggestion",precondition:ke.M$.and(l.R.writable,d.p.inlineSuggestionVisible),kbOpts:{weight:101,primary:2065,kbExpr:ke.M$.and(l.R.writable,d.p.inlineSuggestionVisible)},menuOpts:[{menuId:Me.D8.InlineSuggestionToolbar,title:Se.kg("acceptWord","Accept Word"),group:"primary",order:2}]})}async run(e,t){var i;const n=Ee.get(t);await(null===(i=null===n||void 0===n?void 0:n.model.get())||void 0===i?void 0:i.acceptNextWord(n.editor))}}class We extends n.ks{constructor(){super({id:"editor.action.inlineSuggest.acceptNextLine",label:Se.kg("action.inlineSuggest.acceptNextLine","Accept Next Line Of Inline Suggestion"),alias:"Accept Next Line Of Inline Suggestion",precondition:ke.M$.and(l.R.writable,d.p.inlineSuggestionVisible),kbOpts:{weight:101},menuOpts:[{menuId:Me.D8.InlineSuggestionToolbar,title:Se.kg("acceptLine","Accept Line"),group:"secondary",order:2}]})}async run(e,t){var i;const n=Ee.get(t);await(null===(i=null===n||void 0===n?void 0:n.model.get())||void 0===i?void 0:i.acceptNextLine(n.editor))}}class Fe extends n.ks{constructor(){super({id:a.Wt,label:Se.kg("action.inlineSuggest.accept","Accept Inline Suggestion"),alias:"Accept Inline Suggestion",precondition:d.p.inlineSuggestionVisible,menuOpts:[{menuId:Me.D8.InlineSuggestionToolbar,title:Se.kg("accept","Accept"),group:"primary",order:1}],kbOpts:{primary:2,weight:200,kbExpr:ke.M$.and(d.p.inlineSuggestionVisible,l.R.tabMovesFocus.toNegated(),d.p.inlineSuggestionHasIndentationLessThanTabSize,De.ob.Visible.toNegated(),l.R.hoverFocused.toNegated())}})}async run(e,t){var i;const n=Ee.get(t);n&&(null===(i=n.model.get())||void 0===i||i.accept(n.editor),n.editor.focus())}}class Ue extends n.ks{constructor(){super({id:Ue.ID,label:Se.kg("action.inlineSuggest.hide","Hide Inline Suggestion"),alias:"Hide Inline Suggestion",precondition:d.p.inlineSuggestionVisible,kbOpts:{weight:100,primary:9}})}async run(e,t){const i=Ee.get(t);(0,o.Rn)((e=>{var t;null===(t=null===i||void 0===i?void 0:i.model.get())||void 0===t||t.stop(e)}))}}Ue.ID="editor.action.inlineSuggest.hide";class je extends Me.L{constructor(){super({id:je.ID,title:Se.kg("action.inlineSuggest.alwaysShowToolbar","Always Show Toolbar"),f1:!1,precondition:void 0,menu:[{id:Me.D8.InlineSuggestionToolbar,group:"secondary",order:10}],toggled:ke.M$.equals("config.editor.inlineSuggest.showToolbar","always")})}async run(e,t){const i=e.get(Ie.pG),n="always"===i.getValue("editor.inlineSuggest.showToolbar")?"onHover":"always";i.updateValue("editor.inlineSuggest.showToolbar",n)}}je.ID="editor.action.inlineSuggest.toggleAlwaysShowToolbar";var Be=i(58348),Ke=i(63970),Qe=i(14564),qe=i(2531),He=i(96819),Ge=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},ze=function(e,t){return function(i,n){t(i,n,e)}};class Ze{constructor(e,t,i){this.owner=e,this.range=t,this.controller=i}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let $e=class{constructor(e,t,i,n,s,o){this._editor=e,this._languageService=t,this._openerService=i,this.accessibilityService=n,this._instantiationService=s,this._telemetryService=o,this.hoverOrdinal=4}suggestHoverAnchor(e){const t=Ee.get(this._editor);if(!t)return null;const i=e.target;if(8===i.type){const n=i.detail;if(t.shouldShowHoverAtViewZone(n.viewZoneId))return new s.mm(1e3,this,R.Q.fromPositions(this._editor.getModel().validatePosition(n.positionBefore||n.position)),e.event.posx,e.event.posy,!1)}if(7===i.type&&t.shouldShowHoverAt(i.range))return new s.mm(1e3,this,i.range,e.event.posx,e.event.posy,!1);if(6===i.type){if(i.detail.mightBeForeignElement&&t.shouldShowHoverAt(i.range))return new s.mm(1e3,this,i.range,e.event.posx,e.event.posy,!1)}return null}computeSync(e,t){if("onHover"!==this._editor.getOption(62).showToolbar)return[];const i=Ee.get(this._editor);return i&&i.shouldShowHoverAt(e.range)?[new Ze(this,e.range,i)]:[]}renderHoverParts(e,t){const i=new m.Cm,n=t[0];this._telemetryService.publicLog2("inlineCompletionHover.shown"),this.accessibilityService.isScreenReaderOptimized()&&!this._editor.getOption(8)&&this.renderScreenReaderText(e,n,i);const s=n.controller.model.get(),r=this._instantiationService.createInstance(S.bo,this._editor,!1,(0,o.lk)(null),s.selectedInlineCompletionIndex,s.inlineCompletionsCount,s.activeCommands);return e.fragment.appendChild(r.getDomNode()),s.triggerExplicitly(),i.add(r),i}renderScreenReaderText(e,t,i){const n=c.$,s=n("div.hover-row.markdown-hover"),r=c.BC(s,n("div.hover-contents",{"aria-live":"assertive"})),l=i.add(new Qe.T({editor:this._editor},this._languageService,this._openerService));i.add((0,o.fm)((n=>{var s;const o=null===(s=t.controller.model.read(n))||void 0===s?void 0:s.primaryGhostText.read(n);if(o){const t=this._editor.getModel().getLineContent(o.lineNumber);(t=>{i.add(l.onDidRenderAsync((()=>{r.className="hover-contents code-hover-contents",e.onContentsChanged()})));const n=Se.kg("inlineSuggestionFollows","Suggestion:"),s=i.add(l.render((new Be.Bc).appendText(n).appendCodeblock("text",t)));r.replaceChildren(s.element)})(o.renderForScreenReader(t))}else c.Ln(r)}))),e.fragment.appendChild(s)}};$e=Ge([ze(1,Ke.L),ze(2,qe.C),ze(3,xe.j),ze(4,ue._Y),ze(5,He.k)],$e),(0,n.HW)(Ee.ID,Ee,3),(0,n.Fl)(Ae),(0,n.Fl)(Pe),(0,n.Fl)(Oe),(0,n.Fl)(Ve),(0,n.Fl)(We),(0,n.Fl)(Fe),(0,n.Fl)(Ue),(0,Me.ug)(je),s.B2.register($e)},17907:(e,t,i)=>{i.d(t,{Pm:()=>E,bo:()=>P});var n,s=i(32605),o=i(92593),r=i(42108),l=i(63169),a=i(61498),d=i(73990),c=i(21030),u=i(87766),h=i(2698),g=i(66731),p=i(70145),m=i(23525),f=i(91861),v=i(79267),b=i(51413),C=i(53073),_=i(45924),w=i(35155),L=i(39587),S=i(39686),x=i(6748),y=i(39263),I=i(16391),k=i(96819),N=i(85514),R=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},T=function(e,t){return function(i,n){t(i,n,e)}};let E=class extends u.jG{constructor(e,t,i){super(),this.editor=e,this.model=t,this.instantiationService=i,this.alwaysShowToolbar=(0,h.y0)(this.editor.onDidChangeConfiguration,(()=>"always"===this.editor.getOption(62).showToolbar)),this.sessionPosition=void 0,this.position=(0,h.un)(this,(e=>{var t,i,n;const s=null===(t=this.model.read(e))||void 0===t?void 0:t.primaryGhostText.read(e);if(!this.alwaysShowToolbar.read(e)||!s||0===s.parts.length)return this.sessionPosition=void 0,null;const o=s.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==s.lineNumber&&(this.sessionPosition=void 0);const r=new m.y(s.lineNumber,Math.min(o,null!==(n=null===(i=this.sessionPosition)||void 0===i?void 0:i.column)&&void 0!==n?n:Number.MAX_SAFE_INTEGER));return this.sessionPosition=r,r})),this._register((0,h.yC)(((t,i)=>{const n=this.model.read(t);if(!n||!this.alwaysShowToolbar.read(t))return;const s=i.add(this.instantiationService.createInstance(P,this.editor,!0,this.position,n.selectedInlineCompletionIndex,n.inlineCompletionsCount,n.activeCommands));e.addContentWidget(s),i.add((0,u.s)((()=>e.removeContentWidget(s)))),i.add((0,h.fm)((e=>{this.position.read(e)&&n.lastTriggerKind.read(e)!==f.qw.Explicit&&n.triggerExplicitly()})))})))}};E=R([T(2,y._Y)],E);const D=(0,N.pU)("inline-suggestion-hints-next",c.W.chevronRight,(0,b.kg)("parameterHintsNextIcon","Icon for show next parameter hint.")),M=(0,N.pU)("inline-suggestion-hints-previous",c.W.chevronLeft,(0,b.kg)("parameterHintsPreviousIcon","Icon for show previous parameter hint."));let P=n=class extends u.jG{static get dropDownVisible(){return this._dropDownVisible}createCommandAction(e,t,i){const n=new l.rc(e,t,i,!0,(()=>this._commandService.executeCommand(e))),s=this.keybindingService.lookupKeybinding(e,this._contextKeyService);let o=t;return s&&(o=(0,b.kg)({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",t,s.getLabel())),n.tooltip=o,n}constructor(e,t,i,o,r,a,c,u,g,m,f){super(),this.editor=e,this.withBorder=t,this._position=i,this._currentSuggestionIdx=o,this._suggestionCount=r,this._extraCommands=a,this._commandService=c,this.keybindingService=g,this._contextKeyService=m,this._menuService=f,this.id="InlineSuggestionHintsContentWidget".concat(n.id++),this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=(0,s.h)("div.inlineSuggestionsHints",{className:this.withBorder?".withBorder":""},[(0,s.h)("div@toolBar")]),this.previousAction=this.createCommandAction(v.Vl,(0,b.kg)("previous","Previous"),p.L.asClassName(M)),this.availableSuggestionCountAction=new l.rc("inlineSuggestionHints.availableSuggestionCount","",void 0,!1),this.nextAction=this.createCommandAction(v.PA,(0,b.kg)("next","Next"),p.L.asClassName(D)),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(w.D8.InlineCompletionsActions,this._contextKeyService)),this.clearAvailableSuggestionCountLabelDebounced=this._register(new d.uC((()=>{this.availableSuggestionCountAction.label=""}),100)),this.disableButtonsDebounced=this._register(new d.uC((()=>{this.previousAction.enabled=this.nextAction.enabled=!1}),100)),this.toolBar=this._register(u.createInstance(V,this.nodes.toolBar,w.D8.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:e=>e.startsWith("primary")},actionViewItemProvider:(e,t)=>{if(e instanceof w.Xe)return u.createInstance(A,e,void 0);if(e===this.availableSuggestionCountAction){const t=new O(void 0,e,{label:!0,icon:!1});return t.setClass("availableSuggestionCount"),t}},telemetrySource:"InlineSuggestionToolbar"})),this.toolBar.setPrependedPrimaryActions([this.previousAction,this.availableSuggestionCountAction,this.nextAction]),this._register(this.toolBar.onDidChangeDropdownVisibility((e=>{n._dropDownVisible=e}))),this._register((0,h.fm)((e=>{this._position.read(e),this.editor.layoutContentWidget(this)}))),this._register((0,h.fm)((e=>{const t=this._suggestionCount.read(e),i=this._currentSuggestionIdx.read(e);void 0!==t?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label="".concat(i+1,"/").concat(t)):this.clearAvailableSuggestionCountLabelDebounced.schedule(),void 0!==t&&t>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()}))),this._register((0,h.fm)((e=>{const t=this._extraCommands.read(e).map((e=>({class:void 0,id:e.id,enabled:!0,tooltip:e.tooltip||"",label:e.title,run:t=>this._commandService.executeCommand(e.id)})));for(const[i,n]of this.inlineCompletionsActionsMenus.getActions())for(const e of n)e instanceof w.Xe&&t.push(e);t.length>0&&t.unshift(new l.wv),this.toolBar.setAdditionalSecondaryActions(t)})))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};P._dropDownVisible=!1,P.id=0,P=n=R([T(6,L.d),T(7,y._Y),T(8,I.b),T(9,S.fN),T(10,w.ez)],P);class O extends o.Z4{constructor(){super(...arguments),this._className=void 0}setClass(e){this._className=e}render(e){super.render(e),this._className&&e.classList.add(this._className)}updateTooltip(){}}class A extends C.oq{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=(0,s.h)("div.keybinding").root;this._register(new r.x(t,g.OS,{disableTitle:!0,...r.l})).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}updateTooltip(){}}let V=class extends _.p{constructor(e,t,i,n,s,o,r,l,a){super(e,{resetMenu:t,...i},n,s,o,r,l,a),this.menuId=t,this.options2=i,this.menuService=n,this.contextKeyService=s,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange((()=>this.updateToolbar()))),this.updateToolbar()}updateToolbar(){var e,t,i,n,s,o,r;const l=[],a=[];(0,C.Ot)(this.menu,null===(e=this.options2)||void 0===e?void 0:e.menuOptions,{primary:l,secondary:a},null===(i=null===(t=this.options2)||void 0===t?void 0:t.toolbarOptions)||void 0===i?void 0:i.primaryGroup,null===(s=null===(n=this.options2)||void 0===n?void 0:n.toolbarOptions)||void 0===s?void 0:s.shouldInlineSubmenu,null===(r=null===(o=this.options2)||void 0===o?void 0:o.toolbarOptions)||void 0===r?void 0:r.useSeparatorsInPrimaryActions),a.push(...this.additionalActions),l.unshift(...this.prependedPrimaryActions),this.setActions(l,a)}setPrependedPrimaryActions(e){(0,a.aI)(this.prependedPrimaryActions,e,((e,t)=>e===t))||(this.prependedPrimaryActions=e,this.updateToolbar())}setAdditionalSecondaryActions(e){(0,a.aI)(this.additionalActions,e,((e,t)=>e===t))||(this.additionalActions=e,this.updateToolbar())}};V=R([T(3,w.ez),T(4,S.fN),T(5,x.Z),T(6,I.b),T(7,L.d),T(8,k.k)],V)},77313:(e,t,i)=>{i.d(t,{GM:()=>c,OA:()=>h,pY:()=>u,tN:()=>g,zk:()=>d});var n=i(29591),s=i(87766),o=i(2698),r=i(23525),l=i(99005);const a=[];function d(){return a}class c{constructor(e,t){if(this.startColumn=e,this.endColumnExclusive=t,e>t)throw new n.D7("startColumn ".concat(e," cannot be after endColumnExclusive ").concat(t))}toRange(e){return new l.Q(e,this.startColumn,e,this.endColumnExclusive)}equals(e){return this.startColumn===e.startColumn&&this.endColumnExclusive===e.endColumnExclusive}}function u(e,t){const i=new s.Cm,n=e.createDecorationsCollection();return i.add((0,o.zL)({debugName:()=>"Apply decorations from ".concat(t.debugName)},(e=>{const i=t.read(e);n.set(i)}))),i.add({dispose:()=>{n.clear()}}),i}function h(e,t){return new r.y(e.lineNumber+t.lineNumber-1,1===t.lineNumber?e.column+t.column-1:t.column)}function g(e,t){return new r.y(e.lineNumber-t.lineNumber+1,e.lineNumber-t.lineNumber===0?e.column-t.column+1:e.column)}},61657:(e,t,i)=>{var n=i(30050),s=i(85287),o=i(72330);var r=i(87766),l=i(2698),a=i(94597),d=i(23525),c=i(99005),u=i(63970),h=i(32743),g=i(23033),p=i(66131),m=i(77313),f=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},v=function(e,t){return function(i,n){t(i,n,e)}};const b="inline-edit";let C=class extends r.jG{constructor(e,t,i){super(),this.editor=e,this.model=t,this.languageService=i,this.isDisposed=(0,l.FY)(this,!1),this.currentTextModel=(0,l.y0)(this.editor.onDidChangeModel,(()=>this.editor.getModel())),this.uiState=(0,l.un)(this,(e=>{var t;if(this.isDisposed.read(e))return;const i=this.currentTextModel.read(e);if(i!==this.model.targetTextModel.read(e))return;const n=this.model.ghostText.read(e);if(!n)return;let s=null===(t=this.model.range)||void 0===t?void 0:t.read(e);s&&s.startLineNumber===s.endLineNumber&&s.startColumn===s.endColumn&&(s=void 0);const o=(!s||s.startLineNumber===s.endLineNumber)&&1===n.parts.length&&1===n.parts[0].lines.length,r=1===n.parts.length&&n.parts[0].lines.every((e=>0===e.length)),l=[],a=[];function d(e,t){if(a.length>0){const i=a[a.length-1];t&&i.decorations.push(new g.d(i.content.length+1,i.content.length+1+e[0].length,t,0)),i.content+=e[0],e=e.slice(1)}for(const i of e)a.push({content:i,decorations:t?[new g.d(1,i.length+1,t,0)]:[]})}const c=i.getLineContent(n.lineNumber);let u,h=0;if(!r){for(const e of n.parts){let t=e.lines;s&&!o&&(d(t,b),t=[]),void 0===u?(l.push({column:e.column,text:t[0],preview:e.preview}),t=t.slice(1)):d([c.substring(h,e.column-1)],void 0),t.length>0&&(d(t,b),void 0===u&&e.column<=c.length&&(u=e.column)),h=e.column-1}void 0!==u&&d([c.substring(h)],void 0)}const p=void 0!==u?new m.GM(u,c.length+1):void 0,f=o||!s?n.lineNumber:s.endLineNumber-1;return{inlineTexts:l,additionalLines:a,hiddenRange:p,lineNumber:f,additionalReservedLineCount:this.model.minReservedLineCount.read(e),targetTextModel:i,range:s,isSingleLine:o,isPureRemove:r,backgroundColoring:this.model.backgroundColoring.read(e)}})),this.decorations=(0,l.un)(this,(e=>{const t=this.uiState.read(e);if(!t)return[];const i=[];if(t.hiddenRange&&i.push({range:t.hiddenRange.toRange(t.lineNumber),options:{inlineClassName:"inline-edit-hidden",description:"inline-edit-hidden"}}),t.range){const e=[];if(t.isSingleLine)e.push(t.range);else if(t.isPureRemove){const i=t.range.endLineNumber-t.range.startLineNumber;for(let n=0;n<i;n++){const i=t.range.startLineNumber+n,s=t.targetTextModel.getLineFirstNonWhitespaceColumn(i),o=t.targetTextModel.getLineLastNonWhitespaceColumn(i),r=new c.Q(i,s,i,o);e.push(r)}}else{const i=t.range.endLineNumber-t.range.startLineNumber;for(let n=0;n<i;n++){const i=t.range.startLineNumber+n,s=t.targetTextModel.getLineFirstNonWhitespaceColumn(i),o=t.targetTextModel.getLineLastNonWhitespaceColumn(i),r=new c.Q(i,s,i,o);e.push(r)}}const n=t.backgroundColoring?"inline-edit-remove backgroundColoring":"inline-edit-remove";for(const t of e)i.push({range:t,options:{inlineClassName:n,description:"inline-edit-remove"}})}for(const n of t.inlineTexts)i.push({range:c.Q.fromPositions(new d.y(t.lineNumber,n.column)),options:{description:b,after:{content:n.text,inlineClassName:n.preview?"inline-edit-decoration-preview":"inline-edit-decoration",cursorStops:h.VW.Left},showIfCollapsed:!0}});return i})),this.additionalLinesWidget=this._register(new p.vS(this.editor,this.languageService.languageIdCodec,(0,l.un)((e=>{const t=this.uiState.read(e);return t&&!t.isPureRemove?{lineNumber:t.lineNumber,additionalLines:t.additionalLines,minReservedLineCount:t.additionalReservedLineCount,targetTextModel:t.targetTextModel}:void 0})))),this._register((0,r.s)((()=>{this.isDisposed.set(!0,void 0)}))),this._register((0,m.pY)(this.editor,this.decorations))}ownsViewZone(e){return this.additionalLinesWidget.viewZoneId===e}};C=f([v(2,u.L)],C);var _,w=i(39686),L=i(39263),S=i(91861),x=i(63910),y=i(25143),I=i(68372),k=i(39587),N=i(32605),R=i(42108),T=i(63169),E=i(61498),D=i(66731),M=i(53073),P=i(45924),O=i(35155),A=i(6748),V=i(16391),W=i(96819),F=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},U=function(e,t){return function(i,n){t(i,n,e)}};let j=class extends r.jG{constructor(e,t,i){super(),this.editor=e,this.model=t,this.instantiationService=i,this.alwaysShowToolbar=(0,l.y0)(this.editor.onDidChangeConfiguration,(()=>"always"===this.editor.getOption(63).showToolbar)),this.sessionPosition=void 0,this.position=(0,l.un)(this,(e=>{var t,i,n;const s=null===(t=this.model.read(e))||void 0===t?void 0:t.widget.model.ghostText.read(e);if(!this.alwaysShowToolbar.read(e)||!s||0===s.parts.length)return this.sessionPosition=void 0,null;const o=s.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==s.lineNumber&&(this.sessionPosition=void 0);const r=new d.y(s.lineNumber,Math.min(o,null!==(n=null===(i=this.sessionPosition)||void 0===i?void 0:i.column)&&void 0!==n?n:Number.MAX_SAFE_INTEGER));return this.sessionPosition=r,r})),this._register((0,l.yC)(((t,i)=>{if(!this.model.read(t)||!this.alwaysShowToolbar.read(t))return;const n=i.add(this.instantiationService.createInstance(B,this.editor,!0,this.position));e.addContentWidget(n),i.add((0,r.s)((()=>e.removeContentWidget(n))))})))}};j=F([U(2,L._Y)],j);let B=_=class extends r.jG{constructor(e,t,i,n,s,o){super(),this.editor=e,this.withBorder=t,this._position=i,this._contextKeyService=s,this._menuService=o,this.id="InlineEditHintsContentWidget".concat(_.id++),this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=(0,N.h)("div.inlineEditHints",{className:this.withBorder?".withBorder":""},[(0,N.h)("div@toolBar")]),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(O.D8.InlineEditActions,this._contextKeyService)),this.toolBar=this._register(n.createInstance(Q,this.nodes.toolBar,this.editor,O.D8.InlineEditToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:e=>e.startsWith("primary")},actionViewItemProvider:(e,t)=>{if(e instanceof O.Xe)return n.createInstance(K,e,void 0)},telemetrySource:"InlineEditToolbar"})),this._register(this.toolBar.onDidChangeDropdownVisibility((e=>{_._dropDownVisible=e}))),this._register((0,l.fm)((e=>{this._position.read(e),this.editor.layoutContentWidget(this)}))),this._register((0,l.fm)((e=>{const t=[];for(const[i,n]of this.inlineCompletionsActionsMenus.getActions())for(const e of n)e instanceof O.Xe&&t.push(e);t.length>0&&t.unshift(new T.wv),this.toolBar.setAdditionalSecondaryActions(t)})))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}};B._dropDownVisible=!1,B.id=0,B=_=F([U(3,L._Y),U(4,w.fN),U(5,O.ez)],B);class K extends M.oq{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=(0,N.h)("div.keybinding").root;this._register(new R.x(t,D.OS,{disableTitle:!0,...R.l})).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineEditStatusBarItemLabel")}}updateTooltip(){}}let Q=class extends P.p{constructor(e,t,i,n,s,o,r,l,a,d){super(e,{resetMenu:i,...n},s,o,r,l,a,d),this.editor=t,this.menuId=i,this.options2=n,this.menuService=s,this.contextKeyService=o,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange((()=>this.updateToolbar()))),this._store.add(this.editor.onDidChangeCursorPosition((()=>this.updateToolbar()))),this.updateToolbar()}updateToolbar(){var e,t,i,n,s,o,r;const l=[],a=[];(0,M.Ot)(this.menu,null===(e=this.options2)||void 0===e?void 0:e.menuOptions,{primary:l,secondary:a},null===(i=null===(t=this.options2)||void 0===t?void 0:t.toolbarOptions)||void 0===i?void 0:i.primaryGroup,null===(s=null===(n=this.options2)||void 0===n?void 0:n.toolbarOptions)||void 0===s?void 0:s.shouldInlineSubmenu,null===(r=null===(o=this.options2)||void 0===o?void 0:o.toolbarOptions)||void 0===r?void 0:r.useSeparatorsInPrimaryActions),a.push(...this.additionalActions),l.unshift(...this.prependedPrimaryActions),this.setActions(l,a)}setAdditionalSecondaryActions(e){(0,E.aI)(this.additionalActions,e,((e,t)=>e===t))||(this.additionalActions=e,this.updateToolbar())}};Q=F([U(4,O.ez),U(5,w.fN),U(6,A.Z),U(7,V.b),U(8,k.d),U(9,W.k)],Q);var q,H=i(66457),G=i(29591),z=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},Z=function(e,t){return function(i,n){t(i,n,e)}};class ${constructor(e,t){this.widget=e,this.edit=t}dispose(){this.widget.dispose()}}let Y=q=class extends r.jG{static get(e){return e.getContribution(q.ID)}constructor(e,t,i,n,s,o){super(),this.editor=e,this.instantiationService=t,this.contextKeyService=i,this.languageFeaturesService=n,this._commandService=s,this._configurationService=o,this._isVisibleContext=q.inlineEditVisibleContext.bindTo(this.contextKeyService),this._isCursorAtInlineEditContext=q.cursorAtInlineEditContext.bindTo(this.contextKeyService),this._currentEdit=this._register((0,l.X2)(this,void 0)),this._isAccepting=(0,l.FY)(this,!1),this._enabled=(0,l.y0)(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(63).enabled)),this._fontFamily=(0,l.y0)(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(63).fontFamily)),this._backgroundColoring=(0,l.y0)(this.editor.onDidChangeConfiguration,(()=>this.editor.getOption(63).backgroundColoring));const r=(0,l.yQ)("InlineEditController.modelContentChangedSignal",e.onDidChangeModelContent);this._register((0,l.fm)((t=>{this._enabled.read(t)&&(r.read(t),this._isAccepting.read(t)||this.getInlineEdit(e,!0))})));const a=(0,l.y0)(e.onDidChangeCursorPosition,(()=>e.getPosition()));this._register((0,l.fm)((e=>{if(!this._enabled.read(e))return;const t=a.read(e);t&&this.checkCursorPosition(t)}))),this._register((0,l.fm)((t=>{const i=this._currentEdit.read(t);if(this._isCursorAtInlineEditContext.set(!1),!i)return void this._isVisibleContext.set(!1);this._isVisibleContext.set(!0);const n=e.getPosition();n&&this.checkCursorPosition(n)})));const d=(0,l.yQ)("InlineEditController.editorBlurSignal",e.onDidBlurEditorWidget);this._register((0,l.fm)((async t=>{var i;this._enabled.read(t)&&(d.read(t),this._configurationService.getValue("editor.experimentalInlineEdit.keepOnBlur")||e.getOption(63).keepOnBlur||(null===(i=this._currentRequestCts)||void 0===i||i.dispose(!0),this._currentRequestCts=void 0,await this.clear(!1)))})));const c=(0,l.yQ)("InlineEditController.editorFocusSignal",e.onDidFocusEditorText);this._register((0,l.fm)((t=>{this._enabled.read(t)&&(c.read(t),this.getInlineEdit(e,!0))})));const u=this._register((0,N.jh)());this._register((0,l.fm)((e=>{const t=this._fontFamily.read(e);u.setStyle(""===t||"default"===t?"":"\n.monaco-editor .inline-edit-decoration,\n.monaco-editor .inline-edit-decoration-preview,\n.monaco-editor .inline-edit {\n\tfont-family: ".concat(t,";\n}"))}))),this._register(new j(this.editor,this._currentEdit,this.instantiationService))}checkCursorPosition(e){var t;if(!this._currentEdit)return void this._isCursorAtInlineEditContext.set(!1);const i=null===(t=this._currentEdit.get())||void 0===t?void 0:t.edit;i?this._isCursorAtInlineEditContext.set(c.Q.containsPosition(i.range,e)):this._isCursorAtInlineEditContext.set(!1)}validateInlineEdit(e,t){var i,n;if(t.text.includes("\n")&&t.range.startLineNumber!==t.range.endLineNumber&&t.range.startColumn!==t.range.endColumn){if(1!==t.range.startColumn)return!1;const s=t.range.endLineNumber;if(t.range.endColumn!==(null!==(n=null===(i=e.getModel())||void 0===i?void 0:i.getLineLength(s))&&void 0!==n?n:0)+1)return!1}return!0}async fetchInlineEdit(e,t){this._currentRequestCts&&this._currentRequestCts.dispose(!0);const i=e.getModel();if(!i)return;const n=i.getVersionId(),s=this.languageFeaturesService.inlineEditProvider.all(i);if(0===s.length)return;const o=s[0];this._currentRequestCts=new y.Qi;const r=this._currentRequestCts.token,l=t?S.sm.Automatic:S.sm.Invoke;var a,d;if(t&&await(a=50,d=r,new Promise((e=>{let t;const i=setTimeout((()=>{t&&t.dispose(),e()}),a);d&&(t=d.onCancellationRequested((()=>{clearTimeout(i),t&&t.dispose(),e()})))}))),r.isCancellationRequested||i.isDisposed()||i.getVersionId()!==n)return;const c=await o.provideInlineEdit(i,{triggerKind:l},r);return c&&!r.isCancellationRequested&&!i.isDisposed()&&i.getVersionId()===n&&this.validateInlineEdit(e,c)?c:void 0}async getInlineEdit(e,t){var i;this._isCursorAtInlineEditContext.set(!1),await this.clear();const n=await this.fetchInlineEdit(e,t);if(!n)return;const s=n.range.endLineNumber,o=n.range.endColumn,r=!n.text.endsWith("\n")||n.range.startLineNumber===n.range.endLineNumber&&n.range.startColumn===n.range.endColumn?n.text:n.text.slice(0,-1),a=new I.xD(s,[new I.yP(o,r,!1)]),d=this.instantiationService.createInstance(C,this.editor,{ghostText:(0,l.lk)(a),minReservedLineCount:(0,l.lk)(0),targetTextModel:(0,l.lk)(null!==(i=this.editor.getModel())&&void 0!==i?i:void 0),range:(0,l.lk)(n.range),backgroundColoring:this._backgroundColoring});this._currentEdit.set(new $(d,n),void 0)}async trigger(){await this.getInlineEdit(this.editor,!1)}async jumpBack(){this._jumpBackPosition&&(this.editor.setPosition(this._jumpBackPosition),this.editor.revealPositionInCenterIfOutsideViewport(this._jumpBackPosition))}async accept(){var e;this._isAccepting.set(!0,void 0);const t=null===(e=this._currentEdit.get())||void 0===e?void 0:e.edit;if(!t)return;let i=t.text;t.text.startsWith("\n")&&(i=t.text.substring(1)),this.editor.pushUndoStop(),this.editor.executeEdits("acceptCurrent",[a.k.replace(c.Q.lift(t.range),i)]),t.accepted&&await this._commandService.executeCommand(t.accepted.id,...t.accepted.arguments||[]).then(void 0,G.M_),this.freeEdit(t),(0,l.Rn)((e=>{this._currentEdit.set(void 0,e),this._isAccepting.set(!1,e)}))}jumpToCurrent(){var e,t;this._jumpBackPosition=null===(e=this.editor.getSelection())||void 0===e?void 0:e.getStartPosition();const i=null===(t=this._currentEdit.get())||void 0===t?void 0:t.edit;if(!i)return;const n=d.y.lift({lineNumber:i.range.startLineNumber,column:i.range.startColumn});this.editor.setPosition(n),this.editor.revealPositionInCenterIfOutsideViewport(n)}async clear(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var t;const i=null===(t=this._currentEdit.get())||void 0===t?void 0:t.edit;i&&(null===i||void 0===i?void 0:i.rejected)&&e&&await this._commandService.executeCommand(i.rejected.id,...i.rejected.arguments||[]).then(void 0,G.M_),i&&this.freeEdit(i),this._currentEdit.set(void 0,void 0)}freeEdit(e){const t=this.editor.getModel();if(!t)return;const i=this.languageFeaturesService.inlineEditProvider.all(t);0!==i.length&&i[0].freeInlineEdit(e)}shouldShowHoverAt(e){const t=this._currentEdit.get();if(!t)return!1;const i=t.edit,n=t.widget.model;if(c.Q.containsPosition(i.range,e.getStartPosition())||c.Q.containsPosition(i.range,e.getEndPosition()))return!0;const s=n.ghostText.get();return!!s&&s.parts.some((t=>e.containsPosition(new d.y(s.lineNumber,t.column))))}shouldShowHoverAtViewZone(e){var t,i;return null!==(i=null===(t=this._currentEdit.get())||void 0===t?void 0:t.widget.ownsViewZone(e))&&void 0!==i&&i}};Y.ID="editor.contrib.inlineEditController",Y.inlineEditVisibleKey="inlineEditVisible",Y.inlineEditVisibleContext=new w.N1(q.inlineEditVisibleKey,!1),Y.cursorAtInlineEditKey="cursorAtInlineEdit",Y.cursorAtInlineEditContext=new w.N1(q.cursorAtInlineEditKey,!1),Y=q=z([Z(1,L._Y),Z(2,w.fN),Z(3,x.u),Z(4,k.d),Z(5,H.pG)],Y);class J extends n.ks{constructor(){super({id:"editor.action.inlineEdit.accept",label:"Accept Inline Edit",alias:"Accept Inline Edit",precondition:w.M$.and(o.R.writable,Y.inlineEditVisibleContext),kbOpts:[{weight:101,primary:2,kbExpr:w.M$.and(o.R.writable,Y.inlineEditVisibleContext,Y.cursorAtInlineEditContext)}],menuOpts:[{menuId:O.D8.InlineEditToolbar,title:"Accept",group:"primary",order:1}]})}async run(e,t){const i=Y.get(t);await(null===i||void 0===i?void 0:i.accept())}}class X extends n.ks{constructor(){const e=w.M$.and(o.R.writable,w.M$.not(Y.inlineEditVisibleKey));super({id:"editor.action.inlineEdit.trigger",label:"Trigger Inline Edit",alias:"Trigger Inline Edit",precondition:e,kbOpts:{weight:101,primary:2646,kbExpr:e}})}async run(e,t){const i=Y.get(t);null===i||void 0===i||i.trigger()}}class ee extends n.ks{constructor(){const e=w.M$.and(o.R.writable,Y.inlineEditVisibleContext,w.M$.not(Y.cursorAtInlineEditKey));super({id:"editor.action.inlineEdit.jumpTo",label:"Jump to Inline Edit",alias:"Jump to Inline Edit",precondition:e,kbOpts:{weight:101,primary:2646,kbExpr:e},menuOpts:[{menuId:O.D8.InlineEditToolbar,title:"Jump To Edit",group:"primary",order:3,when:e}]})}async run(e,t){const i=Y.get(t);null===i||void 0===i||i.jumpToCurrent()}}class te extends n.ks{constructor(){const e=w.M$.and(o.R.writable,Y.cursorAtInlineEditContext);super({id:"editor.action.inlineEdit.jumpBack",label:"Jump Back from Inline Edit",alias:"Jump Back from Inline Edit",precondition:e,kbOpts:{weight:110,primary:2646,kbExpr:e},menuOpts:[{menuId:O.D8.InlineEditToolbar,title:"Jump Back",group:"primary",order:3,when:e}]})}async run(e,t){const i=Y.get(t);null===i||void 0===i||i.jumpBack()}}class ie extends n.ks{constructor(){const e=w.M$.and(o.R.writable,Y.inlineEditVisibleContext);super({id:"editor.action.inlineEdit.reject",label:"Reject Inline Edit",alias:"Reject Inline Edit",precondition:e,kbOpts:{weight:100,primary:9,kbExpr:e},menuOpts:[{menuId:O.D8.InlineEditToolbar,title:"Reject",group:"secondary",order:2}]})}async run(e,t){const i=Y.get(t);await(null===i||void 0===i?void 0:i.clear())}}var ne=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},se=function(e,t){return function(i,n){t(i,n,e)}};class oe{constructor(e,t,i){this.owner=e,this.range=t,this.controller=i}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let re=class{constructor(e,t,i){this._editor=e,this._instantiationService=t,this._telemetryService=i,this.hoverOrdinal=5}suggestHoverAnchor(e){const t=Y.get(this._editor);if(!t)return null;const i=e.target;if(8===i.type){const n=i.detail;if(t.shouldShowHoverAtViewZone(n.viewZoneId)){const t=i.range;return new s.mm(1e3,this,t,e.event.posx,e.event.posy,!1)}}if(7===i.type&&t.shouldShowHoverAt(i.range))return new s.mm(1e3,this,i.range,e.event.posx,e.event.posy,!1);if(6===i.type){if(i.detail.mightBeForeignElement&&t.shouldShowHoverAt(i.range))return new s.mm(1e3,this,i.range,e.event.posx,e.event.posy,!1)}return null}computeSync(e,t){if("onHover"!==this._editor.getOption(63).showToolbar)return[];const i=Y.get(this._editor);return i&&i.shouldShowHoverAt(e.range)?[new oe(this,e.range,i)]:[]}renderHoverParts(e,t){const i=new r.Cm;this._telemetryService.publicLog2("inlineEditHover.shown");const n=this._instantiationService.createInstance(B,this._editor,!1,(0,l.lk)(null));return e.fragment.appendChild(n.getDomNode()),i.add(n),i}};re=ne([se(1,L._Y),se(2,W.k)],re),(0,n.Fl)(J),(0,n.Fl)(ie),(0,n.Fl)(ee),(0,n.Fl)(te),(0,n.Fl)(X),(0,n.HW)(Y.ID,Y,3),s.B2.register(re)},64380:(e,t,i)=>{i.d(t,{I:()=>f});var n=i(32605),s=i(73990),o=i(21030),r=i(87766),l=i(12780),a=i(70145),d=i(99005),c=i(15739),u=i(39263),h=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},g=function(e,t){return function(i,n){t(i,n,e)}};const p=c.kI.register({description:"inline-progress-widget",stickiness:1,showIfCollapsed:!0,after:{content:l.S8,inlineClassName:"inline-editor-progress-decoration",inlineClassNameAffectsLetterSpacing:!0}});class m extends r.jG{constructor(e,t,i,n,s){super(),this.typeId=e,this.editor=t,this.range=i,this.delegate=s,this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this.create(n),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this)}create(e){this.domNode=n.$(".inline-progress-widget"),this.domNode.role="button",this.domNode.title=e;const t=n.$("span.icon");this.domNode.append(t),t.classList.add(...a.L.asClassNameArray(o.W.loading),"codicon-modifier-spin");const i=()=>{const e=this.editor.getOption(67);this.domNode.style.height="".concat(e,"px"),this.domNode.style.width="".concat(Math.ceil(.8*e),"px")};i(),this._register(this.editor.onDidChangeConfiguration((e=>{(e.hasChanged(52)||e.hasChanged(67))&&i()}))),this._register(n.ko(this.domNode,n.Bx.CLICK,(e=>{this.delegate.cancel()})))}getId(){return m.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:{lineNumber:this.range.startLineNumber,column:this.range.startColumn},preference:[0]}}dispose(){super.dispose(),this.editor.removeContentWidget(this)}}m.baseId="editor.widget.inlineProgressWidget";let f=class extends r.jG{constructor(e,t,i){super(),this.id=e,this._editor=t,this._instantiationService=i,this._showDelay=500,this._showPromise=this._register(new r.HE),this._currentWidget=new r.HE,this._operationIdPool=0,this._currentDecorations=t.createDecorationsCollection()}async showWhile(e,t,i){const n=this._operationIdPool++;this._currentOperation=n,this.clear(),this._showPromise.value=(0,s.EQ)((()=>{const n=d.Q.fromPositions(e);this._currentDecorations.set([{range:n,options:p}]).length>0&&(this._currentWidget.value=this._instantiationService.createInstance(m,this.id,this._editor,n,t,i))}),this._showDelay);try{return await i}finally{this._currentOperation===n&&(this.clear(),this._currentOperation=void 0)}}clear(){this._showPromise.clear(),this._currentDecorations.clear(),this._currentWidget.clear()}};f=h([g(2,u._Y)],f)},70392:(e,t,i)=>{var n=i(30050),s=i(11288),o=i(72330),r=i(51413);class l extends n.ks{constructor(){super({id:"expandLineSelection",label:r.kg("expandLineSelection","Expand Line Selection"),alias:"Expand Line Selection",precondition:void 0,kbOpts:{weight:0,kbExpr:o.R.textInputFocus,primary:2090}})}run(e,t,i){if(i=i||{},!t.hasModel())return;const n=t._getViewModel();n.model.pushStackElement(),n.setCursorStates(i.source,3,s.c.expandLineSelection(n,n.getCursorStates())),n.revealAllCursors(i.source,!0)}}(0,n.Fl)(l)},93106:(e,t,i)=>{var n=i(57443),s=i(49300),o=i(30050),r=i(77932),l=i(67599),a=i(85545),d=i(94597),c=i(23525),u=i(99005),h=i(5190),g=i(72330);class p{constructor(e,t,i){this._selection=e,this._isCopyingDown=t,this._noop=i||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(e,t){let i=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,i.startLineNumber<i.endLineNumber&&1===i.endColumn&&(this._endLineNumberDelta=1,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const n=[];for(let o=i.startLineNumber;o<=i.endLineNumber;o++)n.push(e.getLineContent(o));const s=n.join("\n");""===s&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?t.addEditOperation(new u.Q(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber+1,1),i.endLineNumber===e.getLineCount()?"":"\n"):this._isCopyingDown?t.addEditOperation(new u.Q(i.startLineNumber,1,i.startLineNumber,1),s+"\n"):t.addEditOperation(new u.Q(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),"\n"+s),this._selectionId=t.trackSelection(i),this._selectionDirection=this._selection.getDirection()}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);if(0!==this._startLineNumberDelta||0!==this._endLineNumberDelta){let e=i.startLineNumber,t=i.startColumn,n=i.endLineNumber,s=i.endColumn;0!==this._startLineNumberDelta&&(e+=this._startLineNumberDelta,t=1),0!==this._endLineNumberDelta&&(n+=this._endLineNumberDelta,s=1),i=h.L.createWithDirection(e,t,n,s,this._selectionDirection)}return i}}var m=i(12780),f=i(90984),v=i(53966),b=i(80158),C=i(70787),_=i(47893),w=i(89658),L=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},S=function(e,t){return function(i,n){t(i,n,e)}};let x=class{constructor(e,t,i,n){this._languageConfigurationService=n,this._selection=e,this._isMovingDown=t,this._autoIndent=i,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(e,t){const i=e.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===i)return void(this._selectionId=t.trackSelection(this._selection));if(!this._isMovingDown&&1===this._selection.startLineNumber)return void(this._selectionId=t.trackSelection(this._selection));this._moveEndPositionDown=!1;let n=this._selection;n.startLineNumber<n.endLineNumber&&1===n.endColumn&&(this._moveEndPositionDown=!0,n=n.setEndPosition(n.endLineNumber-1,e.getLineMaxColumn(n.endLineNumber-1)));const{tabSize:s,indentSize:o,insertSpaces:r}=e.getOptions(),l=this.buildIndentConverter(s,o,r),a={tokenization:{getLineTokens:t=>e.tokenization.getLineTokens(t),getLanguageId:()=>e.getLanguageId(),getLanguageIdAtPosition:(t,i)=>e.getLanguageIdAtPosition(t,i)},getLineContent:null};if(n.startLineNumber===n.endLineNumber&&1===e.getLineMaxColumn(n.startLineNumber)){const i=n.startLineNumber,s=this._isMovingDown?i+1:i-1;1===e.getLineMaxColumn(s)?t.addEditOperation(new u.Q(1,1,1,1),null):(t.addEditOperation(new u.Q(i,1,i,1),e.getLineContent(s)),t.addEditOperation(new u.Q(s,1,s,e.getLineMaxColumn(s)),null)),n=new h.L(s,1,s,1)}else{let i,o;if(this._isMovingDown){i=n.endLineNumber+1,o=e.getLineContent(i),t.addEditOperation(new u.Q(i-1,e.getLineMaxColumn(i-1),i,e.getLineMaxColumn(i)),null);let d=o;if(this.shouldAutoIndent(e,n)){const c=this.matchEnterRule(e,l,s,i,n.startLineNumber-1);if(null!==c){const t=m.UU(e.getLineContent(i)),n=c+C.c(t,s),l=C.k(n,s,r);d=l+this.trimStart(o)}else{a.getLineContent=t=>t===n.startLineNumber?e.getLineContent(i):e.getLineContent(t);const t=(0,_.$f)(this._autoIndent,a,e.getLanguageIdAtPosition(i,1),n.startLineNumber,l,this._languageConfigurationService);if(null!==t){const n=m.UU(e.getLineContent(i)),l=C.c(t,s);if(l!==C.c(n,s)){const e=C.k(l,s,r);d=e+this.trimStart(o)}}}t.addEditOperation(new u.Q(n.startLineNumber,1,n.startLineNumber,1),d+"\n");const h=this.matchEnterRuleMovingDown(e,l,s,n.startLineNumber,i,d);if(null!==h)0!==h&&this.getIndentEditsOfMovingBlock(e,t,n,s,r,h);else{a.getLineContent=t=>t===n.startLineNumber?d:t>=n.startLineNumber+1&&t<=n.endLineNumber+1?e.getLineContent(t-1):e.getLineContent(t);const o=(0,_.$f)(this._autoIndent,a,e.getLanguageIdAtPosition(i,1),n.startLineNumber+1,l,this._languageConfigurationService);if(null!==o){const i=m.UU(e.getLineContent(n.startLineNumber)),l=C.c(o,s),a=C.c(i,s);if(l!==a){const i=l-a;this.getIndentEditsOfMovingBlock(e,t,n,s,r,i)}}}}else t.addEditOperation(new u.Q(n.startLineNumber,1,n.startLineNumber,1),d+"\n")}else if(i=n.startLineNumber-1,o=e.getLineContent(i),t.addEditOperation(new u.Q(i,1,i+1,1),null),t.addEditOperation(new u.Q(n.endLineNumber,e.getLineMaxColumn(n.endLineNumber),n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),"\n"+o),this.shouldAutoIndent(e,n)){a.getLineContent=t=>t===i?e.getLineContent(n.startLineNumber):e.getLineContent(t);const o=this.matchEnterRule(e,l,s,n.startLineNumber,n.startLineNumber-2);if(null!==o)0!==o&&this.getIndentEditsOfMovingBlock(e,t,n,s,r,o);else{const o=(0,_.$f)(this._autoIndent,a,e.getLanguageIdAtPosition(n.startLineNumber,1),i,l,this._languageConfigurationService);if(null!==o){const i=m.UU(e.getLineContent(n.startLineNumber)),l=C.c(o,s),a=C.c(i,s);if(l!==a){const i=l-a;this.getIndentEditsOfMovingBlock(e,t,n,s,r,i)}}}}}this._selectionId=t.trackSelection(n)}buildIndentConverter(e,t,i){return{shiftIndent:n=>f.Y.shiftIndent(n,n.length+1,e,t,i),unshiftIndent:n=>f.Y.unshiftIndent(n,n.length+1,e,t,i)}}parseEnterResult(e,t,i,n,s){if(s){let o=s.indentation;s.indentAction===v.l.None||s.indentAction===v.l.Indent?o=s.indentation+s.appendText:s.indentAction===v.l.IndentOutdent?o=s.indentation:s.indentAction===v.l.Outdent&&(o=t.unshiftIndent(s.indentation)+s.appendText);const r=e.getLineContent(n);if(this.trimStart(r).indexOf(this.trimStart(o))>=0){const s=m.UU(e.getLineContent(n));let r=m.UU(o);const l=(0,_.Yb)(e,n,this._languageConfigurationService);null!==l&&2&l&&(r=t.unshiftIndent(r));return C.c(r,i)-C.c(s,i)}}return null}matchEnterRuleMovingDown(e,t,i,n,s,o){if(m.lT(o)>=0){const o=e.getLineMaxColumn(s),r=(0,w.h)(this._autoIndent,e,new u.Q(s,o,s,o),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,r)}{let s=n-1;for(;s>=1;){const t=e.getLineContent(s);if(m.lT(t)>=0)break;s--}if(s<1||n>e.getLineCount())return null;const o=e.getLineMaxColumn(s),r=(0,w.h)(this._autoIndent,e,new u.Q(s,o,s,o),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,r)}}matchEnterRule(e,t,i,n,s,o){let r=s;for(;r>=1;){let t;t=r===s&&void 0!==o?o:e.getLineContent(r);if(m.lT(t)>=0)break;r--}if(r<1||n>e.getLineCount())return null;const l=e.getLineMaxColumn(r),a=(0,w.h)(this._autoIndent,e,new u.Q(r,l,r,l),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,a)}trimStart(e){return e.replace(/^\s+/,"")}shouldAutoIndent(e,t){if(this._autoIndent<4)return!1;if(!e.tokenization.isCheapToTokenize(t.startLineNumber))return!1;const i=e.getLanguageIdAtPosition(t.startLineNumber,1);return i===e.getLanguageIdAtPosition(t.endLineNumber,1)&&null!==this._languageConfigurationService.getLanguageConfiguration(i).indentRulesSupport}getIndentEditsOfMovingBlock(e,t,i,n,s,o){for(let r=i.startLineNumber;r<=i.endLineNumber;r++){const l=e.getLineContent(r),a=m.UU(l),d=C.c(a,n)+o,c=C.k(d,n,s);c!==a&&(t.addEditOperation(new u.Q(r,1,r,a.length+1),c),r===i.endLineNumber&&i.endColumn<=a.length+1&&""===c&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&i.startLineNumber<i.endLineNumber&&(i=i.setEndPosition(i.endLineNumber,2)),i}};x=L([S(3,b.JZ)],x);class y{static getCollator(){return y._COLLATOR||(y._COLLATOR=new Intl.Collator),y._COLLATOR}constructor(e,t){this.selection=e,this.descending=t,this.selectionId=null}getEditOperations(e,t){const i=function(e,t,i){const n=I(e,t,i);if(!n)return null;return d.k.replace(new u.Q(n.startLineNumber,1,n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),n.after.join("\n"))}(e,this.selection,this.descending);i&&t.addEditOperation(i.range,i.text),this.selectionId=t.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}static canRun(e,t,i){if(null===e)return!1;const n=I(e,t,i);if(!n)return!1;for(let s=0,o=n.before.length;s<o;s++)if(n.before[s]!==n.after[s])return!0;return!1}}function I(e,t,i){const n=t.startLineNumber;let s=t.endLineNumber;if(1===t.endColumn&&s--,n>=s)return null;const o=[];for(let l=n;l<=s;l++)o.push(e.getLineContent(l));let r=o.slice(0);return r.sort(y.getCollator().compare),!0===i&&(r=r.reverse()),{startLineNumber:n,endLineNumber:s,before:o,after:r}}y._COLLATOR=null;var k=i(51413),N=i(35155),R=i(66457);class T extends o.ks{constructor(e,t){super(t),this.down=e}run(e,t){if(!t.hasModel())return;const i=t.getSelections().map(((e,t)=>({selection:e,index:t,ignore:!1})));i.sort(((e,t)=>u.Q.compareRangesUsingStarts(e.selection,t.selection)));let n=i[0];for(let o=1;o<i.length;o++){const e=i[o];n.selection.endLineNumber===e.selection.startLineNumber&&(n.index<e.index?e.ignore=!0:(n.ignore=!0,n=e))}const s=[];for(const o of i)s.push(new p(o.selection,this.down,o.ignore));t.pushUndoStop(),t.executeCommands(this.id,s),t.pushUndoStop()}}class E extends o.ks{constructor(){super({id:"editor.action.duplicateSelection",label:k.kg("duplicateSelection","Duplicate Selection"),alias:"Duplicate Selection",precondition:g.R.writable,menuOpts:{menuId:N.D8.MenubarSelectionMenu,group:"2_line",title:k.kg({key:"miDuplicateSelection",comment:["&& denotes a mnemonic"]},"&&Duplicate Selection"),order:5}})}run(e,t,i){if(!t.hasModel())return;const n=[],s=t.getSelections(),o=t.getModel();for(const l of s)if(l.isEmpty())n.push(new p(l,!0));else{const e=new h.L(l.endLineNumber,l.endColumn,l.endLineNumber,l.endColumn);n.push(new r.tA(e,o.getValueInRange(l)))}t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class D extends o.ks{constructor(e,t){super(t),this.down=e}run(e,t){const i=e.get(b.JZ),n=[],s=t.getSelections()||[],o=t.getOption(12);for(const r of s)n.push(new x(r,this.down,o,i));t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class M extends o.ks{constructor(e,t){super(t),this.descending=e}run(e,t){if(!t.hasModel())return;const i=t.getModel();let n=t.getSelections();1===n.length&&n[0].isEmpty()&&(n=[new h.L(1,1,i.getLineCount(),i.getLineMaxColumn(i.getLineCount()))]);for(const o of n)if(!y.canRun(t.getModel(),o,this.descending))return;const s=[];for(let o=0,r=n.length;o<r;o++)s[o]=new y(n[o],this.descending);t.pushUndoStop(),t.executeCommands(this.id,s),t.pushUndoStop()}}class P extends o.ks{constructor(){super({id:"editor.action.removeDuplicateLines",label:k.kg("lines.deleteDuplicates","Delete Duplicate Lines"),alias:"Delete Duplicate Lines",precondition:g.R.writable})}run(e,t){if(!t.hasModel())return;const i=t.getModel();if(1===i.getLineCount()&&1===i.getLineMaxColumn(1))return;const n=[],s=[];let o=0,r=!0,l=t.getSelections();1===l.length&&l[0].isEmpty()&&(l=[new h.L(1,1,i.getLineCount(),i.getLineMaxColumn(i.getLineCount()))],r=!1);for(const a of l){const e=new Set,t=[];for(let n=a.startLineNumber;n<=a.endLineNumber;n++){const s=i.getLineContent(n);e.has(s)||(t.push(s),e.add(s))}const r=new h.L(a.startLineNumber,1,a.endLineNumber,i.getLineMaxColumn(a.endLineNumber)),l=a.startLineNumber-o,c=new h.L(l,1,l+t.length-1,t[t.length-1].length);n.push(d.k.replace(r,t.join("\n"))),s.push(c),o+=a.endLineNumber-a.startLineNumber+1-t.length}t.pushUndoStop(),t.executeEdits(this.id,n,r?s:void 0),t.pushUndoStop()}}class O extends o.ks{constructor(){super({id:O.ID,label:k.kg("lines.trimTrailingWhitespace","Trim Trailing Whitespace"),alias:"Trim Trailing Whitespace",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:(0,n.m5)(2089,2102),weight:100}})}run(e,t,i){let n=[];"auto-save"===i.reason&&(n=(t.getSelections()||[]).map((e=>new c.y(e.positionLineNumber,e.positionColumn))));const s=t.getSelection();if(null===s)return;const o=e.get(R.pG),r=t.getModel(),a=o.getValue("files.trimTrailingWhitespaceInRegexAndStrings",{overrideIdentifier:null===r||void 0===r?void 0:r.getLanguageId(),resource:null===r||void 0===r?void 0:r.uri}),d=new l.d(s,n,a);t.pushUndoStop(),t.executeCommands(this.id,[d]),t.pushUndoStop()}}O.ID="editor.action.trimTrailingWhitespace";class A extends o.ks{constructor(){super({id:"editor.action.deleteLines",label:k.kg("lines.delete","Delete Line"),alias:"Delete Line",precondition:g.R.writable,kbOpts:{kbExpr:g.R.textInputFocus,primary:3113,weight:100}})}run(e,t){if(!t.hasModel())return;const i=this._getLinesToRemove(t),n=t.getModel();if(1===n.getLineCount()&&1===n.getLineMaxColumn(1))return;let s=0;const o=[],r=[];for(let l=0,a=i.length;l<a;l++){const e=i[l];let t=e.startLineNumber,a=e.endLineNumber,c=1,u=n.getLineMaxColumn(a);a<n.getLineCount()?(a+=1,u=1):t>1&&(t-=1,c=n.getLineMaxColumn(t)),o.push(d.k.replace(new h.L(t,c,a,u),"")),r.push(new h.L(t-s,e.positionColumn,t-s,e.positionColumn)),s+=e.endLineNumber-e.startLineNumber+1}t.pushUndoStop(),t.executeEdits(this.id,o,r),t.pushUndoStop()}_getLinesToRemove(e){const t=e.getSelections().map((e=>{let t=e.endLineNumber;return e.startLineNumber<e.endLineNumber&&1===e.endColumn&&(t-=1),{startLineNumber:e.startLineNumber,selectionStartColumn:e.selectionStartColumn,endLineNumber:t,positionColumn:e.positionColumn}}));t.sort(((e,t)=>e.startLineNumber===t.startLineNumber?e.endLineNumber-t.endLineNumber:e.startLineNumber-t.startLineNumber));const i=[];let n=t[0];for(let s=1;s<t.length;s++)n.endLineNumber+1>=t[s].startLineNumber?n.endLineNumber=t[s].endLineNumber:(i.push(n),n=t[s]);return i.push(n),i}}class V extends o.ks{constructor(){super({id:"editor.action.indentLines",label:k.kg("lines.indent","Indent Line"),alias:"Indent Line",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:2142,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,a.TK.indent(i.cursorConfig,t.getModel(),t.getSelections())),t.pushUndoStop())}}class W extends o.ks{constructor(){super({id:"editor.action.outdentLines",label:k.kg("lines.outdent","Outdent Line"),alias:"Outdent Line",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:2140,weight:100}})}run(e,t){s.Yh.Outdent.runEditorCommand(e,t,null)}}class F extends o.ks{constructor(){super({id:"editor.action.insertLineBefore",label:k.kg("lines.insertBefore","Insert Line Above"),alias:"Insert Line Above",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:3075,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,a.TK.lineInsertBefore(i.cursorConfig,t.getModel(),t.getSelections())))}}class U extends o.ks{constructor(){super({id:"editor.action.insertLineAfter",label:k.kg("lines.insertAfter","Insert Line Below"),alias:"Insert Line Below",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:2051,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,a.TK.lineInsertAfter(i.cursorConfig,t.getModel(),t.getSelections())))}}class j extends o.ks{run(e,t){if(!t.hasModel())return;const i=t.getSelection(),n=this._getRangesToDelete(t),s=[];for(let l=0,a=n.length-1;l<a;l++){const e=n[l],t=n[l+1];null===u.Q.intersectRanges(e,t)?s.push(e):n[l+1]=u.Q.plusRange(e,t)}s.push(n[n.length-1]);const o=this._getEndCursorState(i,s),r=s.map((e=>d.k.replace(e,"")));t.pushUndoStop(),t.executeEdits(this.id,r,o),t.pushUndoStop()}}class B extends o.ks{constructor(){super({id:"editor.action.joinLines",label:k.kg("lines.joinLines","Join Lines"),alias:"Join Lines",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}run(e,t){const i=t.getSelections();if(null===i)return;let n=t.getSelection();if(null===n)return;i.sort(u.Q.compareRangesUsingStarts);const s=[],o=i.reduce(((e,t)=>e.isEmpty()?e.endLineNumber===t.startLineNumber?(n.equalsSelection(e)&&(n=t),t):t.startLineNumber>e.endLineNumber+1?(s.push(e),t):new h.L(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn):t.startLineNumber>e.endLineNumber?(s.push(e),t):new h.L(e.startLineNumber,e.startColumn,t.endLineNumber,t.endColumn)));s.push(o);const r=t.getModel();if(null===r)return;const l=[],a=[];let c=n,g=0;for(let p=0,m=s.length;p<m;p++){const e=s[p],t=e.startLineNumber,i=1;let o,m,f=0;const v=r.getLineLength(e.endLineNumber)-e.endColumn;if(e.isEmpty()||e.startLineNumber===e.endLineNumber){const i=e.getStartPosition();i.lineNumber<r.getLineCount()?(o=t+1,m=r.getLineMaxColumn(o)):(o=i.lineNumber,m=r.getLineMaxColumn(i.lineNumber))}else o=e.endLineNumber,m=r.getLineMaxColumn(o);let b=r.getLineContent(t);for(let n=t+1;n<=o;n++){const e=r.getLineContent(n),t=r.getLineFirstNonWhitespaceColumn(n);if(t>=1){let i=!0;""===b&&(i=!1),!i||" "!==b.charAt(b.length-1)&&"\t"!==b.charAt(b.length-1)||(i=!1,b=b.replace(/[\s\uFEFF\xA0]+$/g," "));const n=e.substr(t-1);b+=(i?" ":"")+n,f=i?n.length+1:n.length}else f=0}const C=new u.Q(t,i,o,m);if(!C.isEmpty()){let i;e.isEmpty()?(l.push(d.k.replace(C,b)),i=new h.L(C.startLineNumber-g,b.length-f+1,t-g,b.length-f+1)):e.startLineNumber===e.endLineNumber?(l.push(d.k.replace(C,b)),i=new h.L(e.startLineNumber-g,e.startColumn,e.endLineNumber-g,e.endColumn)):(l.push(d.k.replace(C,b)),i=new h.L(e.startLineNumber-g,e.startColumn,e.startLineNumber-g,b.length-v)),null!==u.Q.intersectRanges(C,n)?c=i:a.push(i)}g+=C.endLineNumber-C.startLineNumber}a.unshift(c),t.pushUndoStop(),t.executeEdits(this.id,l,a),t.pushUndoStop()}}class K extends o.ks{constructor(){super({id:"editor.action.transpose",label:k.kg("editor.transpose","Transpose Characters around the Cursor"),alias:"Transpose Characters around the Cursor",precondition:g.R.writable})}run(e,t){const i=t.getSelections();if(null===i)return;const n=t.getModel();if(null===n)return;const s=[];for(let o=0,l=i.length;o<l;o++){const e=i[o];if(!e.isEmpty())continue;const t=e.getStartPosition(),l=n.getLineMaxColumn(t.lineNumber);if(t.column>=l){if(t.lineNumber===n.getLineCount())continue;const e=new u.Q(t.lineNumber,Math.max(1,t.column-1),t.lineNumber+1,1),i=n.getValueInRange(e).split("").reverse().join("");s.push(new r.iu(new h.L(t.lineNumber,Math.max(1,t.column-1),t.lineNumber+1,1),i))}else{const e=new u.Q(t.lineNumber,Math.max(1,t.column-1),t.lineNumber,t.column+1),i=n.getValueInRange(e).split("").reverse().join("");s.push(new r.ui(e,i,new h.L(t.lineNumber,t.column+1,t.lineNumber,t.column+1)))}}t.pushUndoStop(),t.executeCommands(this.id,s),t.pushUndoStop()}}class Q extends o.ks{run(e,t){const i=t.getSelections();if(null===i)return;const n=t.getModel();if(null===n)return;const s=t.getOption(131),o=[];for(const r of i)if(r.isEmpty()){const e=r.getStartPosition(),i=t.getConfiguredWordAtPosition(e);if(!i)continue;const l=new u.Q(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn),a=n.getValueInRange(l);o.push(d.k.replace(l,this._modifyText(a,s)))}else{const e=n.getValueInRange(r);o.push(d.k.replace(r,this._modifyText(e,s)))}t.pushUndoStop(),t.executeEdits(this.id,o),t.pushUndoStop()}}class q{constructor(e,t){this._pattern=e,this._flags=t,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch(e){}}return this._actual}isSupported(){return null!==this.get()}}class H extends Q{constructor(){super({id:"editor.action.transformToTitlecase",label:k.kg("editor.transformToTitlecase","Transform to Title Case"),alias:"Transform to Title Case",precondition:g.R.writable})}_modifyText(e,t){const i=H.titleBoundary.get();return i?e.toLocaleLowerCase().replace(i,(e=>e.toLocaleUpperCase())):e}}H.titleBoundary=new q("(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}","gmu");class G extends Q{constructor(){super({id:"editor.action.transformToSnakecase",label:k.kg("editor.transformToSnakecase","Transform to Snake Case"),alias:"Transform to Snake Case",precondition:g.R.writable})}_modifyText(e,t){const i=G.caseBoundary.get(),n=G.singleLetters.get();return i&&n?e.replace(i,"$1_$2").replace(n,"$1_$2$3").toLocaleLowerCase():e}}G.caseBoundary=new q("(\\p{Ll})(\\p{Lu})","gmu"),G.singleLetters=new q("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu");class z extends Q{constructor(){super({id:"editor.action.transformToCamelcase",label:k.kg("editor.transformToCamelcase","Transform to Camel Case"),alias:"Transform to Camel Case",precondition:g.R.writable})}_modifyText(e,t){const i=z.wordBoundary.get();if(!i)return e;const n=e.split(i);return n.shift()+n.map((e=>e.substring(0,1).toLocaleUpperCase()+e.substring(1))).join("")}}z.wordBoundary=new q("[_\\s-]","gm");class Z extends Q{constructor(){super({id:"editor.action.transformToPascalcase",label:k.kg("editor.transformToPascalcase","Transform to Pascal Case"),alias:"Transform to Pascal Case",precondition:g.R.writable})}_modifyText(e,t){const i=Z.wordBoundary.get(),n=Z.wordBoundaryToMaintain.get();if(!i||!n)return e;return e.split(n).map((e=>e.split(i))).flat().map((e=>e.substring(0,1).toLocaleUpperCase()+e.substring(1))).join("")}}Z.wordBoundary=new q("[_\\s-]","gm"),Z.wordBoundaryToMaintain=new q("(?<=\\.)","gm");class $ extends Q{static isSupported(){return[this.caseBoundary,this.singleLetters,this.underscoreBoundary].every((e=>e.isSupported()))}constructor(){super({id:"editor.action.transformToKebabcase",label:k.kg("editor.transformToKebabcase","Transform to Kebab Case"),alias:"Transform to Kebab Case",precondition:g.R.writable})}_modifyText(e,t){const i=$.caseBoundary.get(),n=$.singleLetters.get(),s=$.underscoreBoundary.get();return i&&n&&s?e.replace(s,"$1-$3").replace(i,"$1-$2").replace(n,"$1-$2").toLocaleLowerCase():e}}$.caseBoundary=new q("(\\p{Ll})(\\p{Lu})","gmu"),$.singleLetters=new q("(\\p{Lu}|\\p{N})(\\p{Lu}\\p{Ll})","gmu"),$.underscoreBoundary=new q("(\\S)(_)(\\S)","gm"),(0,o.Fl)(class extends T{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:k.kg("lines.copyUp","Copy Line Up"),alias:"Copy Line Up",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:N.D8.MenubarSelectionMenu,group:"2_line",title:k.kg({key:"miCopyLinesUp",comment:["&& denotes a mnemonic"]},"&&Copy Line Up"),order:1}})}}),(0,o.Fl)(class extends T{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:k.kg("lines.copyDown","Copy Line Down"),alias:"Copy Line Down",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:N.D8.MenubarSelectionMenu,group:"2_line",title:k.kg({key:"miCopyLinesDown",comment:["&& denotes a mnemonic"]},"Co&&py Line Down"),order:2}})}}),(0,o.Fl)(E),(0,o.Fl)(class extends D{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:k.kg("lines.moveUp","Move Line Up"),alias:"Move Line Up",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:N.D8.MenubarSelectionMenu,group:"2_line",title:k.kg({key:"miMoveLinesUp",comment:["&& denotes a mnemonic"]},"Mo&&ve Line Up"),order:3}})}}),(0,o.Fl)(class extends D{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:k.kg("lines.moveDown","Move Line Down"),alias:"Move Line Down",precondition:g.R.writable,kbOpts:{kbExpr:g.R.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:N.D8.MenubarSelectionMenu,group:"2_line",title:k.kg({key:"miMoveLinesDown",comment:["&& denotes a mnemonic"]},"Move &&Line Down"),order:4}})}}),(0,o.Fl)(class extends M{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:k.kg("lines.sortAscending","Sort Lines Ascending"),alias:"Sort Lines Ascending",precondition:g.R.writable})}}),(0,o.Fl)(class extends M{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:k.kg("lines.sortDescending","Sort Lines Descending"),alias:"Sort Lines Descending",precondition:g.R.writable})}}),(0,o.Fl)(P),(0,o.Fl)(O),(0,o.Fl)(A),(0,o.Fl)(V),(0,o.Fl)(W),(0,o.Fl)(F),(0,o.Fl)(U),(0,o.Fl)(class extends j{constructor(){super({id:"deleteAllLeft",label:k.kg("lines.deleteAllLeft","Delete All Left"),alias:"Delete All Left",precondition:g.R.writable,kbOpts:{kbExpr:g.R.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}_getEndCursorState(e,t){let i=null;const n=[];let s=0;return t.forEach((t=>{let o;if(1===t.endColumn&&s>0){const e=t.startLineNumber-s;o=new h.L(e,t.startColumn,e,t.startColumn)}else o=new h.L(t.startLineNumber,t.startColumn,t.startLineNumber,t.startColumn);s+=t.endLineNumber-t.startLineNumber,t.intersectRanges(e)?i=o:n.push(o)})),i&&n.unshift(i),n}_getRangesToDelete(e){const t=e.getSelections();if(null===t)return[];let i=t;const n=e.getModel();return null===n?[]:(i.sort(u.Q.compareRangesUsingStarts),i=i.map((e=>{if(e.isEmpty()){if(1===e.startColumn){const t=Math.max(1,e.startLineNumber-1),i=1===e.startLineNumber?1:n.getLineLength(t)+1;return new u.Q(t,i,e.startLineNumber,1)}return new u.Q(e.startLineNumber,1,e.startLineNumber,e.startColumn)}return new u.Q(e.startLineNumber,1,e.endLineNumber,e.endColumn)})),i)}}),(0,o.Fl)(class extends j{constructor(){super({id:"deleteAllRight",label:k.kg("lines.deleteAllRight","Delete All Right"),alias:"Delete All Right",precondition:g.R.writable,kbOpts:{kbExpr:g.R.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}_getEndCursorState(e,t){let i=null;const n=[];for(let s=0,o=t.length,r=0;s<o;s++){const o=t[s],l=new h.L(o.startLineNumber-r,o.startColumn,o.startLineNumber-r,o.startColumn);o.intersectRanges(e)?i=l:n.push(l)}return i&&n.unshift(i),n}_getRangesToDelete(e){const t=e.getModel();if(null===t)return[];const i=e.getSelections();if(null===i)return[];const n=i.map((e=>{if(e.isEmpty()){const i=t.getLineMaxColumn(e.startLineNumber);return e.startColumn===i?new u.Q(e.startLineNumber,e.startColumn,e.startLineNumber+1,1):new u.Q(e.startLineNumber,e.startColumn,e.startLineNumber,i)}return e}));return n.sort(u.Q.compareRangesUsingStarts),n}}),(0,o.Fl)(B),(0,o.Fl)(K),(0,o.Fl)(class extends Q{constructor(){super({id:"editor.action.transformToUppercase",label:k.kg("editor.transformToUppercase","Transform to Uppercase"),alias:"Transform to Uppercase",precondition:g.R.writable})}_modifyText(e,t){return e.toLocaleUpperCase()}}),(0,o.Fl)(class extends Q{constructor(){super({id:"editor.action.transformToLowercase",label:k.kg("editor.transformToLowercase","Transform to Lowercase"),alias:"Transform to Lowercase",precondition:g.R.writable})}_modifyText(e,t){return e.toLocaleLowerCase()}}),G.caseBoundary.isSupported()&&G.singleLetters.isSupported()&&(0,o.Fl)(G),z.wordBoundary.isSupported()&&(0,o.Fl)(z),Z.wordBoundary.isSupported()&&(0,o.Fl)(Z),H.titleBoundary.isSupported()&&(0,o.Fl)(H),$.isSupported()&&(0,o.Fl)($)},15259:(e,t,i)=>{var n,s=i(61498),o=i(73990),r=i(25143),l=i(57397),a=i(29591),d=i(48250),c=i(87766),u=i(12780),h=i(97072),g=i(30050),p=i(32101),m=i(23525),f=i(99005),v=i(72330),b=i(15739),C=i(80158),_=i(51413),w=i(39686),L=i(63910),S=i(63573),x=i(50044),y=i(40997),I=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},k=function(e,t){return function(i,n){t(i,n,e)}};const N=new w.N1("LinkedEditingInputVisible",!1);let R=n=class extends c.jG{static get(e){return e.getContribution(n.ID)}constructor(e,t,i,n,s){super(),this.languageConfigurationService=n,this._syncRangesToken=0,this._localToDispose=this._register(new c.Cm),this._editor=e,this._providers=i.linkedEditingRangeProvider,this._enabled=!1,this._visibleContextKey=N.bindTo(t),this._debounceInformation=s.for(this._providers,"Linked Editing",{max:200}),this._currentDecorations=this._editor.createDecorationsCollection(),this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new c.Cm),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequestCts=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel((()=>this.reinitialize(!0)))),this._register(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(70)||e.hasChanged(93))&&this.reinitialize(!1)}))),this._register(this._providers.onDidChange((()=>this.reinitialize(!1)))),this._register(this._editor.onDidChangeModelLanguage((()=>this.reinitialize(!0)))),this.reinitialize(!0)}reinitialize(e){const t=this._editor.getModel(),i=null!==t&&(this._editor.getOption(70)||this._editor.getOption(93))&&this._providers.has(t);if(i===this._enabled&&!e)return;if(this._enabled=i,this.clearRanges(),this._localToDispose.clear(),!i||null===t)return;this._localToDispose.add(d.Jh.runAndSubscribe(t.onDidChangeLanguageConfiguration,(()=>{this._languageWordPattern=this.languageConfigurationService.getLanguageConfiguration(t.getLanguageId()).getWordDefinition()})));const n=new o.ve(this._debounceInformation.get(t)),s=()=>{var e;this._rangeUpdateTriggerPromise=n.trigger((()=>this.updateRanges()),null!==(e=this._debounceDuration)&&void 0!==e?e:this._debounceInformation.get(t))},r=new o.ve(0),l=e=>{this._rangeSyncTriggerPromise=r.trigger((()=>this._syncRanges(e)))};this._localToDispose.add(this._editor.onDidChangeCursorPosition((()=>{s()}))),this._localToDispose.add(this._editor.onDidChangeModelContent((e=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const t=this._currentDecorations.getRange(0);if(t&&e.changes.every((e=>t.intersectRanges(e.range))))return void l(this._syncRangesToken)}s()}))),this._localToDispose.add({dispose:()=>{n.dispose(),r.dispose()}}),this.updateRanges()}_syncRanges(e){if(!this._editor.hasModel()||e!==this._syncRangesToken||0===this._currentDecorations.length)return;const t=this._editor.getModel(),i=this._currentDecorations.getRange(0);if(!i||i.startLineNumber!==i.endLineNumber)return this.clearRanges();const n=t.getValueInRange(i);if(this._currentWordPattern){const e=n.match(this._currentWordPattern);if((e?e[0].length:0)!==n.length)return this.clearRanges()}const s=[];for(let o=1,r=this._currentDecorations.length;o<r;o++){const e=this._currentDecorations.getRange(o);if(e)if(e.startLineNumber!==e.endLineNumber)s.push({range:e,text:n});else{let i=t.getValueInRange(e),o=n,r=e.startColumn,l=e.endColumn;const a=u.Qp(i,o);r+=a,i=i.substr(a),o=o.substr(a);const d=u.Vi(i,o);l-=d,i=i.substr(0,i.length-d),o=o.substr(0,o.length-d),r===l&&0===o.length||s.push({range:new f.Q(e.startLineNumber,r,e.endLineNumber,l),text:o})}}if(0!==s.length)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const e=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",s),this._editor._getViewModel().setPrevEditOperationType(e)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations.clear(),this._currentRequestCts&&(this._currentRequestCts.cancel(),this._currentRequestCts=null,this._currentRequestPosition=null)}async updateRanges(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._editor.hasModel())return void this.clearRanges();const t=this._editor.getPosition();if(!this._enabled&&!e||this._editor.getSelections().length>1)return void this.clearRanges();const i=this._editor.getModel(),s=i.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===s){if(t.equals(this._currentRequestPosition))return;if(this._currentDecorations.length>0){const e=this._currentDecorations.getRange(0);if(e&&e.containsPosition(t))return}}this.clearRanges(),this._currentRequestPosition=t,this._currentRequestModelVersion=s;const o=this._currentRequestCts=new r.Qi;try{const e=new y.W(!1),r=await D(this._providers,i,t,o.token);if(this._debounceInformation.update(i,e.elapsed()),o!==this._currentRequestCts)return;if(this._currentRequestCts=null,s!==i.getVersionId())return;let l=[];(null===r||void 0===r?void 0:r.ranges)&&(l=r.ranges),this._currentWordPattern=(null===r||void 0===r?void 0:r.wordPattern)||this._languageWordPattern;let a=!1;for(let i=0,n=l.length;i<n;i++)if(f.Q.containsPosition(l[i],t)){if(a=!0,0!==i){const e=l[i];l.splice(i,1),l.unshift(e)}break}if(!a)return void this.clearRanges();const d=l.map((e=>({range:e,options:n.DECORATION})));this._visibleContextKey.set(!0),this._currentDecorations.set(d),this._syncRangesToken++}catch(l){(0,a.MB)(l)||(0,a.dz)(l),this._currentRequestCts!==o&&this._currentRequestCts||this.clearRanges()}}};R.ID="editor.contrib.linkedEditing",R.DECORATION=b.kI.register({description:"linked-editing",stickiness:0,className:"linked-editing-decoration"}),R=n=I([k(1,w.fN),k(2,L.u),k(3,C.JZ),k(4,x.U)],R);class T extends g.ks{constructor(){super({id:"editor.action.linkedEditing",label:_.kg("linkedEditing.label","Start Linked Editing"),alias:"Start Linked Editing",precondition:w.M$.and(v.R.writable,v.R.hasRenameProvider),kbOpts:{kbExpr:v.R.editorTextFocus,primary:3132,weight:100}})}runCommand(e,t){const i=e.get(p.T),[n,s]=Array.isArray(t)&&t||[void 0,void 0];return h.r.isUri(n)&&m.y.isIPosition(s)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then((e=>{e&&(e.setPosition(s),e.invokeWithinContext((t=>(this.reportTelemetry(t,e),this.run(t,e)))))}),a.dz):super.runCommand(e,t)}run(e,t){const i=R.get(t);return i?Promise.resolve(i.updateRanges(!0)):Promise.resolve()}}const E=g.DX.bindToContribution(R.get);function D(e,t,i,n){const r=e.ordered(t);return(0,o.$1)(r.map((e=>async()=>{try{return await e.provideLinkedEditingRanges(t,i,n)}catch(s){return void(0,a.M_)(s)}})),(e=>!!e&&s.EI(null===e||void 0===e?void 0:e.ranges)))}(0,g.E_)(new E({id:"cancelLinkedEditingInput",precondition:N,handler:e=>e.clearRanges(),kbOpts:{kbExpr:v.R.editorTextFocus,weight:199,primary:9,secondary:[1033]}}));(0,S.x1A)("editor.linkedEditingBackground",{dark:l.Q1.fromHex("#f00").transparent(.3),light:l.Q1.fromHex("#f00").transparent(.3),hcDark:l.Q1.fromHex("#f00").transparent(.3),hcLight:l.Q1.white},_.kg("editorLinkedEditingBackground","Background color when the editor auto renames on type."));(0,g.ke)("_executeLinkedEditingProvider",((e,t,i)=>{const{linkedEditingRangeProvider:n}=e.get(L.u);return D(n,t,i,r.XO.None)})),(0,g.HW)(R.ID,R,1),(0,g.Fl)(T)},25614:(e,t,i)=>{var n=i(73990),s=i(25143),o=i(29591),r=i(58348),l=i(87766),a=i(83888),d=i(66731),c=i(53059),u=i(40997),h=i(97072),g=i(30050),p=i(15739),m=i(50044),f=i(63910),v=i(59183),b=i(61498),C=i(32031),_=i(99005),w=i(21950),L=i(39587);class S{constructor(e,t){this._link=e,this._provider=t}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}async resolve(e){return this._link.url?this._link.url:"function"===typeof this._provider.resolveLink?Promise.resolve(this._provider.resolveLink(this._link,e)).then((t=>(this._link=t||this._link,this._link.url?this.resolve(e):Promise.reject(new Error("missing"))))):Promise.reject(new Error("missing"))}}class x{constructor(e){this._disposables=new l.Cm;let t=[];for(const[i,n]of e){const e=i.links.map((e=>new S(e,n)));t=x._union(t,e),(0,l.Xm)(i)&&this._disposables.add(i)}this.links=t}dispose(){this._disposables.dispose(),this.links.length=0}static _union(e,t){const i=[];let n,s,o,r;for(n=0,o=0,s=e.length,r=t.length;n<s&&o<r;){const s=e[n],r=t[o];if(_.Q.areIntersectingOrTouching(s.range,r.range)){n++;continue}_.Q.compareRangesUsingStarts(s.range,r.range)<0?(i.push(s),n++):(i.push(r),o++)}for(;n<s;n++)i.push(e[n]);for(;o<r;o++)i.push(t[o]);return i}}function y(e,t,i){const n=[],s=e.ordered(t).reverse().map(((e,s)=>Promise.resolve(e.provideLinks(t,i)).then((t=>{t&&(n[s]=[t,e])}),o.M_)));return Promise.all(s).then((()=>{const e=new x((0,b.Yc)(n));return i.isCancellationRequested?(e.dispose(),new x([])):e}))}L.w.registerCommand("_executeLinkProvider",(async function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];let[o,r]=i;(0,C.j)(o instanceof h.r),"number"!==typeof r&&(r=0);const{linkProvider:l}=e.get(f.u),a=e.get(w.S).getModel(o);if(!a)return[];const d=await y(l,a,s.XO.None);if(!d)return[];for(let u=0;u<Math.min(r,d.links.length);u++)await d.links[u].resolve(s.XO.None);const c=d.links.slice(0);return d.dispose(),c}));var I,k=i(51413),N=i(39895),R=i(2531),T=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},E=function(e,t){return function(i,n){t(i,n,e)}};let D=I=class extends l.jG{static get(e){return e.getContribution(I.ID)}constructor(e,t,i,s,o){super(),this.editor=e,this.openerService=t,this.notificationService=i,this.languageFeaturesService=s,this.providers=this.languageFeaturesService.linkProvider,this.debounceInformation=o.for(this.providers,"Links",{min:1e3,max:4e3}),this.computeLinks=this._register(new n.uC((()=>this.computeLinksNow()),1e3)),this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null;const r=this._register(new v.gi(e));this._register(r.onMouseMoveOrRelevantKeyDown((e=>{let[t,i]=e;this._onEditorMouseMove(t,i)}))),this._register(r.onExecute((e=>{this.onEditorMouseUp(e)}))),this._register(r.onCancel((e=>{this.cleanUpActiveLinkDecoration()}))),this._register(e.onDidChangeConfiguration((e=>{e.hasChanged(71)&&(this.updateDecorations([]),this.stop(),this.computeLinks.schedule(0))}))),this._register(e.onDidChangeModelContent((e=>{this.editor.hasModel()&&this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()))}))),this._register(e.onDidChangeModel((e=>{this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.computeLinks.schedule(0)}))),this._register(e.onDidChangeModelLanguage((e=>{this.stop(),this.computeLinks.schedule(0)}))),this._register(this.providers.onDidChange((e=>{this.stop(),this.computeLinks.schedule(0)}))),this.computeLinks.schedule(0)}async computeLinksNow(){if(!this.editor.hasModel()||!this.editor.getOption(71))return;const e=this.editor.getModel();if(!e.isTooLargeForSyncing()&&this.providers.has(e)){this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=(0,n.SS)((t=>y(this.providers,e,t)));try{const t=new u.W(!1);if(this.activeLinksList=await this.computePromise,this.debounceInformation.update(e,t.elapsed()),e.isDisposed())return;this.updateDecorations(this.activeLinksList.links)}catch(t){(0,o.dz)(t)}finally{this.computePromise=null}}}updateDecorations(e){const t="altKey"===this.editor.getOption(78),i=[],n=Object.keys(this.currentOccurrences);for(const o of n){const e=this.currentOccurrences[o];i.push(e.decorationId)}const s=[];if(e)for(const o of e)s.push(O.decoration(o,t));this.editor.changeDecorations((t=>{const n=t.deltaDecorations(i,s);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let i=0,s=n.length;i<s;i++){const t=new O(e[i],n[i]);this.currentOccurrences[t.decorationId]=t}}))}_onEditorMouseMove(e,t){const i="altKey"===this.editor.getOption(78);if(this.isEnabled(e,t)){this.cleanUpActiveLinkDecoration();const t=this.getLinkOccurrence(e.target.position);t&&this.editor.changeDecorations((e=>{t.activate(e,i),this.activeLinkDecorationId=t.decorationId}))}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const e="altKey"===this.editor.getOption(78);if(this.activeLinkDecorationId){const t=this.currentOccurrences[this.activeLinkDecorationId];t&&this.editor.changeDecorations((i=>{t.deactivate(i,e)})),this.activeLinkDecorationId=null}}onEditorMouseUp(e){if(!this.isEnabled(e))return;const t=this.getLinkOccurrence(e.target.position);t&&this.openLinkOccurrence(t,e.hasSideBySideModifier,!0)}openLinkOccurrence(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.openerService)return;const{link:n}=e;n.resolve(s.XO.None).then((e=>{if("string"===typeof e&&this.editor.hasModel()){const t=this.editor.getModel().uri;if(t.scheme===a.ny.file&&e.startsWith("".concat(a.ny.file,":"))){const i=h.r.parse(e);if(i.scheme===a.ny.file){const n=c.su(i);let s=null;n.startsWith("/./")||n.startsWith("\\.\\")?s=".".concat(n.substr(1)):(n.startsWith("//./")||n.startsWith("\\\\.\\"))&&(s=".".concat(n.substr(2))),s&&(e=c.uJ(t,s))}}}return this.openerService.open(e,{openToSide:t,fromUserGesture:i,allowContributedOpeners:!0,allowCommands:!0,fromWorkspace:!0})}),(e=>{const t=e instanceof Error?e.message:e;"invalid"===t?this.notificationService.warn(k.kg("invalid.url","Failed to open this link because it is not well-formed: {0}",n.url.toString())):"missing"===t?this.notificationService.warn(k.kg("missing.url","Failed to open this link because its target is missing.")):(0,o.dz)(e)}))}getLinkOccurrence(e){if(!this.editor.hasModel()||!e)return null;const t=this.editor.getModel().getDecorationsInRange({startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},0,!0);for(const i of t){const e=this.currentOccurrences[i.id];if(e)return e}return null}isEnabled(e,t){return Boolean(6===e.target.type&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey))}stop(){var e;this.computeLinks.cancel(),this.activeLinksList&&(null===(e=this.activeLinksList)||void 0===e||e.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop()}};D.ID="editor.linkDetector",D=I=T([E(1,R.C),E(2,N.Ot),E(3,f.u),E(4,m.U)],D);const M=p.kI.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),P=p.kI.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"});class O{static decoration(e,t){return{range:e.range,options:O._getOptions(e,t,!1)}}static _getOptions(e,t,i){const n={...i?P:M};return n.hoverMessage=function(e,t){const i=e.url&&/^command:/i.test(e.url.toString()),n=e.tooltip?e.tooltip:i?k.kg("links.navigate.executeCmd","Execute command"):k.kg("links.navigate.follow","Follow link"),s=t?d.zx?k.kg("links.navigate.kb.meta.mac","cmd + click"):k.kg("links.navigate.kb.meta","ctrl + click"):d.zx?k.kg("links.navigate.kb.alt.mac","option + click"):k.kg("links.navigate.kb.alt","alt + click");if(e.url){let t="";if(/^command:/i.test(e.url.toString())){const i=e.url.toString().match(/^command:([^?#]+)/);if(i){const e=i[1];t=k.kg("tooltip.explanation","Execute command {0}",e)}}return new r.Bc("",!0).appendLink(e.url.toString(!0).replace(/ /g,"%20"),n,t).appendMarkdown(" (".concat(s,")"))}return(new r.Bc).appendText("".concat(n," (").concat(s,")"))}(e,t),n}constructor(e,t){this.link=e,this.decorationId=t}activate(e,t){e.changeDecorationOptions(this.decorationId,O._getOptions(this.link,t,!0))}deactivate(e,t){e.changeDecorationOptions(this.decorationId,O._getOptions(this.link,t,!1))}}class A extends g.ks{constructor(){super({id:"editor.action.openLink",label:k.kg("label","Open Link"),alias:"Open Link",precondition:void 0})}run(e,t){const i=D.get(t);if(!i)return;if(!t.hasModel())return;const n=t.getSelections();for(const s of n){const e=i.getLinkOccurrence(s.getEndPosition());e&&i.openLinkOccurrence(e,!1)}}}(0,g.HW)(D.ID,D,1),(0,g.Fl)(A)}}]);
//# sourceMappingURL=monaco-editor-vendor.d4d9fc54.f267cf94.js.map