"use strict";(self.webpackChunkmonaco_editor_nginx=self.webpackChunkmonaco_editor_nginx||[]).push([[7332],{90969:function(e,i,t){var n=t(37762),o=t(15671),r=t(43144),a=t(60136),d=t(27277),s=t(76257),l=t(98926),u=t(18420),f=t(14443),c=t(99740),g=t(8022),h={value:(0,u.NC)("accessibleDiffViewer","Accessible Diff Viewer"),original:"Accessible Diff Viewer"},v=function(e){(0,a.Z)(t,e);var i=(0,d.Z)(t);function t(){return(0,o.Z)(this,t),i.call(this,{id:t.id,title:{value:(0,u.NC)("editor.action.accessibleDiffViewer.next","Go to Next Difference"),original:"Go to Next Difference"},category:h,precondition:g.Ao.has("isInDiffEditor"),keybinding:{primary:65,weight:100},f1:!0})}return(0,r.Z)(t,[{key:"run",value:function(e){var i=_(e);null===i||void 0===i||i.accessibleDiffViewerNext()}}]),t}(f.Ke);v.id="editor.action.accessibleDiffViewer.next",f.BH.appendMenuItem(f.eH.EditorTitle,{command:{id:v.id,title:(0,u.NC)("Open Accessible Diff Viewer","Open Accessible Diff Viewer")},order:10,group:"2_diff",when:g.Ao.and(l.u.accessibleDiffViewerVisible.negate(),g.Ao.has("isInDiffEditor"))});var m=function(e){(0,a.Z)(t,e);var i=(0,d.Z)(t);function t(){return(0,o.Z)(this,t),i.call(this,{id:t.id,title:{value:(0,u.NC)("editor.action.accessibleDiffViewer.prev","Go to Previous Difference"),original:"Go to Previous Difference"},category:h,precondition:g.Ao.has("isInDiffEditor"),keybinding:{primary:1089,weight:100},f1:!0})}return(0,r.Z)(t,[{key:"run",value:function(e){var i=_(e);null===i||void 0===i||i.accessibleDiffViewerPrev()}}]),t}(f.Ke);function _(e){var i,t=e.get(s.$),o=t.listDiffEditors(),r=null!==(i=t.getFocusedCodeEditor())&&void 0!==i?i:t.getActiveCodeEditor();if(!r)return null;for(var a=0,d=o.length;a<d;a++){var l=o[a];if(l.getModifiedEditor().getId()===r.getId()||l.getOriginalEditor().getId()===r.getId())return l}if(document.activeElement){var u,f=(0,n.Z)(o);try{for(f.s();!(u=f.n()).done;){var c=u.value;if(p(c.getContainerDomNode(),document.activeElement))return c}}catch(g){f.e(g)}finally{f.f()}}return null}function p(e,i){for(var t=i;t;){if(t===e)return!0;t=t.parentElement}return!1}m.id="editor.action.accessibleDiffViewer.prev",c.P.registerCommandAlias("editor.action.diffReview.next",v.id),(0,f.r1)(v),c.P.registerCommandAlias("editor.action.diffReview.prev",m.id),(0,f.r1)(m)},69846:function(e,i,t){t.d(i,{p:function(){return ve},N:function(){return ge}});var n=t(74165),o=t(97326),r=t(11752),a=t(61120),d=t(60136),s=t(27277),l=t(37762),u=t(15671),f=t(43144),c=t(32959),g=t(65379),h=t(81200),v=t(94763),m=t(23954),_=t(17397),p=t(71049),b=t(77409),y=t(74146),w=t(13880),E=t(71047),L=t(65096),N=t(79730),C=t(88616),S=t(9284),D=t(95253),R=t(76257),I=t(49039),x=t(51811),O=t(70433),M=t(99857),T=t(18420),k=t(93720),V=t(17429),Z=t(90650),W=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function a(e){try{s(n.next(e))}catch(i){r(i)}}function d(e){try{s(n.throw(e))}catch(i){r(i)}}function s(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(a,d)}s((n=n.apply(e,i||[])).next())}))},P=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,r,a,d,s,l){var f;(0,u.Z)(this,t),(f=i.call(this))._viewZoneId=e,f._marginDomNode=r,f.editor=a,f.diff=d,f._contextMenuService=s,f._clipboardService=l,f._visibility=!1,f._marginDomNode.style.zIndex="10",f._diffActions=document.createElement("div"),f._diffActions.className=N.k.asClassName(b.l.lightBulb)+" lightbulb-glyph",f._diffActions.style.position="absolute";var g=a.getOption(65),h=a.getModel().getEOL();f._diffActions.style.right="0px",f._diffActions.style.visibility="hidden",f._diffActions.style.height="".concat(g,"px"),f._diffActions.style.lineHeight="".concat(g,"px"),f._marginDomNode.appendChild(f._diffActions);var v=[],m=0===d.modifiedEndLineNumber;v.push(new k.aU("diff.clipboard.copyDeletedContent",m?d.originalEndLineNumber>d.modifiedStartLineNumber?T.NC("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):T.NC("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):d.originalEndLineNumber>d.modifiedStartLineNumber?T.NC("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):T.NC("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,(function(){return W((0,o.Z)(f),void 0,void 0,(0,n.Z)().mark((function e(){var i,t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=new V.e(d.originalStartLineNumber,1,d.originalEndLineNumber+1,1),t=d.originalModel.getValueInRange(i),e.next=4,this._clipboardService.writeText(t);case 4:case"end":return e.stop()}}),e,this)})))})));var _=0,p=void 0;d.originalEndLineNumber>d.modifiedStartLineNumber&&(p=new k.aU("diff.clipboard.copyDeletedLineContent",m?T.NC("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",d.originalStartLineNumber):T.NC("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",d.originalStartLineNumber),void 0,!0,(function(){return W((0,o.Z)(f),void 0,void 0,(0,n.Z)().mark((function e(){var i,t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==(i=d.originalModel.getLineContent(d.originalStartLineNumber+_))){e.next=7;break}return t=d.originalModel.getEndOfLineSequence(),e.next=5,this._clipboardService.writeText(0===t?"\n":"\r\n");case 5:e.next=9;break;case 7:return e.next=9,this._clipboardService.writeText(i);case 9:case"end":return e.stop()}}),e,this)})))})),v.push(p)),a.getOption(89)||v.push(new k.aU("diff.inline.revertChange",T.NC("diff.inline.revertChange.label","Revert this change"),void 0,!0,(function(){return W((0,o.Z)(f),void 0,void 0,(0,n.Z)().mark((function e(){var i,t,o,r;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=new V.e(d.originalStartLineNumber,1,d.originalEndLineNumber,d.originalModel.getLineMaxColumn(d.originalEndLineNumber)),t=d.originalModel.getValueInRange(i),0===d.modifiedEndLineNumber?(o=a.getModel().getLineMaxColumn(d.modifiedStartLineNumber),a.executeEdits("diffEditor",[{range:new V.e(d.modifiedStartLineNumber,o,d.modifiedStartLineNumber,o),text:h+t}])):(r=a.getModel().getLineMaxColumn(d.modifiedEndLineNumber),a.executeEdits("diffEditor",[{range:new V.e(d.modifiedStartLineNumber,1,d.modifiedEndLineNumber,r),text:t}]));case 3:case"end":return e.stop()}}),e)})))})));var y=a.getOption(125)&&!Z.gn,w=function(e,i){var t;f._contextMenuService.showContextMenu({domForShadowRoot:y&&null!==(t=a.getDomNode())&&void 0!==t?t:void 0,getAnchor:function(){return{x:e,y:i}},getActions:function(){return p&&(p.label=m?T.NC("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",d.originalStartLineNumber+_):T.NC("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",d.originalStartLineNumber+_)),v},autoSelectFirstItem:!0})};return f._register(c.addStandardDisposableListener(f._diffActions,"mousedown",(function(e){var i=c.getDomNodePagePosition(f._diffActions),t=i.top,n=i.height,o=Math.floor(g/3);e.preventDefault(),w(e.posx,t+n+o)}))),f._register(a.onMouseMove((function(e){8===e.target.type||5===e.target.type?e.target.detail.viewZoneId===f._viewZoneId?(f.visibility=!0,_=f._updateLightBulbPosition(f._marginDomNode,e.event.browserEvent.y,g)):f.visibility=!1:f.visibility=!1}))),f._register(a.onMouseDown((function(e){e.event.rightButton&&(8!==e.target.type&&5!==e.target.type||e.target.detail.viewZoneId===f._viewZoneId&&(e.event.preventDefault(),_=f._updateLightBulbPosition(f._marginDomNode,e.event.browserEvent.y,g),w(e.event.posx,e.event.posy+g)))}))),f}return(0,f.Z)(t,[{key:"visibility",get:function(){return this._visibility},set:function(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}},{key:"_updateLightBulbPosition",value:function(e,i,t){var n=i-c.getDomNodePagePosition(e).top,o=Math.floor(n/t),r=o*t;if(this._diffActions.style.top="".concat(r,"px"),this.diff.viewLineCounts)for(var a=0,d=0;d<this.diff.viewLineCounts.length;d++)if(o<(a+=this.diff.viewLineCounts[d]))return d;return o}}]),t}(L.JT),A=t(8422),H=t(17683),z=t(65631),F=t(53603),B=t(43886),U=t(98926),j=t(78519),q=t(63465),K=t(56606),G=t(19484),$=t(92578),J=t(76344),X=t(8022),Y=t(92361),Q=t(64606),ee=t(26746),ie=t(49431),te=t(28322),ne=t(43980),oe=t(87288),re=t(41335),ae=function(e,i,t,n){var o,r=arguments.length,a=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(a=(r<3?o(a):r>3?o(i,t,a):o(i,t))||a);return r>3&&a&&Object.defineProperty(i,t,a),a},de=function(e,i){return function(t,n){i(t,n,e)}},se=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function a(e){try{s(n.next(e))}catch(i){r(i)}}function d(e){try{s(n.throw(e))}catch(i){r(i)}}function s(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(a,d)}s((n=n.apply(e,i||[])).next())}))},le=function(){function e(i,t){(0,u.Z)(this,e),this._contextMenuService=i,this._clipboardService=t,this._zones=[],this._inlineDiffMargins=[],this._zonesMap={},this._decorations=[]}return(0,f.Z)(e,[{key:"getForeignViewZones",value:function(e){var i=this;return e.filter((function(e){return!i._zonesMap[String(e.id)]}))}},{key:"clean",value:function(e){var i=this;this._zones.length>0&&e.changeViewZones((function(e){var t,n=(0,l.Z)(i._zones);try{for(n.s();!(t=n.n()).done;){var o=t.value;e.removeZone(o)}}catch(r){n.e(r)}finally{n.f()}})),this._zones=[],this._zonesMap={},e.changeDecorations((function(e){i._decorations=e.deltaDecorations(i._decorations,[])}))}},{key:"apply",value:function(e,i,t,n){var o=this,r=n?I.Z.capture(e):null;e.changeViewZones((function(i){var n,r,a=(0,l.Z)(o._zones);try{for(a.s();!(r=a.n()).done;){var d=r.value;i.removeZone(d)}}catch(v){a.e(v)}finally{a.f()}var s,u=(0,l.Z)(o._inlineDiffMargins);try{for(u.s();!(s=u.n()).done;){s.value.dispose()}}catch(v){u.e(v)}finally{u.f()}o._zones=[],o._zonesMap={},o._inlineDiffMargins=[];for(var f=0,c=t.zones.length;f<c;f++){var g=t.zones[f];g.suppressMouseDown=!0,g.showInHiddenAreas=!0;var h=i.addZone(g);o._zones.push(h),o._zonesMap[String(h)]=!0,t.zones[f].diff&&g.marginDomNode&&(g.suppressMouseDown=!1,0!==(null===(n=t.zones[f].diff)||void 0===n?void 0:n.originalModel.getValueLength())&&o._inlineDiffMargins.push(new P(h,g.marginDomNode,e,t.zones[f].diff,o._contextMenuService,o._clipboardService)))}})),null===r||void 0===r||r.restore(e),e.changeDecorations((function(e){o._decorations=e.deltaDecorations(o._decorations,t.decorations)})),null===i||void 0===i||i.setZones(t.overviewZones)}}]),e}(),ue=0,fe=(0,oe.q5)("diff-insert",b.l.add,T.NC("diffInsertIcon","Line decoration for inserts in the diff editor.")),ce=(0,oe.q5)("diff-remove",b.l.remove,T.NC("diffRemoveIcon","Line decoration for removals in the diff editor.")),ge=(0,h.Z)("diffEditorWidget",{createHTML:function(e){return e}}),he=T.NC("diff-aria-navigation-tip"," use Shift + F7 to navigate changes"),ve=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,r,a,d,s,f,h,v,m,_){var b;(0,u.Z)(this,t),(b=i.call(this))._editorProgressService=_,b._onDidDispose=b._register(new w.Q5),b.onDidDispose=b._onDidDispose.event,b._onDidChangeModel=b._register(new w.Q5),b.onDidChangeModel=b._onDidChangeModel.event,b._onDidUpdateDiff=b._register(new w.Q5),b.onDidUpdateDiff=b._onDidUpdateDiff.event,b._onDidContentSizeChange=b._register(new w.Q5),b._lastOriginalWarning=null,b._lastModifiedWarning=null,f.willCreateDiffEditor(),b._documentDiffProvider=b._register(s.createInstance(A.Q,n)),b._register(b._documentDiffProvider.onDidChange((function(e){return b._beginUpdateDecorationsSoon()}))),b._codeEditorService=f,b._contextKeyService=b._register(d.createScoped(e)),b._instantiationService=s.createChild(new ee.y([X.i6,b._contextKeyService])),b._contextKeyService.createKey("isInDiffEditor",!0),b._themeService=h,b._notificationService=v,b._id=++ue,b._state=0,b._updatingDiffProgress=null,b._domElement=e,n=n||{},b._options=Oe(n,{enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{collapseUnchangedRegions:!1},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1}),b.isEmbeddedDiffEditorKey=U.u.isEmbeddedDiffEditor.bindTo(b._contextKeyService),b.isEmbeddedDiffEditorKey.set("undefined"!==typeof n.isInEmbeddedEditor&&n.isInEmbeddedEditor),b._updateDecorationsRunner=b._register(new p.pY((function(){return b._updateDecorations()}),0)),b._containerDomElement=document.createElement("div"),b._containerDomElement.className=t._getClassName(b._themeService.getColorTheme(),b._options.renderSideBySide),b._containerDomElement.style.position="relative",b._containerDomElement.style.height="100%",b._domElement.appendChild(b._containerDomElement),b._overviewViewportDomElement=(0,g.X)(document.createElement("div")),b._overviewViewportDomElement.setClassName("diffViewport"),b._overviewViewportDomElement.setPosition("absolute"),b._overviewDomElement=document.createElement("div"),b._overviewDomElement.className="diffOverview",b._overviewDomElement.style.position="absolute",b._overviewDomElement.appendChild(b._overviewViewportDomElement.domNode),b._register(c.addStandardDisposableListener(b._overviewDomElement,c.EventType.POINTER_DOWN,(function(e){b._modifiedEditor.delegateVerticalScrollbarPointerDown(e)}))),b._register(c.addDisposableListener(b._overviewDomElement,c.EventType.MOUSE_WHEEL,(function(e){b._modifiedEditor.delegateScrollFromMouseWheelEvent(e)}),{passive:!1})),b._options.renderOverviewRuler&&b._containerDomElement.appendChild(b._overviewDomElement),b._originalDomNode=document.createElement("div"),b._originalDomNode.className="editor original",b._originalDomNode.style.position="absolute",b._originalDomNode.style.height="100%",b._containerDomElement.appendChild(b._originalDomNode),b._modifiedDomNode=document.createElement("div"),b._modifiedDomNode.className="editor modified",b._modifiedDomNode.style.position="absolute",b._modifiedDomNode.style.height="100%",b._containerDomElement.appendChild(b._modifiedDomNode),b._beginUpdateDecorationsTimeout=-1,b._currentlyChangingViewZones=!1,b._diffComputationToken=0,b._originalEditorState=new le(m,a),b._modifiedEditorState=new le(m,a),b._isVisible=!0,b._isHandlingScrollEvent=!1,b._elementSizeObserver=b._register(new S.I(b._containerDomElement,n.dimension)),b._register(b._elementSizeObserver.onDidChange((function(){return b._onDidContainerSizeChanged()}))),n.automaticLayout&&b._elementSizeObserver.startObserving(),b._diffComputationResult=null,b._originalEditor=b._createLeftHandSideEditor(n,r.originalEditor||{}),b._modifiedEditor=b._createRightHandSideEditor(n,r.modifiedEditor||{}),b._originalOverviewRuler=null,b._modifiedOverviewRuler=null,b._reviewPane=s.createInstance(M.j,(0,o.Z)(b)),b._containerDomElement.appendChild(b._reviewPane.domNode.domNode),b._containerDomElement.appendChild(b._reviewPane.shadow.domNode),b._containerDomElement.appendChild(b._reviewPane.actionBarContainer.domNode),b._options.renderSideBySide?b._setStrategy(new we(b._createDataSource(),b._options.enableSplitViewResizing,b._options.splitViewDefaultRatio)):b._setStrategy(new Le(b._createDataSource(),b._options.enableSplitViewResizing)),b._register(h.onDidColorThemeChange((function(e){b._strategy&&b._strategy.applyColors(e)&&b._updateDecorationsRunner.schedule(),b._containerDomElement.className=t._getClassName(b._themeService.getColorTheme(),b._options.renderSideBySide)})));var E,L=D.Uc.getDiffEditorContributions(),N=(0,l.Z)(L);try{for(N.s();!(E=N.n()).done;){var C=E.value;try{b._register(s.createInstance(C.ctor,(0,o.Z)(b)))}catch(R){(0,y.dL)(R)}}}catch(R){N.e(R)}finally{N.f()}return b._codeEditorService.addDiffEditor((0,o.Z)(b)),b}return(0,f.Z)(t,[{key:"_setState",value:function(e){this._state!==e&&(this._state=e,this._updatingDiffProgress&&(this._updatingDiffProgress.done(),this._updatingDiffProgress=null),1===this._state&&(this._updatingDiffProgress=this._editorProgressService.show(!0,1e3)))}},{key:"accessibleDiffViewerNext",value:function(){this._reviewPane.next()}},{key:"accessibleDiffViewerPrev",value:function(){this._reviewPane.prev()}},{key:"_disposeOverviewRulers",value:function(){this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose(),this._originalOverviewRuler=null),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose(),this._modifiedOverviewRuler=null)}},{key:"_createOverviewRulers",value:function(){this._options.renderOverviewRuler&&(_.ok(!this._originalOverviewRuler&&!this._modifiedOverviewRuler),this._originalEditor.hasModel()&&(this._originalOverviewRuler=this._originalEditor.createOverviewRuler("original diffOverviewRuler"),this._overviewDomElement.appendChild(this._originalOverviewRuler.getDomNode())),this._modifiedEditor.hasModel()&&(this._modifiedOverviewRuler=this._modifiedEditor.createOverviewRuler("modified diffOverviewRuler"),this._overviewDomElement.appendChild(this._modifiedOverviewRuler.getDomNode())),this._layoutOverviewRulers())}},{key:"_createLeftHandSideEditor",value:function(e,i){var n=this,o=this._createInnerEditor(this._instantiationService,this._originalDomNode,this._adjustOptionsForLeftHandSide(e),i);this._register(o.onDidScrollChange((function(e){n._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(n._isHandlingScrollEvent=!0,n._modifiedEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),n._isHandlingScrollEvent=!1,n._layoutOverviewViewport())}))),this._register(o.onDidChangeViewZones((function(){n._onViewZonesChanged()}))),this._register(o.onDidChangeConfiguration((function(e){o.getModel()&&(e.hasChanged(49)&&n._updateDecorationsRunner.schedule(),e.hasChanged(143)&&(n._updateDecorationsRunner.cancel(),n._updateDecorations()))}))),this._register(o.onDidChangeHiddenAreas((function(){n._updateDecorationsRunner.cancel(),n._updateDecorations()}))),this._register(o.onDidChangeModelContent((function(){n._isVisible&&n._beginUpdateDecorationsSoon()})));var r=this._contextKeyService.createKey("isInDiffLeftEditor",o.hasWidgetFocus());return this._register(o.onDidFocusEditorWidget((function(){return r.set(!0)}))),this._register(o.onDidBlurEditorWidget((function(){return r.set(!1)}))),this._register(o.onDidContentSizeChange((function(e){var i=n._originalEditor.getContentWidth()+n._modifiedEditor.getContentWidth()+t.ONE_OVERVIEW_WIDTH,o=Math.max(n._modifiedEditor.getContentHeight(),n._originalEditor.getContentHeight());n._onDidContentSizeChange.fire({contentHeight:o,contentWidth:i,contentHeightChanged:e.contentHeightChanged,contentWidthChanged:e.contentWidthChanged})}))),o}},{key:"_createRightHandSideEditor",value:function(e,i){var n=this,o=this._createInnerEditor(this._instantiationService,this._modifiedDomNode,this._adjustOptionsForRightHandSide(e),i);this._register(o.onDidScrollChange((function(e){n._isHandlingScrollEvent||(e.scrollTopChanged||e.scrollLeftChanged||e.scrollHeightChanged)&&(n._isHandlingScrollEvent=!0,n._originalEditor.setScrollPosition({scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}),n._isHandlingScrollEvent=!1,n._layoutOverviewViewport())}))),this._register(o.onDidChangeViewZones((function(){n._onViewZonesChanged()}))),this._register(o.onDidChangeConfiguration((function(e){o.getModel()&&(e.hasChanged(49)&&n._updateDecorationsRunner.schedule(),e.hasChanged(143)&&(n._updateDecorationsRunner.cancel(),n._updateDecorations()))}))),this._register(o.onDidChangeHiddenAreas((function(){n._updateDecorationsRunner.cancel(),n._updateDecorations()}))),this._register(o.onDidChangeModelContent((function(){n._isVisible&&n._beginUpdateDecorationsSoon()}))),this._register(o.onDidChangeModelOptions((function(e){e.tabSize&&n._updateDecorationsRunner.schedule()})));var r=this._contextKeyService.createKey("isInDiffRightEditor",o.hasWidgetFocus());return this._register(o.onDidFocusEditorWidget((function(){return r.set(!0)}))),this._register(o.onDidBlurEditorWidget((function(){return r.set(!1)}))),this._register(o.onDidContentSizeChange((function(e){var i=n._originalEditor.getContentWidth()+n._modifiedEditor.getContentWidth()+t.ONE_OVERVIEW_WIDTH,o=Math.max(n._modifiedEditor.getContentHeight(),n._originalEditor.getContentHeight());n._onDidContentSizeChange.fire({contentHeight:o,contentWidth:i,contentHeightChanged:e.contentHeightChanged,contentWidthChanged:e.contentWidthChanged})}))),this._register(o.onMouseDown((function(e){var i,t;if(!e.event.rightButton&&e.target.position&&(null===(i=e.target.element)||void 0===i?void 0:i.className.includes("arrow-revert-change"))){var o=e.target.position.lineNumber,r=e.target,a=null===(t=n._diffComputationResult)||void 0===t?void 0:t.changes.find((function(e){return(null===r||void 0===r?void 0:r.detail.afterLineNumber)===e.modifiedStartLineNumber||e.modifiedEndLineNumber>0&&e.modifiedStartLineNumber===o}));return a&&n.revertChange(a),e.event.stopPropagation(),void n._updateDecorations()}}))),o}},{key:"revertChange",value:function(e){var i=this._modifiedEditor,t=this._originalEditor.getModel(),n=this._modifiedEditor.getModel();if(t&&n&&i){var o=e.originalEndLineNumber>0?new V.e(e.originalStartLineNumber,1,e.originalEndLineNumber,t.getLineMaxColumn(e.originalEndLineNumber)):null,r=o?t.getValueInRange(o):null,a=e.modifiedEndLineNumber>0?new V.e(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber,n.getLineMaxColumn(e.modifiedEndLineNumber)):null,d=n.getEOL();if(0===e.originalEndLineNumber&&a){var s=a;e.modifiedStartLineNumber>1?s=a.setStartPosition(e.modifiedStartLineNumber-1,n.getLineMaxColumn(e.modifiedStartLineNumber-1)):e.modifiedEndLineNumber<n.getLineCount()&&(s=a.setEndPosition(e.modifiedEndLineNumber+1,1)),i.executeEdits("diffEditor",[{range:s,text:""}])}else if(0===e.modifiedEndLineNumber&&null!==r){var l=e.modifiedStartLineNumber<n.getLineCount()?new z.L(e.modifiedStartLineNumber+1,1):new z.L(e.modifiedStartLineNumber,n.getLineMaxColumn(e.modifiedStartLineNumber));i.executeEdits("diffEditor",[{range:V.e.fromPositions(l,l),text:e.modifiedStartLineNumber<n.getLineCount()?r+d:d+r}])}else a&&null!==r&&i.executeEdits("diffEditor",[{range:a,text:r}])}}},{key:"_createInnerEditor",value:function(e,i,t,n){return e.createInstance(x.Gm,i,t,n)}},{key:"dispose",value:function(){this._codeEditorService.removeDiffEditor(this),-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._cleanViewZonesAndDecorations(),this._originalOverviewRuler&&(this._overviewDomElement.removeChild(this._originalOverviewRuler.getDomNode()),this._originalOverviewRuler.dispose()),this._modifiedOverviewRuler&&(this._overviewDomElement.removeChild(this._modifiedOverviewRuler.getDomNode()),this._modifiedOverviewRuler.dispose()),this._overviewDomElement.removeChild(this._overviewViewportDomElement.domNode),this._options.renderOverviewRuler&&this._containerDomElement.removeChild(this._overviewDomElement),this._containerDomElement.removeChild(this._originalDomNode),this._originalEditor.dispose(),this._containerDomElement.removeChild(this._modifiedDomNode),this._modifiedEditor.dispose(),this._strategy.dispose(),this._containerDomElement.removeChild(this._reviewPane.domNode.domNode),this._containerDomElement.removeChild(this._reviewPane.shadow.domNode),this._containerDomElement.removeChild(this._reviewPane.actionBarContainer.domNode),this._reviewPane.dispose(),this._domElement.removeChild(this._containerDomElement),this._onDidDispose.fire(),(0,r.Z)((0,a.Z)(t.prototype),"dispose",this).call(this)}},{key:"getId",value:function(){return this.getEditorType()+":"+this._id}},{key:"getEditorType",value:function(){return B.g.IDiffEditor}},{key:"getLineChanges",value:function(){return this._diffComputationResult?this._diffComputationResult.changes:null}},{key:"getOriginalEditor",value:function(){return this._originalEditor}},{key:"getModifiedEditor",value:function(){return this._modifiedEditor}},{key:"updateOptions",value:function(e){var i,n,o=Oe(e,this._options),r=(i=this._options,n=o,{enableSplitViewResizing:i.enableSplitViewResizing!==n.enableSplitViewResizing,renderSideBySide:i.renderSideBySide!==n.renderSideBySide,renderMarginRevertIcon:i.renderMarginRevertIcon!==n.renderMarginRevertIcon,maxComputationTime:i.maxComputationTime!==n.maxComputationTime,maxFileSize:i.maxFileSize!==n.maxFileSize,ignoreTrimWhitespace:i.ignoreTrimWhitespace!==n.ignoreTrimWhitespace,renderIndicators:i.renderIndicators!==n.renderIndicators,originalEditable:i.originalEditable!==n.originalEditable,diffCodeLens:i.diffCodeLens!==n.diffCodeLens,renderOverviewRuler:i.renderOverviewRuler!==n.renderOverviewRuler,diffWordWrap:i.diffWordWrap!==n.diffWordWrap,diffAlgorithm:i.diffAlgorithm!==n.diffAlgorithm,accessibilityVerbose:i.accessibilityVerbose!==n.accessibilityVerbose});this._options=o,this.isEmbeddedDiffEditorKey.set("undefined"!==typeof e.isInEmbeddedEditor&&e.isInEmbeddedEditor);var a=r.ignoreTrimWhitespace||r.renderIndicators||r.renderMarginRevertIcon,d=this._isVisible&&(r.maxComputationTime||r.maxFileSize);this._documentDiffProvider.setOptions(o),a?this._beginUpdateDecorations():d&&this._beginUpdateDecorationsSoon(),this._modifiedEditor.updateOptions(this._adjustOptionsForRightHandSide(e)),this._originalEditor.updateOptions(this._adjustOptionsForLeftHandSide(e)),this._strategy.setEnableSplitViewResizing(this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio),r.renderSideBySide&&(this._options.renderSideBySide?this._setStrategy(new we(this._createDataSource(),this._options.enableSplitViewResizing,this._options.splitViewDefaultRatio)):this._setStrategy(new Le(this._createDataSource(),this._options.enableSplitViewResizing)),this._containerDomElement.className=t._getClassName(this._themeService.getColorTheme(),this._options.renderSideBySide)),r.renderOverviewRuler&&(this._options.renderOverviewRuler?this._containerDomElement.appendChild(this._overviewDomElement):this._containerDomElement.removeChild(this._overviewDomElement))}},{key:"getModel",value:function(){return{original:this._originalEditor.getModel(),modified:this._modifiedEditor.getModel()}}},{key:"createViewModel",value:function(e){return{model:e,waitForDiff:function(){return se(this,void 0,void 0,(0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}}}},{key:"setModel",value:function(e){if(e&&"model"in e&&(e=e.model),e&&(!e.original||!e.modified))throw new Error(e.original?"DiffEditorWidget.setModel: Modified model is null":"DiffEditorWidget.setModel: Original model is null");this._cleanViewZonesAndDecorations(),this._disposeOverviewRulers(),this._originalEditor.setModel(e?e.original:null),this._modifiedEditor.setModel(e?e.modified:null),this._updateDecorationsRunner.cancel(),e&&(this._originalEditor.setScrollTop(0),this._modifiedEditor.setScrollTop(0)),this._diffComputationResult=null,this._diffComputationToken++,this._setState(0),e&&(this._createOverviewRulers(),this._beginUpdateDecorations()),this._layoutOverviewViewport(),this._onDidChangeModel.fire(),this._diffNavigator=this._register(this._instantiationService.createInstance(O.F,this,{alwaysRevealFirst:!1,findResultLoop:this.getModifiedEditor().getOption(40).loop}))}},{key:"getContainerDomNode",value:function(){return this._domElement}},{key:"getVisibleColumnFromPosition",value:function(e){return this._modifiedEditor.getVisibleColumnFromPosition(e)}},{key:"getPosition",value:function(){return this._modifiedEditor.getPosition()}},{key:"setPosition",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this._modifiedEditor.setPosition(e,i)}},{key:"revealLine",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealLine(e,i)}},{key:"revealLineInCenter",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealLineInCenter(e,i)}},{key:"revealLineInCenterIfOutsideViewport",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealLineInCenterIfOutsideViewport(e,i)}},{key:"revealLineNearTop",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealLineNearTop(e,i)}},{key:"revealPosition",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealPosition(e,i)}},{key:"revealPositionInCenter",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealPositionInCenter(e,i)}},{key:"revealPositionInCenterIfOutsideViewport",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealPositionInCenterIfOutsideViewport(e,i)}},{key:"revealPositionNearTop",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealPositionNearTop(e,i)}},{key:"getSelection",value:function(){return this._modifiedEditor.getSelection()}},{key:"getSelections",value:function(){return this._modifiedEditor.getSelections()}},{key:"setSelection",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this._modifiedEditor.setSelection(e,i)}},{key:"setSelections",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this._modifiedEditor.setSelections(e,i)}},{key:"revealLines",value:function(e,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._modifiedEditor.revealLines(e,i,t)}},{key:"revealLinesInCenter",value:function(e,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._modifiedEditor.revealLinesInCenter(e,i,t)}},{key:"revealLinesInCenterIfOutsideViewport",value:function(e,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._modifiedEditor.revealLinesInCenterIfOutsideViewport(e,i,t)}},{key:"revealLinesNearTop",value:function(e,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._modifiedEditor.revealLinesNearTop(e,i,t)}},{key:"revealRange",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this._modifiedEditor.revealRange(e,i,t,n)}},{key:"revealRangeInCenter",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealRangeInCenter(e,i)}},{key:"revealRangeInCenterIfOutsideViewport",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealRangeInCenterIfOutsideViewport(e,i)}},{key:"revealRangeNearTop",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealRangeNearTop(e,i)}},{key:"revealRangeNearTopIfOutsideViewport",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealRangeNearTopIfOutsideViewport(e,i)}},{key:"revealRangeAtTop",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._modifiedEditor.revealRangeAtTop(e,i)}},{key:"getSupportedActions",value:function(){return this._modifiedEditor.getSupportedActions()}},{key:"focus",value:function(){this._modifiedEditor.focus()}},{key:"trigger",value:function(e,i,t){this._modifiedEditor.trigger(e,i,t)}},{key:"createDecorationsCollection",value:function(e){return this._modifiedEditor.createDecorationsCollection(e)}},{key:"changeDecorations",value:function(e){return this._modifiedEditor.changeDecorations(e)}},{key:"saveViewState",value:function(){return{original:this._originalEditor.saveViewState(),modified:this._modifiedEditor.saveViewState()}}},{key:"restoreViewState",value:function(e){if(e&&e.original&&e.modified){var i=e;this._originalEditor.restoreViewState(i.original),this._modifiedEditor.restoreViewState(i.modified)}}},{key:"layout",value:function(e){this._elementSizeObserver.observe(e)}},{key:"hasTextFocus",value:function(){return this._originalEditor.hasTextFocus()||this._modifiedEditor.hasTextFocus()}},{key:"_onDidContainerSizeChanged",value:function(){this._doLayout()}},{key:"_getReviewHeight",value:function(){return this._reviewPane.isVisible()?this._elementSizeObserver.getHeight():0}},{key:"_layoutOverviewRulers",value:function(){if(this._options.renderOverviewRuler&&this._originalOverviewRuler&&this._modifiedOverviewRuler){var e=this._elementSizeObserver.getHeight(),i=this._getReviewHeight(),n=t.ENTIRE_DIFF_OVERVIEW_WIDTH-2*t.ONE_OVERVIEW_WIDTH;this._modifiedEditor.getLayoutInfo()&&(this._originalOverviewRuler.setLayout({top:0,width:t.ONE_OVERVIEW_WIDTH,right:n+t.ONE_OVERVIEW_WIDTH,height:e-i}),this._modifiedOverviewRuler.setLayout({top:0,right:0,width:t.ONE_OVERVIEW_WIDTH,height:e-i}))}}},{key:"_onViewZonesChanged",value:function(){this._currentlyChangingViewZones||this._updateDecorationsRunner.schedule()}},{key:"_beginUpdateDecorationsSoon",value:function(){var e=this;-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1),this._beginUpdateDecorationsTimeout=window.setTimeout((function(){return e._beginUpdateDecorations()}),t.UPDATE_DIFF_DECORATIONS_DELAY)}},{key:"_beginUpdateDecorations",value:function(){var e=this;-1!==this._beginUpdateDecorationsTimeout&&(window.clearTimeout(this._beginUpdateDecorationsTimeout),this._beginUpdateDecorationsTimeout=-1);var i=this._originalEditor.getModel(),n=this._modifiedEditor.getModel();if(i&&n){this._diffComputationToken++;var o=this._diffComputationToken,r=1024*this._options.maxFileSize*1024,a=function(e){var i=e.getValueLength();return 0===r||i<=r};a(i)&&a(n)?(this._setState(1),this._documentDiffProvider.computeDiff(i,n,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace,maxComputationTimeMs:this._options.maxComputationTime,computeMoves:!1}).then((function(t){o===e._diffComputationToken&&i===e._originalEditor.getModel()&&n===e._modifiedEditor.getModel()&&(e._setState(2),e._diffComputationResult={identical:t.identical,quitEarly:t.quitEarly,changes2:t.changes,changes:t.changes.map((function(e){var i,t,n,o,r=e.innerChanges;return e.originalRange.isEmpty?(i=e.originalRange.startLineNumber-1,t=0,r=void 0):(i=e.originalRange.startLineNumber,t=e.originalRange.endLineNumberExclusive-1),e.modifiedRange.isEmpty?(n=e.modifiedRange.startLineNumber-1,o=0,r=void 0):(n=e.modifiedRange.startLineNumber,o=e.modifiedRange.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:t,modifiedStartLineNumber:n,modifiedEndLineNumber:o,charChanges:null===r||void 0===r?void 0:r.map((function(e){return{originalStartLineNumber:e.originalRange.startLineNumber,originalStartColumn:e.originalRange.startColumn,originalEndLineNumber:e.originalRange.endLineNumber,originalEndColumn:e.originalRange.endColumn,modifiedStartLineNumber:e.modifiedRange.startLineNumber,modifiedStartColumn:e.modifiedRange.startColumn,modifiedEndLineNumber:e.modifiedRange.endLineNumber,modifiedEndColumn:e.modifiedRange.endColumn}}))}}))},e._updateDecorationsRunner.schedule(),e._onDidUpdateDiff.fire())}),(function(t){o===e._diffComputationToken&&i===e._originalEditor.getModel()&&n===e._modifiedEditor.getModel()&&(e._setState(2),e._diffComputationResult=null,e._updateDecorationsRunner.schedule())}))):t._equals(i.uri,this._lastOriginalWarning)&&t._equals(n.uri,this._lastModifiedWarning)||(this._lastOriginalWarning=i.uri,this._lastModifiedWarning=n.uri,this._notificationService.warn(T.NC("diff.tooLarge","Cannot compare files because one file is too large.")))}}},{key:"_cleanViewZonesAndDecorations",value:function(){this._originalEditorState.clean(this._originalEditor),this._modifiedEditorState.clean(this._modifiedEditor)}},{key:"_updateDecorations",value:function(){if(this._originalEditor.getModel()&&this._modifiedEditor.getModel()){var e=this._diffComputationResult?this._diffComputationResult.changes:[],i=this._originalEditorState.getForeignViewZones(this._originalEditor.getWhitespaces()),t=this._modifiedEditorState.getForeignViewZones(this._modifiedEditor.getWhitespaces()),n=this._options.renderMarginRevertIcon&&!this._modifiedEditor.getOption(89),o=this._strategy.getEditorsDiffDecorations(e,this._options.ignoreTrimWhitespace,this._options.renderIndicators,n,i,t);try{this._currentlyChangingViewZones=!0,this._originalEditorState.apply(this._originalEditor,this._originalOverviewRuler,o.original,!1),this._modifiedEditorState.apply(this._modifiedEditor,this._modifiedOverviewRuler,o.modified,!0)}finally{this._currentlyChangingViewZones=!1}}}},{key:"_adjustOptionsForSubEditor",value:function(e){var i=Object.assign({},e);return i.inDiffEditor=!0,i.automaticLayout=!1,i.scrollbar=Object.assign({},i.scrollbar||{}),i.scrollbar.vertical="visible",i.folding=!1,i.codeLens=this._options.diffCodeLens,i.fixedOverflowWidgets=!0,i.minimap=Object.assign({},i.minimap||{}),i.minimap.enabled=!1,i}},{key:"_adjustOptionsForLeftHandSide",value:function(e){var i=this._adjustOptionsForSubEditor(e);return this._options.renderSideBySide?i.wordWrapOverride1=this._options.diffWordWrap:(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1}),e.originalAriaLabel&&(i.ariaLabel=e.originalAriaLabel),this._updateAriaLabel(i),i.readOnly=!this._options.originalEditable,i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",Object.assign(Object.assign({},i),{dimension:{height:0,width:0}})}},{key:"_updateAriaLabel",value:function(e){var i,t=null!==(i=e.ariaLabel)&&void 0!==i?i:"";this._options.accessibilityVerbose?t+=he:t&&(t=t.replaceAll(he,"")),e.ariaLabel=t}},{key:"_adjustOptionsForRightHandSide",value:function(e){var i=this._adjustOptionsForSubEditor(e);return e.modifiedAriaLabel&&(i.ariaLabel=e.modifiedAriaLabel),this._updateAriaLabel(i),i.wordWrapOverride1=this._options.diffWordWrap,i.revealHorizontalRightPadding=H.BH.revealHorizontalRightPadding.defaultValue+t.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",Object.assign(Object.assign({},i),{dimension:{height:0,width:0}})}},{key:"doLayout",value:function(){this._elementSizeObserver.observe(),this._doLayout()}},{key:"_doLayout",value:function(){var e=this._elementSizeObserver.getWidth(),i=this._elementSizeObserver.getHeight(),n=this._getReviewHeight(),o=this._strategy.layout();this._originalDomNode.style.width=o+"px",this._originalDomNode.style.left="0px",this._modifiedDomNode.style.width=e-o-t.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._modifiedDomNode.style.left=o+"px",this._overviewDomElement.style.top="0px",this._overviewDomElement.style.height=i-n+"px",this._overviewDomElement.style.width=t.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewDomElement.style.left=e-t.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",this._overviewViewportDomElement.setWidth(t.ENTIRE_DIFF_OVERVIEW_WIDTH),this._overviewViewportDomElement.setHeight(30),this._originalEditor.layout({width:o,height:i-n}),this._modifiedEditor.layout({width:e-o-(this._options.renderOverviewRuler?t.ENTIRE_DIFF_OVERVIEW_WIDTH:0),height:i-n}),(this._originalOverviewRuler||this._modifiedOverviewRuler)&&this._layoutOverviewRulers(),this._reviewPane.layout(i-n,e,n),this._layoutOverviewViewport()}},{key:"_layoutOverviewViewport",value:function(){var e=this._computeOverviewViewport();e?(this._overviewViewportDomElement.setTop(e.top),this._overviewViewportDomElement.setHeight(e.height)):(this._overviewViewportDomElement.setTop(0),this._overviewViewportDomElement.setHeight(0))}},{key:"_computeOverviewViewport",value:function(){var e=this._modifiedEditor.getLayoutInfo();if(!e)return null;var i=this._modifiedEditor.getScrollTop(),t=this._modifiedEditor.getScrollHeight(),n=Math.max(0,e.height),o=Math.max(0,n-0),r=t>0?o/t:0;return{height:Math.max(0,Math.floor(e.height*r)),top:Math.floor(i*r)}}},{key:"_createDataSource",value:function(){var e=this;return{getWidth:function(){return e._elementSizeObserver.getWidth()},getHeight:function(){return e._elementSizeObserver.getHeight()-e._getReviewHeight()},getOptions:function(){return{renderOverviewRuler:e._options.renderOverviewRuler}},getContainerDomNode:function(){return e._containerDomElement},relayoutEditors:function(){e._doLayout()},getOriginalEditor:function(){return e._originalEditor},getModifiedEditor:function(){return e._modifiedEditor}}}},{key:"_setStrategy",value:function(e){var i;null===(i=this._strategy)||void 0===i||i.dispose(),this._strategy=e,this._boundarySashes&&e.setBoundarySashes(this._boundarySashes),e.applyColors(this._themeService.getColorTheme()),this._diffComputationResult&&this._updateDecorations(),this._doLayout()}}],[{key:"_getClassName",value:function(e,i){var t="monaco-diff-editor monaco-editor-background ";return i&&(t+="side-by-side "),t+=(0,re.m6)(e.type)}},{key:"_equals",value:function(e,i){return!e&&!i||!(!e||!i)&&e.toString()===i.toString()}}]),t}(L.JT);ve.ONE_OVERVIEW_WIDTH=15,ve.ENTIRE_DIFF_OVERVIEW_WIDTH=30,ve.UPDATE_DIFF_DECORATIONS_DELAY=200,ve=ae([de(3,J.p),de(4,X.i6),de(5,Q.TG),de(6,R.$),de(7,re.XE),de(8,ie.lT),de(9,Y.i),de(10,te.ek)],ve);var me=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e){var n;return(0,u.Z)(this,t),(n=i.call(this))._dataSource=e,n._insertColor=null,n._removeColor=null,n}return(0,f.Z)(t,[{key:"applyColors",value:function(e){var i=e.getColor(ne.P6Y)||(e.getColor(ne.ypS)||ne.CzK).transparent(2),t=e.getColor(ne.F9q)||(e.getColor(ne.P4M)||ne.keg).transparent(2),n=!i.equals(this._insertColor)||!t.equals(this._removeColor);return this._insertColor=i,this._removeColor=t,n}},{key:"getEditorsDiffDecorations",value:function(e,i,t,n,o,r){r=r.sort((function(e,i){return e.afterLineNumber-i.afterLineNumber})),o=o.sort((function(e,i){return e.afterLineNumber-i.afterLineNumber}));var a=this._getViewZones(e,o,r,t),d=this._getOriginalEditorDecorations(a,e,i,t),s=this._getModifiedEditorDecorations(a,e,i,t,n);return{original:{decorations:d.decorations,overviewZones:d.overviewZones,zones:a.original},modified:{decorations:s.decorations,overviewZones:s.overviewZones,zones:a.modified}}}},{key:"setBoundarySashes",value:function(e){}}]),t}(L.JT),_e=function(){function e(i){(0,u.Z)(this,e),this._source=i,this._index=-1,this.current=null,this.advance()}return(0,f.Z)(e,[{key:"advance",value:function(){this._index++,this._index<this._source.length?this.current=this._source[this._index]:this.current=null}}]),e}(),pe=function(){function e(i,t,n,o,r){(0,u.Z)(this,e),this._lineChanges=i,this._originalForeignVZ=t,this._modifiedForeignVZ=n,this._originalEditor=o,this._modifiedEditor=r}return(0,f.Z)(e,[{key:"getViewZones",value:function(){for(var i=this._originalEditor.getOption(65),t=this._modifiedEditor.getOption(65),n=-1!==this._originalEditor.getOption(143).wrappingColumn,o=-1!==this._modifiedEditor.getOption(143).wrappingColumn,r=n||o,a=this._originalEditor.getModel(),d=this._originalEditor._getViewModel().coordinatesConverter,s=this._modifiedEditor._getViewModel().coordinatesConverter,l=[],u=[],f=0,c=0,g=0,h=0,v=0,m=0,_=function(e,i){return e.afterLineNumber-i.afterLineNumber},p=function(e,i){if(null===i.domNode&&e.length>0){var t=e[e.length-1];if(t.afterLineNumber===i.afterLineNumber&&null===t.domNode)return void(t.heightInLines+=i.heightInLines)}e.push(i)},b=new _e(this._modifiedForeignVZ),y=new _e(this._originalForeignVZ),w=1,E=1,L=0,N=this._lineChanges.length;L<=N;L++){var C=L<N?this._lineChanges[L]:null;null!==C?(g=C.originalStartLineNumber+(C.originalEndLineNumber>0?-1:0),h=C.modifiedStartLineNumber+(C.modifiedEndLineNumber>0?-1:0),c=C.originalEndLineNumber>0?e._getViewLineCount(this._originalEditor,C.originalStartLineNumber,C.originalEndLineNumber):0,f=C.modifiedEndLineNumber>0?e._getViewLineCount(this._modifiedEditor,C.modifiedStartLineNumber,C.modifiedEndLineNumber):0,v=Math.max(C.originalStartLineNumber,C.originalEndLineNumber),m=Math.max(C.modifiedStartLineNumber,C.modifiedEndLineNumber)):(v=g+=1e7+c,m=h+=1e7+f);var S=[],D=[];if(r){var R=void 0;R=C?C.originalEndLineNumber>0?C.originalStartLineNumber-w:C.modifiedStartLineNumber-E:a.getLineCount()-w+1;for(var I=0;I<R;I++){var x=w+I,O=E+I,M=d.getModelLineViewLineCount(x),T=s.getModelLineViewLineCount(O);M<T?S.push({afterLineNumber:x,heightInLines:T-M,domNode:null,marginDomNode:null}):M>T&&D.push({afterLineNumber:O,heightInLines:M-T,domNode:null,marginDomNode:null})}C&&(w=(C.originalEndLineNumber>0?C.originalEndLineNumber:C.originalStartLineNumber)+1,E=(C.modifiedEndLineNumber>0?C.modifiedEndLineNumber:C.modifiedStartLineNumber)+1)}for(;b.current&&b.current.afterLineNumber<=m;){var k=void 0;k=b.current.afterLineNumber<=h?g-h+b.current.afterLineNumber:v;var V=null;C&&C.modifiedStartLineNumber<=b.current.afterLineNumber&&b.current.afterLineNumber<=C.modifiedEndLineNumber&&(V=this._createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion()),S.push({afterLineNumber:k,heightInLines:b.current.height/t,domNode:null,marginDomNode:V}),b.advance()}for(;y.current&&y.current.afterLineNumber<=v;){var Z=void 0;Z=y.current.afterLineNumber<=g?h-g+y.current.afterLineNumber:m,D.push({afterLineNumber:Z,heightInLines:y.current.height/i,domNode:null}),y.advance()}if(null!==C&&Ce(C)){var W=this._produceOriginalFromDiff(C,c,f);W&&S.push(W)}if(null!==C&&Se(C)){var P=this._produceModifiedFromDiff(C,c,f);P&&D.push(P)}var A=0,H=0;for(S=S.sort(_),D=D.sort(_);A<S.length&&H<D.length;){var z=S[A],F=D[H],B=z.afterLineNumber-g,U=F.afterLineNumber-h;B<U?(p(l,z),A++):U<B?(p(u,F),H++):z.shouldNotShrink?(p(l,z),A++):F.shouldNotShrink?(p(u,F),H++):z.heightInLines>=F.heightInLines?(z.heightInLines-=F.heightInLines,H++):(F.heightInLines-=z.heightInLines,A++)}for(;A<S.length;)p(l,S[A]),A++;for(;H<D.length;)p(u,D[H]),H++}return{original:e._ensureDomNodes(l),modified:e._ensureDomNodes(u)}}}],[{key:"_getViewLineCount",value:function(e,i,t){var n=e.getModel(),o=e._getViewModel();if(n&&o){var r=xe(n,o,i,t);return r.endLineNumber-r.startLineNumber+1}return t-i+1}},{key:"_ensureDomNodes",value:function(e){return e.map((function(e){return e.domNode||(e.domNode=Ie()),e}))}}]),e}();function be(e,i,t,n,o){return{range:new V.e(e,i,t,n),options:o}}var ye={arrowRevertChange:j.qx.register({description:"diff-editor-arrow-revert-change",glyphMarginHoverMessage:new E.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(T.NC("revertChangeHoverMessage","Click to revert change")),glyphMarginClassName:"arrow-revert-change "+N.k.asClassName(b.l.arrowRight),zIndex:10001}),charDelete:j.qx.register({description:"diff-editor-char-delete",className:"char-delete"}),charDeleteWholeLine:j.qx.register({description:"diff-editor-char-delete-whole-line",className:"char-delete",isWholeLine:!0}),charInsert:j.qx.register({description:"diff-editor-char-insert",className:"char-insert"}),charInsertWholeLine:j.qx.register({description:"diff-editor-char-insert-whole-line",className:"char-insert",isWholeLine:!0}),lineInsert:j.qx.register({description:"diff-editor-line-insert",className:"line-insert",marginClassName:"gutter-insert",isWholeLine:!0}),lineInsertWithSign:j.qx.register({description:"diff-editor-line-insert-with-sign",className:"line-insert",linesDecorationsClassName:"insert-sign "+N.k.asClassName(fe),marginClassName:"gutter-insert",isWholeLine:!0}),lineDelete:j.qx.register({description:"diff-editor-line-delete",className:"line-delete",marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteWithSign:j.qx.register({description:"diff-editor-line-delete-with-sign",className:"line-delete",linesDecorationsClassName:"delete-sign "+N.k.asClassName(ce),marginClassName:"gutter-delete",isWholeLine:!0}),lineDeleteMargin:j.qx.register({description:"diff-editor-line-delete-margin",marginClassName:"gutter-delete"})},we=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,r){var a;return(0,u.Z)(this,t),(a=i.call(this,e))._disableSash=!1===n,a._defaultRatio=r,a._sashRatio=null,a._sashPosition=null,a._startSashPosition=null,a._sash=a._register(new m.g(a._dataSource.getContainerDomNode(),(0,o.Z)(a),{orientation:0})),a._disableSash&&(a._sash.state=0),a._sash.onDidStart((function(){return a._onSashDragStart()})),a._sash.onDidChange((function(e){return a._onSashDrag(e)})),a._sash.onDidEnd((function(){return a._onSashDragEnd()})),a._sash.onDidReset((function(){return a._onSashReset()})),a}return(0,f.Z)(t,[{key:"setEnableSplitViewResizing",value:function(e,i){this._defaultRatio=i;var t=!1===e;this._disableSash!==t&&(this._disableSash=t,this._sash.state=this._disableSash?0:3)}},{key:"layout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._sashRatio||this._defaultRatio,i=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?ve.ENTIRE_DIFF_OVERVIEW_WIDTH:0),n=Math.floor((e||this._defaultRatio)*i),o=Math.floor(this._defaultRatio*i);return n=this._disableSash?o:n||o,i>2*t.MINIMUM_EDITOR_WIDTH?(n<t.MINIMUM_EDITOR_WIDTH&&(n=t.MINIMUM_EDITOR_WIDTH),n>i-t.MINIMUM_EDITOR_WIDTH&&(n=i-t.MINIMUM_EDITOR_WIDTH)):n=o,this._sashPosition!==n&&(this._sashPosition=n),this._sash.layout(),this._sashPosition}},{key:"_onSashDragStart",value:function(){this._startSashPosition=this._sashPosition}},{key:"_onSashDrag",value:function(e){var i=this._dataSource.getWidth()-(this._dataSource.getOptions().renderOverviewRuler?ve.ENTIRE_DIFF_OVERVIEW_WIDTH:0),t=this.layout((this._startSashPosition+(e.currentX-e.startX))/i);this._sashRatio=t/i,this._dataSource.relayoutEditors()}},{key:"_onSashDragEnd",value:function(){this._sash.layout()}},{key:"_onSashReset",value:function(){this._sashRatio=this._defaultRatio,this._dataSource.relayoutEditors(),this._sash.layout()}},{key:"getVerticalSashTop",value:function(e){return 0}},{key:"getVerticalSashLeft",value:function(e){return this._sashPosition}},{key:"getVerticalSashHeight",value:function(e){return this._dataSource.getHeight()}},{key:"setBoundarySashes",value:function(e){this._sash.orthogonalEndSash=e.bottom}},{key:"_getViewZones",value:function(e,i,t){var n=this._dataSource.getOriginalEditor(),o=this._dataSource.getModifiedEditor();return new Ee(e,i,t,n,o).getViewZones()}},{key:"_getOriginalEditorDecorations",value:function(e,i,t,n){var o,r=this._dataSource.getOriginalEditor(),a=String(this._removeColor),d={decorations:[],overviewZones:[]},s=r.getModel(),u=r._getViewModel(),f=(0,l.Z)(i);try{for(f.s();!(o=f.n()).done;){var c=o.value;if(Se(c)){d.decorations.push({range:new V.e(c.originalStartLineNumber,1,c.originalEndLineNumber,1073741824),options:n?ye.lineDeleteWithSign:ye.lineDelete}),Ce(c)&&c.charChanges||d.decorations.push(be(c.originalStartLineNumber,1,c.originalEndLineNumber,1073741824,ye.charDeleteWholeLine));var g=xe(s,u,c.originalStartLineNumber,c.originalEndLineNumber);if(d.overviewZones.push(new $.EY(g.startLineNumber,g.endLineNumber,0,a)),c.charChanges){var h,v=(0,l.Z)(c.charChanges);try{for(v.s();!(h=v.n()).done;){var m=h.value;if(Re(m))if(t)for(var _=m.originalStartLineNumber;_<=m.originalEndLineNumber;_++){var p=void 0,b=void 0;p=_===m.originalStartLineNumber?m.originalStartColumn:s.getLineFirstNonWhitespaceColumn(_),b=_===m.originalEndLineNumber?m.originalEndColumn:s.getLineLastNonWhitespaceColumn(_),d.decorations.push(be(_,p,_,b,ye.charDelete))}else d.decorations.push(be(m.originalStartLineNumber,m.originalStartColumn,m.originalEndLineNumber,m.originalEndColumn,ye.charDelete))}}catch(y){v.e(y)}finally{v.f()}}}}}catch(y){f.e(y)}finally{f.f()}return d}},{key:"_getModifiedEditorDecorations",value:function(e,i,t,n,o){var r,a=this._dataSource.getModifiedEditor(),d=String(this._insertColor),s={decorations:[],overviewZones:[]},u=a.getModel(),f=a._getViewModel(),g=(0,l.Z)(i);try{var h=function(){var i=r.value;if(o)if(i.modifiedEndLineNumber>0)s.decorations.push({range:new V.e(i.modifiedStartLineNumber,1,i.modifiedStartLineNumber,1),options:ye.arrowRevertChange});else{var a=e.modified.find((function(e){return e.afterLineNumber===i.modifiedStartLineNumber}));a&&(a.marginDomNode=function(){var e=document.createElement("div");return e.className="arrow-revert-change "+N.k.asClassName(b.l.arrowRight),c.$("div",{},e)}())}if(Ce(i)){s.decorations.push({range:new V.e(i.modifiedStartLineNumber,1,i.modifiedEndLineNumber,1073741824),options:n?ye.lineInsertWithSign:ye.lineInsert}),Se(i)&&i.charChanges||s.decorations.push(be(i.modifiedStartLineNumber,1,i.modifiedEndLineNumber,1073741824,ye.charInsertWholeLine));var g=xe(u,f,i.modifiedStartLineNumber,i.modifiedEndLineNumber);if(s.overviewZones.push(new $.EY(g.startLineNumber,g.endLineNumber,0,d)),i.charChanges){var h,v=(0,l.Z)(i.charChanges);try{for(v.s();!(h=v.n()).done;){var m=h.value;if(De(m))if(t)for(var _=m.modifiedStartLineNumber;_<=m.modifiedEndLineNumber;_++){var p=void 0,y=void 0;p=_===m.modifiedStartLineNumber?m.modifiedStartColumn:u.getLineFirstNonWhitespaceColumn(_),y=_===m.modifiedEndLineNumber?m.modifiedEndColumn:u.getLineLastNonWhitespaceColumn(_),s.decorations.push(be(_,p,_,y,ye.charInsert))}else s.decorations.push(be(m.modifiedStartLineNumber,m.modifiedStartColumn,m.modifiedEndLineNumber,m.modifiedEndColumn,ye.charInsert))}}catch(w){v.e(w)}finally{v.f()}}}};for(g.s();!(r=g.n()).done;)h()}catch(v){g.e(v)}finally{g.f()}return s}}]),t}(me);we.MINIMUM_EDITOR_WIDTH=100;var Ee=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,o,r,a){return(0,u.Z)(this,t),i.call(this,e,n,o,r,a)}return(0,f.Z)(t,[{key:"_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion",value:function(){return null}},{key:"_produceOriginalFromDiff",value:function(e,i,t){return t>i?{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:t-i,domNode:null}:null}},{key:"_produceModifiedFromDiff",value:function(e,i,t){return i>t?{afterLineNumber:Math.max(e.modifiedStartLineNumber,e.modifiedEndLineNumber),heightInLines:i-t,domNode:null}:null}}]),t}(pe),Le=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n){var o;return(0,u.Z)(this,t),(o=i.call(this,e))._decorationsLeft=e.getOriginalEditor().getLayoutInfo().decorationsLeft,o._register(e.getOriginalEditor().onDidLayoutChange((function(i){o._decorationsLeft!==i.decorationsLeft&&(o._decorationsLeft=i.decorationsLeft,e.relayoutEditors())}))),o}return(0,f.Z)(t,[{key:"setEnableSplitViewResizing",value:function(e){}},{key:"_getViewZones",value:function(e,i,t,n){var o=this._dataSource.getOriginalEditor(),r=this._dataSource.getModifiedEditor();return new Ne(e,i,t,o,r,n).getViewZones()}},{key:"_getOriginalEditorDecorations",value:function(e,i,t,n){var o,r=String(this._removeColor),a={decorations:[],overviewZones:[]},d=this._dataSource.getOriginalEditor(),s=d.getModel(),u=d._getViewModel(),f=0,c=(0,l.Z)(i);try{for(c.s();!(o=c.n()).done;){var g=o.value;if(Se(g)){for(a.decorations.push({range:new V.e(g.originalStartLineNumber,1,g.originalEndLineNumber,1073741824),options:ye.lineDeleteMargin});f<e.modified.length;){var h=e.modified[f];if(h.diff&&h.diff.originalStartLineNumber>=g.originalStartLineNumber)break;f++}var v=0;if(f<e.modified.length){var m=e.modified[f];m.diff&&m.diff.originalStartLineNumber===g.originalStartLineNumber&&m.diff.originalEndLineNumber===g.originalEndLineNumber&&m.diff.modifiedStartLineNumber===g.modifiedStartLineNumber&&m.diff.modifiedEndLineNumber===g.modifiedEndLineNumber&&(v=m.heightInLines)}var _=xe(s,u,g.originalStartLineNumber,g.originalEndLineNumber);a.overviewZones.push(new $.EY(_.startLineNumber,_.endLineNumber,v,r))}}}catch(p){c.e(p)}finally{c.f()}return a}},{key:"_getModifiedEditorDecorations",value:function(e,i,t,n,o){var r,a=this._dataSource.getModifiedEditor(),d=String(this._insertColor),s={decorations:[],overviewZones:[]},u=a.getModel(),f=a._getViewModel(),c=(0,l.Z)(i);try{for(c.s();!(r=c.n()).done;){var g=r.value;if(Ce(g)){s.decorations.push({range:new V.e(g.modifiedStartLineNumber,1,g.modifiedEndLineNumber,1073741824),options:n?ye.lineInsertWithSign:ye.lineInsert});var h=xe(u,f,g.modifiedStartLineNumber,g.modifiedEndLineNumber);if(s.overviewZones.push(new $.EY(h.startLineNumber,h.endLineNumber,0,d)),g.charChanges){var v,m=(0,l.Z)(g.charChanges);try{for(m.s();!(v=m.n()).done;){var _=v.value;if(De(_))if(t)for(var p=_.modifiedStartLineNumber;p<=_.modifiedEndLineNumber;p++){var b=void 0,y=void 0;b=p===_.modifiedStartLineNumber?_.modifiedStartColumn:u.getLineFirstNonWhitespaceColumn(p),y=p===_.modifiedEndLineNumber?_.modifiedEndColumn:u.getLineLastNonWhitespaceColumn(p),s.decorations.push(be(p,b,p,y,ye.charInsert))}else s.decorations.push(be(_.modifiedStartLineNumber,_.modifiedStartColumn,_.modifiedEndLineNumber,_.modifiedEndColumn,ye.charInsert))}}catch(w){m.e(w)}finally{m.f()}}else s.decorations.push(be(g.modifiedStartLineNumber,1,g.modifiedEndLineNumber,1073741824,ye.charInsertWholeLine))}}}catch(w){c.e(w)}finally{c.f()}return s}},{key:"layout",value:function(){return Math.max(5,this._decorationsLeft)}}]),t}(me),Ne=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,o,r,a,d){var s;return(0,u.Z)(this,t),(s=i.call(this,e,n,o,r,a))._originalModel=r.getModel(),s._renderIndicators=d,s._pendingLineChange=[],s._pendingViewZones=[],s._lineBreaksComputer=s._modifiedEditor._getViewModel().createLineBreaksComputer(),s}return(0,f.Z)(t,[{key:"getViewZones",value:function(){var e=(0,r.Z)((0,a.Z)(t.prototype),"getViewZones",this).call(this);return this._finalize(e),e}},{key:"_createOriginalMarginDomNodeForModifiedForeignViewZoneInAddedRegion",value:function(){var e=document.createElement("div");return e.className="inline-added-margin-view-zone",e}},{key:"_produceOriginalFromDiff",value:function(e,i,t){var n=document.createElement("div");return n.className="inline-added-margin-view-zone",{afterLineNumber:Math.max(e.originalStartLineNumber,e.originalEndLineNumber),heightInLines:t,domNode:document.createElement("div"),marginDomNode:n}}},{key:"_produceModifiedFromDiff",value:function(e,i,t){var n=document.createElement("div");n.className="view-lines line-delete ".concat(v.S);var o=document.createElement("div");o.className="inline-deleted-margin-view-zone";for(var r={shouldNotShrink:!0,afterLineNumber:0===e.modifiedEndLineNumber?e.modifiedStartLineNumber:e.modifiedStartLineNumber-1,heightInLines:i,minWidthInPx:0,domNode:n,marginDomNode:o,diff:{originalStartLineNumber:e.originalStartLineNumber,originalEndLineNumber:e.originalEndLineNumber,modifiedStartLineNumber:e.modifiedStartLineNumber,modifiedEndLineNumber:e.modifiedEndLineNumber,originalModel:this._originalModel,viewLineCounts:null}},a=e.originalStartLineNumber;a<=e.originalEndLineNumber;a++)this._lineBreaksComputer.addRequest(this._originalModel.getLineContent(a),null,null);return this._pendingLineChange.push(e),this._pendingViewZones.push(r),r}},{key:"_finalize",value:function(e){for(var i=this._modifiedEditor.getOptions(),t=this._modifiedEditor.getModel().getOptions().tabSize,n=i.get(49),o=i.get(32),r=n.typicalHalfwidthCharacterWidth,a=i.get(102),d=this._originalModel.mightContainNonBasicASCII(),s=this._originalModel.mightContainRTL(),u=i.get(65),f=i.get(142).decorationsWidth,c=i.get(115),g=i.get(97),h=i.get(92),v=i.get(50),m=this._lineBreaksComputer.finalize(),_=0,p=0;p<this._pendingLineChange.length;p++){var b=this._pendingLineChange[p],y=this._pendingViewZones[p],w=y.domNode;(0,C.N)(w,n);var E=y.marginDomNode;(0,C.N)(E,n);var L=[];if(b.charChanges){var N,S=(0,l.Z)(b.charChanges);try{for(S.s();!(N=S.n()).done;){var D=N.value;Re(D)&&L.push(new G.$t(new V.e(D.originalStartLineNumber,D.originalStartColumn,D.originalEndLineNumber,D.originalEndColumn),"char-delete",0))}}catch(Q){S.e(Q)}finally{S.f()}}for(var R=L.length>0,I=new F.HT(1e4),x=0,O=0,M=null,T=b.originalStartLineNumber;T<=b.originalEndLineNumber;T++){var k=T-b.originalStartLineNumber,Z=this._originalModel.tokenization.getLineTokens(T),W=Z.getLineContent(),P=m[_++],A=q.Kp.filter(L,T,1,W.length+1);if(P){var H,z=0,B=(0,l.Z)(P.breakOffsets);try{for(B.s();!(H=B.n()).done;){var U=H.value,j=Z.sliceAndInflate(z,U,0),K=W.substring(z,U);x=Math.max(x,this._renderOriginalLine(O++,K,j,q.Kp.extractWrapped(A,z,U),R,d,s,n,o,u,f,c,g,h,v,t,I,E)),z=U}}catch(Q){B.e(Q)}finally{B.f()}for(M||(M=[]);M.length<k;)M[M.length]=1;M[k]=P.breakOffsets.length,y.heightInLines+=P.breakOffsets.length-1;var $=document.createElement("div");$.className="gutter-delete",e.original.push({afterLineNumber:T,afterColumn:0,heightInLines:P.breakOffsets.length-1,domNode:Ie(),marginDomNode:$})}else x=Math.max(x,this._renderOriginalLine(O++,W,Z,A,R,d,s,n,o,u,f,c,g,h,v,t,I,E))}x+=a;var J=I.build(),X=ge?ge.createHTML(J):J;if(w.innerHTML=X,y.minWidthInPx=x*r,M)for(var Y=b.originalEndLineNumber-b.originalStartLineNumber;M.length<=Y;)M[M.length]=1;y.diff.viewLineCounts=M}e.original.sort((function(e,i){return e.afterLineNumber-i.afterLineNumber}))}},{key:"_renderOriginalLine",value:function(e,i,t,n,o,r,a,d,s,l,u,f,c,g,h,v,m,_){m.appendString('<div class="view-line'),o||m.appendString(" char-delete"),m.appendString('" style="top:'),m.appendString(String(e*l)),m.appendString('px;width:1000000px;">');var p=G.wA.isBasicASCII(i,r),b=G.wA.containsRTL(i,p,a),y=(0,K.d1)(new K.IJ(d.isMonospace&&!s,d.canUseHalfwidthRightwardsArrow,i,!1,p,b,0,t,n,v,0,d.spaceWidth,d.middotWidth,d.wsmiddotWidth,f,c,g,h!==H.n0.OFF,null),m);if(m.appendString("</div>"),this._renderIndicators){var w=document.createElement("div");w.className="delete-sign ".concat(N.k.asClassName(ce)),w.setAttribute("style","position:absolute;top:".concat(e*l,"px;width:").concat(u,"px;height:").concat(l,"px;right:0;")),_.appendChild(w)}return y.characterMapping.getHorizontalOffset(y.characterMapping.length)}}]),t}(pe);function Ce(e){return e.modifiedEndLineNumber>0}function Se(e){return e.originalEndLineNumber>0}function De(e){return e.modifiedStartLineNumber===e.modifiedEndLineNumber?e.modifiedEndColumn-e.modifiedStartColumn>0:e.modifiedEndLineNumber-e.modifiedStartLineNumber>0}function Re(e){return e.originalStartLineNumber===e.originalEndLineNumber?e.originalEndColumn-e.originalStartColumn>0:e.originalEndLineNumber-e.originalStartLineNumber>0}function Ie(){var e=document.createElement("div");return e.className="diagonal-fill",e}function xe(e,i,t,n){var o=e.getLineCount();return t=Math.min(o,Math.max(1,t)),n=Math.min(o,Math.max(1,n)),i.coordinatesConverter.convertModelRangeToViewRange(new V.e(t,e.getLineMinColumn(t),n,e.getLineMaxColumn(n)))}function Oe(e,i){return{enableSplitViewResizing:(0,H.O7)(e.enableSplitViewResizing,i.enableSplitViewResizing),splitViewDefaultRatio:(0,H.L_)(e.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:(0,H.O7)(e.renderSideBySide,i.renderSideBySide),renderMarginRevertIcon:(0,H.O7)(e.renderMarginRevertIcon,i.renderMarginRevertIcon),maxComputationTime:(0,H.Zc)(e.maxComputationTime,i.maxComputationTime,0,1073741824),maxFileSize:(0,H.Zc)(e.maxFileSize,i.maxFileSize,0,1073741824),ignoreTrimWhitespace:(0,H.O7)(e.ignoreTrimWhitespace,i.ignoreTrimWhitespace),renderIndicators:(0,H.O7)(e.renderIndicators,i.renderIndicators),originalEditable:(0,H.O7)(e.originalEditable,i.originalEditable),diffCodeLens:(0,H.O7)(e.diffCodeLens,i.diffCodeLens),renderOverviewRuler:(0,H.O7)(e.renderOverviewRuler,i.renderOverviewRuler),diffWordWrap:(t=e.diffWordWrap,n=i.diffWordWrap,(0,H.NY)(t,n,["off","on","inherit"])),diffAlgorithm:(0,H.NY)(e.diffAlgorithm,i.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:(0,H.O7)(e.accessibilityVerbose,i.accessibilityVerbose),experimental:{collapseUnchangedRegions:!1},isInEmbeddedEditor:(0,H.O7)(e.isInEmbeddedEditor,i.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:!1};var t,n}(0,re.Ic)((function(e,i){var t=e.getColor(ne.L_t);i.addRule("\n\t.monaco-editor .diagonal-fill {\n\t\tbackground-image: linear-gradient(\n\t\t\t-45deg,\n\t\t\t".concat(t," 12.5%,\n\t\t\t#0000 12.5%, #0000 50%,\n\t\t\t").concat(t," 50%, ").concat(t," 62.5%,\n\t\t\t#0000 62.5%, #0000 100%\n\t\t);\n\t\tbackground-size: 8px 8px;\n\t}\n\t"))}))},6994:function(e,i,t){t.d(i,{z:function(){return Bi}});var n=t(37762),o=t(15671),r=t(43144),a=t(97326),d=t(60136),s=t(27277),l=t(32959),u=t(74146),f=t(13880),c=t(90955),g=t(48777),h=t(97446),v=t(96037),m=t(95253),_=t(76257),p=t(51811),b=t(65096),y=t(63021),w=t(77409),E=t(71047),L=t(79730),N=t(78519),C=t(18420),S=t(87288),D=(0,S.q5)("diff-insert",w.l.add,(0,C.NC)("diffInsertIcon","Line decoration for inserts in the diff editor.")),R=(0,S.q5)("diff-remove",w.l.remove,(0,C.NC)("diffRemoveIcon","Line decoration for removals in the diff editor.")),I=N.qx.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+L.k.asClassName(D),marginClassName:"gutter-insert"}),x=N.qx.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+L.k.asClassName(R),marginClassName:"gutter-delete"}),O=N.qx.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),M=N.qx.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),T=N.qx.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),k=N.qx.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),V=N.qx.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),Z=N.qx.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),W=N.qx.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),P=N.qx.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"}),A=N.qx.register({description:"diff-editor-arrow-revert-change",glyphMarginHoverMessage:new E.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown((0,C.NC)("revertChangeHoverMessage","Click to revert change")),glyphMarginClassName:"arrow-revert-change "+L.k.asClassName(w.l.arrowRight),zIndex:10001}),H=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,r,a,d,s){var l;(0,o.Z)(this,t),(l=i.call(this))._rootElement=e,l._diffModel=r,l._originalEditorLayoutInfo=a,l._modifiedEditorLayoutInfo=d,l._editors=s;var u=document.createElementNS("http://www.w3.org/2000/svg","svg");u.setAttribute("class","moved-blocks-lines"),l._rootElement.appendChild(u),l._register((0,c.EH)("update",(function(e){var i=l._originalEditorLayoutInfo.read(e),n=l._modifiedEditorLayoutInfo.read(e);i&&n&&(u.style.left="".concat(i.width-i.verticalScrollbarWidth,"px"),u.style.height="".concat(i.height,"px"),u.style.width="".concat(i.verticalScrollbarWidth+i.contentLeft-t.movedCodeBlockPadding,"px"))})));var f=(0,c.rD)(l._editors.original.onDidScrollChange,(function(){return l._editors.original.getScrollTop()})),g=(0,c.rD)(l._editors.modified.onDidScrollChange,(function(){return l._editors.modified.getScrollTop()})),h=(0,c.aq)("onDidChangeViewZones",l._editors.modified.onDidChangeViewZones);return l._register((0,c.EH)("update",(function(e){var i,o;u.replaceChildren(),h.read(e);var r=l._originalEditorLayoutInfo.read(e),a=l._modifiedEditorLayoutInfo.read(e);if(r&&a){var d=r.verticalScrollbarWidth+r.contentLeft-t.movedCodeBlockPadding,s=null===(o=null===(i=l._diffModel.read(e))||void 0===i?void 0:i.diff.read(e))||void 0===o?void 0:o.movedTexts;if(s){var c,v=0,m=(0,n.Z)(s);try{var _=function(){var i=c.value;function t(e,i){return(i.getTopForLineNumber(e.startLineNumber)+i.getTopForLineNumber(e.endLineNumberExclusive))/2}var n=t(i.lineRangeMapping.original,l._editors.original)-f.read(e),o=t(i.lineRangeMapping.modified,l._editors.modified)-g.read(e),r=d/2-5*s.length+10*v;v++;var a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d","M ".concat(0," ",n," L ").concat(r," ").concat(n," L ").concat(r," ").concat(o," L ").concat(d," ").concat(o)),a.setAttribute("fill","none"),u.appendChild(a)};for(m.s();!(c=m.n()).done;)_()}catch(p){m.e(p)}finally{m.f()}}}}))),l}return(0,r.Z)(t)}(b.JT);H.movedCodeBlockPadding=4;var z=t(93433),F=t(29439),B=t(9284);function U(e,i){var t=new b.SL,n=e.createDecorationsCollection();return t.add((0,c.EH)("Apply decorations from ".concat(i.debugName),(function(e){var t=i.read(e);n.set(t)}))),t.add({dispose:function(){n.clear()}}),t}function j(e,i){return e.appendChild(i),(0,b.OF)((function(){e.removeChild(i)}))}var q=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n){var r;return(0,o.Z)(this,t),(r=i.call(this)).elementSizeObserver=r._register(new B.I(e,n)),r._width=(0,c.uh)("width",r.elementSizeObserver.getWidth()),r._height=(0,c.uh)("height",r.elementSizeObserver.getHeight()),r._register(r.elementSizeObserver.onDidChange((function(e){return(0,c.PS)((function(e){r._width.set(r.elementSizeObserver.getWidth(),e),r._height.set(r.elementSizeObserver.getHeight(),e)}))}))),r}return(0,r.Z)(t,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"observe",value:function(e){this.elementSizeObserver.observe(e)}},{key:"setAutomaticLayout",value:function(e){e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}]),t}(b.JT);function K(e,i){var t=e.get(),n=t,o=t,r=(0,c.uh)("animatedValue",t),a=-1,d=void 0;function s(){var e,i,l,u,f=Date.now()-a;o=Math.floor((i=n,l=t-n,(e=f)===(u=300)?i+l:l*(1-Math.pow(2,-10*e/u))+i)),f<300?d=requestAnimationFrame(s):o=t,r.set(o,void 0)}return i.add((0,c.nJ)("update value",{createEmptyChangeSummary:function(){return{animate:!1}},handleChange:function(i,t){return i.didChange(e)&&(t.animate=t.animate||i.change),!0}},(function(i,r){void 0!==d&&(cancelAnimationFrame(d),d=void 0),n=o,t=e.read(i),a=Date.now()-(r.animate?0:300),s()}))),r}var G=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,r){var a;return(0,o.Z)(this,t),(a=i.call(this))._register(new J(e,r)),a._register(X(r,{height:n.actualHeight,top:n.actualTop})),a}return(0,r.Z)(t)}(b.JT),$=function(){function e(i,t){var n=this;(0,o.Z)(this,e),this._afterLineNumber=i,this.heightInPx=t,this.domNode=document.createElement("div"),this._actualTop=(0,c.uh)("actualTop",void 0),this._actualHeight=(0,c.uh)("actualHeight",void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=function(e){n._actualTop.set(e,void 0)},this.onComputedHeight=function(e){n._actualHeight.set(e,void 0)}}return(0,r.Z)(e,[{key:"afterLineNumber",get:function(){return this._afterLineNumber.get()}}]),e}(),J=function(){function e(i,t){var n=this;(0,o.Z)(this,e),this._editor=i,this._domElement=t,this._overlayWidgetId="managedOverlayWidget-".concat(e._counter++),this._overlayWidget={getId:function(){return n._overlayWidgetId},getDomNode:function(){return n._domElement},getPosition:function(){return null}},this._editor.addOverlayWidget(this._overlayWidget)}return(0,r.Z)(e,[{key:"dispose",value:function(){this._editor.removeOverlayWidget(this._overlayWidget)}}]),e}();function X(e,i){return(0,c.EH)("applyStyle",(function(t){for(var n=0,o=Object.entries(i);n<o.length;n++){var r=(0,F.Z)(o[n],2),a=r[0],d=r[1];d&&"object"===typeof d&&"read"in d&&(d=d.read(t)),"number"===typeof d&&(d="".concat(d,"px")),e.style[a]=d}}))}function Y(e,i){return function(e,i){var t=globalThis.$hotReload_deprecateExports;if(!t)return;(0,c.aq)("reload",(function(i){function n(t,n){return!!(0,z.Z)(Object.values(t)).some((function(i){return e.includes(i)}))&&(i(void 0),!0)}return t.add(n),{dispose:function(){t.delete(n)}}})).read(i)}([e],i),e}function Q(e,i,t){var o=new b.SL,r=[];return o.add((0,c.EH)("applyViewZones",(function(a){var d=i.read(a),s=new Map,l=new Map;t&&t(!0),e.changeViewZones((function(e){for(var i=0,t=r;i<t.length;i++){var o=t[i];e.removeZone(o)}r.length=0;var a,l=(0,n.Z)(d);try{for(l.s();!(a=l.n()).done;){var u=a.value,f=e.addZone(u);r.push(f),s.set(u,f)}}catch(c){l.e(c)}finally{l.f()}})),t&&t(!1),o.add((0,c.nJ)("layoutZone on change",{createEmptyChangeSummary:function(){return[]},handleChange:function(e,i){var t=l.get(e.changedObservable);return void 0!==t&&i.push(t),!0}},(function(i,o){var r,a=(0,n.Z)(d);try{for(a.s();!(r=a.n()).done;){var u=r.value;u.onChange&&(l.set(u.onChange,s.get(u)),u.onChange.read(i))}}catch(f){a.e(f)}finally{a.f()}t&&t(!0),e.changeViewZones((function(e){var i,t=(0,n.Z)(o);try{for(t.s();!(i=t.n()).done;){var r=i.value;e.layoutZone(r)}}catch(f){t.e(f)}finally{t.f()}})),t&&t(!1)})))}))),o.add({dispose:function(){t&&t(!0),e.changeViewZones((function(e){for(var i=0,t=r;i<t.length;i++){var n=t[i];e.removeZone(n)}})),t&&t(!1)}}),o}J._counter=0;var ee=t(77621),ie=t(65631),te=t(17429),ne=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,r,a){var d;return(0,o.Z)(this,t),(d=i.call(this))._editors=e,d._diffModel=r,d._options=a,d._decorations=(0,c.nK)("decorations",(function(e){var i,t=null===(i=d._diffModel.read(e))||void 0===i?void 0:i.diff.read(e);if(!t)return null;var o,r=d._diffModel.read(e).syncedMovedTexts.read(e),a=d._options.renderIndicators.read(e),s=d._options.showEmptyDecorations.read(e),l=[],u=[],f=(0,n.Z)(t.mappings);try{for(f.s();!(o=f.n()).done;){var c,g=o.value,h=ee.z.subtract(g.lineRangeMapping.originalRange,null===r||void 0===r?void 0:r.lineRangeMapping.original).map((function(e){return e.toInclusiveRange()})).filter(y.$K),v=(0,n.Z)(h);try{for(v.s();!(c=v.n()).done;){var m=c.value;l.push({range:m,options:a?x:M})}}catch(ne){v.e(ne)}finally{v.f()}var _,p=ee.z.subtract(g.lineRangeMapping.modifiedRange,null===r||void 0===r?void 0:r.lineRangeMapping.modified).map((function(e){return e.toInclusiveRange()})).filter(y.$K),b=(0,n.Z)(p);try{for(b.s();!(_=b.n()).done;){var w=_.value;u.push({range:w,options:a?I:O})}}catch(ne){b.e(ne)}finally{b.f()}if(g.lineRangeMapping.modifiedRange.isEmpty||g.lineRangeMapping.originalRange.isEmpty){var E,L=(0,n.Z)(h);try{for(L.s();!(E=L.n()).done;){var N=E.value;l.push({range:N,options:W})}}catch(ne){L.e(ne)}finally{L.f()}var C,S=(0,n.Z)(p);try{for(S.s();!(C=S.n()).done;){var D=C.value;u.push({range:D,options:k})}}catch(ne){S.e(ne)}finally{S.f()}}else{var R,z=(0,n.Z)(g.lineRangeMapping.innerChanges||[]);try{for(z.s();!(R=z.n()).done;){var F=R.value;r&&(r.lineRangeMapping.original.intersect(new ee.z(F.originalRange.startLineNumber,F.originalRange.endLineNumber))||r.lineRangeMapping.modified.intersect(new ee.z(F.modifiedRange.startLineNumber,F.modifiedRange.endLineNumber)))||(g.lineRangeMapping.originalRange.contains(F.originalRange.startLineNumber)&&l.push({range:F.originalRange,options:F.originalRange.isEmpty()&&s?P:Z}),g.lineRangeMapping.modifiedRange.contains(F.modifiedRange.startLineNumber)&&u.push({range:F.modifiedRange,options:F.modifiedRange.isEmpty()&&s?V:T}))}}catch(ne){z.e(ne)}finally{z.f()}}g.lineRangeMapping.modifiedRange.isEmpty||!d._options.shouldRenderRevertArrows.read(e)||r||u.push({range:te.e.fromPositions(new ie.L(g.lineRangeMapping.modifiedRange.startLineNumber,1)),options:A})}}catch(ne){f.e(ne)}finally{f.f()}if(r){var B,U=(0,n.Z)(r.changes);try{for(U.s();!(B=U.n()).done;){var j=B.value,q=j.originalRange.toInclusiveRange();q&&l.push({range:q,options:a?x:M});var K=j.modifiedRange.toInclusiveRange();K&&u.push({range:K,options:a?I:O});var G,$=(0,n.Z)(j.innerChanges||[]);try{for($.s();!(G=$.n()).done;){var J=G.value;l.push({range:J.originalRange,options:Z}),u.push({range:J.modifiedRange,options:T})}}catch(ne){$.e(ne)}finally{$.f()}}}catch(ne){U.e(ne)}finally{U.f()}}var X,Y=(0,n.Z)(t.movedTexts);try{for(Y.s();!(X=Y.n()).done;){var Q=X.value;l.push({range:Q.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal",blockPadding:[H.movedCodeBlockPadding,0,H.movedCodeBlockPadding,H.movedCodeBlockPadding]}}),u.push({range:Q.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified",blockPadding:[4,0,4,4]}})}}catch(ne){Y.e(ne)}finally{Y.f()}return{originalDecorations:l,modifiedDecorations:u}})),d._register(U(d._editors.original,d._decorations.map((function(e){return(null===e||void 0===e?void 0:e.originalDecorations)||[]})))),d._register(U(d._editors.modified,d._decorations.map((function(e){return(null===e||void 0===e?void 0:e.modifiedDecorations)||[]})))),d}return(0,r.Z)(t)}(b.JT),oe=t(23954),re=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,r){var a;return(0,o.Z)(this,t),(a=i.call(this))._options=e,a._domNode=n,a._dimensions=r,a._sashRatio=(0,c.uh)("sashRatio",void 0),a.sashLeft=(0,c.nK)("sashLeft",(function(e){var i,t=null!==(i=a._sashRatio.read(e))&&void 0!==i?i:a._options.splitViewDefaultRatio.read(e);return a._computeSashLeft(t,e)})),a._sash=a._register(new oe.g(a._domNode,{getVerticalSashTop:function(e){return 0},getVerticalSashLeft:function(e){return a.sashLeft.get()},getVerticalSashHeight:function(e){return a._dimensions.height.get()}},{orientation:0})),a._startSashPosition=void 0,a._register(a._sash.onDidStart((function(){a._startSashPosition=a.sashLeft.get()}))),a._register(a._sash.onDidChange((function(e){var i=a._dimensions.width.get(),t=a._computeSashLeft((a._startSashPosition+(e.currentX-e.startX))/i,void 0);a._sashRatio.set(t/i,void 0)}))),a._register(a._sash.onDidEnd((function(){return a._sash.layout()}))),a._register(a._sash.onDidReset((function(){return a._sashRatio.set(void 0,void 0)}))),a._register((0,c.EH)("update sash layout",(function(e){var i=a._options.enableSplitViewResizing.read(e);a._sash.state=i?3:0,a.sashLeft.read(e),a._sash.layout()}))),a}return(0,r.Z)(t,[{key:"setBoundarySashes",value:function(e){this._sash.orthogonalEndSash=e.bottom}},{key:"_computeSashLeft",value:function(e,i){var t=this._dimensions.width.read(i),n=Math.floor(this._options.splitViewDefaultRatio.read(i)*t),o=this._options.enableSplitViewResizing.read(i)?Math.floor(e*t):n,r=100;return t<=200?n:o<r?r:o>t-r?t-r:o}}]),t}(b.JT),ae=t(38102),de=t(71049),se=t(88616),le=t(49039),ue=t(74165),fe=t(97957),ce=t(64061),ge=t(75576),he=t(63571),ve=t(49198),me=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function a(e){try{s(n.next(e))}catch(i){r(i)}}function d(e){try{s(n.throw(e))}catch(i){r(i)}}function s(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(a,d)}s((n=n.apply(e,i||[])).next())}))},_e=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,r,d){var s;(0,o.Z)(this,t),(s=i.call(this)).model=e,s._options=r,s._isDiffUpToDate=(0,c.uh)("isDiffUpToDate",!1),s.isDiffUpToDate=s._isDiffUpToDate,s._diff=(0,c.uh)("diff",void 0),s.diff=s._diff,s._unchangedRegions=(0,c.uh)("unchangedRegion",{regions:[],originalDecorationIds:[],modifiedDecorationIds:[]}),s.unchangedRegions=(0,c.nK)("unchangedRegions",(function(e){return s._options.collapseUnchangedRegions.read(e)?s._unchangedRegions.read(e).regions:((0,c.PS)((function(e){var i,t=(0,n.Z)(s._unchangedRegions.get().regions);try{for(t.s();!(i=t.n()).done;){i.value.setState(0,0,e)}}catch(o){t.e(o)}finally{t.f()}})),[])})),s.syncedMovedTexts=(0,c.uh)("syncedMovedText",void 0);var l=(0,c.GN)("contentChangedSignal"),u=s._register(new de.pY((function(){return l.trigger(void 0)}),200)),f=function(i,t){var o,r=ye.fromDiffs(i.changes,e.original.getLineCount(),e.modified.getLineCount()),a=s._unchangedRegions.get(),d=a.originalDecorationIds.map((function(i){return e.original.getDecorationRange(i)})).filter((function(e){return!!e})).map((function(e){return ee.z.fromRange(e)})),l=a.modifiedDecorationIds.map((function(i){return e.modified.getDecorationRange(i)})).filter((function(e){return!!e})).map((function(e){return ee.z.fromRange(e)})),u=e.original.deltaDecorations(a.originalDecorationIds,r.map((function(e){return{range:e.originalRange.toInclusiveRange(),options:{description:"unchanged"}}}))),f=e.modified.deltaDecorations(a.modifiedDecorationIds,r.map((function(e){return{range:e.modifiedRange.toInclusiveRange(),options:{description:"unchanged"}}}))),c=(0,n.Z)(r);try{for(c.s();!(o=c.n()).done;)for(var g=o.value,h=0;h<a.regions.length;h++)if(g.originalRange.intersectsStrict(d[h])&&g.modifiedRange.intersectsStrict(l[h])){g.setHiddenModifiedRange(a.regions[h].getHiddenModifiedRange(void 0),t);break}}catch(v){c.e(v)}finally{c.f()}s._unchangedRegions.set({regions:r,originalDecorationIds:u,modifiedDecorationIds:f},t)};s._register(e.modified.onDidChangeContent((function(i){if(s._diff.get()){var t=ge.Q.fromModelContentChanges(i.changes),n=Le(s._lastDiff,t,e.original,e.modified);n&&(s._lastDiff=n,(0,c.PS)((function(e){s._diff.set(pe.fromDiffResult(s._lastDiff),e),f(n,e);var i=s.syncedMovedTexts.get();s.syncedMovedTexts.set(i?s._lastDiff.moves.find((function(e){return e.lineRangeMapping.modified.intersect(i.lineRangeMapping.modified)})):void 0,e)}))),u.schedule()}}))),s._register(e.original.onDidChangeContent((function(i){if(s._diff.get()){var t=ge.Q.fromModelContentChanges(i.changes),n=we(s._lastDiff,t,e.original,e.modified);n&&(s._lastDiff=n,(0,c.PS)((function(e){s._diff.set(pe.fromDiffResult(s._lastDiff),e),f(n,e);var i=s.syncedMovedTexts.get();s.syncedMovedTexts.set(i?s._lastDiff.moves.find((function(e){return e.lineRangeMapping.modified.intersect(i.lineRangeMapping.modified)})):void 0,e)}))),u.schedule()}})));var h=(0,c.aq)("documentDiffProviderOptionChanged",d.onDidChange);return s._register((0,g.b2)("compute diff",(function(i,t){return me((0,a.Z)(s),void 0,void 0,(0,ue.Z)().mark((function n(){var o,r,a,s,g,v=this;return(0,ue.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u.cancel(),l.read(i),h.read(i),this._isDiffUpToDate.set(!1,void 0),a=[],t.add(e.original.onDidChangeContent((function(e){var i=ge.Q.fromModelContentChanges(e.changes);a=(0,he.o)(a,i)}))),s=[],t.add(e.modified.onDidChangeContent((function(e){var i=ge.Q.fromModelContentChanges(e.changes);s=(0,he.o)(s,i)}))),n.next=10,d.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(i),maxComputationTimeMs:this._options.maxComputationTimeMs.read(i),computeMoves:this._options.showMoves.read(i)});case 10:g=n.sent,g=null!==(o=we(g,a,e.original,e.modified))&&void 0!==o?o:g,g=null!==(r=Le(g,s,e.original,e.modified))&&void 0!==r?r:g,(0,c.PS)((function(e){f(g,e),v._lastDiff=g;var i=pe.fromDiffResult(g);v._diff.set(i,e),v._isDiffUpToDate.set(!0,e);var t=v.syncedMovedTexts.get();v.syncedMovedTexts.set(t?v._lastDiff.moves.find((function(e){return e.lineRangeMapping.modified.intersect(t.lineRangeMapping.modified)})):void 0,e)}));case 14:case"end":return n.stop()}}),n,this)})))}))),s}return(0,r.Z)(t,[{key:"ensureModifiedLineIsVisible",value:function(e,i){var t;if(0!==(null===(t=this.diff.get())||void 0===t?void 0:t.mappings.length)){var o,r=this._unchangedRegions.get().regions,a=(0,n.Z)(r);try{for(a.s();!(o=a.n()).done;){var d=o.value;if(d.getHiddenModifiedRange(void 0).contains(e))return void d.showAll(i)}}catch(s){a.e(s)}finally{a.f()}}}},{key:"ensureOriginalLineIsVisible",value:function(e,i){var t;if(0!==(null===(t=this.diff.get())||void 0===t?void 0:t.mappings.length)){var o,r=this._unchangedRegions.get().regions,a=(0,n.Z)(r);try{for(a.s();!(o=a.n()).done;){var d=o.value;if(d.getHiddenOriginalRange(void 0).contains(e))return void d.showAll(i)}}catch(s){a.e(s)}finally{a.f()}}}},{key:"waitForDiff",value:function(){return me(this,void 0,void 0,(0,ue.Z)().mark((function e(){return(0,ue.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,c.F_)(this.isDiffUpToDate,(function(e){return e}));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"serializeState",value:function(){return{collapsedRegions:this._unchangedRegions.get().regions.map((function(e){return{range:e.getHiddenModifiedRange(void 0).serialize()}}))}}},{key:"restoreSerializedState",value:function(e){var i=e.collapsedRegions.map((function(e){return ee.z.deserialize(e.range)})),t=this._unchangedRegions.get();(0,c.PS)((function(e){var o,r=(0,n.Z)(t.regions);try{for(r.s();!(o=r.n()).done;){var a,d=o.value,s=(0,n.Z)(i);try{for(s.s();!(a=s.n()).done;){var l=a.value;if(d.modifiedRange.intersect(l)){d.setHiddenModifiedRange(l,e);break}}}catch(u){s.e(u)}finally{s.f()}}}catch(u){r.e(u)}finally{r.f()}}))}}]),t}(b.JT),pe=function(){function e(i,t,n,r){(0,o.Z)(this,e),this.mappings=i,this.movedTexts=t,this.identical=n,this.quitEarly=r}return(0,r.Z)(e,null,[{key:"fromDiffResult",value:function(i){return new e(i.changes.map((function(e){return new be(e)})),i.moves||[],i.identical,i.quitEarly)}}]),e}(),be=(0,r.Z)((function e(i){(0,o.Z)(this,e),this.lineRangeMapping=i})),ye=function(){function e(i,t,n,r,a){var d=this;(0,o.Z)(this,e),this.originalLineNumber=i,this.modifiedLineNumber=t,this.lineCount=n,this._visibleLineCountTop=(0,c.uh)("visibleLineCountTop",0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=(0,c.uh)("visibleLineCountBottom",0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=(0,c.nK)("isVisible",(function(e){return d.visibleLineCountTop.read(e)+d.visibleLineCountBottom.read(e)===d.lineCount&&!d.isDragged.read(e)})),this.isDragged=(0,c.uh)("isDragged",!1),this._visibleLineCountTop.set(r,void 0),this._visibleLineCountBottom.set(a,void 0)}return(0,r.Z)(e,[{key:"originalRange",get:function(){return ee.z.ofLength(this.originalLineNumber,this.lineCount)}},{key:"modifiedRange",get:function(){return ee.z.ofLength(this.modifiedLineNumber,this.lineCount)}},{key:"shouldHideControls",value:function(e){return this._shouldHideControls.read(e)}},{key:"getHiddenOriginalRange",value:function(e){return ee.z.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}},{key:"getHiddenModifiedRange",value:function(e){return ee.z.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}},{key:"setHiddenModifiedRange",value:function(e,i){var t=e.startLineNumber-this.modifiedLineNumber,n=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(t,n,i)}},{key:"getMaxVisibleLineCountTop",value:function(){return this.lineCount-this._visibleLineCountBottom.get()}},{key:"getMaxVisibleLineCountBottom",value:function(){return this.lineCount-this._visibleLineCountTop.get()}},{key:"showMoreAbove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1?arguments[1]:void 0,t=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,t),i)}},{key:"showMoreBelow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=arguments.length>1?arguments[1]:void 0,t=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,t),i)}},{key:"showAll",value:function(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}},{key:"setState",value:function(e,i,t){e=Math.max(Math.min(e,this.lineCount),0),i=Math.max(Math.min(i,this.lineCount-e),0),this._visibleLineCountTop.set(e,t),this._visibleLineCountBottom.set(i,t)}}],[{key:"fromDiffs",value:function(i,t,o){var r,a=fe.f0.inverse(i,t,o),d=[],s=(0,n.Z)(a);try{for(s.s();!(r=s.n()).done;){var l=r.value,u=l.originalRange.startLineNumber,f=l.modifiedRange.startLineNumber,c=l.originalRange.length,g=1===u&&1===f,h=u+c===t+1&&f+c===o+1;(g||h)&&c>6?(g&&!h&&(c-=3),h&&!g&&(u+=3,f+=3,c-=3),d.push(new e(u,f,c,0,0))):c>9&&(u+=3,f+=3,c-=6,d.push(new e(u,f,c,0,0)))}}catch(v){s.e(v)}finally{s.f()}return d}}]),e}();function we(e,i,t,n){if(0===i.length)return e;var o=Le(Ee(e),i,n,t);return o?Ee(o):void 0}function Ee(e){return{changes:e.changes.map((function(e){return e.flip()})),moves:e.moves.map((function(e){return e.flip()})),identical:e.identical,quitEarly:e.quitEarly}}function Le(e,i,t,n){return 0===i.length?e:e.changes.some((function(e){return!e.innerChanges}))||e.moves.length>0?void 0:{identical:!1,quitEarly:!1,changes:Ne(e.changes,i,t,n),moves:e.moves.map((function(e){var o=function(e,i){for(var t=e.startLineNumber,n=e.endLineNumberExclusive,o=i.length-1;o>=0;o--){var r=i[o],a=(0,ve.W9)(r.startOffset)+1,d=(0,ve.W9)(r.endOffset)+1,s=(0,ve.W9)(r.newLength)-(d-a);if(d<t)t+=s,n+=s;else if(a>n);else{if(a<t&&n<d)return;a<t&&d<=n?(t=d+1,t+=s,n+=s):t<=a&&d<t?n=a:n+=s}}return new ee.z(t,n)}(e.lineRangeMapping.modified,i);return o?new fe.y0(new fe.Qy(e.lineRangeMapping.original,o),Ne(e.changes,i,t,n)):void 0})).filter(y.$K)}}function Ne(e,i,t,n){var o=e.flatMap((function(e){return e.innerChanges.map((function(e){return new ge.Q((0,ve.PZ)(e.originalRange.getStartPosition()),(0,ve.PZ)(e.originalRange.getEndPosition()),(0,ve.Uv)(e.modifiedRange).toLength())}))})),r=(0,he.o)(o,i),a=ve.xl,d=ve.xl,s=r.map((function(e){var i=(0,ve.Ii)(d,(0,ve.BE)(a,e.startOffset));return a=e.endOffset,d=(0,ve.Ii)(i,e.newLength),new fe.iy(te.e.fromPositions((0,ve.bP)(e.startOffset),(0,ve.bP)(e.endOffset)),te.e.fromPositions((0,ve.bP)(i),(0,ve.bP)(d)))}));return(0,ce.v)(s,t.getLinesContent(),n.getLinesContent())}var Ce=t(93720),Se=t(90650),De=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function a(e){try{s(n.next(e))}catch(i){r(i)}}function d(e){try{s(n.throw(e))}catch(i){r(i)}}function s(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(a,d)}s((n=n.apply(e,i||[])).next())}))},Re=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,r,d,s,u,f,c,g){var h;(0,o.Z)(this,t),(h=i.call(this))._getViewZoneId=e,h._marginDomNode=n,h._modifiedEditor=r,h._diff=d,h._editor=s,h._viewLineCounts=u,h._originalTextModel=f,h._contextMenuService=c,h._clipboardService=g,h._visibility=!1,h._marginDomNode.style.zIndex="10",h._diffActions=document.createElement("div"),h._diffActions.className=L.k.asClassName(w.l.lightBulb)+" lightbulb-glyph",h._diffActions.style.position="absolute";var v=h._modifiedEditor.getOption(65);h._diffActions.style.right="0px",h._diffActions.style.visibility="hidden",h._diffActions.style.height="".concat(v,"px"),h._diffActions.style.lineHeight="".concat(v,"px"),h._marginDomNode.appendChild(h._diffActions);var m=0,_=r.getOption(125)&&!Se.gn,p=function(e,i){var t;h._contextMenuService.showContextMenu({domForShadowRoot:_&&null!==(t=r.getDomNode())&&void 0!==t?t:void 0,getAnchor:function(){return{x:e,y:i}},getActions:function(){var e=[],i=d.modifiedRange.isEmpty;return e.push(new Ce.aU("diff.clipboard.copyDeletedContent",i?d.originalRange.length>1?(0,C.NC)("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):(0,C.NC)("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):d.originalRange.length>1?(0,C.NC)("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):(0,C.NC)("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,(function(){return De((0,a.Z)(h),void 0,void 0,(0,ue.Z)().mark((function e(){var i;return(0,ue.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._originalTextModel.getValueInRange(d.originalRange.toExclusiveRange()),e.next=3,this._clipboardService.writeText(i);case 3:case"end":return e.stop()}}),e,this)})))}))),d.originalRange.length>1&&e.push(new Ce.aU("diff.clipboard.copyDeletedLineContent",i?(0,C.NC)("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",d.originalRange.startLineNumber+m):(0,C.NC)("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",d.originalRange.startLineNumber+m),void 0,!0,(function(){return De((0,a.Z)(h),void 0,void 0,(0,ue.Z)().mark((function e(){var i,t;return(0,ue.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return""===(i=this._originalTextModel.getLineContent(d.originalRange.startLineNumber+m))&&(t=this._originalTextModel.getEndOfLineSequence(),i=0===t?"\n":"\r\n"),e.next=4,this._clipboardService.writeText(i);case 4:case"end":return e.stop()}}),e,this)})))}))),r.getOption(89)||e.push(new Ce.aU("diff.inline.revertChange",(0,C.NC)("diff.inline.revertChange.label","Revert this change"),void 0,!0,(function(){return De((0,a.Z)(h),void 0,void 0,(0,ue.Z)().mark((function e(){return(0,ue.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._editor.revert(this._diff);case 1:case"end":return e.stop()}}),e,this)})))}))),e},autoSelectFirstItem:!0})};return h._register((0,l.addStandardDisposableListener)(h._diffActions,"mousedown",(function(e){var i=(0,l.getDomNodePagePosition)(h._diffActions),t=i.top,n=i.height,o=Math.floor(v/3);e.preventDefault(),p(e.posx,t+n+o)}))),h._register(r.onMouseMove((function(e){8!==e.target.type&&5!==e.target.type||e.target.detail.viewZoneId!==h._getViewZoneId()?h.visibility=!1:(m=h._updateLightBulbPosition(h._marginDomNode,e.event.browserEvent.y,v),h.visibility=!0)}))),h._register(r.onMouseDown((function(e){e.event.rightButton&&(8!==e.target.type&&5!==e.target.type||e.target.detail.viewZoneId===h._getViewZoneId()&&(e.event.preventDefault(),m=h._updateLightBulbPosition(h._marginDomNode,e.event.browserEvent.y,v),p(e.event.posx,e.event.posy+v)))}))),h}return(0,r.Z)(t,[{key:"visibility",get:function(){return this._visibility},set:function(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}},{key:"_updateLightBulbPosition",value:function(e,i,t){var n=i-(0,l.getDomNodePagePosition)(e).top,o=Math.floor(n/t),r=o*t;if(this._diffActions.style.top="".concat(r,"px"),this._viewLineCounts)for(var a=0,d=0;d<this._viewLineCounts.length;d++)if(o<(a+=this._viewLineCounts[d]))return d;return o}}]),t}(b.JT),Ie=t(69846),xe=t(17683),Oe=t(53603),Me=t(63465),Te=t(56606),ke=t(19484),Ve=Ie.N;var Ze=(0,r.Z)((function e(i,t,n,r){(0,o.Z)(this,e),this.lineTokens=i,this.lineBreakData=t,this.mightContainNonBasicASCII=n,this.mightContainRTL=r})),We=function(){function e(i,t,n,r,a,d,s,l,u,f,c){(0,o.Z)(this,e),this.tabSize=i,this.fontInfo=t,this.disableMonospaceOptimizations=n,this.typicalHalfwidthCharacterWidth=r,this.scrollBeyondLastColumn=a,this.lineHeight=d,this.lineDecorationsWidth=s,this.stopRenderingLineAfter=l,this.renderWhitespace=u,this.renderControlCharacters=f,this.fontLigatures=c}return(0,r.Z)(e,null,[{key:"fromEditor",value:function(i){var t,n=i.getOptions(),o=n.get(49),r=n.get(142);return new e((null===(t=i.getModel())||void 0===t?void 0:t.getOptions().tabSize)||0,o,n.get(32),o.typicalHalfwidthCharacterWidth,n.get(102),n.get(65),r.decorationsWidth,n.get(115),n.get(97),n.get(92),n.get(50))}}]),e}();function Pe(e,i,t,n,o,r,a,d){d.appendString('<div class="view-line'),n||d.appendString(" char-delete"),d.appendString('" style="top:'),d.appendString(String(e*a.lineHeight)),d.appendString('px;width:1000000px;">');var s=i.getLineContent(),l=ke.wA.isBasicASCII(s,o),u=ke.wA.containsRTL(s,l,r),f=(0,Te.d1)(new Te.IJ(a.fontInfo.isMonospace&&!a.disableMonospaceOptimizations,a.fontInfo.canUseHalfwidthRightwardsArrow,s,!1,l,u,0,i,t,a.tabSize,0,a.fontInfo.spaceWidth,a.fontInfo.middotWidth,a.fontInfo.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==xe.n0.OFF,null),d);return d.appendString("</div>"),f.characterMapping.getHorizontalOffset(f.characterMapping.length)}var Ae=t(76344),He=t(92361),ze=function(e,i,t,n){var o,r=arguments.length,a=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(a=(r<3?o(a):r>3?o(i,t,a):o(i,t))||a);return r>3&&a&&Object.defineProperty(i,t,a),a},Fe=function(e,i){return function(t,n){i(t,n,e)}},Be=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,r,a,d,s,u,f){var h;(0,o.Z)(this,t),(h=i.call(this))._editors=e,h._diffModel=r,h._options=a,h._diffEditorWidget=d,h._canIgnoreViewZoneUpdateEvent=s,h._clipboardService=u,h._contextMenuService=f,h._originalTopPadding=(0,c.uh)("originalTopPadding",0),h._originalScrollOffset=(0,c.uh)("originalScrollOffset",0),h._originalScrollOffsetAnimated=K(h._originalScrollOffset,h._store),h._modifiedTopPadding=(0,c.uh)("modifiedTopPadding",0),h._modifiedScrollOffset=(0,c.uh)("modifiedScrollOffset",0),h._modifiedScrollOffsetAnimated=K(h._modifiedScrollOffset,h._store);var v=!1,m=(0,c.uh)("state",0),_=h._register(new de.pY((function(){m.set(m.get()+1,void 0)}),0));h._register(h._editors.original.onDidChangeViewZones((function(e){v||h._canIgnoreViewZoneUpdateEvent()||_.schedule()}))),h._register(h._editors.modified.onDidChangeViewZones((function(e){v||h._canIgnoreViewZoneUpdateEvent()||_.schedule()}))),h._register(h._editors.original.onDidChangeConfiguration((function(e){e.hasChanged(143)&&_.schedule()}))),h._register(h._editors.modified.onDidChangeConfiguration((function(e){e.hasChanged(143)&&_.schedule()})));var p=h._diffModel.map((function(e){return e?(0,c.rD)(e.model.original.onDidChangeTokens,(function(){return 2===e.model.original.tokenization.backgroundTokenizationState})):void 0})).map((function(e,i){return null===e||void 0===e?void 0:e.read(i)})),E=new Set,N=new Set,C=(0,c.nK)("alignments",(function(e){var i=h._diffModel.read(e),t=null===i||void 0===i?void 0:i.diff.read(e);if(!i||!t)return null;m.read(e);var n=h._options.renderSideBySide.read(e);return Ue(h._editors.original,h._editors.modified,t.mappings,E,N,n)})),S=(0,c.nK)("alignments",(function(e){var i,t=null===(i=h._diffModel.read(e))||void 0===i?void 0:i.syncedMovedTexts.read(e);if(!t)return null;m.read(e);var n=t.changes.map((function(e){return new be(e)}));return Ue(h._editors.original,h._editors.modified,n,E,N,!0)}));function D(){var e=document.createElement("div");return e.className="diagonal-fill",e}var I=h._register(new b.SL),x=(0,c.nK)("alignment viewzones",(function(e){var i,t,o,r,a,d,s,u;I.clear();var f=C.read(e)||[],c=[],g=[],v=h._modifiedTopPadding.read(e);v>0&&g.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:v,showInHiddenAreas:!0});var m=h._originalTopPadding.read(e);m>0&&c.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:m,showInHiddenAreas:!0});var _=h._options.renderSideBySide.read(e),b=_||null===(i=h._editors.modified._getViewModel())||void 0===i?void 0:i.createLineBreaksComputer();if(b){var E,N=(0,n.Z)(f);try{for(N.s();!(E=N.n()).done;){var x=E.value;if(x.diff)for(var O=x.originalRange.startLineNumber;O<x.originalRange.endLineNumberExclusive;O++)null===b||void 0===b||b.addRequest(h._editors.original.getModel().getLineContent(O),null,null)}}catch(K){N.e(K)}finally{N.f()}}var M,T=null!==(t=null===b||void 0===b?void 0:b.finalize())&&void 0!==t?t:[],k=0,V=h._editors.modified.getOption(65),W=null===(o=h._diffModel.read(e))||void 0===o?void 0:o.syncedMovedTexts.read(e),P=null!==(a=null===(r=h._editors.original.getModel())||void 0===r?void 0:r.mightContainNonBasicASCII())&&void 0!==a&&a,A=null!==(s=null===(d=h._editors.original.getModel())||void 0===d?void 0:d.mightContainRTL())&&void 0!==s&&s,H=We.fromEditor(h._editors.modified),z=(0,n.Z)(f);try{var F=function(){var i=M.value;if(i.diff&&!_){if(!i.originalRange.isEmpty){p.read(e);var t=document.createElement("div");t.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");var o,r=new Ze(i.originalRange.mapToLineArray((function(e){return h._editors.original.getModel().tokenization.getLineTokens(e)})),i.originalRange.mapToLineArray((function(e){return T[k++]})),P,A),a=[],d=(0,n.Z)(i.diff.innerChanges||[]);try{for(d.s();!(o=d.n()).done;){var s=o.value;a.push(new ke.$t(s.originalRange.delta(-(i.diff.originalRange.startLineNumber-1)),Z.className,0))}}catch(K){d.e(K)}finally{d.f()}var u=function(e,i,t,o){(0,se.N)(o,i.fontInfo);for(var r=t.length>0,a=new Oe.HT(1e4),d=0,s=0,l=[],u=0;u<e.lineTokens.length;u++){var f=u+1,c=e.lineTokens[u],g=e.lineBreakData[u],h=Me.Kp.filter(t,f,1,Number.MAX_SAFE_INTEGER);if(g){var v,m=0,_=(0,n.Z)(g.breakOffsets);try{for(_.s();!(v=_.n()).done;){var p=v.value,b=c.sliceAndInflate(m,p,0);d=Math.max(d,Pe(s,b,Me.Kp.extractWrapped(h,m,p),r,e.mightContainNonBasicASCII,e.mightContainRTL,i,a)),s++,m=p}}catch(K){_.e(K)}finally{_.f()}l.push(g.breakOffsets.length)}else l.push(1),d=Math.max(d,Pe(s,c,h,r,e.mightContainNonBasicASCII,e.mightContainRTL,i,a)),s++}d+=i.scrollBeyondLastColumn;var y=a.build(),w=Ve?Ve.createHTML(y):y;return o.innerHTML=w,{heightInLines:s,minWidthInPx:d*i.typicalHalfwidthCharacterWidth,viewLineCounts:l}}(r,H,a,t),f=document.createElement("div");if(f.className="inline-deleted-margin-view-zone",(0,se.N)(f,H.fontInfo),h._options.renderIndicators.read(e))for(var v=0;v<u.heightInLines;v++){var m=document.createElement("div");m.className="delete-sign ".concat(L.k.asClassName(R)),m.setAttribute("style","position:absolute;top:".concat(v*V,"px;width:").concat(H.lineDecorationsWidth,"px;height:").concat(V,"px;right:0;")),f.appendChild(m)}var b=void 0;I.add(new Re((function(){return(0,y.cW)(b)}),f,h._editors.modified,i.diff,h._diffEditorWidget,u.viewLineCounts,h._editors.original.getModel(),h._contextMenuService,h._clipboardService));for(var E=0;E<u.viewLineCounts.length;E++){var N=u.viewLineCounts[E];N>1&&c.push({afterLineNumber:i.originalRange.startLineNumber+E,domNode:D(),heightInPx:(N-1)*V,showInHiddenAreas:!0})}g.push({afterLineNumber:i.modifiedRange.startLineNumber-1,domNode:t,heightInPx:u.heightInLines*V,minWidthInPx:u.minWidthInPx,marginDomNode:f,setZoneId:function(e){b=e},showInHiddenAreas:!0})}var C=document.createElement("div");C.className="gutter-delete",c.push({afterLineNumber:i.originalRange.endLineNumberExclusive-1,domNode:D(),heightInPx:i.modifiedHeightInPx,marginDomNode:C,showInHiddenAreas:!0})}else{var S=i.modifiedHeightInPx-i.originalHeightInPx;if(S>0){if(null===W||void 0===W?void 0:W.lineRangeMapping.original.contains(i.originalRange.endLineNumberExclusive-1))return 0;c.push({afterLineNumber:i.originalRange.endLineNumberExclusive-1,domNode:D(),heightInPx:S,showInHiddenAreas:!0})}else{if(null===W||void 0===W?void 0:W.lineRangeMapping.modified.contains(i.modifiedRange.endLineNumberExclusive-1))return 0;var x=void 0;i.diff&&i.diff.modifiedRange.isEmpty&&h._options.shouldRenderRevertArrows.read(e)&&(x=function(){var e=document.createElement("div");return e.className="arrow-revert-change "+L.k.asClassName(w.l.arrowRight),(0,l.$)("div",{},e)}()),g.push({afterLineNumber:i.modifiedRange.endLineNumberExclusive-1,domNode:D(),heightInPx:-S,marginDomNode:x,showInHiddenAreas:!0})}}};for(z.s();!(M=z.n()).done;)F()}catch(K){z.e(K)}finally{z.f()}var B,U=(0,n.Z)(null!==(u=S.read(e))&&void 0!==u?u:[]);try{for(U.s();!(B=U.n()).done;){var j=B.value;if((null===W||void 0===W?void 0:W.lineRangeMapping.original.intersect(j.originalRange))||(null===W||void 0===W?void 0:W.lineRangeMapping.modified.intersect(j.modifiedRange))){var q=j.modifiedHeightInPx-j.originalHeightInPx;q>0?c.push({afterLineNumber:j.originalRange.endLineNumberExclusive-1,domNode:D(),heightInPx:q,showInHiddenAreas:!0}):g.push({afterLineNumber:j.modifiedRange.endLineNumberExclusive-1,domNode:D(),heightInPx:-q,showInHiddenAreas:!0})}}}catch(K){U.e(K)}finally{U.f()}return{orig:c,mod:g}}));h._register((0,g.b2)("alignment viewzones",(function(e){var i=le.Z.capture(h._editors.modified),t=x.read(e);v=!0,h._editors.original.changeViewZones((function(e){var i,o=(0,n.Z)(E);try{for(o.s();!(i=o.n()).done;){var r=i.value;e.removeZone(r)}}catch(u){o.e(u)}finally{o.f()}E.clear();var a,d=(0,n.Z)(t.orig);try{for(d.s();!(a=d.n()).done;){var s=a.value,l=e.addZone(s);s.setZoneId&&s.setZoneId(l),E.add(l)}}catch(u){d.e(u)}finally{d.f()}})),h._editors.modified.changeViewZones((function(e){var i,o=(0,n.Z)(N);try{for(o.s();!(i=o.n()).done;){var r=i.value;e.removeZone(r)}}catch(u){o.e(u)}finally{o.f()}N.clear();var a,d=(0,n.Z)(t.mod);try{for(d.s();!(a=d.n()).done;){var s=a.value,l=e.addZone(s);s.setZoneId&&s.setZoneId(l),N.add(l)}}catch(u){d.e(u)}finally{d.f()}})),v=!1,i.restore(h._editors.modified)}))),h._register((0,b.OF)((function(){h._editors.original.changeViewZones((function(e){var i,t=(0,n.Z)(E);try{for(t.s();!(i=t.n()).done;){var o=i.value;e.removeZone(o)}}catch(r){t.e(r)}finally{t.f()}E.clear()})),h._editors.modified.changeViewZones((function(e){var i,t=(0,n.Z)(N);try{for(t.s();!(i=t.n()).done;){var o=i.value;e.removeZone(o)}}catch(r){t.e(r)}finally{t.f()}N.clear()}))})));var O=!1;return h._register(h._editors.original.onDidScrollChange((function(e){e.scrollLeftChanged&&!O&&(O=!0,h._editors.modified.setScrollLeft(e.scrollLeft),O=!1)}))),h._register(h._editors.modified.onDidScrollChange((function(e){e.scrollLeftChanged&&!O&&(O=!0,h._editors.original.setScrollLeft(e.scrollLeft),O=!1)}))),h._originalScrollTop=(0,c.rD)(h._editors.original.onDidScrollChange,(function(){return h._editors.original.getScrollTop()})),h._modifiedScrollTop=(0,c.rD)(h._editors.modified.onDidScrollChange,(function(){return h._editors.modified.getScrollTop()})),h._register((0,g.EH)("update scroll modified",(function(e){var i=h._originalScrollTop.read(e)-(h._originalScrollOffsetAnimated.get()-h._modifiedScrollOffsetAnimated.read(e))-(h._originalTopPadding.get()-h._modifiedTopPadding.read(e));i!==h._editors.modified.getScrollTop()&&h._editors.modified.setScrollTop(i,1)}))),h._register((0,g.EH)("update scroll original",(function(e){var i=h._modifiedScrollTop.read(e)-(h._modifiedScrollOffsetAnimated.get()-h._originalScrollOffsetAnimated.read(e))-(h._modifiedTopPadding.get()-h._originalTopPadding.read(e));i!==h._editors.original.getScrollTop()&&h._editors.original.setScrollTop(i,1)}))),h._register((0,g.EH)("update",(function(e){var i,t=null===(i=h._diffModel.read(e))||void 0===i?void 0:i.syncedMovedTexts.read(e),n=0;if(t){var o=h._editors.original.getTopForLineNumber(t.lineRangeMapping.original.startLineNumber,!0)-h._originalTopPadding.get();n=h._editors.modified.getTopForLineNumber(t.lineRangeMapping.modified.startLineNumber,!0)-h._modifiedTopPadding.get()-o}n>0?(h._modifiedTopPadding.set(0,void 0),h._originalTopPadding.set(n,void 0)):n<0?(h._modifiedTopPadding.set(-n,void 0),h._originalTopPadding.set(0,void 0)):setTimeout((function(){h._modifiedTopPadding.set(0,void 0),h._originalTopPadding.set(0,void 0)}),400),h._editors.modified.hasTextFocus()?h._originalScrollOffset.set(h._modifiedScrollOffset.get()-n,void 0,!0):h._modifiedScrollOffset.set(h._originalScrollOffset.get()+n,void 0,!0)}))),h}return(0,r.Z)(t)}(b.JT);function Ue(e,i,t,o,r,a){var d=new ae.H9(je(e,o)),s=new ae.H9(je(i,r)),l=e.getOption(65),u=i.getOption(65),f=[],c=0,g=0;function h(e,i){for(;;){var t=d.peek(),n=s.peek();if(t&&t.lineNumber>=e&&(t=void 0),n&&n.lineNumber>=i&&(n=void 0),!t&&!n)break;var o=t?t.lineNumber-c:Number.MAX_VALUE,r=n?n.lineNumber-g:Number.MAX_VALUE;o<r?(d.dequeue(),n={lineNumber:t.lineNumber-c+g,heightInPx:0}):o>r?(s.dequeue(),t={lineNumber:n.lineNumber-g+c,heightInPx:0}):(d.dequeue(),s.dequeue()),f.push({originalRange:ee.z.ofLength(t.lineNumber,1),modifiedRange:ee.z.ofLength(n.lineNumber,1),originalHeightInPx:l+t.heightInPx,modifiedHeightInPx:u+n.heightInPx,diff:void 0})}}var v,m=(0,n.Z)(t);try{var _=function(){var i=v.value,t=i.lineRangeMapping;h(t.originalRange.startLineNumber,t.modifiedRange.startLineNumber);var o=!0,r=t.modifiedRange.startLineNumber,m=t.originalRange.startLineNumber;function _(e,t){var n,a,c,g;if(!(e<m||t<r)){if(o)o=!1;else if(e===m||t===r)return;var h=new ee.z(m,e),v=new ee.z(r,t);if(!h.isEmpty||!v.isEmpty){var _=null!==(a=null===(n=d.takeWhile((function(i){return i.lineNumber<e})))||void 0===n?void 0:n.reduce((function(e,i){return e+i.heightInPx}),0))&&void 0!==a?a:0,p=null!==(g=null===(c=s.takeWhile((function(e){return e.lineNumber<t})))||void 0===c?void 0:c.reduce((function(e,i){return e+i.heightInPx}),0))&&void 0!==g?g:0;f.push({originalRange:h,modifiedRange:v,originalHeightInPx:h.length*l+_,modifiedHeightInPx:v.length*u+p,diff:i.lineRangeMapping}),m=e,r=t}}}if(a){var p,b=(0,n.Z)(t.innerChanges||[]);try{for(b.s();!(p=b.n()).done;){var y=p.value;y.originalRange.startColumn>1&&y.modifiedRange.startColumn>1&&_(y.originalRange.startLineNumber,y.modifiedRange.startLineNumber),y.originalRange.endColumn<e.getModel().getLineMaxColumn(y.originalRange.endLineNumber)&&_(y.originalRange.endLineNumber,y.modifiedRange.endLineNumber)}}catch(w){b.e(w)}finally{b.f()}}_(t.originalRange.endLineNumberExclusive,t.modifiedRange.endLineNumberExclusive),c=t.originalRange.endLineNumberExclusive,g=t.modifiedRange.endLineNumberExclusive};for(m.s();!(v=m.n()).done;)_()}catch(p){m.e(p)}finally{m.f()}return h(Number.MAX_VALUE,Number.MAX_VALUE),f}function je(e,i){var t=[],o=[],r=-1!==e.getOption(143).wrappingColumn,a=e._getViewModel().coordinatesConverter,d=e.getOption(65);if(r)for(var s=1;s<=e.getModel().getLineCount();s++){var l=a.getModelLineViewLineCount(s);l>1&&o.push({lineNumber:s,heightInPx:d*(l-1)})}var u,f=(0,n.Z)(e.getWhitespaces());try{for(f.s();!(u=f.n()).done;){var c=u.value;if(!i.has(c.id)){var g=0===c.afterLineNumber?0:a.convertViewPositionToModelPosition(new ie.L(c.afterLineNumber,1)).lineNumber;t.push({lineNumber:g,heightInPx:c.height})}}}catch(v){f.e(v)}finally{f.f()}var h=function(e,i,t,n){if(0===e.length)return i;if(0===i.length)return e;for(var o=[],r=0,a=0;r<e.length&&a<i.length;){var d=e[r],s=i[a],l=t(d),u=t(s);l<u?(o.push(d),r++):l>u?(o.push(s),a++):(o.push(n(d,s)),r++,a++)}for(;r<e.length;)o.push(e[r]),r++;for(;a<i.length;)o.push(i[a]),a++;return o}(t,o,(function(e){return e.lineNumber}),(function(e,i){return{lineNumber:e.lineNumber,heightInPx:e.heightInPx+i.heightInPx}}));return h}Be=ze([Fe(5,Ae.p),Fe(6,He.i)],Be);var qe=t(65379),Ke=t(60038),Ge=t(92578),$e=t(43980),Je=t(41335),Xe=function(e,i,t,n){var o,r=arguments.length,a=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(a=(r<3?o(a):r>3?o(i,t,a):o(i,t))||a);return r>3&&a&&Object.defineProperty(i,t,a),a},Ye=function(e,i){return function(t,n){i(t,n,e)}},Qe=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,r,a,d,s,u,f){var h;(0,o.Z)(this,t),(h=i.call(this))._editors=e,h._rootElement=n,h._diffModel=r,h._rootWidth=a,h._rootHeight=d,h._modifiedEditorLayoutInfo=s,h._options=u,h._themeService=f;var v=(0,c.rD)(h._themeService.onDidColorThemeChange,(function(){return h._themeService.getColorTheme()})),m=(0,c.nK)("colors",(function(e){var i=v.read(e);return{insertColor:i.getColor($e.P6Y)||(i.getColor($e.ypS)||$e.CzK).transparent(2),removeColor:i.getColor($e.F9q)||(i.getColor($e.P4M)||$e.keg).transparent(2)}})),_=(0,c.rD)(h._editors.modified.onDidScrollChange,(function(){return h._editors.modified.getScrollTop()})),p=(0,c.rD)(h._editors.modified.onDidScrollChange,(function(){return h._editors.modified.getScrollHeight()}));return h._register((0,g.b2)("create diff editor overview ruler if enabled",(function(e,i){if(h._options.renderOverviewRuler.read(e)){var n=(0,qe.X)(document.createElement("div"));n.setClassName("diffViewport"),n.setPosition("absolute");var o=(0,l.h)("div.diffOverview",{style:{position:"absolute",top:"0px",width:t.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;i.add(j(o,n.domNode)),i.add((0,l.addStandardDisposableListener)(o,l.EventType.POINTER_DOWN,(function(e){h._editors.modified.delegateVerticalScrollbarPointerDown(e)}))),i.add((0,l.addDisposableListener)(o,l.EventType.MOUSE_WHEEL,(function(e){h._editors.modified.delegateScrollFromMouseWheelEvent(e)}),{passive:!1})),i.add(j(h._rootElement,o)),i.add((0,g.b2)("recreate overview rules when model changes",(function(e,i){var r=h._diffModel.read(e),a=h._editors.original.createOverviewRuler("original diffOverviewRuler");a&&(i.add(a),i.add(j(o,a.getDomNode())));var d=h._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(d&&(i.add(d),i.add(j(o,d.getDomNode()))),a&&d){var s=(0,c.aq)("viewZoneChanged",h._editors.original.onDidChangeViewZones),l=(0,c.aq)("viewZoneChanged",h._editors.modified.onDidChangeViewZones),u=(0,c.aq)("hiddenRangesChanged",h._editors.original.onDidChangeHiddenAreas),f=(0,c.aq)("hiddenRangesChanged",h._editors.modified.onDidChangeHiddenAreas);i.add((0,c.EH)("set overview ruler zones",(function(e){var i;s.read(e),l.read(e),u.read(e),f.read(e);var t=m.read(e),n=null===(i=null===r||void 0===r?void 0:r.diff.read(e))||void 0===i?void 0:i.mappings;function o(e,i,t){var n=t._getViewModel();return n?e.filter((function(e){return e.length>0})).map((function(e){var t=n.coordinatesConverter.convertModelPositionToViewPosition(new ie.L(e.startLineNumber,1)),o=n.coordinatesConverter.convertModelPositionToViewPosition(new ie.L(e.endLineNumberExclusive,1));return new Ge.EY(t.lineNumber,o.lineNumber,0,i.toString())})):[]}null===a||void 0===a||a.setZones(o((n||[]).map((function(e){return e.lineRangeMapping.originalRange})),t.removeColor,h._editors.original)),null===d||void 0===d||d.setZones(o((n||[]).map((function(e){return e.lineRangeMapping.modifiedRange})),t.insertColor,h._editors.modified))}))),i.add((0,c.EH)("layout overview ruler",(function(e){var i=h._rootHeight.read(e),r=h._rootWidth.read(e),s=h._modifiedEditorLayoutInfo.read(e);if(s){var l=t.ENTIRE_DIFF_OVERVIEW_WIDTH-2*t.ONE_OVERVIEW_WIDTH;a.setLayout({top:0,height:i,right:l+t.ONE_OVERVIEW_WIDTH,width:t.ONE_OVERVIEW_WIDTH}),d.setLayout({top:0,height:i,right:0,width:t.ONE_OVERVIEW_WIDTH});var u=_.read(e),f=p.read(e),c=h._editors.modified.getOption(101),g=new Ke.M(c.verticalHasArrows?c.arrowSize:0,c.verticalScrollbarSize,0,s.height,f,u);n.setTop(g.getSliderPosition()),n.setHeight(g.getSliderSize())}else n.setTop(0),n.setHeight(0);o.style.height=i+"px",o.style.left=r-t.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",n.setWidth(t.ENTIRE_DIFF_OVERVIEW_WIDTH)})))}})))}}))),h}return(0,r.Z)(t)}(b.JT);Qe.ONE_OVERVIEW_WIDTH=15,Qe.ENTIRE_DIFF_OVERVIEW_WIDTH=2*Qe.ONE_OVERVIEW_WIDTH,Qe=Xe([Ye(7,Je.XE)],Qe);var ei=t(26805),ii=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,r,a){var d;(0,o.Z)(this,t),(d=i.call(this))._editors=e,d._diffModel=r,d._options=a,d._isUpdatingViewZones=!1,d._register(d._editors.original.onDidChangeCursorPosition((function(e){if(3===e.reason){var i=d._diffModel.get();(0,c.PS)((function(e){var t,o=(0,n.Z)(d._editors.original.getSelections()||[]);try{for(o.s();!(t=o.n()).done;){var r=t.value;null===i||void 0===i||i.ensureOriginalLineIsVisible(r.getStartPosition().lineNumber,e),null===i||void 0===i||i.ensureOriginalLineIsVisible(r.getEndPosition().lineNumber,e)}}catch(a){o.e(a)}finally{o.f()}}))}}))),d._register(d._editors.modified.onDidChangeCursorPosition((function(e){if(3===e.reason){var i=d._diffModel.get();(0,c.PS)((function(e){var t,o=(0,n.Z)(d._editors.modified.getSelections()||[]);try{for(o.s();!(t=o.n()).done;){var r=t.value;null===i||void 0===i||i.ensureModifiedLineIsVisible(r.getStartPosition().lineNumber,e),null===i||void 0===i||i.ensureModifiedLineIsVisible(r.getEndPosition().lineNumber,e)}}catch(a){o.e(a)}finally{o.f()}}))}})));var s=d._diffModel.map((function(e,i){var t,n;return 0===(null===(t=null===e||void 0===e?void 0:e.diff.read(i))||void 0===t?void 0:t.mappings.length)?[]:null!==(n=null===e||void 0===e?void 0:e.unchangedRegions.read(i))&&void 0!==n?n:[]})),l=(0,v.Be)("view zones",(function(e,i){var t,o=[],r=[],a=d._options.renderSideBySide.read(e),l=s.read(e),u=(0,n.Z)(l);try{var f=function(){var n=t.value;if(n.shouldHideControls(e))return 1;var s=(0,v.nK)("hiddenOriginalRangeStart",(function(e){return n.getHiddenOriginalRange(e).startLineNumber-1})),l=new $(s,24);o.push(l),i.add(new ti(d._editors.original,l,n,!a));var u=(0,v.nK)("hiddenModifiedRangeStart",(function(e){return n.getHiddenModifiedRange(e).startLineNumber-1})),f=new $(u,24);r.push(f),i.add(new ti(d._editors.modified,f,n,!1))};for(u.s();!(t=u.n()).done;)f()}catch(c){u.e(c)}finally{u.f()}return{origViewZones:o,modViewZones:r}})),u={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},f={description:"Fold Unchanged",glyphMarginHoverMessage:new E.W5(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown((0,C.NC)("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+L.k.asClassName(w.l.fold),zIndex:10001};return d._register(U(d._editors.original,(0,v.nK)("decorations",(function(e){var i,t=s.read(e),o=t.map((function(e){return{range:e.originalRange.toInclusiveRange(),options:u}})),r=(0,n.Z)(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;a.shouldHideControls(e)&&o.push({range:te.e.fromPositions(new ie.L(a.originalLineNumber,1)),options:f})}}catch(d){r.e(d)}finally{r.f()}return o})))),d._register(U(d._editors.modified,(0,v.nK)("decorations",(function(e){var i,t=s.read(e),o=t.map((function(e){return{range:e.modifiedRange.toInclusiveRange(),options:u}})),r=(0,n.Z)(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;a.shouldHideControls(e)&&o.push({range:ee.z.ofLength(a.modifiedLineNumber,1).toInclusiveRange(),options:f})}}catch(d){r.e(d)}finally{r.f()}return o})))),d._register(Q(d._editors.original,l.map((function(e){return e.origViewZones})),(function(e){return d._isUpdatingViewZones=e}))),d._register(Q(d._editors.modified,l.map((function(e){return e.modViewZones})),(function(e){return d._isUpdatingViewZones=e}))),d._register((0,g.b2)("update folded unchanged regions",(function(e,i){var t=s.read(e);d._editors.original.setHiddenAreas(t.map((function(i){return i.getHiddenOriginalRange(e).toInclusiveRange()})).filter(y.$K)),d._editors.modified.setHiddenAreas(t.map((function(i){return i.getHiddenModifiedRange(e).toInclusiveRange()})).filter(y.$K))}))),d._register(d._editors.modified.onMouseUp((function(e){var i;if(!e.event.rightButton&&e.target.position&&(null===(i=e.target.element)||void 0===i?void 0:i.className.includes("fold-unchanged"))){var t=e.target.position.lineNumber,n=d._diffModel.get();if(!n)return;var o=n.unchangedRegions.get().find((function(e){return e.modifiedRange.includes(t)}));if(!o)return;o.setState(0,0,void 0),e.event.stopPropagation(),e.event.preventDefault()}}))),d._register(d._editors.original.onMouseUp((function(e){var i;if(!e.event.rightButton&&e.target.position&&(null===(i=e.target.element)||void 0===i?void 0:i.className.includes("fold-unchanged"))){var t=e.target.position.lineNumber,n=d._diffModel.get();if(!n)return;var o=n.unchangedRegions.get().find((function(e){return e.originalRange.includes(t)}));if(!o)return;o.setState(0,0,void 0),e.event.stopPropagation(),e.event.preventDefault()}}))),d}return(0,r.Z)(t,[{key:"isUpdatingViewZones",get:function(){return this._isUpdatingViewZones}}]),t}(b.JT),ti=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,r,a){var d;(0,o.Z)(this,t);var s=(0,l.h)("div.diff-hidden-lines-widget");(d=i.call(this,e,n,s.root))._editor=e,d._unchangedRegion=r,d.hide=a,d._nodes=(0,l.h)("div.diff-hidden-lines",[(0,l.h)("div.top@top",{title:"Click or drag to show more above"}),(0,l.h)("div.center@content",{style:{display:"flex"}},[(0,l.h)("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center"}},[l.$.apply(void 0,["a",{title:"Show all",role:"button",onclick:function(){d._unchangedRegion.showAll(void 0)}}].concat((0,z.Z)((0,ei.T)("$(unfold)"))))]),(0,l.h)("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),(0,l.h)("div.bottom@bottom",{title:"Click or drag to show more below",role:"button"})]),s.root.appendChild(d._nodes.root);var u=(0,c.rD)(d._editor.onDidLayoutChange,(function(){return d._editor.getLayoutInfo()}));d.hide?(0,l.reset)(d._nodes.first):d._register(X(d._nodes.first,{width:u.map((function(e){return e.contentLeft}))}));var f=d._editor;return d._register((0,l.addDisposableListener)(d._nodes.top,"mousedown",(function(e){if(0===e.button){d._nodes.top.classList.toggle("dragging",!0),d._nodes.root.classList.toggle("dragging",!0),e.preventDefault();var i=e.clientY,t=!1,n=d._unchangedRegion.visibleLineCountTop.get();d._unchangedRegion.isDragged.set(!0,void 0);var o=(0,l.addDisposableListener)(window,"mousemove",(function(e){var o=e.clientY-i;t=t||Math.abs(o)>2;var r=Math.round(o/f.getOption(65)),a=Math.max(0,Math.min(n+r,d._unchangedRegion.getMaxVisibleLineCountTop()));d._unchangedRegion.visibleLineCountTop.set(a,void 0)})),r=(0,l.addDisposableListener)(window,"mouseup",(function(e){t||d._unchangedRegion.showMoreAbove(20,void 0),d._nodes.top.classList.toggle("dragging",!1),d._nodes.root.classList.toggle("dragging",!1),d._unchangedRegion.isDragged.set(!1,void 0),o.dispose(),r.dispose()}))}}))),d._register((0,l.addDisposableListener)(d._nodes.bottom,"mousedown",(function(e){if(0===e.button){d._nodes.bottom.classList.toggle("dragging",!0),d._nodes.root.classList.toggle("dragging",!0),e.preventDefault();var i=e.clientY,t=!1,n=d._unchangedRegion.visibleLineCountBottom.get();d._unchangedRegion.isDragged.set(!0,void 0);var o=(0,l.addDisposableListener)(window,"mousemove",(function(e){var o=e.clientY-i;t=t||Math.abs(o)>2;var r=Math.round(o/f.getOption(65)),a=Math.max(0,Math.min(n-r,d._unchangedRegion.getMaxVisibleLineCountBottom())),s=f.getTopForLineNumber(d._unchangedRegion.originalRange.endLineNumberExclusive);d._unchangedRegion.visibleLineCountBottom.set(a,void 0);var l=f.getTopForLineNumber(d._unchangedRegion.originalRange.endLineNumberExclusive);f.setScrollTop(f.getScrollTop()+(l-s))})),r=(0,l.addDisposableListener)(window,"mouseup",(function(e){if(d._unchangedRegion.isDragged.set(!1,void 0),!t){var i=f.getTopForLineNumber(d._unchangedRegion.originalRange.endLineNumberExclusive);d._unchangedRegion.showMoreBelow(20,void 0);var n=f.getTopForLineNumber(d._unchangedRegion.originalRange.endLineNumberExclusive);f.setScrollTop(f.getScrollTop()+(n-i))}d._nodes.bottom.classList.toggle("dragging",!1),d._nodes.root.classList.toggle("dragging",!1),o.dispose(),r.dispose()}))}}))),d._register((0,g.EH)("update labels",(function(e){var i=[];if(!d.hide){var t=r.getHiddenModifiedRange(e).length,n="".concat(t," Hidden Lines");i.push((0,l.$)("span",{title:n},n))}l.reset.apply(void 0,[d._nodes.others].concat(i))}))),d}return(0,r.Z)(t)}(G),ni=t(8422),oi=t(43886),ri=t(98926),ai=t(8022),di=t(64606),si=t(26746),li=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(){var e;return(0,o.Z)(this,t),(e=i.apply(this,arguments))._id=++t.idCounter,e._onDidDispose=e._register(new f.Q5),e.onDidDispose=e._onDidDispose.event,e}return(0,r.Z)(t,[{key:"getId",value:function(){return this.getEditorType()+":v2:"+this._id}},{key:"getVisibleColumnFromPosition",value:function(e){return this._targetEditor.getVisibleColumnFromPosition(e)}},{key:"getPosition",value:function(){return this._targetEditor.getPosition()}},{key:"setPosition",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this._targetEditor.setPosition(e,i)}},{key:"revealLine",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealLine(e,i)}},{key:"revealLineInCenter",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealLineInCenter(e,i)}},{key:"revealLineInCenterIfOutsideViewport",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealLineInCenterIfOutsideViewport(e,i)}},{key:"revealLineNearTop",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealLineNearTop(e,i)}},{key:"revealPosition",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealPosition(e,i)}},{key:"revealPositionInCenter",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealPositionInCenter(e,i)}},{key:"revealPositionInCenterIfOutsideViewport",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealPositionInCenterIfOutsideViewport(e,i)}},{key:"revealPositionNearTop",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealPositionNearTop(e,i)}},{key:"getSelection",value:function(){return this._targetEditor.getSelection()}},{key:"getSelections",value:function(){return this._targetEditor.getSelections()}},{key:"setSelection",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this._targetEditor.setSelection(e,i)}},{key:"setSelections",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this._targetEditor.setSelections(e,i)}},{key:"revealLines",value:function(e,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._targetEditor.revealLines(e,i,t)}},{key:"revealLinesInCenter",value:function(e,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._targetEditor.revealLinesInCenter(e,i,t)}},{key:"revealLinesInCenterIfOutsideViewport",value:function(e,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._targetEditor.revealLinesInCenterIfOutsideViewport(e,i,t)}},{key:"revealLinesNearTop",value:function(e,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this._targetEditor.revealLinesNearTop(e,i,t)}},{key:"revealRange",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this._targetEditor.revealRange(e,i,t,n)}},{key:"revealRangeInCenter",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealRangeInCenter(e,i)}},{key:"revealRangeInCenterIfOutsideViewport",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealRangeInCenterIfOutsideViewport(e,i)}},{key:"revealRangeNearTop",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealRangeNearTop(e,i)}},{key:"revealRangeNearTopIfOutsideViewport",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealRangeNearTopIfOutsideViewport(e,i)}},{key:"revealRangeAtTop",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._targetEditor.revealRangeAtTop(e,i)}},{key:"getSupportedActions",value:function(){return this._targetEditor.getSupportedActions()}},{key:"focus",value:function(){this._targetEditor.focus()}},{key:"trigger",value:function(e,i,t){this._targetEditor.trigger(e,i,t)}},{key:"createDecorationsCollection",value:function(e){return this._targetEditor.createDecorationsCollection(e)}},{key:"changeDecorations",value:function(e){return this._targetEditor.changeDecorations(e)}}]),t}(b.JT);li.idCounter=0;var ui=t(75256),fi=function(e,i,t,n){var o,r=arguments.length,a=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(a=(r<3?o(a):r>3?o(i,t,a):o(i,t))||a);return r>3&&a&&Object.defineProperty(i,t,a),a},ci=function(e,i){return function(t,n){i(t,n,e)}},gi=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,r,a,d,s,l){var u;return(0,o.Z)(this,t),(u=i.call(this)).originalEditorElement=e,u.modifiedEditorElement=n,u._options=r,u._createInnerEditor=d,u._instantiationService=s,u._keybindingService=l,u._onDidContentSizeChange=u._register(new f.Q5),u.original=u._createLeftHandSideEditor(r.editorOptions.get(),a.originalEditor||{}),u.modified=u._createRightHandSideEditor(r.editorOptions.get(),a.modifiedEditor||{}),u._register((0,g.nJ)("update editor options",{createEmptyChangeSummary:function(){return{}},handleChange:function(e,i){return e.didChange(r.editorOptions)&&Object.assign(i,e.change.changedOptions),!0}},(function(e,i){r.editorOptions.read(e),u.modified.updateOptions(u._adjustOptionsForRightHandSide(e,i)),u.original.updateOptions(u._adjustOptionsForLeftHandSide(e,i))}))),u}return(0,r.Z)(t,[{key:"_createLeftHandSideEditor",value:function(e,i){var t=this._adjustOptionsForLeftHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,t,i);return n.setContextValue("isInDiffLeftEditor",!0),n}},{key:"_createRightHandSideEditor",value:function(e,i){var t=this._adjustOptionsForRightHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,t,i);return n.setContextValue("isInDiffRightEditor",!0),n}},{key:"_constructInnerEditor",value:function(e,i,t,n){var o=this,r=this._createInnerEditor(e,i,t,n);return this._register(r.onDidContentSizeChange((function(e){var i=o.original.getContentWidth()+o.modified.getContentWidth()+Qe.ENTIRE_DIFF_OVERVIEW_WIDTH,t=Math.max(o.modified.getContentHeight(),o.original.getContentHeight());o._onDidContentSizeChange.fire({contentHeight:t,contentWidth:i,contentHeightChanged:e.contentHeightChanged,contentWidthChanged:e.contentWidthChanged})}))),r}},{key:"_adjustOptionsForLeftHandSide",value:function(e,i){var t=this._adjustOptionsForSubEditor(i);return this._options.renderSideBySide.get()?t.wordWrapOverride1=this._options.diffWordWrap.get():(t.wordWrapOverride1="off",t.wordWrapOverride2="off",t.stickyScroll={enabled:!1}),i.originalAriaLabel&&(t.ariaLabel=i.originalAriaLabel),t.ariaLabel=this._updateAriaLabel(t.ariaLabel),t.readOnly=!this._options.originalEditable.get(),t.dropIntoEditor={enabled:!t.readOnly},t.extraEditorClassName="original-in-monaco-diff-editor",t}},{key:"_adjustOptionsForRightHandSide",value:function(e,i){var t=this._adjustOptionsForSubEditor(i);return i.modifiedAriaLabel&&(t.ariaLabel=i.modifiedAriaLabel),t.ariaLabel=this._updateAriaLabel(t.ariaLabel),t.wordWrapOverride1=this._options.diffWordWrap.get(),t.revealHorizontalRightPadding=xe.BH.revealHorizontalRightPadding.defaultValue+Qe.ENTIRE_DIFF_OVERVIEW_WIDTH,t.scrollbar.verticalHasArrows=!1,t.extraEditorClassName="modified-in-monaco-diff-editor",t}},{key:"_adjustOptionsForSubEditor",value:function(e){var i=Object.assign(Object.assign({},e),{dimension:{height:0,width:0}});return i.inDiffEditor=!0,i.automaticLayout=!1,i.scrollbar=Object.assign({},i.scrollbar||{}),i.scrollbar.vertical="visible",i.folding=!1,i.codeLens=this._options.diffCodeLens.get(),i.fixedOverflowWidgets=!0,i.minimap=Object.assign({},i.minimap||{}),i.minimap.enabled=!1,this._options.collapseUnchangedRegions.get()?i.stickyScroll={enabled:!1}:i.stickyScroll=this._options.editorOptions.get().stickyScroll,i}},{key:"_updateAriaLabel",value:function(e){var i;e||(e="");var t=(0,C.NC)("diff-aria-navigation-tip"," use {0} to open the accessibility help.",null===(i=this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp"))||void 0===i?void 0:i.getAriaLabel());return this._options.accessibilityVerbose.get()?e+t:e?e.replaceAll(t,""):""}}]),t}(b.JT);gi=fi([ci(5,di.TG),ci(6,ui.d)],gi);var hi=function(){function e(i){var t=this;(0,o.Z)(this,e),this.renderOverviewRuler=(0,c.nK)("renderOverviewRuler",(function(e){return t._options.read(e).renderOverviewRuler})),this.renderSideBySide=(0,c.nK)("renderSideBySide",(function(e){return t._options.read(e).renderSideBySide})),this.readOnly=(0,c.nK)("readOnly",(function(e){return t._options.read(e).readOnly})),this.shouldRenderRevertArrows=(0,c.nK)("shouldRenderRevertArrows",(function(e){return!!t._options.read(e).renderMarginRevertIcon&&(!!t.renderSideBySide.read(e)&&!t.readOnly.read(e))})),this.renderIndicators=(0,c.nK)("renderIndicators",(function(e){return t._options.read(e).renderIndicators})),this.enableSplitViewResizing=(0,c.nK)("enableSplitViewResizing",(function(e){return t._options.read(e).enableSplitViewResizing})),this.collapseUnchangedRegions=(0,c.nK)("hideUnchangedRegions",(function(e){return t._options.read(e).experimental.collapseUnchangedRegions})),this.splitViewDefaultRatio=(0,c.nK)("splitViewDefaultRatio",(function(e){return t._options.read(e).splitViewDefaultRatio})),this.ignoreTrimWhitespace=(0,c.nK)("ignoreTrimWhitespace",(function(e){return t._options.read(e).ignoreTrimWhitespace})),this.maxComputationTimeMs=(0,c.nK)("maxComputationTime",(function(e){return t._options.read(e).maxComputationTime})),this.showMoves=(0,c.nK)("showMoves",(function(e){var i=t._options.read(e);return i.experimental.showMoves&&i.renderSideBySide})),this.isInEmbeddedEditor=(0,c.nK)("isInEmbeddedEditor",(function(e){return t._options.read(e).isInEmbeddedEditor})),this.diffWordWrap=(0,c.nK)("diffWordWrap",(function(e){return t._options.read(e).diffWordWrap})),this.originalEditable=(0,c.nK)("originalEditable",(function(e){return t._options.read(e).originalEditable})),this.diffCodeLens=(0,c.nK)("diffCodeLens",(function(e){return t._options.read(e).diffCodeLens})),this.accessibilityVerbose=(0,c.nK)("accessibilityVerbose",(function(e){return t._options.read(e).accessibilityVerbose})),this.diffAlgorithm=(0,c.nK)("diffAlgorithm",(function(e){return t._options.read(e).diffAlgorithm})),this.showEmptyDecorations=(0,c.nK)("showEmptyDecorations",(function(e){return t._options.read(e).experimental.showEmptyDecorations})),this.onlyShowAccessibleDiffViewer=(0,c.nK)("onlyShowAccessibleDiffViewer",(function(e){return t._options.read(e).onlyShowAccessibleDiffViewer}));var n=Object.assign(Object.assign({},i),mi(i,vi));this._options=(0,c.uh)("options",n)}return(0,r.Z)(e,[{key:"editorOptions",get:function(){return this._options}},{key:"updateOptions",value:function(e){var i=mi(e,this._options.get()),t=Object.assign(Object.assign(Object.assign({},this._options.get()),e),i);this._options.set(t,void 0,{changedOptions:e})}}]),e}(),vi={enableSplitViewResizing:!0,splitViewDefaultRatio:.5,renderSideBySide:!0,renderMarginRevertIcon:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{collapseUnchangedRegions:!1,showMoves:!1,showEmptyDecorations:!0},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1};function mi(e,i){var t,n,o;return{enableSplitViewResizing:(0,xe.O7)(e.enableSplitViewResizing,i.enableSplitViewResizing),splitViewDefaultRatio:(0,xe.L_)(e.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:(0,xe.O7)(e.renderSideBySide,i.renderSideBySide),renderMarginRevertIcon:(0,xe.O7)(e.renderMarginRevertIcon,i.renderMarginRevertIcon),maxComputationTime:(0,xe.Zc)(e.maxComputationTime,i.maxComputationTime,0,1073741824),maxFileSize:(0,xe.Zc)(e.maxFileSize,i.maxFileSize,0,1073741824),ignoreTrimWhitespace:(0,xe.O7)(e.ignoreTrimWhitespace,i.ignoreTrimWhitespace),renderIndicators:(0,xe.O7)(e.renderIndicators,i.renderIndicators),originalEditable:(0,xe.O7)(e.originalEditable,i.originalEditable),diffCodeLens:(0,xe.O7)(e.diffCodeLens,i.diffCodeLens),renderOverviewRuler:(0,xe.O7)(e.renderOverviewRuler,i.renderOverviewRuler),diffWordWrap:(0,xe.NY)(e.diffWordWrap,i.diffWordWrap,["off","on","inherit"]),diffAlgorithm:(0,xe.NY)(e.diffAlgorithm,i.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:(0,xe.O7)(e.accessibilityVerbose,i.accessibilityVerbose),experimental:{collapseUnchangedRegions:(0,xe.O7)(null===(t=e.experimental)||void 0===t?void 0:t.collapseUnchangedRegions,i.experimental.collapseUnchangedRegions),showMoves:(0,xe.O7)(null===(n=e.experimental)||void 0===n?void 0:n.showMoves,i.experimental.showMoves),showEmptyDecorations:(0,xe.O7)(null===(o=e.experimental)||void 0===o?void 0:o.showEmptyDecorations,i.experimental.showEmptyDecorations)},isInEmbeddedEditor:(0,xe.O7)(e.isInEmbeddedEditor,i.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:(0,xe.O7)(e.onlyShowAccessibleDiffViewer,i.onlyShowAccessibleDiffViewer)}}var _i=t(65171),pi=t(84337),bi=t(99857),yi=t(58188),wi=t(51373),Ei=t(93574),Li=(0,ue.Z)().mark(Hi),Ni=function(e,i,t,n){var o,r=arguments.length,a=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(a=(r<3?o(a):r>3?o(i,t,a):o(i,t))||a);return r>3&&a&&Object.defineProperty(i,t,a),a},Ci=function(e,i){return function(t,n){i(t,n,e)}},Si=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function a(e){try{s(n.next(e))}catch(i){r(i)}}function d(e){try{s(n.throw(e))}catch(i){r(i)}}function s(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(a,d)}s((n=n.apply(e,i||[])).next())}))},Di=(0,S.q5)("diff-review-insert",w.l.add,(0,C.NC)("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),Ri=(0,S.q5)("diff-review-remove",w.l.remove,(0,C.NC)("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),Ii=(0,S.q5)("diff-review-close",w.l.close,(0,C.NC)("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer.")),xi=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,r,a,d,s,l,u,f){var g;return(0,o.Z)(this,t),(g=i.call(this))._parentNode=e,g._visible=n,g._setVisible=r,g._canClose=a,g._width=d,g._height=s,g._diffs=l,g._editors=u,g._instantiationService=f,g.model=(0,v.Be)("model",(function(e,i){var t=g._visible.read(e);if(g._parentNode.style.visibility=t?"visible":"hidden",!t)return null;var n=i.add(g._instantiationService.createInstance(Oi,g._diffs,g._editors,g._setVisible,g._canClose));return{model:n,view:i.add(g._instantiationService.createInstance(Ai,g._parentNode,n,g._width,g._height,g._editors))}})),g._register((0,c.$g)(g.model,!0)),g}return(0,r.Z)(t,[{key:"next",value:function(){var e=this;(0,c.PS)((function(i){var t=e._visible.get();e._setVisible(!0,i),t&&e.model.get().model.nextGroup(i)}))}},{key:"prev",value:function(){var e=this;(0,c.PS)((function(i){e._setVisible(!0,i),e.model.get().model.previousGroup(i)}))}},{key:"close",value:function(){var e=this;(0,c.PS)((function(i){e._setVisible(!1,i)}))}}]),t}(b.JT);xi=Ni([Ci(8,di.TG)],xi);var Oi=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,r,a,d,s){var l;return(0,o.Z)(this,t),(l=i.call(this))._diffs=e,l._editors=r,l._setVisible=a,l.canClose=d,l._audioCueService=s,l._groups=(0,c.uh)("groups",[]),l._currentGroupIdx=(0,c.uh)("currentGroupIdx",0),l._currentElementIdx=(0,c.uh)("currentElementIdx",0),l.groups=l._groups,l.currentGroup=l._currentGroupIdx.map((function(e,i){return l._groups.read(i)[e]})),l.currentGroupIndex=l._currentGroupIdx,l.currentElement=l._currentElementIdx.map((function(e,i){var t;return null===(t=l.currentGroup.read(i))||void 0===t?void 0:t.lines[e]})),l._register((0,c.EH)("update groups",(function(e){var i=l._diffs.read(e);if(i){var t=function(e,i,t){var o,r=[],a=(0,n.Z)(Hi(e,(function(e,i){return i.modifiedRange.startLineNumber-e.modifiedRange.endLineNumberExclusive<2*Ti})));try{var d=function(){var e=o.value,a=[];a.push(new Vi);var d=new ee.z(Math.max(1,e[0].originalRange.startLineNumber-Ti),Math.min(e[e.length-1].originalRange.endLineNumberExclusive+Ti,i+1)),s=new ee.z(Math.max(1,e[0].modifiedRange.startLineNumber-Ti),Math.min(e[e.length-1].modifiedRange.endLineNumberExclusive+Ti,t+1));!function(e,i){var t,o,r=(0,n.Z)(e);try{for(r.s();!(o=r.n()).done;){var a=o.value;i(t,a),t=a}}catch(d){r.e(d)}finally{r.f()}i(t,void 0)}(e,(function(e,i){var t=new ee.z(e?e.originalRange.endLineNumberExclusive:d.startLineNumber,i?i.originalRange.startLineNumber:d.endLineNumberExclusive),n=new ee.z(e?e.modifiedRange.endLineNumberExclusive:s.startLineNumber,i?i.modifiedRange.startLineNumber:s.endLineNumberExclusive);t.forEach((function(e){a.push(new Pi(e,n.startLineNumber+(e-t.startLineNumber)))})),i&&(i.originalRange.forEach((function(e){a.push(new Zi(i,e))})),i.modifiedRange.forEach((function(e){a.push(new Wi(i,e))})))}));var l=e[0].modifiedRange.join(e[e.length-1].modifiedRange),u=e[0].originalRange.join(e[e.length-1].originalRange);r.push(new ki(new fe.Qy(l,u),a))};for(a.s();!(o=a.n()).done;)d()}catch(s){a.e(s)}finally{a.f()}return r}(i,l._editors.original.getModel().getLineCount(),l._editors.modified.getModel().getLineCount());(0,c.PS)((function(e){var i=l._editors.modified.getPosition();if(i){var n=t.findIndex((function(e){return(null===i||void 0===i?void 0:i.lineNumber)<e.range.modified.endLineNumberExclusive}));-1!==n&&l._currentGroupIdx.set(n,e)}l._groups.set(t,e)}))}else l._groups.set([],void 0)}))),l._register((0,c.EH)("play audio-cue for diff",(function(e){var i=l.currentElement.read(e);(null===i||void 0===i?void 0:i.type)===Mi.Deleted?l._audioCueService.playAudioCue(Ei.y$.diffLineDeleted):(null===i||void 0===i?void 0:i.type)===Mi.Added&&l._audioCueService.playAudioCue(Ei.y$.diffLineInserted)}))),l._register((0,c.EH)("select lines in editor",(function(e){var i,t=l.currentElement.read(e);if(t&&t.type!==Mi.Header){var n=null!==(i=t.modifiedLineNumber)&&void 0!==i?i:t.diff.modifiedRange.startLineNumber;l._editors.modified.setSelection(te.e.fromPositions(new ie.L(n,1)))}}))),l}return(0,r.Z)(t,[{key:"_goToGroupDelta",value:function(e,i){var t=this,n=this.groups.get();!n||n.length<=1||(0,h.c8)(i,(function(i){t._currentGroupIdx.set((t._currentGroupIdx.get()+n.length+e)%n.length,i),t._currentElementIdx.set(0,i)}))}},{key:"nextGroup",value:function(e){this._goToGroupDelta(1,e)}},{key:"previousGroup",value:function(e){this._goToGroupDelta(-1,e)}},{key:"_goToLineDelta",value:function(e){var i=this,t=this.currentGroup.get();!t||t.lines.length<=1||(0,c.PS)((function(n){i._currentElementIdx.set((i._currentElementIdx.get()+t.lines.length+e)%t.lines.length,n)}))}},{key:"goToNextLine",value:function(){this._goToLineDelta(1)}},{key:"goToPreviousLine",value:function(){this._goToLineDelta(-1)}},{key:"goToLine",value:function(e){var i=this,t=this.currentGroup.get();if(t){var n=t.lines.indexOf(e);-1!==n&&(0,c.PS)((function(e){i._currentElementIdx.set(n,e)}))}}},{key:"revealCurrentElementInEditor",value:function(){this._setVisible(!1,void 0);var e=this.currentElement.get();e&&(e.type===Mi.Deleted?(this._editors.original.setSelection(te.e.fromPositions(new ie.L(e.originalLineNumber,1))),this._editors.original.revealLine(e.originalLineNumber),this._editors.original.focus()):(e.type!==Mi.Header&&(this._editors.modified.setSelection(te.e.fromPositions(new ie.L(e.modifiedLineNumber,1))),this._editors.modified.revealLine(e.modifiedLineNumber)),this._editors.modified.focus()))}},{key:"close",value:function(){this._setVisible(!1,void 0),this._editors.modified.focus()}}]),t}(b.JT);Oi=Ni([Ci(4,Ei.e7)],Oi);var Mi,Ti=3;!function(e){e[e.Header=0]="Header",e[e.Unchanged=1]="Unchanged",e[e.Deleted=2]="Deleted",e[e.Added=3]="Added"}(Mi||(Mi={}));var ki=(0,r.Z)((function e(i,t){(0,o.Z)(this,e),this.range=i,this.lines=t})),Vi=(0,r.Z)((function e(){(0,o.Z)(this,e),this.type=Mi.Header})),Zi=(0,r.Z)((function e(i,t){(0,o.Z)(this,e),this.diff=i,this.originalLineNumber=t,this.type=Mi.Deleted,this.modifiedLineNumber=void 0})),Wi=(0,r.Z)((function e(i,t){(0,o.Z)(this,e),this.diff=i,this.modifiedLineNumber=t,this.type=Mi.Added,this.originalLineNumber=void 0})),Pi=(0,r.Z)((function e(i,t){(0,o.Z)(this,e),this.originalLineNumber=i,this.modifiedLineNumber=t,this.type=Mi.Unchanged})),Ai=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,r,d,s,u){var f;(0,o.Z)(this,t),(f=i.call(this))._element=e,f._model=n,f._width=r,f._height=d,f._editors=s,f._languageService=u,f.domNode=f._element,f.domNode.className="diff-review monaco-editor-background";var h=document.createElement("div");return h.className="diff-review-actions",f._actionBar=f._register(new _i.o(h)),f._register((0,c.EH)("update actions",(function(e){f._actionBar.clear(),f._model.canClose.read(e)&&f._actionBar.push(new Ce.aU("diffreview.close",(0,C.NC)("label.close","Close"),"close-diff-review "+L.k.asClassName(Ii),!0,(function(){return Si((0,a.Z)(f),void 0,void 0,(0,ue.Z)().mark((function e(){return(0,ue.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.close());case 1:case"end":return e.stop()}}),e)})))})),{label:!1,icon:!0})}))),f._content=document.createElement("div"),f._content.className="diff-review-content",f._content.setAttribute("role","code"),f._scrollbar=f._register(new pi.s$(f._content,{})),(0,l.reset)(f.domNode,f._scrollbar.getDomNode(),h),f._register((0,b.OF)((function(){(0,l.reset)(f.domNode)}))),f._register(X(f.domNode,{width:f._width,height:f._height})),f._register(X(f._content,{width:f._width,height:f._height})),f._register((0,g.b2)("render",(function(e,i){f._model.currentGroup.read(e),f._render(i)}))),f._register((0,l.addStandardDisposableListener)(f.domNode,"keydown",(function(e){(e.equals(18)||e.equals(2066)||e.equals(530))&&(e.preventDefault(),f._model.goToNextLine()),(e.equals(16)||e.equals(2064)||e.equals(528))&&(e.preventDefault(),f._model.goToPreviousLine()),(e.equals(9)||e.equals(2057)||e.equals(521)||e.equals(1033))&&(e.preventDefault(),f._model.close()),(e.equals(10)||e.equals(3))&&(e.preventDefault(),f._model.revealCurrentElementInEditor())}))),f}return(0,r.Z)(t,[{key:"_render",value:function(e){var i=this,t=this._editors.original.getOptions(),o=this._editors.modified.getOptions(),r=document.createElement("div");r.className="diff-review-table",r.setAttribute("role","list"),r.setAttribute("aria-label",(0,C.NC)("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),(0,se.N)(r,o.get(49)),(0,l.reset)(this._content,r);var a=this._editors.original.getModel(),d=this._editors.modified.getModel();if(a&&d){var s,u=a.getOptions(),f=d.getOptions(),g=o.get(65),h=this._model.currentGroup.get(),v=(0,n.Z)((null===h||void 0===h?void 0:h.lines)||[]);try{var m=function(){var n,v=s.value;if(!h)return 1;if(v.type===Mi.Header){var m=document.createElement("div");m.className="diff-review-row",m.setAttribute("role","listitem");var _=h.range,p=i._model.currentGroupIndex.get(),b=i._model.groups.get().length,y=function(e){return 0===e?(0,C.NC)("no_lines_changed","no lines changed"):1===e?(0,C.NC)("one_line_changed","1 line changed"):(0,C.NC)("more_lines_changed","{0} lines changed",e)},w=y(_.original.length),E=y(_.modified.length);m.setAttribute("aria-label",(0,C.NC)({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",p+1,b,_.original.startLineNumber,w,_.modified.startLineNumber,E));var L=document.createElement("div");L.className="diff-review-cell diff-review-summary",L.appendChild(document.createTextNode("".concat(p+1,"/").concat(b,": @@ -").concat(_.original.startLineNumber,",").concat(_.original.length," +").concat(_.modified.startLineNumber,",").concat(_.modified.length," @@"))),m.appendChild(L),n=m}else n=i._createRow(v,g,i._width.get(),t,a,u,o,d,f);r.appendChild(n);var N=(0,c.nK)("isSelected",(function(e){return i._model.currentElement.read(e)===v}));e.add((0,c.EH)("update tab index",(function(e){var i=N.read(e);n.tabIndex=i?0:-1,i&&n.focus()}))),e.add((0,l.addDisposableListener)(n,"focus",(function(){i._model.goToLine(v)})))};for(v.s();!(s=v.n()).done&&!m(););}catch(_){v.e(_)}finally{v.f()}this._scrollbar.scanDomNode()}}},{key:"_createRow",value:function(e,i,t,n,o,r,a,d,s){var l=n.get(142),u=l.glyphMarginWidth+l.lineNumbersWidth,f=a.get(142),c=10+f.glyphMarginWidth+f.lineNumbersWidth,g="diff-review-row",h="",v=null;switch(e.type){case Mi.Added:g="diff-review-row line-insert",h=" char-insert",v=Di;break;case Mi.Deleted:g="diff-review-row line-delete",h=" char-delete",v=Ri}var m=document.createElement("div");m.style.minWidth=t+"px",m.className=g,m.setAttribute("role","listitem"),m.ariaLevel="";var _=document.createElement("div");_.className="diff-review-cell",_.style.height="".concat(i,"px"),m.appendChild(_);var p=document.createElement("span");p.style.width=u+"px",p.style.minWidth=u+"px",p.className="diff-review-line-number"+h,void 0!==e.originalLineNumber?p.appendChild(document.createTextNode(String(e.originalLineNumber))):p.innerText="\xa0",_.appendChild(p);var b=document.createElement("span");b.style.width=c+"px",b.style.minWidth=c+"px",b.style.paddingRight="10px",b.className="diff-review-line-number"+h,void 0!==e.modifiedLineNumber?b.appendChild(document.createTextNode(String(e.modifiedLineNumber))):b.innerText="\xa0",_.appendChild(b);var y,w=document.createElement("span");if(w.className="diff-review-spacer",v){var E=document.createElement("span");E.className=L.k.asClassName(v),E.innerText="\xa0\xa0",w.appendChild(E)}else w.innerText="\xa0\xa0";if(_.appendChild(w),void 0!==e.modifiedLineNumber){var N=this._getLineHtml(d,a,s.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);bi.j._ttPolicy&&(N=bi.j._ttPolicy.createHTML(N)),_.insertAdjacentHTML("beforeend",N),y=d.getLineContent(e.modifiedLineNumber)}else{var S=this._getLineHtml(o,n,r.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);bi.j._ttPolicy&&(S=bi.j._ttPolicy.createHTML(S)),_.insertAdjacentHTML("beforeend",S),y=o.getLineContent(e.originalLineNumber)}0===y.length&&(y=(0,C.NC)("blankLine","blank"));var D="";switch(e.type){case Mi.Unchanged:D=e.originalLineNumber===e.modifiedLineNumber?(0,C.NC)({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",y,e.originalLineNumber):(0,C.NC)("equalLine","{0} original line {1} modified line {2}",y,e.originalLineNumber,e.modifiedLineNumber);break;case Mi.Added:D=(0,C.NC)("insertLine","+ {0} modified line {1}",y,e.modifiedLineNumber);break;case Mi.Deleted:D=(0,C.NC)("deleteLine","- {0} original line {1}",y,e.originalLineNumber)}return m.setAttribute("aria-label",D),m}},{key:"_getLineHtml",value:function(e,i,t,n,o){var r=e.getLineContent(n),a=i.get(49),d=wi.A.createEmpty(r,o),s=ke.wA.isBasicASCII(r,e.mightContainNonBasicASCII()),l=ke.wA.containsRTL(r,s,e.mightContainRTL());return(0,Te.tF)(new Te.IJ(a.isMonospace&&!i.get(32),a.canUseHalfwidthRightwardsArrow,r,!1,s,l,0,d,[],t,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,i.get(115),i.get(97),i.get(92),i.get(50)!==xe.n0.OFF,null)).html}}]),t}(b.JT);function Hi(e,i){var t,o,r,a,d;return(0,ue.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:r=(0,n.Z)(e),s.prev=1,r.s();case 3:if((a=r.n()).done){s.next=16;break}if(d=a.value,void 0===o||!i(o,d)){s.next=9;break}t.push(d),s.next=13;break;case 9:if(!t){s.next=12;break}return s.next=12,t;case 12:t=[d];case 13:o=d;case 14:s.next=3;break;case 16:s.next=21;break;case 18:s.prev=18,s.t0=s.catch(1),r.e(s.t0);case 21:return s.prev=21,r.f(),s.finish(21);case 24:if(!t){s.next=27;break}return s.next=27,t;case 27:case"end":return s.stop()}}),Li,null,[[1,18,21,24]])}Ai=Ni([Ci(5,yi.O)],Ai);(0,$e.P6G)("diffEditor.move.border",{dark:"#8b8b8b9c",light:"#8b8b8b9c",hcDark:"#8b8b8b9c",hcLight:"#8b8b8b9c"},(0,C.NC)("diffEditor.move.border","The border color for text that got moved in the diff editor."));var zi=function(e,i,t,n){var o,r=arguments.length,a=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(a=(r<3?o(a):r>3?o(i,t,a):o(i,t))||a);return r>3&&a&&Object.defineProperty(i,t,a),a},Fi=function(e,i){return function(t,n){i(t,n,e)}},Bi=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e,n,r,d,s,u,m){var _,p;(0,o.Z)(this,t),(_=i.call(this))._domElement=e,_._parentContextKeyService=d,_._parentInstantiationService=s,_._audioCueService=m,_.elements=(0,l.h)("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[(0,l.h)("div.noModificationsOverlay@overlay",{style:{position:"absolute",height:"100%",visibility:"hidden"}},[(0,l.$)("span",{},"No Changes")]),(0,l.h)("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),(0,l.h)("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),(0,l.h)("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),_._diffModel=_._register((0,h.DN)("diffModel",void 0)),_.onDidChangeModel=f.ju.fromObservableLight(_._diffModel),_._contextKeyService=_._register(_._parentContextKeyService.createScoped(_._domElement)),_._instantiationService=_._parentInstantiationService.createChild(new si.y([ai.i6,_._contextKeyService])),_._boundarySashes=(0,c.uh)("boundarySashes",void 0),_._accessibleDiffViewerShouldBeVisible=(0,c.uh)("accessibleDiffViewerShouldBeVisible",!1),_._accessibleDiffViewerVisible=(0,c.nK)("accessibleDiffViewerVisible",(function(e){return!!_._options.onlyShowAccessibleDiffViewer.read(e)||_._accessibleDiffViewerShouldBeVisible.read(e)})),_._layoutInfo=(0,c.nK)("modifiedEditorLayoutInfo",(function(e){var i,t=_._rootSizeObserver.width.read(e),n=_._rootSizeObserver.height.read(e),o=null===(i=_._sash.read(e))||void 0===i?void 0:i.sashLeft.read(e),r=null!==o&&void 0!==o?o:Math.max(5,_._editors.original.getLayoutInfo().decorationsLeft),a=t-r-(_._options.renderOverviewRuler.read(e)?Qe.ENTIRE_DIFF_OVERVIEW_WIDTH:0);return _.elements.original.style.width=r+"px",_.elements.original.style.left="0px",_.elements.modified.style.width=a+"px",_.elements.modified.style.left=r+"px",_._editors.original.layout({width:r,height:n}),_._editors.modified.layout({width:a,height:n}),{modifiedEditor:_._editors.modified.getLayoutInfo(),originalEditor:_._editors.original.getLayoutInfo()}})),_._diffValue=_._diffModel.map((function(e,i){return null===e||void 0===e?void 0:e.diff.read(i)})),_.onDidUpdateDiff=f.ju.fromObservableLight(_._diffValue),u.willCreateDiffEditor(),_._contextKeyService.createKey("isInDiffEditor",!0),_._contextKeyService.createKey("diffEditorVersion",2),_._options=new hi(n),_._contextKeyService.createKey(ri.u.isEmbeddedDiffEditor.key,!1);var b=ri.u.isEmbeddedDiffEditor.bindTo(_._contextKeyService);_._register((0,c.EH)("update isEmbeddedDiffEditorKey",(function(e){b.set(_._options.isInEmbeddedEditor.read(e))})));var y=ri.u.accessibleDiffViewerVisible.bindTo(_._contextKeyService);_._register((0,c.EH)("update accessibleDiffViewerVisible context key",(function(e){y.set(_._accessibleDiffViewerVisible.read(e))}))),_._domElement.appendChild(_.elements.root),_._rootSizeObserver=_._register(new q(_.elements.root,n.dimension)),_._rootSizeObserver.setAutomaticLayout(null!==(p=n.automaticLayout)&&void 0!==p&&p),_._editors=_._register(_._instantiationService.createInstance(gi,_.elements.original,_.elements.modified,_._options,r,(function(e,i,t,n){return _._createInnerEditor(e,i,t,n)}))),_._sash=(0,v.Be)("sash",(function(e,i){var t=_._options.renderSideBySide.read(e);if(_.elements.root.classList.toggle("side-by-side",t),t){var n=i.add(new re(_._options,_.elements.root,{height:_._rootSizeObserver.height,width:_._rootSizeObserver.width.map((function(e,i){return e-(_._options.renderOverviewRuler.read(i)?Qe.ENTIRE_DIFF_OVERVIEW_WIDTH:0)}))}));return i.add((0,c.EH)("setBoundarySashes",(function(e){var i=_._boundarySashes.read(e);i&&n.setBoundarySashes(i)}))),n}})),_._register((0,c.$g)(_._sash,!0)),_._register((0,g.b2)("UnchangedRangesFeature",(function(e,i){_.unchangedRangesFeature=i.add(new(Y(ii,e))(_._editors,_._diffModel,_._options))}))),_._register((0,g.b2)("DiffEditorDecorations",(function(e,i){i.add(new(Y(ne,e))(_._editors,_._diffModel,_._options))}))),_._register((0,g.b2)("ViewZoneManager",(function(e,i){i.add(_._instantiationService.createInstance(Y(Be,e),_._editors,_._diffModel,_._options,(0,a.Z)(_),(function(){return _.unchangedRangesFeature.isUpdatingViewZones})))}))),_._register((0,g.b2)("OverviewRulerPart",(function(e,i){i.add(_._instantiationService.createInstance(Y(Qe,e),_._editors,_.elements.root,_._diffModel,_._rootSizeObserver.width,_._rootSizeObserver.height,_._layoutInfo.map((function(e){return e.modifiedEditor})),_._options))}))),_._register((0,g.b2)("_accessibleDiffViewer",(function(e,i){_._accessibleDiffViewer=i.add(_._register(_._instantiationService.createInstance(Y(xi,e),_.elements.accessibleDiffViewer,_._accessibleDiffViewerVisible,(function(e,i){return _._accessibleDiffViewerShouldBeVisible.set(e,i)}),_._options.onlyShowAccessibleDiffViewer.map((function(e){return!e})),_._rootSizeObserver.width,_._rootSizeObserver.height,_._diffModel.map((function(e,i){var t;return null===(t=null===e||void 0===e?void 0:e.diff.read(i))||void 0===t?void 0:t.mappings.map((function(e){return e.lineRangeMapping}))})),_._editors)))})));var w=_._accessibleDiffViewerVisible.map((function(e){return e?"hidden":"visible"}));return _._register(X(_.elements.modified,{visibility:w})),_._register(X(_.elements.original,{visibility:w})),_._createDiffEditorContributions(),u.addDiffEditor((0,a.Z)(_)),_._register((0,c.$g)(_._layoutInfo,!0)),_._register(new H(_.elements.root,_._diffModel,_._layoutInfo.map((function(e){return e.originalEditor})),_._layoutInfo.map((function(e){return e.modifiedEditor})),_._editors)),_._register(X(_.elements.overlay,{width:_._layoutInfo.map((function(e,i){return e.originalEditor.width+(_._options.renderSideBySide.read(i)?0:e.modifiedEditor.width)})),visibility:(0,c.nK)("visibility",(function(e){var i,t;return _._options.collapseUnchangedRegions.read(e)&&0===(null===(t=null===(i=_._diffModel.read(e))||void 0===i?void 0:i.diff.read(e))||void 0===t?void 0:t.mappings.length)?"visible":"hidden"}))})),_._register(_._editors.original.onDidChangeCursorPosition((function(e){var i=_._diffModel.get();if(i){var t=i.diff.get().movedTexts.find((function(i){return i.lineRangeMapping.original.contains(e.position.lineNumber)}));i.syncedMovedTexts.set(t,void 0)}}))),_._register(_._editors.modified.onDidChangeCursorPosition((function(e){var i=_._diffModel.get();if(i){var t=i.diff.get().movedTexts.find((function(i){return i.lineRangeMapping.modified.contains(e.position.lineNumber)}));i.syncedMovedTexts.set(t,void 0)}}))),_._register(_._editors.modified.onMouseDown((function(e){var i,t;if(!e.event.rightButton&&e.target.position&&(null===(i=e.target.element)||void 0===i?void 0:i.className.includes("arrow-revert-change"))){var n=e.target.position.lineNumber,o=e.target,r=_._diffModel.get();if(!r)return;var a=null===(t=r.diff.get())||void 0===t?void 0:t.mappings;if(!a)return;var d=a.find((function(e){return(null===o||void 0===o?void 0:o.detail.afterLineNumber)===e.lineRangeMapping.modifiedRange.startLineNumber-1||e.lineRangeMapping.modifiedRange.startLineNumber===n}));if(!d)return;_.revert(d.lineRangeMapping),e.event.stopPropagation()}}))),_._register(f.ju.runAndSubscribe(_._editors.modified.onDidChangeCursorPosition,(function(e){var i,t;if(3===(null===e||void 0===e?void 0:e.reason)){var n=null===(t=null===(i=_._diffModel.get())||void 0===i?void 0:i.diff.get())||void 0===t?void 0:t.mappings.find((function(i){return i.lineRangeMapping.modifiedRange.contains(e.position.lineNumber)}));(null===n||void 0===n?void 0:n.lineRangeMapping.modifiedRange.isEmpty)?_._audioCueService.playAudioCue(Ei.y$.diffLineDeleted):(null===n||void 0===n?void 0:n.lineRangeMapping.originalRange.isEmpty)?_._audioCueService.playAudioCue(Ei.y$.diffLineInserted):n&&_._audioCueService.playAudioCue(Ei.y$.diffLineModified)}}))),_}return(0,r.Z)(t,[{key:"_createInnerEditor",value:function(e,i,t,n){return e.createInstance(p.Gm,i,t,n)}},{key:"_createDiffEditorContributions",value:function(){var e,i=m.Uc.getDiffEditorContributions(),t=(0,n.Z)(i);try{for(t.s();!(e=t.n()).done;){var o=e.value;try{this._register(this._instantiationService.createInstance(o.ctor,this))}catch(r){(0,u.dL)(r)}}}catch(r){t.e(r)}finally{t.f()}}},{key:"_targetEditor",get:function(){return this._editors.modified}},{key:"getEditorType",value:function(){return oi.g.IDiffEditor}},{key:"layout",value:function(e){this._rootSizeObserver.observe(e)}},{key:"hasTextFocus",value:function(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}},{key:"saveViewState",value:function(){var e;return{original:this._editors.original.saveViewState(),modified:this._editors.modified.saveViewState(),modelState:null===(e=this._diffModel.get())||void 0===e?void 0:e.serializeState()}}},{key:"restoreViewState",value:function(e){var i;if(e&&e.original&&e.modified){var t=e;this._editors.original.restoreViewState(t.original),this._editors.modified.restoreViewState(t.modified),t.modelState&&(null===(i=this._diffModel.get())||void 0===i||i.restoreSerializedState(t.modelState))}}},{key:"createViewModel",value:function(e){return new _e(e,this._options,this._instantiationService.createInstance(ni.Q,{diffAlgorithm:this._options.diffAlgorithm.get()}))}},{key:"getModel",value:function(){var e,i;return null!==(i=null===(e=this._diffModel.get())||void 0===e?void 0:e.model)&&void 0!==i?i:null}},{key:"setModel",value:function(e){var i=this;!e&&this._diffModel.get()&&this._accessibleDiffViewer.close();var t=e?"model"in e?e:this.createViewModel(e):void 0;this._editors.original.setModel(t?t.model.original:null),this._editors.modified.setModel(t?t.model.modified:null),(0,h.PS)((function(e){i._diffModel.set(t,e)}))}},{key:"updateOptions",value:function(e){this._options.updateOptions(e)}},{key:"getContainerDomNode",value:function(){return this._domElement}},{key:"getOriginalEditor",value:function(){return this._editors.original}},{key:"getModifiedEditor",value:function(){return this._editors.modified}},{key:"getLineChanges",value:function(){var e,i=null===(e=this._diffModel.get())||void 0===e?void 0:e.diff.get();return i?i.mappings.map((function(e){var i,t,n,o,r=e.lineRangeMapping,a=r.innerChanges;return r.originalRange.isEmpty?(i=r.originalRange.startLineNumber-1,t=0,a=void 0):(i=r.originalRange.startLineNumber,t=r.originalRange.endLineNumberExclusive-1),r.modifiedRange.isEmpty?(n=r.modifiedRange.startLineNumber-1,o=0,a=void 0):(n=r.modifiedRange.startLineNumber,o=r.modifiedRange.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:t,modifiedStartLineNumber:n,modifiedEndLineNumber:o,charChanges:null===a||void 0===a?void 0:a.map((function(e){return{originalStartLineNumber:e.originalRange.startLineNumber,originalStartColumn:e.originalRange.startColumn,originalEndLineNumber:e.originalRange.endLineNumber,originalEndColumn:e.originalRange.endColumn,modifiedStartLineNumber:e.modifiedRange.startLineNumber,modifiedStartColumn:e.modifiedRange.startColumn,modifiedEndLineNumber:e.modifiedRange.endLineNumber,modifiedEndColumn:e.modifiedRange.endColumn}}))}})):null}},{key:"revert",value:function(e){var i,t=null===(i=this._diffModel.get())||void 0===i?void 0:i.model;if(t){var n=e.innerChanges?e.innerChanges.map((function(e){return{range:e.modifiedRange,text:t.original.getValueInRange(e.originalRange)}})):[{range:e.modifiedRange.toExclusiveRange(),text:t.original.getValueInRange(e.originalRange.toExclusiveRange())}];this._editors.modified.executeEdits("diffEditor",n)}}},{key:"accessibleDiffViewerNext",value:function(){this._accessibleDiffViewer.next()}},{key:"accessibleDiffViewerPrev",value:function(){this._accessibleDiffViewer.prev()}}]),t}(li);Bi=zi([Fi(3,ai.i6),Fi(4,di.TG),Fi(5,_.$),Fi(6,Ei.e7)],Bi)},70433:function(e,i,t){t.d(i,{F:function(){return y}});var n=t(15671),o=t(43144),r=t(11752),a=t(61120),d=t(60136),s=t(27277),l=t(17397),u=t(13880),f=t(65096),c=t(28751),g=t(17429),h=t(93574),v=t(76257),m=t(93897),_=function(e,i,t,n){var o,r=arguments.length,a=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(a=(r<3?o(a):r>3?o(i,t,a):o(i,t))||a);return r>3&&a&&Object.defineProperty(i,t,a),a},p=function(e,i){return function(t,n){i(t,n,e)}},b={followsCaret:!0,ignoreCharChanges:!0,alwaysRevealFirst:!0,findResultLoop:!0},y=function(e){(0,d.Z)(t,e);var i=(0,s.Z)(t);function t(e){var o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,d=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;return(0,n.Z)(this,t),(o=i.call(this))._audioCueService=a,o._codeEditorService=d,o._accessibilityService=s,o._onDidUpdate=o._register(new u.Q5),o._editor=e,o._options=c.jB(r,b,!1),o.disposed=!1,o.nextIdx=-1,o.ranges=[],o.ignoreSelectionChange=!1,o.revealFirst=Boolean(o._options.alwaysRevealFirst),o._register(o._editor.onDidUpdateDiff((function(){return o._onDiffUpdated()}))),o._options.followsCaret&&o._register(o._editor.getModifiedEditor().onDidChangeCursorPosition((function(e){o.ignoreSelectionChange||(o._updateAccessibilityState(e.position.lineNumber),o.nextIdx=-1)}))),o._init(),o}return(0,o.Z)(t,[{key:"_init",value:function(){this._editor.getLineChanges()}},{key:"_onDiffUpdated",value:function(){this._init(),this._compute(this._editor.getLineChanges()),this.revealFirst&&null!==this._editor.getLineChanges()&&(this.revealFirst=!1,this.nextIdx=-1,this.next(1))}},{key:"_compute",value:function(e){var i=this;this.ranges=[],e&&e.forEach((function(e){!i._options.ignoreCharChanges&&e.charChanges?e.charChanges.forEach((function(e){i.ranges.push({rhs:!0,range:new g.e(e.modifiedStartLineNumber,e.modifiedStartColumn,e.modifiedEndLineNumber,e.modifiedEndColumn)})})):0===e.modifiedEndLineNumber?i.ranges.push({rhs:!0,range:new g.e(e.modifiedStartLineNumber,1,e.modifiedStartLineNumber+1,1)}):i.ranges.push({rhs:!0,range:new g.e(e.modifiedStartLineNumber,1,e.modifiedEndLineNumber+1,1)})})),this.ranges.sort((function(e,i){return g.e.compareRangesUsingStarts(e.range,i.range)})),this._onDidUpdate.fire(this)}},{key:"_initIdx",value:function(e){var i=!1,t=this._editor.getPosition();if(t){for(var n=0,o=this.ranges.length;n<o&&!i;n++){var r=this.ranges[n].range;t.isBeforeOrEqual(r.getStartPosition())&&(this.nextIdx=n+(e?0:-1),i=!0)}i||(this.nextIdx=e?0:this.ranges.length-1),this.nextIdx<0&&(this.nextIdx=this.ranges.length-1)}else this.nextIdx=0}},{key:"_move",value:function(e,i){if(l.ok(!this.disposed,"Illegal State - diff navigator has been disposed"),this.canNavigate()){-1===this.nextIdx?this._initIdx(e):e?(this.nextIdx+=1,this.nextIdx>=this.ranges.length&&(this.nextIdx=0)):(this.nextIdx-=1,this.nextIdx<0&&(this.nextIdx=this.ranges.length-1));var t=this.ranges[this.nextIdx];this.ignoreSelectionChange=!0;try{var n=t.range.getStartPosition();this._editor.setPosition(n),this._editor.revealRangeInCenter(t.range,i),this._updateAccessibilityState(n.lineNumber,!0)}finally{this.ignoreSelectionChange=!1}}}},{key:"_updateAccessibilityState",value:function(e,i){var t,n=null===(t=this._editor.getModel())||void 0===t?void 0:t.modified;if(n){var o=n.getLineDecorations(e).find((function(e){return"line-insert"===e.options.className}));if(o)this._audioCueService.playAudioCue(h.y$.diffLineModified,!0);else{if(!i)return;this._audioCueService.playAudioCue(h.y$.diffLineDeleted,!0)}var r=this._codeEditorService.getActiveCodeEditor();i&&r&&o&&this._accessibilityService.isScreenReaderOptimized()&&(r.setSelection({startLineNumber:e,startColumn:0,endLineNumber:e,endColumn:Number.MAX_VALUE}),r.writeScreenReaderContent("diff-navigation"))}}},{key:"canNavigate",value:function(){return this.ranges&&this.ranges.length>0}},{key:"next",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.canNavigateNext()&&this._move(!0,e)}},{key:"previous",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.canNavigatePrevious()&&this._move(!1,e)}},{key:"canNavigateNext",value:function(){return this.canNavigateLoop()||this.nextIdx<this.ranges.length-1}},{key:"canNavigatePrevious",value:function(){return this.canNavigateLoop()||0!==this.nextIdx}},{key:"canNavigateLoop",value:function(){return Boolean(this._options.findResultLoop)}},{key:"dispose",value:function(){(0,r.Z)((0,a.Z)(t.prototype),"dispose",this).call(this),this.ranges=[],this.disposed=!0}}]),t}(f.JT);y=_([p(2,h.e7),p(3,v.$),p(4,m.F)],y)},99857:function(e,i,t){t.d(i,{j:function(){return W}});var n=t(74165),o=t(97326),r=t(60136),a=t(27277),d=t(15671),s=t(43144),l=t(32959),u=t(65379),f=t(81200),c=t(65171),g=t(84337),h=t(93720),v=t(77409),m=t(65096),_=t(79730),p=t(88616),b=t(17683),y=t(65631),w=t(58188),E=t(51373),L=t(56606),N=t(19484),C=t(18420),S=t(93574),D=t(77819),R=t(87288),I=function(e,i,t,n){var o,r=arguments.length,a=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(a=(r<3?o(a):r>3?o(i,t,a):o(i,t))||a);return r>3&&a&&Object.defineProperty(i,t,a),a},x=function(e,i){return function(t,n){i(t,n,e)}},O=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function a(e){try{s(n.next(e))}catch(i){r(i)}}function d(e){try{s(n.throw(e))}catch(i){r(i)}}function s(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(a,d)}s((n=n.apply(e,i||[])).next())}))},M=function(){function e(i,t,n,o){(0,d.Z)(this,e),this.originalLineStart=i,this.originalLineEnd=t,this.modifiedLineStart=n,this.modifiedLineEnd=o}return(0,s.Z)(e,[{key:"getType",value:function(){return 0===this.originalLineStart?1:0===this.modifiedLineStart?2:0}}]),e}(),T=(0,s.Z)((function e(i){(0,d.Z)(this,e),this.entries=i})),k=(0,R.q5)("diff-review-insert",v.l.add,C.NC("diffReviewInsertIcon","Icon for 'Insert' in diff review.")),V=(0,R.q5)("diff-review-remove",v.l.remove,C.NC("diffReviewRemoveIcon","Icon for 'Remove' in diff review.")),Z=(0,R.q5)("diff-review-close",v.l.close,C.NC("diffReviewCloseIcon","Icon for 'Close' in diff review.")),W=function(e){(0,r.Z)(t,e);var i=(0,a.Z)(t);function t(e,r,a,s){var f;return(0,d.Z)(this,t),(f=i.call(this))._languageService=r,f._audioCueService=a,f._configurationService=s,f._width=0,f._diffEditor=e,f._isVisible=!1,f.shadow=(0,u.X)(document.createElement("div")),f.shadow.setClassName("diff-review-shadow"),f.actionBarContainer=(0,u.X)(document.createElement("div")),f.actionBarContainer.setClassName("diff-review-actions"),f._actionBar=f._register(new c.o(f.actionBarContainer.domNode)),f._actionBar.push(new h.aU("diffreview.close",C.NC("label.close","Close"),"close-diff-review "+_.k.asClassName(Z),!0,(function(){return O((0,o.Z)(f),void 0,void 0,(0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.hide());case 1:case"end":return e.stop()}}),e,this)})))})),{label:!1,icon:!0}),f.domNode=(0,u.X)(document.createElement("div")),f.domNode.setClassName("diff-review monaco-editor-background"),f._content=(0,u.X)(document.createElement("div")),f._content.setClassName("diff-review-content"),f._content.setAttribute("role","code"),f.scrollbar=f._register(new g.s$(f._content.domNode,{})),f.domNode.domNode.appendChild(f.scrollbar.getDomNode()),f._register(e.onDidUpdateDiff((function(){f._isVisible&&(f._diffs=f._compute(),f._render())}))),f._register(e.getModifiedEditor().onDidChangeCursorPosition((function(){f._isVisible&&f._render()}))),f._register(l.addStandardDisposableListener(f.domNode.domNode,"click",(function(e){e.preventDefault();var i=l.findParentWithClass(e.target,"diff-review-row");i&&f._goToRow(i)}))),f._register(l.addStandardDisposableListener(f.domNode.domNode,"keydown",(function(e){(e.equals(18)||e.equals(2066)||e.equals(530))&&(e.preventDefault(),f._goToRow(f._getNextRow(),"next")),(e.equals(16)||e.equals(2064)||e.equals(528))&&(e.preventDefault(),f._goToRow(f._getPrevRow(),"previous")),(e.equals(9)||e.equals(2057)||e.equals(521)||e.equals(1033)||e.equals(10)||e.equals(3))&&(e.preventDefault(),f.accept())}))),f._register(f._configurationService.onDidChangeConfiguration((function(e){e.affectsConfiguration("accessibility.verbosity.diffEditor")&&f._diffEditor.updateOptions({accessibilityVerbose:f._configurationService.getValue("accessibility.verbosity.diffEditor")})}))),f._diffs=[],f._currentDiff=null,f}return(0,s.Z)(t,[{key:"prev",value:function(){var e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){for(var i=-1,t=0,n=this._diffs.length;t<n;t++)if(this._diffs[t]===this._currentDiff){i=t;break}e=this._diffs.length+i-1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0!==this._diffs.length){e%=this._diffs.length;var o=this._diffs[e].entries;this._diffEditor.setPosition(new y.L(o[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:o[0].modifiedLineStart,endColumn:1073741824,endLineNumber:o[o.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getPrevRow(),"previous")}}},{key:"next",value:function(){var e=0;if(this._isVisible||(this._diffs=this._compute()),this._isVisible){for(var i=-1,t=0,n=this._diffs.length;t<n;t++)if(this._diffs[t]===this._currentDiff){i=t;break}e=i+1}else e=this._findDiffIndex(this._diffEditor.getPosition());if(0!==this._diffs.length){e%=this._diffs.length;var o=this._diffs[e].entries;this._diffEditor.setPosition(new y.L(o[0].modifiedLineStart,1)),this._diffEditor.setSelection({startColumn:1,startLineNumber:o[0].modifiedLineStart,endColumn:1073741824,endLineNumber:o[o.length-1].modifiedLineEnd}),this._isVisible=!0,this._diffEditor.doLayout(),this._render(),this._goToRow(this._getNextRow(),"next")}}},{key:"accept",value:function(){var e=-1,i=this._getCurrentFocusedRow();if(i){var t=parseInt(i.getAttribute("data-line"),10);isNaN(t)||(e=t)}this.hide(),-1!==e&&(this._diffEditor.setPosition(new y.L(e,1)),this._diffEditor.revealPosition(new y.L(e,1),1))}},{key:"hide",value:function(){this._isVisible=!1,this._diffEditor.updateOptions({readOnly:!1}),this._diffEditor.focus(),this._diffEditor.doLayout(),this._render()}},{key:"_getPrevRow",value:function(){var e=this._getCurrentFocusedRow();return e?e.previousElementSibling?e.previousElementSibling:e:this._getFirstRow()}},{key:"_getNextRow",value:function(){var e=this._getCurrentFocusedRow();return e?e.nextElementSibling?e.nextElementSibling:e:this._getFirstRow()}},{key:"_getFirstRow",value:function(){return this.domNode.domNode.querySelector(".diff-review-row")}},{key:"_getCurrentFocusedRow",value:function(){var e=document.activeElement;return e&&/diff-review-row/.test(e.className)?e:null}},{key:"_goToRow",value:function(e,i){var t=this._getCurrentFocusedRow();e.tabIndex=0,e.focus(),t&&t!==e&&(t.tabIndex=-1);var n=i?"next"===i?null===t||void 0===t?void 0:t.nextElementSibling:null===t||void 0===t?void 0:t.previousElementSibling:t;(null===n||void 0===n?void 0:n.classList.contains("line-insert"))?this._audioCueService.playAudioCue(S.y$.diffLineInserted,!0):(null===n||void 0===n?void 0:n.classList.contains("line-delete"))&&this._audioCueService.playAudioCue(S.y$.diffLineDeleted,!0),this.scrollbar.scanDomNode()}},{key:"isVisible",value:function(){return this._isVisible}},{key:"layout",value:function(e,i,t){this._width=i,this.shadow.setTop(e-6),this.shadow.setWidth(i),this.shadow.setHeight(this._isVisible?6:0),this.domNode.setTop(e),this.domNode.setWidth(i),this.domNode.setHeight(t),this._content.setHeight(t),this._content.setWidth(i),this._isVisible?(this.actionBarContainer.setAttribute("aria-hidden","false"),this.actionBarContainer.setDisplay("block")):(this.actionBarContainer.setAttribute("aria-hidden","true"),this.actionBarContainer.setDisplay("none"))}},{key:"_compute",value:function(){var e=this._diffEditor.getLineChanges();if(!e||0===e.length)return[];var i=this._diffEditor.getOriginalEditor().getModel(),n=this._diffEditor.getModifiedEditor().getModel();return i&&n?t._mergeAdjacent(e,i.getLineCount(),n.getLineCount()):[]}},{key:"_findDiffIndex",value:function(e){for(var i=e.lineNumber,t=0,n=this._diffs.length;t<n;t++){var o=this._diffs[t].entries;if(i<=o[o.length-1].modifiedLineEnd)return t}return 0}},{key:"_render",value:function(){var e=this._diffEditor.getOriginalEditor().getOptions(),i=this._diffEditor.getModifiedEditor().getOptions(),n=this._diffEditor.getOriginalEditor().getModel(),o=this._diffEditor.getModifiedEditor().getModel(),r=n.getOptions(),a=o.getOptions();if(!this._isVisible||!n||!o)return l.clearNode(this._content.domNode),this._currentDiff=null,void this.scrollbar.scanDomNode();this._diffEditor.updateOptions({readOnly:!0});var d=this._findDiffIndex(this._diffEditor.getPosition());if(this._diffs[d]!==this._currentDiff){this._currentDiff=this._diffs[d];var s=this._diffs[d].entries,u=document.createElement("div");u.className="diff-review-table",u.setAttribute("role","list"),u.setAttribute("aria-label",'Difference review. Use "Stage | Unstage | Revert Selected Ranges" commands'),(0,p.N)(u,i.get(49));for(var f=0,c=0,g=0,h=0,v=0,m=s.length;v<m;v++){var _=s[v],b=_.originalLineStart,y=_.originalLineEnd,w=_.modifiedLineStart,E=_.modifiedLineEnd;0!==b&&(0===f||b<f)&&(f=b),0!==y&&(0===c||y>c)&&(c=y),0!==w&&(0===g||w<g)&&(g=w),0!==E&&(0===h||E>h)&&(h=E)}var L=document.createElement("div");L.className="diff-review-row";var N=document.createElement("div");N.className="diff-review-cell diff-review-summary";var S=c-f+1,D=h-g+1;N.appendChild(document.createTextNode("".concat(d+1,"/").concat(this._diffs.length,": @@ -").concat(f,",").concat(S," +").concat(g,",").concat(D," @@"))),L.setAttribute("data-line",String(g));var R=function(e){return 0===e?C.NC("no_lines_changed","no lines changed"):1===e?C.NC("one_line_changed","1 line changed"):C.NC("more_lines_changed","{0} lines changed",e)},I=R(S),x=R(D);L.setAttribute("aria-label",C.NC({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",d+1,this._diffs.length,f,I,g,x)),L.appendChild(N),L.setAttribute("role","listitem"),u.appendChild(L);for(var O=i.get(65),M=g,T=0,k=s.length;T<k;T++){var V=s[T];t._renderSection(u,V,M,O,this._width,e,n,r,i,o,a,this._languageService.languageIdCodec),0!==V.modifiedLineStart&&(M=V.modifiedLineEnd)}l.clearNode(this._content.domNode),this._content.domNode.appendChild(u),this.scrollbar.scanDomNode()}}}],[{key:"_mergeAdjacent",value:function(e,i,t){if(!e||0===e.length)return[];for(var n=[],o=0,r=0,a=e.length;r<a;r++){var d=e[r],s=d.originalStartLineNumber,l=d.originalEndLineNumber,u=d.modifiedStartLineNumber,f=d.modifiedEndLineNumber,c=[],g=0,h=0===l?s:s-1,v=0===f?u:u-1,m=1,_=1;if(r>0){var p=e[r-1];m=0===p.originalEndLineNumber?p.originalStartLineNumber+1:p.originalEndLineNumber+1,_=0===p.modifiedEndLineNumber?p.modifiedStartLineNumber+1:p.modifiedEndLineNumber+1}var b=h-3+1,y=v-3+1;if(b<m){var w=m-b;b+=w,y+=w}if(y<_){var E=_-y;b+=E,y+=E}c[g++]=new M(b,h,y,v),0!==l&&(c[g++]=new M(s,l,0,0)),0!==f&&(c[g++]=new M(0,0,u,f));var L=0===l?s+1:l+1,N=0===f?u+1:f+1,C=i,S=t;if(r+1<a){var D=e[r+1];C=0===D.originalEndLineNumber?D.originalStartLineNumber:D.originalStartLineNumber-1,S=0===D.modifiedEndLineNumber?D.modifiedStartLineNumber:D.modifiedStartLineNumber-1}var R=L+3-1,I=N+3-1;if(R>C){var x=C-R;R+=x,I+=x}if(I>S){var O=S-I;R+=O,I+=O}c[g++]=new M(L,R,N,I),n[o++]=new T(c)}for(var k=n[0].entries,V=[],Z=0,W=1,P=n.length;W<P;W++){var A=n[W].entries,H=k[k.length-1],z=A[0];0===H.getType()&&0===z.getType()&&z.originalLineStart<=H.originalLineEnd?(k[k.length-1]=new M(H.originalLineStart,z.originalLineEnd,H.modifiedLineStart,z.modifiedLineEnd),k=k.concat(A.slice(1))):(V[Z++]=new T(k),k=A)}return V[Z++]=new T(k),V}},{key:"_renderSection",value:function(e,i,n,o,r,a,d,s,l,u,f,c){var g=i.getType(),h="diff-review-row",v="",m=null;switch(g){case 1:h="diff-review-row line-insert",v=" char-insert",m=k;break;case 2:h="diff-review-row line-delete",v=" char-delete",m=V}for(var p=i.originalLineStart,b=i.originalLineEnd,y=i.modifiedLineStart,w=i.modifiedLineEnd,E=Math.max(w-y,b-p),L=a.get(142),N=L.glyphMarginWidth+L.lineNumbersWidth,S=l.get(142),D=10+S.glyphMarginWidth+S.lineNumbersWidth,R=0;R<=E;R++){var I=0===p?0:p+R,x=0===y?0:y+R,O=document.createElement("div");O.style.minWidth=r+"px",O.className=h,O.setAttribute("role","listitem"),0!==x&&(n=x),O.setAttribute("data-line",String(n));var M=document.createElement("div");M.className="diff-review-cell",M.style.height="".concat(o,"px"),O.appendChild(M);var T=document.createElement("span");T.style.width=N+"px",T.style.minWidth=N+"px",T.className="diff-review-line-number"+v,0!==I?T.appendChild(document.createTextNode(String(I))):T.innerText="\xa0",M.appendChild(T);var Z=document.createElement("span");Z.style.width=D+"px",Z.style.minWidth=D+"px",Z.style.paddingRight="10px",Z.className="diff-review-line-number"+v,0!==x?Z.appendChild(document.createTextNode(String(x))):Z.innerText="\xa0",M.appendChild(Z);var W=document.createElement("span");if(W.className="diff-review-spacer",m){var P=document.createElement("span");P.className=_.k.asClassName(m),P.innerText="\xa0\xa0",W.appendChild(P)}else W.innerText="\xa0\xa0";M.appendChild(W);var A=void 0;if(0!==x){var H=this._renderLine(u,l,f.tabSize,x,c);t._ttPolicy&&(H=t._ttPolicy.createHTML(H)),M.insertAdjacentHTML("beforeend",H),A=u.getLineContent(x)}else{var z=this._renderLine(d,a,s.tabSize,I,c);t._ttPolicy&&(z=t._ttPolicy.createHTML(z)),M.insertAdjacentHTML("beforeend",z),A=d.getLineContent(I)}0===A.length&&(A=C.NC("blankLine","blank"));var F="";switch(g){case 0:F=I===x?C.NC({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",A,I):C.NC("equalLine","{0} original line {1} modified line {2}",A,I,x);break;case 1:F=C.NC("insertLine","+ {0} modified line {1}",A,x);break;case 2:F=C.NC("deleteLine","- {0} original line {1}",A,I)}O.setAttribute("aria-label",F),e.appendChild(O)}}},{key:"_renderLine",value:function(e,i,t,n,o){var r=e.getLineContent(n),a=i.get(49),d=E.A.createEmpty(r,o),s=N.wA.isBasicASCII(r,e.mightContainNonBasicASCII()),l=N.wA.containsRTL(r,s,e.mightContainRTL());return(0,L.tF)(new L.IJ(a.isMonospace&&!i.get(32),a.canUseHalfwidthRightwardsArrow,r,!1,s,l,0,d,[],t,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,i.get(115),i.get(97),i.get(92),i.get(50)!==b.n0.OFF,null)).html}}]),t}(m.JT);W._ttPolicy=(0,f.Z)("diffReview",{createHTML:function(e){return e}}),W=I([x(1,w.O),x(2,S.e7),x(3,D.Ui)],W)},4391:function(e,i,t){t.d(i,{H:function(){return L}});var n=t(15671),o=t(43144),r=t(97326),a=t(60136),d=t(27277),s=t(11752),l=t(61120),u=t(28751),f=t(76257),c=t(51811),g=t(99740),h=t(8022),v=t(64606),m=t(49431),_=t(41335),p=t(93897),b=t(19536),y=t(65441),w=function(e,i,t,n){var o,r=arguments.length,a=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(a=(r<3?o(a):r>3?o(i,t,a):o(i,t))||a);return r>3&&a&&Object.defineProperty(i,t,a),a},E=function(e,i){return function(t,n){i(t,n,e)}},L=function(e){(0,a.Z)(t,e);var i=(0,d.Z)(t);function t(e,o,a,d,u,f,c,g,h,v,m,_,p){var b,y;return(0,n.Z)(this,t),(y=i.call(this,e,Object.assign(Object.assign({},d.getRawOptions()),{overflowWidgetsDomNode:d.getOverflowWidgetsDomNode()}),a,u,f,c,g,h,v,m,_,p))._parentEditor=d,y._overwriteOptions=o,(0,s.Z)((b=(0,r.Z)(y),(0,l.Z)(t.prototype)),"updateOptions",b).call(b,y._overwriteOptions),y._register(d.onDidChangeConfiguration((function(e){return y._onParentConfigurationChanged(e)}))),y}return(0,o.Z)(t,[{key:"getParentEditor",value:function(){return this._parentEditor}},{key:"_onParentConfigurationChanged",value:function(e){(0,s.Z)((0,l.Z)(t.prototype),"updateOptions",this).call(this,this._parentEditor.getRawOptions()),(0,s.Z)((0,l.Z)(t.prototype),"updateOptions",this).call(this,this._overwriteOptions)}},{key:"updateOptions",value:function(e){u.jB(this._overwriteOptions,e,!0),(0,s.Z)((0,l.Z)(t.prototype),"updateOptions",this).call(this,this._overwriteOptions)}}]),t}(c.Gm);L=w([E(4,v.TG),E(5,f.$),E(6,g.H),E(7,h.i6),E(8,_.XE),E(9,m.lT),E(10,p.F),E(11,b.c_),E(12,y.p)],L)},8422:function(e,i,t){t.d(i,{Q:function(){return v}});var n=t(74165),o=t(15671),r=t(43144),a=t(13880),d=t(48497),s=t(77621),l=t(97957),u=t(88697),f=t(45536),c=function(e,i,t,n){var o,r=arguments.length,a=r<3?i:null===n?n=Object.getOwnPropertyDescriptor(i,t):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,i,t,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(a=(r<3?o(a):r>3?o(i,t,a):o(i,t))||a);return r>3&&a&&Object.defineProperty(i,t,a),a},g=function(e,i){return function(t,n){i(t,n,e)}},h=function(e,i,t,n){return new(t||(t=Promise))((function(o,r){function a(e){try{s(n.next(e))}catch(i){r(i)}}function d(e){try{s(n.throw(e))}catch(i){r(i)}}function s(e){var i;e.done?o(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(a,d)}s((n=n.apply(e,i||[])).next())}))},v=function(){function e(i,t,n){(0,o.Z)(this,e),this.editorWorkerService=t,this.telemetryService=n,this.onDidChangeEventEmitter=new a.Q5,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(i)}return(0,r.Z)(e,[{key:"dispose",value:function(){var e;null===(e=this.diffAlgorithmOnDidChangeSubscription)||void 0===e||e.dispose()}},{key:"computeDiff",value:function(i,t,o){var r;return h(this,void 0,void 0,(0,n.Z)().mark((function a(){var u,f,c,g,h,v;return(0,n.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("string"===typeof this.diffAlgorithm){n.next=2;break}return n.abrupt("return",this.diffAlgorithm.computeDiff(i,t,o));case 2:if(1!==i.getLineCount()||1!==i.getLineMaxColumn(1)){n.next=4;break}return n.abrupt("return",{changes:[new l.f0(new s.z(1,2),new s.z(1,t.getLineCount()+1),[new l.iy(i.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]});case 4:if(u=JSON.stringify([i.uri.toString(),t.uri.toString()]),f=JSON.stringify([i.id,t.id,i.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(o)]),!(c=e.diffCache.get(u))||c.context!==f){n.next=9;break}return n.abrupt("return",c.result);case 9:return g=d.G.create(),n.next=12,this.editorWorkerService.computeDiff(i.uri,t.uri,o,this.diffAlgorithm);case 12:if(h=n.sent,v=g.elapsed(),this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:v,timedOut:null===(r=null===h||void 0===h?void 0:h.quitEarly)||void 0===r||r}),h){n.next=17;break}throw new Error("no diff result available");case 17:return e.diffCache.size>10&&e.diffCache.delete(e.diffCache.keys().next().value),e.diffCache.set(u,{result:h,context:f}),n.abrupt("return",h);case 20:case"end":return n.stop()}}),a,this)})))}},{key:"setOptions",value:function(e){var i,t=this,n=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&(null===(i=this.diffAlgorithmOnDidChangeSubscription)||void 0===i||i.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,"string"!==typeof e.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange((function(){return t.onDidChangeEventEmitter.fire()}))),n=!0),n&&this.onDidChangeEventEmitter.fire()}}]),e}();v.diffCache=new Map,v=c([g(1,u.p),g(2,f.b)],v)},82377:function(){}}]);
//# sourceMappingURL=monaco-editor-vendor.4c895aa2.add2ad76.js.map